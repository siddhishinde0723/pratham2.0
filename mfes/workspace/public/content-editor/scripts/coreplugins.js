!function(e){var t={};function n(i){if(t[i])return t[i].exports;var r=t[i]={i:i,l:!1,exports:{}};return e[i].call(r.exports,r,r.exports,n),r.l=!0,r.exports}n.m=e,n.c=t,n.d=function(e,t,i){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(i,r,function(t){return e[t]}.bind(null,r));return i},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=30)}([function(e,t){(function(){e.exports={Element:1,Attribute:2,Text:3,CData:4,EntityReference:5,EntityDeclaration:6,ProcessingInstruction:7,Comment:8,Document:9,DocType:10,DocumentFragment:11,NotationDeclaration:12,Declaration:201,Raw:202,AttributeDeclaration:203,ElementDeclaration:204,Dummy:205}}).call(this)},function(e,t,n){(function(){var t,i,r,a,o,s,l,u,c,d,h,p,f,g,m,v,y={}.hasOwnProperty,b=[].splice;({isObject:v,isFunction:m,isEmpty:g,getValue:f}=n(2)),u=null,r=null,a=null,o=null,s=null,h=null,p=null,d=null,l=null,i=null,c=null,t=null,e.exports=function(){class e{constructor(e){this.parent=e,this.parent&&(this.options=this.parent.options,this.stringify=this.parent.stringify),this.value=null,this.children=[],this.baseURI=null,u||(u=n(6),r=n(8),a=n(9),o=n(10),s=n(11),h=n(16),p=n(17),d=n(18),l=n(27),i=n(0),c=n(71),n(7),t=n(72))}setParent(e){var t,n,i,r,a;for(this.parent=e,e&&(this.options=e.options,this.stringify=e.stringify),a=[],n=0,i=(r=this.children).length;n<i;n++)t=r[n],a.push(t.setParent(this));return a}element(e,t,n){var i,r,a,o,s,l,u,c,d;if(l=null,null===t&&null==n&&([t,n]=[{},null]),null==t&&(t={}),t=f(t),v(t)||([n,t]=[t,n]),null!=e&&(e=f(e)),Array.isArray(e))for(a=0,u=e.length;a<u;a++)r=e[a],l=this.element(r);else if(m(e))l=this.element(e.apply());else if(v(e)){for(s in e)if(y.call(e,s))if(d=e[s],m(d)&&(d=d.apply()),!this.options.ignoreDecorators&&this.stringify.convertAttKey&&0===s.indexOf(this.stringify.convertAttKey))l=this.attribute(s.substr(this.stringify.convertAttKey.length),d);else if(!this.options.separateArrayItems&&Array.isArray(d)&&g(d))l=this.dummy();else if(v(d)&&g(d))l=this.element(s);else if(this.options.keepNullNodes||null!=d)if(!this.options.separateArrayItems&&Array.isArray(d))for(o=0,c=d.length;o<c;o++)r=d[o],(i={})[s]=r,l=this.element(i);else v(d)?!this.options.ignoreDecorators&&this.stringify.convertTextKey&&0===s.indexOf(this.stringify.convertTextKey)?l=this.element(d):(l=this.element(s)).element(d):l=this.element(s,d);else l=this.dummy()}else l=this.options.keepNullNodes||null!==n?!this.options.ignoreDecorators&&this.stringify.convertTextKey&&0===e.indexOf(this.stringify.convertTextKey)?this.text(n):!this.options.ignoreDecorators&&this.stringify.convertCDataKey&&0===e.indexOf(this.stringify.convertCDataKey)?this.cdata(n):!this.options.ignoreDecorators&&this.stringify.convertCommentKey&&0===e.indexOf(this.stringify.convertCommentKey)?this.comment(n):!this.options.ignoreDecorators&&this.stringify.convertRawKey&&0===e.indexOf(this.stringify.convertRawKey)?this.raw(n):!this.options.ignoreDecorators&&this.stringify.convertPIKey&&0===e.indexOf(this.stringify.convertPIKey)?this.instruction(e.substr(this.stringify.convertPIKey.length),n):this.node(e,t,n):this.dummy();if(null==l)throw new Error("Could not create any elements with: "+e+". "+this.debugInfo());return l}insertBefore(e,t,n){var i,r,a,o,s;if(null!=e?e.type:void 0)return o=t,(a=e).setParent(this),o?(r=children.indexOf(o),s=children.splice(r),children.push(a),Array.prototype.push.apply(children,s)):children.push(a),a;if(this.isRoot)throw new Error("Cannot insert elements at root level. "+this.debugInfo(e));return r=this.parent.children.indexOf(this),s=this.parent.children.splice(r),i=this.parent.element(e,t,n),Array.prototype.push.apply(this.parent.children,s),i}insertAfter(e,t,n){var i,r,a;if(this.isRoot)throw new Error("Cannot insert elements at root level. "+this.debugInfo(e));return r=this.parent.children.indexOf(this),a=this.parent.children.splice(r+1),i=this.parent.element(e,t,n),Array.prototype.push.apply(this.parent.children,a),i}remove(){var e;if(this.isRoot)throw new Error("Cannot remove the root element. "+this.debugInfo());return e=this.parent.children.indexOf(this),b.apply(this.parent.children,[e,e-e+1].concat([])),this.parent}node(e,t,n){var i;return null!=e&&(e=f(e)),t||(t={}),t=f(t),v(t)||([n,t]=[t,n]),i=new u(this,e,t),null!=n&&i.text(n),this.children.push(i),i}text(e){var t;return v(e)&&this.element(e),t=new p(this,e),this.children.push(t),this}cdata(e){var t;return t=new r(this,e),this.children.push(t),this}comment(e){var t;return t=new a(this,e),this.children.push(t),this}commentBefore(e){var t,n;return t=this.parent.children.indexOf(this),n=this.parent.children.splice(t),this.parent.comment(e),Array.prototype.push.apply(this.parent.children,n),this}commentAfter(e){var t,n;return t=this.parent.children.indexOf(this),n=this.parent.children.splice(t+1),this.parent.comment(e),Array.prototype.push.apply(this.parent.children,n),this}raw(e){var t;return t=new h(this,e),this.children.push(t),this}dummy(){return new l(this)}instruction(e,t){var n,i,r,a,o;if(null!=e&&(e=f(e)),null!=t&&(t=f(t)),Array.isArray(e))for(a=0,o=e.length;a<o;a++)n=e[a],this.instruction(n);else if(v(e))for(n in e)y.call(e,n)&&(i=e[n],this.instruction(n,i));else m(t)&&(t=t.apply()),r=new d(this,e,t),this.children.push(r);return this}instructionBefore(e,t){var n,i;return n=this.parent.children.indexOf(this),i=this.parent.children.splice(n),this.parent.instruction(e,t),Array.prototype.push.apply(this.parent.children,i),this}instructionAfter(e,t){var n,i;return n=this.parent.children.indexOf(this),i=this.parent.children.splice(n+1),this.parent.instruction(e,t),Array.prototype.push.apply(this.parent.children,i),this}declaration(e,t,n){var r,a;return r=this.document(),a=new o(r,e,t,n),0===r.children.length?r.children.unshift(a):r.children[0].type===i.Declaration?r.children[0]=a:r.children.unshift(a),r.root()||r}dtd(e,t){var n,r,a,o,l,u,c,d,h;for(n=this.document(),r=new s(n,e,t),a=o=0,u=(d=n.children).length;o<u;a=++o)if(d[a].type===i.DocType)return n.children[a]=r,r;for(a=l=0,c=(h=n.children).length;l<c;a=++l)if(h[a].isRoot)return n.children.splice(a,0,r),r;return n.children.push(r),r}up(){if(this.isRoot)throw new Error("The root node has no parent. Use doc() if you need to get the document object.");return this.parent}root(){var e;for(e=this;e;){if(e.type===i.Document)return e.rootObject;if(e.isRoot)return e;e=e.parent}}document(){var e;for(e=this;e;){if(e.type===i.Document)return e;e=e.parent}}end(e){return this.document().end(e)}prev(){var e;if((e=this.parent.children.indexOf(this))<1)throw new Error("Already at the first node. "+this.debugInfo());return this.parent.children[e-1]}next(){var e;if(-1===(e=this.parent.children.indexOf(this))||e===this.parent.children.length-1)throw new Error("Already at the last node. "+this.debugInfo());return this.parent.children[e+1]}importDocument(e){var t,n,r,a,o;if((n=e.root().clone()).parent=this,n.isRoot=!1,this.children.push(n),this.type===i.Document&&(n.isRoot=!0,n.documentObject=this,this.rootObject=n,this.children))for(r=0,a=(o=this.children).length;r<a;r++)if((t=o[r]).type===i.DocType){t.name=n.name;break}return this}debugInfo(e){var t,n;return null!=(e=e||this.name)||(null!=(t=this.parent)?t.name:void 0)?null==e?"parent: <"+this.parent.name+">":(null!=(n=this.parent)?n.name:void 0)?"node: <"+e+">, parent: <"+this.parent.name+">":"node: <"+e+">":""}ele(e,t,n){return this.element(e,t,n)}nod(e,t,n){return this.node(e,t,n)}txt(e){return this.text(e)}dat(e){return this.cdata(e)}com(e){return this.comment(e)}ins(e,t){return this.instruction(e,t)}doc(){return this.document()}dec(e,t,n){return this.declaration(e,t,n)}e(e,t,n){return this.element(e,t,n)}n(e,t,n){return this.node(e,t,n)}t(e){return this.text(e)}d(e){return this.cdata(e)}c(e){return this.comment(e)}r(e){return this.raw(e)}i(e,t){return this.instruction(e,t)}u(){return this.up()}importXMLBuilder(e){return this.importDocument(e)}attribute(e,t){throw new Error("attribute() applies to element nodes only.")}att(e,t){return this.attribute(e,t)}a(e,t){return this.attribute(e,t)}removeAttribute(e){throw new Error("attribute() applies to element nodes only.")}replaceChild(e,t){throw new Error("This DOM method is not implemented."+this.debugInfo())}removeChild(e){throw new Error("This DOM method is not implemented."+this.debugInfo())}appendChild(e){throw new Error("This DOM method is not implemented."+this.debugInfo())}hasChildNodes(){return 0!==this.children.length}cloneNode(e){throw new Error("This DOM method is not implemented."+this.debugInfo())}normalize(){throw new Error("This DOM method is not implemented."+this.debugInfo())}isSupported(e,t){return!0}hasAttributes(){return 0!==this.attribs.length}compareDocumentPosition(e){var n;return this===e?0:this.document()!==e.document()?(n=t.Disconnected|t.ImplementationSpecific,Math.random()<.5?n|=t.Preceding:n|=t.Following,n):this.isAncestor(e)?t.Contains|t.Preceding:this.isDescendant(e)?t.Contains|t.Following:this.isPreceding(e)?t.Preceding:t.Following}isSameNode(e){throw new Error("This DOM method is not implemented."+this.debugInfo())}lookupPrefix(e){throw new Error("This DOM method is not implemented."+this.debugInfo())}isDefaultNamespace(e){throw new Error("This DOM method is not implemented."+this.debugInfo())}lookupNamespaceURI(e){throw new Error("This DOM method is not implemented."+this.debugInfo())}isEqualNode(e){var t,n,i;if(e.nodeType!==this.nodeType)return!1;if(e.children.length!==this.children.length)return!1;for(t=n=0,i=this.children.length-1;0<=i?n<=i:n>=i;t=0<=i?++n:--n)if(!this.children[t].isEqualNode(e.children[t]))return!1;return!0}getFeature(e,t){throw new Error("This DOM method is not implemented."+this.debugInfo())}setUserData(e,t,n){throw new Error("This DOM method is not implemented."+this.debugInfo())}getUserData(e){throw new Error("This DOM method is not implemented."+this.debugInfo())}contains(e){return!!e&&(e===this||this.isDescendant(e))}isDescendant(e){var t,n,i,r;for(n=0,i=(r=this.children).length;n<i;n++){if(e===(t=r[n]))return!0;if(t.isDescendant(e))return!0}return!1}isAncestor(e){return e.isDescendant(this)}isPreceding(e){var t,n;return t=this.treePosition(e),n=this.treePosition(this),-1!==t&&-1!==n&&t<n}isFollowing(e){var t,n;return t=this.treePosition(e),n=this.treePosition(this),-1!==t&&-1!==n&&t>n}treePosition(e){var t,n;return n=0,t=!1,this.foreachTreeNode(this.document(),function(i){if(n++,!t&&i===e)return t=!0}),t?n:-1}foreachTreeNode(e,t){var n,i,r,a,o;for(e||(e=this.document()),i=0,r=(a=e.children).length;i<r;i++){if(o=t(n=a[i]))return o;if(o=this.foreachTreeNode(n,t))return o}}}return Object.defineProperty(e.prototype,"nodeName",{get:function(){return this.name}}),Object.defineProperty(e.prototype,"nodeType",{get:function(){return this.type}}),Object.defineProperty(e.prototype,"nodeValue",{get:function(){return this.value}}),Object.defineProperty(e.prototype,"parentNode",{get:function(){return this.parent}}),Object.defineProperty(e.prototype,"childNodes",{get:function(){return this.childNodeList&&this.childNodeList.nodes||(this.childNodeList=new c(this.children)),this.childNodeList}}),Object.defineProperty(e.prototype,"firstChild",{get:function(){return this.children[0]||null}}),Object.defineProperty(e.prototype,"lastChild",{get:function(){return this.children[this.children.length-1]||null}}),Object.defineProperty(e.prototype,"previousSibling",{get:function(){var e;return e=this.parent.children.indexOf(this),this.parent.children[e-1]||null}}),Object.defineProperty(e.prototype,"nextSibling",{get:function(){var e;return e=this.parent.children.indexOf(this),this.parent.children[e+1]||null}}),Object.defineProperty(e.prototype,"ownerDocument",{get:function(){return this.document()||null}}),Object.defineProperty(e.prototype,"textContent",{get:function(){var e,t,n,r,a;if(this.nodeType===i.Element||this.nodeType===i.DocumentFragment){for(a="",t=0,n=(r=this.children).length;t<n;t++)(e=r[t]).textContent&&(a+=e.textContent);return a}return null},set:function(e){throw new Error("This DOM method is not implemented."+this.debugInfo())}}),e}.call(this)}).call(this)},function(e,t){(function(){var t,n,i,r,a,o,s,l={}.hasOwnProperty;t=function(e,...t){var n,i,r,o;if(a(Object.assign))Object.assign.apply(null,arguments);else for(n=0,r=t.length;n<r;n++)if(null!=(o=t[n]))for(i in o)l.call(o,i)&&(e[i]=o[i]);return e},a=function(e){return!!e&&"[object Function]"===Object.prototype.toString.call(e)},o=function(e){var t;return!!e&&("function"==(t=typeof e)||"object"===t)},i=function(e){return a(Array.isArray)?Array.isArray(e):"[object Array]"===Object.prototype.toString.call(e)},r=function(e){var t;if(i(e))return!e.length;for(t in e)if(l.call(e,t))return!1;return!0},s=function(e){var t,n;return o(e)&&(n=Object.getPrototypeOf(e))&&(t=n.constructor)&&"function"==typeof t&&t instanceof t&&Function.prototype.toString.call(t)===Function.prototype.toString.call(Object)},n=function(e){return a(e.valueOf)?e.valueOf():e},e.exports.assign=t,e.exports.isFunction=a,e.exports.isObject=o,e.exports.isArray=i,e.exports.isEmpty=r,e.exports.isPlainObject=s,e.exports.getValue=n}).call(this)},function(e,t){var n;n=function(){return this}();try{n=n||Function("return this")()||(0,eval)("this")}catch(e){"object"==typeof window&&(n=window)}e.exports=n},function(e,t,n){(function(){var t;t=n(1),e.exports=function(){class e extends t{constructor(e){super(e),this.value=""}clone(){return Object.create(this)}substringData(e,t){throw new Error("This DOM method is not implemented."+this.debugInfo())}appendData(e){throw new Error("This DOM method is not implemented."+this.debugInfo())}insertData(e,t){throw new Error("This DOM method is not implemented."+this.debugInfo())}deleteData(e,t){throw new Error("This DOM method is not implemented."+this.debugInfo())}replaceData(e,t,n){throw new Error("This DOM method is not implemented."+this.debugInfo())}isEqualNode(e){return!!super.isEqualNode(e)&&e.data===this.data}}return Object.defineProperty(e.prototype,"data",{get:function(){return this.value},set:function(e){return this.value=e||""}}),Object.defineProperty(e.prototype,"length",{get:function(){return this.value.length}}),Object.defineProperty(e.prototype,"textContent",{get:function(){return this.value},set:function(e){return this.value=e||""}}),e}.call(this)}).call(this)},function(e,t){(function(){e.exports={None:0,OpenTag:1,InsideTag:2,CloseTag:3}}).call(this)},function(e,t,n){(function(){var t,i,r,a,o,s,l,u={}.hasOwnProperty;({isObject:l,isFunction:s,getValue:o}=n(2)),a=n(1),t=n(0),i=n(26),r=n(7),e.exports=function(){class e extends a{constructor(e,n,i){var r,a,o,s;if(super(e),null==n)throw new Error("Missing element name. "+this.debugInfo());if(this.name=this.stringify.name(n),this.type=t.Element,this.attribs={},this.schemaTypeInfo=null,null!=i&&this.attribute(i),e.type===t.Document&&(this.isRoot=!0,this.documentObject=e,e.rootObject=this,e.children))for(a=0,o=(s=e.children).length;a<o;a++)if((r=s[a]).type===t.DocType){r.name=this.name;break}}clone(){var e,t,n,i;for(t in(n=Object.create(this)).isRoot&&(n.documentObject=null),n.attribs={},i=this.attribs)u.call(i,t)&&(e=i[t],n.attribs[t]=e.clone());return n.children=[],this.children.forEach(function(e){var t;return(t=e.clone()).parent=n,n.children.push(t)}),n}attribute(e,t){var n,r;if(null!=e&&(e=o(e)),l(e))for(n in e)u.call(e,n)&&(r=e[n],this.attribute(n,r));else s(t)&&(t=t.apply()),this.options.keepNullAttributes&&null==t?this.attribs[e]=new i(this,e,""):null!=t&&(this.attribs[e]=new i(this,e,t));return this}removeAttribute(e){var t,n,i;if(null==e)throw new Error("Missing attribute name. "+this.debugInfo());if(e=o(e),Array.isArray(e))for(n=0,i=e.length;n<i;n++)t=e[n],delete this.attribs[t];else delete this.attribs[e];return this}toString(e){return this.options.writer.element(this,this.options.writer.filterOptions(e))}att(e,t){return this.attribute(e,t)}a(e,t){return this.attribute(e,t)}getAttribute(e){return this.attribs.hasOwnProperty(e)?this.attribs[e].value:null}setAttribute(e,t){throw new Error("This DOM method is not implemented."+this.debugInfo())}getAttributeNode(e){return this.attribs.hasOwnProperty(e)?this.attribs[e]:null}setAttributeNode(e){throw new Error("This DOM method is not implemented."+this.debugInfo())}removeAttributeNode(e){throw new Error("This DOM method is not implemented."+this.debugInfo())}getElementsByTagName(e){throw new Error("This DOM method is not implemented."+this.debugInfo())}getAttributeNS(e,t){throw new Error("This DOM method is not implemented."+this.debugInfo())}setAttributeNS(e,t,n){throw new Error("This DOM method is not implemented."+this.debugInfo())}removeAttributeNS(e,t){throw new Error("This DOM method is not implemented."+this.debugInfo())}getAttributeNodeNS(e,t){throw new Error("This DOM method is not implemented."+this.debugInfo())}setAttributeNodeNS(e){throw new Error("This DOM method is not implemented."+this.debugInfo())}getElementsByTagNameNS(e,t){throw new Error("This DOM method is not implemented."+this.debugInfo())}hasAttribute(e){return this.attribs.hasOwnProperty(e)}hasAttributeNS(e,t){throw new Error("This DOM method is not implemented."+this.debugInfo())}setIdAttribute(e,t){return this.attribs.hasOwnProperty(e)?this.attribs[e].isId:t}setIdAttributeNS(e,t,n){throw new Error("This DOM method is not implemented."+this.debugInfo())}setIdAttributeNode(e,t){throw new Error("This DOM method is not implemented."+this.debugInfo())}getElementsByTagName(e){throw new Error("This DOM method is not implemented."+this.debugInfo())}getElementsByTagNameNS(e,t){throw new Error("This DOM method is not implemented."+this.debugInfo())}getElementsByClassName(e){throw new Error("This DOM method is not implemented."+this.debugInfo())}isEqualNode(e){var t,n,i;if(!super.isEqualNode(e))return!1;if(e.namespaceURI!==this.namespaceURI)return!1;if(e.prefix!==this.prefix)return!1;if(e.localName!==this.localName)return!1;if(e.attribs.length!==this.attribs.length)return!1;for(t=n=0,i=this.attribs.length-1;0<=i?n<=i:n>=i;t=0<=i?++n:--n)if(!this.attribs[t].isEqualNode(e.attribs[t]))return!1;return!0}}return Object.defineProperty(e.prototype,"tagName",{get:function(){return this.name}}),Object.defineProperty(e.prototype,"namespaceURI",{get:function(){return""}}),Object.defineProperty(e.prototype,"prefix",{get:function(){return""}}),Object.defineProperty(e.prototype,"localName",{get:function(){return this.name}}),Object.defineProperty(e.prototype,"id",{get:function(){throw new Error("This DOM method is not implemented."+this.debugInfo())}}),Object.defineProperty(e.prototype,"className",{get:function(){throw new Error("This DOM method is not implemented."+this.debugInfo())}}),Object.defineProperty(e.prototype,"classList",{get:function(){throw new Error("This DOM method is not implemented."+this.debugInfo())}}),Object.defineProperty(e.prototype,"attributes",{get:function(){return this.attributeMap&&this.attributeMap.nodes||(this.attributeMap=new r(this.attribs)),this.attributeMap}}),e}.call(this)}).call(this)},function(e,t){(function(){e.exports=function(){class e{constructor(e){this.nodes=e}clone(){return this.nodes=null}getNamedItem(e){return this.nodes[e]}setNamedItem(e){var t;return t=this.nodes[e.nodeName],this.nodes[e.nodeName]=e,t||null}removeNamedItem(e){var t;return t=this.nodes[e],delete this.nodes[e],t||null}item(e){return this.nodes[Object.keys(this.nodes)[e]]||null}getNamedItemNS(e,t){throw new Error("This DOM method is not implemented.")}setNamedItemNS(e){throw new Error("This DOM method is not implemented.")}removeNamedItemNS(e,t){throw new Error("This DOM method is not implemented.")}}return Object.defineProperty(e.prototype,"length",{get:function(){return Object.keys(this.nodes).length||0}}),e}.call(this)}).call(this)},function(e,t,n){(function(){var t,i;t=n(0),i=n(4),e.exports=class extends i{constructor(e,n){if(super(e),null==n)throw new Error("Missing CDATA text. "+this.debugInfo());this.name="#cdata-section",this.type=t.CData,this.value=this.stringify.cdata(n)}clone(){return Object.create(this)}toString(e){return this.options.writer.cdata(this,this.options.writer.filterOptions(e))}}}).call(this)},function(e,t,n){(function(){var t,i;t=n(0),i=n(4),e.exports=class extends i{constructor(e,n){if(super(e),null==n)throw new Error("Missing comment text. "+this.debugInfo());this.name="#comment",this.type=t.Comment,this.value=this.stringify.comment(n)}clone(){return Object.create(this)}toString(e){return this.options.writer.comment(this,this.options.writer.filterOptions(e))}}}).call(this)},function(e,t,n){(function(){var t,i,r;({isObject:r}=n(2)),i=n(1),t=n(0),e.exports=class extends i{constructor(e,n,i,a){super(e),r(n)&&({version:n,encoding:i,standalone:a}=n),n||(n="1.0"),this.type=t.Declaration,this.version=this.stringify.xmlVersion(n),null!=i&&(this.encoding=this.stringify.xmlEncoding(i)),null!=a&&(this.standalone=this.stringify.xmlStandalone(a))}toString(e){return this.options.writer.declaration(this,this.options.writer.filterOptions(e))}}}).call(this)},function(e,t,n){(function(){var t,i,r,a,o,s,l,u;({isObject:u}=n(2)),l=n(1),t=n(0),i=n(12),a=n(13),r=n(14),o=n(15),s=n(7),e.exports=function(){class e extends l{constructor(e,n,i){var r,a,o,s;if(super(e),this.type=t.DocType,e.children)for(a=0,o=(s=e.children).length;a<o;a++)if((r=s[a]).type===t.Element){this.name=r.name;break}this.documentObject=e,u(n)&&({pubID:n,sysID:i}=n),null==i&&([i,n]=[n,i]),null!=n&&(this.pubID=this.stringify.dtdPubID(n)),null!=i&&(this.sysID=this.stringify.dtdSysID(i))}element(e,t){var n;return n=new r(this,e,t),this.children.push(n),this}attList(e,t,n,r,a){var o;return o=new i(this,e,t,n,r,a),this.children.push(o),this}entity(e,t){var n;return n=new a(this,!1,e,t),this.children.push(n),this}pEntity(e,t){var n;return n=new a(this,!0,e,t),this.children.push(n),this}notation(e,t){var n;return n=new o(this,e,t),this.children.push(n),this}toString(e){return this.options.writer.docType(this,this.options.writer.filterOptions(e))}ele(e,t){return this.element(e,t)}att(e,t,n,i,r){return this.attList(e,t,n,i,r)}ent(e,t){return this.entity(e,t)}pent(e,t){return this.pEntity(e,t)}not(e,t){return this.notation(e,t)}up(){return this.root()||this.documentObject}isEqualNode(e){return!!super.isEqualNode(e)&&e.name===this.name&&e.publicId===this.publicId&&e.systemId===this.systemId}}return Object.defineProperty(e.prototype,"entities",{get:function(){var e,n,i,r,a;for(r={},n=0,i=(a=this.children).length;n<i;n++)(e=a[n]).type!==t.EntityDeclaration||e.pe||(r[e.name]=e);return new s(r)}}),Object.defineProperty(e.prototype,"notations",{get:function(){var e,n,i,r,a;for(r={},n=0,i=(a=this.children).length;n<i;n++)(e=a[n]).type===t.NotationDeclaration&&(r[e.name]=e);return new s(r)}}),Object.defineProperty(e.prototype,"publicId",{get:function(){return this.pubID}}),Object.defineProperty(e.prototype,"systemId",{get:function(){return this.sysID}}),Object.defineProperty(e.prototype,"internalSubset",{get:function(){throw new Error("This DOM method is not implemented."+this.debugInfo())}}),e}.call(this)}).call(this)},function(e,t,n){(function(){var t,i;i=n(1),t=n(0),e.exports=class extends i{constructor(e,n,i,r,a,o){if(super(e),null==n)throw new Error("Missing DTD element name. "+this.debugInfo());if(null==i)throw new Error("Missing DTD attribute name. "+this.debugInfo(n));if(!r)throw new Error("Missing DTD attribute type. "+this.debugInfo(n));if(!a)throw new Error("Missing DTD attribute default. "+this.debugInfo(n));if(0!==a.indexOf("#")&&(a="#"+a),!a.match(/^(#REQUIRED|#IMPLIED|#FIXED|#DEFAULT)$/))throw new Error("Invalid default value type; expected: #REQUIRED, #IMPLIED, #FIXED or #DEFAULT. "+this.debugInfo(n));if(o&&!a.match(/^(#FIXED|#DEFAULT)$/))throw new Error("Default value only applies to #FIXED or #DEFAULT. "+this.debugInfo(n));this.elementName=this.stringify.name(n),this.type=t.AttributeDeclaration,this.attributeName=this.stringify.name(i),this.attributeType=this.stringify.dtdAttType(r),o&&(this.defaultValue=this.stringify.dtdAttDefault(o)),this.defaultValueType=a}toString(e){return this.options.writer.dtdAttList(this,this.options.writer.filterOptions(e))}}}).call(this)},function(e,t,n){(function(){var t,i,r;({isObject:r}=n(2)),i=n(1),t=n(0),e.exports=function(){class e extends i{constructor(e,n,i,a){if(super(e),null==i)throw new Error("Missing DTD entity name. "+this.debugInfo(i));if(null==a)throw new Error("Missing DTD entity value. "+this.debugInfo(i));if(this.pe=!!n,this.name=this.stringify.name(i),this.type=t.EntityDeclaration,r(a)){if(!a.pubID&&!a.sysID)throw new Error("Public and/or system identifiers are required for an external entity. "+this.debugInfo(i));if(a.pubID&&!a.sysID)throw new Error("System identifier is required for a public external entity. "+this.debugInfo(i));if(this.internal=!1,null!=a.pubID&&(this.pubID=this.stringify.dtdPubID(a.pubID)),null!=a.sysID&&(this.sysID=this.stringify.dtdSysID(a.sysID)),null!=a.nData&&(this.nData=this.stringify.dtdNData(a.nData)),this.pe&&this.nData)throw new Error("Notation declaration is not allowed in a parameter entity. "+this.debugInfo(i))}else this.value=this.stringify.dtdEntityValue(a),this.internal=!0}toString(e){return this.options.writer.dtdEntity(this,this.options.writer.filterOptions(e))}}return Object.defineProperty(e.prototype,"publicId",{get:function(){return this.pubID}}),Object.defineProperty(e.prototype,"systemId",{get:function(){return this.sysID}}),Object.defineProperty(e.prototype,"notationName",{get:function(){return this.nData||null}}),Object.defineProperty(e.prototype,"inputEncoding",{get:function(){return null}}),Object.defineProperty(e.prototype,"xmlEncoding",{get:function(){return null}}),Object.defineProperty(e.prototype,"xmlVersion",{get:function(){return null}}),e}.call(this)}).call(this)},function(e,t,n){(function(){var t,i;i=n(1),t=n(0),e.exports=class extends i{constructor(e,n,i){if(super(e),null==n)throw new Error("Missing DTD element name. "+this.debugInfo());i||(i="(#PCDATA)"),Array.isArray(i)&&(i="("+i.join(",")+")"),this.name=this.stringify.name(n),this.type=t.ElementDeclaration,this.value=this.stringify.dtdElementValue(i)}toString(e){return this.options.writer.dtdElement(this,this.options.writer.filterOptions(e))}}}).call(this)},function(e,t,n){(function(){var t,i;i=n(1),t=n(0),e.exports=function(){class e extends i{constructor(e,n,i){if(super(e),null==n)throw new Error("Missing DTD notation name. "+this.debugInfo(n));if(!i.pubID&&!i.sysID)throw new Error("Public or system identifiers are required for an external entity. "+this.debugInfo(n));this.name=this.stringify.name(n),this.type=t.NotationDeclaration,null!=i.pubID&&(this.pubID=this.stringify.dtdPubID(i.pubID)),null!=i.sysID&&(this.sysID=this.stringify.dtdSysID(i.sysID))}toString(e){return this.options.writer.dtdNotation(this,this.options.writer.filterOptions(e))}}return Object.defineProperty(e.prototype,"publicId",{get:function(){return this.pubID}}),Object.defineProperty(e.prototype,"systemId",{get:function(){return this.sysID}}),e}.call(this)}).call(this)},function(e,t,n){(function(){var t,i;t=n(0),i=n(1),e.exports=class extends i{constructor(e,n){if(super(e),null==n)throw new Error("Missing raw text. "+this.debugInfo());this.type=t.Raw,this.value=this.stringify.raw(n)}clone(){return Object.create(this)}toString(e){return this.options.writer.raw(this,this.options.writer.filterOptions(e))}}}).call(this)},function(e,t,n){(function(){var t,i;t=n(0),i=n(4),e.exports=function(){class e extends i{constructor(e,n){if(super(e),null==n)throw new Error("Missing element text. "+this.debugInfo());this.name="#text",this.type=t.Text,this.value=this.stringify.text(n)}clone(){return Object.create(this)}toString(e){return this.options.writer.text(this,this.options.writer.filterOptions(e))}splitText(e){throw new Error("This DOM method is not implemented."+this.debugInfo())}replaceWholeText(e){throw new Error("This DOM method is not implemented."+this.debugInfo())}}return Object.defineProperty(e.prototype,"isElementContentWhitespace",{get:function(){throw new Error("This DOM method is not implemented."+this.debugInfo())}}),Object.defineProperty(e.prototype,"wholeText",{get:function(){var e,t,n;for(n="",t=this.previousSibling;t;)n=t.data+n,t=t.previousSibling;for(n+=this.data,e=this.nextSibling;e;)n+=e.data,e=e.nextSibling;return n}}),e}.call(this)}).call(this)},function(e,t,n){(function(){var t,i;t=n(0),i=n(4),e.exports=class extends i{constructor(e,n,i){if(super(e),null==n)throw new Error("Missing instruction target. "+this.debugInfo());this.type=t.ProcessingInstruction,this.target=this.stringify.insTarget(n),this.name=this.target,i&&(this.value=this.stringify.insValue(i))}clone(){return Object.create(this)}toString(e){return this.options.writer.processingInstruction(this,this.options.writer.filterOptions(e))}isEqualNode(e){return!!super.isEqualNode(e)&&e.target===this.target}}}).call(this)},function(e,t,n){(function(){var t;t=n(29),e.exports=class extends t{constructor(e){super(e)}document(e,t){var n,i,r,a,o;for(t=this.filterOptions(t),a="",i=0,r=(o=e.children).length;i<r;i++)n=o[i],a+=this.writeChildNode(n,t,0);return t.pretty&&a.slice(-t.newline.length)===t.newline&&(a=a.slice(0,-t.newline.length)),a}}}).call(this)},function(e,t,n){var i;
/*!
 * jQuery JavaScript Library v3.4.0
 * https://jquery.com/
 *
 * Includes Sizzle.js
 * https://sizzlejs.com/
 *
 * Copyright JS Foundation and other contributors
 * Released under the MIT license
 * https://jquery.org/license
 *
 * Date: 2019-04-10T19:48Z
 */
/*!
 * jQuery JavaScript Library v3.4.0
 * https://jquery.com/
 *
 * Includes Sizzle.js
 * https://sizzlejs.com/
 *
 * Copyright JS Foundation and other contributors
 * Released under the MIT license
 * https://jquery.org/license
 *
 * Date: 2019-04-10T19:48Z
 */!function(t,n){"use strict";"object"==typeof e&&"object"==typeof e.exports?e.exports=t.document?n(t,!0):function(e){if(!e.document)throw new Error("jQuery requires a window with a document");return n(e)}:n(t)}("undefined"!=typeof window?window:this,function(n,r){"use strict";var a=[],o=n.document,s=Object.getPrototypeOf,l=a.slice,u=a.concat,c=a.push,d=a.indexOf,h={},p=h.toString,f=h.hasOwnProperty,g=f.toString,m=g.call(Object),v={},y=function(e){return"function"==typeof e&&"number"!=typeof e.nodeType},b=function(e){return null!=e&&e===e.window},_={type:!0,src:!0,nonce:!0,noModule:!0};function T(e,t,n){var i,r,a=(n=n||o).createElement("script");if(a.text=e,t)for(i in _)(r=t[i]||t.getAttribute&&t.getAttribute(i))&&a.setAttribute(i,r);n.head.appendChild(a).parentNode.removeChild(a)}function E(e){return null==e?e+"":"object"==typeof e||"function"==typeof e?h[p.call(e)]||"object":typeof e}var C=function(e,t){return new C.fn.init(e,t)},w=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g;function k(e){var t=!!e&&"length"in e&&e.length,n=E(e);return!y(e)&&!b(e)&&("array"===n||0===t||"number"==typeof t&&t>0&&t-1 in e)}C.fn=C.prototype={jquery:"3.4.0",constructor:C,length:0,toArray:function(){return l.call(this)},get:function(e){return null==e?l.call(this):e<0?this[e+this.length]:this[e]},pushStack:function(e){var t=C.merge(this.constructor(),e);return t.prevObject=this,t},each:function(e){return C.each(this,e)},map:function(e){return this.pushStack(C.map(this,function(t,n){return e.call(t,n,t)}))},slice:function(){return this.pushStack(l.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(e){var t=this.length,n=+e+(e<0?t:0);return this.pushStack(n>=0&&n<t?[this[n]]:[])},end:function(){return this.prevObject||this.constructor()},push:c,sort:a.sort,splice:a.splice},C.extend=C.fn.extend=function(){var e,t,n,i,r,a,o=arguments[0]||{},s=1,l=arguments.length,u=!1;for("boolean"==typeof o&&(u=o,o=arguments[s]||{},s++),"object"==typeof o||y(o)||(o={}),s===l&&(o=this,s--);s<l;s++)if(null!=(e=arguments[s]))for(t in e)i=e[t],"__proto__"!==t&&o!==i&&(u&&i&&(C.isPlainObject(i)||(r=Array.isArray(i)))?(n=o[t],a=r&&!Array.isArray(n)?[]:r||C.isPlainObject(n)?n:{},r=!1,o[t]=C.extend(u,a,i)):void 0!==i&&(o[t]=i));return o},C.extend({expando:"jQuery"+("3.4.0"+Math.random()).replace(/\D/g,""),isReady:!0,error:function(e){throw new Error(e)},noop:function(){},isPlainObject:function(e){var t,n;return!(!e||"[object Object]"!==p.call(e)||(t=s(e))&&("function"!=typeof(n=f.call(t,"constructor")&&t.constructor)||g.call(n)!==m))},isEmptyObject:function(e){var t;for(t in e)return!1;return!0},globalEval:function(e,t){T(e,{nonce:t&&t.nonce})},each:function(e,t){var n,i=0;if(k(e))for(n=e.length;i<n&&!1!==t.call(e[i],i,e[i]);i++);else for(i in e)if(!1===t.call(e[i],i,e[i]))break;return e},trim:function(e){return null==e?"":(e+"").replace(w,"")},makeArray:function(e,t){var n=t||[];return null!=e&&(k(Object(e))?C.merge(n,"string"==typeof e?[e]:e):c.call(n,e)),n},inArray:function(e,t,n){return null==t?-1:d.call(t,e,n)},merge:function(e,t){for(var n=+t.length,i=0,r=e.length;i<n;i++)e[r++]=t[i];return e.length=r,e},grep:function(e,t,n){for(var i=[],r=0,a=e.length,o=!n;r<a;r++)!t(e[r],r)!==o&&i.push(e[r]);return i},map:function(e,t,n){var i,r,a=0,o=[];if(k(e))for(i=e.length;a<i;a++)null!=(r=t(e[a],a,n))&&o.push(r);else for(a in e)null!=(r=t(e[a],a,n))&&o.push(r);return u.apply([],o)},guid:1,support:v}),"function"==typeof Symbol&&(C.fn[Symbol.iterator]=a[Symbol.iterator]),C.each("Boolean Number String Function Array Date RegExp Object Error Symbol".split(" "),function(e,t){h["[object "+t+"]"]=t.toLowerCase()});var S=
/*!
 * Sizzle CSS Selector Engine v2.3.4
 * https://sizzlejs.com/
 *
 * Copyright JS Foundation and other contributors
 * Released under the MIT license
 * https://js.foundation/
 *
 * Date: 2019-04-08
 */
function(e){var t,n,i,r,a,o,s,l,u,c,d,h,p,f,g,m,v,y,b,_="sizzle"+1*new Date,T=e.document,E=0,C=0,w=le(),k=le(),S=le(),I=le(),O=function(e,t){return e===t&&(d=!0),0},D={}.hasOwnProperty,R=[],x=R.pop,A=R.push,P=R.push,L=R.slice,N=function(e,t){for(var n=0,i=e.length;n<i;n++)if(e[n]===t)return n;return-1},M="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",K="[\\x20\\t\\r\\n\\f]",$="(?:\\\\.|[\\w-]|[^\0-\\xa0])+",j="\\["+K+"*("+$+")(?:"+K+"*([*^$|!~]?=)"+K+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+$+"))|)"+K+"*\\]",B=":("+$+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+j+")*)|.*)\\)|)",F=new RegExp(K+"+","g"),U=new RegExp("^"+K+"+|((?:^|[^\\\\])(?:\\\\.)*)"+K+"+$","g"),V=new RegExp("^"+K+"*,"+K+"*"),q=new RegExp("^"+K+"*([>+~]|"+K+")"+K+"*"),H=new RegExp(K+"|>"),z=new RegExp(B),W=new RegExp("^"+$+"$"),G={ID:new RegExp("^#("+$+")"),CLASS:new RegExp("^\\.("+$+")"),TAG:new RegExp("^("+$+"|[*])"),ATTR:new RegExp("^"+j),PSEUDO:new RegExp("^"+B),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+K+"*(even|odd|(([+-]|)(\\d*)n|)"+K+"*(?:([+-]|)"+K+"*(\\d+)|))"+K+"*\\)|)","i"),bool:new RegExp("^(?:"+M+")$","i"),needsContext:new RegExp("^"+K+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+K+"*((?:-\\d)?\\d*)"+K+"*\\)|)(?=[^-]|$)","i")},X=/HTML$/i,Y=/^(?:input|select|textarea|button)$/i,Q=/^h\d$/i,J=/^[^{]+\{\s*\[native \w/,Z=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,ee=/[+~]/,te=new RegExp("\\\\([\\da-f]{1,6}"+K+"?|("+K+")|.)","ig"),ne=function(e,t,n){var i="0x"+t-65536;return i!=i||n?t:i<0?String.fromCharCode(i+65536):String.fromCharCode(i>>10|55296,1023&i|56320)},ie=/([\0-\x1f\x7f]|^-?\d)|^-$|[^\0-\x1f\x7f-\uFFFF\w-]/g,re=function(e,t){return t?"\0"===e?"�":e.slice(0,-1)+"\\"+e.charCodeAt(e.length-1).toString(16)+" ":"\\"+e},ae=function(){h()},oe=_e(function(e){return!0===e.disabled&&"fieldset"===e.nodeName.toLowerCase()},{dir:"parentNode",next:"legend"});try{P.apply(R=L.call(T.childNodes),T.childNodes),R[T.childNodes.length].nodeType}catch(e){P={apply:R.length?function(e,t){A.apply(e,L.call(t))}:function(e,t){for(var n=e.length,i=0;e[n++]=t[i++];);e.length=n-1}}}function se(e,t,i,r){var a,s,u,c,d,f,v,y=t&&t.ownerDocument,E=t?t.nodeType:9;if(i=i||[],"string"!=typeof e||!e||1!==E&&9!==E&&11!==E)return i;if(!r&&((t?t.ownerDocument||t:T)!==p&&h(t),t=t||p,g)){if(11!==E&&(d=Z.exec(e)))if(a=d[1]){if(9===E){if(!(u=t.getElementById(a)))return i;if(u.id===a)return i.push(u),i}else if(y&&(u=y.getElementById(a))&&b(t,u)&&u.id===a)return i.push(u),i}else{if(d[2])return P.apply(i,t.getElementsByTagName(e)),i;if((a=d[3])&&n.getElementsByClassName&&t.getElementsByClassName)return P.apply(i,t.getElementsByClassName(a)),i}if(n.qsa&&!I[e+" "]&&(!m||!m.test(e))&&(1!==E||"object"!==t.nodeName.toLowerCase())){if(v=e,y=t,1===E&&H.test(e)){for((c=t.getAttribute("id"))?c=c.replace(ie,re):t.setAttribute("id",c=_),s=(f=o(e)).length;s--;)f[s]="#"+c+" "+be(f[s]);v=f.join(","),y=ee.test(e)&&ve(t.parentNode)||t}try{return P.apply(i,y.querySelectorAll(v)),i}catch(t){I(e,!0)}finally{c===_&&t.removeAttribute("id")}}}return l(e.replace(U,"$1"),t,i,r)}function le(){var e=[];return function t(n,r){return e.push(n+" ")>i.cacheLength&&delete t[e.shift()],t[n+" "]=r}}function ue(e){return e[_]=!0,e}function ce(e){var t=p.createElement("fieldset");try{return!!e(t)}catch(e){return!1}finally{t.parentNode&&t.parentNode.removeChild(t),t=null}}function de(e,t){for(var n=e.split("|"),r=n.length;r--;)i.attrHandle[n[r]]=t}function he(e,t){var n=t&&e,i=n&&1===e.nodeType&&1===t.nodeType&&e.sourceIndex-t.sourceIndex;if(i)return i;if(n)for(;n=n.nextSibling;)if(n===t)return-1;return e?1:-1}function pe(e){return function(t){return"input"===t.nodeName.toLowerCase()&&t.type===e}}function fe(e){return function(t){var n=t.nodeName.toLowerCase();return("input"===n||"button"===n)&&t.type===e}}function ge(e){return function(t){return"form"in t?t.parentNode&&!1===t.disabled?"label"in t?"label"in t.parentNode?t.parentNode.disabled===e:t.disabled===e:t.isDisabled===e||t.isDisabled!==!e&&oe(t)===e:t.disabled===e:"label"in t&&t.disabled===e}}function me(e){return ue(function(t){return t=+t,ue(function(n,i){for(var r,a=e([],n.length,t),o=a.length;o--;)n[r=a[o]]&&(n[r]=!(i[r]=n[r]))})})}function ve(e){return e&&void 0!==e.getElementsByTagName&&e}for(t in n=se.support={},a=se.isXML=function(e){var t=e.namespaceURI,n=(e.ownerDocument||e).documentElement;return!X.test(t||n&&n.nodeName||"HTML")},h=se.setDocument=function(e){var t,r,o=e?e.ownerDocument||e:T;return o!==p&&9===o.nodeType&&o.documentElement?(f=(p=o).documentElement,g=!a(p),T!==p&&(r=p.defaultView)&&r.top!==r&&(r.addEventListener?r.addEventListener("unload",ae,!1):r.attachEvent&&r.attachEvent("onunload",ae)),n.attributes=ce(function(e){return e.className="i",!e.getAttribute("className")}),n.getElementsByTagName=ce(function(e){return e.appendChild(p.createComment("")),!e.getElementsByTagName("*").length}),n.getElementsByClassName=J.test(p.getElementsByClassName),n.getById=ce(function(e){return f.appendChild(e).id=_,!p.getElementsByName||!p.getElementsByName(_).length}),n.getById?(i.filter.ID=function(e){var t=e.replace(te,ne);return function(e){return e.getAttribute("id")===t}},i.find.ID=function(e,t){if(void 0!==t.getElementById&&g){var n=t.getElementById(e);return n?[n]:[]}}):(i.filter.ID=function(e){var t=e.replace(te,ne);return function(e){var n=void 0!==e.getAttributeNode&&e.getAttributeNode("id");return n&&n.value===t}},i.find.ID=function(e,t){if(void 0!==t.getElementById&&g){var n,i,r,a=t.getElementById(e);if(a){if((n=a.getAttributeNode("id"))&&n.value===e)return[a];for(r=t.getElementsByName(e),i=0;a=r[i++];)if((n=a.getAttributeNode("id"))&&n.value===e)return[a]}return[]}}),i.find.TAG=n.getElementsByTagName?function(e,t){return void 0!==t.getElementsByTagName?t.getElementsByTagName(e):n.qsa?t.querySelectorAll(e):void 0}:function(e,t){var n,i=[],r=0,a=t.getElementsByTagName(e);if("*"===e){for(;n=a[r++];)1===n.nodeType&&i.push(n);return i}return a},i.find.CLASS=n.getElementsByClassName&&function(e,t){if(void 0!==t.getElementsByClassName&&g)return t.getElementsByClassName(e)},v=[],m=[],(n.qsa=J.test(p.querySelectorAll))&&(ce(function(e){f.appendChild(e).innerHTML="<a id='"+_+"'></a><select id='"+_+"-\r\\' msallowcapture=''><option selected=''></option></select>",e.querySelectorAll("[msallowcapture^='']").length&&m.push("[*^$]="+K+"*(?:''|\"\")"),e.querySelectorAll("[selected]").length||m.push("\\["+K+"*(?:value|"+M+")"),e.querySelectorAll("[id~="+_+"-]").length||m.push("~="),e.querySelectorAll(":checked").length||m.push(":checked"),e.querySelectorAll("a#"+_+"+*").length||m.push(".#.+[+~]")}),ce(function(e){e.innerHTML="<a href='' disabled='disabled'></a><select disabled='disabled'><option/></select>";var t=p.createElement("input");t.setAttribute("type","hidden"),e.appendChild(t).setAttribute("name","D"),e.querySelectorAll("[name=d]").length&&m.push("name"+K+"*[*^$|!~]?="),2!==e.querySelectorAll(":enabled").length&&m.push(":enabled",":disabled"),f.appendChild(e).disabled=!0,2!==e.querySelectorAll(":disabled").length&&m.push(":enabled",":disabled"),e.querySelectorAll("*,:x"),m.push(",.*:")})),(n.matchesSelector=J.test(y=f.matches||f.webkitMatchesSelector||f.mozMatchesSelector||f.oMatchesSelector||f.msMatchesSelector))&&ce(function(e){n.disconnectedMatch=y.call(e,"*"),y.call(e,"[s!='']:x"),v.push("!=",B)}),m=m.length&&new RegExp(m.join("|")),v=v.length&&new RegExp(v.join("|")),t=J.test(f.compareDocumentPosition),b=t||J.test(f.contains)?function(e,t){var n=9===e.nodeType?e.documentElement:e,i=t&&t.parentNode;return e===i||!(!i||1!==i.nodeType||!(n.contains?n.contains(i):e.compareDocumentPosition&&16&e.compareDocumentPosition(i)))}:function(e,t){if(t)for(;t=t.parentNode;)if(t===e)return!0;return!1},O=t?function(e,t){if(e===t)return d=!0,0;var i=!e.compareDocumentPosition-!t.compareDocumentPosition;return i||(1&(i=(e.ownerDocument||e)===(t.ownerDocument||t)?e.compareDocumentPosition(t):1)||!n.sortDetached&&t.compareDocumentPosition(e)===i?e===p||e.ownerDocument===T&&b(T,e)?-1:t===p||t.ownerDocument===T&&b(T,t)?1:c?N(c,e)-N(c,t):0:4&i?-1:1)}:function(e,t){if(e===t)return d=!0,0;var n,i=0,r=e.parentNode,a=t.parentNode,o=[e],s=[t];if(!r||!a)return e===p?-1:t===p?1:r?-1:a?1:c?N(c,e)-N(c,t):0;if(r===a)return he(e,t);for(n=e;n=n.parentNode;)o.unshift(n);for(n=t;n=n.parentNode;)s.unshift(n);for(;o[i]===s[i];)i++;return i?he(o[i],s[i]):o[i]===T?-1:s[i]===T?1:0},p):p},se.matches=function(e,t){return se(e,null,null,t)},se.matchesSelector=function(e,t){if((e.ownerDocument||e)!==p&&h(e),n.matchesSelector&&g&&!I[t+" "]&&(!v||!v.test(t))&&(!m||!m.test(t)))try{var i=y.call(e,t);if(i||n.disconnectedMatch||e.document&&11!==e.document.nodeType)return i}catch(e){I(t,!0)}return se(t,p,null,[e]).length>0},se.contains=function(e,t){return(e.ownerDocument||e)!==p&&h(e),b(e,t)},se.attr=function(e,t){(e.ownerDocument||e)!==p&&h(e);var r=i.attrHandle[t.toLowerCase()],a=r&&D.call(i.attrHandle,t.toLowerCase())?r(e,t,!g):void 0;return void 0!==a?a:n.attributes||!g?e.getAttribute(t):(a=e.getAttributeNode(t))&&a.specified?a.value:null},se.escape=function(e){return(e+"").replace(ie,re)},se.error=function(e){throw new Error("Syntax error, unrecognized expression: "+e)},se.uniqueSort=function(e){var t,i=[],r=0,a=0;if(d=!n.detectDuplicates,c=!n.sortStable&&e.slice(0),e.sort(O),d){for(;t=e[a++];)t===e[a]&&(r=i.push(a));for(;r--;)e.splice(i[r],1)}return c=null,e},r=se.getText=function(e){var t,n="",i=0,a=e.nodeType;if(a){if(1===a||9===a||11===a){if("string"==typeof e.textContent)return e.textContent;for(e=e.firstChild;e;e=e.nextSibling)n+=r(e)}else if(3===a||4===a)return e.nodeValue}else for(;t=e[i++];)n+=r(t);return n},(i=se.selectors={cacheLength:50,createPseudo:ue,match:G,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(e){return e[1]=e[1].replace(te,ne),e[3]=(e[3]||e[4]||e[5]||"").replace(te,ne),"~="===e[2]&&(e[3]=" "+e[3]+" "),e.slice(0,4)},CHILD:function(e){return e[1]=e[1].toLowerCase(),"nth"===e[1].slice(0,3)?(e[3]||se.error(e[0]),e[4]=+(e[4]?e[5]+(e[6]||1):2*("even"===e[3]||"odd"===e[3])),e[5]=+(e[7]+e[8]||"odd"===e[3])):e[3]&&se.error(e[0]),e},PSEUDO:function(e){var t,n=!e[6]&&e[2];return G.CHILD.test(e[0])?null:(e[3]?e[2]=e[4]||e[5]||"":n&&z.test(n)&&(t=o(n,!0))&&(t=n.indexOf(")",n.length-t)-n.length)&&(e[0]=e[0].slice(0,t),e[2]=n.slice(0,t)),e.slice(0,3))}},filter:{TAG:function(e){var t=e.replace(te,ne).toLowerCase();return"*"===e?function(){return!0}:function(e){return e.nodeName&&e.nodeName.toLowerCase()===t}},CLASS:function(e){var t=w[e+" "];return t||(t=new RegExp("(^|"+K+")"+e+"("+K+"|$)"))&&w(e,function(e){return t.test("string"==typeof e.className&&e.className||void 0!==e.getAttribute&&e.getAttribute("class")||"")})},ATTR:function(e,t,n){return function(i){var r=se.attr(i,e);return null==r?"!="===t:!t||(r+="","="===t?r===n:"!="===t?r!==n:"^="===t?n&&0===r.indexOf(n):"*="===t?n&&r.indexOf(n)>-1:"$="===t?n&&r.slice(-n.length)===n:"~="===t?(" "+r.replace(F," ")+" ").indexOf(n)>-1:"|="===t&&(r===n||r.slice(0,n.length+1)===n+"-"))}},CHILD:function(e,t,n,i,r){var a="nth"!==e.slice(0,3),o="last"!==e.slice(-4),s="of-type"===t;return 1===i&&0===r?function(e){return!!e.parentNode}:function(t,n,l){var u,c,d,h,p,f,g=a!==o?"nextSibling":"previousSibling",m=t.parentNode,v=s&&t.nodeName.toLowerCase(),y=!l&&!s,b=!1;if(m){if(a){for(;g;){for(h=t;h=h[g];)if(s?h.nodeName.toLowerCase()===v:1===h.nodeType)return!1;f=g="only"===e&&!f&&"nextSibling"}return!0}if(f=[o?m.firstChild:m.lastChild],o&&y){for(b=(p=(u=(c=(d=(h=m)[_]||(h[_]={}))[h.uniqueID]||(d[h.uniqueID]={}))[e]||[])[0]===E&&u[1])&&u[2],h=p&&m.childNodes[p];h=++p&&h&&h[g]||(b=p=0)||f.pop();)if(1===h.nodeType&&++b&&h===t){c[e]=[E,p,b];break}}else if(y&&(b=p=(u=(c=(d=(h=t)[_]||(h[_]={}))[h.uniqueID]||(d[h.uniqueID]={}))[e]||[])[0]===E&&u[1]),!1===b)for(;(h=++p&&h&&h[g]||(b=p=0)||f.pop())&&((s?h.nodeName.toLowerCase()!==v:1!==h.nodeType)||!++b||(y&&((c=(d=h[_]||(h[_]={}))[h.uniqueID]||(d[h.uniqueID]={}))[e]=[E,b]),h!==t)););return(b-=r)===i||b%i==0&&b/i>=0}}},PSEUDO:function(e,t){var n,r=i.pseudos[e]||i.setFilters[e.toLowerCase()]||se.error("unsupported pseudo: "+e);return r[_]?r(t):r.length>1?(n=[e,e,"",t],i.setFilters.hasOwnProperty(e.toLowerCase())?ue(function(e,n){for(var i,a=r(e,t),o=a.length;o--;)e[i=N(e,a[o])]=!(n[i]=a[o])}):function(e){return r(e,0,n)}):r}},pseudos:{not:ue(function(e){var t=[],n=[],i=s(e.replace(U,"$1"));return i[_]?ue(function(e,t,n,r){for(var a,o=i(e,null,r,[]),s=e.length;s--;)(a=o[s])&&(e[s]=!(t[s]=a))}):function(e,r,a){return t[0]=e,i(t,null,a,n),t[0]=null,!n.pop()}}),has:ue(function(e){return function(t){return se(e,t).length>0}}),contains:ue(function(e){return e=e.replace(te,ne),function(t){return(t.textContent||r(t)).indexOf(e)>-1}}),lang:ue(function(e){return W.test(e||"")||se.error("unsupported lang: "+e),e=e.replace(te,ne).toLowerCase(),function(t){var n;do{if(n=g?t.lang:t.getAttribute("xml:lang")||t.getAttribute("lang"))return(n=n.toLowerCase())===e||0===n.indexOf(e+"-")}while((t=t.parentNode)&&1===t.nodeType);return!1}}),target:function(t){var n=e.location&&e.location.hash;return n&&n.slice(1)===t.id},root:function(e){return e===f},focus:function(e){return e===p.activeElement&&(!p.hasFocus||p.hasFocus())&&!!(e.type||e.href||~e.tabIndex)},enabled:ge(!1),disabled:ge(!0),checked:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&!!e.checked||"option"===t&&!!e.selected},selected:function(e){return e.parentNode&&e.parentNode.selectedIndex,!0===e.selected},empty:function(e){for(e=e.firstChild;e;e=e.nextSibling)if(e.nodeType<6)return!1;return!0},parent:function(e){return!i.pseudos.empty(e)},header:function(e){return Q.test(e.nodeName)},input:function(e){return Y.test(e.nodeName)},button:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&"button"===e.type||"button"===t},text:function(e){var t;return"input"===e.nodeName.toLowerCase()&&"text"===e.type&&(null==(t=e.getAttribute("type"))||"text"===t.toLowerCase())},first:me(function(){return[0]}),last:me(function(e,t){return[t-1]}),eq:me(function(e,t,n){return[n<0?n+t:n]}),even:me(function(e,t){for(var n=0;n<t;n+=2)e.push(n);return e}),odd:me(function(e,t){for(var n=1;n<t;n+=2)e.push(n);return e}),lt:me(function(e,t,n){for(var i=n<0?n+t:n>t?t:n;--i>=0;)e.push(i);return e}),gt:me(function(e,t,n){for(var i=n<0?n+t:n;++i<t;)e.push(i);return e})}}).pseudos.nth=i.pseudos.eq,{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})i.pseudos[t]=pe(t);for(t in{submit:!0,reset:!0})i.pseudos[t]=fe(t);function ye(){}function be(e){for(var t=0,n=e.length,i="";t<n;t++)i+=e[t].value;return i}function _e(e,t,n){var i=t.dir,r=t.next,a=r||i,o=n&&"parentNode"===a,s=C++;return t.first?function(t,n,r){for(;t=t[i];)if(1===t.nodeType||o)return e(t,n,r);return!1}:function(t,n,l){var u,c,d,h=[E,s];if(l){for(;t=t[i];)if((1===t.nodeType||o)&&e(t,n,l))return!0}else for(;t=t[i];)if(1===t.nodeType||o)if(c=(d=t[_]||(t[_]={}))[t.uniqueID]||(d[t.uniqueID]={}),r&&r===t.nodeName.toLowerCase())t=t[i]||t;else{if((u=c[a])&&u[0]===E&&u[1]===s)return h[2]=u[2];if(c[a]=h,h[2]=e(t,n,l))return!0}return!1}}function Te(e){return e.length>1?function(t,n,i){for(var r=e.length;r--;)if(!e[r](t,n,i))return!1;return!0}:e[0]}function Ee(e,t,n,i,r){for(var a,o=[],s=0,l=e.length,u=null!=t;s<l;s++)(a=e[s])&&(n&&!n(a,i,r)||(o.push(a),u&&t.push(s)));return o}function Ce(e,t,n,i,r,a){return i&&!i[_]&&(i=Ce(i)),r&&!r[_]&&(r=Ce(r,a)),ue(function(a,o,s,l){var u,c,d,h=[],p=[],f=o.length,g=a||function(e,t,n){for(var i=0,r=t.length;i<r;i++)se(e,t[i],n);return n}(t||"*",s.nodeType?[s]:s,[]),m=!e||!a&&t?g:Ee(g,h,e,s,l),v=n?r||(a?e:f||i)?[]:o:m;if(n&&n(m,v,s,l),i)for(u=Ee(v,p),i(u,[],s,l),c=u.length;c--;)(d=u[c])&&(v[p[c]]=!(m[p[c]]=d));if(a){if(r||e){if(r){for(u=[],c=v.length;c--;)(d=v[c])&&u.push(m[c]=d);r(null,v=[],u,l)}for(c=v.length;c--;)(d=v[c])&&(u=r?N(a,d):h[c])>-1&&(a[u]=!(o[u]=d))}}else v=Ee(v===o?v.splice(f,v.length):v),r?r(null,o,v,l):P.apply(o,v)})}function we(e){for(var t,n,r,a=e.length,o=i.relative[e[0].type],s=o||i.relative[" "],l=o?1:0,c=_e(function(e){return e===t},s,!0),d=_e(function(e){return N(t,e)>-1},s,!0),h=[function(e,n,i){var r=!o&&(i||n!==u)||((t=n).nodeType?c(e,n,i):d(e,n,i));return t=null,r}];l<a;l++)if(n=i.relative[e[l].type])h=[_e(Te(h),n)];else{if((n=i.filter[e[l].type].apply(null,e[l].matches))[_]){for(r=++l;r<a&&!i.relative[e[r].type];r++);return Ce(l>1&&Te(h),l>1&&be(e.slice(0,l-1).concat({value:" "===e[l-2].type?"*":""})).replace(U,"$1"),n,l<r&&we(e.slice(l,r)),r<a&&we(e=e.slice(r)),r<a&&be(e))}h.push(n)}return Te(h)}return ye.prototype=i.filters=i.pseudos,i.setFilters=new ye,o=se.tokenize=function(e,t){var n,r,a,o,s,l,u,c=k[e+" "];if(c)return t?0:c.slice(0);for(s=e,l=[],u=i.preFilter;s;){for(o in n&&!(r=V.exec(s))||(r&&(s=s.slice(r[0].length)||s),l.push(a=[])),n=!1,(r=q.exec(s))&&(n=r.shift(),a.push({value:n,type:r[0].replace(U," ")}),s=s.slice(n.length)),i.filter)!(r=G[o].exec(s))||u[o]&&!(r=u[o](r))||(n=r.shift(),a.push({value:n,type:o,matches:r}),s=s.slice(n.length));if(!n)break}return t?s.length:s?se.error(e):k(e,l).slice(0)},s=se.compile=function(e,t){var n,r=[],a=[],s=S[e+" "];if(!s){for(t||(t=o(e)),n=t.length;n--;)(s=we(t[n]))[_]?r.push(s):a.push(s);(s=S(e,function(e,t){var n=t.length>0,r=e.length>0,a=function(a,o,s,l,c){var d,f,m,v=0,y="0",b=a&&[],_=[],T=u,C=a||r&&i.find.TAG("*",c),w=E+=null==T?1:Math.random()||.1,k=C.length;for(c&&(u=o===p||o||c);y!==k&&null!=(d=C[y]);y++){if(r&&d){for(f=0,o||d.ownerDocument===p||(h(d),s=!g);m=e[f++];)if(m(d,o||p,s)){l.push(d);break}c&&(E=w)}n&&((d=!m&&d)&&v--,a&&b.push(d))}if(v+=y,n&&y!==v){for(f=0;m=t[f++];)m(b,_,o,s);if(a){if(v>0)for(;y--;)b[y]||_[y]||(_[y]=x.call(l));_=Ee(_)}P.apply(l,_),c&&!a&&_.length>0&&v+t.length>1&&se.uniqueSort(l)}return c&&(E=w,u=T),b};return n?ue(a):a}(a,r))).selector=e}return s},l=se.select=function(e,t,n,r){var a,l,u,c,d,h="function"==typeof e&&e,p=!r&&o(e=h.selector||e);if(n=n||[],1===p.length){if((l=p[0]=p[0].slice(0)).length>2&&"ID"===(u=l[0]).type&&9===t.nodeType&&g&&i.relative[l[1].type]){if(!(t=(i.find.ID(u.matches[0].replace(te,ne),t)||[])[0]))return n;h&&(t=t.parentNode),e=e.slice(l.shift().value.length)}for(a=G.needsContext.test(e)?0:l.length;a--&&(u=l[a],!i.relative[c=u.type]);)if((d=i.find[c])&&(r=d(u.matches[0].replace(te,ne),ee.test(l[0].type)&&ve(t.parentNode)||t))){if(l.splice(a,1),!(e=r.length&&be(l)))return P.apply(n,r),n;break}}return(h||s(e,p))(r,t,!g,n,!t||ee.test(e)&&ve(t.parentNode)||t),n},n.sortStable=_.split("").sort(O).join("")===_,n.detectDuplicates=!!d,h(),n.sortDetached=ce(function(e){return 1&e.compareDocumentPosition(p.createElement("fieldset"))}),ce(function(e){return e.innerHTML="<a href='#'></a>","#"===e.firstChild.getAttribute("href")})||de("type|href|height|width",function(e,t,n){if(!n)return e.getAttribute(t,"type"===t.toLowerCase()?1:2)}),n.attributes&&ce(function(e){return e.innerHTML="<input/>",e.firstChild.setAttribute("value",""),""===e.firstChild.getAttribute("value")})||de("value",function(e,t,n){if(!n&&"input"===e.nodeName.toLowerCase())return e.defaultValue}),ce(function(e){return null==e.getAttribute("disabled")})||de(M,function(e,t,n){var i;if(!n)return!0===e[t]?t.toLowerCase():(i=e.getAttributeNode(t))&&i.specified?i.value:null}),se}(n);C.find=S,C.expr=S.selectors,C.expr[":"]=C.expr.pseudos,C.uniqueSort=C.unique=S.uniqueSort,C.text=S.getText,C.isXMLDoc=S.isXML,C.contains=S.contains,C.escapeSelector=S.escape;var I=function(e,t,n){for(var i=[],r=void 0!==n;(e=e[t])&&9!==e.nodeType;)if(1===e.nodeType){if(r&&C(e).is(n))break;i.push(e)}return i},O=function(e,t){for(var n=[];e;e=e.nextSibling)1===e.nodeType&&e!==t&&n.push(e);return n},D=C.expr.match.needsContext;function R(e,t){return e.nodeName&&e.nodeName.toLowerCase()===t.toLowerCase()}var x=/^<([a-z][^\/\0>:\x20\t\r\n\f]*)[\x20\t\r\n\f]*\/?>(?:<\/\1>|)$/i;function A(e,t,n){return y(t)?C.grep(e,function(e,i){return!!t.call(e,i,e)!==n}):t.nodeType?C.grep(e,function(e){return e===t!==n}):"string"!=typeof t?C.grep(e,function(e){return d.call(t,e)>-1!==n}):C.filter(t,e,n)}C.filter=function(e,t,n){var i=t[0];return n&&(e=":not("+e+")"),1===t.length&&1===i.nodeType?C.find.matchesSelector(i,e)?[i]:[]:C.find.matches(e,C.grep(t,function(e){return 1===e.nodeType}))},C.fn.extend({find:function(e){var t,n,i=this.length,r=this;if("string"!=typeof e)return this.pushStack(C(e).filter(function(){for(t=0;t<i;t++)if(C.contains(r[t],this))return!0}));for(n=this.pushStack([]),t=0;t<i;t++)C.find(e,r[t],n);return i>1?C.uniqueSort(n):n},filter:function(e){return this.pushStack(A(this,e||[],!1))},not:function(e){return this.pushStack(A(this,e||[],!0))},is:function(e){return!!A(this,"string"==typeof e&&D.test(e)?C(e):e||[],!1).length}});var P,L=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]+))$/;(C.fn.init=function(e,t,n){var i,r;if(!e)return this;if(n=n||P,"string"==typeof e){if(!(i="<"===e[0]&&">"===e[e.length-1]&&e.length>=3?[null,e,null]:L.exec(e))||!i[1]&&t)return!t||t.jquery?(t||n).find(e):this.constructor(t).find(e);if(i[1]){if(t=t instanceof C?t[0]:t,C.merge(this,C.parseHTML(i[1],t&&t.nodeType?t.ownerDocument||t:o,!0)),x.test(i[1])&&C.isPlainObject(t))for(i in t)y(this[i])?this[i](t[i]):this.attr(i,t[i]);return this}return(r=o.getElementById(i[2]))&&(this[0]=r,this.length=1),this}return e.nodeType?(this[0]=e,this.length=1,this):y(e)?void 0!==n.ready?n.ready(e):e(C):C.makeArray(e,this)}).prototype=C.fn,P=C(o);var N=/^(?:parents|prev(?:Until|All))/,M={children:!0,contents:!0,next:!0,prev:!0};function K(e,t){for(;(e=e[t])&&1!==e.nodeType;);return e}C.fn.extend({has:function(e){var t=C(e,this),n=t.length;return this.filter(function(){for(var e=0;e<n;e++)if(C.contains(this,t[e]))return!0})},closest:function(e,t){var n,i=0,r=this.length,a=[],o="string"!=typeof e&&C(e);if(!D.test(e))for(;i<r;i++)for(n=this[i];n&&n!==t;n=n.parentNode)if(n.nodeType<11&&(o?o.index(n)>-1:1===n.nodeType&&C.find.matchesSelector(n,e))){a.push(n);break}return this.pushStack(a.length>1?C.uniqueSort(a):a)},index:function(e){return e?"string"==typeof e?d.call(C(e),this[0]):d.call(this,e.jquery?e[0]:e):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(e,t){return this.pushStack(C.uniqueSort(C.merge(this.get(),C(e,t))))},addBack:function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}}),C.each({parent:function(e){var t=e.parentNode;return t&&11!==t.nodeType?t:null},parents:function(e){return I(e,"parentNode")},parentsUntil:function(e,t,n){return I(e,"parentNode",n)},next:function(e){return K(e,"nextSibling")},prev:function(e){return K(e,"previousSibling")},nextAll:function(e){return I(e,"nextSibling")},prevAll:function(e){return I(e,"previousSibling")},nextUntil:function(e,t,n){return I(e,"nextSibling",n)},prevUntil:function(e,t,n){return I(e,"previousSibling",n)},siblings:function(e){return O((e.parentNode||{}).firstChild,e)},children:function(e){return O(e.firstChild)},contents:function(e){return void 0!==e.contentDocument?e.contentDocument:(R(e,"template")&&(e=e.content||e),C.merge([],e.childNodes))}},function(e,t){C.fn[e]=function(n,i){var r=C.map(this,t,n);return"Until"!==e.slice(-5)&&(i=n),i&&"string"==typeof i&&(r=C.filter(i,r)),this.length>1&&(M[e]||C.uniqueSort(r),N.test(e)&&r.reverse()),this.pushStack(r)}});var $=/[^\x20\t\r\n\f]+/g;function j(e){return e}function B(e){throw e}function F(e,t,n,i){var r;try{e&&y(r=e.promise)?r.call(e).done(t).fail(n):e&&y(r=e.then)?r.call(e,t,n):t.apply(void 0,[e].slice(i))}catch(e){n.apply(void 0,[e])}}C.Callbacks=function(e){e="string"==typeof e?function(e){var t={};return C.each(e.match($)||[],function(e,n){t[n]=!0}),t}(e):C.extend({},e);var t,n,i,r,a=[],o=[],s=-1,l=function(){for(r=r||e.once,i=t=!0;o.length;s=-1)for(n=o.shift();++s<a.length;)!1===a[s].apply(n[0],n[1])&&e.stopOnFalse&&(s=a.length,n=!1);e.memory||(n=!1),t=!1,r&&(a=n?[]:"")},u={add:function(){return a&&(n&&!t&&(s=a.length-1,o.push(n)),function t(n){C.each(n,function(n,i){y(i)?e.unique&&u.has(i)||a.push(i):i&&i.length&&"string"!==E(i)&&t(i)})}(arguments),n&&!t&&l()),this},remove:function(){return C.each(arguments,function(e,t){for(var n;(n=C.inArray(t,a,n))>-1;)a.splice(n,1),n<=s&&s--}),this},has:function(e){return e?C.inArray(e,a)>-1:a.length>0},empty:function(){return a&&(a=[]),this},disable:function(){return r=o=[],a=n="",this},disabled:function(){return!a},lock:function(){return r=o=[],n||t||(a=n=""),this},locked:function(){return!!r},fireWith:function(e,n){return r||(n=[e,(n=n||[]).slice?n.slice():n],o.push(n),t||l()),this},fire:function(){return u.fireWith(this,arguments),this},fired:function(){return!!i}};return u},C.extend({Deferred:function(e){var t=[["notify","progress",C.Callbacks("memory"),C.Callbacks("memory"),2],["resolve","done",C.Callbacks("once memory"),C.Callbacks("once memory"),0,"resolved"],["reject","fail",C.Callbacks("once memory"),C.Callbacks("once memory"),1,"rejected"]],i="pending",r={state:function(){return i},always:function(){return a.done(arguments).fail(arguments),this},catch:function(e){return r.then(null,e)},pipe:function(){var e=arguments;return C.Deferred(function(n){C.each(t,function(t,i){var r=y(e[i[4]])&&e[i[4]];a[i[1]](function(){var e=r&&r.apply(this,arguments);e&&y(e.promise)?e.promise().progress(n.notify).done(n.resolve).fail(n.reject):n[i[0]+"With"](this,r?[e]:arguments)})}),e=null}).promise()},then:function(e,i,r){var a=0;function o(e,t,i,r){return function(){var s=this,l=arguments,u=function(){var n,u;if(!(e<a)){if((n=i.apply(s,l))===t.promise())throw new TypeError("Thenable self-resolution");u=n&&("object"==typeof n||"function"==typeof n)&&n.then,y(u)?r?u.call(n,o(a,t,j,r),o(a,t,B,r)):(a++,u.call(n,o(a,t,j,r),o(a,t,B,r),o(a,t,j,t.notifyWith))):(i!==j&&(s=void 0,l=[n]),(r||t.resolveWith)(s,l))}},c=r?u:function(){try{u()}catch(n){C.Deferred.exceptionHook&&C.Deferred.exceptionHook(n,c.stackTrace),e+1>=a&&(i!==B&&(s=void 0,l=[n]),t.rejectWith(s,l))}};e?c():(C.Deferred.getStackHook&&(c.stackTrace=C.Deferred.getStackHook()),n.setTimeout(c))}}return C.Deferred(function(n){t[0][3].add(o(0,n,y(r)?r:j,n.notifyWith)),t[1][3].add(o(0,n,y(e)?e:j)),t[2][3].add(o(0,n,y(i)?i:B))}).promise()},promise:function(e){return null!=e?C.extend(e,r):r}},a={};return C.each(t,function(e,n){var o=n[2],s=n[5];r[n[1]]=o.add,s&&o.add(function(){i=s},t[3-e][2].disable,t[3-e][3].disable,t[0][2].lock,t[0][3].lock),o.add(n[3].fire),a[n[0]]=function(){return a[n[0]+"With"](this===a?void 0:this,arguments),this},a[n[0]+"With"]=o.fireWith}),r.promise(a),e&&e.call(a,a),a},when:function(e){var t=arguments.length,n=t,i=Array(n),r=l.call(arguments),a=C.Deferred(),o=function(e){return function(n){i[e]=this,r[e]=arguments.length>1?l.call(arguments):n,--t||a.resolveWith(i,r)}};if(t<=1&&(F(e,a.done(o(n)).resolve,a.reject,!t),"pending"===a.state()||y(r[n]&&r[n].then)))return a.then();for(;n--;)F(r[n],o(n),a.reject);return a.promise()}});var U=/^(Eval|Internal|Range|Reference|Syntax|Type|URI)Error$/;C.Deferred.exceptionHook=function(e,t){n.console&&n.console.warn&&e&&U.test(e.name)&&n.console.warn("jQuery.Deferred exception: "+e.message,e.stack,t)},C.readyException=function(e){n.setTimeout(function(){throw e})};var V=C.Deferred();function q(){o.removeEventListener("DOMContentLoaded",q),n.removeEventListener("load",q),C.ready()}C.fn.ready=function(e){return V.then(e).catch(function(e){C.readyException(e)}),this},C.extend({isReady:!1,readyWait:1,ready:function(e){(!0===e?--C.readyWait:C.isReady)||(C.isReady=!0,!0!==e&&--C.readyWait>0||V.resolveWith(o,[C]))}}),C.ready.then=V.then,"complete"===o.readyState||"loading"!==o.readyState&&!o.documentElement.doScroll?n.setTimeout(C.ready):(o.addEventListener("DOMContentLoaded",q),n.addEventListener("load",q));var H=function(e,t,n,i,r,a,o){var s=0,l=e.length,u=null==n;if("object"===E(n))for(s in r=!0,n)H(e,t,s,n[s],!0,a,o);else if(void 0!==i&&(r=!0,y(i)||(o=!0),u&&(o?(t.call(e,i),t=null):(u=t,t=function(e,t,n){return u.call(C(e),n)})),t))for(;s<l;s++)t(e[s],n,o?i:i.call(e[s],s,t(e[s],n)));return r?e:u?t.call(e):l?t(e[0],n):a},z=/^-ms-/,W=/-([a-z])/g;function G(e,t){return t.toUpperCase()}function X(e){return e.replace(z,"ms-").replace(W,G)}var Y=function(e){return 1===e.nodeType||9===e.nodeType||!+e.nodeType};function Q(){this.expando=C.expando+Q.uid++}Q.uid=1,Q.prototype={cache:function(e){var t=e[this.expando];return t||(t={},Y(e)&&(e.nodeType?e[this.expando]=t:Object.defineProperty(e,this.expando,{value:t,configurable:!0}))),t},set:function(e,t,n){var i,r=this.cache(e);if("string"==typeof t)r[X(t)]=n;else for(i in t)r[X(i)]=t[i];return r},get:function(e,t){return void 0===t?this.cache(e):e[this.expando]&&e[this.expando][X(t)]},access:function(e,t,n){return void 0===t||t&&"string"==typeof t&&void 0===n?this.get(e,t):(this.set(e,t,n),void 0!==n?n:t)},remove:function(e,t){var n,i=e[this.expando];if(void 0!==i){if(void 0!==t){n=(t=Array.isArray(t)?t.map(X):(t=X(t))in i?[t]:t.match($)||[]).length;for(;n--;)delete i[t[n]]}(void 0===t||C.isEmptyObject(i))&&(e.nodeType?e[this.expando]=void 0:delete e[this.expando])}},hasData:function(e){var t=e[this.expando];return void 0!==t&&!C.isEmptyObject(t)}};var J=new Q,Z=new Q,ee=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,te=/[A-Z]/g;function ne(e,t,n){var i;if(void 0===n&&1===e.nodeType)if(i="data-"+t.replace(te,"-$&").toLowerCase(),"string"==typeof(n=e.getAttribute(i))){try{n=function(e){return"true"===e||"false"!==e&&("null"===e?null:e===+e+""?+e:ee.test(e)?JSON.parse(e):e)}(n)}catch(e){}Z.set(e,t,n)}else n=void 0;return n}C.extend({hasData:function(e){return Z.hasData(e)||J.hasData(e)},data:function(e,t,n){return Z.access(e,t,n)},removeData:function(e,t){Z.remove(e,t)},_data:function(e,t,n){return J.access(e,t,n)},_removeData:function(e,t){J.remove(e,t)}}),C.fn.extend({data:function(e,t){var n,i,r,a=this[0],o=a&&a.attributes;if(void 0===e){if(this.length&&(r=Z.get(a),1===a.nodeType&&!J.get(a,"hasDataAttrs"))){for(n=o.length;n--;)o[n]&&0===(i=o[n].name).indexOf("data-")&&(i=X(i.slice(5)),ne(a,i,r[i]));J.set(a,"hasDataAttrs",!0)}return r}return"object"==typeof e?this.each(function(){Z.set(this,e)}):H(this,function(t){var n;if(a&&void 0===t)return void 0!==(n=Z.get(a,e))?n:void 0!==(n=ne(a,e))?n:void 0;this.each(function(){Z.set(this,e,t)})},null,t,arguments.length>1,null,!0)},removeData:function(e){return this.each(function(){Z.remove(this,e)})}}),C.extend({queue:function(e,t,n){var i;if(e)return t=(t||"fx")+"queue",i=J.get(e,t),n&&(!i||Array.isArray(n)?i=J.access(e,t,C.makeArray(n)):i.push(n)),i||[]},dequeue:function(e,t){t=t||"fx";var n=C.queue(e,t),i=n.length,r=n.shift(),a=C._queueHooks(e,t);"inprogress"===r&&(r=n.shift(),i--),r&&("fx"===t&&n.unshift("inprogress"),delete a.stop,r.call(e,function(){C.dequeue(e,t)},a)),!i&&a&&a.empty.fire()},_queueHooks:function(e,t){var n=t+"queueHooks";return J.get(e,n)||J.access(e,n,{empty:C.Callbacks("once memory").add(function(){J.remove(e,[t+"queue",n])})})}}),C.fn.extend({queue:function(e,t){var n=2;return"string"!=typeof e&&(t=e,e="fx",n--),arguments.length<n?C.queue(this[0],e):void 0===t?this:this.each(function(){var n=C.queue(this,e,t);C._queueHooks(this,e),"fx"===e&&"inprogress"!==n[0]&&C.dequeue(this,e)})},dequeue:function(e){return this.each(function(){C.dequeue(this,e)})},clearQueue:function(e){return this.queue(e||"fx",[])},promise:function(e,t){var n,i=1,r=C.Deferred(),a=this,o=this.length,s=function(){--i||r.resolveWith(a,[a])};for("string"!=typeof e&&(t=e,e=void 0),e=e||"fx";o--;)(n=J.get(a[o],e+"queueHooks"))&&n.empty&&(i++,n.empty.add(s));return s(),r.promise(t)}});var ie=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,re=new RegExp("^(?:([+-])=|)("+ie+")([a-z%]*)$","i"),ae=["Top","Right","Bottom","Left"],oe=o.documentElement,se=function(e){return C.contains(e.ownerDocument,e)},le={composed:!0};oe.attachShadow&&(se=function(e){return C.contains(e.ownerDocument,e)||e.getRootNode(le)===e.ownerDocument});var ue=function(e,t){return"none"===(e=t||e).style.display||""===e.style.display&&se(e)&&"none"===C.css(e,"display")},ce=function(e,t,n,i){var r,a,o={};for(a in t)o[a]=e.style[a],e.style[a]=t[a];for(a in r=n.apply(e,i||[]),t)e.style[a]=o[a];return r};function de(e,t,n,i){var r,a,o=20,s=i?function(){return i.cur()}:function(){return C.css(e,t,"")},l=s(),u=n&&n[3]||(C.cssNumber[t]?"":"px"),c=e.nodeType&&(C.cssNumber[t]||"px"!==u&&+l)&&re.exec(C.css(e,t));if(c&&c[3]!==u){for(l/=2,u=u||c[3],c=+l||1;o--;)C.style(e,t,c+u),(1-a)*(1-(a=s()/l||.5))<=0&&(o=0),c/=a;c*=2,C.style(e,t,c+u),n=n||[]}return n&&(c=+c||+l||0,r=n[1]?c+(n[1]+1)*n[2]:+n[2],i&&(i.unit=u,i.start=c,i.end=r)),r}var he={};function pe(e){var t,n=e.ownerDocument,i=e.nodeName,r=he[i];return r||(t=n.body.appendChild(n.createElement(i)),r=C.css(t,"display"),t.parentNode.removeChild(t),"none"===r&&(r="block"),he[i]=r,r)}function fe(e,t){for(var n,i,r=[],a=0,o=e.length;a<o;a++)(i=e[a]).style&&(n=i.style.display,t?("none"===n&&(r[a]=J.get(i,"display")||null,r[a]||(i.style.display="")),""===i.style.display&&ue(i)&&(r[a]=pe(i))):"none"!==n&&(r[a]="none",J.set(i,"display",n)));for(a=0;a<o;a++)null!=r[a]&&(e[a].style.display=r[a]);return e}C.fn.extend({show:function(){return fe(this,!0)},hide:function(){return fe(this)},toggle:function(e){return"boolean"==typeof e?e?this.show():this.hide():this.each(function(){ue(this)?C(this).show():C(this).hide()})}});var ge=/^(?:checkbox|radio)$/i,me=/<([a-z][^\/\0>\x20\t\r\n\f]*)/i,ve=/^$|^module$|\/(?:java|ecma)script/i,ye={option:[1,"<select multiple='multiple'>","</select>"],thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};function be(e,t){var n;return n=void 0!==e.getElementsByTagName?e.getElementsByTagName(t||"*"):void 0!==e.querySelectorAll?e.querySelectorAll(t||"*"):[],void 0===t||t&&R(e,t)?C.merge([e],n):n}function _e(e,t){for(var n=0,i=e.length;n<i;n++)J.set(e[n],"globalEval",!t||J.get(t[n],"globalEval"))}ye.optgroup=ye.option,ye.tbody=ye.tfoot=ye.colgroup=ye.caption=ye.thead,ye.th=ye.td;var Te,Ee,Ce=/<|&#?\w+;/;function we(e,t,n,i,r){for(var a,o,s,l,u,c,d=t.createDocumentFragment(),h=[],p=0,f=e.length;p<f;p++)if((a=e[p])||0===a)if("object"===E(a))C.merge(h,a.nodeType?[a]:a);else if(Ce.test(a)){for(o=o||d.appendChild(t.createElement("div")),s=(me.exec(a)||["",""])[1].toLowerCase(),l=ye[s]||ye._default,o.innerHTML=l[1]+C.htmlPrefilter(a)+l[2],c=l[0];c--;)o=o.lastChild;C.merge(h,o.childNodes),(o=d.firstChild).textContent=""}else h.push(t.createTextNode(a));for(d.textContent="",p=0;a=h[p++];)if(i&&C.inArray(a,i)>-1)r&&r.push(a);else if(u=se(a),o=be(d.appendChild(a),"script"),u&&_e(o),n)for(c=0;a=o[c++];)ve.test(a.type||"")&&n.push(a);return d}Te=o.createDocumentFragment().appendChild(o.createElement("div")),(Ee=o.createElement("input")).setAttribute("type","radio"),Ee.setAttribute("checked","checked"),Ee.setAttribute("name","t"),Te.appendChild(Ee),v.checkClone=Te.cloneNode(!0).cloneNode(!0).lastChild.checked,Te.innerHTML="<textarea>x</textarea>",v.noCloneChecked=!!Te.cloneNode(!0).lastChild.defaultValue;var ke=/^key/,Se=/^(?:mouse|pointer|contextmenu|drag|drop)|click/,Ie=/^([^.]*)(?:\.(.+)|)/;function Oe(){return!0}function De(){return!1}function Re(e,t){return e===function(){try{return o.activeElement}catch(e){}}()==("focus"===t)}function xe(e,t,n,i,r,a){var o,s;if("object"==typeof t){for(s in"string"!=typeof n&&(i=i||n,n=void 0),t)xe(e,s,n,i,t[s],a);return e}if(null==i&&null==r?(r=n,i=n=void 0):null==r&&("string"==typeof n?(r=i,i=void 0):(r=i,i=n,n=void 0)),!1===r)r=De;else if(!r)return e;return 1===a&&(o=r,(r=function(e){return C().off(e),o.apply(this,arguments)}).guid=o.guid||(o.guid=C.guid++)),e.each(function(){C.event.add(this,t,r,i,n)})}function Ae(e,t,n){n?(J.set(e,t,!1),C.event.add(e,t,{namespace:!1,handler:function(e){var i,r,a=J.get(this,t);if(1&e.isTrigger&&this[t]){if(a)(C.event.special[t]||{}).delegateType&&e.stopPropagation();else if(a=l.call(arguments),J.set(this,t,a),i=n(this,t),this[t](),a!==(r=J.get(this,t))||i?J.set(this,t,!1):r=void 0,a!==r)return e.stopImmediatePropagation(),e.preventDefault(),r}else a&&(J.set(this,t,C.event.trigger(C.extend(a.shift(),C.Event.prototype),a,this)),e.stopImmediatePropagation())}})):C.event.add(e,t,Oe)}C.event={global:{},add:function(e,t,n,i,r){var a,o,s,l,u,c,d,h,p,f,g,m=J.get(e);if(m)for(n.handler&&(n=(a=n).handler,r=a.selector),r&&C.find.matchesSelector(oe,r),n.guid||(n.guid=C.guid++),(l=m.events)||(l=m.events={}),(o=m.handle)||(o=m.handle=function(t){return void 0!==C&&C.event.triggered!==t.type?C.event.dispatch.apply(e,arguments):void 0}),u=(t=(t||"").match($)||[""]).length;u--;)p=g=(s=Ie.exec(t[u])||[])[1],f=(s[2]||"").split(".").sort(),p&&(d=C.event.special[p]||{},p=(r?d.delegateType:d.bindType)||p,d=C.event.special[p]||{},c=C.extend({type:p,origType:g,data:i,handler:n,guid:n.guid,selector:r,needsContext:r&&C.expr.match.needsContext.test(r),namespace:f.join(".")},a),(h=l[p])||((h=l[p]=[]).delegateCount=0,d.setup&&!1!==d.setup.call(e,i,f,o)||e.addEventListener&&e.addEventListener(p,o)),d.add&&(d.add.call(e,c),c.handler.guid||(c.handler.guid=n.guid)),r?h.splice(h.delegateCount++,0,c):h.push(c),C.event.global[p]=!0)},remove:function(e,t,n,i,r){var a,o,s,l,u,c,d,h,p,f,g,m=J.hasData(e)&&J.get(e);if(m&&(l=m.events)){for(u=(t=(t||"").match($)||[""]).length;u--;)if(p=g=(s=Ie.exec(t[u])||[])[1],f=(s[2]||"").split(".").sort(),p){for(d=C.event.special[p]||{},h=l[p=(i?d.delegateType:d.bindType)||p]||[],s=s[2]&&new RegExp("(^|\\.)"+f.join("\\.(?:.*\\.|)")+"(\\.|$)"),o=a=h.length;a--;)c=h[a],!r&&g!==c.origType||n&&n.guid!==c.guid||s&&!s.test(c.namespace)||i&&i!==c.selector&&("**"!==i||!c.selector)||(h.splice(a,1),c.selector&&h.delegateCount--,d.remove&&d.remove.call(e,c));o&&!h.length&&(d.teardown&&!1!==d.teardown.call(e,f,m.handle)||C.removeEvent(e,p,m.handle),delete l[p])}else for(p in l)C.event.remove(e,p+t[u],n,i,!0);C.isEmptyObject(l)&&J.remove(e,"handle events")}},dispatch:function(e){var t,n,i,r,a,o,s=C.event.fix(e),l=new Array(arguments.length),u=(J.get(this,"events")||{})[s.type]||[],c=C.event.special[s.type]||{};for(l[0]=s,t=1;t<arguments.length;t++)l[t]=arguments[t];if(s.delegateTarget=this,!c.preDispatch||!1!==c.preDispatch.call(this,s)){for(o=C.event.handlers.call(this,s,u),t=0;(r=o[t++])&&!s.isPropagationStopped();)for(s.currentTarget=r.elem,n=0;(a=r.handlers[n++])&&!s.isImmediatePropagationStopped();)s.rnamespace&&!1!==a.namespace&&!s.rnamespace.test(a.namespace)||(s.handleObj=a,s.data=a.data,void 0!==(i=((C.event.special[a.origType]||{}).handle||a.handler).apply(r.elem,l))&&!1===(s.result=i)&&(s.preventDefault(),s.stopPropagation()));return c.postDispatch&&c.postDispatch.call(this,s),s.result}},handlers:function(e,t){var n,i,r,a,o,s=[],l=t.delegateCount,u=e.target;if(l&&u.nodeType&&!("click"===e.type&&e.button>=1))for(;u!==this;u=u.parentNode||this)if(1===u.nodeType&&("click"!==e.type||!0!==u.disabled)){for(a=[],o={},n=0;n<l;n++)void 0===o[r=(i=t[n]).selector+" "]&&(o[r]=i.needsContext?C(r,this).index(u)>-1:C.find(r,this,null,[u]).length),o[r]&&a.push(i);a.length&&s.push({elem:u,handlers:a})}return u=this,l<t.length&&s.push({elem:u,handlers:t.slice(l)}),s},addProp:function(e,t){Object.defineProperty(C.Event.prototype,e,{enumerable:!0,configurable:!0,get:y(t)?function(){if(this.originalEvent)return t(this.originalEvent)}:function(){if(this.originalEvent)return this.originalEvent[e]},set:function(t){Object.defineProperty(this,e,{enumerable:!0,configurable:!0,writable:!0,value:t})}})},fix:function(e){return e[C.expando]?e:new C.Event(e)},special:{load:{noBubble:!0},click:{setup:function(e){var t=this||e;return ge.test(t.type)&&t.click&&R(t,"input")&&void 0===J.get(t,"click")&&Ae(t,"click",Oe),!1},trigger:function(e){var t=this||e;return ge.test(t.type)&&t.click&&R(t,"input")&&void 0===J.get(t,"click")&&Ae(t,"click"),!0},_default:function(e){var t=e.target;return ge.test(t.type)&&t.click&&R(t,"input")&&J.get(t,"click")||R(t,"a")}},beforeunload:{postDispatch:function(e){void 0!==e.result&&e.originalEvent&&(e.originalEvent.returnValue=e.result)}}}},C.removeEvent=function(e,t,n){e.removeEventListener&&e.removeEventListener(t,n)},C.Event=function(e,t){if(!(this instanceof C.Event))return new C.Event(e,t);e&&e.type?(this.originalEvent=e,this.type=e.type,this.isDefaultPrevented=e.defaultPrevented||void 0===e.defaultPrevented&&!1===e.returnValue?Oe:De,this.target=e.target&&3===e.target.nodeType?e.target.parentNode:e.target,this.currentTarget=e.currentTarget,this.relatedTarget=e.relatedTarget):this.type=e,t&&C.extend(this,t),this.timeStamp=e&&e.timeStamp||Date.now(),this[C.expando]=!0},C.Event.prototype={constructor:C.Event,isDefaultPrevented:De,isPropagationStopped:De,isImmediatePropagationStopped:De,isSimulated:!1,preventDefault:function(){var e=this.originalEvent;this.isDefaultPrevented=Oe,e&&!this.isSimulated&&e.preventDefault()},stopPropagation:function(){var e=this.originalEvent;this.isPropagationStopped=Oe,e&&!this.isSimulated&&e.stopPropagation()},stopImmediatePropagation:function(){var e=this.originalEvent;this.isImmediatePropagationStopped=Oe,e&&!this.isSimulated&&e.stopImmediatePropagation(),this.stopPropagation()}},C.each({altKey:!0,bubbles:!0,cancelable:!0,changedTouches:!0,ctrlKey:!0,detail:!0,eventPhase:!0,metaKey:!0,pageX:!0,pageY:!0,shiftKey:!0,view:!0,char:!0,code:!0,charCode:!0,key:!0,keyCode:!0,button:!0,buttons:!0,clientX:!0,clientY:!0,offsetX:!0,offsetY:!0,pointerId:!0,pointerType:!0,screenX:!0,screenY:!0,targetTouches:!0,toElement:!0,touches:!0,which:function(e){var t=e.button;return null==e.which&&ke.test(e.type)?null!=e.charCode?e.charCode:e.keyCode:!e.which&&void 0!==t&&Se.test(e.type)?1&t?1:2&t?3:4&t?2:0:e.which}},C.event.addProp),C.each({focus:"focusin",blur:"focusout"},function(e,t){C.event.special[e]={setup:function(){return Ae(this,e,Re),!1},trigger:function(){return Ae(this,e),!0},delegateType:t}}),C.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(e,t){C.event.special[e]={delegateType:t,bindType:t,handle:function(e){var n,i=e.relatedTarget,r=e.handleObj;return i&&(i===this||C.contains(this,i))||(e.type=r.origType,n=r.handler.apply(this,arguments),e.type=t),n}}}),C.fn.extend({on:function(e,t,n,i){return xe(this,e,t,n,i)},one:function(e,t,n,i){return xe(this,e,t,n,i,1)},off:function(e,t,n){var i,r;if(e&&e.preventDefault&&e.handleObj)return i=e.handleObj,C(e.delegateTarget).off(i.namespace?i.origType+"."+i.namespace:i.origType,i.selector,i.handler),this;if("object"==typeof e){for(r in e)this.off(r,t,e[r]);return this}return!1!==t&&"function"!=typeof t||(n=t,t=void 0),!1===n&&(n=De),this.each(function(){C.event.remove(this,e,n,t)})}});var Pe=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([a-z][^\/\0>\x20\t\r\n\f]*)[^>]*)\/>/gi,Le=/<script|<style|<link/i,Ne=/checked\s*(?:[^=]|=\s*.checked.)/i,Me=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g;function Ke(e,t){return R(e,"table")&&R(11!==t.nodeType?t:t.firstChild,"tr")&&C(e).children("tbody")[0]||e}function $e(e){return e.type=(null!==e.getAttribute("type"))+"/"+e.type,e}function je(e){return"true/"===(e.type||"").slice(0,5)?e.type=e.type.slice(5):e.removeAttribute("type"),e}function Be(e,t){var n,i,r,a,o,s,l,u;if(1===t.nodeType){if(J.hasData(e)&&(a=J.access(e),o=J.set(t,a),u=a.events))for(r in delete o.handle,o.events={},u)for(n=0,i=u[r].length;n<i;n++)C.event.add(t,r,u[r][n]);Z.hasData(e)&&(s=Z.access(e),l=C.extend({},s),Z.set(t,l))}}function Fe(e,t,n,i){t=u.apply([],t);var r,a,o,s,l,c,d=0,h=e.length,p=h-1,f=t[0],g=y(f);if(g||h>1&&"string"==typeof f&&!v.checkClone&&Ne.test(f))return e.each(function(r){var a=e.eq(r);g&&(t[0]=f.call(this,r,a.html())),Fe(a,t,n,i)});if(h&&(a=(r=we(t,e[0].ownerDocument,!1,e,i)).firstChild,1===r.childNodes.length&&(r=a),a||i)){for(s=(o=C.map(be(r,"script"),$e)).length;d<h;d++)l=r,d!==p&&(l=C.clone(l,!0,!0),s&&C.merge(o,be(l,"script"))),n.call(e[d],l,d);if(s)for(c=o[o.length-1].ownerDocument,C.map(o,je),d=0;d<s;d++)l=o[d],ve.test(l.type||"")&&!J.access(l,"globalEval")&&C.contains(c,l)&&(l.src&&"module"!==(l.type||"").toLowerCase()?C._evalUrl&&!l.noModule&&C._evalUrl(l.src,{nonce:l.nonce||l.getAttribute("nonce")}):T(l.textContent.replace(Me,""),l,c))}return e}function Ue(e,t,n){for(var i,r=t?C.filter(t,e):e,a=0;null!=(i=r[a]);a++)n||1!==i.nodeType||C.cleanData(be(i)),i.parentNode&&(n&&se(i)&&_e(be(i,"script")),i.parentNode.removeChild(i));return e}C.extend({htmlPrefilter:function(e){return e.replace(Pe,"<$1></$2>")},clone:function(e,t,n){var i,r,a,o,s,l,u,c=e.cloneNode(!0),d=se(e);if(!(v.noCloneChecked||1!==e.nodeType&&11!==e.nodeType||C.isXMLDoc(e)))for(o=be(c),i=0,r=(a=be(e)).length;i<r;i++)s=a[i],"input"===(u=(l=o[i]).nodeName.toLowerCase())&&ge.test(s.type)?l.checked=s.checked:"input"!==u&&"textarea"!==u||(l.defaultValue=s.defaultValue);if(t)if(n)for(a=a||be(e),o=o||be(c),i=0,r=a.length;i<r;i++)Be(a[i],o[i]);else Be(e,c);return(o=be(c,"script")).length>0&&_e(o,!d&&be(e,"script")),c},cleanData:function(e){for(var t,n,i,r=C.event.special,a=0;void 0!==(n=e[a]);a++)if(Y(n)){if(t=n[J.expando]){if(t.events)for(i in t.events)r[i]?C.event.remove(n,i):C.removeEvent(n,i,t.handle);n[J.expando]=void 0}n[Z.expando]&&(n[Z.expando]=void 0)}}}),C.fn.extend({detach:function(e){return Ue(this,e,!0)},remove:function(e){return Ue(this,e)},text:function(e){return H(this,function(e){return void 0===e?C.text(this):this.empty().each(function(){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||(this.textContent=e)})},null,e,arguments.length)},append:function(){return Fe(this,arguments,function(e){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||Ke(this,e).appendChild(e)})},prepend:function(){return Fe(this,arguments,function(e){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var t=Ke(this,e);t.insertBefore(e,t.firstChild)}})},before:function(){return Fe(this,arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this)})},after:function(){return Fe(this,arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this.nextSibling)})},empty:function(){for(var e,t=0;null!=(e=this[t]);t++)1===e.nodeType&&(C.cleanData(be(e,!1)),e.textContent="");return this},clone:function(e,t){return e=null!=e&&e,t=null==t?e:t,this.map(function(){return C.clone(this,e,t)})},html:function(e){return H(this,function(e){var t=this[0]||{},n=0,i=this.length;if(void 0===e&&1===t.nodeType)return t.innerHTML;if("string"==typeof e&&!Le.test(e)&&!ye[(me.exec(e)||["",""])[1].toLowerCase()]){e=C.htmlPrefilter(e);try{for(;n<i;n++)1===(t=this[n]||{}).nodeType&&(C.cleanData(be(t,!1)),t.innerHTML=e);t=0}catch(e){}}t&&this.empty().append(e)},null,e,arguments.length)},replaceWith:function(){var e=[];return Fe(this,arguments,function(t){var n=this.parentNode;C.inArray(this,e)<0&&(C.cleanData(be(this)),n&&n.replaceChild(t,this))},e)}}),C.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(e,t){C.fn[e]=function(e){for(var n,i=[],r=C(e),a=r.length-1,o=0;o<=a;o++)n=o===a?this:this.clone(!0),C(r[o])[t](n),c.apply(i,n.get());return this.pushStack(i)}});var Ve=new RegExp("^("+ie+")(?!px)[a-z%]+$","i"),qe=function(e){var t=e.ownerDocument.defaultView;return t&&t.opener||(t=n),t.getComputedStyle(e)},He=new RegExp(ae.join("|"),"i");function ze(e,t,n){var i,r,a,o,s=e.style;return(n=n||qe(e))&&(""!==(o=n.getPropertyValue(t)||n[t])||se(e)||(o=C.style(e,t)),!v.pixelBoxStyles()&&Ve.test(o)&&He.test(t)&&(i=s.width,r=s.minWidth,a=s.maxWidth,s.minWidth=s.maxWidth=s.width=o,o=n.width,s.width=i,s.minWidth=r,s.maxWidth=a)),void 0!==o?o+"":o}function We(e,t){return{get:function(){if(!e())return(this.get=t).apply(this,arguments);delete this.get}}}!function(){function e(){if(c){u.style.cssText="position:absolute;left:-11111px;width:60px;margin-top:1px;padding:0;border:0",c.style.cssText="position:relative;display:block;box-sizing:border-box;overflow:scroll;margin:auto;border:1px;padding:1px;width:60%;top:1%",oe.appendChild(u).appendChild(c);var e=n.getComputedStyle(c);i="1%"!==e.top,l=12===t(e.marginLeft),c.style.right="60%",s=36===t(e.right),r=36===t(e.width),c.style.position="absolute",a=12===t(c.offsetWidth/3),oe.removeChild(u),c=null}}function t(e){return Math.round(parseFloat(e))}var i,r,a,s,l,u=o.createElement("div"),c=o.createElement("div");c.style&&(c.style.backgroundClip="content-box",c.cloneNode(!0).style.backgroundClip="",v.clearCloneStyle="content-box"===c.style.backgroundClip,C.extend(v,{boxSizingReliable:function(){return e(),r},pixelBoxStyles:function(){return e(),s},pixelPosition:function(){return e(),i},reliableMarginLeft:function(){return e(),l},scrollboxSize:function(){return e(),a}}))}();var Ge=["Webkit","Moz","ms"],Xe=o.createElement("div").style,Ye={};function Qe(e){return C.cssProps[e]||Ye[e]||(e in Xe?e:Ye[e]=function(e){for(var t=e[0].toUpperCase()+e.slice(1),n=Ge.length;n--;)if((e=Ge[n]+t)in Xe)return e}(e)||e)}var Je=/^(none|table(?!-c[ea]).+)/,Ze=/^--/,et={position:"absolute",visibility:"hidden",display:"block"},tt={letterSpacing:"0",fontWeight:"400"};function nt(e,t,n){var i=re.exec(t);return i?Math.max(0,i[2]-(n||0))+(i[3]||"px"):t}function it(e,t,n,i,r,a){var o="width"===t?1:0,s=0,l=0;if(n===(i?"border":"content"))return 0;for(;o<4;o+=2)"margin"===n&&(l+=C.css(e,n+ae[o],!0,r)),i?("content"===n&&(l-=C.css(e,"padding"+ae[o],!0,r)),"margin"!==n&&(l-=C.css(e,"border"+ae[o]+"Width",!0,r))):(l+=C.css(e,"padding"+ae[o],!0,r),"padding"!==n?l+=C.css(e,"border"+ae[o]+"Width",!0,r):s+=C.css(e,"border"+ae[o]+"Width",!0,r));return!i&&a>=0&&(l+=Math.max(0,Math.ceil(e["offset"+t[0].toUpperCase()+t.slice(1)]-a-l-s-.5))||0),l}function rt(e,t,n){var i=qe(e),r=(!v.boxSizingReliable()||n)&&"border-box"===C.css(e,"boxSizing",!1,i),a=r,o=ze(e,t,i),s="offset"+t[0].toUpperCase()+t.slice(1);if(Ve.test(o)){if(!n)return o;o="auto"}return(!v.boxSizingReliable()&&r||"auto"===o||!parseFloat(o)&&"inline"===C.css(e,"display",!1,i))&&e.getClientRects().length&&(r="border-box"===C.css(e,"boxSizing",!1,i),(a=s in e)&&(o=e[s])),(o=parseFloat(o)||0)+it(e,t,n||(r?"border":"content"),a,i,o)+"px"}function at(e,t,n,i,r){return new at.prototype.init(e,t,n,i,r)}C.extend({cssHooks:{opacity:{get:function(e,t){if(t){var n=ze(e,"opacity");return""===n?"1":n}}}},cssNumber:{animationIterationCount:!0,columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,gridArea:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnStart:!0,gridRow:!0,gridRowEnd:!0,gridRowStart:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{},style:function(e,t,n,i){if(e&&3!==e.nodeType&&8!==e.nodeType&&e.style){var r,a,o,s=X(t),l=Ze.test(t),u=e.style;if(l||(t=Qe(s)),o=C.cssHooks[t]||C.cssHooks[s],void 0===n)return o&&"get"in o&&void 0!==(r=o.get(e,!1,i))?r:u[t];"string"==(a=typeof n)&&(r=re.exec(n))&&r[1]&&(n=de(e,t,r),a="number"),null!=n&&n==n&&("number"!==a||l||(n+=r&&r[3]||(C.cssNumber[s]?"":"px")),v.clearCloneStyle||""!==n||0!==t.indexOf("background")||(u[t]="inherit"),o&&"set"in o&&void 0===(n=o.set(e,n,i))||(l?u.setProperty(t,n):u[t]=n))}},css:function(e,t,n,i){var r,a,o,s=X(t);return Ze.test(t)||(t=Qe(s)),(o=C.cssHooks[t]||C.cssHooks[s])&&"get"in o&&(r=o.get(e,!0,n)),void 0===r&&(r=ze(e,t,i)),"normal"===r&&t in tt&&(r=tt[t]),""===n||n?(a=parseFloat(r),!0===n||isFinite(a)?a||0:r):r}}),C.each(["height","width"],function(e,t){C.cssHooks[t]={get:function(e,n,i){if(n)return!Je.test(C.css(e,"display"))||e.getClientRects().length&&e.getBoundingClientRect().width?rt(e,t,i):ce(e,et,function(){return rt(e,t,i)})},set:function(e,n,i){var r,a=qe(e),o=!v.scrollboxSize()&&"absolute"===a.position,s=(o||i)&&"border-box"===C.css(e,"boxSizing",!1,a),l=i?it(e,t,i,s,a):0;return s&&o&&(l-=Math.ceil(e["offset"+t[0].toUpperCase()+t.slice(1)]-parseFloat(a[t])-it(e,t,"border",!1,a)-.5)),l&&(r=re.exec(n))&&"px"!==(r[3]||"px")&&(e.style[t]=n,n=C.css(e,t)),nt(0,n,l)}}}),C.cssHooks.marginLeft=We(v.reliableMarginLeft,function(e,t){if(t)return(parseFloat(ze(e,"marginLeft"))||e.getBoundingClientRect().left-ce(e,{marginLeft:0},function(){return e.getBoundingClientRect().left}))+"px"}),C.each({margin:"",padding:"",border:"Width"},function(e,t){C.cssHooks[e+t]={expand:function(n){for(var i=0,r={},a="string"==typeof n?n.split(" "):[n];i<4;i++)r[e+ae[i]+t]=a[i]||a[i-2]||a[0];return r}},"margin"!==e&&(C.cssHooks[e+t].set=nt)}),C.fn.extend({css:function(e,t){return H(this,function(e,t,n){var i,r,a={},o=0;if(Array.isArray(t)){for(i=qe(e),r=t.length;o<r;o++)a[t[o]]=C.css(e,t[o],!1,i);return a}return void 0!==n?C.style(e,t,n):C.css(e,t)},e,t,arguments.length>1)}}),C.Tween=at,at.prototype={constructor:at,init:function(e,t,n,i,r,a){this.elem=e,this.prop=n,this.easing=r||C.easing._default,this.options=t,this.start=this.now=this.cur(),this.end=i,this.unit=a||(C.cssNumber[n]?"":"px")},cur:function(){var e=at.propHooks[this.prop];return e&&e.get?e.get(this):at.propHooks._default.get(this)},run:function(e){var t,n=at.propHooks[this.prop];return this.options.duration?this.pos=t=C.easing[this.easing](e,this.options.duration*e,0,1,this.options.duration):this.pos=t=e,this.now=(this.end-this.start)*t+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),n&&n.set?n.set(this):at.propHooks._default.set(this),this}},at.prototype.init.prototype=at.prototype,at.propHooks={_default:{get:function(e){var t;return 1!==e.elem.nodeType||null!=e.elem[e.prop]&&null==e.elem.style[e.prop]?e.elem[e.prop]:(t=C.css(e.elem,e.prop,""))&&"auto"!==t?t:0},set:function(e){C.fx.step[e.prop]?C.fx.step[e.prop](e):1!==e.elem.nodeType||!C.cssHooks[e.prop]&&null==e.elem.style[Qe(e.prop)]?e.elem[e.prop]=e.now:C.style(e.elem,e.prop,e.now+e.unit)}}},at.propHooks.scrollTop=at.propHooks.scrollLeft={set:function(e){e.elem.nodeType&&e.elem.parentNode&&(e.elem[e.prop]=e.now)}},C.easing={linear:function(e){return e},swing:function(e){return.5-Math.cos(e*Math.PI)/2},_default:"swing"},C.fx=at.prototype.init,C.fx.step={};var ot,st,lt=/^(?:toggle|show|hide)$/,ut=/queueHooks$/;function ct(){st&&(!1===o.hidden&&n.requestAnimationFrame?n.requestAnimationFrame(ct):n.setTimeout(ct,C.fx.interval),C.fx.tick())}function dt(){return n.setTimeout(function(){ot=void 0}),ot=Date.now()}function ht(e,t){var n,i=0,r={height:e};for(t=t?1:0;i<4;i+=2-t)r["margin"+(n=ae[i])]=r["padding"+n]=e;return t&&(r.opacity=r.width=e),r}function pt(e,t,n){for(var i,r=(ft.tweeners[t]||[]).concat(ft.tweeners["*"]),a=0,o=r.length;a<o;a++)if(i=r[a].call(n,t,e))return i}function ft(e,t,n){var i,r,a=0,o=ft.prefilters.length,s=C.Deferred().always(function(){delete l.elem}),l=function(){if(r)return!1;for(var t=ot||dt(),n=Math.max(0,u.startTime+u.duration-t),i=1-(n/u.duration||0),a=0,o=u.tweens.length;a<o;a++)u.tweens[a].run(i);return s.notifyWith(e,[u,i,n]),i<1&&o?n:(o||s.notifyWith(e,[u,1,0]),s.resolveWith(e,[u]),!1)},u=s.promise({elem:e,props:C.extend({},t),opts:C.extend(!0,{specialEasing:{},easing:C.easing._default},n),originalProperties:t,originalOptions:n,startTime:ot||dt(),duration:n.duration,tweens:[],createTween:function(t,n){var i=C.Tween(e,u.opts,t,n,u.opts.specialEasing[t]||u.opts.easing);return u.tweens.push(i),i},stop:function(t){var n=0,i=t?u.tweens.length:0;if(r)return this;for(r=!0;n<i;n++)u.tweens[n].run(1);return t?(s.notifyWith(e,[u,1,0]),s.resolveWith(e,[u,t])):s.rejectWith(e,[u,t]),this}}),c=u.props;for(function(e,t){var n,i,r,a,o;for(n in e)if(r=t[i=X(n)],a=e[n],Array.isArray(a)&&(r=a[1],a=e[n]=a[0]),n!==i&&(e[i]=a,delete e[n]),(o=C.cssHooks[i])&&"expand"in o)for(n in a=o.expand(a),delete e[i],a)n in e||(e[n]=a[n],t[n]=r);else t[i]=r}(c,u.opts.specialEasing);a<o;a++)if(i=ft.prefilters[a].call(u,e,c,u.opts))return y(i.stop)&&(C._queueHooks(u.elem,u.opts.queue).stop=i.stop.bind(i)),i;return C.map(c,pt,u),y(u.opts.start)&&u.opts.start.call(e,u),u.progress(u.opts.progress).done(u.opts.done,u.opts.complete).fail(u.opts.fail).always(u.opts.always),C.fx.timer(C.extend(l,{elem:e,anim:u,queue:u.opts.queue})),u}C.Animation=C.extend(ft,{tweeners:{"*":[function(e,t){var n=this.createTween(e,t);return de(n.elem,e,re.exec(t),n),n}]},tweener:function(e,t){y(e)?(t=e,e=["*"]):e=e.match($);for(var n,i=0,r=e.length;i<r;i++)n=e[i],ft.tweeners[n]=ft.tweeners[n]||[],ft.tweeners[n].unshift(t)},prefilters:[function(e,t,n){var i,r,a,o,s,l,u,c,d="width"in t||"height"in t,h=this,p={},f=e.style,g=e.nodeType&&ue(e),m=J.get(e,"fxshow");for(i in n.queue||(null==(o=C._queueHooks(e,"fx")).unqueued&&(o.unqueued=0,s=o.empty.fire,o.empty.fire=function(){o.unqueued||s()}),o.unqueued++,h.always(function(){h.always(function(){o.unqueued--,C.queue(e,"fx").length||o.empty.fire()})})),t)if(r=t[i],lt.test(r)){if(delete t[i],a=a||"toggle"===r,r===(g?"hide":"show")){if("show"!==r||!m||void 0===m[i])continue;g=!0}p[i]=m&&m[i]||C.style(e,i)}if((l=!C.isEmptyObject(t))||!C.isEmptyObject(p))for(i in d&&1===e.nodeType&&(n.overflow=[f.overflow,f.overflowX,f.overflowY],null==(u=m&&m.display)&&(u=J.get(e,"display")),"none"===(c=C.css(e,"display"))&&(u?c=u:(fe([e],!0),u=e.style.display||u,c=C.css(e,"display"),fe([e]))),("inline"===c||"inline-block"===c&&null!=u)&&"none"===C.css(e,"float")&&(l||(h.done(function(){f.display=u}),null==u&&(c=f.display,u="none"===c?"":c)),f.display="inline-block")),n.overflow&&(f.overflow="hidden",h.always(function(){f.overflow=n.overflow[0],f.overflowX=n.overflow[1],f.overflowY=n.overflow[2]})),l=!1,p)l||(m?"hidden"in m&&(g=m.hidden):m=J.access(e,"fxshow",{display:u}),a&&(m.hidden=!g),g&&fe([e],!0),h.done(function(){for(i in g||fe([e]),J.remove(e,"fxshow"),p)C.style(e,i,p[i])})),l=pt(g?m[i]:0,i,h),i in m||(m[i]=l.start,g&&(l.end=l.start,l.start=0))}],prefilter:function(e,t){t?ft.prefilters.unshift(e):ft.prefilters.push(e)}}),C.speed=function(e,t,n){var i=e&&"object"==typeof e?C.extend({},e):{complete:n||!n&&t||y(e)&&e,duration:e,easing:n&&t||t&&!y(t)&&t};return C.fx.off?i.duration=0:"number"!=typeof i.duration&&(i.duration in C.fx.speeds?i.duration=C.fx.speeds[i.duration]:i.duration=C.fx.speeds._default),null!=i.queue&&!0!==i.queue||(i.queue="fx"),i.old=i.complete,i.complete=function(){y(i.old)&&i.old.call(this),i.queue&&C.dequeue(this,i.queue)},i},C.fn.extend({fadeTo:function(e,t,n,i){return this.filter(ue).css("opacity",0).show().end().animate({opacity:t},e,n,i)},animate:function(e,t,n,i){var r=C.isEmptyObject(e),a=C.speed(t,n,i),o=function(){var t=ft(this,C.extend({},e),a);(r||J.get(this,"finish"))&&t.stop(!0)};return o.finish=o,r||!1===a.queue?this.each(o):this.queue(a.queue,o)},stop:function(e,t,n){var i=function(e){var t=e.stop;delete e.stop,t(n)};return"string"!=typeof e&&(n=t,t=e,e=void 0),t&&!1!==e&&this.queue(e||"fx",[]),this.each(function(){var t=!0,r=null!=e&&e+"queueHooks",a=C.timers,o=J.get(this);if(r)o[r]&&o[r].stop&&i(o[r]);else for(r in o)o[r]&&o[r].stop&&ut.test(r)&&i(o[r]);for(r=a.length;r--;)a[r].elem!==this||null!=e&&a[r].queue!==e||(a[r].anim.stop(n),t=!1,a.splice(r,1));!t&&n||C.dequeue(this,e)})},finish:function(e){return!1!==e&&(e=e||"fx"),this.each(function(){var t,n=J.get(this),i=n[e+"queue"],r=n[e+"queueHooks"],a=C.timers,o=i?i.length:0;for(n.finish=!0,C.queue(this,e,[]),r&&r.stop&&r.stop.call(this,!0),t=a.length;t--;)a[t].elem===this&&a[t].queue===e&&(a[t].anim.stop(!0),a.splice(t,1));for(t=0;t<o;t++)i[t]&&i[t].finish&&i[t].finish.call(this);delete n.finish})}}),C.each(["toggle","show","hide"],function(e,t){var n=C.fn[t];C.fn[t]=function(e,i,r){return null==e||"boolean"==typeof e?n.apply(this,arguments):this.animate(ht(t,!0),e,i,r)}}),C.each({slideDown:ht("show"),slideUp:ht("hide"),slideToggle:ht("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(e,t){C.fn[e]=function(e,n,i){return this.animate(t,e,n,i)}}),C.timers=[],C.fx.tick=function(){var e,t=0,n=C.timers;for(ot=Date.now();t<n.length;t++)(e=n[t])()||n[t]!==e||n.splice(t--,1);n.length||C.fx.stop(),ot=void 0},C.fx.timer=function(e){C.timers.push(e),C.fx.start()},C.fx.interval=13,C.fx.start=function(){st||(st=!0,ct())},C.fx.stop=function(){st=null},C.fx.speeds={slow:600,fast:200,_default:400},C.fn.delay=function(e,t){return e=C.fx&&C.fx.speeds[e]||e,t=t||"fx",this.queue(t,function(t,i){var r=n.setTimeout(t,e);i.stop=function(){n.clearTimeout(r)}})},function(){var e=o.createElement("input"),t=o.createElement("select").appendChild(o.createElement("option"));e.type="checkbox",v.checkOn=""!==e.value,v.optSelected=t.selected,(e=o.createElement("input")).value="t",e.type="radio",v.radioValue="t"===e.value}();var gt,mt=C.expr.attrHandle;C.fn.extend({attr:function(e,t){return H(this,C.attr,e,t,arguments.length>1)},removeAttr:function(e){return this.each(function(){C.removeAttr(this,e)})}}),C.extend({attr:function(e,t,n){var i,r,a=e.nodeType;if(3!==a&&8!==a&&2!==a)return void 0===e.getAttribute?C.prop(e,t,n):(1===a&&C.isXMLDoc(e)||(r=C.attrHooks[t.toLowerCase()]||(C.expr.match.bool.test(t)?gt:void 0)),void 0!==n?null===n?void C.removeAttr(e,t):r&&"set"in r&&void 0!==(i=r.set(e,n,t))?i:(e.setAttribute(t,n+""),n):r&&"get"in r&&null!==(i=r.get(e,t))?i:null==(i=C.find.attr(e,t))?void 0:i)},attrHooks:{type:{set:function(e,t){if(!v.radioValue&&"radio"===t&&R(e,"input")){var n=e.value;return e.setAttribute("type",t),n&&(e.value=n),t}}}},removeAttr:function(e,t){var n,i=0,r=t&&t.match($);if(r&&1===e.nodeType)for(;n=r[i++];)e.removeAttribute(n)}}),gt={set:function(e,t,n){return!1===t?C.removeAttr(e,n):e.setAttribute(n,n),n}},C.each(C.expr.match.bool.source.match(/\w+/g),function(e,t){var n=mt[t]||C.find.attr;mt[t]=function(e,t,i){var r,a,o=t.toLowerCase();return i||(a=mt[o],mt[o]=r,r=null!=n(e,t,i)?o:null,mt[o]=a),r}});var vt=/^(?:input|select|textarea|button)$/i,yt=/^(?:a|area)$/i;function bt(e){return(e.match($)||[]).join(" ")}function _t(e){return e.getAttribute&&e.getAttribute("class")||""}function Tt(e){return Array.isArray(e)?e:"string"==typeof e&&e.match($)||[]}C.fn.extend({prop:function(e,t){return H(this,C.prop,e,t,arguments.length>1)},removeProp:function(e){return this.each(function(){delete this[C.propFix[e]||e]})}}),C.extend({prop:function(e,t,n){var i,r,a=e.nodeType;if(3!==a&&8!==a&&2!==a)return 1===a&&C.isXMLDoc(e)||(t=C.propFix[t]||t,r=C.propHooks[t]),void 0!==n?r&&"set"in r&&void 0!==(i=r.set(e,n,t))?i:e[t]=n:r&&"get"in r&&null!==(i=r.get(e,t))?i:e[t]},propHooks:{tabIndex:{get:function(e){var t=C.find.attr(e,"tabindex");return t?parseInt(t,10):vt.test(e.nodeName)||yt.test(e.nodeName)&&e.href?0:-1}}},propFix:{for:"htmlFor",class:"className"}}),v.optSelected||(C.propHooks.selected={get:function(e){var t=e.parentNode;return t&&t.parentNode&&t.parentNode.selectedIndex,null},set:function(e){var t=e.parentNode;t&&(t.selectedIndex,t.parentNode&&t.parentNode.selectedIndex)}}),C.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){C.propFix[this.toLowerCase()]=this}),C.fn.extend({addClass:function(e){var t,n,i,r,a,o,s,l=0;if(y(e))return this.each(function(t){C(this).addClass(e.call(this,t,_t(this)))});if((t=Tt(e)).length)for(;n=this[l++];)if(r=_t(n),i=1===n.nodeType&&" "+bt(r)+" "){for(o=0;a=t[o++];)i.indexOf(" "+a+" ")<0&&(i+=a+" ");r!==(s=bt(i))&&n.setAttribute("class",s)}return this},removeClass:function(e){var t,n,i,r,a,o,s,l=0;if(y(e))return this.each(function(t){C(this).removeClass(e.call(this,t,_t(this)))});if(!arguments.length)return this.attr("class","");if((t=Tt(e)).length)for(;n=this[l++];)if(r=_t(n),i=1===n.nodeType&&" "+bt(r)+" "){for(o=0;a=t[o++];)for(;i.indexOf(" "+a+" ")>-1;)i=i.replace(" "+a+" "," ");r!==(s=bt(i))&&n.setAttribute("class",s)}return this},toggleClass:function(e,t){var n=typeof e,i="string"===n||Array.isArray(e);return"boolean"==typeof t&&i?t?this.addClass(e):this.removeClass(e):y(e)?this.each(function(n){C(this).toggleClass(e.call(this,n,_t(this),t),t)}):this.each(function(){var t,r,a,o;if(i)for(r=0,a=C(this),o=Tt(e);t=o[r++];)a.hasClass(t)?a.removeClass(t):a.addClass(t);else void 0!==e&&"boolean"!==n||((t=_t(this))&&J.set(this,"__className__",t),this.setAttribute&&this.setAttribute("class",t||!1===e?"":J.get(this,"__className__")||""))})},hasClass:function(e){var t,n,i=0;for(t=" "+e+" ";n=this[i++];)if(1===n.nodeType&&(" "+bt(_t(n))+" ").indexOf(t)>-1)return!0;return!1}});var Et=/\r/g;C.fn.extend({val:function(e){var t,n,i,r=this[0];return arguments.length?(i=y(e),this.each(function(n){var r;1===this.nodeType&&(null==(r=i?e.call(this,n,C(this).val()):e)?r="":"number"==typeof r?r+="":Array.isArray(r)&&(r=C.map(r,function(e){return null==e?"":e+""})),(t=C.valHooks[this.type]||C.valHooks[this.nodeName.toLowerCase()])&&"set"in t&&void 0!==t.set(this,r,"value")||(this.value=r))})):r?(t=C.valHooks[r.type]||C.valHooks[r.nodeName.toLowerCase()])&&"get"in t&&void 0!==(n=t.get(r,"value"))?n:"string"==typeof(n=r.value)?n.replace(Et,""):null==n?"":n:void 0}}),C.extend({valHooks:{option:{get:function(e){var t=C.find.attr(e,"value");return null!=t?t:bt(C.text(e))}},select:{get:function(e){var t,n,i,r=e.options,a=e.selectedIndex,o="select-one"===e.type,s=o?null:[],l=o?a+1:r.length;for(i=a<0?l:o?a:0;i<l;i++)if(((n=r[i]).selected||i===a)&&!n.disabled&&(!n.parentNode.disabled||!R(n.parentNode,"optgroup"))){if(t=C(n).val(),o)return t;s.push(t)}return s},set:function(e,t){for(var n,i,r=e.options,a=C.makeArray(t),o=r.length;o--;)((i=r[o]).selected=C.inArray(C.valHooks.option.get(i),a)>-1)&&(n=!0);return n||(e.selectedIndex=-1),a}}}}),C.each(["radio","checkbox"],function(){C.valHooks[this]={set:function(e,t){if(Array.isArray(t))return e.checked=C.inArray(C(e).val(),t)>-1}},v.checkOn||(C.valHooks[this].get=function(e){return null===e.getAttribute("value")?"on":e.value})}),v.focusin="onfocusin"in n;var Ct=/^(?:focusinfocus|focusoutblur)$/,wt=function(e){e.stopPropagation()};C.extend(C.event,{trigger:function(e,t,i,r){var a,s,l,u,c,d,h,p,g=[i||o],m=f.call(e,"type")?e.type:e,v=f.call(e,"namespace")?e.namespace.split("."):[];if(s=p=l=i=i||o,3!==i.nodeType&&8!==i.nodeType&&!Ct.test(m+C.event.triggered)&&(m.indexOf(".")>-1&&(m=(v=m.split(".")).shift(),v.sort()),c=m.indexOf(":")<0&&"on"+m,(e=e[C.expando]?e:new C.Event(m,"object"==typeof e&&e)).isTrigger=r?2:3,e.namespace=v.join("."),e.rnamespace=e.namespace?new RegExp("(^|\\.)"+v.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,e.result=void 0,e.target||(e.target=i),t=null==t?[e]:C.makeArray(t,[e]),h=C.event.special[m]||{},r||!h.trigger||!1!==h.trigger.apply(i,t))){if(!r&&!h.noBubble&&!b(i)){for(u=h.delegateType||m,Ct.test(u+m)||(s=s.parentNode);s;s=s.parentNode)g.push(s),l=s;l===(i.ownerDocument||o)&&g.push(l.defaultView||l.parentWindow||n)}for(a=0;(s=g[a++])&&!e.isPropagationStopped();)p=s,e.type=a>1?u:h.bindType||m,(d=(J.get(s,"events")||{})[e.type]&&J.get(s,"handle"))&&d.apply(s,t),(d=c&&s[c])&&d.apply&&Y(s)&&(e.result=d.apply(s,t),!1===e.result&&e.preventDefault());return e.type=m,r||e.isDefaultPrevented()||h._default&&!1!==h._default.apply(g.pop(),t)||!Y(i)||c&&y(i[m])&&!b(i)&&((l=i[c])&&(i[c]=null),C.event.triggered=m,e.isPropagationStopped()&&p.addEventListener(m,wt),i[m](),e.isPropagationStopped()&&p.removeEventListener(m,wt),C.event.triggered=void 0,l&&(i[c]=l)),e.result}},simulate:function(e,t,n){var i=C.extend(new C.Event,n,{type:e,isSimulated:!0});C.event.trigger(i,null,t)}}),C.fn.extend({trigger:function(e,t){return this.each(function(){C.event.trigger(e,t,this)})},triggerHandler:function(e,t){var n=this[0];if(n)return C.event.trigger(e,t,n,!0)}}),v.focusin||C.each({focus:"focusin",blur:"focusout"},function(e,t){var n=function(e){C.event.simulate(t,e.target,C.event.fix(e))};C.event.special[t]={setup:function(){var i=this.ownerDocument||this,r=J.access(i,t);r||i.addEventListener(e,n,!0),J.access(i,t,(r||0)+1)},teardown:function(){var i=this.ownerDocument||this,r=J.access(i,t)-1;r?J.access(i,t,r):(i.removeEventListener(e,n,!0),J.remove(i,t))}}});var kt=n.location,St=Date.now(),It=/\?/;C.parseXML=function(e){var t;if(!e||"string"!=typeof e)return null;try{t=(new n.DOMParser).parseFromString(e,"text/xml")}catch(e){t=void 0}return t&&!t.getElementsByTagName("parsererror").length||C.error("Invalid XML: "+e),t};var Ot=/\[\]$/,Dt=/\r?\n/g,Rt=/^(?:submit|button|image|reset|file)$/i,xt=/^(?:input|select|textarea|keygen)/i;function At(e,t,n,i){var r;if(Array.isArray(t))C.each(t,function(t,r){n||Ot.test(e)?i(e,r):At(e+"["+("object"==typeof r&&null!=r?t:"")+"]",r,n,i)});else if(n||"object"!==E(t))i(e,t);else for(r in t)At(e+"["+r+"]",t[r],n,i)}C.param=function(e,t){var n,i=[],r=function(e,t){var n=y(t)?t():t;i[i.length]=encodeURIComponent(e)+"="+encodeURIComponent(null==n?"":n)};if(null==e)return"";if(Array.isArray(e)||e.jquery&&!C.isPlainObject(e))C.each(e,function(){r(this.name,this.value)});else for(n in e)At(n,e[n],t,r);return i.join("&")},C.fn.extend({serialize:function(){return C.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var e=C.prop(this,"elements");return e?C.makeArray(e):this}).filter(function(){var e=this.type;return this.name&&!C(this).is(":disabled")&&xt.test(this.nodeName)&&!Rt.test(e)&&(this.checked||!ge.test(e))}).map(function(e,t){var n=C(this).val();return null==n?null:Array.isArray(n)?C.map(n,function(e){return{name:t.name,value:e.replace(Dt,"\r\n")}}):{name:t.name,value:n.replace(Dt,"\r\n")}}).get()}});var Pt=/%20/g,Lt=/#.*$/,Nt=/([?&])_=[^&]*/,Mt=/^(.*?):[ \t]*([^\r\n]*)$/gm,Kt=/^(?:GET|HEAD)$/,$t=/^\/\//,jt={},Bt={},Ft="*/".concat("*"),Ut=o.createElement("a");function Vt(e){return function(t,n){"string"!=typeof t&&(n=t,t="*");var i,r=0,a=t.toLowerCase().match($)||[];if(y(n))for(;i=a[r++];)"+"===i[0]?(i=i.slice(1)||"*",(e[i]=e[i]||[]).unshift(n)):(e[i]=e[i]||[]).push(n)}}function qt(e,t,n,i){var r={},a=e===Bt;function o(s){var l;return r[s]=!0,C.each(e[s]||[],function(e,s){var u=s(t,n,i);return"string"!=typeof u||a||r[u]?a?!(l=u):void 0:(t.dataTypes.unshift(u),o(u),!1)}),l}return o(t.dataTypes[0])||!r["*"]&&o("*")}function Ht(e,t){var n,i,r=C.ajaxSettings.flatOptions||{};for(n in t)void 0!==t[n]&&((r[n]?e:i||(i={}))[n]=t[n]);return i&&C.extend(!0,e,i),e}Ut.href=kt.href,C.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:kt.href,type:"GET",isLocal:/^(?:about|app|app-storage|.+-extension|file|res|widget):$/.test(kt.protocol),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":Ft,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/\bxml\b/,html:/\bhtml/,json:/\bjson\b/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":JSON.parse,"text xml":C.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(e,t){return t?Ht(Ht(e,C.ajaxSettings),t):Ht(C.ajaxSettings,e)},ajaxPrefilter:Vt(jt),ajaxTransport:Vt(Bt),ajax:function(e,t){"object"==typeof e&&(t=e,e=void 0),t=t||{};var i,r,a,s,l,u,c,d,h,p,f=C.ajaxSetup({},t),g=f.context||f,m=f.context&&(g.nodeType||g.jquery)?C(g):C.event,v=C.Deferred(),y=C.Callbacks("once memory"),b=f.statusCode||{},_={},T={},E="canceled",w={readyState:0,getResponseHeader:function(e){var t;if(c){if(!s)for(s={};t=Mt.exec(a);)s[t[1].toLowerCase()+" "]=(s[t[1].toLowerCase()+" "]||[]).concat(t[2]);t=s[e.toLowerCase()+" "]}return null==t?null:t.join(", ")},getAllResponseHeaders:function(){return c?a:null},setRequestHeader:function(e,t){return null==c&&(e=T[e.toLowerCase()]=T[e.toLowerCase()]||e,_[e]=t),this},overrideMimeType:function(e){return null==c&&(f.mimeType=e),this},statusCode:function(e){var t;if(e)if(c)w.always(e[w.status]);else for(t in e)b[t]=[b[t],e[t]];return this},abort:function(e){var t=e||E;return i&&i.abort(t),k(0,t),this}};if(v.promise(w),f.url=((e||f.url||kt.href)+"").replace($t,kt.protocol+"//"),f.type=t.method||t.type||f.method||f.type,f.dataTypes=(f.dataType||"*").toLowerCase().match($)||[""],null==f.crossDomain){u=o.createElement("a");try{u.href=f.url,u.href=u.href,f.crossDomain=Ut.protocol+"//"+Ut.host!=u.protocol+"//"+u.host}catch(e){f.crossDomain=!0}}if(f.data&&f.processData&&"string"!=typeof f.data&&(f.data=C.param(f.data,f.traditional)),qt(jt,f,t,w),c)return w;for(h in(d=C.event&&f.global)&&0==C.active++&&C.event.trigger("ajaxStart"),f.type=f.type.toUpperCase(),f.hasContent=!Kt.test(f.type),r=f.url.replace(Lt,""),f.hasContent?f.data&&f.processData&&0===(f.contentType||"").indexOf("application/x-www-form-urlencoded")&&(f.data=f.data.replace(Pt,"+")):(p=f.url.slice(r.length),f.data&&(f.processData||"string"==typeof f.data)&&(r+=(It.test(r)?"&":"?")+f.data,delete f.data),!1===f.cache&&(r=r.replace(Nt,"$1"),p=(It.test(r)?"&":"?")+"_="+St+++p),f.url=r+p),f.ifModified&&(C.lastModified[r]&&w.setRequestHeader("If-Modified-Since",C.lastModified[r]),C.etag[r]&&w.setRequestHeader("If-None-Match",C.etag[r])),(f.data&&f.hasContent&&!1!==f.contentType||t.contentType)&&w.setRequestHeader("Content-Type",f.contentType),w.setRequestHeader("Accept",f.dataTypes[0]&&f.accepts[f.dataTypes[0]]?f.accepts[f.dataTypes[0]]+("*"!==f.dataTypes[0]?", "+Ft+"; q=0.01":""):f.accepts["*"]),f.headers)w.setRequestHeader(h,f.headers[h]);if(f.beforeSend&&(!1===f.beforeSend.call(g,w,f)||c))return w.abort();if(E="abort",y.add(f.complete),w.done(f.success),w.fail(f.error),i=qt(Bt,f,t,w)){if(w.readyState=1,d&&m.trigger("ajaxSend",[w,f]),c)return w;f.async&&f.timeout>0&&(l=n.setTimeout(function(){w.abort("timeout")},f.timeout));try{c=!1,i.send(_,k)}catch(e){if(c)throw e;k(-1,e)}}else k(-1,"No Transport");function k(e,t,o,s){var u,h,p,_,T,E=t;c||(c=!0,l&&n.clearTimeout(l),i=void 0,a=s||"",w.readyState=e>0?4:0,u=e>=200&&e<300||304===e,o&&(_=function(e,t,n){for(var i,r,a,o,s=e.contents,l=e.dataTypes;"*"===l[0];)l.shift(),void 0===i&&(i=e.mimeType||t.getResponseHeader("Content-Type"));if(i)for(r in s)if(s[r]&&s[r].test(i)){l.unshift(r);break}if(l[0]in n)a=l[0];else{for(r in n){if(!l[0]||e.converters[r+" "+l[0]]){a=r;break}o||(o=r)}a=a||o}if(a)return a!==l[0]&&l.unshift(a),n[a]}(f,w,o)),_=function(e,t,n,i){var r,a,o,s,l,u={},c=e.dataTypes.slice();if(c[1])for(o in e.converters)u[o.toLowerCase()]=e.converters[o];for(a=c.shift();a;)if(e.responseFields[a]&&(n[e.responseFields[a]]=t),!l&&i&&e.dataFilter&&(t=e.dataFilter(t,e.dataType)),l=a,a=c.shift())if("*"===a)a=l;else if("*"!==l&&l!==a){if(!(o=u[l+" "+a]||u["* "+a]))for(r in u)if((s=r.split(" "))[1]===a&&(o=u[l+" "+s[0]]||u["* "+s[0]])){!0===o?o=u[r]:!0!==u[r]&&(a=s[0],c.unshift(s[1]));break}if(!0!==o)if(o&&e.throws)t=o(t);else try{t=o(t)}catch(e){return{state:"parsererror",error:o?e:"No conversion from "+l+" to "+a}}}return{state:"success",data:t}}(f,_,w,u),u?(f.ifModified&&((T=w.getResponseHeader("Last-Modified"))&&(C.lastModified[r]=T),(T=w.getResponseHeader("etag"))&&(C.etag[r]=T)),204===e||"HEAD"===f.type?E="nocontent":304===e?E="notmodified":(E=_.state,h=_.data,u=!(p=_.error))):(p=E,!e&&E||(E="error",e<0&&(e=0))),w.status=e,w.statusText=(t||E)+"",u?v.resolveWith(g,[h,E,w]):v.rejectWith(g,[w,E,p]),w.statusCode(b),b=void 0,d&&m.trigger(u?"ajaxSuccess":"ajaxError",[w,f,u?h:p]),y.fireWith(g,[w,E]),d&&(m.trigger("ajaxComplete",[w,f]),--C.active||C.event.trigger("ajaxStop")))}return w},getJSON:function(e,t,n){return C.get(e,t,n,"json")},getScript:function(e,t){return C.get(e,void 0,t,"script")}}),C.each(["get","post"],function(e,t){C[t]=function(e,n,i,r){return y(n)&&(r=r||i,i=n,n=void 0),C.ajax(C.extend({url:e,type:t,dataType:r,data:n,success:i},C.isPlainObject(e)&&e))}}),C._evalUrl=function(e,t){return C.ajax({url:e,type:"GET",dataType:"script",cache:!0,async:!1,global:!1,converters:{"text script":function(){}},dataFilter:function(e){C.globalEval(e,t)}})},C.fn.extend({wrapAll:function(e){var t;return this[0]&&(y(e)&&(e=e.call(this[0])),t=C(e,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&t.insertBefore(this[0]),t.map(function(){for(var e=this;e.firstElementChild;)e=e.firstElementChild;return e}).append(this)),this},wrapInner:function(e){return y(e)?this.each(function(t){C(this).wrapInner(e.call(this,t))}):this.each(function(){var t=C(this),n=t.contents();n.length?n.wrapAll(e):t.append(e)})},wrap:function(e){var t=y(e);return this.each(function(n){C(this).wrapAll(t?e.call(this,n):e)})},unwrap:function(e){return this.parent(e).not("body").each(function(){C(this).replaceWith(this.childNodes)}),this}}),C.expr.pseudos.hidden=function(e){return!C.expr.pseudos.visible(e)},C.expr.pseudos.visible=function(e){return!!(e.offsetWidth||e.offsetHeight||e.getClientRects().length)},C.ajaxSettings.xhr=function(){try{return new n.XMLHttpRequest}catch(e){}};var zt={0:200,1223:204},Wt=C.ajaxSettings.xhr();v.cors=!!Wt&&"withCredentials"in Wt,v.ajax=Wt=!!Wt,C.ajaxTransport(function(e){var t,i;if(v.cors||Wt&&!e.crossDomain)return{send:function(r,a){var o,s=e.xhr();if(s.open(e.type,e.url,e.async,e.username,e.password),e.xhrFields)for(o in e.xhrFields)s[o]=e.xhrFields[o];for(o in e.mimeType&&s.overrideMimeType&&s.overrideMimeType(e.mimeType),e.crossDomain||r["X-Requested-With"]||(r["X-Requested-With"]="XMLHttpRequest"),r)s.setRequestHeader(o,r[o]);t=function(e){return function(){t&&(t=i=s.onload=s.onerror=s.onabort=s.ontimeout=s.onreadystatechange=null,"abort"===e?s.abort():"error"===e?"number"!=typeof s.status?a(0,"error"):a(s.status,s.statusText):a(zt[s.status]||s.status,s.statusText,"text"!==(s.responseType||"text")||"string"!=typeof s.responseText?{binary:s.response}:{text:s.responseText},s.getAllResponseHeaders()))}},s.onload=t(),i=s.onerror=s.ontimeout=t("error"),void 0!==s.onabort?s.onabort=i:s.onreadystatechange=function(){4===s.readyState&&n.setTimeout(function(){t&&i()})},t=t("abort");try{s.send(e.hasContent&&e.data||null)}catch(e){if(t)throw e}},abort:function(){t&&t()}}}),C.ajaxPrefilter(function(e){e.crossDomain&&(e.contents.script=!1)}),C.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/\b(?:java|ecma)script\b/},converters:{"text script":function(e){return C.globalEval(e),e}}}),C.ajaxPrefilter("script",function(e){void 0===e.cache&&(e.cache=!1),e.crossDomain&&(e.type="GET")}),C.ajaxTransport("script",function(e){var t,n;if(e.crossDomain||e.scriptAttrs)return{send:function(i,r){t=C("<script>").attr(e.scriptAttrs||{}).prop({charset:e.scriptCharset,src:e.url}).on("load error",n=function(e){t.remove(),n=null,e&&r("error"===e.type?404:200,e.type)}),o.head.appendChild(t[0])},abort:function(){n&&n()}}});var Gt,Xt=[],Yt=/(=)\?(?=&|$)|\?\?/;C.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var e=Xt.pop()||C.expando+"_"+St++;return this[e]=!0,e}}),C.ajaxPrefilter("json jsonp",function(e,t,i){var r,a,o,s=!1!==e.jsonp&&(Yt.test(e.url)?"url":"string"==typeof e.data&&0===(e.contentType||"").indexOf("application/x-www-form-urlencoded")&&Yt.test(e.data)&&"data");if(s||"jsonp"===e.dataTypes[0])return r=e.jsonpCallback=y(e.jsonpCallback)?e.jsonpCallback():e.jsonpCallback,s?e[s]=e[s].replace(Yt,"$1"+r):!1!==e.jsonp&&(e.url+=(It.test(e.url)?"&":"?")+e.jsonp+"="+r),e.converters["script json"]=function(){return o||C.error(r+" was not called"),o[0]},e.dataTypes[0]="json",a=n[r],n[r]=function(){o=arguments},i.always(function(){void 0===a?C(n).removeProp(r):n[r]=a,e[r]&&(e.jsonpCallback=t.jsonpCallback,Xt.push(r)),o&&y(a)&&a(o[0]),o=a=void 0}),"script"}),v.createHTMLDocument=((Gt=o.implementation.createHTMLDocument("").body).innerHTML="<form></form><form></form>",2===Gt.childNodes.length),C.parseHTML=function(e,t,n){return"string"!=typeof e?[]:("boolean"==typeof t&&(n=t,t=!1),t||(v.createHTMLDocument?((i=(t=o.implementation.createHTMLDocument("")).createElement("base")).href=o.location.href,t.head.appendChild(i)):t=o),r=x.exec(e),a=!n&&[],r?[t.createElement(r[1])]:(r=we([e],t,a),a&&a.length&&C(a).remove(),C.merge([],r.childNodes)));var i,r,a},C.fn.load=function(e,t,n){var i,r,a,o=this,s=e.indexOf(" ");return s>-1&&(i=bt(e.slice(s)),e=e.slice(0,s)),y(t)?(n=t,t=void 0):t&&"object"==typeof t&&(r="POST"),o.length>0&&C.ajax({url:e,type:r||"GET",dataType:"html",data:t}).done(function(e){a=arguments,o.html(i?C("<div>").append(C.parseHTML(e)).find(i):e)}).always(n&&function(e,t){o.each(function(){n.apply(this,a||[e.responseText,t,e])})}),this},C.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(e,t){C.fn[t]=function(e){return this.on(t,e)}}),C.expr.pseudos.animated=function(e){return C.grep(C.timers,function(t){return e===t.elem}).length},C.offset={setOffset:function(e,t,n){var i,r,a,o,s,l,u=C.css(e,"position"),c=C(e),d={};"static"===u&&(e.style.position="relative"),s=c.offset(),a=C.css(e,"top"),l=C.css(e,"left"),("absolute"===u||"fixed"===u)&&(a+l).indexOf("auto")>-1?(o=(i=c.position()).top,r=i.left):(o=parseFloat(a)||0,r=parseFloat(l)||0),y(t)&&(t=t.call(e,n,C.extend({},s))),null!=t.top&&(d.top=t.top-s.top+o),null!=t.left&&(d.left=t.left-s.left+r),"using"in t?t.using.call(e,d):c.css(d)}},C.fn.extend({offset:function(e){if(arguments.length)return void 0===e?this:this.each(function(t){C.offset.setOffset(this,e,t)});var t,n,i=this[0];return i?i.getClientRects().length?(t=i.getBoundingClientRect(),n=i.ownerDocument.defaultView,{top:t.top+n.pageYOffset,left:t.left+n.pageXOffset}):{top:0,left:0}:void 0},position:function(){if(this[0]){var e,t,n,i=this[0],r={top:0,left:0};if("fixed"===C.css(i,"position"))t=i.getBoundingClientRect();else{for(t=this.offset(),n=i.ownerDocument,e=i.offsetParent||n.documentElement;e&&(e===n.body||e===n.documentElement)&&"static"===C.css(e,"position");)e=e.parentNode;e&&e!==i&&1===e.nodeType&&((r=C(e).offset()).top+=C.css(e,"borderTopWidth",!0),r.left+=C.css(e,"borderLeftWidth",!0))}return{top:t.top-r.top-C.css(i,"marginTop",!0),left:t.left-r.left-C.css(i,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var e=this.offsetParent;e&&"static"===C.css(e,"position");)e=e.offsetParent;return e||oe})}}),C.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(e,t){var n="pageYOffset"===t;C.fn[e]=function(i){return H(this,function(e,i,r){var a;if(b(e)?a=e:9===e.nodeType&&(a=e.defaultView),void 0===r)return a?a[t]:e[i];a?a.scrollTo(n?a.pageXOffset:r,n?r:a.pageYOffset):e[i]=r},e,i,arguments.length)}}),C.each(["top","left"],function(e,t){C.cssHooks[t]=We(v.pixelPosition,function(e,n){if(n)return n=ze(e,t),Ve.test(n)?C(e).position()[t]+"px":n})}),C.each({Height:"height",Width:"width"},function(e,t){C.each({padding:"inner"+e,content:t,"":"outer"+e},function(n,i){C.fn[i]=function(r,a){var o=arguments.length&&(n||"boolean"!=typeof r),s=n||(!0===r||!0===a?"margin":"border");return H(this,function(t,n,r){var a;return b(t)?0===i.indexOf("outer")?t["inner"+e]:t.document.documentElement["client"+e]:9===t.nodeType?(a=t.documentElement,Math.max(t.body["scroll"+e],a["scroll"+e],t.body["offset"+e],a["offset"+e],a["client"+e])):void 0===r?C.css(t,n,s):C.style(t,n,r,s)},t,o?r:void 0,o)}})}),C.each("blur focus focusin focusout resize scroll click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup contextmenu".split(" "),function(e,t){C.fn[t]=function(e,n){return arguments.length>0?this.on(t,null,e,n):this.trigger(t)}}),C.fn.extend({hover:function(e,t){return this.mouseenter(e).mouseleave(t||e)}}),C.fn.extend({bind:function(e,t,n){return this.on(e,null,t,n)},unbind:function(e,t){return this.off(e,null,t)},delegate:function(e,t,n,i){return this.on(t,e,n,i)},undelegate:function(e,t,n){return 1===arguments.length?this.off(e,"**"):this.off(t,e||"**",n)}}),C.proxy=function(e,t){var n,i,r;if("string"==typeof t&&(n=e[t],t=e,e=n),y(e))return i=l.call(arguments,2),(r=function(){return e.apply(t||this,i.concat(l.call(arguments)))}).guid=e.guid=e.guid||C.guid++,r},C.holdReady=function(e){e?C.readyWait++:C.ready(!0)},C.isArray=Array.isArray,C.parseJSON=JSON.parse,C.nodeName=R,C.isFunction=y,C.isWindow=b,C.camelCase=X,C.type=E,C.now=Date.now,C.isNumeric=function(e){var t=C.type(e);return("number"===t||"string"===t)&&!isNaN(e-parseFloat(e))},void 0===(i=function(){return C}.apply(t,[]))||(e.exports=i);var Qt=n.jQuery,Jt=n.$;return C.noConflict=function(e){return n.$===C&&(n.$=Jt),e&&n.jQuery===C&&(n.jQuery=Qt),C},r||(n.jQuery=n.$=C),C})},function(e,t,n){(function(t){var n;n="undefined"!=typeof window?window:void 0!==t?t:"undefined"!=typeof self?self:{},e.exports=n}).call(this,n(3))},function(e,t,n){(function(t){var i,r=void 0!==t?t:"undefined"!=typeof window?window:{},a=n(42);"undefined"!=typeof document?i=document:(i=r["__GLOBAL_DOCUMENT_CACHE@4"])||(i=r["__GLOBAL_DOCUMENT_CACHE@4"]=a),e.exports=i}).call(this,n(3))},function(e,t){
/**
 * @license AngularJS v1.5.9
 * (c) 2010-2016 Google, Inc. http://angularjs.org
 * License: MIT
 */
!function(e){"use strict";function t(e,t){return t=t||Error,function(){var n,i,r=arguments,a=r[0],o="["+(e?e+":":"")+a+"] ";for(o+=r[1].replace(/\{\d+\}/g,function(e){var t=+e.slice(1,-1)+2;return t<r.length?Be(r[t]):e}),o+="\nhttp://errors.angularjs.org/1.5.9/"+(e?e+"/":"")+a,i=2,n="?";i<r.length;i++,n="&")o+=n+"p"+(i-2)+"="+encodeURIComponent(Be(r[i]));return new t(o)}}var n=/^\/(.+)\/([a-z]*)$/,i="validity",r=Object.prototype.hasOwnProperty,a=function(e){return j(e)?e.toLowerCase():e},o=function(e){return j(e)?e.toUpperCase():e};"i"!=="I".toLowerCase()&&(a=function(e){return j(e)?e.replace(/[A-Z]/g,function(e){return String.fromCharCode(32|e.charCodeAt(0))}):e},o=function(e){return j(e)?e.replace(/[a-z]/g,function(e){return String.fromCharCode(-33&e.charCodeAt(0))}):e});var s,l,u,c,d=[].slice,h=[].splice,p=[].push,f=Object.prototype.toString,g=Object.getPrototypeOf,m=t("ng"),v=e.angular||(e.angular={}),y=0;function b(e){if(null==e||H(e))return!1;if(U(e)||j(e)||l&&e instanceof l)return!0;var t="length"in Object(e)&&e.length;return B(t)&&(t>=0&&(t-1 in e||e instanceof Array)||"function"==typeof e.item)}function _(e,t,n){var i,a;if(e)if(V(e))for(i in e)"prototype"===i||"length"===i||"name"===i||e.hasOwnProperty&&!e.hasOwnProperty(i)||t.call(n,e[i],i,e);else if(U(e)||b(e)){var o="object"!=typeof e;for(i=0,a=e.length;i<a;i++)(o||i in e)&&t.call(n,e[i],i,e)}else if(e.forEach&&e.forEach!==_)e.forEach(t,n,e);else if($(e))for(i in e)t.call(n,e[i],i,e);else if("function"==typeof e.hasOwnProperty)for(i in e)e.hasOwnProperty(i)&&t.call(n,e[i],i,e);else for(i in e)r.call(e,i)&&t.call(n,e[i],i,e);return e}function T(e,t,n){for(var i=Object.keys(e).sort(),r=0;r<i.length;r++)t.call(n,e[i[r]],i[r]);return i}function E(e){return function(t,n){e(n,t)}}function C(){return++y}function w(e,t){t?e.$$hashKey=t:delete e.$$hashKey}function k(e,t,n){for(var i=e.$$hashKey,r=0,a=t.length;r<a;++r){var o=t[r];if(K(o)||V(o))for(var s=Object.keys(o),l=0,u=s.length;l<u;l++){var c=s[l],d=o[c];n&&K(d)?F(d)?e[c]=new Date(d.valueOf()):q(d)?e[c]=new RegExp(d):d.nodeName?e[c]=d.cloneNode(!0):J(d)?e[c]=d.clone():(K(e[c])||(e[c]=U(d)?[]:{}),k(e[c],[d],!0)):e[c]=d}}return w(e,i),e}function S(e){return k(e,d.call(arguments,1),!1)}function I(e){return k(e,d.call(arguments,1),!0)}function O(e){return parseInt(e,10)}s=e.document.documentMode;var D=Number.isNaN||function(e){return e!=e};function R(e,t){return S(Object.create(e),t)}function x(){}function A(e){return e}function P(e){return function(){return e}}function L(e){return V(e.toString)&&e.toString!==f}function N(e){return void 0===e}function M(e){return void 0!==e}function K(e){return null!==e&&"object"==typeof e}function $(e){return null!==e&&"object"==typeof e&&!g(e)}function j(e){return"string"==typeof e}function B(e){return"number"==typeof e}function F(e){return"[object Date]"===f.call(e)}x.$inject=[],A.$inject=[];var U=Array.isArray;function V(e){return"function"==typeof e}function q(e){return"[object RegExp]"===f.call(e)}function H(e){return e&&e.window===e}function z(e){return e&&e.$evalAsync&&e.$watch}function W(e){return"boolean"==typeof e}function G(e){return e&&V(e.then)}var X=/^\[object (?:Uint8|Uint8Clamped|Uint16|Uint32|Int8|Int16|Int32|Float32|Float64)Array\]$/,Y=function(e){return j(e)?e.trim():e},Q=function(e){return e.replace(/([-()\[\]{}+?*.$\^|,:#<!\\])/g,"\\$1").replace(/\x08/g,"\\x08")};function J(e){return!(!e||!(e.nodeName||e.prop&&e.attr&&e.find))}function Z(e){return a(e.nodeName||e[0]&&e[0].nodeName)}function ee(e,t){var n=e.indexOf(t);return n>=0&&e.splice(n,1),n}function te(e,t){var n,i,a=[],o=[];if(t){if((i=t)&&B(i.length)&&X.test(f.call(i))||(n=t,"[object ArrayBuffer]"===f.call(n)))throw m("cpta","Can't copy! TypedArray destination cannot be mutated.");if(e===t)throw m("cpi","Can't copy! Source and destination are identical.");return U(t)?t.length=0:_(t,function(e,n){"$$hashKey"!==n&&delete t[n]}),a.push(e),o.push(t),s(e,t)}return l(e);function s(e,t){var n,i=t.$$hashKey;if(U(e))for(var a=0,o=e.length;a<o;a++)t.push(l(e[a]));else if($(e))for(n in e)t[n]=l(e[n]);else if(e&&"function"==typeof e.hasOwnProperty)for(n in e)e.hasOwnProperty(n)&&(t[n]=l(e[n]));else for(n in e)r.call(e,n)&&(t[n]=l(e[n]));return w(t,i),t}function l(e){if(!K(e))return e;var t=a.indexOf(e);if(-1!==t)return o[t];if(H(e)||z(e))throw m("cpws","Can't copy! Making copies of Window or Scope instances is not supported.");var n=!1,i=function(e){switch(f.call(e)){case"[object Int8Array]":case"[object Int16Array]":case"[object Int32Array]":case"[object Float32Array]":case"[object Float64Array]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Uint16Array]":case"[object Uint32Array]":return new e.constructor(l(e.buffer),e.byteOffset,e.length);case"[object ArrayBuffer]":if(!e.slice){var t=new ArrayBuffer(e.byteLength);return new Uint8Array(t).set(new Uint8Array(e)),t}return e.slice(0);case"[object Boolean]":case"[object Number]":case"[object String]":case"[object Date]":return new e.constructor(e.valueOf());case"[object RegExp]":var n=new RegExp(e.source,e.toString().match(/[^\/]*$/)[0]);return n.lastIndex=e.lastIndex,n;case"[object Blob]":return new e.constructor([e],{type:e.type})}if(V(e.cloneNode))return e.cloneNode(!0)}(e);return void 0===i&&(i=U(e)?[]:Object.create(g(e)),n=!0),a.push(e),o.push(i),n?s(e,i):i}}function ne(e,t){if(e===t)return!0;if(null===e||null===t)return!1;if(e!=e&&t!=t)return!0;var n,i,r,a=typeof e;if(a===typeof t&&"object"===a){if(!U(e)){if(F(e))return!!F(t)&&ne(e.getTime(),t.getTime());if(q(e))return!!q(t)&&e.toString()===t.toString();if(z(e)||z(t)||H(e)||H(t)||U(t)||F(t)||q(t))return!1;for(i in r=Pe(),e)if("$"!==i.charAt(0)&&!V(e[i])){if(!ne(e[i],t[i]))return!1;r[i]=!0}for(i in t)if(!(i in r)&&"$"!==i.charAt(0)&&M(t[i])&&!V(t[i]))return!1;return!0}if(!U(t))return!1;if((n=e.length)===t.length){for(i=0;i<n;i++)if(!ne(e[i],t[i]))return!1;return!0}}return!1}var ie=function(){if(!M(ie.rules)){var t=e.document.querySelector("[ng-csp]")||e.document.querySelector("[data-ng-csp]");if(t){var n=t.getAttribute("ng-csp")||t.getAttribute("data-ng-csp");ie.rules={noUnsafeEval:!n||-1!==n.indexOf("no-unsafe-eval"),noInlineStyle:!n||-1!==n.indexOf("no-inline-style")}}else ie.rules={noUnsafeEval:function(){try{return new Function(""),!1}catch(e){return!0}}(),noInlineStyle:!1}}return ie.rules},re=function(){if(M(re.name_))return re.name_;var t,n,i,r,a=_e.length;for(n=0;n<a;++n)if(i=_e[n],t=e.document.querySelector("["+i.replace(":","\\:")+"jq]")){r=t.getAttribute(i+"jq");break}return re.name_=r};function ae(e,t,n){return e.concat(d.call(t,n))}function oe(e,t){return d.call(e,t||0)}function se(e,t){var n=arguments.length>2?oe(arguments,2):[];return!V(t)||t instanceof RegExp?t:n.length?function(){return arguments.length?t.apply(e,ae(n,arguments,0)):t.apply(e,n)}:function(){return arguments.length?t.apply(e,arguments):t.call(e)}}function le(t,n){var i=n;return"string"==typeof t&&"$"===t.charAt(0)&&"$"===t.charAt(1)?i=void 0:H(n)?i="$WINDOW":n&&e.document===n?i="$DOCUMENT":z(n)&&(i="$SCOPE"),i}function ue(e,t){if(!N(e))return B(t)||(t=t?2:null),JSON.stringify(e,le,t)}function ce(e){return j(e)?JSON.parse(e):e}var de=/:/g;function he(e,t){e=e.replace(de,"");var n=Date.parse("Jan 01, 1970 00:00:00 "+e)/6e4;return D(n)?t:n}function pe(e,t,n){n=n?-1:1;var i=e.getTimezoneOffset();return function(e,t){return(e=new Date(e.getTime())).setMinutes(e.getMinutes()+t),e}(e,n*(he(t,i)-i))}function fe(e){e=l(e).clone();try{e.empty()}catch(e){}var t=l("<div>").append(e).html();try{return e[0].nodeType===Ne?a(t):t.match(/^(<[^>]+>)/)[1].replace(/^<([\w\-]+)/,function(e,t){return"<"+a(t)})}catch(e){return a(t)}}function ge(e){try{return decodeURIComponent(e)}catch(e){}}function me(e){var t={};return _((e||"").split("&"),function(e){var n,i,a;e&&(i=e=e.replace(/\+/g,"%20"),-1!==(n=e.indexOf("="))&&(i=e.substring(0,n),a=e.substring(n+1)),M(i=ge(i))&&(a=!M(a)||ge(a),r.call(t,i)?U(t[i])?t[i].push(a):t[i]=[t[i],a]:t[i]=a))}),t}function ve(e){var t=[];return _(e,function(e,n){U(e)?_(e,function(e){t.push(be(n,!0)+(!0===e?"":"="+be(e,!0)))}):t.push(be(n,!0)+(!0===e?"":"="+be(e,!0)))}),t.length?t.join("&"):""}function ye(e){return be(e,!0).replace(/%26/gi,"&").replace(/%3D/gi,"=").replace(/%2B/gi,"+")}function be(e,t){return encodeURIComponent(e).replace(/%40/gi,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%3B/gi,";").replace(/%20/g,t?"%20":"+")}var _e=["ng-","data-ng-","ng:","x-ng-"],Te=function(e){if(!e.currentScript)return!0;var t=e.currentScript.getAttribute("src"),n=e.createElement("a");n.href=t;var i=n.protocol;if(e.location.protocol===i)return!0;switch(i){case"http:":case"https:":case"ftp:":case"blob:":case"file:":case"data:":return!0;default:return!1}}(e.document);function Ee(t,n,i){K(i)||(i={}),i=S({strictDi:!1},i);var r=function(){if((t=l(t)).injector()){var r=t[0]===e.document?"document":fe(t);throw m("btstrpd","App already bootstrapped with this element '{0}'",r.replace(/</,"&lt;").replace(/>/,"&gt;"))}(n=n||[]).unshift(["$provide",function(e){e.value("$rootElement",t)}]),i.debugInfoEnabled&&n.push(["$compileProvider",function(e){e.debugInfoEnabled(!0)}]),n.unshift("ng");var a=Ft(n,i.strictDi);return a.invoke(["$rootScope","$rootElement","$compile","$injector",function(e,t,n,i){e.$apply(function(){t.data("$injector",i),n(t)(e)})}]),a},a=/^NG_ENABLE_DEBUG_INFO!/,o=/^NG_DEFER_BOOTSTRAP!/;if(e&&a.test(e.name)&&(i.debugInfoEnabled=!0,e.name=e.name.replace(a,"")),e&&!o.test(e.name))return r();e.name=e.name.replace(o,""),v.resumeBootstrap=function(e){return _(e,function(e){n.push(e)}),r()},V(v.resumeDeferredBootstrap)&&v.resumeDeferredBootstrap()}function Ce(){e.name="NG_ENABLE_DEBUG_INFO!"+e.name,e.location.reload()}function we(e){var t=v.element(e).injector();if(!t)throw m("test","no injector found for element argument to getTestability");return t.get("$$testability")}var ke=/[A-Z]/g;function Se(e,t){return t=t||"_",e.replace(ke,function(e,n){return(n?t:"")+e.toLowerCase()})}var Ie=!1;function Oe(e,t,n){if(!e)throw m("areq","Argument '{0}' is {1}",t||"?",n||"required");return e}function De(e,t,n){return n&&U(e)&&(e=e[e.length-1]),Oe(V(e),t,"not a function, got "+(e&&"object"==typeof e?e.constructor.name||"Object":typeof e)),e}function Re(e,t){if("hasOwnProperty"===e)throw m("badname","hasOwnProperty is not a valid {0} name",t)}function xe(e,t,n){if(!t)return e;for(var i,r=t.split("."),a=e,o=r.length,s=0;s<o;s++)i=r[s],e&&(e=(a=e)[i]);return!n&&V(e)?se(a,e):e}function Ae(e){for(var t,n=e[0],i=e[e.length-1],r=1;n!==i&&(n=n.nextSibling);r++)(t||e[r]!==n)&&(t||(t=l(d.call(e,0,r))),t.push(n));return t||e}function Pe(){return Object.create(null)}var Le=1,Ne=3,Me=8,Ke=9,$e=11;function je(e,t){if(U(e)){t=t||[];for(var n=0,i=e.length;n<i;n++)t[n]=e[n]}else if(K(e))for(var r in t=t||{},e)"$"===r.charAt(0)&&"$"===r.charAt(1)||(t[r]=e[r]);return t||e}function Be(e){return"function"==typeof e?e.toString().replace(/ \{[\s\S]*$/,""):N(e)?"undefined":"string"!=typeof e?function(e){var t=[];return JSON.stringify(e,function(e,n){if(K(n=le(e,n))){if(t.indexOf(n)>=0)return"...";t.push(n)}return n})}(e):e}var Fe={full:"1.5.9",major:1,minor:5,dot:9,codeName:"timeturning-lockdown"};st.expando="ng339";var Ue=st.cache={},Ve=1,qe=function(e,t,n){e.addEventListener(t,n,!1)},He=function(e,t,n){e.removeEventListener(t,n,!1)};st._data=function(e){return this.cache[e[this.expando]]||{}};var ze=/([:\-_]+(.))/g,We=/^moz([A-Z])/,Ge={mouseleave:"mouseout",mouseenter:"mouseover"},Xe=t("jqLite");function Ye(e){return e.replace(ze,function(e,t,n,i){return i?n.toUpperCase():n}).replace(We,"Moz$1")}var Qe=/^<([\w-]+)\s*\/?>(?:<\/\1>|)$/,Je=/<|&#?\w+;/,Ze=/<([\w:-]+)/,et=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:-]+)[^>]*)\/>/gi,tt={option:[1,'<select multiple="multiple">',"</select>"],thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};function nt(e){return!Je.test(e)}function it(e){var t=e.nodeType;return t===Le||!t||t===Ke}function rt(e,t){var n,i,r,a,o=t.createDocumentFragment(),s=[];if(nt(e))s.push(t.createTextNode(e));else{for(n=o.appendChild(t.createElement("div")),i=(Ze.exec(e)||["",""])[1].toLowerCase(),r=tt[i]||tt._default,n.innerHTML=r[1]+e.replace(et,"<$1></$2>")+r[2],a=r[0];a--;)n=n.lastChild;s=ae(s,n.childNodes),(n=o.firstChild).textContent=""}return o.textContent="",o.innerHTML="",_(s,function(e){o.appendChild(e)}),o}function at(e,t){var n=e.parentNode;n&&n.replaceChild(t,e),t.appendChild(e)}tt.optgroup=tt.option,tt.tbody=tt.tfoot=tt.colgroup=tt.caption=tt.thead,tt.th=tt.td;var ot=e.Node.prototype.contains||function(e){return!!(16&this.compareDocumentPosition(e))};function st(t){if(t instanceof st)return t;var n,i,r,a;if(j(t)&&(t=Y(t),n=!0),!(this instanceof st)){if(n&&"<"!==t.charAt(0))throw Xe("nosel","Looking up elements via selectors is not supported by jqLite! See: http://docs.angularjs.org/api/angular.element");return new st(t)}vt(this,n?(i=t,r=r||e.document,(a=Qe.exec(i))?[r.createElement(a[1])]:(a=rt(i,r))?a.childNodes:[]):t)}function lt(e){return e.cloneNode(!0)}function ut(e,t){if(t||dt(e),e.querySelectorAll)for(var n=e.querySelectorAll("*"),i=0,r=n.length;i<r;i++)dt(n[i])}function ct(e,t,n,i){if(M(i))throw Xe("offargs","jqLite#off() does not support the `selector` argument");var r=ht(e),a=r&&r.events,o=r&&r.handle;if(o)if(t){var s=function(t){var i=a[t];M(n)&&ee(i||[],n),M(n)&&i&&i.length>0||(He(e,t,o),delete a[t])};_(t.split(" "),function(e){s(e),Ge[e]&&s(Ge[e])})}else for(t in a)"$destroy"!==t&&He(e,t,o),delete a[t]}function dt(e,t){var n=e.ng339,i=n&&Ue[n];if(i){if(t)return void delete i.data[t];i.handle&&(i.events.$destroy&&i.handle({},"$destroy"),ct(e)),delete Ue[n],e.ng339=void 0}}function ht(e,t){var n=e.ng339,i=n&&Ue[n];return t&&!i&&(e.ng339=n=++Ve,i=Ue[n]={events:{},data:{},handle:void 0}),i}function pt(e,t,n){if(it(e)){var i=M(n),r=!i&&t&&!K(t),a=!t,o=ht(e,!r),s=o&&o.data;if(i)s[t]=n;else{if(a)return s;if(r)return s&&s[t];S(s,t)}}}function ft(e,t){return!!e.getAttribute&&(" "+(e.getAttribute("class")||"")+" ").replace(/[\n\t]/g," ").indexOf(" "+t+" ")>-1}function gt(e,t){t&&e.setAttribute&&_(t.split(" "),function(t){e.setAttribute("class",Y((" "+(e.getAttribute("class")||"")+" ").replace(/[\n\t]/g," ").replace(" "+Y(t)+" "," ")))})}function mt(e,t){if(t&&e.setAttribute){var n=(" "+(e.getAttribute("class")||"")+" ").replace(/[\n\t]/g," ");_(t.split(" "),function(e){e=Y(e),-1===n.indexOf(" "+e+" ")&&(n+=e+" ")}),e.setAttribute("class",Y(n))}}function vt(e,t){if(t)if(t.nodeType)e[e.length++]=t;else{var n=t.length;if("number"==typeof n&&t.window!==t){if(n)for(var i=0;i<n;i++)e[e.length++]=t[i]}else e[e.length++]=t}}function yt(e,t){return bt(e,"$"+(t||"ngController")+"Controller")}function bt(e,t,n){e.nodeType===Ke&&(e=e.documentElement);for(var i=U(t)?t:[t];e;){for(var r=0,a=i.length;r<a;r++)if(M(n=l.data(e,i[r])))return n;e=e.parentNode||e.nodeType===$e&&e.host}}function _t(e){for(ut(e,!0);e.firstChild;)e.removeChild(e.firstChild)}function Tt(e,t){t||ut(e);var n=e.parentNode;n&&n.removeChild(e)}var Et=st.prototype={ready:function(t){var n=!1;function i(){n||(n=!0,t())}"complete"===e.document.readyState?e.setTimeout(i):(this.on("DOMContentLoaded",i),st(e).on("load",i))},toString:function(){var e=[];return _(this,function(t){e.push(""+t)}),"["+e.join(", ")+"]"},eq:function(e){return l(e>=0?this[e]:this[this.length+e])},length:0,push:p,sort:[].sort,splice:[].splice},Ct={};_("multiple,selected,checked,disabled,readOnly,required,open".split(","),function(e){Ct[a(e)]=e});var wt={};_("input,select,option,textarea,button,form,details".split(","),function(e){wt[e]=!0});var kt={ngMinlength:"minlength",ngMaxlength:"maxlength",ngMin:"min",ngMax:"max",ngPattern:"pattern"};function St(e,t){var n=Ct[t.toLowerCase()];return n&&wt[Z(e)]&&n}function It(e,t,n){n.call(e,t)}function Ot(e,t,n){var i=t.relatedTarget;i&&(i===e||ot.call(e,i))||n.call(e,t)}function Dt(){this.$get=function(){return S(st,{hasClass:function(e,t){return e.attr&&(e=e[0]),ft(e,t)},addClass:function(e,t){return e.attr&&(e=e[0]),mt(e,t)},removeClass:function(e,t){return e.attr&&(e=e[0]),gt(e,t)}})}}function Rt(e,t){var n=e&&e.$$hashKey;if(n)return"function"==typeof n&&(n=e.$$hashKey()),n;var i=typeof e;return"function"===i||"object"===i&&null!==e?e.$$hashKey=i+":"+(t||C)():i+":"+e}function xt(e,t){if(t){var n=0;this.nextUid=function(){return++n}}_(e,this.put,this)}_({data:pt,removeData:dt,hasData:function(e){for(var t in Ue[e.ng339])return!0;return!1},cleanData:function(e){for(var t=0,n=e.length;t<n;t++)dt(e[t])}},function(e,t){st[t]=e}),_({data:pt,inheritedData:bt,scope:function(e){return l.data(e,"$scope")||bt(e.parentNode||e,["$isolateScope","$scope"])},isolateScope:function(e){return l.data(e,"$isolateScope")||l.data(e,"$isolateScopeNoTemplate")},controller:yt,injector:function(e){return bt(e,"$injector")},removeAttr:function(e,t){e.removeAttribute(t)},hasClass:ft,css:function(e,t,n){if(t=Ye(t),!M(n))return e.style[t];e.style[t]=n},attr:function(e,t,n){var i=e.nodeType;if(i!==Ne&&2!==i&&i!==Me){var r=a(t);if(Ct[r]){if(!M(n))return e[t]||(e.attributes.getNamedItem(t)||x).specified?r:void 0;n?(e[t]=!0,e.setAttribute(t,r)):(e[t]=!1,e.removeAttribute(r))}else if(M(n))e.setAttribute(t,n);else if(e.getAttribute){var o=e.getAttribute(t,2);return null===o?void 0:o}}},prop:function(e,t,n){if(!M(n))return e[t];e[t]=n},text:function(){return e.$dv="",e;function e(e,t){if(N(t)){var n=e.nodeType;return n===Le||n===Ne?e.textContent:""}e.textContent=t}}(),val:function(e,t){if(N(t)){if(e.multiple&&"select"===Z(e)){var n=[];return _(e.options,function(e){e.selected&&n.push(e.value||e.text)}),0===n.length?null:n}return e.value}e.value=t},html:function(e,t){if(N(t))return e.innerHTML;ut(e,!0),e.innerHTML=t},empty:_t},function(e,t){st.prototype[t]=function(t,n){var i,r,a=this.length;if(e!==_t&&N(2===e.length&&e!==ft&&e!==yt?t:n)){if(K(t)){for(i=0;i<a;i++)if(e===pt)e(this[i],t);else for(r in t)e(this[i],r,t[r]);return this}for(var o=e.$dv,s=N(o)?Math.min(a,1):a,l=0;l<s;l++){var u=e(this[l],t,n);o=o?o+u:u}return o}for(i=0;i<a;i++)e(this[i],t,n);return this}}),_({removeData:dt,on:function(e,t,n,i){if(M(i))throw Xe("onargs","jqLite#on() does not support the `selector` or `eventData` parameters");if(it(e)){var r=ht(e,!0),a=r.events,o=r.handle;o||(o=r.handle=function(e,t){var n=function(n,i){n.isDefaultPrevented=function(){return n.defaultPrevented};var r=t[i||n.type],a=r?r.length:0;if(a){if(N(n.immediatePropagationStopped)){var o=n.stopImmediatePropagation;n.stopImmediatePropagation=function(){n.immediatePropagationStopped=!0,n.stopPropagation&&n.stopPropagation(),o&&o.call(n)}}n.isImmediatePropagationStopped=function(){return!0===n.immediatePropagationStopped};var s=r.specialHandlerWrapper||It;a>1&&(r=je(r));for(var l=0;l<a;l++)n.isImmediatePropagationStopped()||s(e,n,r[l])}};return n.elem=e,n}(e,a));for(var s=t.indexOf(" ")>=0?t.split(" "):[t],l=s.length,u=function(t,i,r){var s=a[t];s||((s=a[t]=[]).specialHandlerWrapper=i,"$destroy"===t||r||qe(e,t,o)),s.push(n)};l--;)t=s[l],Ge[t]?(u(Ge[t],Ot),u(t,void 0,!0)):u(t)}},off:ct,one:function(e,t,n){(e=l(e)).on(t,function i(){e.off(t,n),e.off(t,i)}),e.on(t,n)},replaceWith:function(e,t){var n,i=e.parentNode;ut(e),_(new st(t),function(t){n?i.insertBefore(t,n.nextSibling):i.replaceChild(t,e),n=t})},children:function(e){var t=[];return _(e.childNodes,function(e){e.nodeType===Le&&t.push(e)}),t},contents:function(e){return e.contentDocument||e.childNodes||[]},append:function(e,t){var n=e.nodeType;if(n===Le||n===$e)for(var i=0,r=(t=new st(t)).length;i<r;i++){var a=t[i];e.appendChild(a)}},prepend:function(e,t){if(e.nodeType===Le){var n=e.firstChild;_(new st(t),function(t){e.insertBefore(t,n)})}},wrap:function(e,t){at(e,l(t).eq(0).clone()[0])},remove:Tt,detach:function(e){Tt(e,!0)},after:function(e,t){for(var n=e,i=e.parentNode,r=0,a=(t=new st(t)).length;r<a;r++){var o=t[r];i.insertBefore(o,n.nextSibling),n=o}},addClass:mt,removeClass:gt,toggleClass:function(e,t,n){t&&_(t.split(" "),function(t){var i=n;N(i)&&(i=!ft(e,t)),(i?mt:gt)(e,t)})},parent:function(e){var t=e.parentNode;return t&&t.nodeType!==$e?t:null},next:function(e){return e.nextElementSibling},find:function(e,t){return e.getElementsByTagName?e.getElementsByTagName(t):[]},clone:lt,triggerHandler:function(e,t,n){var i,r,a,o=t.type||t,s=ht(e),l=s&&s.events,u=l&&l[o];u&&(i={preventDefault:function(){this.defaultPrevented=!0},isDefaultPrevented:function(){return!0===this.defaultPrevented},stopImmediatePropagation:function(){this.immediatePropagationStopped=!0},isImmediatePropagationStopped:function(){return!0===this.immediatePropagationStopped},stopPropagation:x,type:o,target:e},t.type&&(i=S(i,t)),r=je(u),a=n?[i].concat(n):[i],_(r,function(t){i.isImmediatePropagationStopped()||t.apply(e,a)}))}},function(e,t){st.prototype[t]=function(t,n,i){for(var r,a=0,o=this.length;a<o;a++)N(r)?M(r=e(this[a],t,n,i))&&(r=l(r)):vt(r,e(this[a],t,n,i));return M(r)?r:this},st.prototype.bind=st.prototype.on,st.prototype.unbind=st.prototype.off}),xt.prototype={put:function(e,t){this[Rt(e,this.nextUid)]=t},get:function(e){return this[Rt(e,this.nextUid)]},remove:function(e){var t=this[e=Rt(e,this.nextUid)];return delete this[e],t}};var At=[function(){this.$get=[function(){return xt}]}],Pt=/^([^\(]+?)=>/,Lt=/^[^\(]*\(\s*([^\)]*)\)/m,Nt=/,/,Mt=/^\s*(_?)(\S+?)\1\s*$/,Kt=/((\/\/.*$)|(\/\*[\s\S]*?\*\/))/gm,$t=t("$injector");function jt(e){return Function.prototype.toString.call(e)+" "}function Bt(e){var t=jt(e).replace(Kt,"");return t.match(Pt)||t.match(Lt)}function Ft(e,t){t=!0===t;var n={},i="Provider",r=[],a=new xt([],!0),o={$provide:{provider:f(g),factory:f(m),service:f(function(e,t){return m(e,["$injector",function(e){return e.instantiate(t)}])}),value:f(function(e,t){return m(e,P(t),!1)}),constant:f(function(e,t){Re(e,"constant"),o[e]=t,u[e]=t}),decorator:function(e,t){var n=l.get(e+i),r=n.$get;n.$get=function(){var e=h.invoke(r,n);return h.invoke(t,null,{$delegate:e})}}}},l=o.$injector=y(o,function(e,t){throw v.isString(t)&&r.push(t),$t("unpr","Unknown provider: {0}",r.join(" <- "))}),u={},d=y(u,function(e,t){var n=l.get(e+i,t);return h.invoke(n.$get,n,void 0,e)}),h=d;o["$injector"+i]={$get:P(d)};var p=function e(t){Oe(N(t)||U(t),"modulesToLoad","not an array");var n,i=[];return _(t,function(t){if(!a.get(t)){a.put(t,!0);try{j(t)?(n=c(t),i=i.concat(e(n.requires)).concat(n._runBlocks),r(n._invokeQueue),r(n._configBlocks)):V(t)?i.push(l.invoke(t)):U(t)?i.push(l.invoke(t)):De(t,"module")}catch(e){throw U(t)&&(t=t[t.length-1]),e.message&&e.stack&&-1===e.stack.indexOf(e.message)&&(e=e.message+"\n"+e.stack),$t("modulerr","Failed to instantiate module {0} due to:\n{1}",t,e.stack||e.message||e)}}function r(e){var t,n;for(t=0,n=e.length;t<n;t++){var i=e[t],r=l.get(i[0]);r[i[1]].apply(r,i[2])}}}),i}(e);return(h=d.get("$injector")).strictDi=t,_(p,function(e){e&&h.invoke(e)}),h;function f(e){return function(t,n){if(!K(t))return e(t,n);_(t,E(e))}}function g(e,t){if(Re(e,"service"),(V(t)||U(t))&&(t=l.instantiate(t)),!t.$get)throw $t("pget","Provider '{0}' must define $get factory method.",e);return o[e+i]=t}function m(e,t,n){return g(e,{$get:!1!==n?function(e,t){return function(){var n=h.invoke(t,this);if(N(n))throw $t("undef","Provider '{0}' must return a value from $get factory method.",e);return n}}(e,t):t})}function y(e,a){function l(t,i){if(e.hasOwnProperty(t)){if(e[t]===n)throw $t("cdep","Circular dependency found: {0}",t+" <- "+r.join(" <- "));return e[t]}try{return r.unshift(t),e[t]=n,e[t]=a(t,i),e[t]}catch(i){throw e[t]===n&&delete e[t],i}finally{r.shift()}}function u(e,n,i){for(var r=[],a=Ft.$$annotate(e,t,i),o=0,s=a.length;o<s;o++){var u=a[o];if("string"!=typeof u)throw $t("itkn","Incorrect injection token! Expected service name as string, got {0}",u);r.push(n&&n.hasOwnProperty(u)?n[u]:l(u,i))}return r}return{invoke:function(e,t,n,i){"string"==typeof n&&(i=n,n=null);var r,a=u(e,n,i);return U(e)&&(e=e[e.length-1]),r=e,s<=11||"function"!=typeof r||!/^(?:class\b|constructor\()/.test(jt(r))?e.apply(t,a):(a.unshift(null),new(Function.prototype.bind.apply(e,a)))},instantiate:function(e,t,n){var i=U(e)?e[e.length-1]:e,r=u(e,t,n);return r.unshift(null),new(Function.prototype.bind.apply(i,r))},get:l,annotate:Ft.$$annotate,has:function(t){return o.hasOwnProperty(t+i)||e.hasOwnProperty(t)}}}}function Ut(){var t=!0;this.disableAutoScrolling=function(){t=!1},this.$get=["$window","$location","$rootScope",function(n,i,r){var a=n.document;function o(e){if(e){e.scrollIntoView();var t=function(){var e=s.yOffset;if(V(e))e=e();else if(J(e)){var t=e[0];e="fixed"!==n.getComputedStyle(t).position?0:t.getBoundingClientRect().bottom}else B(e)||(e=0);return e}();if(t){var i=e.getBoundingClientRect().top;n.scrollBy(0,i-t)}}else n.scrollTo(0,0)}function s(e){var t,n,r;(e=j(e)?e:i.hash())?(t=a.getElementById(e))?o(t):(n=a.getElementsByName(e),r=null,Array.prototype.some.call(n,function(e){if("a"===Z(e))return r=e,!0}),(t=r)?o(t):"top"===e&&o(null)):o(null)}return t&&r.$watch(function(){return i.hash()},function(t,n){var i,a;t===n&&""===t||(i=function(){r.$evalAsync(s)},"complete"===(a=a||e).document.readyState?a.setTimeout(i):l(a).on("load",i))}),s}]}Ft.$$annotate=function(e,t,n){var i,r;if("function"==typeof e){if(!(i=e.$inject)){if(i=[],e.length){if(t)throw j(n)&&n||(n=e.name||function(e){var t=Bt(e);return t?"function("+(t[1]||"").replace(/[\s\r\n]+/," ")+")":"fn"}(e)),$t("strictdi","{0} is not using explicit annotation and cannot be invoked in strict mode",n);_(Bt(e)[1].split(Nt),function(e){e.replace(Mt,function(e,t,n){i.push(n)})})}e.$inject=i}}else U(e)?(De(e[r=e.length-1],"fn"),i=e.slice(0,r)):De(e,"fn",!0);return i};var Vt=t("$animate"),qt=1;function Ht(e,t){return e||t?e?t?(U(e)&&(e=e.join(" ")),U(t)&&(t=t.join(" ")),e+" "+t):e:t:""}function zt(e){return K(e)?e:{}}var Wt=function(){this.$get=x},Gt=function(){var e=new xt,t=[];this.$get=["$$AnimateRunner","$rootScope",function(n,i){return{enabled:x,on:x,off:x,pin:x,push:function(o,s,l,u){u&&u(),(l=l||{}).from&&o.css(l.from),l.to&&o.css(l.to),(l.addClass||l.removeClass)&&function(n,o,s){var l=e.get(n)||{},u=r(l,o,!0),c=r(l,s,!1);(u||c)&&(e.put(n,l),t.push(n),1===t.length&&i.$$postDigest(a))}(o,l.addClass,l.removeClass);var c=new n;return c.complete(),c}};function r(e,t,n){var i=!1;return t&&_(t=j(t)?t.split(" "):U(t)?t:[],function(t){t&&(i=!0,e[t]=n)}),i}function a(){_(t,function(t){var n=e.get(t);if(n){var i=function(e){j(e)&&(e=e.split(" "));var t=Pe();return _(e,function(e){e.length&&(t[e]=!0)}),t}(t.attr("class")),r="",a="";_(n,function(e,t){e!==!!i[t]&&(e?r+=(r.length?" ":"")+t:a+=(a.length?" ":"")+t)}),_(t,function(e){r&&mt(e,r),a&&gt(e,a)}),e.remove(t)}}),t.length=0}}]},Xt=["$provide",function(e){var t=this;this.$$registeredAnimations=Object.create(null),this.register=function(n,i){if(n&&"."!==n.charAt(0))throw Vt("notcsel","Expecting class selector starting with '.' got '{0}'.",n);var r=n+"-animation";t.$$registeredAnimations[n.substr(1)]=r,e.factory(r,i)},this.classNameFilter=function(e){if(1===arguments.length&&(this.$$classNameFilter=e instanceof RegExp?e:null,this.$$classNameFilter&&new RegExp("(\\s+|\\/)ng-animate(\\s+|\\/)").test(this.$$classNameFilter.toString())))throw Vt("nongcls",'$animateProvider.classNameFilter(regex) prohibits accepting a regex value which matches/contains the "{0}" CSS class.',"ng-animate");return this.$$classNameFilter},this.$get=["$$animateQueue",function(e){function t(e,t,n){if(n){var i=function(e){for(var t=0;t<e.length;t++){var n=e[t];if(n.nodeType===qt)return n}}(n);!i||i.parentNode||i.previousElementSibling||(n=null)}n?n.after(e):t.prepend(e)}return{on:e.on,off:e.off,pin:e.pin,enabled:e.enabled,cancel:function(e){e.end&&e.end()},enter:function(n,i,r,a){return i=i&&l(i),r=r&&l(r),t(n,i=i||r.parent(),r),e.push(n,"enter",zt(a))},move:function(n,i,r,a){return i=i&&l(i),r=r&&l(r),t(n,i=i||r.parent(),r),e.push(n,"move",zt(a))},leave:function(t,n){return e.push(t,"leave",zt(n),function(){t.remove()})},addClass:function(t,n,i){return(i=zt(i)).addClass=Ht(i.addclass,n),e.push(t,"addClass",i)},removeClass:function(t,n,i){return(i=zt(i)).removeClass=Ht(i.removeClass,n),e.push(t,"removeClass",i)},setClass:function(t,n,i,r){return(r=zt(r)).addClass=Ht(r.addClass,n),r.removeClass=Ht(r.removeClass,i),e.push(t,"setClass",r)},animate:function(t,n,i,r,a){return(a=zt(a)).from=a.from?S(a.from,n):n,a.to=a.to?S(a.to,i):i,r=r||"ng-inline-animate",a.tempClasses=Ht(a.tempClasses,r),e.push(t,"animate",a)}}}]}],Yt=function(){this.$get=["$$rAF",function(e){var t=[];function n(n){t.push(n),t.length>1||e(function(){for(var e=0;e<t.length;e++)t[e]();t=[]})}return function(){var e=!1;return n(function(){e=!0}),function(t){e?t():n(t)}}}]},Qt=function(){this.$get=["$q","$sniffer","$$animateAsyncRun","$document","$timeout",function(e,t,n,i,r){function a(e){this.setHost(e);var t=n();this._doneCallbacks=[],this._tick=function(e){var n=i[0];n&&n.hidden?function(e){r(e,0,!1)}(e):t(e)},this._state=0}return a.chain=function(e,t){var n=0;!function i(){n!==e.length?e[n](function(e){!1!==e?(n++,i()):t(!1)}):t(!0)}()},a.all=function(e,t){var n=0,i=!0;function r(r){i=i&&r,++n===e.length&&t(i)}_(e,function(e){e.done(r)})},a.prototype={setHost:function(e){this.host=e||{}},done:function(e){2===this._state?e():this._doneCallbacks.push(e)},progress:x,getPromise:function(){if(!this.promise){var t=this;this.promise=e(function(e,n){t.done(function(t){!1===t?n():e()})})}return this.promise},then:function(e,t){return this.getPromise().then(e,t)},catch:function(e){return this.getPromise().catch(e)},finally:function(e){return this.getPromise().finally(e)},pause:function(){this.host.pause&&this.host.pause()},resume:function(){this.host.resume&&this.host.resume()},end:function(){this.host.end&&this.host.end(),this._resolve(!0)},cancel:function(){this.host.cancel&&this.host.cancel(),this._resolve(!1)},complete:function(e){var t=this;0===t._state&&(t._state=1,t._tick(function(){t._resolve(e)}))},_resolve:function(e){2!==this._state&&(_(this._doneCallbacks,function(t){t(e)}),this._doneCallbacks.length=0,this._state=2)}},a}]},Jt=function(){this.$get=["$$rAF","$q","$$AnimateRunner",function(e,t,n){return function(t,i){var r=i||{};r.$$prepared||(r=te(r)),r.cleanupStyles&&(r.from=r.to=null),r.from&&(t.css(r.from),r.from=null);var a,o=new n;return{start:s,end:s};function s(){return e(function(){r.addClass&&(t.addClass(r.addClass),r.addClass=null),r.removeClass&&(t.removeClass(r.removeClass),r.removeClass=null),r.to&&(t.css(r.to),r.to=null),a||o.complete(),a=!0}),o}}}]};function Zt(){this.$get=["$window","$log","$sniffer","$document",function(e,t,n,i){return new function(e,t,n,i){var r=this,a=e.location,o=e.history,s=e.setTimeout,u=e.clearTimeout,c={};r.isMock=!1;var d=0,h=[];function p(e){try{e.apply(null,oe(arguments,1))}finally{if(0==--d)for(;h.length;)try{h.pop()()}catch(e){n.error(e)}}}r.$$completeOutstandingRequest=p,r.$$incOutstandingRequestCount=function(){d++},r.notifyWhenNoOutstandingRequests=function(e){0===d?e():h.push(e)};var f,g,m=a.href,v=t.find("base"),y=null,b=i.history?function(){try{return o.state}catch(e){}}:x;k(),g=f,r.url=function(t,n,s){if(N(s)&&(s=null),a!==e.location&&(a=e.location),o!==e.history&&(o=e.history),t){var l=g===s;if(m===t&&(!i.history||l))return r;var u=m&&Xn(m)===Xn(t);return m=t,g=s,!i.history||u&&l?(u||(y=t),n?a.replace(t):u?a.hash=function(e){var t=e.indexOf("#");return-1===t?"":e.substr(t)}(t):a.href=t,a.href!==t&&(y=t)):(o[n?"replaceState":"pushState"](s,"",t),k(),g=f),y&&(y=t),r}return y||a.href.replace(/%27/g,"'")},r.state=function(){return f};var T=[],E=!1;function C(){y=null,k(),S()}var w=null;function k(){ne(f=N(f=b())?null:f,w)&&(f=w),w=f}function S(){m===r.url()&&g===f||(m=r.url(),g=f,_(T,function(e){e(r.url(),f)}))}r.onUrlChange=function(t){return E||(i.history&&l(e).on("popstate",C),l(e).on("hashchange",C),E=!0),T.push(t),t},r.$$applicationDestroyed=function(){l(e).off("hashchange popstate",C)},r.$$checkUrlChange=S,r.baseHref=function(){var e=v.attr("href");return e?e.replace(/^(https?:)?\/\/[^\/]*/,""):""},r.defer=function(e,t){var n;return d++,n=s(function(){delete c[n],p(e)},t||0),c[n]=!0,n},r.defer.cancel=function(e){return!!c[e]&&(delete c[e],u(e),p(x),!0)}}(e,i,t,n)}]}function en(){this.$get=function(){var e={};function n(n,i){if(n in e)throw t("$cacheFactory")("iid","CacheId '{0}' is already taken!",n);var r=0,a=S({},i,{id:n}),o=Pe(),s=i&&i.capacity||Number.MAX_VALUE,l=Pe(),u=null,c=null;return e[n]={put:function(e,t){if(!N(t))return s<Number.MAX_VALUE&&d(l[e]||(l[e]={key:e})),e in o||r++,o[e]=t,r>s&&this.remove(c.key),t},get:function(e){if(s<Number.MAX_VALUE){var t=l[e];if(!t)return;d(t)}return o[e]},remove:function(e){if(s<Number.MAX_VALUE){var t=l[e];if(!t)return;t===u&&(u=t.p),t===c&&(c=t.n),h(t.n,t.p),delete l[e]}e in o&&(delete o[e],r--)},removeAll:function(){o=Pe(),r=0,l=Pe(),u=c=null},destroy:function(){o=null,a=null,l=null,delete e[n]},info:function(){return S({},a,{size:r})}};function d(e){e!==u&&(c?c===e&&(c=e.n):c=e,h(e.n,e.p),h(e,u),(u=e).n=null)}function h(e,t){e!==t&&(e&&(e.p=t),t&&(t.n=e))}}return n.info=function(){var t={};return _(e,function(e,n){t[n]=e.info()}),t},n.get=function(t){return e[t]},n}}function tn(){this.$get=["$cacheFactory",function(e){return e("templates")}]}var nn=t("$compile"),rn=new function(){};function an(t,n){var i={},o="Directive",u=/^\s*directive:\s*([\w\-]+)\s+(.*)$/,c=/(([\w\-]+)(?::([^;]+))?;?)/,d=function(e){var t,n={},i="ngSrc,ngSrcset,src,srcset".split(",");for(t=0;t<i.length;t++)n[i[t]]=!0;return n}(),h=/^(?:(\^\^?)?(\?)?(\^\^?)?)?/,p=/^(on[a-z]+|formaction)$/,g=Pe();function m(e,t,n){var i=/^\s*([@&<]|=(\*?))(\??)\s*(\w*)\s*$/,r=Pe();return _(e,function(e,a){if(e in g)r[a]=g[e];else{var o=e.match(i);if(!o)throw nn("iscp","Invalid {3} for directive '{0}'. Definition: {... {1}: '{2}' ...}",t,a,e,n?"controller bindings definition":"isolate scope definition");r[a]={mode:o[1][0],collection:"*"===o[2],optional:"?"===o[3],attrName:o[4]||a},o[4]&&(g[e]=r[a])}}),r}function v(e,t){var n={isolateScope:null,bindToController:null};if(K(e.scope)&&(!0===e.bindToController?(n.bindToController=m(e.scope,t,!0),n.isolateScope={}):n.isolateScope=m(e.scope,t,!1)),K(e.bindToController)&&(n.bindToController=m(e.bindToController,t,!0)),K(n.bindToController)){var i=e.controller,r=e.controllerAs;if(!i)throw nn("noctrl","Cannot bind to controller without directive '{0}'s controller.",t);if(!pn(i,r))throw nn("noident","Cannot bind to controller without identifier for directive '{0}'.",t)}return n}this.directive=function e(n,r){return Re(n,"directive"),j(n)?(function(e){var t=e.charAt(0);if(!t||t!==a(t))throw nn("baddir","Directive/Component name '{0}' is invalid. The first character must be a lowercase letter",e);if(e!==e.trim())throw nn("baddir","Directive/Component name '{0}' is invalid. The name should not contain leading or trailing whitespaces",e)}(n),Oe(r,"directiveFactory"),i.hasOwnProperty(n)||(i[n]=[],t.factory(n+o,["$injector","$exceptionHandler",function(e,t){var r=[];return _(i[n],function(i,a){try{var o=e.invoke(i);V(o)?o={compile:P(o)}:!o.compile&&o.link&&(o.compile=P(o.link)),o.priority=o.priority||0,o.index=a,o.name=o.name||n,o.require=function(e){var t=e.require||e.controller&&e.name;return!U(t)&&K(t)&&_(t,function(e,n){var i=e.match(h);e.substring(i[0].length)||(t[n]=i[0]+n)}),t}(o),o.restrict=o.restrict||"EA",o.$$moduleName=i.$$moduleName,r.push(o)}catch(e){t(e)}}),r}])),i[n].push(r)):_(n,E(e)),this},this.component=function(e,t){var n=t.controller||function(){};function i(e){function i(t){return V(t)||U(t)?function(n,i){return e.invoke(t,this,{$element:n,$attrs:i})}:t}var r=t.template||t.templateUrl?t.template:"",a={controller:n,controllerAs:pn(t.controller)||t.controllerAs||"$ctrl",template:i(r),templateUrl:i(t.templateUrl),transclude:t.transclude,scope:{},bindToController:t.bindings||{},restrict:"E",require:t.require};return _(t,function(e,t){"$"===t.charAt(0)&&(a[t]=e)}),a}return _(t,function(e,t){"$"===t.charAt(0)&&(i[t]=e,V(n)&&(n[t]=e))}),i.$inject=["$injector"],this.directive(e,i)},this.aHrefSanitizationWhitelist=function(e){return M(e)?(n.aHrefSanitizationWhitelist(e),this):n.aHrefSanitizationWhitelist()},this.imgSrcSanitizationWhitelist=function(e){return M(e)?(n.imgSrcSanitizationWhitelist(e),this):n.imgSrcSanitizationWhitelist()};var y=!0;this.debugInfoEnabled=function(e){return M(e)?(y=e,this):y};var b=10;this.onChangesTtl=function(e){return arguments.length?(b=e,this):b};var T=!0;this.commentDirectivesEnabled=function(e){return arguments.length?(T=e,this):T};var C=!0;this.cssClassDirectivesEnabled=function(e){return arguments.length?(C=e,this):C},this.$get=["$injector","$interpolate","$exceptionHandler","$templateRequest","$parse","$controller","$rootScope","$sce","$animate","$$sanitizeUri",function(t,n,g,m,E,w,k,I,O,D){var P,L=/^\w/,$=e.document.createElement("div"),B=T,F=C,q=b;function H(){try{if(!--q)throw P=void 0,nn("infchng","{0} $onChanges() iterations reached. Aborting!\n",b);k.$apply(function(){for(var e=[],t=0,n=P.length;t<n;++t)try{P[t]()}catch(t){e.push(t)}if(P=void 0,e.length)throw e})}finally{q++}}function G(e,t){if(t){var n,i,r,a=Object.keys(t);for(n=0,i=a.length;n<i;n++)this[r=a[n]]=t[r]}else this.$attr={};this.$$element=e}function X(e,t){try{e.addClass(t)}catch(e){}}G.prototype={$normalize:ln,$addClass:function(e){e&&e.length>0&&O.addClass(this.$$element,e)},$removeClass:function(e){e&&e.length>0&&O.removeClass(this.$$element,e)},$updateClass:function(e,t){var n=un(e,t);n&&n.length&&O.addClass(this.$$element,n);var i=un(t,e);i&&i.length&&O.removeClass(this.$$element,i)},$set:function(e,t,n,i){var r,a=St(this.$$element[0],e),o=kt[e],s=e;if(a?(this.$$element.prop(e,t),i=a):o&&(this[o]=t,s=o),this[e]=t,i?this.$attr[e]=i:(i=this.$attr[e])||(this.$attr[e]=i=Se(e,"-")),"a"===(r=Z(this.$$element))&&("href"===e||"xlinkHref"===e)||"img"===r&&"src"===e)this[e]=t=D(t,"src"===e);else if("img"===r&&"srcset"===e&&M(t)){for(var l="",u=Y(t),c=/\s/.test(u)?/(\s+\d+x\s*,|\s+\d+w\s*,|\s+,|,\s+)/:/(,)/,d=u.split(c),h=Math.floor(d.length/2),p=0;p<h;p++){var f=2*p;l+=D(Y(d[f]),!0),l+=" "+Y(d[f+1])}var m=Y(d[2*p]).split(/\s/);l+=D(Y(m[0]),!0),2===m.length&&(l+=" "+Y(m[1])),this[e]=t=l}!1!==n&&(null===t||N(t)?this.$$element.removeAttr(i):L.test(i)?this.$$element.attr(i,t):function(e,t,n){$.innerHTML="<span "+t+">";var i=$.firstChild.attributes,r=i[0];i.removeNamedItem(r.name),r.value=n,e.attributes.setNamedItem(r)}(this.$$element[0],i,t));var v=this.$$observers;v&&_(v[s],function(e){try{e(t)}catch(e){g(e)}})},$observe:function(e,t){var n=this,i=n.$$observers||(n.$$observers=Pe()),r=i[e]||(i[e]=[]);return r.push(t),k.$evalAsync(function(){r.$$inter||!n.hasOwnProperty(e)||N(n[e])||t(n[e])}),function(){ee(r,t)}}};var Q=n.startSymbol(),J=n.endSymbol(),te="{{"===Q&&"}}"===J?A:function(e){return e.replace(/\{\{/g,Q).replace(/}}/g,J)},ie=/^ngAttr[A-Z]/,re=/^(.+)Start$/;return ae.$$addBindingInfo=y?function(e,t){var n=e.data("$binding")||[];U(t)?n=n.concat(t):n.push(t),e.data("$binding",n)}:x,ae.$$addBindingClass=y?function(e){X(e,"ng-binding")}:x,ae.$$addScopeInfo=y?function(e,t,n,i){var r=n?i?"$isolateScopeNoTemplate":"$isolateScope":"$scope";e.data(r,t)}:x,ae.$$addScopeClass=y?function(e,t){X(e,t?"ng-isolate-scope":"ng-scope")}:x,ae.$$createComment=function(t,n){var i="";return y&&(i=" "+(t||"")+": ",n&&(i+=n+" ")),e.document.createComment(i)},ae;function ae(t,n,i,r,a){t instanceof l||(t=l(t));for(var o=/\S+/,s=0,u=t.length;s<u;s++){var c=t[s];c.nodeType===Ne&&c.nodeValue.match(o)&&at(c,t[s]=e.document.createElement("span"))}var d=le(t,n,t,i,r,a);ae.$$addScopeClass(t);var h=null;return function(e,n,i){Oe(e,"scope"),a&&a.needsNewScope&&(e=e.$parent.$new());var r,o,s,u=(i=i||{}).parentBoundTranscludeFn,c=i.transcludeControllers,p=i.futureParentElement;if(u&&u.$$boundTransclude&&(u=u.$$boundTransclude),h||(o=(r=p)&&r[0],h=o&&"foreignobject"!==Z(o)&&f.call(o).match(/SVG/)?"svg":"html"),s="html"!==h?l(we(h,l("<div>").append(t).html())):n?Et.clone.call(t):t,c)for(var g in c)s.data("$"+g+"Controller",c[g].instance);return ae.$$addScopeInfo(s,e),n&&n(s,e),d&&d(e,s,s,u),s}}function le(e,t,n,i,r,a){for(var o,s,u,c,d,h,p,f=[],g=0;g<e.length;g++)o=new G,(u=(s=ce(e[g],[],o,0===g?i:void 0,r)).length?ge(s,e[g],o,t,n,null,[],[],a):null)&&u.scope&&ae.$$addScopeClass(o.$$element),d=u&&u.terminal||!(c=e[g].childNodes)||!c.length?null:le(c,u?(u.transcludeOnThisElement||!u.templateOnThisElement)&&u.transclude:t),(u||d)&&(f.push(g,u,d),h=!0,p=p||u),a=null;return h?function(e,n,i,r){var a,o,s,u,c,d,h,g;if(p){var m=n.length;for(g=new Array(m),c=0;c<f.length;c+=3)g[h=f[c]]=n[h]}else g=n;for(c=0,d=f.length;c<d;)s=g[f[c++]],a=f[c++],o=f[c++],a?(a.scope?(u=e.$new(),ae.$$addScopeInfo(l(s),u)):u=e,a(o,u,s,i,a.transcludeOnThisElement?ue(e,a.transclude,r):!a.templateOnThisElement&&r?r:!r&&t?ue(e,t):null)):o&&o(e,s.childNodes,void 0,r)}:null}function ue(e,t,n){function i(i,r,a,o,s){return i||((i=e.$new(!1,s)).$$transcluded=!0),t(i,r,{parentBoundTranscludeFn:n,transcludeControllers:a,futureParentElement:o})}var r=i.$$slots=Pe();for(var a in t.$$slots)t.$$slots[a]?r[a]=ue(e,t.$$slots[a],n):r[a]=null;return i}function ce(e,t,i,r,a){var o,l,d,h=e.nodeType,p=i.$attr;switch(h){case Le:ye(t,ln(l=Z(e)),"E",r,a);for(var f,g,m,v,y,b,_=e.attributes,T=0,E=_&&_.length;T<E;T++){var C=!1,w=!1;g=(f=_[T]).name,y=Y(f.value),v=ln(g),(b=ie.test(v))&&(g=g.replace(sn,"").substr(8).replace(/_(.)/g,function(e,t){return t.toUpperCase()}));var k=v.match(re);k&&be(k[1])&&(C=g,w=g.substr(0,g.length-5)+"end",g=g.substr(0,g.length-6)),p[m=ln(g.toLowerCase())]=g,!b&&i.hasOwnProperty(m)||(i[m]=y,St(e,m)&&(i[m]=!0)),ke(e,t,y,m,b),ye(t,m,"A",r,a,C,w)}if("input"===l&&"hidden"===e.getAttribute("type")&&e.setAttribute("autocomplete","off"),!F)break;if(K(d=e.className)&&(d=d.animVal),j(d)&&""!==d)for(;o=c.exec(d);)ye(t,m=ln(o[2]),"C",r,a)&&(i[m]=Y(o[3])),d=d.substr(o.index+o[0].length);break;case Ne:if(11===s)for(;e.parentNode&&e.nextSibling&&e.nextSibling.nodeType===Ne;)e.nodeValue=e.nodeValue+e.nextSibling.nodeValue,e.parentNode.removeChild(e.nextSibling);!function(e,t){var i=n(t,!0);i&&e.push({priority:0,compile:function(e){var t=e.parent(),n=!!t.length;return n&&ae.$$addBindingClass(t),function(e,t){var r=t.parent();n||ae.$$addBindingClass(r),ae.$$addBindingInfo(r,i.expressions),e.$watch(i,function(e){t[0].nodeValue=e})}}})}(t,e.nodeValue);break;case Me:if(!B)break;!function(e,t,n,i,r){try{var a=u.exec(e.nodeValue);if(a){var o=ln(a[1]);ye(t,o,"M",i,r)&&(n[o]=Y(a[2]))}}catch(e){}}(e,t,i,r,a)}return t.sort(Ee),t}function de(e,t,n){var i=[],r=0;if(t&&e.hasAttribute&&e.hasAttribute(t))do{if(!e)throw nn("uterdir","Unterminated attribute, found '{0}' but no matching '{1}' found.",t,n);e.nodeType===Le&&(e.hasAttribute(t)&&r++,e.hasAttribute(n)&&r--),i.push(e),e=e.nextSibling}while(r>0);else i.push(e);return l(i)}function he(e,t,n){return function(i,r,a,o,s){return r=de(r[0],t,n),e(i,r,a,o,s)}}function pe(e,t,n,i,r,a){var o;return e?ae(t,n,i,r,a):function(){return o||(o=ae(t,n,i,r,a),t=n=a=null),o.apply(this,arguments)}}function ge(e,t,n,i,r,a,o,s,u){u=u||{};for(var c,d,h,p,f,m=-Number.MAX_VALUE,v=u.newScopeDirective,y=u.controllerDirectives,b=u.newIsolateScopeDirective,T=u.templateDirective,E=u.nonTlbTranscludeDirective,C=!1,k=!1,I=u.hasElementTranscludeDirective,O=n.$$element=l(t),D=a,R=i,x=!1,A=!1,P=0,L=e.length;P<L;P++){var M=(c=e[P]).$$start,$=c.$$end;if(M&&(O=de(t,M,$)),h=void 0,m>c.priority)break;if((f=c.scope)&&(c.templateUrl||(K(f)?(Ce("new/isolated scope",b||v,c,O),b=c):Ce("new/isolated scope",b,c,O)),v=v||c),d=c.name,!x&&(c.replace&&(c.templateUrl||c.template)||c.transclude&&!c.$$tlb)){for(var j,B=P+1;j=e[B++];)if(j.transclude&&!j.$$tlb||j.replace&&(j.templateUrl||j.template)){A=!0;break}x=!0}if(!c.templateUrl&&c.controller&&(f=c.controller,y=y||Pe(),Ce("'"+d+"' controller",y[d],c,O),y[d]=c),f=c.transclude)if(C=!0,c.$$tlb||(Ce("transclusion",E,c,O),E=c),"element"===f)I=!0,m=c.priority,h=O,O=n.$$element=l(ae.$$createComment(d,n[d])),t=O[0],Ie(r,oe(h),t),h[0].$$parentNode=h[0].parentNode,R=pe(A,h,i,m,D&&D.name,{nonTlbTranscludeDirective:E});else{var F=Pe();if(h=l(lt(t)).contents(),K(f)){h=[];var q=Pe(),H=Pe();for(var W in _(f,function(e,t){var n="?"===e.charAt(0);e=n?e.substring(1):e,q[e]=t,F[t]=null,H[t]=n}),_(O.contents(),function(e){var t=q[ln(Z(e))];t?(H[t]=!0,F[t]=F[t]||[],F[t].push(e)):h.push(e)}),_(H,function(e,t){if(!e)throw nn("reqslot","Required transclusion slot `{0}` was not filled.",t)}),F)F[W]&&(F[W]=pe(A,F[W],i))}O.empty(),(R=pe(A,h,i,void 0,void 0,{needsNewScope:c.$$isolateScope||c.$$newScope})).$$slots=F}if(c.template)if(k=!0,Ce("template",T,c,O),T=c,f=V(c.template)?c.template(O,n):c.template,f=te(f),c.replace){if(D=c,h=nt(f)?[]:cn(we(c.templateNamespace,Y(f))),t=h[0],1!==h.length||t.nodeType!==Le)throw nn("tplrt","Template for directive '{0}' must have exactly one root element. {1}",d,"");Ie(r,O,t);var X={$attr:{}},Q=ce(t,[],X),J=e.splice(P+1,e.length-(P+1));(b||v)&&ve(Q,b,v),e=e.concat(Q).concat(J),_e(n,X),L=e.length}else O.html(f);if(c.templateUrl)k=!0,Ce("template",T,c,O),T=c,c.replace&&(D=c),ie=Te(e.splice(P,e.length-P),O,n,r,C&&R,o,s,{controllerDirectives:y,newScopeDirective:v!==c&&v,newIsolateScopeDirective:b,templateDirective:T,nonTlbTranscludeDirective:E}),L=e.length;else if(c.compile)try{p=c.compile(O,n,R);var ee=c.$$originalDirective||c;V(p)?ne(null,se(ee,p),M,$):p&&ne(se(ee,p.pre),se(ee,p.post),M,$)}catch(e){g(e,fe(O))}c.terminal&&(ie.terminal=!0,m=Math.max(m,c.priority))}return ie.scope=v&&!0===v.scope,ie.transcludeOnThisElement=C,ie.templateOnThisElement=k,ie.transclude=R,u.hasElementTranscludeDirective=I,ie;function ne(e,t,n,i){e&&(n&&(e=he(e,n,i)),e.require=c.require,e.directiveName=d,(b===c||c.$$isolateScope)&&(e=De(e,{isolateScope:!0})),o.push(e)),t&&(n&&(t=he(t,n,i)),t.require=c.require,t.directiveName=d,(b===c||c.$$isolateScope)&&(t=De(t,{isolateScope:!0})),s.push(t))}function ie(e,i,r,a,u){var c,d,h,p,f,m,E,C,k,O;for(var D in t===r?(k=n,C=n.$$element):k=new G(C=l(r),n),f=i,b?p=i.$new(!0):v&&(f=i.$parent),u&&((E=function(e,t,n,i){var r;if(z(e)||(i=n,n=t,t=e,e=void 0),I&&(r=m),n||(n=I?C.parent():C),!i)return u(e,t,r,n,L);var a=u.$$slots[i];if(a)return a(e,t,r,n,L);if(N(a))throw nn("noslot",'No parent directive that requires a transclusion with slot name "{0}". Element: {1}',i,fe(C))}).$$boundTransclude=u,E.isSlotFilled=function(e){return!!u.$$slots[e]}),y&&(m=function(e,t,n,i,r,a,o){var s=Pe();for(var l in i){var u=i[l],c={$scope:u===o||u.$$isolateScope?r:a,$element:e,$attrs:t,$transclude:n},d=u.controller;"@"===d&&(d=t[u.name]);var h=w(d,c,!0,u.controllerAs);s[u.name]=h,e.data("$"+u.name+"Controller",h.instance)}return s}(C,k,E,y,p,i,b)),b&&(ae.$$addScopeInfo(C,p,!0,!(T&&(T===b||T===b.$$originalDirective))),ae.$$addScopeClass(C,!0),p.$$isolateBindings=b.$$isolateBindings,(O=xe(i,k,p,p.$$isolateBindings,b)).removeWatches&&p.$on("$destroy",O.removeWatches)),m){var R=y[D],x=m[D],A=R.$$bindings.bindToController;x.identifier&&A?x.bindingInfo=xe(f,k,x.instance,A,R):x.bindingInfo={};var P=x();P!==x.instance&&(x.instance=P,C.data("$"+R.name+"Controller",P),x.bindingInfo.removeWatches&&x.bindingInfo.removeWatches(),x.bindingInfo=xe(f,k,x.instance,A,R))}for(_(y,function(e,t){var n=e.require;e.bindToController&&!U(n)&&K(n)&&S(m[t].instance,me(t,n,C,m))}),_(m,function(e){var t=e.instance;if(V(t.$onChanges))try{t.$onChanges(e.bindingInfo.initialChanges)}catch(e){g(e)}if(V(t.$onInit))try{t.$onInit()}catch(e){g(e)}V(t.$doCheck)&&(f.$watch(function(){t.$doCheck()}),t.$doCheck()),V(t.$onDestroy)&&f.$on("$destroy",function(){t.$onDestroy()})}),c=0,d=o.length;c<d;c++)Re(h=o[c],h.isolateScope?p:i,C,k,h.require&&me(h.directiveName,h.require,C,m),E);var L=i;for(b&&(b.template||null===b.templateUrl)&&(L=p),e&&e(L,r.childNodes,void 0,u),c=s.length-1;c>=0;c--)Re(h=s[c],h.isolateScope?p:i,C,k,h.require&&me(h.directiveName,h.require,C,m),E);_(m,function(e){var t=e.instance;V(t.$postLink)&&t.$postLink()})}}function me(e,t,n,i){var r;if(j(t)){var a=t.match(h),o=t.substring(a[0].length),s=a[1]||a[3],l="?"===a[2];if("^^"===s?n=n.parent():r=(r=i&&i[o])&&r.instance,!r){var u="$"+o+"Controller";r=s?n.inheritedData(u):n.data(u)}if(!r&&!l)throw nn("ctreq","Controller '{0}', required by directive '{1}', can't be found!",o,e)}else if(U(t)){r=[];for(var c=0,d=t.length;c<d;c++)r[c]=me(e,t[c],n,i)}else K(t)&&(r={},_(t,function(t,a){r[a]=me(e,t,n,i)}));return r||null}function ve(e,t,n){for(var i=0,r=e.length;i<r;i++)e[i]=R(e[i],{$$isolateScope:t,$$newScope:n})}function ye(e,n,r,a,s,l,u){if(n===s)return null;var c=null;if(i.hasOwnProperty(n))for(var d,h=t.get(n+o),p=0,f=h.length;p<f;p++)try{if(d=h[p],(N(a)||a>d.priority)&&-1!==d.restrict.indexOf(r)){if(l&&(d=R(d,{$$start:l,$$end:u})),!d.$$bindings){var m=d.$$bindings=v(d,d.name);K(m.isolateScope)&&(d.$$isolateBindings=m.isolateScope)}e.push(d),c=d}}catch(e){g(e)}return c}function be(e){if(i.hasOwnProperty(e))for(var n=t.get(e+o),r=0,a=n.length;r<a;r++)if(n[r].multiElement)return!0;return!1}function _e(e,t){var n=t.$attr,i=e.$attr;_(e,function(i,r){"$"!==r.charAt(0)&&(t[r]&&t[r]!==i&&(i+=("style"===r?";":" ")+t[r]),e.$set(r,i,!0,n[r]))}),_(t,function(t,r){e.hasOwnProperty(r)||"$"===r.charAt(0)||(e[r]=t,"class"!==r&&"style"!==r&&(i[r]=n[r]))})}function Te(e,t,n,i,r,a,o,s){var u,c,d=[],h=t[0],p=e.shift(),f=R(p,{templateUrl:null,transclude:null,replace:null,$$originalDirective:p}),g=V(p.templateUrl)?p.templateUrl(t,n):p.templateUrl,v=p.templateNamespace;return t.empty(),m(g).then(function(m){var y,b,T,E;if(m=te(m),p.replace){if(T=nt(m)?[]:cn(we(v,Y(m))),y=T[0],1!==T.length||y.nodeType!==Le)throw nn("tplrt","Template for directive '{0}' must have exactly one root element. {1}",p.name,g);b={$attr:{}},Ie(i,t,y);var C=ce(y,[],b);K(p.scope)&&ve(C,!0),e=C.concat(e),_e(n,b)}else y=h,t.html(m);for(e.unshift(f),u=ge(e,y,n,r,t,p,a,o,s),_(i,function(e,n){e===y&&(i[n]=t[0])}),c=le(t[0].childNodes,r);d.length;){var w=d.shift(),k=d.shift(),S=d.shift(),I=d.shift(),O=t[0];if(!w.$$destroyed){if(k!==h){var D=k.className;s.hasElementTranscludeDirective&&p.replace||(O=lt(y)),Ie(S,l(k),O),X(l(O),D)}E=u.transcludeOnThisElement?ue(w,u.transclude,I):I,u(c,w,O,i,E)}}d=null}),function(e,t,n,i,r){var a=r;t.$$destroyed||(d?d.push(t,n,i,a):(u.transcludeOnThisElement&&(a=ue(t,u.transclude,r)),u(c,t,n,i,a)))}}function Ee(e,t){var n=t.priority-e.priority;return 0!==n?n:e.name!==t.name?e.name<t.name?-1:1:e.index-t.index}function Ce(e,t,n,i){function r(e){return e?" (module: "+e+")":""}if(t)throw nn("multidir","Multiple directives [{0}{1}, {2}{3}] asking for {4} on: {5}",t.name,r(t.$$moduleName),n.name,r(n.$$moduleName),e,fe(i))}function we(t,n){switch(t=a(t||"html")){case"svg":case"math":var i=e.document.createElement("div");return i.innerHTML="<"+t+">"+n+"</"+t+">",i.childNodes[0].childNodes;default:return n}}function ke(e,t,i,r,a){var o=function(e,t){if("srcdoc"===t)return I.HTML;var n=Z(e);if("src"===t||"ngSrc"===t){if(-1===["img","video","audio","source","track"].indexOf(n))return I.RESOURCE_URL}else if("xlinkHref"===t||"form"===n&&"action"===t)return I.RESOURCE_URL}(e,r);a=d[r]||a;var s=n(i,!0,o,a);if(s){if("multiple"===r&&"select"===Z(e))throw nn("selmulti","Binding to the 'multiple' attribute is not supported. Element: {0}",fe(e));t.push({priority:100,compile:function(){return{pre:function(e,t,l){var u=l.$$observers||(l.$$observers=Pe());if(p.test(r))throw nn("nodomevents","Interpolations for HTML DOM event attributes are disallowed.  Please use the ng- versions (such as ng-click instead of onclick) instead.");var c=l[r];c!==i&&(s=c&&n(c,!0,o,a),i=c),s&&(l[r]=s(e),(u[r]||(u[r]=[])).$$inter=!0,(l.$$observers&&l.$$observers[r].$$scope||e).$watch(s,function(e,t){"class"===r&&e!==t?l.$updateClass(e,t):l.$set(r,e)}))}}}})}}function Ie(t,n,i){var r,a,o=n[0],s=n.length,u=o.parentNode;if(t)for(r=0,a=t.length;r<a;r++)if(t[r]===o){t[r++]=i;for(var c=r,d=c+s-1,h=t.length;c<h;c++,d++)d<h?t[c]=t[d]:delete t[c];t.length-=s-1,t.context===o&&(t.context=i);break}u&&u.replaceChild(i,o);var p=e.document.createDocumentFragment();for(r=0;r<s;r++)p.appendChild(n[r]);for(l.hasData(o)&&(l.data(i,l.data(o)),l(o).off("$destroy")),l.cleanData(p.querySelectorAll("*")),r=1;r<s;r++)delete n[r];n[0]=i,n.length=1}function De(e,t){return S(function(){return e.apply(null,arguments)},e,t)}function Re(e,t,n,i,r,a){try{e(t,n,i,r,a)}catch(e){g(e,fe(n))}}function xe(e,t,i,a,o){var s,l=[],u={};function c(t,n,r){V(i.$onChanges)&&n!==r&&(P||(e.$$postDigest(H),P=[]),s||(s={},P.push(d)),s[t]&&(r=s[t].previousValue),s[t]=new on(r,n))}function d(){i.$onChanges(s),s=void 0}return _(a,function(a,s){var d,h,p,f,g,m=a.attrName,v=a.optional;switch(a.mode){case"@":v||r.call(t,m)||(i[s]=t[m]=void 0),t.$observe(m,function(e){if(j(e)||W(e)){var t=i[s];c(s,e,t),i[s]=e}}),t.$$observers[m].$$scope=e,j(d=t[m])?i[s]=n(d)(e):W(d)&&(i[s]=d),u[s]=new on(rn,i[s]);break;case"=":if(!r.call(t,m)){if(v)break;t[m]=void 0}if(v&&!t[m])break;h=E(t[m]),f=h.literal?ne:function(e,t){return e===t||e!=e&&t!=t},p=h.assign||function(){throw d=i[s]=h(e),nn("nonassign","Expression '{0}' in attribute '{1}' used with directive '{2}' is non-assignable!",t[m],m,o.name)},d=i[s]=h(e);var y=function(t){return f(t,i[s])||(f(t,d)?p(e,t=i[s]):i[s]=t),d=t};y.$stateful=!0,g=a.collection?e.$watchCollection(t[m],y):e.$watch(E(t[m],y),null,h.literal),l.push(g);break;case"<":if(!r.call(t,m)){if(v)break;t[m]=void 0}if(v&&!t[m])break;h=E(t[m]);var b=i[s]=h(e);u[s]=new on(rn,i[s]),g=e.$watch(h,function(e,t){if(t===e){if(t===b)return;t=b}c(s,e,t),i[s]=e},h.literal),l.push(g);break;case"&":if((h=t.hasOwnProperty(m)?E(t[m]):x)===x&&v)break;i[s]=function(t){return h(e,t)}}}),{initialChanges:u,removeWatches:l.length&&function(){for(var e=0,t=l.length;e<t;++e)l[e]()}}}}]}function on(e,t){this.previousValue=e,this.currentValue=t}an.$inject=["$provide","$$sanitizeUriProvider"],on.prototype.isFirstChange=function(){return this.previousValue===rn};var sn=/^((?:x|data)[:\-_])/i;function ln(e){return Ye(e.replace(sn,""))}function un(e,t){var n="",i=e.split(/\s+/),r=t.split(/\s+/);e:for(var a=0;a<i.length;a++){for(var o=i[a],s=0;s<r.length;s++)if(o===r[s])continue e;n+=(n.length>0?" ":"")+o}return n}function cn(e){var t=(e=l(e)).length;if(t<=1)return e;for(;t--;)e[t].nodeType===Me&&h.call(e,t,1);return e}var dn=t("$controller"),hn=/^(\S+)(\s+as\s+([\w$]+))?$/;function pn(e,t){if(t&&j(t))return t;if(j(e)){var n=hn.exec(e);if(n)return n[3]}}function fn(){var e={},n=!1;this.has=function(t){return e.hasOwnProperty(t)},this.register=function(t,n){Re(t,"controller"),K(t)?S(e,t):e[t]=n},this.allowGlobals=function(){n=!0},this.$get=["$injector","$window",function(i,r){return function(t,o,s,l){var u,c,d,h;if(s=!0===s,l&&j(l)&&(h=l),j(t)){if(!(c=t.match(hn)))throw dn("ctrlfmt","Badly formed controller string '{0}'. Must match `__name__ as __id__` or `__name__`.",t);d=c[1],h=h||c[3],De(t=e.hasOwnProperty(d)?e[d]:xe(o.$scope,d,!0)||(n?xe(r,d,!0):void 0),d,!0)}if(s){var p=(U(t)?t[t.length-1]:t).prototype;return u=Object.create(p||null),h&&a(o,h,u,d||t.name),S(function(){var e=i.invoke(t,u,o,d);return e!==u&&(K(e)||V(e))&&(u=e,h&&a(o,h,u,d||t.name)),u},{instance:u,identifier:h})}return u=i.instantiate(t,o,d),h&&a(o,h,u,d||t.name),u};function a(e,n,i,r){if(!e||!K(e.$scope))throw t("$controller")("noscp","Cannot export controller '{0}' as '{1}'! No $scope object provided via `locals`.",r,n);e.$scope[n]=i}}]}function gn(){this.$get=["$window",function(e){return l(e.document)}]}function mn(){this.$get=["$log",function(e){return function(t,n){e.error.apply(e,arguments)}}]}var vn=function(){this.$get=["$document",function(e){return function(t){return t?!t.nodeType&&t instanceof l&&(t=t[0]):t=e[0].body,t.offsetWidth+1}}]},yn="application/json",bn={"Content-Type":yn+";charset=utf-8"},_n=/^\[|^\{(?!\{)/,Tn={"[":/]$/,"{":/}$/},En=/^\)\]\}',?\n/,Cn=t("$http"),wn=function(e){return function(){throw Cn("legacy","The method `{0}` on the promise returned from `$http` has been disabled.",e)}};function kn(e){return K(e)?F(e)?e.toISOString():ue(e):e}function Sn(){this.$get=function(){return function(e){if(!e)return"";var t=[];return T(e,function(e,n){null===e||N(e)||(U(e)?_(e,function(e){t.push(be(n)+"="+be(kn(e)))}):t.push(be(n)+"="+be(kn(e))))}),t.join("&")}}}function In(){this.$get=function(){return function(e){if(!e)return"";var t=[];return function e(n,i,r){null===n||N(n)||(U(n)?_(n,function(t,n){e(t,i+"["+(K(t)?n:"")+"]")}):K(n)&&!F(n)?T(n,function(t,n){e(t,i+(r?"":"[")+n+(r?"":"]"))}):t.push(be(i)+"="+be(kn(n))))}(e,"",!0),t.join("&")}}}function On(e,t){if(j(e)){var n=e.replace(En,"").trim();if(n){var i=t("Content-Type");(i&&0===i.indexOf(yn)||(a=(r=n).match(_n))&&Tn[a[0]].test(r))&&(e=ce(n))}}var r,a;return e}function Dn(e){var t,n=Pe();function i(e,t){e&&(n[e]=n[e]?n[e]+", "+t:t)}return j(e)?_(e.split("\n"),function(e){t=e.indexOf(":"),i(a(Y(e.substr(0,t))),Y(e.substr(t+1)))}):K(e)&&_(e,function(e,t){i(a(t),Y(e))}),n}function Rn(e){var t;return function(n){if(t||(t=Dn(e)),n){var i=t[a(n)];return void 0===i&&(i=null),i}return t}}function xn(e,t,n,i){return V(i)?i(e,t,n):(_(i,function(i){e=i(e,t,n)}),e)}function An(e){return 200<=e&&e<300}function Pn(){var e=this.defaults={transformResponse:[On],transformRequest:[function(e){return!K(e)||(t=e,"[object File]"===f.call(t))||function(e){return"[object Blob]"===f.call(e)}(e)||function(e){return"[object FormData]"===f.call(e)}(e)?e:ue(e);var t}],headers:{common:{Accept:"application/json, text/plain, */*"},post:je(bn),put:je(bn),patch:je(bn)},xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",paramSerializer:"$httpParamSerializer"},n=!1;this.useApplyAsync=function(e){return M(e)?(n=!!e,this):n};var i=!0;this.useLegacyPromiseExtensions=function(e){return M(e)?(i=!!e,this):i};var r=this.interceptors=[];this.$get=["$httpBackend","$$cookieReader","$cacheFactory","$rootScope","$q","$injector",function(s,l,u,c,d,h){var p=u("$http");e.paramSerializer=j(e.paramSerializer)?h.get(e.paramSerializer):e.paramSerializer;var f=[];function g(r){if(!K(r))throw t("$http")("badreq","Http request configuration must be an object.  Received: {0}",r);if(!j(r.url))throw t("$http")("badreq","Http request configuration url must be a string.  Received: {0}",r.url);var u=S({method:"get",transformRequest:e.transformRequest,transformResponse:e.transformResponse,paramSerializer:e.paramSerializer},r);u.headers=function(t){var n,i,r,o=e.headers,s=S({},t.headers);o=S({},o.common,o[a(t.method)]);e:for(n in o){for(r in i=a(n),s)if(a(r)===i)continue e;s[n]=o[n]}return function(e,t){var n,i={};return _(e,function(e,r){V(e)?null!=(n=e(t))&&(i[r]=n):i[r]=e}),i}(s,je(t))}(r),u.method=o(u.method),u.paramSerializer=j(u.paramSerializer)?h.get(u.paramSerializer):u.paramSerializer;var m=[],v=[],y=d.when(u);return _(f,function(e){(e.request||e.requestError)&&m.unshift(e.request,e.requestError),(e.response||e.responseError)&&v.push(e.response,e.responseError)}),y=b(y=(y=b(y,m)).then(function(t){var i=t.headers,r=xn(t.data,Rn(i),void 0,t.transformRequest);return N(r)&&_(i,function(e,t){"content-type"===a(t)&&delete i[t]}),N(t.withCredentials)&&!N(e.withCredentials)&&(t.withCredentials=e.withCredentials),function(t,i){var r,a,o=d.defer(),u=o.promise,h=t.headers,f=function(e,t){return t.length>0&&(e+=(-1===e.indexOf("?")?"?":"&")+t),e}(t.url,t.paramSerializer(t.params));if(g.pendingRequests.push(t),u.then(T,T),!t.cache&&!e.cache||!1===t.cache||"GET"!==t.method&&"JSONP"!==t.method||(r=K(t.cache)?t.cache:K(e.cache)?e.cache:p),r&&(M(a=r.get(f))?G(a)?a.then(b,b):U(a)?y(a[1],a[0],je(a[2]),a[3]):y(a,200,{},"OK"):r.put(f,u)),N(a)){var m=cr(t.url)?l()[t.xsrfCookieName||e.xsrfCookieName]:void 0;m&&(h[t.xsrfHeaderName||e.xsrfHeaderName]=m),s(t.method,f,i,function(e,t,i,a){function o(){y(t,e,i,a)}r&&(An(e)?r.put(f,[e,t,Dn(i),a]):r.remove(f)),n?c.$applyAsync(o):(o(),c.$$phase||c.$apply())},h,t.timeout,t.withCredentials,t.responseType,v(t.eventHandlers),v(t.uploadEventHandlers))}return u;function v(e){if(e){var t={};return _(e,function(e,i){t[i]=function(t){function i(){e(t)}n?c.$applyAsync(i):c.$$phase?i():c.$apply(i)}}),t}}function y(e,n,i,r){(An(n=n>=-1?n:0)?o.resolve:o.reject)({data:e,status:n,headers:Rn(i),config:t,statusText:r})}function b(e){y(e.data,e.status,je(e.headers()),e.statusText)}function T(){var e=g.pendingRequests.indexOf(t);-1!==e&&g.pendingRequests.splice(e,1)}}(t,r).then(T,T)}),v),i?(y.success=function(e){return De(e,"fn"),y.then(function(t){e(t.data,t.status,t.headers,u)}),y},y.error=function(e){return De(e,"fn"),y.then(null,function(t){e(t.data,t.status,t.headers,u)}),y}):(y.success=wn("success"),y.error=wn("error")),y;function b(e,t){for(var n=0,i=t.length;n<i;){var r=t[n++],a=t[n++];e=e.then(r,a)}return t.length=0,e}function T(e){var t=S({},e);return t.data=xn(e.data,e.headers,e.status,u.transformResponse),An(e.status)?t:d.reject(t)}}return _(r,function(e){f.unshift(j(e)?h.get(e):h.invoke(e))}),g.pendingRequests=[],function(e){_(arguments,function(e){g[e]=function(t,n){return g(S({},n||{},{method:e,url:t}))}})}("get","delete","head","jsonp"),function(e){_(arguments,function(e){g[e]=function(t,n,i){return g(S({},i||{},{method:e,url:t,data:n}))}})}("post","put","patch"),g.defaults=e,g}]}function Ln(){this.$get=function(){return function(){return new e.XMLHttpRequest}}}function Nn(){this.$get=["$browser","$jsonpCallbacks","$document","$xhrFactory",function(e,t,n,i){return function(e,t,n,i,r){return function(o,s,l,u,c,d,h,p,f,g){if(e.$$incOutstandingRequestCount(),s=s||e.url(),"jsonp"===a(o))var m=i.createCallback(s),v=function(e,t,n){e=e.replace("JSON_CALLBACK",t);var a=r.createElement("script"),o=null;return a.type="text/javascript",a.src=e,a.async=!0,o=function(e){He(a,"load",o),He(a,"error",o),r.body.removeChild(a),a=null;var s=-1,l="unknown";e&&("load"!==e.type||i.wasCalled(t)||(e={type:"error"}),l=e.type,s="error"===e.type?404:200),n&&n(s,l)},qe(a,"load",o),qe(a,"error",o),r.body.appendChild(a),o}(s,m,function(e,t){var n=200===e&&i.getResponse(m);C(u,e,n,"",t),i.removeCallback(m)});else{var y=t(o,s);y.open(o,s,!0),_(c,function(e,t){M(e)&&y.setRequestHeader(t,e)}),y.onload=function(){var e=y.statusText||"",t="response"in y?y.response:y.responseText,n=1223===y.status?204:y.status;0===n&&(n=t?200:"file"===ur(s).protocol?404:0),C(u,n,t,y.getAllResponseHeaders(),e)};var b=function(){C(u,-1,null,null,"")};if(y.onerror=b,y.onabort=b,y.ontimeout=b,_(f,function(e,t){y.addEventListener(t,e)}),_(g,function(e,t){y.upload.addEventListener(t,e)}),h&&(y.withCredentials=!0),p)try{y.responseType=p}catch(e){if("json"!==p)throw e}y.send(N(l)?null:l)}if(d>0)var T=n(E,d);else G(d)&&d.then(E);function E(){v&&v(),y&&y.abort()}function C(t,i,r,a,o){M(T)&&n.cancel(T),v=y=null,t(i,r,a,o),e.$$completeOutstandingRequest(x)}}}(e,i,e.defer,t,n[0])}]}var Mn=v.$interpolateMinErr=t("$interpolate");function Kn(){var e="{{",t="}}";this.startSymbol=function(t){return t?(e=t,this):e},this.endSymbol=function(e){return e?(t=e,this):t},this.$get=["$parse","$exceptionHandler","$sce",function(n,i,r){var a=e.length,o=t.length,s=new RegExp(e.replace(/./g,u),"g"),l=new RegExp(t.replace(/./g,u),"g");function u(e){return"\\\\\\"+e}function c(n){return n.replace(s,e).replace(l,t)}function d(e,t,n,i){var r=e.$watch(function(e){return r(),i(e)},t,n);return r}function h(s,l,u,h){var p;if(!s.length||-1===s.indexOf(e))return l||((p=P(c(s))).exp=s,p.expressions=[],p.$$watchDelegate=d),p;h=!!h;for(var f,g,m,v=0,y=[],b=[],_=s.length,T=[],E=[];v<_;){if(-1===(f=s.indexOf(e,v))||-1===(g=s.indexOf(t,f+a))){v!==_&&T.push(c(s.substring(v)));break}v!==f&&T.push(c(s.substring(v,f))),m=s.substring(f+a,g),y.push(m),b.push(n(m,k)),v=g+o,E.push(T.length),T.push("")}if(u&&T.length>1&&Mn.throwNoconcat(s),!l||y.length){var C=function(e){for(var t=0,n=y.length;t<n;t++){if(h&&N(e[t]))return;T[E[t]]=e[t]}return T.join("")},w=function(e){return u?r.getTrusted(u,e):r.valueOf(e)};return S(function(e){var t=0,n=y.length,r=new Array(n);try{for(;t<n;t++)r[t]=b[t](e);return C(r)}catch(e){i(Mn.interr(s,e))}},{exp:s,expressions:y,$$watchDelegate:function(e,t){var n;return e.$watchGroup(b,function(i,r){var a=C(i);V(t)&&t.call(this,a,i!==r?n:a,e),n=a})}})}function k(e){try{return e=w(e),h&&!M(e)?e:function(e){if(null==e)return"";switch(typeof e){case"string":break;case"number":e=""+e;break;default:e=ue(e)}return e}(e)}catch(e){i(Mn.interr(s,e))}}}return h.startSymbol=function(){return e},h.endSymbol=function(){return t},h}]}function $n(){this.$get=["$rootScope","$window","$q","$$q","$browser",function(e,t,n,i,r){var a={};function o(o,s,l,u){var c=arguments.length>4,d=c?oe(arguments,4):[],h=t.setInterval,p=t.clearInterval,f=0,g=M(u)&&!u,m=(g?i:n).defer(),v=m.promise;return l=M(l)?l:0,v.$$intervalId=h(function(){g?r.defer(y):e.$evalAsync(y),m.notify(f++),l>0&&f>=l&&(m.resolve(f),p(v.$$intervalId),delete a[v.$$intervalId]),g||e.$apply()},s),a[v.$$intervalId]=m,v;function y(){c?o.apply(null,d):o(f)}}return o.cancel=function(e){return!!(e&&e.$$intervalId in a)&&(a[e.$$intervalId].reject("canceled"),t.clearInterval(e.$$intervalId),delete a[e.$$intervalId],!0)},o}]}Mn.throwNoconcat=function(e){throw Mn("noconcat","Error while interpolating: {0}\nStrict Contextual Escaping disallows interpolations that concatenate multiple expressions when a trusted value is required.  See http://docs.angularjs.org/api/ng.$sce",e)},Mn.interr=function(e,t){return Mn("interr","Can't interpolate: {0}\n{1}",e,t.toString())};var jn=function(){this.$get=["$window",function(e){var t=e.angular.callbacks,n={};return{createCallback:function(e){var i="_"+(t.$$counter++).toString(36),r="angular.callbacks."+i,a=function(e){var t=function(e){t.data=e,t.called=!0};return t.id=e,t}(i);return n[r]=t[i]=a,r},wasCalled:function(e){return n[e].called},getResponse:function(e){return n[e].data},removeCallback:function(e){var i=n[e];delete t[i.id],delete n[e]}}}]},Bn=/^([^\?#]*)(\?([^#]*))?(#(.*))?$/,Fn={http:80,https:443,ftp:21},Un=t("$location");function Vn(e){for(var t=e.split("/"),n=t.length;n--;)t[n]=ye(t[n]);return t.join("/")}function qn(e,t){var n=ur(e);t.$$protocol=n.protocol,t.$$host=n.hostname,t.$$port=O(n.port)||Fn[n.protocol]||null}var Hn=/^\s*[\\/]{2,}/;function zn(e,t){if(Hn.test(e))throw Un("badpath",'Invalid url "{0}".',e);var n="/"!==e.charAt(0);n&&(e="/"+e);var i=ur(e);t.$$path=decodeURIComponent(n&&"/"===i.pathname.charAt(0)?i.pathname.substring(1):i.pathname),t.$$search=me(i.search),t.$$hash=decodeURIComponent(i.hash),t.$$path&&"/"!==t.$$path.charAt(0)&&(t.$$path="/"+t.$$path)}function Wn(e,t){return 0===e.lastIndexOf(t,0)}function Gn(e,t){if(Wn(t,e))return t.substr(e.length)}function Xn(e){var t=e.indexOf("#");return-1===t?e:e.substr(0,t)}function Yn(e){return e.replace(/(#.+)|#$/,"$1")}function Qn(e,t,n){this.$$html5=!0,n=n||"",qn(e,this),this.$$parse=function(e){var n=Gn(t,e);if(!j(n))throw Un("ipthprfx",'Invalid url "{0}", missing path prefix "{1}".',e,t);zn(n,this),this.$$path||(this.$$path="/"),this.$$compose()},this.$$compose=function(){var e=ve(this.$$search),n=this.$$hash?"#"+ye(this.$$hash):"";this.$$url=Vn(this.$$path)+(e?"?"+e:"")+n,this.$$absUrl=t+this.$$url.substr(1)},this.$$parseLinkUrl=function(i,r){return r&&"#"===r[0]?(this.hash(r.slice(1)),!0):(M(a=Gn(e,i))?(o=a,s=n&&M(a=Gn(n,a))?t+(Gn("/",a)||a):e+o):M(a=Gn(t,i))?s=t+a:t===i+"/"&&(s=t),s&&this.$$parse(s),!!s);var a,o,s}}function Jn(e,t,n){qn(e,this),this.$$parse=function(i){var r,a=Gn(e,i)||Gn(t,i);N(a)||"#"!==a.charAt(0)?this.$$html5?r=a:(r="",N(a)&&(e=i,this.replace())):N(r=Gn(n,a))&&(r=a),zn(r,this),this.$$path=function(e,t,n){var i,r=/^\/[A-Z]:(\/.*)/;return Wn(t,n)&&(t=t.replace(n,"")),r.exec(t)?e:(i=r.exec(e))?i[1]:e}(this.$$path,r,e),this.$$compose()},this.$$compose=function(){var t=ve(this.$$search),i=this.$$hash?"#"+ye(this.$$hash):"";this.$$url=Vn(this.$$path)+(t?"?"+t:"")+i,this.$$absUrl=e+(this.$$url?n+this.$$url:"")},this.$$parseLinkUrl=function(t,n){return Xn(e)===Xn(t)&&(this.$$parse(t),!0)}}function Zn(e,t,n){this.$$html5=!0,Jn.apply(this,arguments),this.$$parseLinkUrl=function(i,r){return r&&"#"===r[0]?(this.hash(r.slice(1)),!0):(e===Xn(i)?a=i:(o=Gn(t,i))?a=e+n+o:t===i+"/"&&(a=t),a&&this.$$parse(a),!!a);var a,o},this.$$compose=function(){var t=ve(this.$$search),i=this.$$hash?"#"+ye(this.$$hash):"";this.$$url=Vn(this.$$path)+(t?"?"+t:"")+i,this.$$absUrl=e+n+this.$$url}}var ei={$$absUrl:"",$$html5:!1,$$replace:!1,absUrl:ti("$$absUrl"),url:function(e){if(N(e))return this.$$url;var t=Bn.exec(e);return(t[1]||""===e)&&this.path(decodeURIComponent(t[1])),(t[2]||t[1]||""===e)&&this.search(t[3]||""),this.hash(t[5]||""),this},protocol:ti("$$protocol"),host:ti("$$host"),port:ti("$$port"),path:ni("$$path",function(e){return"/"===(e=null!==e?e.toString():"").charAt(0)?e:"/"+e}),search:function(e,t){switch(arguments.length){case 0:return this.$$search;case 1:if(j(e)||B(e))e=e.toString(),this.$$search=me(e);else{if(!K(e))throw Un("isrcharg","The first argument of the `$location#search()` call must be a string or an object.");_(e=te(e,{}),function(t,n){null==t&&delete e[n]}),this.$$search=e}break;default:N(t)||null===t?delete this.$$search[e]:this.$$search[e]=t}return this.$$compose(),this},hash:ni("$$hash",function(e){return null!==e?e.toString():""}),replace:function(){return this.$$replace=!0,this}};function ti(e){return function(){return this[e]}}function ni(e,t){return function(n){return N(n)?this[e]:(this[e]=t(n),this.$$compose(),this)}}function ii(){var e="",t={enabled:!1,requireBase:!0,rewriteLinks:!0};this.hashPrefix=function(t){return M(t)?(e=t,this):e},this.html5Mode=function(e){return W(e)?(t.enabled=e,this):K(e)?(W(e.enabled)&&(t.enabled=e.enabled),W(e.requireBase)&&(t.requireBase=e.requireBase),W(e.rewriteLinks)&&(t.rewriteLinks=e.rewriteLinks),this):t},this.$get=["$rootScope","$browser","$sniffer","$rootElement","$window",function(n,i,r,a,o){var s,u,c,d,h=i.baseHref(),p=i.url();if(t.enabled){if(!h&&t.requireBase)throw Un("nobase","$location in HTML5 mode requires a <base> tag to be present!");c=(d=p).substring(0,d.indexOf("/",d.indexOf("//")+2))+(h||"/"),u=r.history?Qn:Zn}else c=Xn(p),u=Jn;var f=function(e){return e.substr(0,Xn(e).lastIndexOf("/")+1)}(c);(s=new u(c,f,"#"+e)).$$parseLinkUrl(p,p),s.$$state=i.state();var g=/^\s*(javascript|mailto):/i;function m(e,t,n){var r=s.url(),a=s.$$state;try{i.url(e,t,n),s.$$state=i.state()}catch(e){throw s.url(r),s.$$state=a,e}}a.on("click",function(e){if(t.rewriteLinks&&!e.ctrlKey&&!e.metaKey&&!e.shiftKey&&2!==e.which&&2!==e.button){for(var r=l(e.target);"a"!==Z(r[0]);)if(r[0]===a[0]||!(r=r.parent())[0])return;var u=r.prop("href"),c=r.attr("href")||r.attr("xlink:href");K(u)&&"[object SVGAnimatedString]"===u.toString()&&(u=ur(u.animVal).href),g.test(u)||!u||r.attr("target")||e.isDefaultPrevented()||s.$$parseLinkUrl(u,c)&&(e.preventDefault(),s.absUrl()!==i.url()&&(n.$apply(),o.angular["ff-684208-preventDefault"]=!0))}}),Yn(s.absUrl())!==Yn(p)&&i.url(s.absUrl(),!0);var v=!0;return i.onUrlChange(function(e,t){N(Gn(f,e))?o.location.href=e:(n.$evalAsync(function(){var i,r=s.absUrl(),a=s.$$state;e=Yn(e),s.$$parse(e),s.$$state=t,i=n.$broadcast("$locationChangeStart",e,r,t,a).defaultPrevented,s.absUrl()===e&&(i?(s.$$parse(r),s.$$state=a,m(r,!1,a)):(v=!1,y(r,a)))}),n.$$phase||n.$digest())}),n.$watch(function(){var e=Yn(i.url()),t=Yn(s.absUrl()),a=i.state(),o=s.$$replace,l=e!==t||s.$$html5&&r.history&&a!==s.$$state;(v||l)&&(v=!1,n.$evalAsync(function(){var t=s.absUrl(),i=n.$broadcast("$locationChangeStart",t,e,s.$$state,a).defaultPrevented;s.absUrl()===t&&(i?(s.$$parse(e),s.$$state=a):(l&&m(t,o,a===s.$$state?null:s.$$state),y(e,a)))})),s.$$replace=!1}),s;function y(e,t){n.$broadcast("$locationChangeSuccess",s.absUrl(),e,s.$$state,t)}}]}function ri(){var e=!0,t=this;this.debugEnabled=function(t){return M(t)?(e=t,this):e},this.$get=["$window",function(n){return{log:r("log"),info:r("info"),warn:r("warn"),error:r("error"),debug:(i=r("debug"),function(){e&&i.apply(t,arguments)})};var i;function r(e){var t=n.console||{},i=t[e]||t.log||x,r=!1;try{r=!!i.apply}catch(e){}return r?function(){var e=[];return _(arguments,function(t){e.push(function(e){return e instanceof Error&&(e.stack?e=e.message&&-1===e.stack.indexOf(e.message)?"Error: "+e.message+"\n"+e.stack:e.stack:e.sourceURL&&(e=e.message+"\n"+e.sourceURL+":"+e.line)),e}(t))}),i.apply(t,e)}:function(e,t){i(e,null==t?"":t)}}}]}_([Zn,Jn,Qn],function(e){e.prototype=Object.create(ei),e.prototype.state=function(t){if(!arguments.length)return this.$$state;if(e!==Qn||!this.$$html5)throw Un("nostate","History API state support is available only in HTML5 mode and only in browsers supporting HTML5 History API");return this.$$state=N(t)?null:t,this}});var ai=t("$parse"),oi=[].constructor,si=(!1).constructor,li=Function.constructor,ui=(0).constructor,ci={}.constructor,di="".constructor,hi=oi.prototype,pi=si.prototype,fi=li.prototype,gi=ui.prototype,mi=ci.prototype,vi=di.prototype,yi=fi.call,bi=fi.apply,_i=fi.bind,Ti=mi.valueOf;function Ei(e,t){if("__defineGetter__"===e||"__defineSetter__"===e||"__lookupGetter__"===e||"__lookupSetter__"===e||"__proto__"===e)throw ai("isecfld","Attempting to access a disallowed field in Angular expressions! Expression: {0}",t);return e}function Ci(e){return e+""}function wi(e,t){if(e){if(e.constructor===e)throw ai("isecfn","Referencing Function in Angular expressions is disallowed! Expression: {0}",t);if(e.window===e)throw ai("isecwindow","Referencing the Window in Angular expressions is disallowed! Expression: {0}",t);if(e.children&&(e.nodeName||e.prop&&e.attr&&e.find))throw ai("isecdom","Referencing DOM nodes in Angular expressions is disallowed! Expression: {0}",t);if(e===Object)throw ai("isecobj","Referencing Object in Angular expressions is disallowed! Expression: {0}",t)}return e}function ki(e,t){if(e){if(e.constructor===e)throw ai("isecfn","Referencing Function in Angular expressions is disallowed! Expression: {0}",t);if(e===yi||e===bi||e===_i)throw ai("isecff","Referencing call, apply or bind in Angular expressions is disallowed! Expression: {0}",t)}}function Si(e,t){if(e&&(e===oi||e===si||e===li||e===ui||e===ci||e===di||e===hi||e===pi||e===fi||e===gi||e===mi||e===vi))throw ai("isecaf","Assigning to a constructor or its prototype is disallowed! Expression: {0}",t)}var Ii=Pe();_("+ - * / % === !== == != < > <= >= && || ! = |".split(" "),function(e){Ii[e]=!0});var Oi={n:"\n",f:"\f",r:"\r",t:"\t",v:"\v","'":"'",'"':'"'},Di=function(e){this.options=e};Di.prototype={constructor:Di,lex:function(e){for(this.text=e,this.index=0,this.tokens=[];this.index<this.text.length;){var t=this.text.charAt(this.index);if('"'===t||"'"===t)this.readString(t);else if(this.isNumber(t)||"."===t&&this.isNumber(this.peek()))this.readNumber();else if(this.isIdentifierStart(this.peekMultichar()))this.readIdent();else if(this.is(t,"(){}[].,;:?"))this.tokens.push({index:this.index,text:t}),this.index++;else if(this.isWhitespace(t))this.index++;else{var n=t+this.peek(),i=n+this.peek(2),r=Ii[t],a=Ii[n],o=Ii[i];if(r||a||o){var s=o?i:a?n:t;this.tokens.push({index:this.index,text:s,operator:!0}),this.index+=s.length}else this.throwError("Unexpected next character ",this.index,this.index+1)}}return this.tokens},is:function(e,t){return-1!==t.indexOf(e)},peek:function(e){var t=e||1;return this.index+t<this.text.length&&this.text.charAt(this.index+t)},isNumber:function(e){return"0"<=e&&e<="9"&&"string"==typeof e},isWhitespace:function(e){return" "===e||"\r"===e||"\t"===e||"\n"===e||"\v"===e||" "===e},isIdentifierStart:function(e){return this.options.isIdentifierStart?this.options.isIdentifierStart(e,this.codePointAt(e)):this.isValidIdentifierStart(e)},isValidIdentifierStart:function(e){return"a"<=e&&e<="z"||"A"<=e&&e<="Z"||"_"===e||"$"===e},isIdentifierContinue:function(e){return this.options.isIdentifierContinue?this.options.isIdentifierContinue(e,this.codePointAt(e)):this.isValidIdentifierContinue(e)},isValidIdentifierContinue:function(e,t){return this.isValidIdentifierStart(e,t)||this.isNumber(e)},codePointAt:function(e){return 1===e.length?e.charCodeAt(0):(e.charCodeAt(0)<<10)+e.charCodeAt(1)-56613888},peekMultichar:function(){var e=this.text.charAt(this.index),t=this.peek();if(!t)return e;var n=e.charCodeAt(0),i=t.charCodeAt(0);return n>=55296&&n<=56319&&i>=56320&&i<=57343?e+t:e},isExpOperator:function(e){return"-"===e||"+"===e||this.isNumber(e)},throwError:function(e,t,n){n=n||this.index;var i=M(t)?"s "+t+"-"+this.index+" ["+this.text.substring(t,n)+"]":" "+n;throw ai("lexerr","Lexer Error: {0} at column{1} in expression [{2}].",e,i,this.text)},readNumber:function(){for(var e="",t=this.index;this.index<this.text.length;){var n=a(this.text.charAt(this.index));if("."===n||this.isNumber(n))e+=n;else{var i=this.peek();if("e"===n&&this.isExpOperator(i))e+=n;else if(this.isExpOperator(n)&&i&&this.isNumber(i)&&"e"===e.charAt(e.length-1))e+=n;else{if(!this.isExpOperator(n)||i&&this.isNumber(i)||"e"!==e.charAt(e.length-1))break;this.throwError("Invalid exponent")}}this.index++}this.tokens.push({index:t,text:e,constant:!0,value:Number(e)})},readIdent:function(){var e=this.index;for(this.index+=this.peekMultichar().length;this.index<this.text.length;){var t=this.peekMultichar();if(!this.isIdentifierContinue(t))break;this.index+=t.length}this.tokens.push({index:e,text:this.text.slice(e,this.index),identifier:!0})},readString:function(e){var t=this.index;this.index++;for(var n="",i=e,r=!1;this.index<this.text.length;){var a=this.text.charAt(this.index);if(i+=a,r){if("u"===a){var o=this.text.substring(this.index+1,this.index+5);o.match(/[\da-f]{4}/i)||this.throwError("Invalid unicode escape [\\u"+o+"]"),this.index+=4,n+=String.fromCharCode(parseInt(o,16))}else n+=Oi[a]||a;r=!1}else if("\\"===a)r=!0;else{if(a===e)return this.index++,void this.tokens.push({index:t,text:i,constant:!0,value:n});n+=a}this.index++}this.throwError("Unterminated quote",t)}};var Ri=function(e,t){this.lexer=e,this.options=t};function xi(e,t){return void 0!==e?e:t}function Ai(e,t){return void 0===e?t:void 0===t?e:e+t}function Pi(e,t){var n,i,r;switch(e.type){case Ri.Program:n=!0,_(e.body,function(e){Pi(e.expression,t),n=n&&e.expression.constant}),e.constant=n;break;case Ri.Literal:e.constant=!0,e.toWatch=[];break;case Ri.UnaryExpression:Pi(e.argument,t),e.constant=e.argument.constant,e.toWatch=e.argument.toWatch;break;case Ri.BinaryExpression:Pi(e.left,t),Pi(e.right,t),e.constant=e.left.constant&&e.right.constant,e.toWatch=e.left.toWatch.concat(e.right.toWatch);break;case Ri.LogicalExpression:Pi(e.left,t),Pi(e.right,t),e.constant=e.left.constant&&e.right.constant,e.toWatch=e.constant?[]:[e];break;case Ri.ConditionalExpression:Pi(e.test,t),Pi(e.alternate,t),Pi(e.consequent,t),e.constant=e.test.constant&&e.alternate.constant&&e.consequent.constant,e.toWatch=e.constant?[]:[e];break;case Ri.Identifier:e.constant=!1,e.toWatch=[e];break;case Ri.MemberExpression:Pi(e.object,t),e.computed&&Pi(e.property,t),e.constant=e.object.constant&&(!e.computed||e.property.constant),e.toWatch=[e];break;case Ri.CallExpression:r=!!e.filter&&function(e,t){return!e(t).$stateful}(t,e.callee.name),n=r,i=[],_(e.arguments,function(e){Pi(e,t),n=n&&e.constant,e.constant||i.push.apply(i,e.toWatch)}),e.constant=n,e.toWatch=r?i:[e];break;case Ri.AssignmentExpression:Pi(e.left,t),Pi(e.right,t),e.constant=e.left.constant&&e.right.constant,e.toWatch=[e];break;case Ri.ArrayExpression:n=!0,i=[],_(e.elements,function(e){Pi(e,t),n=n&&e.constant,e.constant||i.push.apply(i,e.toWatch)}),e.constant=n,e.toWatch=i;break;case Ri.ObjectExpression:n=!0,i=[],_(e.properties,function(e){Pi(e.value,t),n=n&&e.value.constant&&!e.computed,e.value.constant||i.push.apply(i,e.value.toWatch)}),e.constant=n,e.toWatch=i;break;case Ri.ThisExpression:case Ri.LocalsExpression:e.constant=!1,e.toWatch=[]}}function Li(e){if(1===e.length){var t=e[0].expression,n=t.toWatch;return 1!==n.length?n:n[0]!==t?n:void 0}}function Ni(e){return e.type===Ri.Identifier||e.type===Ri.MemberExpression}function Mi(e){if(1===e.body.length&&Ni(e.body[0].expression))return{type:Ri.AssignmentExpression,left:e.body[0].expression,right:{type:Ri.NGValueParameter},operator:"="}}function Ki(e){return 0===e.body.length||1===e.body.length&&(e.body[0].expression.type===Ri.Literal||e.body[0].expression.type===Ri.ArrayExpression||e.body[0].expression.type===Ri.ObjectExpression)}function $i(e){return e.constant}function ji(e,t){this.astBuilder=e,this.$filter=t}function Bi(e,t){this.astBuilder=e,this.$filter=t}Ri.Program="Program",Ri.ExpressionStatement="ExpressionStatement",Ri.AssignmentExpression="AssignmentExpression",Ri.ConditionalExpression="ConditionalExpression",Ri.LogicalExpression="LogicalExpression",Ri.BinaryExpression="BinaryExpression",Ri.UnaryExpression="UnaryExpression",Ri.CallExpression="CallExpression",Ri.MemberExpression="MemberExpression",Ri.Identifier="Identifier",Ri.Literal="Literal",Ri.ArrayExpression="ArrayExpression",Ri.Property="Property",Ri.ObjectExpression="ObjectExpression",Ri.ThisExpression="ThisExpression",Ri.LocalsExpression="LocalsExpression",Ri.NGValueParameter="NGValueParameter",Ri.prototype={ast:function(e){this.text=e,this.tokens=this.lexer.lex(e);var t=this.program();return 0!==this.tokens.length&&this.throwError("is an unexpected token",this.tokens[0]),t},program:function(){for(var e=[];;)if(this.tokens.length>0&&!this.peek("}",")",";","]")&&e.push(this.expressionStatement()),!this.expect(";"))return{type:Ri.Program,body:e}},expressionStatement:function(){return{type:Ri.ExpressionStatement,expression:this.filterChain()}},filterChain:function(){for(var e=this.expression();this.expect("|");)e=this.filter(e);return e},expression:function(){return this.assignment()},assignment:function(){var e=this.ternary();return this.expect("=")&&(e={type:Ri.AssignmentExpression,left:e,right:this.assignment(),operator:"="}),e},ternary:function(){var e,t,n=this.logicalOR();return this.expect("?")&&(e=this.expression(),this.consume(":"))?(t=this.expression(),{type:Ri.ConditionalExpression,test:n,alternate:e,consequent:t}):n},logicalOR:function(){for(var e=this.logicalAND();this.expect("||");)e={type:Ri.LogicalExpression,operator:"||",left:e,right:this.logicalAND()};return e},logicalAND:function(){for(var e=this.equality();this.expect("&&");)e={type:Ri.LogicalExpression,operator:"&&",left:e,right:this.equality()};return e},equality:function(){for(var e,t=this.relational();e=this.expect("==","!=","===","!==");)t={type:Ri.BinaryExpression,operator:e.text,left:t,right:this.relational()};return t},relational:function(){for(var e,t=this.additive();e=this.expect("<",">","<=",">=");)t={type:Ri.BinaryExpression,operator:e.text,left:t,right:this.additive()};return t},additive:function(){for(var e,t=this.multiplicative();e=this.expect("+","-");)t={type:Ri.BinaryExpression,operator:e.text,left:t,right:this.multiplicative()};return t},multiplicative:function(){for(var e,t=this.unary();e=this.expect("*","/","%");)t={type:Ri.BinaryExpression,operator:e.text,left:t,right:this.unary()};return t},unary:function(){var e;return(e=this.expect("+","-","!"))?{type:Ri.UnaryExpression,operator:e.text,prefix:!0,argument:this.unary()}:this.primary()},primary:function(){var e,t;for(this.expect("(")?(e=this.filterChain(),this.consume(")")):this.expect("[")?e=this.arrayDeclaration():this.expect("{")?e=this.object():this.selfReferential.hasOwnProperty(this.peek().text)?e=te(this.selfReferential[this.consume().text]):this.options.literals.hasOwnProperty(this.peek().text)?e={type:Ri.Literal,value:this.options.literals[this.consume().text]}:this.peek().identifier?e=this.identifier():this.peek().constant?e=this.constant():this.throwError("not a primary expression",this.peek());t=this.expect("(","[",".");)"("===t.text?(e={type:Ri.CallExpression,callee:e,arguments:this.parseArguments()},this.consume(")")):"["===t.text?(e={type:Ri.MemberExpression,object:e,property:this.expression(),computed:!0},this.consume("]")):"."===t.text?e={type:Ri.MemberExpression,object:e,property:this.identifier(),computed:!1}:this.throwError("IMPOSSIBLE");return e},filter:function(e){for(var t=[e],n={type:Ri.CallExpression,callee:this.identifier(),arguments:t,filter:!0};this.expect(":");)t.push(this.expression());return n},parseArguments:function(){var e=[];if(")"!==this.peekToken().text)do{e.push(this.filterChain())}while(this.expect(","));return e},identifier:function(){var e=this.consume();return e.identifier||this.throwError("is not a valid identifier",e),{type:Ri.Identifier,name:e.text}},constant:function(){return{type:Ri.Literal,value:this.consume().value}},arrayDeclaration:function(){var e=[];if("]"!==this.peekToken().text)do{if(this.peek("]"))break;e.push(this.expression())}while(this.expect(","));return this.consume("]"),{type:Ri.ArrayExpression,elements:e}},object:function(){var e,t=[];if("}"!==this.peekToken().text)do{if(this.peek("}"))break;e={type:Ri.Property,kind:"init"},this.peek().constant?(e.key=this.constant(),e.computed=!1,this.consume(":"),e.value=this.expression()):this.peek().identifier?(e.key=this.identifier(),e.computed=!1,this.peek(":")?(this.consume(":"),e.value=this.expression()):e.value=e.key):this.peek("[")?(this.consume("["),e.key=this.expression(),this.consume("]"),e.computed=!0,this.consume(":"),e.value=this.expression()):this.throwError("invalid key",this.peek()),t.push(e)}while(this.expect(","));return this.consume("}"),{type:Ri.ObjectExpression,properties:t}},throwError:function(e,t){throw ai("syntax","Syntax Error: Token '{0}' {1} at column {2} of the expression [{3}] starting at [{4}].",t.text,e,t.index+1,this.text,this.text.substring(t.index))},consume:function(e){if(0===this.tokens.length)throw ai("ueoe","Unexpected end of expression: {0}",this.text);var t=this.expect(e);return t||this.throwError("is unexpected, expecting ["+e+"]",this.peek()),t},peekToken:function(){if(0===this.tokens.length)throw ai("ueoe","Unexpected end of expression: {0}",this.text);return this.tokens[0]},peek:function(e,t,n,i){return this.peekAhead(0,e,t,n,i)},peekAhead:function(e,t,n,i,r){if(this.tokens.length>e){var a=this.tokens[e],o=a.text;if(o===t||o===n||o===i||o===r||!t&&!n&&!i&&!r)return a}return!1},expect:function(e,t,n,i){var r=this.peek(e,t,n,i);return!!r&&(this.tokens.shift(),r)},selfReferential:{this:{type:Ri.ThisExpression},$locals:{type:Ri.LocalsExpression}}},ji.prototype={compile:function(e,t){var n=this,i=this.astBuilder.ast(e);this.state={nextId:0,filters:{},expensiveChecks:t,fn:{vars:[],body:[],own:{}},assign:{vars:[],body:[],own:{}},inputs:[]},Pi(i,n.$filter);var r,a="";if(this.stage="assign",r=Mi(i)){this.state.computing="assign";var o=this.nextId();this.recurse(r,o),this.return_(o),a="fn.assign="+this.generateFunction("assign","s,v,l")}var s=Li(i.body);n.stage="inputs",_(s,function(e,t){var i="fn"+t;n.state[i]={vars:[],body:[],own:{}},n.state.computing=i;var r=n.nextId();n.recurse(e,r),n.return_(r),n.state.inputs.push(i),e.watchId=t}),this.state.computing="fn",this.stage="main",this.recurse(i);var l='"'+this.USE+" "+this.STRICT+'";\n'+this.filterPrefix()+"var fn="+this.generateFunction("fn","s,l,a,i")+a+this.watchFns()+"return fn;",u=new Function("$filter","ensureSafeMemberName","ensureSafeObject","ensureSafeFunction","getStringValue","ensureSafeAssignContext","ifDefined","plus","text",l)(this.$filter,Ei,wi,ki,Ci,Si,xi,Ai,e);return this.state=this.stage=void 0,u.literal=Ki(i),u.constant=$i(i),u},USE:"use",STRICT:"strict",watchFns:function(){var e=[],t=this.state.inputs,n=this;return _(t,function(t){e.push("var "+t+"="+n.generateFunction(t,"s"))}),t.length&&e.push("fn.inputs=["+t.join(",")+"];"),e.join("")},generateFunction:function(e,t){return"function("+t+"){"+this.varsPrefix(e)+this.body(e)+"};"},filterPrefix:function(){var e=[],t=this;return _(this.state.filters,function(n,i){e.push(n+"=$filter("+t.escape(i)+")")}),e.length?"var "+e.join(",")+";":""},varsPrefix:function(e){return this.state[e].vars.length?"var "+this.state[e].vars.join(",")+";":""},body:function(e){return this.state[e].body.join("")},recurse:function(e,t,n,i,r,a){var o,s,l,u,c,d=this;if(i=i||x,!a&&M(e.watchId))return t=t||this.nextId(),void this.if_("i",this.lazyAssign(t,this.computedMember("i",e.watchId)),this.lazyRecurse(e,t,n,i,r,!0));switch(e.type){case Ri.Program:_(e.body,function(t,n){d.recurse(t.expression,void 0,void 0,function(e){s=e}),n!==e.body.length-1?d.current().body.push(s,";"):d.return_(s)});break;case Ri.Literal:u=this.escape(e.value),this.assign(t,u),i(u);break;case Ri.UnaryExpression:this.recurse(e.argument,void 0,void 0,function(e){s=e}),u=e.operator+"("+this.ifDefined(s,0)+")",this.assign(t,u),i(u);break;case Ri.BinaryExpression:this.recurse(e.left,void 0,void 0,function(e){o=e}),this.recurse(e.right,void 0,void 0,function(e){s=e}),u="+"===e.operator?this.plus(o,s):"-"===e.operator?this.ifDefined(o,0)+e.operator+this.ifDefined(s,0):"("+o+")"+e.operator+"("+s+")",this.assign(t,u),i(u);break;case Ri.LogicalExpression:t=t||this.nextId(),d.recurse(e.left,t),d.if_("&&"===e.operator?t:d.not(t),d.lazyRecurse(e.right,t)),i(t);break;case Ri.ConditionalExpression:t=t||this.nextId(),d.recurse(e.test,t),d.if_(t,d.lazyRecurse(e.alternate,t),d.lazyRecurse(e.consequent,t)),i(t);break;case Ri.Identifier:t=t||this.nextId(),n&&(n.context="inputs"===d.stage?"s":this.assign(this.nextId(),this.getHasOwnProperty("l",e.name)+"?l:s"),n.computed=!1,n.name=e.name),Ei(e.name),d.if_("inputs"===d.stage||d.not(d.getHasOwnProperty("l",e.name)),function(){d.if_("inputs"===d.stage||"s",function(){r&&1!==r&&d.if_(d.not(d.nonComputedMember("s",e.name)),d.lazyAssign(d.nonComputedMember("s",e.name),"{}")),d.assign(t,d.nonComputedMember("s",e.name))})},t&&d.lazyAssign(t,d.nonComputedMember("l",e.name))),(d.state.expensiveChecks||Ui(e.name))&&d.addEnsureSafeObject(t),i(t);break;case Ri.MemberExpression:o=n&&(n.context=this.nextId())||this.nextId(),t=t||this.nextId(),d.recurse(e.object,o,void 0,function(){d.if_(d.notNull(o),function(){r&&1!==r&&d.addEnsureSafeAssignContext(o),e.computed?(s=d.nextId(),d.recurse(e.property,s),d.getStringValue(s),d.addEnsureSafeMemberName(s),r&&1!==r&&d.if_(d.not(d.computedMember(o,s)),d.lazyAssign(d.computedMember(o,s),"{}")),u=d.ensureSafeObject(d.computedMember(o,s)),d.assign(t,u),n&&(n.computed=!0,n.name=s)):(Ei(e.property.name),r&&1!==r&&d.if_(d.not(d.nonComputedMember(o,e.property.name)),d.lazyAssign(d.nonComputedMember(o,e.property.name),"{}")),u=d.nonComputedMember(o,e.property.name),(d.state.expensiveChecks||Ui(e.property.name))&&(u=d.ensureSafeObject(u)),d.assign(t,u),n&&(n.computed=!1,n.name=e.property.name))},function(){d.assign(t,"undefined")}),i(t)},!!r);break;case Ri.CallExpression:t=t||this.nextId(),e.filter?(s=d.filter(e.callee.name),l=[],_(e.arguments,function(e){var t=d.nextId();d.recurse(e,t),l.push(t)}),u=s+"("+l.join(",")+")",d.assign(t,u),i(t)):(s=d.nextId(),o={},l=[],d.recurse(e.callee,s,o,function(){d.if_(d.notNull(s),function(){d.addEnsureSafeFunction(s),_(e.arguments,function(e){d.recurse(e,d.nextId(),void 0,function(e){l.push(d.ensureSafeObject(e))})}),o.name?(d.state.expensiveChecks||d.addEnsureSafeObject(o.context),u=d.member(o.context,o.name,o.computed)+"("+l.join(",")+")"):u=s+"("+l.join(",")+")",u=d.ensureSafeObject(u),d.assign(t,u)},function(){d.assign(t,"undefined")}),i(t)}));break;case Ri.AssignmentExpression:if(s=this.nextId(),o={},!Ni(e.left))throw ai("lval","Trying to assign a value to a non l-value");this.recurse(e.left,void 0,o,function(){d.if_(d.notNull(o.context),function(){d.recurse(e.right,s),d.addEnsureSafeObject(d.member(o.context,o.name,o.computed)),d.addEnsureSafeAssignContext(o.context),u=d.member(o.context,o.name,o.computed)+e.operator+s,d.assign(t,u),i(t||u)})},1);break;case Ri.ArrayExpression:l=[],_(e.elements,function(e){d.recurse(e,d.nextId(),void 0,function(e){l.push(e)})}),u="["+l.join(",")+"]",this.assign(t,u),i(u);break;case Ri.ObjectExpression:l=[],c=!1,_(e.properties,function(e){e.computed&&(c=!0)}),c?(t=t||this.nextId(),this.assign(t,"{}"),_(e.properties,function(e){e.computed?(o=d.nextId(),d.recurse(e.key,o)):o=e.key.type===Ri.Identifier?e.key.name:""+e.key.value,s=d.nextId(),d.recurse(e.value,s),d.assign(d.member(t,o,e.computed),s)})):(_(e.properties,function(t){d.recurse(t.value,e.constant?void 0:d.nextId(),void 0,function(e){l.push(d.escape(t.key.type===Ri.Identifier?t.key.name:""+t.key.value)+":"+e)})}),u="{"+l.join(",")+"}",this.assign(t,u)),i(t||u);break;case Ri.ThisExpression:this.assign(t,"s"),i("s");break;case Ri.LocalsExpression:this.assign(t,"l"),i("l");break;case Ri.NGValueParameter:this.assign(t,"v"),i("v")}},getHasOwnProperty:function(e,t){var n=e+"."+t,i=this.current().own;return i.hasOwnProperty(n)||(i[n]=this.nextId(!1,e+"&&("+this.escape(t)+" in "+e+")")),i[n]},assign:function(e,t){if(e)return this.current().body.push(e,"=",t,";"),e},filter:function(e){return this.state.filters.hasOwnProperty(e)||(this.state.filters[e]=this.nextId(!0)),this.state.filters[e]},ifDefined:function(e,t){return"ifDefined("+e+","+this.escape(t)+")"},plus:function(e,t){return"plus("+e+","+t+")"},return_:function(e){this.current().body.push("return ",e,";")},if_:function(e,t,n){if(!0===e)t();else{var i=this.current().body;i.push("if(",e,"){"),t(),i.push("}"),n&&(i.push("else{"),n(),i.push("}"))}},not:function(e){return"!("+e+")"},notNull:function(e){return e+"!=null"},nonComputedMember:function(e,t){return/^[$_a-zA-Z][$_a-zA-Z0-9]*$/.test(t)?e+"."+t:e+'["'+t.replace(/[^$_a-zA-Z0-9]/g,this.stringEscapeFn)+'"]'},computedMember:function(e,t){return e+"["+t+"]"},member:function(e,t,n){return n?this.computedMember(e,t):this.nonComputedMember(e,t)},addEnsureSafeObject:function(e){this.current().body.push(this.ensureSafeObject(e),";")},addEnsureSafeMemberName:function(e){this.current().body.push(this.ensureSafeMemberName(e),";")},addEnsureSafeFunction:function(e){this.current().body.push(this.ensureSafeFunction(e),";")},addEnsureSafeAssignContext:function(e){this.current().body.push(this.ensureSafeAssignContext(e),";")},ensureSafeObject:function(e){return"ensureSafeObject("+e+",text)"},ensureSafeMemberName:function(e){return"ensureSafeMemberName("+e+",text)"},ensureSafeFunction:function(e){return"ensureSafeFunction("+e+",text)"},getStringValue:function(e){this.assign(e,"getStringValue("+e+")")},ensureSafeAssignContext:function(e){return"ensureSafeAssignContext("+e+",text)"},lazyRecurse:function(e,t,n,i,r,a){var o=this;return function(){o.recurse(e,t,n,i,r,a)}},lazyAssign:function(e,t){var n=this;return function(){n.assign(e,t)}},stringEscapeRegex:/[^ a-zA-Z0-9]/g,stringEscapeFn:function(e){return"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)},escape:function(e){if(j(e))return"'"+e.replace(this.stringEscapeRegex,this.stringEscapeFn)+"'";if(B(e))return e.toString();if(!0===e)return"true";if(!1===e)return"false";if(null===e)return"null";if(void 0===e)return"undefined";throw ai("esc","IMPOSSIBLE")},nextId:function(e,t){var n="v"+this.state.nextId++;return e||this.current().vars.push(n+(t?"="+t:"")),n},current:function(){return this.state[this.state.computing]}},Bi.prototype={compile:function(e,t){var n,i,r=this,a=this.astBuilder.ast(e);this.expression=e,this.expensiveChecks=t,Pi(a,r.$filter),(n=Mi(a))&&(i=this.recurse(n));var o,s=Li(a.body);s&&(o=[],_(s,function(e,t){var n=r.recurse(e);e.input=n,o.push(n),e.watchId=t}));var l=[];_(a.body,function(e){l.push(r.recurse(e.expression))});var u=0===a.body.length?x:1===a.body.length?l[0]:function(e,t){var n;return _(l,function(i){n=i(e,t)}),n};return i&&(u.assign=function(e,t,n){return i(e,n,t)}),o&&(u.inputs=o),u.literal=Ki(a),u.constant=$i(a),u},recurse:function(e,t,n){var i,r,a,o=this;if(e.input)return this.inputs(e.input,e.watchId);switch(e.type){case Ri.Literal:return this.value(e.value,t);case Ri.UnaryExpression:return r=this.recurse(e.argument),this["unary"+e.operator](r,t);case Ri.BinaryExpression:case Ri.LogicalExpression:return i=this.recurse(e.left),r=this.recurse(e.right),this["binary"+e.operator](i,r,t);case Ri.ConditionalExpression:return this["ternary?:"](this.recurse(e.test),this.recurse(e.alternate),this.recurse(e.consequent),t);case Ri.Identifier:return Ei(e.name,o.expression),o.identifier(e.name,o.expensiveChecks||Ui(e.name),t,n,o.expression);case Ri.MemberExpression:return i=this.recurse(e.object,!1,!!n),e.computed||(Ei(e.property.name,o.expression),r=e.property.name),e.computed&&(r=this.recurse(e.property)),e.computed?this.computedMember(i,r,t,n,o.expression):this.nonComputedMember(i,r,o.expensiveChecks,t,n,o.expression);case Ri.CallExpression:return a=[],_(e.arguments,function(e){a.push(o.recurse(e))}),e.filter&&(r=this.$filter(e.callee.name)),e.filter||(r=this.recurse(e.callee,!0)),e.filter?function(e,n,i,o){for(var s=[],l=0;l<a.length;++l)s.push(a[l](e,n,i,o));var u=r.apply(void 0,s,o);return t?{context:void 0,name:void 0,value:u}:u}:function(e,n,i,s){var l,u=r(e,n,i,s);if(null!=u.value){wi(u.context,o.expression),ki(u.value,o.expression);for(var c=[],d=0;d<a.length;++d)c.push(wi(a[d](e,n,i,s),o.expression));l=wi(u.value.apply(u.context,c),o.expression)}return t?{value:l}:l};case Ri.AssignmentExpression:return i=this.recurse(e.left,!0,1),r=this.recurse(e.right),function(e,n,a,s){var l=i(e,n,a,s),u=r(e,n,a,s);return wi(l.value,o.expression),Si(l.context),l.context[l.name]=u,t?{value:u}:u};case Ri.ArrayExpression:return a=[],_(e.elements,function(e){a.push(o.recurse(e))}),function(e,n,i,r){for(var o=[],s=0;s<a.length;++s)o.push(a[s](e,n,i,r));return t?{value:o}:o};case Ri.ObjectExpression:return a=[],_(e.properties,function(e){e.computed?a.push({key:o.recurse(e.key),computed:!0,value:o.recurse(e.value)}):a.push({key:e.key.type===Ri.Identifier?e.key.name:""+e.key.value,computed:!1,value:o.recurse(e.value)})}),function(e,n,i,r){for(var o={},s=0;s<a.length;++s)a[s].computed?o[a[s].key(e,n,i,r)]=a[s].value(e,n,i,r):o[a[s].key]=a[s].value(e,n,i,r);return t?{value:o}:o};case Ri.ThisExpression:return function(e){return t?{value:e}:e};case Ri.LocalsExpression:return function(e,n){return t?{value:n}:n};case Ri.NGValueParameter:return function(e,n,i){return t?{value:i}:i}}},"unary+":function(e,t){return function(n,i,r,a){var o=e(n,i,r,a);return o=M(o)?+o:0,t?{value:o}:o}},"unary-":function(e,t){return function(n,i,r,a){var o=e(n,i,r,a);return o=M(o)?-o:0,t?{value:o}:o}},"unary!":function(e,t){return function(n,i,r,a){var o=!e(n,i,r,a);return t?{value:o}:o}},"binary+":function(e,t,n){return function(i,r,a,o){var s=Ai(e(i,r,a,o),t(i,r,a,o));return n?{value:s}:s}},"binary-":function(e,t,n){return function(i,r,a,o){var s=e(i,r,a,o),l=t(i,r,a,o),u=(M(s)?s:0)-(M(l)?l:0);return n?{value:u}:u}},"binary*":function(e,t,n){return function(i,r,a,o){var s=e(i,r,a,o)*t(i,r,a,o);return n?{value:s}:s}},"binary/":function(e,t,n){return function(i,r,a,o){var s=e(i,r,a,o)/t(i,r,a,o);return n?{value:s}:s}},"binary%":function(e,t,n){return function(i,r,a,o){var s=e(i,r,a,o)%t(i,r,a,o);return n?{value:s}:s}},"binary===":function(e,t,n){return function(i,r,a,o){var s=e(i,r,a,o)===t(i,r,a,o);return n?{value:s}:s}},"binary!==":function(e,t,n){return function(i,r,a,o){var s=e(i,r,a,o)!==t(i,r,a,o);return n?{value:s}:s}},"binary==":function(e,t,n){return function(i,r,a,o){var s=e(i,r,a,o)==t(i,r,a,o);return n?{value:s}:s}},"binary!=":function(e,t,n){return function(i,r,a,o){var s=e(i,r,a,o)!=t(i,r,a,o);return n?{value:s}:s}},"binary<":function(e,t,n){return function(i,r,a,o){var s=e(i,r,a,o)<t(i,r,a,o);return n?{value:s}:s}},"binary>":function(e,t,n){return function(i,r,a,o){var s=e(i,r,a,o)>t(i,r,a,o);return n?{value:s}:s}},"binary<=":function(e,t,n){return function(i,r,a,o){var s=e(i,r,a,o)<=t(i,r,a,o);return n?{value:s}:s}},"binary>=":function(e,t,n){return function(i,r,a,o){var s=e(i,r,a,o)>=t(i,r,a,o);return n?{value:s}:s}},"binary&&":function(e,t,n){return function(i,r,a,o){var s=e(i,r,a,o)&&t(i,r,a,o);return n?{value:s}:s}},"binary||":function(e,t,n){return function(i,r,a,o){var s=e(i,r,a,o)||t(i,r,a,o);return n?{value:s}:s}},"ternary?:":function(e,t,n,i){return function(r,a,o,s){var l=e(r,a,o,s)?t(r,a,o,s):n(r,a,o,s);return i?{value:l}:l}},value:function(e,t){return function(){return t?{context:void 0,name:void 0,value:e}:e}},identifier:function(e,t,n,i,r){return function(a,o,s,l){var u=o&&e in o?o:a;i&&1!==i&&u&&!u[e]&&(u[e]={});var c=u?u[e]:void 0;return t&&wi(c,r),n?{context:u,name:e,value:c}:c}},computedMember:function(e,t,n,i,r){return function(a,o,s,l){var u,c,d=e(a,o,s,l);return null!=d&&(Ei(u=Ci(u=t(a,o,s,l)),r),i&&1!==i&&(Si(d),d&&!d[u]&&(d[u]={})),wi(c=d[u],r)),n?{context:d,name:u,value:c}:c}},nonComputedMember:function(e,t,n,i,r,a){return function(o,s,l,u){var c=e(o,s,l,u);r&&1!==r&&(Si(c),c&&!c[t]&&(c[t]={}));var d=null!=c?c[t]:void 0;return(n||Ui(t))&&wi(d,a),i?{context:c,name:t,value:d}:d}},inputs:function(e,t){return function(n,i,r,a){return a?a[t]:e(n,i,r)}}};var Fi=function(e,t,n){this.lexer=e,this.$filter=t,this.options=n,this.ast=new Ri(e,n),this.astCompiler=n.csp?new Bi(this.ast,t):new ji(this.ast,t)};function Ui(e){return"constructor"===e}function Vi(e){return V(e.valueOf)?e.valueOf():Ti.call(e)}function qi(){var e,t,n=Pe(),i=Pe(),r={true:!0,false:!1,null:null,undefined:void 0};this.addLiteral=function(e,t){r[e]=t},this.setIdentifierFns=function(n,i){return e=n,t=i,this},this.$get=["$filter",function(a){var o=ie().noUnsafeEval,s={csp:o,expensiveChecks:!1,literals:te(r),isIdentifierStart:V(e)&&e,isIdentifierContinue:V(t)&&t},l={csp:o,expensiveChecks:!0,literals:te(r),isIdentifierStart:V(e)&&e,isIdentifierContinue:V(t)&&t},u=!1;return c.$$runningExpensiveChecks=function(){return u},c;function c(e,t,r){var o,c,d;switch(r=r||u,typeof e){case"string":d=e=e.trim();var v=r?i:n;if(!(o=v[d])){":"===e.charAt(0)&&":"===e.charAt(1)&&(c=!0,e=e.substring(2));var y=r?l:s,b=new Di(y);(o=new Fi(b,a,y).parse(e)).constant?o.$$watchDelegate=g:c?o.$$watchDelegate=o.literal?f:p:o.inputs&&(o.$$watchDelegate=h),r&&(o=function e(t){if(!t)return t;i.$$watchDelegate=t.$$watchDelegate,i.assign=e(t.assign),i.constant=t.constant,i.literal=t.literal;for(var n=0;t.inputs&&n<t.inputs.length;++n)t.inputs[n]=e(t.inputs[n]);return i.inputs=t.inputs,i;function i(e,n,i,r){var a=u;u=!0;try{return t(e,n,i,r)}finally{u=a}}}(o)),v[d]=o}return m(o,t);case"function":return m(e,t);default:return m(x,t)}}function d(e,t){return null==e||null==t?e===t:("object"!=typeof e||"object"!=typeof(e=Vi(e)))&&(e===t||e!=e&&t!=t)}function h(e,t,n,i,r){var a,o=i.inputs;if(1===o.length){var s=d;return o=o[0],e.$watch(function(e){var t=o(e);return d(t,s)||(a=i(e,void 0,void 0,[t]),s=t&&Vi(t)),a},t,n,r)}for(var l=[],u=[],c=0,h=o.length;c<h;c++)l[c]=d,u[c]=null;return e.$watch(function(e){for(var t=!1,n=0,r=o.length;n<r;n++){var s=o[n](e);(t||(t=!d(s,l[n])))&&(u[n]=s,l[n]=s&&Vi(s))}return t&&(a=i(e,void 0,void 0,u)),a},t,n,r)}function p(e,t,n,i){var r,a;return r=e.$watch(function(e){return i(e)},function(e,n,i){a=e,V(t)&&t.apply(this,arguments),M(e)&&i.$$postDigest(function(){M(a)&&r()})},n)}function f(e,t,n,i){var r,a;return r=e.$watch(function(e){return i(e)},function(e,n,i){a=e,V(t)&&t.call(this,e,n,i),o(e)&&i.$$postDigest(function(){o(a)&&r()})},n);function o(e){var t=!0;return _(e,function(e){M(e)||(t=!1)}),t}}function g(e,t,n,i){var r=e.$watch(function(e){return r(),i(e)},t,n);return r}function m(e,t){if(!t)return e;var n=e.$$watchDelegate,i=!1,r=n!==f&&n!==p?function(n,r,a,o){var s=i&&o?o[0]:e(n,r,a,o);return t(s,n,r)}:function(n,i,r,a){var o=e(n,i,r,a),s=t(o,n,i);return M(o)?s:o};return e.$$watchDelegate&&e.$$watchDelegate!==h?r.$$watchDelegate=e.$$watchDelegate:t.$stateful||(r.$$watchDelegate=h,i=!e.inputs,r.inputs=e.inputs?e.inputs:[e]),r}}]}function Hi(){this.$get=["$rootScope","$exceptionHandler",function(e,t){return Wi(function(t){e.$evalAsync(t)},t)}]}function zi(){this.$get=["$browser","$exceptionHandler",function(e,t){return Wi(function(t){e.defer(t)},t)}]}function Wi(e,n){var i=t("$q",TypeError),r=function(){var e=new l;return e.resolve=o(e,e.resolve),e.reject=o(e,e.reject),e.notify=o(e,e.notify),e};function a(){this.$$state={status:0}}function o(e,t){return function(n){t.call(e,n)}}function s(t){!t.processScheduled&&t.pending&&(t.processScheduled=!0,e(function(){!function(e){var t,i,r;r=e.pending,e.processScheduled=!1,e.pending=void 0;for(var a=0,o=r.length;a<o;++a){i=r[a][0],t=r[a][e.status];try{V(t)?i.resolve(t(e.value)):1===e.status?i.resolve(e.value):i.reject(e.value)}catch(e){i.reject(e),n(e)}}}(t)}))}function l(){this.promise=new a}S(a.prototype,{then:function(e,t,n){if(N(e)&&N(t)&&N(n))return this;var i=new l;return this.$$state.pending=this.$$state.pending||[],this.$$state.pending.push([i,e,t,n]),this.$$state.status>0&&s(this.$$state),i.promise},catch:function(e){return this.then(null,e)},finally:function(e,t){return this.then(function(t){return c(t,!0,e)},function(t){return c(t,!1,e)},t)}}),S(l.prototype,{resolve:function(e){this.promise.$$state.status||(e===this.promise?this.$$reject(i("qcycle","Expected promise to be resolved with value other than itself '{0}'",e)):this.$$resolve(e))},$$resolve:function(e){var t,i=this,r=!1;try{(K(e)||V(e))&&(t=e&&e.then),V(t)?(this.promise.$$state.status=-1,t.call(e,function(e){r||(r=!0,i.$$resolve(e))},a,o(this,this.notify))):(this.promise.$$state.value=e,this.promise.$$state.status=1,s(this.promise.$$state))}catch(e){a(e),n(e)}function a(e){r||(r=!0,i.$$reject(e))}},reject:function(e){this.promise.$$state.status||this.$$reject(e)},$$reject:function(e){this.promise.$$state.value=e,this.promise.$$state.status=2,s(this.promise.$$state)},notify:function(t){var i=this.promise.$$state.pending;this.promise.$$state.status<=0&&i&&i.length&&e(function(){for(var e,r,a=0,o=i.length;a<o;a++){r=i[a][0],e=i[a][3];try{r.notify(V(e)?e(t):t)}catch(e){n(e)}}})}});var u=function(e,t){var n=new l;return t?n.resolve(e):n.reject(e),n.promise},c=function(e,t,n){var i=null;try{V(n)&&(i=n())}catch(e){return u(e,!1)}return G(i)?i.then(function(){return u(e,t)},function(e){return u(e,!1)}):u(e,t)},d=function(e,t,n,i){var r=new l;return r.resolve(e),r.promise.then(t,n,i)},h=d,p=function(e){if(!V(e))throw i("norslvr","Expected resolverFn, got '{0}'",e);var t=new l;return e(function(e){t.resolve(e)},function(e){t.reject(e)}),t.promise};return p.prototype=a.prototype,p.defer=r,p.reject=function(e){var t=new l;return t.reject(e),t.promise},p.when=d,p.resolve=h,p.all=function(e){var t=new l,n=0,i=U(e)?[]:{};return _(e,function(e,r){n++,d(e).then(function(e){i.hasOwnProperty(r)||(i[r]=e,--n||t.resolve(i))},function(e){i.hasOwnProperty(r)||t.reject(e)})}),0===n&&t.resolve(i),t.promise},p.race=function(e){var t=r();return _(e,function(e){d(e).then(t.resolve,t.reject)}),t.promise},p}function Gi(){this.$get=["$window","$timeout",function(e,t){var n=e.requestAnimationFrame||e.webkitRequestAnimationFrame,i=e.cancelAnimationFrame||e.webkitCancelAnimationFrame||e.webkitCancelRequestAnimationFrame,r=!!n,a=r?function(e){var t=n(e);return function(){i(t)}}:function(e){var n=t(e,16.66,!1);return function(){t.cancel(n)}};return a.supported=r,a}]}function Xi(){var e=10,n=t("$rootScope"),i=null,a=null;this.digestTtl=function(t){return arguments.length&&(e=t),e},this.$get=["$exceptionHandler","$parse","$browser",function(t,o,l){function u(e){e.currentScope.$$destroyed=!0}function c(){this.$id=C(),this.$$phase=this.$parent=this.$$watchers=this.$$nextSibling=this.$$prevSibling=this.$$childHead=this.$$childTail=null,this.$root=this,this.$$destroyed=!1,this.$$listeners={},this.$$listenerCount={},this.$$watchersCount=0,this.$$isolateBindings=null}c.prototype={constructor:c,$new:function(e,t){var n;return t=t||this,e?(n=new c).$root=this.$root:(this.$$ChildScope||(this.$$ChildScope=function(e){function t(){this.$$watchers=this.$$nextSibling=this.$$childHead=this.$$childTail=null,this.$$listeners={},this.$$listenerCount={},this.$$watchersCount=0,this.$id=C(),this.$$ChildScope=null}return t.prototype=e,t}(this)),n=new this.$$ChildScope),n.$parent=t,n.$$prevSibling=t.$$childTail,t.$$childHead?(t.$$childTail.$$nextSibling=n,t.$$childTail=n):t.$$childHead=t.$$childTail=n,(e||t!==this)&&n.$on("$destroy",u),n},$watch:function(e,t,n,r){var a=o(e);if(a.$$watchDelegate)return a.$$watchDelegate(this,t,n,a,e);var s=this,l=s.$$watchers,u={fn:t,last:E,get:a,exp:r||e,eq:!!n};return i=null,V(t)||(u.fn=x),l||(l=s.$$watchers=[]),l.unshift(u),y(this,1),function(){ee(l,u)>=0&&y(s,-1),i=null}},$watchGroup:function(e,t){var n=new Array(e.length),i=new Array(e.length),r=[],a=this,o=!1,s=!0;if(!e.length){var l=!0;return a.$evalAsync(function(){l&&t(i,i,a)}),function(){l=!1}}if(1===e.length)return this.$watch(e[0],function(e,r,a){i[0]=e,n[0]=r,t(i,e===r?i:n,a)});function u(){o=!1,s?(s=!1,t(i,i,a)):t(i,n,a)}return _(e,function(e,t){var s=a.$watch(e,function(e,r){i[t]=e,n[t]=r,o||(o=!0,a.$evalAsync(u))});r.push(s)}),function(){for(;r.length;)r.shift()()}},$watchCollection:function(e,t){g.$stateful=!0;var n,i,a,s=this,l=t.length>1,u=0,c=o(e,g),d=[],h={},p=!0,f=0;function g(e){var t,a,o,s;if(!N(n=e)){if(K(n))if(b(n)){i!==d&&(f=(i=d).length=0,u++),t=n.length,f!==t&&(u++,i.length=f=t);for(var l=0;l<t;l++)s=i[l],o=n[l],s!=s&&o!=o||s===o||(u++,i[l]=o)}else{for(a in i!==h&&(i=h={},f=0,u++),t=0,n)r.call(n,a)&&(t++,o=n[a],s=i[a],a in i?s!=s&&o!=o||s===o||(u++,i[a]=o):(f++,i[a]=o,u++));if(f>t)for(a in u++,i)r.call(n,a)||(f--,delete i[a])}else i!==n&&(i=n,u++);return u}}return this.$watch(c,function(){if(p?(p=!1,t(n,n,s)):t(n,a,s),l)if(K(n))if(b(n)){a=new Array(n.length);for(var e=0;e<n.length;e++)a[e]=n[e]}else for(var i in a={},n)r.call(n,i)&&(a[i]=n[i]);else a=n})},$digest:function(){var r,o,s,u,c,f,y,b,_,T,C=e,k=[];m("$digest"),l.$$checkUrlChange(),this===d&&null!==a&&(l.defer.cancel(a),w()),i=null;do{f=!1,b=this;for(var S=0;S<h.length;S++){try{(T=h[S]).scope.$eval(T.expression,T.locals)}catch(e){t(e)}i=null}h.length=0;e:do{if(u=b.$$watchers)for(c=u.length;c--;)try{if(r=u[c])if((o=(0,r.get)(b))===(s=r.last)||(r.eq?ne(o,s):D(o)&&D(s))){if(r===i){f=!1;break e}}else f=!0,i=r,r.last=r.eq?te(o,null):o,(0,r.fn)(o,s===E?o:s,b),C<5&&(k[_=4-C]||(k[_]=[]),k[_].push({msg:V(r.exp)?"fn: "+(r.exp.name||r.exp.toString()):r.exp,newVal:o,oldVal:s}))}catch(e){t(e)}if(!(y=b.$$watchersCount&&b.$$childHead||b!==this&&b.$$nextSibling))for(;b!==this&&!(y=b.$$nextSibling);)b=b.$parent}while(b=y);if((f||h.length)&&!C--)throw v(),n("infdig","{0} $digest() iterations reached. Aborting!\nWatchers fired in the last 5 iterations: {1}",e,k)}while(f||h.length);for(v();g<p.length;)try{p[g++]()}catch(e){t(e)}p.length=g=0},$destroy:function(){if(!this.$$destroyed){var e=this.$parent;for(var t in this.$broadcast("$destroy"),this.$$destroyed=!0,this===d&&l.$$applicationDestroyed(),y(this,-this.$$watchersCount),this.$$listenerCount)T(this,this.$$listenerCount[t],t);e&&e.$$childHead===this&&(e.$$childHead=this.$$nextSibling),e&&e.$$childTail===this&&(e.$$childTail=this.$$prevSibling),this.$$prevSibling&&(this.$$prevSibling.$$nextSibling=this.$$nextSibling),this.$$nextSibling&&(this.$$nextSibling.$$prevSibling=this.$$prevSibling),this.$destroy=this.$digest=this.$apply=this.$evalAsync=this.$applyAsync=x,this.$on=this.$watch=this.$watchGroup=function(){return x},this.$$listeners={},this.$$nextSibling=null,function e(t){9===s&&(t.$$childHead&&e(t.$$childHead),t.$$nextSibling&&e(t.$$nextSibling)),t.$parent=t.$$nextSibling=t.$$prevSibling=t.$$childHead=t.$$childTail=t.$root=t.$$watchers=null}(this)}},$eval:function(e,t){return o(e)(this,t)},$evalAsync:function(e,t){d.$$phase||h.length||l.defer(function(){h.length&&d.$digest()}),h.push({scope:this,expression:o(e),locals:t})},$$postDigest:function(e){p.push(e)},$apply:function(e){try{m("$apply");try{return this.$eval(e)}finally{v()}}catch(e){t(e)}finally{try{d.$digest()}catch(e){throw t(e),e}}},$applyAsync:function(e){var t=this;e&&f.push(function(){t.$eval(e)}),e=o(e),null===a&&(a=l.defer(function(){d.$apply(w)}))},$on:function(e,t){var n=this.$$listeners[e];n||(this.$$listeners[e]=n=[]),n.push(t);var i=this;do{i.$$listenerCount[e]||(i.$$listenerCount[e]=0),i.$$listenerCount[e]++}while(i=i.$parent);var r=this;return function(){var i=n.indexOf(t);-1!==i&&(n[i]=null,T(r,1,e))}},$emit:function(e,n){var i,r,a,o=[],s=this,l=!1,u={name:e,targetScope:s,stopPropagation:function(){l=!0},preventDefault:function(){u.defaultPrevented=!0},defaultPrevented:!1},c=ae([u],arguments,1);do{for(i=s.$$listeners[e]||o,u.currentScope=s,r=0,a=i.length;r<a;r++)if(i[r])try{i[r].apply(null,c)}catch(e){t(e)}else i.splice(r,1),r--,a--;if(l)return u.currentScope=null,u;s=s.$parent}while(s);return u.currentScope=null,u},$broadcast:function(e,n){var i=this,r=this,a={name:e,targetScope:this,preventDefault:function(){a.defaultPrevented=!0},defaultPrevented:!1};if(!this.$$listenerCount[e])return a;for(var o,s,l,u=ae([a],arguments,1);i=r;){for(a.currentScope=i,s=0,l=(o=i.$$listeners[e]||[]).length;s<l;s++)if(o[s])try{o[s].apply(null,u)}catch(e){t(e)}else o.splice(s,1),s--,l--;if(!(r=i.$$listenerCount[e]&&i.$$childHead||i!==this&&i.$$nextSibling))for(;i!==this&&!(r=i.$$nextSibling);)i=i.$parent}return a.currentScope=null,a}};var d=new c,h=d.$$asyncQueue=[],p=d.$$postDigestQueue=[],f=d.$$applyAsyncQueue=[],g=0;return d;function m(e){if(d.$$phase)throw n("inprog","{0} already in progress",d.$$phase);d.$$phase=e}function v(){d.$$phase=null}function y(e,t){do{e.$$watchersCount+=t}while(e=e.$parent)}function T(e,t,n){do{e.$$listenerCount[n]-=t,0===e.$$listenerCount[n]&&delete e.$$listenerCount[n]}while(e=e.$parent)}function E(){}function w(){for(;f.length;)try{f.shift()()}catch(e){t(e)}a=null}}]}function Yi(){var e=/^\s*(https?|ftp|mailto|tel|file):/,t=/^\s*((https?|ftp|file|blob):|data:image\/)/;this.aHrefSanitizationWhitelist=function(t){return M(t)?(e=t,this):e},this.imgSrcSanitizationWhitelist=function(e){return M(e)?(t=e,this):t},this.$get=function(){return function(n,i){var r,a=i?t:e;return""===(r=ur(n).href)||r.match(a)?n:"unsafe:"+r}}}Fi.prototype={constructor:Fi,parse:function(e){return this.astCompiler.compile(e,this.options.expensiveChecks)}};var Qi=t("$sce"),Ji={HTML:"html",CSS:"css",URL:"url",RESOURCE_URL:"resourceUrl",JS:"js"};function Zi(e){var t=[];return M(e)&&_(e,function(e){t.push(function(e){if("self"===e)return e;if(j(e)){if(e.indexOf("***")>-1)throw Qi("iwcard","Illegal sequence *** in string matcher.  String: {0}",e);return e=Q(e).replace("\\*\\*",".*").replace("\\*","[^:/.?&;]*"),new RegExp("^"+e+"$")}if(q(e))return new RegExp("^"+e.source+"$");throw Qi("imatcher",'Matchers may only be "self", string patterns or RegExp objects')}(e))}),t}function er(){this.SCE_CONTEXTS=Ji;var e=["self"],t=[];this.resourceUrlWhitelist=function(t){return arguments.length&&(e=Zi(t)),e},this.resourceUrlBlacklist=function(e){return arguments.length&&(t=Zi(e)),t},this.$get=["$injector",function(n){var i=function(e){throw Qi("unsafe","Attempting to use an unsafe value in a safe context.")};function r(e,t){return"self"===e?cr(t):!!e.exec(t.href)}function a(e){var t=function(e){this.$$unwrapTrustedValue=function(){return e}};return e&&(t.prototype=new e),t.prototype.valueOf=function(){return this.$$unwrapTrustedValue()},t.prototype.toString=function(){return this.$$unwrapTrustedValue().toString()},t}n.has("$sanitize")&&(i=n.get("$sanitize"));var o=a(),s={};return s[Ji.HTML]=a(o),s[Ji.CSS]=a(o),s[Ji.URL]=a(o),s[Ji.JS]=a(o),s[Ji.RESOURCE_URL]=a(s[Ji.URL]),{trustAs:function(e,t){var n=s.hasOwnProperty(e)?s[e]:null;if(!n)throw Qi("icontext","Attempted to trust a value in invalid context. Context: {0}; Value: {1}",e,t);if(null===t||N(t)||""===t)return t;if("string"!=typeof t)throw Qi("itype","Attempted to trust a non-string value in a content requiring a string: Context: {0}",e);return new n(t)},getTrusted:function(n,a){if(null===a||N(a)||""===a)return a;var o=s.hasOwnProperty(n)?s[n]:null;if(o&&a instanceof o)return a.$$unwrapTrustedValue();if(n===Ji.RESOURCE_URL){if(function(n){var i,a,o=ur(n.toString()),s=!1;for(i=0,a=e.length;i<a;i++)if(r(e[i],o)){s=!0;break}if(s)for(i=0,a=t.length;i<a;i++)if(r(t[i],o)){s=!1;break}return s}(a))return a;throw Qi("insecurl","Blocked loading resource from url not allowed by $sceDelegate policy.  URL: {0}",a.toString())}if(n===Ji.HTML)return i(a);throw Qi("unsafe","Attempting to use an unsafe value in a safe context.")},valueOf:function(e){return e instanceof o?e.$$unwrapTrustedValue():e}}}]}function tr(){var e=!0;this.enabled=function(t){return arguments.length&&(e=!!t),e},this.$get=["$parse","$sceDelegate",function(t,n){if(e&&s<8)throw Qi("iequirks","Strict Contextual Escaping does not support Internet Explorer version < 11 in quirks mode.  You can fix this by adding the text <!doctype html> to the top of your HTML document.  See http://docs.angularjs.org/api/ng.$sce for more information.");var i=je(Ji);i.isEnabled=function(){return e},i.trustAs=n.trustAs,i.getTrusted=n.getTrusted,i.valueOf=n.valueOf,e||(i.trustAs=i.getTrusted=function(e,t){return t},i.valueOf=A),i.parseAs=function(e,n){var r=t(n);return r.literal&&r.constant?r:t(n,function(t){return i.getTrusted(e,t)})};var r=i.parseAs,o=i.getTrusted,l=i.trustAs;return _(Ji,function(e,t){var n=a(t);i[Ye("parse_as_"+n)]=function(t){return r(e,t)},i[Ye("get_trusted_"+n)]=function(t){return o(e,t)},i[Ye("trust_as_"+n)]=function(t){return l(e,t)}}),i}]}function nr(){this.$get=["$window","$document",function(e,t){var n,i,r={},o=!(e.chrome&&(e.chrome.app&&e.chrome.app.runtime||!e.chrome.app&&e.chrome.runtime&&e.chrome.runtime.id))&&e.history&&e.history.pushState,l=O((/android (\d+)/.exec(a((e.navigator||{}).userAgent))||[])[1]),u=/Boxee/i.test((e.navigator||{}).userAgent),c=t[0]||{},d=/^(Moz|webkit|ms)(?=[A-Z])/,h=c.body&&c.body.style,p=!1,f=!1;if(h){for(var g in h)if(i=d.exec(g)){n=(n=i[0])[0].toUpperCase()+n.substr(1);break}n||(n="WebkitOpacity"in h&&"webkit"),p=!!("transition"in h||n+"Transition"in h),f=!!("animation"in h||n+"Animation"in h),!l||p&&f||(p=j(h.webkitTransition),f=j(h.webkitAnimation))}return{history:!(!o||l<4||u),hasEvent:function(e){if("input"===e&&s<=11)return!1;if(N(r[e])){var t=c.createElement("div");r[e]="on"+e in t}return r[e]},csp:ie(),vendorPrefix:n,transitions:p,animations:f,android:l}}]}var ir=t("$compile");function rr(){var e;this.httpOptions=function(t){return t?(e=t,this):e},this.$get=["$templateCache","$http","$q","$sce",function(t,n,i,r){function a(o,s){a.totalPendingRequests++,j(o)&&!N(t.get(o))||(o=r.getTrustedResourceUrl(o));var l=n.defaults&&n.defaults.transformResponse;return U(l)?l=l.filter(function(e){return e!==On}):l===On&&(l=null),n.get(o,S({cache:t,transformResponse:l},e)).finally(function(){a.totalPendingRequests--}).then(function(e){return t.put(o,e.data),e.data},function(e){if(!s)throw ir("tpload","Failed to load template: {0} (HTTP status: {1} {2})",o,e.status,e.statusText);return i.reject(e)})}return a.totalPendingRequests=0,a}]}function ar(){this.$get=["$rootScope","$browser","$location",function(e,t,n){return{findBindings:function(e,t,n){var i=[];return _(e.getElementsByClassName("ng-binding"),function(e){var r=v.element(e).data("$binding");r&&_(r,function(r){n?new RegExp("(^|\\s)"+Q(t)+"(\\s|\\||$)").test(r)&&i.push(e):-1!==r.indexOf(t)&&i.push(e)})}),i},findModels:function(e,t,n){for(var i=["ng-","data-ng-","ng\\:"],r=0;r<i.length;++r){var a="["+i[r]+"model"+(n?"=":"*=")+'"'+t+'"]',o=e.querySelectorAll(a);if(o.length)return o}},getLocation:function(){return n.url()},setLocation:function(t){t!==n.url()&&(n.url(t),e.$digest())},whenStable:function(e){t.notifyWhenNoOutstandingRequests(e)}}}]}function or(){this.$get=["$rootScope","$browser","$q","$$q","$exceptionHandler",function(e,t,n,i,r){var a={};function o(o,s,l){V(o)||(l=s,s=o,o=x);var u,c=oe(arguments,3),d=M(l)&&!l,h=(d?i:n).defer(),p=h.promise;return u=t.defer(function(){try{h.resolve(o.apply(null,c))}catch(e){h.reject(e),r(e)}finally{delete a[p.$$timeoutId]}d||e.$apply()},s),p.$$timeoutId=u,a[u]=h,p}return o.cancel=function(e){return!!(e&&e.$$timeoutId in a)&&(a[e.$$timeoutId].reject("canceled"),delete a[e.$$timeoutId],t.defer.cancel(e.$$timeoutId))},o}]}var sr=e.document.createElement("a"),lr=ur(e.location.href);function ur(e){var t=e;return s&&(sr.setAttribute("href",t),t=sr.href),sr.setAttribute("href",t),{href:sr.href,protocol:sr.protocol?sr.protocol.replace(/:$/,""):"",host:sr.host,search:sr.search?sr.search.replace(/^\?/,""):"",hash:sr.hash?sr.hash.replace(/^#/,""):"",hostname:sr.hostname,port:sr.port,pathname:"/"===sr.pathname.charAt(0)?sr.pathname:"/"+sr.pathname}}function cr(e){var t=j(e)?ur(e):e;return t.protocol===lr.protocol&&t.host===lr.host}function dr(){this.$get=P(e)}function hr(e){var t=e[0]||{},n={},i="";function r(e){try{return decodeURIComponent(e)}catch(t){return e}}return function(){var e,a,o,s,l,u=t.cookie||"";if(u!==i)for(e=(i=u).split("; "),n={},o=0;o<e.length;o++)(s=(a=e[o]).indexOf("="))>0&&(l=r(a.substring(0,s)),N(n[l])&&(n[l]=r(a.substring(s+1))));return n}}function pr(){this.$get=hr}function fr(e){var t="Filter";function n(i,r){if(K(i)){var a={};return _(i,function(e,t){a[t]=n(t,e)}),a}return e.factory(i+t,r)}this.register=n,this.$get=["$injector",function(e){return function(n){return e.get(n+t)}}],n("currency",Tr),n("date",Pr),n("filter",gr),n("json",Lr),n("limitTo",Kr),n("lowercase",Nr),n("number",Er),n("orderBy",jr),n("uppercase",Mr)}function gr(){return function(e,n,i,r){if(!b(e)){if(null==e)return e;throw t("filter")("notarray","Expected array but received: {0}",e)}var o,s;switch(r=r||"$",vr(n)){case"function":o=n;break;case"boolean":case"null":case"number":case"string":s=!0;case"object":o=function(e,t,n,i){var r=K(e)&&n in e;return!0===t?t=ne:V(t)||(t=function(e,t){return!(N(e)||(null===e||null===t?e!==t:K(t)||K(e)&&!L(e)||(e=a(""+e),t=a(""+t),-1===e.indexOf(t))))}),function(a){return r&&!K(a)?mr(a,e[n],t,n,!1):mr(a,e,t,n,i)}}(n,i,r,s);break;default:return e}return Array.prototype.filter.call(e,o)}}function mr(e,t,n,i,r,a){var o=vr(e),s=vr(t);if("string"===s&&"!"===t.charAt(0))return!mr(e,t.substring(1),n,i,r);if(U(e))return e.some(function(e){return mr(e,t,n,i,r)});switch(o){case"object":var l;if(r){for(l in e)if("$"!==l.charAt(0)&&mr(e[l],t,n,i,!0))return!0;return!a&&mr(e,t,n,i,!1)}if("object"===s){for(l in t){var u=t[l];if(!V(u)&&!N(u)){var c=l===i;if(!mr(c?e:e[l],u,n,i,c,c))return!1}}return!0}return n(e,t);case"function":return!1;default:return n(e,t)}}function vr(e){return null===e?"null":typeof e}hr.$inject=["$document"],fr.$inject=["$provide"];var yr=22,br=".",_r="0";function Tr(e){var t=e.NUMBER_FORMATS;return function(e,n,i){return N(n)&&(n=t.CURRENCY_SYM),N(i)&&(i=t.PATTERNS[1].maxFrac),null==e?e:Cr(e,t.PATTERNS[1],t.GROUP_SEP,t.DECIMAL_SEP,i).replace(/\u00A4/g,n)}}function Er(e){var t=e.NUMBER_FORMATS;return function(e,n){return null==e?e:Cr(e,t.PATTERNS[0],t.GROUP_SEP,t.DECIMAL_SEP,n)}}function Cr(e,t,n,i,r){if(!j(e)&&!B(e)||isNaN(e))return"";var a,o=!isFinite(e),s=!1,l=Math.abs(e)+"",u="";if(o)u="∞";else{!function(e,t,n,i){var r=e.d,a=r.length-e.i,o=(t=N(t)?Math.min(Math.max(n,a),i):+t)+e.i,s=r[o];if(o>0){r.splice(Math.max(e.i,o));for(var l=o;l<r.length;l++)r[l]=0}else{a=Math.max(0,a),e.i=1,r.length=Math.max(1,o=t+1),r[0]=0;for(var u=1;u<o;u++)r[u]=0}if(s>=5)if(o-1<0){for(var c=0;c>o;c--)r.unshift(0),e.i++;r.unshift(1),e.i++}else r[o-1]++;for(;a<Math.max(0,t);a++)r.push(0);var d=r.reduceRight(function(e,t,n,i){return t+=e,i[n]=t%10,Math.floor(t/10)},0);d&&(r.unshift(d),e.i++)}(a=function(e){var t,n,i,r,a,o=0;for((n=e.indexOf(br))>-1&&(e=e.replace(br,"")),(i=e.search(/e/i))>0?(n<0&&(n=i),n+=+e.slice(i+1),e=e.substring(0,i)):n<0&&(n=e.length),i=0;e.charAt(i)===_r;i++);if(i===(a=e.length))t=[0],n=1;else{for(a--;e.charAt(a)===_r;)a--;for(n-=i,t=[],r=0;i<=a;i++,r++)t[r]=+e.charAt(i)}return n>yr&&(t=t.splice(0,yr-1),o=n-1,n=1),{d:t,e:o,i:n}}(l),r,t.minFrac,t.maxFrac);var c=a.d,d=a.i,h=a.e,p=[];for(s=c.reduce(function(e,t){return e&&!t},!0);d<0;)c.unshift(0),d++;d>0?p=c.splice(d,c.length):(p=c,c=[0]);var f=[];for(c.length>=t.lgSize&&f.unshift(c.splice(-t.lgSize,c.length).join(""));c.length>t.gSize;)f.unshift(c.splice(-t.gSize,c.length).join(""));c.length&&f.unshift(c.join("")),u=f.join(n),p.length&&(u+=i+p.join("")),h&&(u+="e+"+h)}return e<0&&!s?t.negPre+u+t.negSuf:t.posPre+u+t.posSuf}function wr(e,t,n,i){var r="";for((e<0||i&&e<=0)&&(i?e=1-e:(e=-e,r="-")),e=""+e;e.length<t;)e=_r+e;return n&&(e=e.substr(e.length-t)),r+e}function kr(e,t,n,i,r){return n=n||0,function(a){var o=a["get"+e]();return(n>0||o>-n)&&(o+=n),0===o&&-12===n&&(o=12),wr(o,t,i,r)}}function Sr(e,t,n){return function(i,r){var a=i["get"+e]();return r[o((n?"STANDALONE":"")+(t?"SHORT":"")+e)][a]}}function Ir(e){var t=new Date(e,0,1).getDay();return new Date(e,0,(t<=4?5:12)-t)}function Or(e){return function(t){var n,i=Ir(t.getFullYear()),r=(n=t,+new Date(n.getFullYear(),n.getMonth(),n.getDate()+(4-n.getDay()))-+i);return wr(1+Math.round(r/6048e5),e)}}function Dr(e,t){return e.getFullYear()<=0?t.ERAS[0]:t.ERAS[1]}Tr.$inject=["$locale"],Er.$inject=["$locale"];var Rr={yyyy:kr("FullYear",4,0,!1,!0),yy:kr("FullYear",2,0,!0,!0),y:kr("FullYear",1,0,!1,!0),MMMM:Sr("Month"),MMM:Sr("Month",!0),MM:kr("Month",2,1),M:kr("Month",1,1),LLLL:Sr("Month",!1,!0),dd:kr("Date",2),d:kr("Date",1),HH:kr("Hours",2),H:kr("Hours",1),hh:kr("Hours",2,-12),h:kr("Hours",1,-12),mm:kr("Minutes",2),m:kr("Minutes",1),ss:kr("Seconds",2),s:kr("Seconds",1),sss:kr("Milliseconds",3),EEEE:Sr("Day"),EEE:Sr("Day",!0),a:function(e,t){return e.getHours()<12?t.AMPMS[0]:t.AMPMS[1]},Z:function(e,t,n){var i=-1*n;return(i>=0?"+":"")+(wr(Math[i>0?"floor":"ceil"](i/60),2)+wr(Math.abs(i%60),2))},ww:Or(2),w:Or(1),G:Dr,GG:Dr,GGG:Dr,GGGG:function(e,t){return e.getFullYear()<=0?t.ERANAMES[0]:t.ERANAMES[1]}},xr=/((?:[^yMLdHhmsaZEwG']+)|(?:'(?:[^']|'')*')|(?:E+|y+|M+|L+|d+|H+|h+|m+|s+|a|Z|G+|w+))(.*)/,Ar=/^\-?\d+$/;function Pr(e){var t=/^(\d{4})-?(\d\d)-?(\d\d)(?:T(\d\d)(?::?(\d\d)(?::?(\d\d)(?:\.(\d+))?)?)?(Z|([+-])(\d\d):?(\d\d))?)?$/;return function(n,i,r){var a,o,s="",l=[];if(i=i||"mediumDate",i=e.DATETIME_FORMATS[i]||i,j(n)&&(n=Ar.test(n)?O(n):function(e){var n;if(n=e.match(t)){var i=new Date(0),r=0,a=0,o=n[8]?i.setUTCFullYear:i.setFullYear,s=n[8]?i.setUTCHours:i.setHours;n[9]&&(r=O(n[9]+n[10]),a=O(n[9]+n[11])),o.call(i,O(n[1]),O(n[2])-1,O(n[3]));var l=O(n[4]||0)-r,u=O(n[5]||0)-a,c=O(n[6]||0),d=Math.round(1e3*parseFloat("0."+(n[7]||0)));return s.call(i,l,u,c,d),i}return e}(n)),B(n)&&(n=new Date(n)),!F(n)||!isFinite(n.getTime()))return n;for(;i;)(o=xr.exec(i))?i=(l=ae(l,o,1)).pop():(l.push(i),i=null);var u=n.getTimezoneOffset();return r&&(u=he(r,u),n=pe(n,r,!0)),_(l,function(t){a=Rr[t],s+=a?a(n,e.DATETIME_FORMATS,u):"''"===t?"'":t.replace(/(^'|'$)/g,"").replace(/''/g,"'")}),s}}function Lr(){return function(e,t){return N(t)&&(t=2),ue(e,t)}}Pr.$inject=["$locale"];var Nr=P(a),Mr=P(o);function Kr(){return function(e,t,n){return t=Math.abs(Number(t))===1/0?Number(t):O(t),D(t)?e:(B(e)&&(e=e.toString()),b(e)?(n=(n=!n||isNaN(n)?0:O(n))<0?Math.max(0,e.length+n):n,t>=0?$r(e,n,n+t):0===n?$r(e,t,e.length):$r(e,Math.max(0,n+t),n)):e)}}function $r(e,t,n){return j(e)?e.slice(t,n):d.call(e,t,n)}function jr(e){return function(r,a,o,s){if(null==r)return r;if(!b(r))throw t("orderBy")("notarray","Expected array but received: {0}",r);U(a)||(a=[a]),0===a.length&&(a=["+"]);var l=a.map(function(t){var n=1,i=A;if(V(t))i=t;else if(j(t)&&("+"!==t.charAt(0)&&"-"!==t.charAt(0)||(n="-"===t.charAt(0)?-1:1,t=t.substring(1)),""!==t&&(i=e(t)).constant)){var r=i();i=function(e){return e[r]}}return{get:i,descending:n}}),u=o?-1:1,c=V(s)?s:i,d=Array.prototype.map.call(r,function(e,t){return{value:e,tieBreaker:{value:t,type:"number",index:t},predicateValues:l.map(function(i){return function(e,t){var i=typeof e;return null===e?(i="string",e="null"):"object"===i&&(e=function(e){return V(e.valueOf)&&n(e=e.valueOf())?e:(L(e)&&n(e=e.toString()),e)}(e)),{value:e,type:i,index:t}}(i.get(e),t)})}});return d.sort(function(e,t){for(var n=0,i=l.length;n<i;n++){var r=c(e.predicateValues[n],t.predicateValues[n]);if(r)return r*l[n].descending*u}return c(e.tieBreaker,t.tieBreaker)*u}),d.map(function(e){return e.value})};function n(e){switch(typeof e){case"number":case"boolean":case"string":return!0;default:return!1}}function i(e,t){var n=0,i=e.type,r=t.type;if(i===r){var a=e.value,o=t.value;"string"===i?(a=a.toLowerCase(),o=o.toLowerCase()):"object"===i&&(K(a)&&(a=e.index),K(o)&&(o=t.index)),a!==o&&(n=a<o?-1:1)}else n=i<r?-1:1;return n}}function Br(e){return V(e)&&(e={link:e}),e.restrict=e.restrict||"AC",P(e)}jr.$inject=["$parse"];var Fr=P({restrict:"E",compile:function(e,t){if(!t.href&&!t.xlinkHref)return function(e,t){if("a"===t[0].nodeName.toLowerCase()){var n="[object SVGAnimatedString]"===f.call(t.prop("href"))?"xlink:href":"href";t.on("click",function(e){t.attr(n)||e.preventDefault()})}}}}),Ur={};_(Ct,function(e,t){if("multiple"!==e){var n=ln("ng-"+t),i=r;"checked"===e&&(i=function(e,t,i){i.ngModel!==i[n]&&r(e,0,i)}),Ur[n]=function(){return{restrict:"A",priority:100,link:i}}}function r(e,i,r){e.$watch(r[n],function(e){r.$set(t,!!e)})}}),_(kt,function(e,t){Ur[t]=function(){return{priority:100,link:function(e,i,r){if("ngPattern"===t&&"/"===r.ngPattern.charAt(0)){var a=r.ngPattern.match(n);if(a)return void r.$set("ngPattern",new RegExp(a[1],a[2]))}e.$watch(r[t],function(e){r.$set(t,e)})}}}}),_(["src","srcset","href"],function(e){var t=ln("ng-"+e);Ur[t]=function(){return{priority:99,link:function(n,i,r){var a=e,o=e;"href"===e&&"[object SVGAnimatedString]"===f.call(i.prop("href"))&&(o="xlinkHref",r.$attr[o]="xlink:href",a=null),r.$observe(t,function(t){t?(r.$set(o,t),s&&a&&i.prop(a,r[o])):"href"===e&&r.$set(o,null)})}}}});var Vr={$addControl:x,$$renameControl:function(e,t){e.$name=t},$removeControl:x,$setValidity:x,$setDirty:x,$setPristine:x,$setSubmitted:x},qr="ng-submitted";function Hr(e,t,n,i,r){var a=this,o=[];a.$error={},a.$$success={},a.$pending=void 0,a.$name=r(t.name||t.ngForm||"")(n),a.$dirty=!1,a.$pristine=!0,a.$valid=!0,a.$invalid=!1,a.$submitted=!1,a.$$parentForm=Vr,a.$rollbackViewValue=function(){_(o,function(e){e.$rollbackViewValue()})},a.$commitViewValue=function(){_(o,function(e){e.$commitViewValue()})},a.$addControl=function(e){Re(e.$name,"input"),o.push(e),e.$name&&(a[e.$name]=e),e.$$parentForm=a},a.$$renameControl=function(e,t){var n=e.$name;a[n]===e&&delete a[n],a[t]=e,e.$name=t},a.$removeControl=function(e){e.$name&&a[e.$name]===e&&delete a[e.$name],_(a.$pending,function(t,n){a.$setValidity(n,null,e)}),_(a.$error,function(t,n){a.$setValidity(n,null,e)}),_(a.$$success,function(t,n){a.$setValidity(n,null,e)}),ee(o,e),e.$$parentForm=Vr},Wa({ctrl:this,$element:e,set:function(e,t,n){var i=e[t];i?-1===i.indexOf(n)&&i.push(n):e[t]=[n]},unset:function(e,t,n){var i=e[t];i&&(ee(i,n),0===i.length&&delete e[t])},$animate:i}),a.$setDirty=function(){i.removeClass(e,ja),i.addClass(e,Ba),a.$dirty=!0,a.$pristine=!1,a.$$parentForm.$setDirty()},a.$setPristine=function(){i.setClass(e,ja,Ba+" "+qr),a.$dirty=!1,a.$pristine=!0,a.$submitted=!1,_(o,function(e){e.$setPristine()})},a.$setUntouched=function(){_(o,function(e){e.$setUntouched()})},a.$setSubmitted=function(){i.addClass(e,qr),a.$submitted=!0,a.$$parentForm.$setSubmitted()}}Hr.$inject=["$element","$attrs","$scope","$animate","$interpolate"];var zr=function(e){return["$timeout","$parse",function(t,n){return{name:"form",restrict:e?"EAC":"E",require:["form","^^?form"],controller:Hr,compile:function(n,r){n.addClass(ja).addClass(Ka);var a=r.name?"name":!(!e||!r.ngForm)&&"ngForm";return{pre:function(e,n,r,o){var s=o[0];if(!("action"in r)){var l=function(t){e.$apply(function(){s.$commitViewValue(),s.$setSubmitted()}),t.preventDefault()};qe(n[0],"submit",l),n.on("$destroy",function(){t(function(){He(n[0],"submit",l)},0,!1)})}(o[1]||s.$$parentForm).$addControl(s);var u=a?i(s.$name):x;a&&(u(e,s),r.$observe(a,function(t){s.$name!==t&&(u(e,void 0),s.$$parentForm.$$renameControl(s,t),(u=i(s.$name))(e,s))})),n.on("$destroy",function(){s.$$parentForm.$removeControl(s),u(e,void 0),S(s,Vr)})}}}};function i(e){return""===e?n('this[""]').assign:n(e).assign||x}}]},Wr=zr(),Gr=zr(!0),Xr=/^\d{4,}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+(?:[+-][0-2]\d:[0-5]\d|Z)$/,Yr=/^[a-z][a-z\d.+-]*:\/*(?:[^:@]+(?::[^@]+)?@)?(?:[^\s:/?#]+|\[[a-f\d:]+\])(?::\d+)?(?:\/[^?#]*)?(?:\?[^#]*)?(?:#.*)?$/i,Qr=/^(?=.{1,254}$)(?=.{1,64}@)[-!#$%&'*+\/0-9=?A-Z^_`a-z{|}~]+(\.[-!#$%&'*+\/0-9=?A-Z^_`a-z{|}~]+)*@[A-Za-z0-9]([A-Za-z0-9-]{0,61}[A-Za-z0-9])?(\.[A-Za-z0-9]([A-Za-z0-9-]{0,61}[A-Za-z0-9])?)*$/,Jr=/^\s*(\-|\+)?(\d+|(\d*(\.\d*)))([eE][+-]?\d+)?\s*$/,Zr=/^(\d{4,})-(\d{2})-(\d{2})$/,ea=/^(\d{4,})-(\d\d)-(\d\d)T(\d\d):(\d\d)(?::(\d\d)(\.\d{1,3})?)?$/,ta=/^(\d{4,})-W(\d\d)$/,na=/^(\d{4,})-(\d\d)$/,ia=/^(\d\d):(\d\d)(?::(\d\d)(\.\d{1,3})?)?$/,ra="keydown wheel mousedown",aa=Pe();_("date,datetime-local,month,time,week".split(","),function(e){aa[e]=!0});var oa={text:function(e,t,n,i,r,a){la(e,t,n,i,r,a),sa(i)},date:ca("date",Zr,ua(Zr,["yyyy","MM","dd"]),"yyyy-MM-dd"),"datetime-local":ca("datetimelocal",ea,ua(ea,["yyyy","MM","dd","HH","mm","ss","sss"]),"yyyy-MM-ddTHH:mm:ss.sss"),time:ca("time",ia,ua(ia,["HH","mm","ss","sss"]),"HH:mm:ss.sss"),week:ca("week",ta,function(e,t){if(F(e))return e;if(j(e)){ta.lastIndex=0;var n=ta.exec(e);if(n){var i=+n[1],r=+n[2],a=0,o=0,s=0,l=0,u=Ir(i),c=7*(r-1);return t&&(a=t.getHours(),o=t.getMinutes(),s=t.getSeconds(),l=t.getMilliseconds()),new Date(i,0,u.getDate()+c,a,o,s,l)}}return NaN},"yyyy-Www"),month:ca("month",na,ua(na,["yyyy","MM"]),"yyyy-MM"),number:function(e,t,n,i,r,a){var o,s;da(e,t,n,i),la(e,t,n,i,r,a),ha(i),(M(n.min)||n.ngMin)&&(i.$validators.min=function(e){return i.$isEmpty(e)||N(o)||e>=o},n.$observe("min",function(e){o=pa(e),i.$validate()})),(M(n.max)||n.ngMax)&&(i.$validators.max=function(e){return i.$isEmpty(e)||N(s)||e<=s},n.$observe("max",function(e){s=pa(e),i.$validate()}))},url:function(e,t,n,i,r,a){la(e,t,n,i,r,a),sa(i),i.$$parserName="url",i.$validators.url=function(e,t){var n=e||t;return i.$isEmpty(n)||Yr.test(n)}},email:function(e,t,n,i,r,a){la(e,t,n,i,r,a),sa(i),i.$$parserName="email",i.$validators.email=function(e,t){var n=e||t;return i.$isEmpty(n)||Qr.test(n)}},radio:function(e,t,n,i){N(n.name)&&t.attr("name",C()),t.on("click",function(e){t[0].checked&&i.$setViewValue(n.value,e&&e.type)}),i.$render=function(){var e=n.value;t[0].checked=e===i.$viewValue},n.$observe("value",i.$render)},range:function(e,t,n,i,r,a){da(e,t,n,i),ha(i),la(e,t,n,i,r,a);var o=i.$$hasNativeValidators&&"range"===t[0].type,s=o?0:void 0,l=o?100:void 0,u=o?1:void 0,c=t[0].validity,d=M(n.min),h=M(n.max),p=M(n.step),f=i.$render;function g(e,i){t.attr(e,n[e]),n.$observe(e,i)}i.$render=o&&M(c.rangeUnderflow)&&M(c.rangeOverflow)?function(){f(),i.$setViewValue(t.val())}:f,d&&(i.$validators.min=o?function(){return!0}:function(e,t){return i.$isEmpty(t)||N(s)||t>=s},g("min",function(e){if(s=pa(e),!D(i.$modelValue))if(o){var n=t.val();s>n&&(n=s,t.val(n)),i.$setViewValue(n)}else i.$validate()})),h&&(i.$validators.max=o?function(){return!0}:function(e,t){return i.$isEmpty(t)||N(l)||t<=l},g("max",function(e){if(l=pa(e),!D(i.$modelValue))if(o){var n=t.val();l<n&&(t.val(l),n=l<s?s:l),i.$setViewValue(n)}else i.$validate()})),p&&(i.$validators.step=o?function(){return!c.stepMismatch}:function(e,t){return i.$isEmpty(t)||N(u)||function(e,t,n){var i=Number(e);if(!fa(i)||!fa(t)||!fa(n)){var r=Math.max(ga(i),ga(t),ga(n)),a=Math.pow(10,r);i*=a,t*=a,n*=a}return(i-t)%n==0}(t,s||0,u)},g("step",function(e){u=pa(e),D(i.$modelValue)||(o&&i.$viewValue!==t.val()?i.$setViewValue(t.val()):i.$validate())}))},checkbox:function(e,t,n,i,r,a,o,s){var l=ma(s,e,"ngTrueValue",n.ngTrueValue,!0),u=ma(s,e,"ngFalseValue",n.ngFalseValue,!1);t.on("click",function(e){i.$setViewValue(t[0].checked,e&&e.type)}),i.$render=function(){t[0].checked=i.$viewValue},i.$isEmpty=function(e){return!1===e},i.$formatters.push(function(e){return ne(e,l)}),i.$parsers.push(function(e){return e?l:u})},hidden:x,button:x,submit:x,reset:x,file:x};function sa(e){e.$formatters.push(function(t){return e.$isEmpty(t)?t:t.toString()})}function la(e,t,n,r,o,s){var l,u=a(t[0].type);if(!o.android){var c=!1;t.on("compositionstart",function(){c=!0}),t.on("compositionend",function(){c=!1,d()})}var d=function(e){if(l&&(s.defer.cancel(l),l=null),!c){var i=t.val(),a=e&&e.type;"password"===u||n.ngTrim&&"false"===n.ngTrim||(i=Y(i)),(r.$viewValue!==i||""===i&&r.$$hasNativeValidators)&&r.$setViewValue(i,a)}};if(o.hasEvent("input"))t.on("input",d);else{var h=function(e,t,n){l||(l=s.defer(function(){l=null,t&&t.value===n||d(e)}))};t.on("keydown",function(e){var t=e.keyCode;91===t||15<t&&t<19||37<=t&&t<=40||h(e,this,this.value)}),o.hasEvent("paste")&&t.on("paste cut",h)}t.on("change",d),aa[u]&&r.$$hasNativeValidators&&u===n.type&&t.on(ra,function(e){if(!l){var t=this[i],n=t.badInput,r=t.typeMismatch;l=s.defer(function(){l=null,t.badInput===n&&t.typeMismatch===r||d(e)})}}),r.$render=function(){var e=r.$isEmpty(r.$viewValue)?"":r.$viewValue;t.val()!==e&&t.val(e)}}function ua(e,t){return function(n,i){var r,a;if(F(n))return n;if(j(n)){if('"'===n.charAt(0)&&'"'===n.charAt(n.length-1)&&(n=n.substring(1,n.length-1)),Xr.test(n))return new Date(n);if(e.lastIndex=0,r=e.exec(n))return r.shift(),a=i?{yyyy:i.getFullYear(),MM:i.getMonth()+1,dd:i.getDate(),HH:i.getHours(),mm:i.getMinutes(),ss:i.getSeconds(),sss:i.getMilliseconds()/1e3}:{yyyy:1970,MM:1,dd:1,HH:0,mm:0,ss:0,sss:0},_(r,function(e,n){n<t.length&&(a[t[n]]=+e)}),new Date(a.yyyy,a.MM-1,a.dd,a.HH,a.mm,a.ss||0,1e3*a.sss||0)}return NaN}}function ca(e,t,n,i){return function(r,a,o,s,l,u,c){da(r,a,o,s),la(0,a,o,s,l,u);var d,h,p,f=s&&s.$options&&s.$options.timezone;function g(e){return e&&!(e.getTime&&e.getTime()!=e.getTime())}function m(e){return M(e)&&!F(e)?n(e)||void 0:e}s.$$parserName=e,s.$parsers.push(function(e){if(s.$isEmpty(e))return null;if(t.test(e)){var i=n(e,d);return f&&(i=pe(i,f)),i}}),s.$formatters.push(function(e){if(e&&!F(e))throw Ua("datefmt","Expected `{0}` to be a date",e);return g(e)?((d=e)&&f&&(d=pe(d,f,!0)),c("date")(e,i,f)):(d=null,"")}),(M(o.min)||o.ngMin)&&(s.$validators.min=function(e){return!g(e)||N(h)||n(e)>=h},o.$observe("min",function(e){h=m(e),s.$validate()})),(M(o.max)||o.ngMax)&&(s.$validators.max=function(e){return!g(e)||N(p)||n(e)<=p},o.$observe("max",function(e){p=m(e),s.$validate()}))}}function da(e,t,n,r){var a=t[0];(r.$$hasNativeValidators=K(a.validity))&&r.$parsers.push(function(e){var n=t.prop(i)||{};return n.badInput||n.typeMismatch?void 0:e})}function ha(e){e.$$parserName="number",e.$parsers.push(function(t){return e.$isEmpty(t)?null:Jr.test(t)?parseFloat(t):void 0}),e.$formatters.push(function(t){if(!e.$isEmpty(t)){if(!B(t))throw Ua("numfmt","Expected `{0}` to be a number",t);t=t.toString()}return t})}function pa(e){return M(e)&&!B(e)&&(e=parseFloat(e)),D(e)?void 0:e}function fa(e){return(0|e)===e}function ga(e){var t=e.toString(),n=t.indexOf(".");if(-1===n){if(-1<e&&e<1){var i=/e-(\d+)$/.exec(t);if(i)return Number(i[1])}return 0}return t.length-n-1}function ma(e,t,n,i,r){var a;if(M(i)){if(!(a=e(i)).constant)throw Ua("constexpr","Expected constant expression for `{0}`, but saw `{1}`.",n,i);return a(t)}return r}var va=["$browser","$sniffer","$filter","$parse",function(e,t,n,i){return{restrict:"E",require:["?ngModel"],link:{pre:function(r,o,s,l){if(l[0]){var u=a(s.type);"range"!==u||s.hasOwnProperty("ngInputRange")||(u="text"),(oa[u]||oa.text)(r,o,s,l[0],t,e,n,i)}}}}}],ya=/^(true|false|\d+)$/,ba=function(){return{restrict:"A",priority:100,compile:function(e,t){return ya.test(t.ngValue)?function(e,t,n){n.$set("value",e.$eval(n.ngValue))}:function(e,t,n){e.$watch(n.ngValue,function(e){n.$set("value",e)})}}}},_a=["$compile",function(e){return{restrict:"AC",compile:function(t){return e.$$addBindingClass(t),function(t,n,i){e.$$addBindingInfo(n,i.ngBind),n=n[0],t.$watch(i.ngBind,function(e){n.textContent=N(e)?"":e})}}}}],Ta=["$interpolate","$compile",function(e,t){return{compile:function(n){return t.$$addBindingClass(n),function(n,i,r){var a=e(i.attr(r.$attr.ngBindTemplate));t.$$addBindingInfo(i,a.expressions),i=i[0],r.$observe("ngBindTemplate",function(e){i.textContent=N(e)?"":e})}}}}],Ea=["$sce","$parse","$compile",function(e,t,n){return{restrict:"A",compile:function(i,r){var a=t(r.ngBindHtml),o=t(r.ngBindHtml,function(t){return e.valueOf(t)});return n.$$addBindingClass(i),function(t,i,r){n.$$addBindingInfo(i,r.ngBindHtml),t.$watch(o,function(){var n=a(t);i.html(e.getTrustedHtml(n)||"")})}}}}],Ca=P({restrict:"A",require:"ngModel",link:function(e,t,n,i){i.$viewChangeListeners.push(function(){e.$eval(n.ngChange)})}});function wa(e,t){return e="ngClass"+e,["$animate",function(n){return{restrict:"AC",link:function(a,o,s){var l;function u(e){var t=c(e,1);s.$addClass(t)}function c(e,t){var n=o.data("$classCounts")||Pe(),i=[];return _(e,function(e){(t>0||n[e])&&(n[e]=(n[e]||0)+t,n[e]===+(t>0)&&i.push(e))}),o.data("$classCounts",n),i.join(" ")}function d(e){if(!0===t||(1&a.$index)===t){var s=r(e||[]);l?ne(e,l)||function(e,t){var r=i(t,e),a=i(e,t);r=c(r,1),a=c(a,-1),r&&r.length&&n.addClass(o,r),a&&a.length&&n.removeClass(o,a)}(r(l),s):u(s)}l=U(e)?e.map(function(e){return je(e)}):je(e)}a.$watch(s[e],d,!0),s.$observe("class",function(t){d(a.$eval(s[e]))}),"ngClass"!==e&&a.$watch("$index",function(n,i){var o=1&n;if(o!==(1&i)){var l=r(a.$eval(s[e]));o===t?u(l):function(e){var t=c(l,-1);s.$removeClass(t)}()}})}};function i(e,t){var n=[];e:for(var i=0;i<e.length;i++){for(var r=e[i],a=0;a<t.length;a++)if(r===t[a])continue e;n.push(r)}return n}function r(e){var t=[];return U(e)?(_(e,function(e){t=t.concat(r(e))}),t):j(e)?e.split(" "):K(e)?(_(e,function(e,n){e&&(t=t.concat(n.split(" ")))}),t):e}}]}var ka=wa("",!0),Sa=wa("Odd",0),Ia=wa("Even",1),Oa=Br({compile:function(e,t){t.$set("ngCloak",void 0),e.removeClass("ng-cloak")}}),Da=[function(){return{restrict:"A",scope:!0,controller:"@",priority:500}}],Ra={},xa={blur:!0,focus:!0};_("click dblclick mousedown mouseup mouseover mouseout mousemove mouseenter mouseleave keydown keyup keypress submit focus blur copy cut paste".split(" "),function(e){var t=ln("ng-"+e);Ra[t]=["$parse","$rootScope",function(n,i){return{restrict:"A",compile:function(r,a){var o=n(a[t],null,!0);return function(t,n){n.on(e,function(n){var r=function(){o(t,{$event:n})};xa[e]&&i.$$phase?t.$evalAsync(r):t.$apply(r)})}}}}]});var Aa=["$animate","$compile",function(e,t){return{multiElement:!0,transclude:"element",priority:600,terminal:!0,restrict:"A",$$tlb:!0,link:function(n,i,r,a,o){var s,l,u;n.$watch(r.ngIf,function(n){n?l||o(function(n,a){l=a,n[n.length++]=t.$$createComment("end ngIf",r.ngIf),s={clone:n},e.enter(n,i.parent(),i)}):(u&&(u.remove(),u=null),l&&(l.$destroy(),l=null),s&&(u=Ae(s.clone),e.leave(u).then(function(){u=null}),s=null))})}}}],Pa=["$templateRequest","$anchorScroll","$animate",function(e,t,n){return{restrict:"ECA",priority:400,terminal:!0,transclude:"element",controller:v.noop,compile:function(i,r){var a=r.ngInclude||r.src,o=r.onload||"",s=r.autoscroll;return function(i,r,l,u,c){var d,h,p,f=0,g=function(){h&&(h.remove(),h=null),d&&(d.$destroy(),d=null),p&&(n.leave(p).then(function(){h=null}),h=p,p=null)};i.$watch(a,function(a){var l=function(){!M(s)||s&&!i.$eval(s)||t()},h=++f;a?(e(a,!0).then(function(e){if(!i.$$destroyed&&h===f){var t=i.$new();u.template=e;var s=c(t,function(e){g(),n.enter(e,null,r).then(l)});p=s,(d=t).$emit("$includeContentLoaded",a),i.$eval(o)}},function(){i.$$destroyed||h===f&&(g(),i.$emit("$includeContentError",a))}),i.$emit("$includeContentRequested",a)):(g(),u.template=null)})}}}}],La=["$compile",function(t){return{restrict:"ECA",priority:-400,require:"ngInclude",link:function(n,i,r,a){if(f.call(i[0]).match(/SVG/))return i.empty(),void t(rt(a.template,e.document).childNodes)(n,function(e){i.append(e)},{futureParentElement:i});i.html(a.template),t(i.contents())(n)}}}],Na=Br({priority:450,compile:function(){return{pre:function(e,t,n){e.$eval(n.ngInit)}}}}),Ma=function(){return{restrict:"A",priority:100,require:"ngModel",link:function(e,t,n,i){var r=t.attr(n.$attr.ngList)||", ",a="false"!==n.ngTrim,o=a?Y(r):r;i.$parsers.push(function(e){if(!N(e)){var t=[];return e&&_(e.split(o),function(e){e&&t.push(a?Y(e):e)}),t}}),i.$formatters.push(function(e){if(U(e))return e.join(r)}),i.$isEmpty=function(e){return!e||!e.length}}}},Ka="ng-valid",$a="ng-invalid",ja="ng-pristine",Ba="ng-dirty",Fa="ng-pending",Ua=t("ngModel"),Va=["$scope","$exceptionHandler","$attrs","$element","$parse","$animate","$timeout","$rootScope","$q","$interpolate",function(e,t,n,i,r,a,o,s,l,u){this.$viewValue=Number.NaN,this.$modelValue=Number.NaN,this.$$rawModelValue=void 0,this.$validators={},this.$asyncValidators={},this.$parsers=[],this.$formatters=[],this.$viewChangeListeners=[],this.$untouched=!0,this.$touched=!1,this.$pristine=!0,this.$dirty=!1,this.$valid=!0,this.$invalid=!1,this.$error={},this.$$success={},this.$pending=void 0,this.$name=u(n.name||"",!1)(e),this.$$parentForm=Vr;var c,d=r(n.ngModel),h=d.assign,p=d,f=h,g=null,m=this;this.$$setOptions=function(e){if(m.$options=e,e&&e.getterSetter){var t=r(n.ngModel+"()"),a=r(n.ngModel+"($$$p)");p=function(e){var n=d(e);return V(n)&&(n=t(e)),n},f=function(e,t){V(d(e))?a(e,{$$$p:t}):h(e,t)}}else if(!d.assign)throw Ua("nonassign","Expression '{0}' is non-assignable. Element: {1}",n.ngModel,fe(i))},this.$render=x,this.$isEmpty=function(e){return N(e)||""===e||null===e||e!=e},this.$$updateEmptyClasses=function(e){m.$isEmpty(e)?(a.removeClass(i,"ng-not-empty"),a.addClass(i,"ng-empty")):(a.removeClass(i,"ng-empty"),a.addClass(i,"ng-not-empty"))};var v=0;Wa({ctrl:this,$element:i,set:function(e,t){e[t]=!0},unset:function(e,t){delete e[t]},$animate:a}),this.$setPristine=function(){m.$dirty=!1,m.$pristine=!0,a.removeClass(i,Ba),a.addClass(i,ja)},this.$setDirty=function(){m.$dirty=!0,m.$pristine=!1,a.removeClass(i,ja),a.addClass(i,Ba),m.$$parentForm.$setDirty()},this.$setUntouched=function(){m.$touched=!1,m.$untouched=!0,a.setClass(i,"ng-untouched","ng-touched")},this.$setTouched=function(){m.$touched=!0,m.$untouched=!1,a.setClass(i,"ng-touched","ng-untouched")},this.$rollbackViewValue=function(){o.cancel(g),m.$viewValue=m.$$lastCommittedViewValue,m.$render()},this.$validate=function(){if(!D(m.$modelValue)){var e=m.$$lastCommittedViewValue,t=m.$$rawModelValue,n=m.$valid,i=m.$modelValue,r=m.$options&&m.$options.allowInvalid;m.$$runValidators(t,e,function(e){r||n===e||(m.$modelValue=e?t:void 0,m.$modelValue!==i&&m.$$writeModelToScope())})}},this.$$runValidators=function(e,t,n){var i,r,a=++v;function o(e,t){a===v&&m.$setValidity(e,t)}function s(e){a===v&&n(e)}!function(){var e=m.$$parserName||"parse";return N(c)?(o(e,null),!0):(c||(_(m.$validators,function(e,t){o(t,null)}),_(m.$asyncValidators,function(e,t){o(t,null)})),o(e,c),c)}()?s(!1):function(){var n=!0;return _(m.$validators,function(i,r){var a=i(e,t);n=n&&a,o(r,a)}),!!n||(_(m.$asyncValidators,function(e,t){o(t,null)}),!1)}()?(i=[],r=!0,_(m.$asyncValidators,function(n,a){var s=n(e,t);if(!G(s))throw Ua("nopromise","Expected asynchronous validator to return a promise but got '{0}' instead.",s);o(a,void 0),i.push(s.then(function(){o(a,!0)},function(){r=!1,o(a,!1)}))}),i.length?l.all(i).then(function(){s(r)},x):s(!0)):s(!1)},this.$commitViewValue=function(){var e=m.$viewValue;o.cancel(g),(m.$$lastCommittedViewValue!==e||""===e&&m.$$hasNativeValidators)&&(m.$$updateEmptyClasses(e),m.$$lastCommittedViewValue=e,m.$pristine&&this.$setDirty(),this.$$parseAndValidate())},this.$$parseAndValidate=function(){var t=m.$$lastCommittedViewValue;if(c=!N(t)||void 0)for(var n=0;n<m.$parsers.length;n++)if(N(t=m.$parsers[n](t))){c=!1;break}D(m.$modelValue)&&(m.$modelValue=p(e));var i=m.$modelValue,r=m.$options&&m.$options.allowInvalid;function a(){m.$modelValue!==i&&m.$$writeModelToScope()}m.$$rawModelValue=t,r&&(m.$modelValue=t,a()),m.$$runValidators(t,m.$$lastCommittedViewValue,function(e){r||(m.$modelValue=e?t:void 0,a())})},this.$$writeModelToScope=function(){f(e,m.$modelValue),_(m.$viewChangeListeners,function(e){try{e()}catch(e){t(e)}})},this.$setViewValue=function(e,t){m.$viewValue=e,m.$options&&!m.$options.updateOnDefault||m.$$debounceViewValueCommit(t)},this.$$debounceViewValueCommit=function(t){var n,i=0,r=m.$options;r&&M(r.debounce)&&(B(n=r.debounce)?i=n:B(n[t])?i=n[t]:B(n.default)&&(i=n.default)),o.cancel(g),i?g=o(function(){m.$commitViewValue()},i):s.$$phase?m.$commitViewValue():e.$apply(function(){m.$commitViewValue()})},e.$watch(function(){var t=p(e);if(t!==m.$modelValue&&(m.$modelValue==m.$modelValue||t==t)){m.$modelValue=m.$$rawModelValue=t,c=void 0;for(var n=m.$formatters,i=n.length,r=t;i--;)r=n[i](r);m.$viewValue!==r&&(m.$$updateEmptyClasses(r),m.$viewValue=m.$$lastCommittedViewValue=r,m.$render(),m.$$runValidators(m.$modelValue,m.$viewValue,x))}return t})}],qa=["$rootScope",function(e){return{restrict:"A",require:["ngModel","^?form","^?ngModelOptions"],controller:Va,priority:1,compile:function(t){return t.addClass(ja).addClass("ng-untouched").addClass(Ka),{pre:function(e,t,n,i){var r=i[0],a=i[1]||r.$$parentForm;r.$$setOptions(i[2]&&i[2].$options),a.$addControl(r),n.$observe("name",function(e){r.$name!==e&&r.$$parentForm.$$renameControl(r,e)}),e.$on("$destroy",function(){r.$$parentForm.$removeControl(r)})},post:function(t,n,i,r){var a=r[0];a.$options&&a.$options.updateOn&&n.on(a.$options.updateOn,function(e){a.$$debounceViewValueCommit(e&&e.type)}),n.on("blur",function(){a.$touched||(e.$$phase?t.$evalAsync(a.$setTouched):t.$apply(a.$setTouched))})}}}}}],Ha=/(\s+|^)default(\s+|$)/,za=function(){return{restrict:"A",controller:["$scope","$attrs",function(e,t){var n=this;this.$options=te(e.$eval(t.ngModelOptions)),M(this.$options.updateOn)?(this.$options.updateOnDefault=!1,this.$options.updateOn=Y(this.$options.updateOn.replace(Ha,function(){return n.$options.updateOnDefault=!0," "}))):this.$options.updateOnDefault=!0}]}};function Wa(e){var t=e.ctrl,n=e.$element,i={},r=e.set,a=e.unset,o=e.$animate;function s(e,t){t&&!i[e]?(o.addClass(n,e),i[e]=!0):!t&&i[e]&&(o.removeClass(n,e),i[e]=!1)}function l(e,t){e=e?"-"+Se(e,"-"):"",s(Ka+e,!0===t),s($a+e,!1===t)}i[$a]=!(i[Ka]=n.hasClass(Ka)),t.$setValidity=function(e,n,i){var o;N(n)?function(e,n,i){t[e]||(t[e]={}),r(t[e],n,i)}("$pending",e,i):function(e,n,i){t[e]&&a(t[e],n,i),Ga(t[e])&&(t[e]=void 0)}("$pending",e,i),W(n)?n?(a(t.$error,e,i),r(t.$$success,e,i)):(r(t.$error,e,i),a(t.$$success,e,i)):(a(t.$error,e,i),a(t.$$success,e,i)),t.$pending?(s(Fa,!0),t.$valid=t.$invalid=void 0,l("",null)):(s(Fa,!1),t.$valid=Ga(t.$error),t.$invalid=!t.$valid,l("",t.$valid)),l(e,o=t.$pending&&t.$pending[e]?void 0:!t.$error[e]&&(!!t.$$success[e]||null)),t.$$parentForm.$setValidity(e,o,t)}}function Ga(e){if(e)for(var t in e)if(e.hasOwnProperty(t))return!1;return!0}var Xa=Br({terminal:!0,priority:1e3}),Ya=t("ngOptions"),Qa=/^\s*([\s\S]+?)(?:\s+as\s+([\s\S]+?))?(?:\s+group\s+by\s+([\s\S]+?))?(?:\s+disable\s+when\s+([\s\S]+?))?\s+for\s+(?:([\$\w][\$\w]*)|(?:\(\s*([\$\w][\$\w]*)\s*,\s*([\$\w][\$\w]*)\s*\)))\s+in\s+([\s\S]+?)(?:\s+track\s+by\s+([\s\S]+?))?$/,Ja=["$compile","$document","$parse",function(t,n,i){var r=e.document.createElement("option"),a=e.document.createElement("optgroup");return{restrict:"A",terminal:!0,require:["select","ngModel"],link:{pre:function(e,t,n,i){i[0].registerOption=x},post:function(e,o,s,u){for(var c,d=u[0],h=u[1],p=s.multiple,f=0,g=o.children(),m=g.length;f<m;f++)if(""===g[f].value){c=g.eq(f);break}var y,T=!!c,E=l(r.cloneNode(!1));E.val("?");var C=function(e,t,n){var r=e.match(Qa);if(!r)throw Ya("iexp","Expected expression in form of '_select_ (as _label_)? for (_key_,)?_value_ in _collection_' but got '{0}'. Element: {1}",e,fe(t));var a=r[5]||r[7],o=r[6],s=/ as /.test(r[0])&&r[1],l=r[9],u=i(r[2]?r[1]:a),c=s&&i(s)||u,d=l&&i(l),h=l?function(e,t){return d(n,t)}:function(e){return Rt(e)},p=function(e,t){return h(e,T(e,t))},f=i(r[2]||r[1]),g=i(r[3]||""),m=i(r[4]||""),y=i(r[8]),_={},T=o?function(e,t){return _[o]=t,_[a]=e,_}:function(e){return _[a]=e,_};function E(e,t,n,i,r){this.selectValue=e,this.viewValue=t,this.label=n,this.group=i,this.disabled=r}function C(e){var t;if(!o&&b(e))t=e;else for(var n in t=[],e)e.hasOwnProperty(n)&&"$"!==n.charAt(0)&&t.push(n);return t}return{trackBy:l,getTrackByValue:p,getWatchables:i(y,function(e){for(var t=[],i=C(e=e||[]),a=i.length,o=0;o<a;o++){var s=e===i?o:i[o],l=e[s],u=T(l,s),c=h(l,u);if(t.push(c),r[2]||r[1]){var d=f(n,u);t.push(d)}if(r[4]){var p=m(n,u);t.push(p)}}return t}),getOptions:function(){for(var e=[],t={},i=y(n)||[],r=C(i),a=r.length,o=0;o<a;o++){var s=i===r?o:r[o],u=i[s],d=T(u,s),b=c(n,d),_=h(b,d),w=new E(_,b,f(n,d),g(n,d),m(n,d));e.push(w),t[_]=w}return{items:e,selectValueMap:t,getOptionFromViewValue:function(e){return t[p(e)]},getViewValueFromOption:function(e){return l?v.copy(e.viewValue):e.viewValue}}}}}(s.ngOptions,o,e),w=n[0].createDocumentFragment(),k=function(){T?c.removeAttr("selected"):c.remove()},S=function(){E.remove()};function I(e,t){var n=r.cloneNode(!1);t.appendChild(n),function(e,t){e.element=t,t.disabled=e.disabled,e.label!==t.label&&(t.label=e.label,t.textContent=e.label),e.value!==t.value&&(t.value=e.selectValue)}(e,n)}function O(){var e=y&&d.readValue();if(y)for(var t=y.items.length-1;t>=0;t--){var n=y.items[t];M(n.group)?Tt(n.element.parentNode):Tt(n.element)}y=C.getOptions();var i={};if(T&&o.prepend(c),y.items.forEach(function(e){var t;M(e.group)?((t=i[e.group])||(t=a.cloneNode(!1),w.appendChild(t),t.label=null===e.group?"null":e.group,i[e.group]=t),I(e,t)):I(e,w)}),o[0].appendChild(w),h.$render(),!h.$isEmpty(e)){var r=d.readValue();(C.trackBy||p?ne(e,r):e===r)||(h.$setViewValue(r),h.$render())}}p?(h.$isEmpty=function(e){return!e||0===e.length},d.writeValue=function(e){y.items.forEach(function(e){e.element.selected=!1}),e&&e.forEach(function(e){var t=y.getOptionFromViewValue(e);t&&(t.element.selected=!0)})},d.readValue=function(){var e=[];return _(o.val()||[],function(t){var n=y.selectValueMap[t];n&&!n.disabled&&e.push(y.getViewValueFromOption(n))}),e},C.trackBy&&e.$watchCollection(function(){if(U(h.$viewValue))return h.$viewValue.map(function(e){return C.getTrackByValue(e)})},function(){h.$render()})):(d.writeValue=function(e){var t=y.selectValueMap[o.val()],n=y.getOptionFromViewValue(e);t&&t.element.removeAttribute("selected"),n?(o[0].value!==n.selectValue&&(S(),k(),o[0].value=n.selectValue,n.element.selected=!0),n.element.setAttribute("selected","selected")):null===e||T?(S(),T||o.prepend(c),o.val(""),c.prop("selected",!0),c.attr("selected",!0)):(k(),o.prepend(E),o.val("?"),E.prop("selected",!0),E.attr("selected",!0))},d.readValue=function(){var e=y.selectValueMap[o.val()];return e&&!e.disabled?(k(),S(),y.getViewValueFromOption(e)):null},C.trackBy&&e.$watch(function(){return C.getTrackByValue(h.$viewValue)},function(){h.$render()})),T?(c.remove(),t(c)(e),c.removeClass("ng-scope")):c=l(r.cloneNode(!1)),o.empty(),O(),e.$watchCollection(C.getWatchables,O)}}}}],Za=["$locale","$interpolate","$log",function(e,t,n){var i=/{}/g,r=/^when(Minus)?(.+)$/;return{link:function(o,s,l){var u,c=l.count,d=l.$attr.when&&s.attr(l.$attr.when),h=l.offset||0,p=o.$eval(d)||{},f={},g=t.startSymbol(),m=t.endSymbol(),y=g+c+"-"+h+m,b=v.noop;function T(e){s.text(e||"")}_(l,function(e,t){var n=r.exec(t);if(n){var i=(n[1]?"-":"")+a(n[2]);p[i]=s.attr(l.$attr[t])}}),_(p,function(e,n){f[n]=t(e.replace(i,y))}),o.$watch(c,function(t){var i=parseFloat(t),r=D(i);if(r||i in p||(i=e.pluralCat(i-h)),!(i===u||r&&D(u))){b();var a=f[i];N(a)?(null!=t&&n.debug("ngPluralize: no rule defined for '"+i+"' in "+d),b=x,T()):b=o.$watch(a,T),u=i}})}}}],eo=["$parse","$animate","$compile",function(e,n,i){var a=t("ngRepeat"),o=function(e,t,n,i,r,a,o){e[n]=i,r&&(e[r]=a),e.$index=t,e.$first=0===t,e.$last=t===o-1,e.$middle=!(e.$first||e.$last),e.$odd=!(e.$even=0==(1&t))},s=function(e){return e.clone[0]},l=function(e){return e.clone[e.clone.length-1]};return{restrict:"A",multiElement:!0,transclude:"element",priority:1e3,terminal:!0,$$tlb:!0,compile:function(t,u){var c=u.ngRepeat,d=i.$$createComment("end ngRepeat",c),h=c.match(/^\s*([\s\S]+?)\s+in\s+([\s\S]+?)(?:\s+as\s+([\s\S]+?))?(?:\s+track\s+by\s+([\s\S]+?))?\s*$/);if(!h)throw a("iexp","Expected expression in form of '_item_ in _collection_[ track by _id_]' but got '{0}'.",c);var p=h[1],f=h[2],g=h[3],m=h[4];if(!(h=p.match(/^(?:(\s*[\$\w]+)|\(\s*([\$\w]+)\s*,\s*([\$\w]+)\s*\))$/)))throw a("iidexp","'_item_' in '_item_ in _collection_' should be an identifier or '(_key_, _value_)' expression, but got '{0}'.",p);var v,y,T,E,C=h[3]||h[1],w=h[2];if(g&&(!/^[$a-zA-Z_][$a-zA-Z0-9_]*$/.test(g)||/^(null|undefined|this|\$index|\$first|\$middle|\$last|\$even|\$odd|\$parent|\$root|\$id)$/.test(g)))throw a("badident","alias '{0}' is invalid --- must be a valid JS identifier which is not a reserved name.",g);var k={$id:Rt};return m?v=e(m):(T=function(e,t){return Rt(t)},E=function(e){return e}),function(e,t,i,u,h){v&&(y=function(t,n,i){return w&&(k[w]=t),k[C]=n,k.$index=i,v(e,k)});var p=Pe();e.$watchCollection(f,function(i){var u,f,m,v,k,S,I,O,D,R,x,A,P=t[0],L=Pe();if(g&&(e[g]=i),b(i))D=i,O=y||T;else for(var N in O=y||E,D=[],i)r.call(i,N)&&"$"!==N.charAt(0)&&D.push(N);for(v=D.length,x=new Array(v),u=0;u<v;u++)if(k=i===D?u:D[u],S=i[k],I=O(k,S,u),p[I])R=p[I],delete p[I],L[I]=R,x[u]=R;else{if(L[I])throw _(x,function(e){e&&e.scope&&(p[e.id]=e)}),a("dupes","Duplicates in a repeater are not allowed. Use 'track by' expression to specify unique keys. Repeater: {0}, Duplicate key: {1}, Duplicate value: {2}",c,I,S);x[u]={id:I,scope:void 0,clone:void 0},L[I]=!0}for(var M in p){if(A=Ae((R=p[M]).clone),n.leave(A),A[0].parentNode)for(u=0,f=A.length;u<f;u++)A[u].$$NG_REMOVED=!0;R.scope.$destroy()}for(u=0;u<v;u++)if(k=i===D?u:D[u],S=i[k],(R=x[u]).scope){m=P;do{m=m.nextSibling}while(m&&m.$$NG_REMOVED);s(R)!==m&&n.move(Ae(R.clone),null,P),P=l(R),o(R.scope,u,C,S,w,k,v)}else h(function(e,t){R.scope=t;var i=d.cloneNode(!1);e[e.length++]=i,n.enter(e,null,P),P=i,R.clone=e,L[R.id]=R,o(R.scope,u,C,S,w,k,v)});p=L})}}}}],to=["$animate",function(e){return{restrict:"A",multiElement:!0,link:function(t,n,i){t.$watch(i.ngShow,function(t){e[t?"removeClass":"addClass"](n,"ng-hide",{tempClasses:"ng-hide-animate"})})}}}],no=["$animate",function(e){return{restrict:"A",multiElement:!0,link:function(t,n,i){t.$watch(i.ngHide,function(t){e[t?"addClass":"removeClass"](n,"ng-hide",{tempClasses:"ng-hide-animate"})})}}}],io=Br(function(e,t,n){e.$watch(n.ngStyle,function(e,n){n&&e!==n&&_(n,function(e,n){t.css(n,"")}),e&&t.css(e)},!0)}),ro=["$animate","$compile",function(e,t){return{require:"ngSwitch",controller:["$scope",function(){this.cases={}}],link:function(n,i,r,a){var o=r.ngSwitch||r.on,s=[],l=[],u=[],c=[],d=function(e,t){return function(){e.splice(t,1)}};n.$watch(o,function(n){var i,r;for(i=0,r=u.length;i<r;++i)e.cancel(u[i]);for(u.length=0,i=0,r=c.length;i<r;++i){var o=Ae(l[i].clone);c[i].$destroy(),(u[i]=e.leave(o)).then(d(u,i))}l.length=0,c.length=0,(s=a.cases["!"+n]||a.cases["?"])&&_(s,function(n){n.transclude(function(i,r){c.push(r);var a=n.element;i[i.length++]=t.$$createComment("end ngSwitchWhen");var o={clone:i};l.push(o),e.enter(i,a.parent(),a)})})})}}}],ao=Br({transclude:"element",priority:1200,require:"^ngSwitch",multiElement:!0,link:function(e,t,n,i,r){i.cases["!"+n.ngSwitchWhen]=i.cases["!"+n.ngSwitchWhen]||[],i.cases["!"+n.ngSwitchWhen].push({transclude:r,element:t})}}),oo=Br({transclude:"element",priority:1200,require:"^ngSwitch",multiElement:!0,link:function(e,t,n,i,r){i.cases["?"]=i.cases["?"]||[],i.cases["?"].push({transclude:r,element:t})}}),so=t("ngTransclude"),lo=["$compile",function(e){return{restrict:"EAC",terminal:!0,compile:function(t){var n=e(t.contents());return t.empty(),function(e,t,i,r,a){if(!a)throw so("orphan","Illegal use of ngTransclude directive in the template! No parent directive that requires a transclusion found. Element: {0}",fe(t));i.ngTransclude===i.$attr.ngTransclude&&(i.ngTransclude="");var o=i.ngTransclude||i.ngTranscludeSlot;function s(){n(e,function(e){t.append(e)})}a(function(e,n){e.length?t.append(e):(s(),n.$destroy())},null,o),o&&!a.isSlotFilled(o)&&s()}}}}],uo=["$templateCache",function(e){return{restrict:"E",terminal:!0,compile:function(t,n){if("text/ng-template"===n.type){var i=n.id,r=t[0].text;e.put(i,r)}}}}],co={$setViewValue:x,$render:x},ho=["$element","$scope",function(t,n){var i=this,r=new xt;i.ngModelCtrl=co,i.unknownOption=l(e.document.createElement("option")),i.renderUnknownOption=function(e){var n="? "+Rt(e)+" ?";i.unknownOption.val(n),t.prepend(i.unknownOption),t.val(n)},n.$on("$destroy",function(){i.renderUnknownOption=x}),i.removeUnknownOption=function(){i.unknownOption.parent()&&i.unknownOption.remove()},i.readValue=function(){return i.removeUnknownOption(),t.val()},i.writeValue=function(e){i.hasOption(e)?(i.removeUnknownOption(),t.val(e),""===e&&i.emptyOption.prop("selected",!0)):null==e&&i.emptyOption?(i.removeUnknownOption(),t.val("")):i.renderUnknownOption(e)},i.addOption=function(e,t){if(t[0].nodeType!==Me){Re(e,'"option value"'),""===e&&(i.emptyOption=t);var n,a=r.get(e)||0;r.put(e,a+1),i.ngModelCtrl.$render(),(n=t)[0].hasAttribute("selected")&&(n[0].selected=!0)}},i.removeOption=function(e){var t=r.get(e);t&&(1===t?(r.remove(e),""===e&&(i.emptyOption=void 0)):r.put(e,t-1))},i.hasOption=function(e){return!!r.get(e)},i.registerOption=function(e,t,n,r,a){var o;r?n.$observe("value",function(e){M(o)&&i.removeOption(o),o=e,i.addOption(e,t)}):a?e.$watch(a,function(e,r){n.$set("value",e),r!==e&&i.removeOption(r),i.addOption(e,t)}):i.addOption(n.value,t),t.on("$destroy",function(){i.removeOption(n.value),i.ngModelCtrl.$render()})}}],po=function(){return{restrict:"E",require:["select","?ngModel"],controller:ho,priority:1,link:{pre:function(e,t,n,i){var r=i[1];if(r){var a=i[0];if(a.ngModelCtrl=r,t.on("change",function(){e.$apply(function(){r.$setViewValue(a.readValue())})}),n.multiple){a.readValue=function(){var e=[];return _(t.find("option"),function(t){t.selected&&e.push(t.value)}),e},a.writeValue=function(e){var n=new xt(e);_(t.find("option"),function(e){e.selected=M(n.get(e.value))})};var o,s=NaN;e.$watch(function(){s!==r.$viewValue||ne(o,r.$viewValue)||(o=je(r.$viewValue),r.$render()),s=r.$viewValue}),r.$isEmpty=function(e){return!e||0===e.length}}}},post:function(e,t,n,i){var r=i[1];if(r){var a=i[0];r.$render=function(){a.writeValue(r.$viewValue)}}}}}},fo=["$interpolate",function(e){return{restrict:"E",priority:100,compile:function(t,n){if(M(n.value))var i=e(n.value,!0);else{var r=e(t.text(),!0);r||n.$set("value",t.text())}return function(e,t,n){var a=t.parent(),o=a.data("$selectController")||a.parent().data("$selectController");o&&o.registerOption(e,t,n,i,r)}}}}],go=function(){return{restrict:"A",require:"?ngModel",link:function(e,t,n,i){i&&(n.required=!0,i.$validators.required=function(e,t){return!n.required||!i.$isEmpty(t)},n.$observe("required",function(){i.$validate()}))}}},mo=function(){return{restrict:"A",require:"?ngModel",link:function(e,n,i,r){if(r){var a,o=i.ngPattern||i.pattern;i.$observe("pattern",function(e){if(j(e)&&e.length>0&&(e=new RegExp("^"+e+"$")),e&&!e.test)throw t("ngPattern")("noregexp","Expected {0} to be a RegExp but was {1}. Element: {2}",o,e,fe(n));a=e||void 0,r.$validate()}),r.$validators.pattern=function(e,t){return r.$isEmpty(t)||N(a)||a.test(t)}}}}},vo=function(){return{restrict:"A",require:"?ngModel",link:function(e,t,n,i){if(i){var r=-1;n.$observe("maxlength",function(e){var t=O(e);r=D(t)?-1:t,i.$validate()}),i.$validators.maxlength=function(e,t){return r<0||i.$isEmpty(t)||t.length<=r}}}}},yo=function(){return{restrict:"A",require:"?ngModel",link:function(e,t,n,i){if(i){var r=0;n.$observe("minlength",function(e){r=O(e)||0,i.$validate()}),i.$validators.minlength=function(e,t){return i.$isEmpty(t)||t.length>=r}}}}};e.angular.bootstrap?e.console&&console.log("WARNING: Tried to load angular more than once."):(function(){var t;if(!Ie){var n=re();(u=N(n)?e.jQuery:n?e[n]:void 0)&&u.fn.on?(l=u,S(u.fn,{scope:Et.scope,isolateScope:Et.isolateScope,controller:Et.controller,injector:Et.injector,inheritedData:Et.inheritedData}),t=u.cleanData,u.cleanData=function(e){for(var n,i,r=0;null!=(i=e[r]);r++)(n=u._data(i,"events"))&&n.$destroy&&u(i).triggerHandler("$destroy");t(e)}):l=st,v.element=l,Ie=!0}}(),S(v,{bootstrap:Ee,copy:te,extend:S,merge:I,equals:ne,element:l,forEach:_,injector:Ft,noop:x,bind:se,toJson:ue,fromJson:ce,identity:A,isUndefined:N,isDefined:M,isString:j,isFunction:V,isObject:K,isNumber:B,isElement:J,isArray:U,version:Fe,isDate:F,lowercase:a,uppercase:o,callbacks:{$$counter:0},getTestability:we,$$minErr:t,$$csp:ie,reloadWithDebugInfo:Ce}),(c=function(e){var n=t("$injector"),i=t("ng");function r(e,t,n){return e[t]||(e[t]=n())}var a=r(e,"angular",Object);return a.$$minErr=a.$$minErr||t,r(a,"module",function(){var e={};return function(t,a,o){return function(e,t){if("hasOwnProperty"===e)throw i("badname","hasOwnProperty is not a valid {0} name","module")}(t),a&&e.hasOwnProperty(t)&&(e[t]=null),r(e,t,function(){if(!a)throw n("nomod","Module '{0}' is not available! You either misspelled the module name or forgot to load it. If registering a module ensure that you specify the dependencies as the second argument.",t);var e=[],i=[],r=[],s=u("$injector","invoke","push",i),l={_invokeQueue:e,_configBlocks:i,_runBlocks:r,requires:a,name:t,provider:c("$provide","provider"),factory:c("$provide","factory"),service:c("$provide","service"),value:u("$provide","value"),constant:u("$provide","constant","unshift"),decorator:c("$provide","decorator"),animation:c("$animateProvider","register"),filter:c("$filterProvider","register"),controller:c("$controllerProvider","register"),directive:c("$compileProvider","directive"),component:c("$compileProvider","component"),config:s,run:function(e){return r.push(e),this}};return o&&s(o),l;function u(t,n,i,r){return r||(r=e),function(){return r[i||"push"]([t,n,arguments]),l}}function c(n,i){return function(r,a){return a&&V(a)&&(a.$$moduleName=t),e.push([n,i,arguments]),l}}})}})}(e))("ng",["ngLocale"],["$provide",function(e){e.provider({$$sanitizeUri:Yi}),e.provider("$compile",an).directive({a:Fr,input:va,textarea:va,form:Wr,script:uo,select:po,option:fo,ngBind:_a,ngBindHtml:Ea,ngBindTemplate:Ta,ngClass:ka,ngClassEven:Ia,ngClassOdd:Sa,ngCloak:Oa,ngController:Da,ngForm:Gr,ngHide:no,ngIf:Aa,ngInclude:Pa,ngInit:Na,ngNonBindable:Xa,ngPluralize:Za,ngRepeat:eo,ngShow:to,ngStyle:io,ngSwitch:ro,ngSwitchWhen:ao,ngSwitchDefault:oo,ngOptions:Ja,ngTransclude:lo,ngModel:qa,ngList:Ma,ngChange:Ca,pattern:mo,ngPattern:mo,required:go,ngRequired:go,minlength:yo,ngMinlength:yo,maxlength:vo,ngMaxlength:vo,ngValue:ba,ngModelOptions:za}).directive({ngInclude:La}).directive(Ur).directive(Ra),e.provider({$anchorScroll:Ut,$animate:Xt,$animateCss:Jt,$$animateJs:Wt,$$animateQueue:Gt,$$AnimateRunner:Qt,$$animateAsyncRun:Yt,$browser:Zt,$cacheFactory:en,$controller:fn,$document:gn,$exceptionHandler:mn,$filter:fr,$$forceReflow:vn,$interpolate:Kn,$interval:$n,$http:Pn,$httpParamSerializer:Sn,$httpParamSerializerJQLike:In,$httpBackend:Nn,$xhrFactory:Ln,$jsonpCallbacks:jn,$location:ii,$log:ri,$parse:qi,$rootScope:Xi,$q:Hi,$$q:zi,$sce:tr,$sceDelegate:er,$sniffer:nr,$templateCache:tn,$templateRequest:rr,$$testability:ar,$timeout:or,$window:dr,$$rAF:Gi,$$jqLite:Dt,$$HashMap:At,$$cookieReader:pr})}]),v.module("ngLocale",[],["$provide",function(e){e.value("$locale",{DATETIME_FORMATS:{AMPMS:["AM","PM"],DAY:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],ERANAMES:["Before Christ","Anno Domini"],ERAS:["BC","AD"],FIRSTDAYOFWEEK:6,MONTH:["January","February","March","April","May","June","July","August","September","October","November","December"],SHORTDAY:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],SHORTMONTH:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],STANDALONEMONTH:["January","February","March","April","May","June","July","August","September","October","November","December"],WEEKENDRANGE:[5,6],fullDate:"EEEE, MMMM d, y",longDate:"MMMM d, y",medium:"MMM d, y h:mm:ss a",mediumDate:"MMM d, y",mediumTime:"h:mm:ss a",short:"M/d/yy h:mm a",shortDate:"M/d/yy",shortTime:"h:mm a"},NUMBER_FORMATS:{CURRENCY_SYM:"$",DECIMAL_SEP:".",GROUP_SEP:",",PATTERNS:[{gSize:3,lgSize:3,maxFrac:3,minFrac:0,minInt:1,negPre:"-",negSuf:"",posPre:"",posSuf:""},{gSize:3,lgSize:3,maxFrac:2,minFrac:2,minInt:1,negPre:"-¤",negSuf:"",posPre:"¤",posSuf:""}]},id:"en-us",localeID:"en_US",pluralCat:function(e,t){var n=0|e,i=function(e,t){var n=t;void 0===n&&(n=Math.min(function(e){var t=(e+="").indexOf(".");return-1==t?0:e.length-t-1}(e),3));var i=Math.pow(10,n);return{v:n,f:(e*i|0)%i}}(e,t);return 1==n&&0==i.v?"one":"other"}})}]),l(e.document).ready(function(){!function(t,n){var i,r,a={};if(_(_e,function(e){var n=e+"app";!i&&t.hasAttribute&&t.hasAttribute(n)&&(i=t,r=t.getAttribute(n))}),_(_e,function(e){var n,a=e+"app";!i&&(n=t.querySelector("["+a.replace(":","\\:")+"]"))&&(i=n,r=n.getAttribute(a))}),i){if(!Te)return void e.console.error("Angular: disabling automatic bootstrap. <script> protocol indicates an extension, document.location.href does not match.");a.strictDi=null!==function(e,t){var n,i,r=_e.length;for(i=0;i<r;++i)if(n=_e[i]+"strict-di",j(n=e.getAttribute(n)))return n;return null}(i),n(i,r?[r]:[],a)}}(e.document,Ee)}))}(window),!window.angular.$$csp().noInlineStyle&&window.angular.element(document.head).prepend('<style type="text/css">@charset "UTF-8";[ng\\:cloak],[ng-cloak],[data-ng-cloak],[x-ng-cloak],.ng-cloak,.x-ng-cloak,.ng-hide:not(.ng-hide-animate){display:none !important;}ng\\:form{display:block;}.ng-animate-shim{visibility:hidden;}.ng-anchor{position:absolute;}</style>')},function(e,t){(function(){e.exports=class{hasFeature(e,t){return!0}createDocumentType(e,t,n){throw new Error("This DOM method is not implemented.")}createDocument(e,t,n){throw new Error("This DOM method is not implemented.")}createHTMLDocument(e){throw new Error("This DOM method is not implemented.")}getFeature(e,t){throw new Error("This DOM method is not implemented.")}}}).call(this)},function(e,t,n){(function(){var t,i,r,a,o,s,l;({isPlainObject:l}=n(2)),r=n(24),i=n(68),a=n(1),t=n(0),s=n(28),o=n(19),e.exports=function(){class e extends a{constructor(e){super(null),this.name="#document",this.type=t.Document,this.documentURI=null,this.domConfig=new i,e||(e={}),e.writer||(e.writer=new o),this.options=e,this.stringify=new s(e)}end(e){var t;return t={},e?l(e)&&(t=e,e=this.options.writer):e=this.options.writer,e.document(this,e.filterOptions(t))}toString(e){return this.options.writer.document(this,this.options.writer.filterOptions(e))}createElement(e){throw new Error("This DOM method is not implemented."+this.debugInfo())}createDocumentFragment(){throw new Error("This DOM method is not implemented."+this.debugInfo())}createTextNode(e){throw new Error("This DOM method is not implemented."+this.debugInfo())}createComment(e){throw new Error("This DOM method is not implemented."+this.debugInfo())}createCDATASection(e){throw new Error("This DOM method is not implemented."+this.debugInfo())}createProcessingInstruction(e,t){throw new Error("This DOM method is not implemented."+this.debugInfo())}createAttribute(e){throw new Error("This DOM method is not implemented."+this.debugInfo())}createEntityReference(e){throw new Error("This DOM method is not implemented."+this.debugInfo())}getElementsByTagName(e){throw new Error("This DOM method is not implemented."+this.debugInfo())}importNode(e,t){throw new Error("This DOM method is not implemented."+this.debugInfo())}createElementNS(e,t){throw new Error("This DOM method is not implemented."+this.debugInfo())}createAttributeNS(e,t){throw new Error("This DOM method is not implemented."+this.debugInfo())}getElementsByTagNameNS(e,t){throw new Error("This DOM method is not implemented."+this.debugInfo())}getElementById(e){throw new Error("This DOM method is not implemented."+this.debugInfo())}adoptNode(e){throw new Error("This DOM method is not implemented."+this.debugInfo())}normalizeDocument(){throw new Error("This DOM method is not implemented."+this.debugInfo())}renameNode(e,t,n){throw new Error("This DOM method is not implemented."+this.debugInfo())}getElementsByClassName(e){throw new Error("This DOM method is not implemented."+this.debugInfo())}createEvent(e){throw new Error("This DOM method is not implemented."+this.debugInfo())}createRange(){throw new Error("This DOM method is not implemented."+this.debugInfo())}createNodeIterator(e,t,n){throw new Error("This DOM method is not implemented."+this.debugInfo())}createTreeWalker(e,t,n){throw new Error("This DOM method is not implemented."+this.debugInfo())}}return Object.defineProperty(e.prototype,"implementation",{value:new r}),Object.defineProperty(e.prototype,"doctype",{get:function(){var e,n,i,r;for(n=0,i=(r=this.children).length;n<i;n++)if((e=r[n]).type===t.DocType)return e;return null}}),Object.defineProperty(e.prototype,"documentElement",{get:function(){return this.rootObject||null}}),Object.defineProperty(e.prototype,"inputEncoding",{get:function(){return null}}),Object.defineProperty(e.prototype,"strictErrorChecking",{get:function(){return!1}}),Object.defineProperty(e.prototype,"xmlEncoding",{get:function(){return 0!==this.children.length&&this.children[0].type===t.Declaration?this.children[0].encoding:null}}),Object.defineProperty(e.prototype,"xmlStandalone",{get:function(){return 0!==this.children.length&&this.children[0].type===t.Declaration&&"yes"===this.children[0].standalone}}),Object.defineProperty(e.prototype,"xmlVersion",{get:function(){return 0!==this.children.length&&this.children[0].type===t.Declaration?this.children[0].version:"1.0"}}),Object.defineProperty(e.prototype,"URL",{get:function(){return this.documentURI}}),Object.defineProperty(e.prototype,"origin",{get:function(){return null}}),Object.defineProperty(e.prototype,"compatMode",{get:function(){return null}}),Object.defineProperty(e.prototype,"characterSet",{get:function(){return null}}),Object.defineProperty(e.prototype,"contentType",{get:function(){return null}}),e}.call(this)}).call(this)},function(e,t,n){(function(){var t;t=n(0),n(1),e.exports=function(){class e{constructor(e,n,i){if(this.parent=e,this.parent&&(this.options=this.parent.options,this.stringify=this.parent.stringify),null==n)throw new Error("Missing attribute name. "+this.debugInfo(n));this.name=this.stringify.name(n),this.value=this.stringify.attValue(i),this.type=t.Attribute,this.isId=!1,this.schemaTypeInfo=null}clone(){return Object.create(this)}toString(e){return this.options.writer.attribute(this,this.options.writer.filterOptions(e))}debugInfo(e){return null==(e=e||this.name)?"parent: <"+this.parent.name+">":"attribute: {"+e+"}, parent: <"+this.parent.name+">"}isEqualNode(e){return e.namespaceURI===this.namespaceURI&&e.prefix===this.prefix&&e.localName===this.localName&&e.value===this.value}}return Object.defineProperty(e.prototype,"nodeType",{get:function(){return this.type}}),Object.defineProperty(e.prototype,"ownerElement",{get:function(){return this.parent}}),Object.defineProperty(e.prototype,"textContent",{get:function(){return this.value},set:function(e){return this.value=e||""}}),Object.defineProperty(e.prototype,"namespaceURI",{get:function(){return""}}),Object.defineProperty(e.prototype,"prefix",{get:function(){return""}}),Object.defineProperty(e.prototype,"localName",{get:function(){return this.name}}),Object.defineProperty(e.prototype,"specified",{get:function(){return!0}}),e}.call(this)}).call(this)},function(e,t,n){(function(){var t,i;i=n(1),t=n(0),e.exports=class extends i{constructor(e){super(e),this.type=t.Dummy}clone(){return Object.create(this)}toString(e){return""}}}).call(this)},function(e,t){(function(){var t={}.hasOwnProperty;e.exports=function(){class e{constructor(e){var n,i,r;for(n in this.assertLegalChar=this.assertLegalChar.bind(this),this.assertLegalName=this.assertLegalName.bind(this),e||(e={}),this.options=e,this.options.version||(this.options.version="1.0"),i=e.stringify||{})t.call(i,n)&&(r=i[n],this[n]=r)}name(e){return this.options.noValidation?e:this.assertLegalName(""+e||"")}text(e){return this.options.noValidation?e:this.assertLegalChar(this.textEscape(""+e||""))}cdata(e){return this.options.noValidation?e:(e=(e=""+e||"").replace("]]>","]]]]><![CDATA[>"),this.assertLegalChar(e))}comment(e){if(this.options.noValidation)return e;if((e=""+e||"").match(/--/))throw new Error("Comment text cannot contain double-hypen: "+e);return this.assertLegalChar(e)}raw(e){return this.options.noValidation?e:""+e||""}attValue(e){return this.options.noValidation?e:this.assertLegalChar(this.attEscape(e=""+e||""))}insTarget(e){return this.options.noValidation?e:this.assertLegalChar(""+e||"")}insValue(e){if(this.options.noValidation)return e;if((e=""+e||"").match(/\?>/))throw new Error("Invalid processing instruction value: "+e);return this.assertLegalChar(e)}xmlVersion(e){if(this.options.noValidation)return e;if(!(e=""+e||"").match(/1\.[0-9]+/))throw new Error("Invalid version number: "+e);return e}xmlEncoding(e){if(this.options.noValidation)return e;if(!(e=""+e||"").match(/^[A-Za-z](?:[A-Za-z0-9._-])*$/))throw new Error("Invalid encoding: "+e);return this.assertLegalChar(e)}xmlStandalone(e){return this.options.noValidation?e:e?"yes":"no"}dtdPubID(e){return this.options.noValidation?e:this.assertLegalChar(""+e||"")}dtdSysID(e){return this.options.noValidation?e:this.assertLegalChar(""+e||"")}dtdElementValue(e){return this.options.noValidation?e:this.assertLegalChar(""+e||"")}dtdAttType(e){return this.options.noValidation?e:this.assertLegalChar(""+e||"")}dtdAttDefault(e){return this.options.noValidation?e:this.assertLegalChar(""+e||"")}dtdEntityValue(e){return this.options.noValidation?e:this.assertLegalChar(""+e||"")}dtdNData(e){return this.options.noValidation?e:this.assertLegalChar(""+e||"")}assertLegalChar(e){var t,n;if(this.options.noValidation)return e;if("1.0"===this.options.version){if(t=/[\0-\x08\x0B\f\x0E-\x1F\uFFFE\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]/g,void 0!==this.options.invalidCharReplacement)e=e.replace(t,this.options.invalidCharReplacement);else if(n=e.match(t))throw new Error(`Invalid character in string: ${e} at index ${n.index}`)}else if("1.1"===this.options.version)if(t=/[\0\uFFFE\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]/g,void 0!==this.options.invalidCharReplacement)e=e.replace(t,this.options.invalidCharReplacement);else if(n=e.match(t))throw new Error(`Invalid character in string: ${e} at index ${n.index}`);return e}assertLegalName(e){var t;if(this.options.noValidation)return e;if(t=/^([:A-Z_a-z\xC0-\xD6\xD8-\xF6\xF8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]|[\uD800-\uDB7F][\uDC00-\uDFFF])([\x2D\.0-:A-Z_a-z\xB7\xC0-\xD6\xD8-\xF6\xF8-\u037D\u037F-\u1FFF\u200C\u200D\u203F\u2040\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]|[\uD800-\uDB7F][\uDC00-\uDFFF])*$/,!(e=this.assertLegalChar(e)).match(t))throw new Error(`Invalid character in name: ${e}`);return e}textEscape(e){var t;return this.options.noValidation?e:(t=this.options.noDoubleEncoding?/(?!&(lt|gt|amp|apos|quot);)&/g:/&/g,e.replace(t,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\r/g,"&#xD;"))}attEscape(e){var t;return this.options.noValidation?e:(t=this.options.noDoubleEncoding?/(?!&(lt|gt|amp|apos|quot);)&/g:/&/g,e.replace(t,"&amp;").replace(/</g,"&lt;").replace(/"/g,"&quot;").replace(/\t/g,"&#x9;").replace(/\n/g,"&#xA;").replace(/\r/g,"&#xD;"))}}return e.prototype.convertAttKey="@",e.prototype.convertPIKey="?",e.prototype.convertTextKey="#text",e.prototype.convertCDataKey="#cdata",e.prototype.convertCommentKey="#comment",e.prototype.convertRawKey="#raw",e}.call(this)}).call(this)},function(e,t,n){(function(){var t,i,r,a={}.hasOwnProperty;({assign:r}=n(2)),t=n(0),n(10),n(11),n(8),n(9),n(6),n(16),n(17),n(18),n(27),n(12),n(14),n(13),n(15),i=n(5),e.exports=class{constructor(e){var t,n,i;for(t in e||(e={}),this.options=e,n=e.writer||{})a.call(n,t)&&(i=n[t],this["_"+t]=this[t],this[t]=i)}filterOptions(e){var t,n,a,o,s,l,u,c,d;return e||(e={}),e=r({},this.options,e),(t={writer:this}).pretty=e.pretty||!1,t.allowEmpty=e.allowEmpty||!1,t.indent=null!=(n=e.indent)?n:"  ",t.newline=null!=(a=e.newline)?a:"\n",t.offset=null!=(o=e.offset)?o:0,t.width=null!=(s=e.width)?s:0,t.dontPrettyTextNodes=null!=(l=null!=(u=e.dontPrettyTextNodes)?u:e.dontprettytextnodes)?l:0,t.spaceBeforeSlash=null!=(c=null!=(d=e.spaceBeforeSlash)?d:e.spacebeforeslash)?c:"",!0===t.spaceBeforeSlash&&(t.spaceBeforeSlash=" "),t.suppressPrettyCount=0,t.user={},t.state=i.None,t}indent(e,t,n){var i;return!t.pretty||t.suppressPrettyCount?"":t.pretty&&(i=(n||0)+t.offset+1)>0?new Array(i).join(t.indent):""}endline(e,t,n){return!t.pretty||t.suppressPrettyCount?"":t.newline}attribute(e,t,n){var i;return this.openAttribute(e,t,n),i=t.pretty&&t.width>0?e.name+'="'+e.value+'"':" "+e.name+'="'+e.value+'"',this.closeAttribute(e,t,n),i}cdata(e,t,n){var r;return this.openNode(e,t,n),t.state=i.OpenTag,r=this.indent(e,t,n)+"<![CDATA[",t.state=i.InsideTag,r+=e.value,t.state=i.CloseTag,r+="]]>"+this.endline(e,t,n),t.state=i.None,this.closeNode(e,t,n),r}comment(e,t,n){var r;return this.openNode(e,t,n),t.state=i.OpenTag,r=this.indent(e,t,n)+"\x3c!-- ",t.state=i.InsideTag,r+=e.value,t.state=i.CloseTag,r+=" --\x3e"+this.endline(e,t,n),t.state=i.None,this.closeNode(e,t,n),r}declaration(e,t,n){var r;return this.openNode(e,t,n),t.state=i.OpenTag,r=this.indent(e,t,n)+"<?xml",t.state=i.InsideTag,r+=' version="'+e.version+'"',null!=e.encoding&&(r+=' encoding="'+e.encoding+'"'),null!=e.standalone&&(r+=' standalone="'+e.standalone+'"'),t.state=i.CloseTag,r+=t.spaceBeforeSlash+"?>",r+=this.endline(e,t,n),t.state=i.None,this.closeNode(e,t,n),r}docType(e,t,n){var r,a,o,s,l;if(n||(n=0),this.openNode(e,t,n),t.state=i.OpenTag,s=this.indent(e,t,n),s+="<!DOCTYPE "+e.root().name,e.pubID&&e.sysID?s+=' PUBLIC "'+e.pubID+'" "'+e.sysID+'"':e.sysID&&(s+=' SYSTEM "'+e.sysID+'"'),e.children.length>0){for(s+=" [",s+=this.endline(e,t,n),t.state=i.InsideTag,a=0,o=(l=e.children).length;a<o;a++)r=l[a],s+=this.writeChildNode(r,t,n+1);t.state=i.CloseTag,s+="]"}return t.state=i.CloseTag,s+=t.spaceBeforeSlash+">",s+=this.endline(e,t,n),t.state=i.None,this.closeNode(e,t,n),s}element(e,n,r){var o,s,l,u,c,d,h,p,f,g,m,v,y,b,_,T,E,C;if(r||(r=0),m=!1,this.openNode(e,n,r),n.state=i.OpenTag,v=this.indent(e,n,r)+"<"+e.name,n.pretty&&n.width>0)for(g in h=v.length,b=e.attribs)a.call(b,g)&&(o=b[g],h+(y=this.attribute(o,n,r)).length>n.width?(C=this.indent(e,n,r+1)+y,v+=this.endline(e,n,r)+C,h=C.length):(v+=C=" "+y,h+=C.length));else for(g in _=e.attribs)a.call(_,g)&&(o=_[g],v+=this.attribute(o,n,r));if(u=0===(l=e.children.length)?null:e.children[0],0===l||e.children.every(function(e){return(e.type===t.Text||e.type===t.Raw||e.type===t.CData)&&""===e.value}))n.allowEmpty?(v+=">",n.state=i.CloseTag,v+="</"+e.name+">"+this.endline(e,n,r)):(n.state=i.CloseTag,v+=n.spaceBeforeSlash+"/>"+this.endline(e,n,r));else if(!n.pretty||1!==l||u.type!==t.Text&&u.type!==t.Raw&&u.type!==t.CData||null==u.value){if(n.dontPrettyTextNodes)for(c=0,p=(T=e.children).length;c<p;c++)if(((s=T[c]).type===t.Text||s.type===t.Raw||s.type===t.CData)&&null!=s.value){n.suppressPrettyCount++,m=!0;break}for(v+=">"+this.endline(e,n,r),n.state=i.InsideTag,d=0,f=(E=e.children).length;d<f;d++)s=E[d],v+=this.writeChildNode(s,n,r+1);n.state=i.CloseTag,v+=this.indent(e,n,r)+"</"+e.name+">",m&&n.suppressPrettyCount--,v+=this.endline(e,n,r),n.state=i.None}else v+=">",n.state=i.InsideTag,n.suppressPrettyCount++,m=!0,v+=this.writeChildNode(u,n,r+1),n.suppressPrettyCount--,m=!1,n.state=i.CloseTag,v+="</"+e.name+">"+this.endline(e,n,r);return this.closeNode(e,n,r),v}writeChildNode(e,n,i){switch(e.type){case t.CData:return this.cdata(e,n,i);case t.Comment:return this.comment(e,n,i);case t.Element:return this.element(e,n,i);case t.Raw:return this.raw(e,n,i);case t.Text:return this.text(e,n,i);case t.ProcessingInstruction:return this.processingInstruction(e,n,i);case t.Dummy:return"";case t.Declaration:return this.declaration(e,n,i);case t.DocType:return this.docType(e,n,i);case t.AttributeDeclaration:return this.dtdAttList(e,n,i);case t.ElementDeclaration:return this.dtdElement(e,n,i);case t.EntityDeclaration:return this.dtdEntity(e,n,i);case t.NotationDeclaration:return this.dtdNotation(e,n,i);default:throw new Error("Unknown XML node type: "+e.constructor.name)}}processingInstruction(e,t,n){var r;return this.openNode(e,t,n),t.state=i.OpenTag,r=this.indent(e,t,n)+"<?",t.state=i.InsideTag,r+=e.target,e.value&&(r+=" "+e.value),t.state=i.CloseTag,r+=t.spaceBeforeSlash+"?>",r+=this.endline(e,t,n),t.state=i.None,this.closeNode(e,t,n),r}raw(e,t,n){var r;return this.openNode(e,t,n),t.state=i.OpenTag,r=this.indent(e,t,n),t.state=i.InsideTag,r+=e.value,t.state=i.CloseTag,r+=this.endline(e,t,n),t.state=i.None,this.closeNode(e,t,n),r}text(e,t,n){var r;return this.openNode(e,t,n),t.state=i.OpenTag,r=this.indent(e,t,n),t.state=i.InsideTag,r+=e.value,t.state=i.CloseTag,r+=this.endline(e,t,n),t.state=i.None,this.closeNode(e,t,n),r}dtdAttList(e,t,n){var r;return this.openNode(e,t,n),t.state=i.OpenTag,r=this.indent(e,t,n)+"<!ATTLIST",t.state=i.InsideTag,r+=" "+e.elementName+" "+e.attributeName+" "+e.attributeType,"#DEFAULT"!==e.defaultValueType&&(r+=" "+e.defaultValueType),e.defaultValue&&(r+=' "'+e.defaultValue+'"'),t.state=i.CloseTag,r+=t.spaceBeforeSlash+">"+this.endline(e,t,n),t.state=i.None,this.closeNode(e,t,n),r}dtdElement(e,t,n){var r;return this.openNode(e,t,n),t.state=i.OpenTag,r=this.indent(e,t,n)+"<!ELEMENT",t.state=i.InsideTag,r+=" "+e.name+" "+e.value,t.state=i.CloseTag,r+=t.spaceBeforeSlash+">"+this.endline(e,t,n),t.state=i.None,this.closeNode(e,t,n),r}dtdEntity(e,t,n){var r;return this.openNode(e,t,n),t.state=i.OpenTag,r=this.indent(e,t,n)+"<!ENTITY",t.state=i.InsideTag,e.pe&&(r+=" %"),r+=" "+e.name,e.value?r+=' "'+e.value+'"':(e.pubID&&e.sysID?r+=' PUBLIC "'+e.pubID+'" "'+e.sysID+'"':e.sysID&&(r+=' SYSTEM "'+e.sysID+'"'),e.nData&&(r+=" NDATA "+e.nData)),t.state=i.CloseTag,r+=t.spaceBeforeSlash+">"+this.endline(e,t,n),t.state=i.None,this.closeNode(e,t,n),r}dtdNotation(e,t,n){var r;return this.openNode(e,t,n),t.state=i.OpenTag,r=this.indent(e,t,n)+"<!NOTATION",t.state=i.InsideTag,r+=" "+e.name,e.pubID&&e.sysID?r+=' PUBLIC "'+e.pubID+'" "'+e.sysID+'"':e.pubID?r+=' PUBLIC "'+e.pubID+'"':e.sysID&&(r+=' SYSTEM "'+e.sysID+'"'),t.state=i.CloseTag,r+=t.spaceBeforeSlash+">"+this.endline(e,t,n),t.state=i.None,this.closeNode(e,t,n),r}openNode(e,t,n){}closeNode(e,t,n){}openAttribute(e,t,n){}closeAttribute(e,t,n){}}}).call(this)},function(e,t,n){n(31),n(32),n(33),n(34),n(35),n(36),n(40),n(41),n(46),n(47),n(48),n(49),n(50),n(51),n(52),n(53),n(56),n(57),n(59),n(60),n(63),n(77),n(78),n(79),n(80),n(81),n(83),n(86),n(87),e.exports=n(88)},function(module,exports){org.ekstep.pluginframework.resourceManager.loadExternalResource("/content-plugins/org.ekstep.colorpicker-1.0/editor/libs/spectrum.js","js"),org.ekstep.pluginframework.resourceManager.loadExternalResource("/content-plugins/org.ekstep.colorpicker-1.0/editor/libs/spectrum.css","css"),org.ekstep.pluginframework.resourceManager.loadExternalResource("/content-plugins/org.ekstep.colorpicker-1.0/editor/colorpickerplugin.css","css"),org.ekstep.pluginframework.pluginManager.registerPlugin({id:"org.ekstep.colorpicker",ver:"1.0",author:"Chetan Sachdev",title:"Colorpicker Plugin",description:"",publishedDate:"",editor:{main:"editor/plugin.js",dependencies:[{type:"js",src:"editor/libs/spectrum.js"},{type:"css",src:"editor/libs/spectrum.css"},{type:"css",src:"editor/colorpickerplugin.css"}],menu:[]},renderer:{}},eval('org.ekstep.contenteditor.basePlugin.extend({type:"colorpicker",picker:[],initialize:function(){ecEditor.addEventListener("colorpicker:state",this.invoke,this)},invoke:function(e,t){var c=this;"added"!=ecEditor.jQuery("#"+t.id+" input").attr("colorpicker")&&(this.picker[t.id]=ecEditor.jQuery("#"+t.id+" input").spectrum({color:"#FF0000",showInput:!0,showAlpha:!1,preferredFormat:"hex",showButtons:!1,containerClassName:"awesome",clickoutFiresChange:!1,showButtons:!0,change:function(e){t.callback(t.id,e.toHexString()),ecEditor.getService(ServiceConstants.TELEMETRY_SERVICE).interact({id:"button",type:"click",subtype:"change",target:"colorpicker",pluginid:c.manifest.id,pluginver:c.manifest.ver,objectid:t.id,stage:ecEditor.getCurrentStage().id})},showPaletteOnly:!0,togglePaletteOnly:!0,togglePaletteMoreText:"more",togglePaletteLessText:"less",color:"blanchedalmond",palette:[["#000","#444","#666","#999","#ccc","#eee","#f3f3f3","#fff"],["#f00","#f90","#ff0","#0f0","#0ff","#00f","#90f","#f0f"],["#f4cccc","#fce5cd","#fff2cc","#d9ead3","#d0e0e3","#cfe2f3","#d9d2e9","#ead1dc"],["#ea9999","#f9cb9c","#ffe599","#b6d7a8","#a2c4c9","#9fc5e8","#b4a7d6","#d5a6bd"],["#e06666","#f6b26b","#ffd966","#93c47d","#76a5af","#6fa8dc","#8e7cc3","#c27ba0"],["#c00","#e69138","#f1c232","#6aa84f","#45818e","#3d85c6","#674ea7","#a64d79"],["#900","#b45f06","#bf9000","#38761d","#134f5c","#0b5394","#351c75","#741b47"],["#600","#783f04","#7f6000","#274e13","#0c343d","#073763","#20124d","#4c1130"]],maxSelectionSize:10,hideAfterPaletteSelect:!0,move:function(e){t.callback(t.id,e.toHexString()),ecEditor.getService(ServiceConstants.TELEMETRY_SERVICE).interact({type:"click",subtype:"move",target:"colorpicker",pluginid:c.manifest.id,pluginver:c.manifest.ver,objectid:t.id,stage:ecEditor.getCurrentStage().id})}}),ecEditor.jQuery("#"+t.id+" input").attr("colorpicker","added")),t&&t.color?ecEditor.jQuery("#"+t.id+" input").spectrum("set",t.color):ecEditor.jQuery("#"+t.id+" input").spectrum("set","#000000")}});')),org.ekstep.pluginframework.resourceManager.loadExternalResource("/content-plugins/org.ekstep.config-1.0/editor/libs/jquery-ui.min.js","js"),org.ekstep.pluginframework.resourceManager.loadExternalResource("/content-plugins/org.ekstep.config-1.0/editor/config.css","css"),org.ekstep.pluginframework.pluginManager.registerPlugin({id:"org.ekstep.config",ver:"1.0",author:"Santhosh Vasabhaktula",title:"Config Plugin",description:"",publishedDate:"",editor:{main:"editor/plugin.js",dependencies:[{type:"js",src:"editor/libs/jquery-ui.min.js"},{type:"css",src:"editor/config.css"},{type:"plugin",plugin:"org.ekstep.colorpicker",ver:"1.0"}],sidebarMenu:[{id:"settings",type:"icon",toolTip:"Settings",title:"Settings",iconClass:"settings icon",templateURL:"editor/partials/sidebarSettingTemplate.html",controllerURL:"editor/sidebar-settings-controller.js"}]}},eval('org.ekstep.contenteditor.basePlugin.extend({type:"config",initialize:function(){org.ekstep.contenteditor.api.addEventListener("org.ekstep.config:invoke",this.invoke,this),org.ekstep.contenteditor.api.addEventListener("org.ekstep.config:toggleStageEvent",this.toggleEventToStage,this),org.ekstep.contenteditor.api.addEventListener("config:updateValue",this.updateConfig,this),org.ekstep.contenteditor.api.addEventListener("config:on:change",this._onConfigChange,this),org.ekstep.contenteditor.api.addEventListener("config:add",this.addConfig,this);var e=org.ekstep.contenteditor.api.resolvePluginResource(this.manifest.id,this.manifest.ver,"editor/colorpicker-directive.js");org.ekstep.contenteditor.api.getService(ServiceConstants.POPUP_SERVICE).loadNgModules(void 0,e)},updateConfig:function(e,t){var n=this,o=org.ekstep.contenteditor.api._.reduce(t.oldValue,function(e,n,o){return org.ekstep.contenteditor.api._.isEqual(n,t.newValue[o])?e:e.concat(o)},[]);org.ekstep.contenteditor.api._.forEach(o,function(e){n.onConfigChange(e,t.newValue[e])})},_onConfigChange:function(e,t){this.onConfigChange(t.key,t.value)},onConfigChange:function(e,t){var n=org.ekstep.contenteditor.api.getCurrentObject()?org.ekstep.contenteditor.api.getCurrentObject():org.ekstep.contenteditor.api.getCurrentStage();!org.ekstep.contenteditor.api._.isUndefined(t)&&n&&(n._onConfigChange(e,t),n.onConfigChange(e,t),"autoplay"===e&&this.toggleEventToStage("",{flag:t,id:n.id}))},invoke:function(e,t){var n=this;if("browser"==t.type||"button"==t.type){var o=t.type;org.ekstep.contenteditor.api.dispatchEvent(t.event.id,{type:t.event.type,callback:function(e){n.onConfigChange(o,e)}})}},toggleEventToStage:function(e,t){var n=org.ekstep.contenteditor.api.getCurrentStage(),o=-1;n.event&&_.forEach(n.event,function(e,n){org.ekstep.contenteditor.api._.isArray(e.action)?e.action[0].asset===t.id&&(o=n):org.ekstep.contenteditor.api._.isObject(e.action)&&e.action.asset===t.id&&(o=n)}),!0===t.flag&&-1===o?n.addEvent({type:"enter",action:[{id:UUID(),type:"command",command:"play",asset:t.id}]}):!1===t.flag&&-1!==o&&n.event.splice(o,1)}});')),org.ekstep.pluginframework.resourceManager.loadExternalResource("/content-plugins/org.ekstep.readalongbrowser-1.0/editor/libs/karaoke.js","js"),org.ekstep.pluginframework.resourceManager.loadExternalResource("/content-plugins/org.ekstep.readalongbrowser-1.0/editor/libs/jquery.scrollTo.js","js"),org.ekstep.pluginframework.resourceManager.loadExternalResource("/content-plugins/org.ekstep.readalongbrowser-1.0/editor/libs/jquery.jplayer.min.js","js"),org.ekstep.pluginframework.resourceManager.loadExternalResource("/content-plugins/org.ekstep.readalongbrowser-1.0/editor/css/jquery-ui.css","css"),org.ekstep.pluginframework.pluginManager.registerPlugin({id:"org.ekstep.readalongbrowser",ver:"1.0",shortId:"readalongbrowser",author:"Kartheek Palla",title:"Read-along Plugin",description:"",publishedDate:"",editor:{main:"editor/plugin.js",help:{src:"editor/help.md",dataType:"text"},dependencies:[{type:"js",src:"editor/libs/karaoke.js"},{type:"js",src:"editor/libs/jquery.scrollTo.js"},{type:"js",src:"editor/libs/jquery.jplayer.min.js"},{type:"css",src:"editor/css/jquery-ui.css"}],views:[{template:"./readalongbrowser.html",controller:"./readalongbrowserapp.js"}],configManifest:[{propertyName:"highlight",title:"Highlight Color",description:"Choose a color from the color picker to highlight the text",dataType:"colorpicker",required:!0,defaultValue:"#FFFF00"},{propertyName:"color",title:"Font color",description:"Choose a color from the color picker",dataType:"colorpicker",required:!0,defaultValue:"rgb(255,0,0)"},{propertyName:"font",dataType:"group",description:"Choose fontweight and fontstyle",config:[{propertyName:"fontweight",title:"Font Weight",toolTip:"Bold",description:"Select font size for the text",dataType:"icon",iconClass:"bold icon",required:!0,defaultValue:!1},{propertyName:"fontstyle",title:"Font Style",toolTip:"Italic",description:"Select font style for the text",dataType:"icon",iconClass:"italic icon",required:!0,defaultValue:!1}]},{propertyName:"fontfamily",title:"Font Family",description:"Select font family for the text",dataType:"select",range:["Arial","Courier","Georgia","Helvetica","Monospace","Sans-serif","Serif","Tahoma","Times","Trebuchet MS","Verdana","NotoSansKannada","NotoSansGujarati","NotoSansBengali","NotoSansGurmukhi","NotoSansOriya","NotoSansDevanagari","NotoSansTamil","NotoSansTelugu","NotoNastaliqUrdu","NotoSansMalayalam"],required:!0,defaultValue:"Sans-serif"},{propertyName:"fontsize",title:"Font Size",description:"Select font size for the text",dataType:"select",range:[18,20,22,24,26,28,32,36,40,44,48,54,60,66,72,80,88,96],required:!0,defaultValue:18}],playable:!0}},eval('org.ekstep.contenteditor.basePlugin.extend({type:"readalongbrowser",magicNumber:1920,editorWidth:720,currentInstance:void 0,cb:void 0,text:void 0,initialize:function(){var e=this;ecEditor.addEventListener("object:unselected",this.objectUnselected,this),ecEditor.addEventListener("delete:invoked",this.deleteObject,this),ecEditor.addEventListener(e.manifest.id+":showpopup",this.loadHtml,this),setTimeout(function(){var t=ecEditor.resolvePluginResource(e.manifest.id,e.manifest.ver,"editor/readalongbrowser.html"),r=ecEditor.resolvePluginResource(e.manifest.id,e.manifest.ver,"editor/readalongbrowserapp.js");ecEditor.getService("popup").loadNgModules(t,r)},1e3)},loadHtml:function(e,t){currentInstance=this,this.cb=t.callback,this.attributes=t.textObj.attributes,this.config=t.textObj.config,"readalong"==t.textObj.attributes.textType&&(this.editorObj=t.textObj.editorObj),ecEditor.getService("popup").open({template:"readalongbrowser",controller:"readalongbrowsercontroller",controllerAs:"$ctrl",resolve:{instance:function(){return currentInstance}},width:900,showClose:!1,closeByEscape:!1,closeByDocument:!1,className:"ngdialog-theme-plain"},function(){ecEditor._.isUndefined(currentInstance.editorObj)||currentInstance.editorObj.text||(currentInstance.editorObj.remove(),ecEditor.render())})},invokeKaraoke:function(e,t){var r=new Karaoke;if(r.audioObj.url=e,t){var i=ecEditor._.isEmpty(t.config.timings)?"":ecEditor._.split(t.config.timings,","),o=[],d=[],c=ecEditor._.split(t.attributes.__text," "),n=0;ecEditor._.each(i,function(e,t){n+=1,d.push({word:c[t],stepNo:10*parseFloat(e/1e3).toFixed(1),wordIdx:n}),o.push(parseFloat(e/1e3).toFixed(1))}),r.audioObj.url=e,r.audioObj.wordMap=d,r.audioObj.wordTimes=o,r.audioObj.highlightColor=t.config.highlight}else r.audioObj.url=e,r.audioObj.wordMap="",r.audioObj.wordTimes="",r.audioObj.highlightColor="",ecEditor.jQuery("#jplayerSync").data("jPlayer","");return ecEditor.jQuery("#syncSlider").bind("click",ecEditor.jQuery.proxy(r.changePlaybackRate,r)),ecEditor.jQuery("#changeaudio").bind("click",ecEditor.jQuery.proxy(r.res,r)),ecEditor.jQuery("#syncStart").bind("click",ecEditor.jQuery.proxy(r.startSync,r)),ecEditor.jQuery("#pick-hcolor").bind("click",ecEditor.jQuery.proxy(r.setColor,r)),ecEditor.jQuery("#stopAudio").bind("click",ecEditor.jQuery.proxy(r.stopAudio,r)),ecEditor.jQuery(".slideStep").bind("drop",ecEditor.jQuery.proxy(r.handleWordDrop,r)),ecEditor.jQuery("#syncMark").bind("click",ecEditor.jQuery.proxy(r.markWords,r)),ecEditor.jQuery("#sync-play").bind("click",ecEditor.jQuery.proxy(r.playSyncedLayer,r)),ecEditor.jQuery("#sync-pause").bind("click",ecEditor.jQuery.proxy(r.pauseAudio,r)),window.karaoke=r,r.initPlayer(),r}});')),org.ekstep.pluginframework.resourceManager.loadExternalResource("/content-plugins/org.ekstep.assetbrowser-1.4/editor/libs/sunbird-file-upload-library.js","js"),org.ekstep.pluginframework.resourceManager.loadExternalResource("/content-plugins/org.ekstep.assetbrowser-1.4/editor/recorder/wave/wavesurfer.min.js","js"),org.ekstep.pluginframework.resourceManager.loadExternalResource("/content-plugins/org.ekstep.assetbrowser-1.4/editor/recorder/angular-audio-recorder.js","js"),org.ekstep.pluginframework.resourceManager.loadExternalResource("/content-plugins/org.ekstep.assetbrowser-1.4/editor/libs/ng-tags-input.js","js"),org.ekstep.pluginframework.resourceManager.loadExternalResource("/content-plugins/org.ekstep.assetbrowser-1.4/editor/libs/ng-tags-input.css","css"),org.ekstep.pluginframework.resourceManager.loadExternalResource("/content-plugins/org.ekstep.assetbrowser-1.4/editor/libs/angular-inview.js","js"),org.ekstep.pluginframework.resourceManager.loadExternalResource("/content-plugins/org.ekstep.assetbrowser-1.4/editor/libs/video.js","js"),org.ekstep.pluginframework.resourceManager.loadExternalResource("/content-plugins/org.ekstep.assetbrowser-1.4/editor/libs/videoyoutube.js","js"),org.ekstep.pluginframework.resourceManager.loadExternalResource("/content-plugins/org.ekstep.assetbrowser-1.4/editor/libs/videojs.css","css"),org.ekstep.pluginframework.pluginManager.registerPlugin({id:"org.ekstep.assetbrowser",ver:"1.4",shortId:"assetbrowser",author:"Sunil A S",title:"Asset Browser",description:"",publishedDate:"",editor:{main:"editor/plugin.js",dependencies:[{type:"js",src:"editor/libs/sunbird-file-upload-library.js"},{type:"js",src:"editor/recorder/wave/wavesurfer.min.js"},{type:"js",src:"editor/recorder/angular-audio-recorder.js"},{type:"js",src:"editor/libs/ng-tags-input.js"},{type:"css",src:"editor/libs/ng-tags-input.css"},{type:"js",src:"editor/libs/angular-inview.js"},{type:"js",src:"editor/libs/video.js"},{type:"js",src:"editor/libs/videoyoutube.js"},{type:"css",src:"editor/libs/videojs.css"}],views:[{template:"./assetBrowser.html",controller:"./assetbrowserapp.js"}]}},eval('org.ekstep.contenteditor.basePlugin.extend({type:"assetbrowser",initData:void 0,cb:void 0,initialize:function(){var e=this;org.ekstep.contenteditor.api.addEventListener(this.manifest.id+":show",this.initPreview,this);var t=org.ekstep.contenteditor.api.resolvePluginResource(e.manifest.id,e.manifest.ver,"editor/assetBrowser.html"),i=org.ekstep.contenteditor.api.resolvePluginResource(e.manifest.id,e.manifest.ver,"editor/assetbrowserapp.js");org.ekstep.contenteditor.api.getService("popup").loadNgModules(t,i)},initPreview:function(e,t){var i=this;this.cb=t.callback,this.mediaType=t.type,this.search_filter=t.search_filter,org.ekstep.contenteditor.api.getService("popup").open({template:"partials/assetbrowser.html",controller:"browsercontroller",controllerAs:"$ctrl",resolve:{instance:function(){return i}},showClose:!1,closeByDocument:!1,closeByEscape:!1,className:"ngdialog-theme-plain"})},getAsset:function(e,t,i,r,s,n,o){var a,c,l,d=this;i&&("video"==i?(l=!_.includes(r,"Asset"),a={request:{filters:{objectType:"Content",mimeType:"video"==t?new Array("video/x-youtube","video/mp4","video/webm"):t,contentType:_.includes(r,"Asset")?new Array("Asset"):new Array("Resource"),status:new Array("Live","Review","Draft")},limit:50,offset:n}}):a={request:{filters:{mediaType:t,contentType:r,compatibilityLevel:{min:1,max:2},status:new Array("Live","Review","Draft")},limit:50,offset:n}}),org.ekstep.contenteditor.api._.isUndefined(e)||(a.request.query=e),org.ekstep.contenteditor.api._.isUndefined(s)?c=org.ekstep.contenteditor.api._.omit(this.search_filter,["mediaType","limit"]):(a.request.filters.createdBy=s,c=org.ekstep.contenteditor.api._.omit(this.search_filter,["mediaType","limit","createdBy"])),org.ekstep.contenteditor.api._.merge(a.request.filters,c);org.ekstep.contenteditor.api.getService(ServiceConstants.SEARCH_SERVICE);ecEditor.getService("search").search(a,function(e,t){if(e||"OK"!=t.data.responseCode)o(e,null);else if(_.includes(r,"Resource")&&!l){var i=_.cloneDeep(a);i.request.filters.contentType=new Array("Resource"),i.request.filters.mimeType=new Array("video/x-youtube"),d.searchAsset(i).then(function(e){var i={};_.includes(r,"Asset")&&!_.isUndefined(t.data.result.content)?(Array.prototype.push.apply(t.data.result.content,e.data.result.content),t.data.result.content=_.orderBy(t.data.result.content,["createdOn"],["desc"]),i=t):i=e,o(null,i)}).catch(function(e){o(e,null)})}else o(null,t)})},searchAsset:function(e){return new Promise(function(t,i){ecEditor.getService("search").search(e,function(e,r){e||"OK"!=r.data.responseCode?i(e):t(r)})})},showAssetBrowser:function(e,t){},fileValidation:function(e,t,i){if(window.File&&window.FileList&&window.Blob){var r=org.ekstep.contenteditor.api.jQuery("#"+e)[0].files[0].size,s=org.ekstep.contenteditor.api.jQuery("#"+e)[0].files[0].type;return r>t?(alert("File size is higher than the allowed size!"),!1):!s||(-1!=org.ekstep.contenteditor.api.jQuery.inArray(s,i)||(alert("File type is not allowed!"),!1))}return!0}});'))},function(e,t){window.assessmentBrowserUtil=function(){function e(e,t){var n,i;return t=ecEditor._.isUndefined(t)?[]:ecEditor._.isArray(t)?t:[t],ecEditor._.forEach(t,function(t){if(t.id&&t.src&&(i=ecEditor._.findIndex(e.theme.manifest.media,function(e){return e.src===t.src}),-1===(n=ecEditor._.findIndex(e.theme.manifest.media,function(e){return e.id===t.id}))&&e.theme.manifest.media.push(t),-1!==n&&-1===i)){var r={id:t.id,src:t.src,type:t.type};t.assetId&&(r.assetId=t.assetId),e.theme.manifest.media[n]=r}}),e}return{getQuestionPreviwContent:function(t,n){try{if(!t)throw"Template cannot be empty";var i={theme:{manifest:{media:[]},template:[],controller:[{name:"assessment",type:"items",id:"assessment",__cdata:{}}],startStage:"assessmentStage",id:"theme",ver:.3,stage:[{id:"baseStage",preload:!0,image:[],audio:[],voice:[]},{id:"assessmentStage",x:0,y:0,w:100,h:100,g:[{embed:{template:"item","var-item":"item"},x:10,y:0,w:80,h:90}],iterate:"assessment",var:"item"}]}};i.theme.controller[0].__cdata={total_items:1,SET_TYPE:"MATERIALISED_SET",SET_OBJECT_TYPE_KEY:"AssessmentItem",item_sets:[{id:"itemSet",count:1}],items:{itemSet:[n]},identifier:"itemSet"};var r=ecEditor._.isUndefined(t.theme.template)?[]:ecEditor._.isArray(t.theme.template)?t.theme.template:[t.theme.template];return ecEditor._.forEach(r,function(e){e&&ecEditor._.findIndex(i.theme.template,function(t){return t.id==e.id})<0&&i.theme.template.push(e)}),n.media&&(i=e(i,n.media)),ecEditor._.has(t,"theme.manifest")&&t.theme.manifest.media&&(i=e(i,t.theme.manifest.media)),i}catch(e){return{error:e}}}}}(),window.X2JS=function(e){"use strict";void 0===(e=e||{}).escapeMode&&(e.escapeMode=!0),e.attributePrefix=e.attributePrefix||"_","none"===e.attributePrefix&&(e.attributePrefix=""),e.arrayAccessForm=e.arrayAccessForm||"none",e.emptyNodeForm=e.emptyNodeForm||"text",void 0===e.enableToStringFunc&&(e.enableToStringFunc=!0),e.arrayAccessFormPaths=e.arrayAccessFormPaths||[],void 0===e.skipEmptyTextNodesForObj&&(e.skipEmptyTextNodesForObj=!0),void 0===e.stripWhitespaces&&(e.stripWhitespaces=!0),e.datetimeAccessFormPaths=e.datetimeAccessFormPaths||[],void 0===e.coerce&&(e.coerce=!0),function(){function e(e){var t=String(e);return 1===t.length&&(t="0"+t),t}"function"!=typeof String.prototype.trim&&(String.prototype.trim=function(){return this.replace(/^\s+|^\n+|(\s|\n)+$/g,"")}),"function"!=typeof Date.prototype.toISOString&&(Date.prototype.toISOString=function(){return this.getUTCFullYear()+"-"+e(this.getUTCMonth()+1)+"-"+e(this.getUTCDate())+"T"+e(this.getUTCHours())+":"+e(this.getUTCMinutes())+":"+e(this.getUTCSeconds())+"."+String((this.getUTCMilliseconds()/1e3).toFixed(3)).slice(2,5)+"Z"})}();var t={ELEMENT_NODE:1,TEXT_NODE:3,CDATA_SECTION_NODE:4,COMMENT_NODE:8,DOCUMENT_NODE:9};function n(e){var t=e.localName;return null==t&&(t=e.baseName),null!=t&&""!=t||(t=e.nodeName),t}function i(e){return"string"==typeof e?e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;"):e}function r(t,n,i){switch(e.arrayAccessForm){case"property":t[n]instanceof Array?t[n+"_asArray"]=t[n]:t[n+"_asArray"]=[t[n]]}if(!(t[n]instanceof Array)&&e.arrayAccessFormPaths.length>0){for(var r=0;r<e.arrayAccessFormPaths.length;r++){var a=e.arrayAccessFormPaths[r];if("string"==typeof a){if(a==i)break}else if(a instanceof RegExp){if(a.test(i))break}else if("function"==typeof a&&a(t,n,i))break}r!=e.arrayAccessFormPaths.length&&(t[n]=[t[n]])}}function a(e){var t=e.split(/[-T:+Z]/g),n=new Date(t[0],t[1]-1,t[2]),i=t[5].split(".");if(n.setHours(t[3],t[4],i[0]),i.length>1&&n.setMilliseconds(i[1]),t[6]&&t[7]){var r=60*t[6]+Number(t[7]);r=0+("-"==(/\d\d-\d\d:\d\d$/.test(e)?"-":"+")?-1*r:r),n.setMinutes(n.getMinutes()-r-n.getTimezoneOffset())}else-1!==e.indexOf("Z",e.length-1)&&(n=new Date(Date.UTC(n.getFullYear(),n.getMonth(),n.getDate(),n.getHours(),n.getMinutes(),n.getSeconds(),n.getMilliseconds())));return n}function o(i,l){if(i.nodeType==t.DOCUMENT_NODE){for(var u=new Object,c=i.childNodes,d=0;d<c.length;d++)(h=c.item(d)).nodeType==t.ELEMENT_NODE&&(u[p=n(h)]=o(h,p));return u}if(i.nodeType==t.ELEMENT_NODE){for((u=new Object).__cnt=0,c=i.childNodes,d=0;d<c.length;d++){var h,p=n(h=c.item(d));h.nodeType!=t.COMMENT_NODE&&(u.__cnt++,null==u[p]?(u[p]=o(h,l+"."+p),r(u,p,l+"."+p)):(null!=u[p]&&(u[p]instanceof Array||(u[p]=[u[p]],r(u,p,l+"."+p))),u[p][u[p].length]=o(h,l+"."+p)))}for(var f=0;f<i.attributes.length;f++){var g=i.attributes.item(f);u.__cnt++,u[e.attributePrefix+g.name]=s(g.value)}var m=i.prefix;return null!=m&&""!=m&&(u.__cnt++,u.__prefix=m),null!=u["#text"]&&(u.__text=u["#text"],u.__text instanceof Array&&(u.__text=u.__text.join("\n")),e.escapeMode&&(u.__text=u.__text.replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&quot;/g,'"').replace(/&#x27;/g,"'").replace(/&#x2F;/g,"/")),e.stripWhitespaces&&(u.__text=u.__text.trim()),delete u["#text"],"property"==e.arrayAccessForm&&delete u["#text_asArray"],u.__text=function(t,n,i){if(e.datetimeAccessFormPaths.length>0){for(var r=i.split(".#")[0],o=0;o<e.datetimeAccessFormPaths.length;o++){var s=e.datetimeAccessFormPaths[o];if("string"==typeof s){if(s==r)break}else if(s instanceof RegExp){if(s.test(r))break}else if("function"==typeof s&&s(obj,n,r))break}return o!=e.datetimeAccessFormPaths.length?a(t):t}return t}(u.__text,p,l+"."+p)),null!=u["#cdata-section"]&&(u.__cdata=u["#cdata-section"],delete u["#cdata-section"],"property"==e.arrayAccessForm&&delete u["#cdata-section_asArray"]),1==u.__cnt&&null!=u.__text?u=u.__text:0==u.__cnt&&"text"==e.emptyNodeForm?u="":u.__cnt>1&&null!=u.__text&&e.skipEmptyTextNodesForObj&&(e.stripWhitespaces&&""==u.__text||""==u.__text.trim())&&delete u.__text,delete u.__cnt,!e.enableToStringFunc||null==u.__text&&null==u.__cdata||(u.toString=function(){return(null!=this.__text?this.__text:"")+(null!=this.__cdata?this.__cdata:"")}),u}if(i.nodeType==t.TEXT_NODE||i.nodeType==t.CDATA_SECTION_NODE)return s(i.nodeValue)}function s(t){if(!e.coerce||""===t.trim())return t;var n=Number(t);if(!isNaN(n))return n;var i=t.toLowerCase();return"true"==i||"false"!=i&&t}function l(t,n,r,a){var o="<"+(null!=t&&null!=t.__prefix?t.__prefix+":":"")+n;if(null!=r)for(var s=0;s<r.length;s++){var l=r[s],u=t[l];e.escapeMode&&(u=i(u)),o+=" "+l.substr(e.attributePrefix.length)+"='"+u+"'"}return o+(a?"/>":">")}function u(e,t){return"</"+(null!=e.__prefix?e.__prefix+":":"")+t+">"}function c(t,n){return"property"==e.arrayAccessForm&&(r="_asArray",-1!==(i=n.toString()).indexOf(r,i.length-r.length))||0==n.toString().indexOf(e.attributePrefix)||0==n.toString().indexOf("__")||t[n]instanceof Function;var i,r}function d(e){var t=0;if(e instanceof Object)for(var n in e)c(e,n)||t++;return t}function h(t){var n=[];if(t instanceof Object)for(var i in t)-1==i.toString().indexOf("__")&&0==i.toString().indexOf(e.attributePrefix)&&n.push(i);return n}function p(t){var n="";return t instanceof Object?n+=function(t){var n="";return null!=t.__cdata&&(n+="<![CDATA["+t.__cdata+"]]>"),null!=t.__text&&(e.escapeMode?n+=i(t.__text):n+=t.__text),n}(t):null!=t&&(e.escapeMode?n+=i(t):n+=t),n}function f(e,t,n){var i="";if(0==e.length)i+=l(e,t,n,!0);else for(var r=0;r<e.length;r++)i+=l(e[r],t,h(e[r]),!1),i+=g(e[r]),i+=u(e[r],t);return i}function g(e){var t="";if(d(e)>0)for(var n in e)if(!c(e,n)){var i=e[n],r=h(i);null==i||void 0==i?t+=l(i,n,r,!0):i instanceof Object?i instanceof Array?t+=f(i,n,r):i instanceof Date?(t+=l(i,n,r,!1),t+=i.toISOString(),t+=u(i,n)):d(i)>0||null!=i.__text||null!=i.__cdata?(t+=l(i,n,r,!1),t+=g(i),t+=u(i,n)):t+=l(i,n,r,!0):(t+=l(i,n,r,!1),t+=p(i),t+=u(i,n))}return t+p(e)}this.parseXmlString=function(e){var t,n=window.ActiveXObject||"ActiveXObject"in window;if(void 0===e)return null;if(window.DOMParser){var i=new window.DOMParser,r=null;if(!n)try{r=i.parseFromString("INVALID","text/xml").childNodes[0].namespaceURI}catch(e){r=null}try{t=i.parseFromString(e,"text/xml"),null!=r&&t.getElementsByTagNameNS(r,"parsererror").length>0&&(t=null)}catch(e){t=null}}else 0==e.indexOf("<?")&&(e=e.substr(e.indexOf("?>")+2)),(t=new ActiveXObject("Microsoft.XMLDOM")).async="false",t.loadXML(e);return t},this.asArray=function(e){return e instanceof Array?e:[e]},this.toXmlDateTime=function(e){return e instanceof Date?e.toISOString():"number"==typeof e?new Date(e).toISOString():null},this.asDateTime=function(e){return"string"==typeof e?a(e):e},this.xml2json=function(e){return o(e)},this.xml_str2json=function(e){var t=this.parseXmlString(e);return null!=t?this.xml2json(t):null},this.json2xml_str=function(e){return g(e)},this.json2xml=function(e){var t=this.json2xml_str(e);return this.parseXmlString(t)},this.getVersion=function(){return"1.1.5"}},org.ekstep.pluginframework.pluginManager.registerPlugin({id:"org.ekstep.assessmentbrowser",ver:"1.1",shortId:"assessmentbrowser",author:"Santhosh Vasabhaktula",title:"AssessmentBrowser Plugin",description:"",publishedDate:"",editor:{main:"editor/plugin.js",dependencies:[{type:"plugin",plugin:"org.ekstep.conceptselector",ver:"1.1"},{type:"js",src:"editor/assessmentbrowser_util.js"},{type:"js",src:"editor/libs/xml2json.js"}]}},org.ekstep.contenteditor.basePlugin.extend({type:"assessmentbrowser",previewURL:(ecEditor.getConfig("previewURL")||"/content/preview/preview.html")+"?webview=true",callback:function(){},initialize:function(){var e=this;ecEditor.addEventListener(this.manifest.id+":show",this.showAssessmentBrowser,this),setTimeout(function(){var t=ecEditor.resolvePluginResource(e.manifest.id,e.manifest.ver,"editor/assessmentbrowser.html"),n=ecEditor.resolvePluginResource(e.manifest.id,e.manifest.ver,"editor/assessmentbrowserapp.js");ecEditor.getService("popup").loadNgModules(t,n)},1e3)},showAssessmentBrowser:function(e,t){var n=this;this.callback=t.callback,this.data=ecEditor._.isUndefined(t.data)?"":t.data,ecEditor.getService("popup").open({template:"assessmentbrowser",controller:"assessmentbrowsercontroller",controllerAs:"$ctrl",resolve:{instance:function(){return n}},width:900,showClose:!1,closeByEscape:!1,closeByDocument:!1,className:"ngdialog-theme-plain"})}}))},function(e,t,n){var i,r,a;!function(o){"use strict";r=[n(20)],void 0===(a="function"==typeof(i=function(e,t){var n={beforeShow:c,move:c,change:c,show:c,hide:c,color:!1,flat:!1,showInput:!1,allowEmpty:!1,showButtons:!0,clickoutFiresChange:!0,showInitial:!1,showPalette:!1,showPaletteOnly:!1,hideAfterPaletteSelect:!1,togglePaletteOnly:!1,showSelectionPalette:!0,localStorageKey:!1,appendTo:"body",maxSelectionSize:7,cancelText:"cancel",chooseText:"choose",togglePaletteMoreText:"more",togglePaletteLessText:"less",clearText:"Clear Color Selection",noColorSelectedText:"No Color Selected",preferredFormat:!1,className:"",containerClassName:"",replacerClassName:"",showAlpha:!1,theme:"sp-light",palette:[["#ffffff","#000000","#ff0000","#ff8000","#ffff00","#008000","#0000ff","#4b0082","#9400d3"]],selectionPalette:[],disabled:!1,offset:null},i=[],r=!!/msie/i.exec(window.navigator.userAgent),a=function(){function e(e,t){return!!~(""+e).indexOf(t)}var t=document.createElement("div").style;return t.cssText="background-color:rgba(0,0,0,.5)",e(t.backgroundColor,"rgba")||e(t.backgroundColor,"hsla")}(),o=["<div class='sp-replacer'>","<div class='sp-preview'><div class='sp-preview-inner'></div></div>","<div class='sp-dd'><i class='dropdown icon'></i></div>","</div>"].join(""),s=function(){var e="";if(r)for(var t=1;t<=6;t++)e+="<div class='sp-"+t+"'></div>";return["<div class='sp-container sp-hidden'>","<div class='sp-palette-container'>","<div class='sp-palette sp-thumb sp-cf'></div>","<div class='sp-palette-button-container sp-cf'>","<button type='button' class='sp-palette-toggle'></button>","</div>","</div>","<div class='sp-picker-container'>","<div class='sp-top sp-cf'>","<div class='sp-fill'></div>","<div class='sp-top-inner'>","<div class='sp-color'>","<div class='sp-sat'>","<div class='sp-val'>","<div class='sp-dragger'></div>","</div>","</div>","</div>","<div class='sp-clear sp-clear-display'>","</div>","<div class='sp-hue'>","<div class='sp-slider'></div>",e,"</div>","</div>","<div class='sp-alpha'><div class='sp-alpha-inner'><div class='sp-alpha-handle'></div></div></div>","</div>","<div class='sp-input-container sp-cf'>","<input class='sp-input' type='text' spellcheck='false'  />","</div>","<div class='sp-initial sp-thumb sp-cf'></div>","<div class='sp-button-container sp-cf'>","<a class='sp-cancel' href='#'></a>","<button type='button' class='sp-choose'></button>","</div>","</div>","</div>"].join("")}();function l(t,n,i,r){for(var o=[],s=0;s<t.length;s++){var l=t[s];if(l){var u=tinycolor(l),c=u.toHsl().l<.5?"sp-thumb-el sp-thumb-dark":"sp-thumb-el sp-thumb-light";c+=tinycolor.equals(n,l)?" sp-thumb-active":"";var d=u.toString(r.preferredFormat||"rgb"),h=a?"background-color:"+u.toRgbString():"filter:"+u.toFilter();o.push('<span title="'+d+'" data-color="'+u.toRgbString()+'" class="'+c+'"><span class="sp-thumb-inner" style="'+h+';" /></span>')}else o.push(e("<div />").append(e('<span data-color="" style="background-color:transparent;" class="sp-clear-display"></span>').attr("title",r.noColorSelectedText)).html())}return"<div class='sp-cf "+i+"'>"+o.join("")+"</div>"}function u(u,c){var g,m,v=function(t,i){var r=e.extend({},n,t);return r.callbacks={move:h(r.move,i),change:h(r.change,i),show:h(r.show,i),hide:h(r.hide,i),beforeShow:h(r.beforeShow,i)},r}(c,u),y=v.flat,b=v.showSelectionPalette,_=v.localStorageKey,T=v.theme,E=v.callbacks,C=(g=Fe,10,function(){var e=this,t=arguments;m||(m=setTimeout(function(){m=null,g.apply(e,t)},10))}),w=!1,k=!1,S=0,I=0,O=0,D=0,R=0,x=0,A=0,P=0,L=0,N=0,M=1,K=[],$=[],j={},B=v.selectionPalette.slice(0),F=v.maxSelectionSize,U="sp-dragging",V=null,q=u.ownerDocument,H=(q.body,e(u)),z=!1,W=e(s,q).addClass(T),G=W.find(".sp-picker-container"),X=W.find(".sp-color"),Y=W.find(".sp-dragger"),Q=W.find(".sp-hue"),J=W.find(".sp-slider"),Z=W.find(".sp-alpha-inner"),ee=W.find(".sp-alpha"),te=W.find(".sp-alpha-handle"),ne=W.find(".sp-input"),ie=W.find(".sp-palette"),re=W.find(".sp-initial"),ae=W.find(".sp-cancel"),oe=W.find(".sp-clear"),se=W.find(".sp-choose"),le=W.find(".sp-palette-toggle"),ue=H.is("input"),ce=ue&&"color"===H.attr("type")&&f(),de=ue&&!y,he=de?e(o).addClass(T).addClass(v.className).addClass(v.replacerClassName):e([]),pe=de?he:H,fe=he.find(".sp-preview-inner"),ge=v.color||ue&&H.val(),me=!1,ve=v.preferredFormat,ye=!v.showButtons||v.clickoutFiresChange,be=!ge,_e=v.allowEmpty&&!ce;function Te(){if(v.showPaletteOnly&&(v.showPalette=!0),le.text(v.showPaletteOnly?v.togglePaletteMoreText:v.togglePaletteLessText),v.palette){K=v.palette.slice(0),$=e.isArray(K[0])?K:[K],j={};for(var t=0;t<$.length;t++)for(var n=0;n<$[t].length;n++){var i=tinycolor($[t][n]).toRgbString();j[i]=!0}}W.toggleClass("sp-flat",y),W.toggleClass("sp-input-disabled",!v.showInput),W.toggleClass("sp-alpha-enabled",v.showAlpha),W.toggleClass("sp-clear-enabled",_e),W.toggleClass("sp-buttons-disabled",!v.showButtons),W.toggleClass("sp-palette-buttons-disabled",!v.togglePaletteOnly),W.toggleClass("sp-palette-disabled",!v.showPalette),W.toggleClass("sp-palette-only",v.showPaletteOnly),W.toggleClass("sp-initial-disabled",!v.showInitial),W.addClass(v.className).addClass(v.containerClassName),Fe()}function Ee(){if(_&&window.localStorage){try{var t=window.localStorage[_].split(",#");t.length>1&&(delete window.localStorage[_],e.each(t,function(e,t){Ce(t)}))}catch(e){}try{B=window.localStorage[_].split(";")}catch(e){}}}function Ce(t){if(b){var n=tinycolor(t).toRgbString();if(!j[n]&&-1===e.inArray(n,B))for(B.push(n);B.length>F;)B.shift();if(_&&window.localStorage)try{window.localStorage[_]=B.join(";")}catch(e){}}}function we(){var t=Me(),n=e.map($,function(e,n){return l(e,t,"sp-palette-row sp-palette-row-"+n,v)});Ee(),B&&n.push(l(function(){var e=[];if(v.showPalette)for(var t=0;t<B.length;t++){var n=tinycolor(B[t]).toRgbString();j[n]||e.push(B[t])}return e.reverse().slice(0,v.maxSelectionSize)}(),t,"sp-palette-row sp-palette-row-selection",v)),ie.html(n.join(""))}function ke(){if(v.showInitial){var e=me,t=Me();re.html(l([e,t],t,"sp-palette-row-initial",v))}}function Se(){(I<=0||S<=0||D<=0)&&Fe(),k=!0,W.addClass(U),V=null,H.trigger("dragstart.spectrum",[Me()])}function Ie(){k=!1,W.removeClass(U),H.trigger("dragstop.spectrum",[Me()])}function Oe(){var e=ne.val();if(null!==e&&""!==e||!_e){var t=tinycolor(e);t.isValid()?(Ne(t),Ke(),Be()):ne.addClass("sp-validation-error")}else Ne(null),Ke(),Be()}function De(){w?Pe():Re()}function Re(){var t=e.Event("beforeShow.spectrum");w?Fe():(H.trigger(t,[Me()]),!1===E.beforeShow(Me())||t.isDefaultPrevented()||(function(){for(var e=0;e<i.length;e++)i[e]&&i[e].hide()}(),w=!0,e(q).on("keydown.spectrum",xe),e(q).on("click.spectrum",Ae),e(window).on("resize.spectrum",C),he.addClass("sp-active"),W.removeClass("sp-hidden"),Fe(),$e(),me=Me(),ke(),E.show(me),H.trigger("show.spectrum",[me])))}function xe(e){27===e.keyCode&&Pe()}function Ae(e){2!=e.button&&(k||(ye?Be(!0):Le(),Pe()))}function Pe(){w&&!y&&(w=!1,e(q).off("keydown.spectrum",xe),e(q).off("click.spectrum",Ae),e(window).off("resize.spectrum",C),he.removeClass("sp-active"),W.addClass("sp-hidden"),E.hide(Me()),H.trigger("hide.spectrum",[Me()]))}function Le(){Ne(me,!0),Be(!0)}function Ne(e,t){var n,i;tinycolor.equals(e,Me())?$e():(!e&&_e?be=!0:(be=!1,i=(n=tinycolor(e)).toHsv(),P=i.h%360/360,L=i.s,N=i.v,M=i.a),$e(),n&&n.isValid()&&!t&&(ve=v.preferredFormat||n.getFormat()))}function Me(e){return e=e||{},_e&&be?null:tinycolor.fromRatio({h:P,s:L,v:N,a:Math.round(1e3*M)/1e3},{format:e.format||ve})}function Ke(){$e(),E.move(Me()),H.trigger("move.spectrum",[Me()])}function $e(){ne.removeClass("sp-validation-error"),je();var e=tinycolor.fromRatio({h:P,s:1,v:1});X.css("background-color",e.toHexString());var t=ve;M<1&&(0!==M||"name"!==t)&&("hex"!==t&&"hex3"!==t&&"hex6"!==t&&"name"!==t||(t="rgb"));var n=Me({format:t}),i="";if(fe.removeClass("sp-clear-display"),fe.css("background-color","transparent"),!n&&_e)fe.addClass("sp-clear-display");else{var o=n.toHexString(),s=n.toRgbString();if(a||1===n.alpha?fe.css("background-color",s):(fe.css("background-color","transparent"),fe.css("filter",n.toFilter())),v.showAlpha){var l=n.toRgb();l.a=0;var u=tinycolor(l).toRgbString(),c="linear-gradient(left, "+u+", "+o+")";r?Z.css("filter",tinycolor(u).toFilter({gradientType:1},o)):(Z.css("background","-webkit-"+c),Z.css("background","-moz-"+c),Z.css("background","-ms-"+c),Z.css("background","linear-gradient(to right, "+u+", "+o+")"))}i=n.toString(t)}v.showInput&&ne.val(i),v.showPalette&&we(),ke()}function je(){var e=L,t=N;if(_e&&be)te.hide(),J.hide(),Y.hide();else{te.show(),J.show(),Y.show();var n=e*S,i=I-t*I;n=Math.max(-O,Math.min(S-O,n-O)),i=Math.max(-O,Math.min(I-O,i-O)),Y.css({top:i+"px",left:n+"px"});var r=M*R;te.css({left:r-x/2+"px"});var a=P*D;J.css({top:a-A+"px"})}}function Be(e){var t=Me(),n="",i=!tinycolor.equals(t,me);t&&(n=t.toString(ve),Ce(t)),ue&&H.val(n),e&&i&&(E.change(t),H.trigger("change",[t]))}function Fe(){var t,n,i,r,a,o,s,l,u,c,d,h;w&&(S=X.width(),I=X.height(),O=Y.height(),Q.width(),D=Q.height(),A=J.height(),R=ee.width(),x=te.width(),y||(W.css("position","absolute"),v.offset?W.offset(v.offset):W.offset((n=pe,i=(t=W).outerWidth(),r=t.outerHeight(),a=n.outerHeight(),l=(s=(o=t[0].ownerDocument).documentElement).clientWidth+e(o).scrollLeft(),u=s.clientHeight+e(o).scrollTop(),d=(c=n.offset()).left,h=c.top,h+=a,d-=Math.min(d,d+i>l&&l>i?Math.abs(d+i-l):0),{top:h-=Math.min(h,h+r>u&&u>r?Math.abs(r+a-0):0),bottom:c.bottom,left:d,right:c.right,width:c.width,height:c.height}))),je(),v.showPalette&&we(),H.trigger("reflow.spectrum"))}function Ue(){Pe(),z=!0,H.attr("disabled",!0),pe.addClass("sp-disabled")}!function(){if(r&&W.find("*:not(input)").attr("unselectable","on"),Te(),de&&H.after(he).hide(),_e||oe.hide(),y)H.after(W).hide();else{var t="parent"===v.appendTo?H.parent():e(v.appendTo);1!==t.length&&(t=e("body")),t.append(W)}function n(t){return t.data&&t.data.ignore?(Ne(e(t.target).closest(".sp-thumb-el").data("color")),Ke()):(Ne(e(t.target).closest(".sp-thumb-el").data("color")),Ke(),v.hideAfterPaletteSelect?(Be(!0),Pe()):Be()),!1}Ee(),pe.on("click.spectrum touchstart.spectrum",function(t){z||De(),t.stopPropagation(),e(t.target).is("input")||t.preventDefault()}),(H.is(":disabled")||!0===v.disabled)&&Ue(),W.click(d),ne.change(Oe),ne.on("paste",function(){setTimeout(Oe,1)}),ne.keydown(function(e){13==e.keyCode&&Oe()}),ae.text(v.cancelText),ae.on("click.spectrum",function(e){e.stopPropagation(),e.preventDefault(),Le(),Pe()}),oe.attr("title",v.clearText),oe.on("click.spectrum",function(e){e.stopPropagation(),e.preventDefault(),be=!0,Ke(),y&&Be(!0)}),se.text(v.chooseText),se.on("click.spectrum",function(e){e.stopPropagation(),e.preventDefault(),r&&ne.is(":focus")&&ne.trigger("change"),ne.hasClass("sp-validation-error")||(Be(!0),Pe())}),le.text(v.showPaletteOnly?v.togglePaletteMoreText:v.togglePaletteLessText),le.on("click.spectrum",function(e){e.stopPropagation(),e.preventDefault(),v.showPaletteOnly=!v.showPaletteOnly,v.showPaletteOnly||y||W.css("left","-="+(G.outerWidth(!0)+5)),Te()}),p(ee,function(e,t,n){M=e/R,be=!1,n.shiftKey&&(M=Math.round(10*M)/10),Ke()},Se,Ie),p(Q,function(e,t){P=parseFloat(t/D),be=!1,v.showAlpha||(M=1),Ke()},Se,Ie),p(X,function(e,t,n){if(n.shiftKey){if(!V){var i=L*S,r=I-N*I,a=Math.abs(e-i)>Math.abs(t-r);V=a?"x":"y"}}else V=null;var o=!V||"y"===V;(!V||"x"===V)&&(L=parseFloat(e/S)),o&&(N=parseFloat((I-t)/I)),be=!1,v.showAlpha||(M=1),Ke()},Se,Ie),ge?(Ne(ge),$e(),ve=v.preferredFormat||tinycolor(ge).format,Ce(ge)):$e(),y&&Re();var i=r?"mousedown.spectrum":"click.spectrum touchstart.spectrum";ie.on(i,".sp-thumb-el",n),re.on(i,".sp-thumb-el:nth-child(1)",{ignore:!0},n)}();var Ve={show:Re,hide:Pe,toggle:De,reflow:Fe,option:function(n,i){return n===t?e.extend({},v):i===t?v[n]:(v[n]=i,"preferredFormat"===n&&(ve=v.preferredFormat),void Te())},enable:function(){z=!1,H.attr("disabled",!1),pe.removeClass("sp-disabled")},disable:Ue,offset:function(e){v.offset=e,Fe()},set:function(e){Ne(e),Be()},get:Me,destroy:function(){H.show(),pe.off("click.spectrum touchstart.spectrum"),W.remove(),he.remove(),i[Ve.id]=null},container:W};return Ve.id=i.push(Ve)-1,Ve}function c(){}function d(e){e.stopPropagation()}function h(e,t){var n=Array.prototype.slice,i=n.call(arguments,2);return function(){return e.apply(t,i.concat(n.call(arguments)))}}function p(t,n,i,a){n=n||function(){},i=i||function(){},a=a||function(){};var o=document,s=!1,l={},u=0,c=0,d="ontouchstart"in window,h={};function p(e){e.stopPropagation&&e.stopPropagation(),e.preventDefault&&e.preventDefault(),e.returnValue=!1}function f(e){if(s){if(r&&o.documentMode<9&&!e.button)return g();var i=e.originalEvent&&e.originalEvent.touches&&e.originalEvent.touches[0],a=i&&i.pageX||e.pageX,h=i&&i.pageY||e.pageY,f=Math.max(0,Math.min(a-l.left,c)),m=Math.max(0,Math.min(h-l.top,u));d&&p(e),n.apply(t,[f,m,e])}}function g(){s&&(e(o).off(h),e(o.body).removeClass("sp-dragging"),setTimeout(function(){a.apply(t,arguments)},0)),s=!1}h.selectstart=p,h.dragstart=p,h["touchmove mousemove"]=f,h["touchend mouseup"]=g,e(t).on("touchstart mousedown",function(n){(n.which?3==n.which:2==n.button)||s||!1!==i.apply(t,arguments)&&(s=!0,u=e(t).height(),c=e(t).width(),l=e(t).offset(),e(o).on(h),e(o.body).addClass("sp-dragging"),f(n),p(n))})}function f(){return e.fn.spectrum.inputTypeColorSupport()}e.fn.spectrum=function(t,n){if("string"==typeof t){var r=this,a=Array.prototype.slice.call(arguments,1);return this.each(function(){var n=i[e(this).data("spectrum.id")];if(n){var o=n[t];if(!o)throw new Error("Spectrum: no such method: '"+t+"'");"get"==t?r=n.get():"container"==t?r=n.container:"option"==t?r=n.option.apply(n,a):"destroy"==t?(n.destroy(),e(this).removeData("spectrum.id")):o.apply(n,a)}}),r}return this.spectrum("destroy").each(function(){var n=u(this,e.extend({},e(this).data(),t));e(this).data("spectrum.id",n.id)})},e.fn.spectrum.load=!0,e.fn.spectrum.loadOpts={},e.fn.spectrum.draggable=p,e.fn.spectrum.defaults=n,e.fn.spectrum.inputTypeColorSupport=function t(){if(void 0===t._cachedResult){var n=e("<input type='color'/>")[0];t._cachedResult="color"===n.type&&""!==n.value}return t._cachedResult},e.spectrum={},e.spectrum.localization={},e.spectrum.palettes={},e.fn.spectrum.processNativeColorInputs=function(){var t=e("input[type=color]");t.length&&!f()&&t.spectrum({preferredFormat:"hex6"})},function(){var e=/^[\s,#]+/,t=/\s+$/,n=0,i=Math,r=i.round,a=i.min,o=i.max,s=i.random,l=function(s,u){if(s=s||"",u=u||{},s instanceof l)return s;if(!(this instanceof l))return new l(s,u);var c=function(n){var r,s,l,u={r:0,g:0,b:0},c=1,d=!1,h=!1;return"string"==typeof n&&(n=function(n){n=n.replace(e,"").replace(t,"").toLowerCase();var i,r,a=!1;if(S[n])n=S[n],a=!0;else if("transparent"==n)return{r:0,g:0,b:0,a:0,format:"name"};return(i=K.rgb.exec(n))?{r:i[1],g:i[2],b:i[3]}:(i=K.rgba.exec(n))?{r:i[1],g:i[2],b:i[3],a:i[4]}:(i=K.hsl.exec(n))?{h:i[1],s:i[2],l:i[3]}:(i=K.hsla.exec(n))?{h:i[1],s:i[2],l:i[3],a:i[4]}:(i=K.hsv.exec(n))?{h:i[1],s:i[2],v:i[3]}:(i=K.hsva.exec(n))?{h:i[1],s:i[2],v:i[3],a:i[4]}:(i=K.hex8.exec(n))?{a:(r=i[1],x(r)/255),r:x(i[2]),g:x(i[3]),b:x(i[4]),format:a?"name":"hex8"}:(i=K.hex6.exec(n))?{r:x(i[1]),g:x(i[2]),b:x(i[3]),format:a?"name":"hex"}:!!(i=K.hex3.exec(n))&&{r:x(i[1]+""+i[1]),g:x(i[2]+""+i[2]),b:x(i[3]+""+i[3]),format:a?"name":"hex"}}(n)),"object"==typeof n&&(n.hasOwnProperty("r")&&n.hasOwnProperty("g")&&n.hasOwnProperty("b")?(r=n.r,s=n.g,l=n.b,u={r:255*D(r,255),g:255*D(s,255),b:255*D(l,255)},d=!0,h="%"===String(n.r).substr(-1)?"prgb":"rgb"):n.hasOwnProperty("h")&&n.hasOwnProperty("s")&&n.hasOwnProperty("v")?(n.s=P(n.s),n.v=P(n.v),u=function(e,t,n){e=6*D(e,360),t=D(t,100),n=D(n,100);var r=i.floor(e),a=e-r,o=n*(1-t),s=n*(1-a*t),l=n*(1-(1-a)*t),u=r%6;return{r:255*[n,s,o,o,l,n][u],g:255*[l,n,n,s,o,o][u],b:255*[o,o,l,n,n,s][u]}}(n.h,n.s,n.v),d=!0,h="hsv"):n.hasOwnProperty("h")&&n.hasOwnProperty("s")&&n.hasOwnProperty("l")&&(n.s=P(n.s),n.l=P(n.l),u=function(e,t,n){var i,r,a;function o(e,t,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?e+6*(t-e)*n:n<.5?t:n<2/3?e+(t-e)*(2/3-n)*6:e}if(e=D(e,360),t=D(t,100),n=D(n,100),0===t)i=r=a=n;else{var s=n<.5?n*(1+t):n+t-n*t,l=2*n-s;i=o(l,s,e+1/3),r=o(l,s,e),a=o(l,s,e-1/3)}return{r:255*i,g:255*r,b:255*a}}(n.h,n.s,n.l),d=!0,h="hsl"),n.hasOwnProperty("a")&&(c=n.a)),c=O(c),{ok:d,format:n.format||h,r:a(255,o(u.r,0)),g:a(255,o(u.g,0)),b:a(255,o(u.b,0)),a:c}}(s);this._originalInput=s,this._r=c.r,this._g=c.g,this._b=c.b,this._a=c.a,this._roundA=r(1e3*this._a)/1e3,this._format=u.format||c.format,this._gradientType=u.gradientType,this._r<1&&(this._r=r(this._r)),this._g<1&&(this._g=r(this._g)),this._b<1&&(this._b=r(this._b)),this._ok=c.ok,this._tc_id=n++};function u(e,t,n){e=D(e,255),t=D(t,255),n=D(n,255);var i,r,s=o(e,t,n),l=a(e,t,n),u=(s+l)/2;if(s==l)i=r=0;else{var c=s-l;switch(r=u>.5?c/(2-s-l):c/(s+l),s){case e:i=(t-n)/c+(t<n?6:0);break;case t:i=(n-e)/c+2;break;case n:i=(e-t)/c+4}i/=6}return{h:i,s:r,l:u}}function c(e,t,n){e=D(e,255),t=D(t,255),n=D(n,255);var i,r,s=o(e,t,n),l=a(e,t,n),u=s,c=s-l;if(r=0===s?0:c/s,s==l)i=0;else{switch(s){case e:i=(t-n)/c+(t<n?6:0);break;case t:i=(n-e)/c+2;break;case n:i=(e-t)/c+4}i/=6}return{h:i,s:r,v:u}}function d(e,t,n,i){var a=[A(r(e).toString(16)),A(r(t).toString(16)),A(r(n).toString(16))];return i&&a[0].charAt(0)==a[0].charAt(1)&&a[1].charAt(0)==a[1].charAt(1)&&a[2].charAt(0)==a[2].charAt(1)?a[0].charAt(0)+a[1].charAt(0)+a[2].charAt(0):a.join("")}function h(e,t,n,i){var a;return[A((a=i,Math.round(255*parseFloat(a)).toString(16))),A(r(e).toString(16)),A(r(t).toString(16)),A(r(n).toString(16))].join("")}function p(e,t){t=0===t?0:t||10;var n=l(e).toHsl();return n.s-=t/100,n.s=R(n.s),l(n)}function f(e,t){t=0===t?0:t||10;var n=l(e).toHsl();return n.s+=t/100,n.s=R(n.s),l(n)}function g(e){return l(e).desaturate(100)}function m(e,t){t=0===t?0:t||10;var n=l(e).toHsl();return n.l+=t/100,n.l=R(n.l),l(n)}function v(e,t){t=0===t?0:t||10;var n=l(e).toRgb();return n.r=o(0,a(255,n.r-r(-t/100*255))),n.g=o(0,a(255,n.g-r(-t/100*255))),n.b=o(0,a(255,n.b-r(-t/100*255))),l(n)}function y(e,t){t=0===t?0:t||10;var n=l(e).toHsl();return n.l-=t/100,n.l=R(n.l),l(n)}function b(e,t){var n=l(e).toHsl(),i=(r(n.h)+t)%360;return n.h=i<0?360+i:i,l(n)}function _(e){var t=l(e).toHsl();return t.h=(t.h+180)%360,l(t)}function T(e){var t=l(e).toHsl(),n=t.h;return[l(e),l({h:(n+120)%360,s:t.s,l:t.l}),l({h:(n+240)%360,s:t.s,l:t.l})]}function E(e){var t=l(e).toHsl(),n=t.h;return[l(e),l({h:(n+90)%360,s:t.s,l:t.l}),l({h:(n+180)%360,s:t.s,l:t.l}),l({h:(n+270)%360,s:t.s,l:t.l})]}function C(e){var t=l(e).toHsl(),n=t.h;return[l(e),l({h:(n+72)%360,s:t.s,l:t.l}),l({h:(n+216)%360,s:t.s,l:t.l})]}function w(e,t,n){t=t||6,n=n||30;var i=l(e).toHsl(),r=360/n,a=[l(e)];for(i.h=(i.h-(r*t>>1)+720)%360;--t;)i.h=(i.h+r)%360,a.push(l(i));return a}function k(e,t){t=t||6;for(var n=l(e).toHsv(),i=n.h,r=n.s,a=n.v,o=[],s=1/t;t--;)o.push(l({h:i,s:r,v:a})),a=(a+s)%1;return o}l.prototype={isDark:function(){return this.getBrightness()<128},isLight:function(){return!this.isDark()},isValid:function(){return this._ok},getOriginalInput:function(){return this._originalInput},getFormat:function(){return this._format},getAlpha:function(){return this._a},getBrightness:function(){var e=this.toRgb();return(299*e.r+587*e.g+114*e.b)/1e3},setAlpha:function(e){return this._a=O(e),this._roundA=r(1e3*this._a)/1e3,this},toHsv:function(){var e=c(this._r,this._g,this._b);return{h:360*e.h,s:e.s,v:e.v,a:this._a}},toHsvString:function(){var e=c(this._r,this._g,this._b),t=r(360*e.h),n=r(100*e.s),i=r(100*e.v);return 1==this._a?"hsv("+t+", "+n+"%, "+i+"%)":"hsva("+t+", "+n+"%, "+i+"%, "+this._roundA+")"},toHsl:function(){var e=u(this._r,this._g,this._b);return{h:360*e.h,s:e.s,l:e.l,a:this._a}},toHslString:function(){var e=u(this._r,this._g,this._b),t=r(360*e.h),n=r(100*e.s),i=r(100*e.l);return 1==this._a?"hsl("+t+", "+n+"%, "+i+"%)":"hsla("+t+", "+n+"%, "+i+"%, "+this._roundA+")"},toHex:function(e){return d(this._r,this._g,this._b,e)},toHexString:function(e){return"#"+this.toHex(e)},toHex8:function(){return h(this._r,this._g,this._b,this._a)},toHex8String:function(){return"#"+this.toHex8()},toRgb:function(){return{r:r(this._r),g:r(this._g),b:r(this._b),a:this._a}},toRgbString:function(){return 1==this._a?"rgb("+r(this._r)+", "+r(this._g)+", "+r(this._b)+")":"rgba("+r(this._r)+", "+r(this._g)+", "+r(this._b)+", "+this._roundA+")"},toPercentageRgb:function(){return{r:r(100*D(this._r,255))+"%",g:r(100*D(this._g,255))+"%",b:r(100*D(this._b,255))+"%",a:this._a}},toPercentageRgbString:function(){return 1==this._a?"rgb("+r(100*D(this._r,255))+"%, "+r(100*D(this._g,255))+"%, "+r(100*D(this._b,255))+"%)":"rgba("+r(100*D(this._r,255))+"%, "+r(100*D(this._g,255))+"%, "+r(100*D(this._b,255))+"%, "+this._roundA+")"},toName:function(){return 0===this._a?"transparent":!(this._a<1)&&(I[d(this._r,this._g,this._b,!0)]||!1)},toFilter:function(e){var t="#"+h(this._r,this._g,this._b,this._a),n=t,i=this._gradientType?"GradientType = 1, ":"";e&&(n=l(e).toHex8String());return"progid:DXImageTransform.Microsoft.gradient("+i+"startColorstr="+t+",endColorstr="+n+")"},toString:function(e){var t=!!e;e=e||this._format;var n=!1,i=this._a<1&&this._a>=0;return!t&&i&&("hex"===e||"hex6"===e||"hex3"===e||"name"===e)?"name"===e&&0===this._a?this.toName():this.toRgbString():("rgb"===e&&(n=this.toRgbString()),"prgb"===e&&(n=this.toPercentageRgbString()),"hex"!==e&&"hex6"!==e||(n=this.toHexString()),"hex3"===e&&(n=this.toHexString(!0)),"hex8"===e&&(n=this.toHex8String()),"name"===e&&(n=this.toName()),"hsl"===e&&(n=this.toHslString()),"hsv"===e&&(n=this.toHsvString()),n||this.toHexString())},_applyModification:function(e,t){var n=e.apply(null,[this].concat([].slice.call(t)));return this._r=n._r,this._g=n._g,this._b=n._b,this.setAlpha(n._a),this},lighten:function(){return this._applyModification(m,arguments)},brighten:function(){return this._applyModification(v,arguments)},darken:function(){return this._applyModification(y,arguments)},desaturate:function(){return this._applyModification(p,arguments)},saturate:function(){return this._applyModification(f,arguments)},greyscale:function(){return this._applyModification(g,arguments)},spin:function(){return this._applyModification(b,arguments)},_applyCombination:function(e,t){return e.apply(null,[this].concat([].slice.call(t)))},analogous:function(){return this._applyCombination(w,arguments)},complement:function(){return this._applyCombination(_,arguments)},monochromatic:function(){return this._applyCombination(k,arguments)},splitcomplement:function(){return this._applyCombination(C,arguments)},triad:function(){return this._applyCombination(T,arguments)},tetrad:function(){return this._applyCombination(E,arguments)}},l.fromRatio=function(e,t){if("object"==typeof e){var n={};for(var i in e)e.hasOwnProperty(i)&&(n[i]="a"===i?e[i]:P(e[i]));e=n}return l(e,t)},l.equals=function(e,t){return!(!e||!t)&&l(e).toRgbString()==l(t).toRgbString()},l.random=function(){return l.fromRatio({r:s(),g:s(),b:s()})},l.mix=function(e,t,n){n=0===n?0:n||50;var i,r=l(e).toRgb(),a=l(t).toRgb(),o=n/100,s=2*o-1,u=a.a-r.a,c=1-(i=((i=s*u==-1?s:(s+u)/(1+s*u))+1)/2),d={r:a.r*i+r.r*c,g:a.g*i+r.g*c,b:a.b*i+r.b*c,a:a.a*o+r.a*(1-o)};return l(d)},l.readability=function(e,t){var n=l(e),i=l(t),r=n.toRgb(),a=i.toRgb(),o=n.getBrightness(),s=i.getBrightness(),u=Math.max(r.r,a.r)-Math.min(r.r,a.r)+Math.max(r.g,a.g)-Math.min(r.g,a.g)+Math.max(r.b,a.b)-Math.min(r.b,a.b);return{brightness:Math.abs(o-s),color:u}},l.isReadable=function(e,t){var n=l.readability(e,t);return n.brightness>125&&n.color>500},l.mostReadable=function(e,t){for(var n=null,i=0,r=!1,a=0;a<t.length;a++){var o=l.readability(e,t[a]),s=o.brightness>125&&o.color>500,u=o.brightness/125*3+o.color/500;(s&&!r||s&&r&&u>i||!s&&!r&&u>i)&&(r=s,i=u,n=l(t[a]))}return n};var S=l.names={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"0ff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000",blanchedalmond:"ffebcd",blue:"00f",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",burntsienna:"ea7e5d",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"0ff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkgrey:"a9a9a9",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkslategrey:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dimgrey:"696969",dodgerblue:"1e90ff",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"f0f",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",grey:"808080",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgray:"d3d3d3",lightgreen:"90ee90",lightgrey:"d3d3d3",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslategray:"789",lightslategrey:"789",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"0f0",limegreen:"32cd32",linen:"faf0e6",magenta:"f0f",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370db",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"db7093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",rebeccapurple:"663399",red:"f00",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",slategrey:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",wheat:"f5deb3",white:"fff",whitesmoke:"f5f5f5",yellow:"ff0",yellowgreen:"9acd32"},I=l.hexNames=function(e){var t={};for(var n in e)e.hasOwnProperty(n)&&(t[e[n]]=n);return t}(S);function O(e){return e=parseFloat(e),(isNaN(e)||e<0||e>1)&&(e=1),e}function D(e,t){(function(e){return"string"==typeof e&&-1!=e.indexOf(".")&&1===parseFloat(e)})(e)&&(e="100%");var n=function(e){return"string"==typeof e&&-1!=e.indexOf("%")}(e);return e=a(t,o(0,parseFloat(e))),n&&(e=parseInt(e*t,10)/100),i.abs(e-t)<1e-6?1:e%t/parseFloat(t)}function R(e){return a(1,o(0,e))}function x(e){return parseInt(e,16)}function A(e){return 1==e.length?"0"+e:""+e}function P(e){return e<=1&&(e=100*e+"%"),e}var L,N,M,K=(N="[\\s|\\(]+("+(L="(?:[-\\+]?\\d*\\.\\d+%?)|(?:[-\\+]?\\d+%?)")+")[,|\\s]+("+L+")[,|\\s]+("+L+")\\s*\\)?",M="[\\s|\\(]+("+L+")[,|\\s]+("+L+")[,|\\s]+("+L+")[,|\\s]+("+L+")\\s*\\)?",{rgb:new RegExp("rgb"+N),rgba:new RegExp("rgba"+M),hsl:new RegExp("hsl"+N),hsla:new RegExp("hsla"+M),hsv:new RegExp("hsv"+N),hsva:new RegExp("hsva"+M),hex3:/^([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex8:/^([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/});window.tinycolor=l}(),e(function(){e.fn.spectrum.load&&e.fn.spectrum.processNativeColorInputs()})})?i.apply(t,r):i)||(e.exports=a)}(),org.ekstep.pluginframework.pluginManager.registerPlugin({id:"org.ekstep.colorpicker",ver:"1.0",author:"Chetan Sachdev",title:"Colorpicker Plugin",description:"",publishedDate:"",editor:{main:"editor/plugin.js",dependencies:[{type:"js",src:"editor/libs/spectrum.js"},{type:"css",src:"editor/libs/spectrum.css"},{type:"css",src:"editor/colorpickerplugin.css"}],menu:[]},renderer:{}},org.ekstep.contenteditor.basePlugin.extend({type:"colorpicker",picker:[],initialize:function(){ecEditor.addEventListener("colorpicker:state",this.invoke,this)},invoke:function(e,t){var n=this;"added"!=ecEditor.jQuery("#"+t.id+" input").attr("colorpicker")&&(this.picker[t.id]=ecEditor.jQuery("#"+t.id+" input").spectrum({color:"#FF0000",color:"blanchedalmond",showInput:!0,showAlpha:!1,preferredFormat:"hex",showButtons:!1,showButtons:!0,containerClassName:"awesome",clickoutFiresChange:!1,change:function(e){t.callback(t.id,e.toHexString()),ecEditor.getService(ServiceConstants.TELEMETRY_SERVICE).interact({id:"button",type:"click",subtype:"change",target:"colorpicker",pluginid:n.manifest.id,pluginver:n.manifest.ver,objectid:t.id,stage:ecEditor.getCurrentStage().id})},showPaletteOnly:!0,togglePaletteOnly:!0,togglePaletteMoreText:"more",togglePaletteLessText:"less",palette:[["#000","#444","#666","#999","#ccc","#eee","#f3f3f3","#fff"],["#f00","#f90","#ff0","#0f0","#0ff","#00f","#90f","#f0f"],["#f4cccc","#fce5cd","#fff2cc","#d9ead3","#d0e0e3","#cfe2f3","#d9d2e9","#ead1dc"],["#ea9999","#f9cb9c","#ffe599","#b6d7a8","#a2c4c9","#9fc5e8","#b4a7d6","#d5a6bd"],["#e06666","#f6b26b","#ffd966","#93c47d","#76a5af","#6fa8dc","#8e7cc3","#c27ba0"],["#c00","#e69138","#f1c232","#6aa84f","#45818e","#3d85c6","#674ea7","#a64d79"],["#900","#b45f06","#bf9000","#38761d","#134f5c","#0b5394","#351c75","#741b47"],["#600","#783f04","#7f6000","#274e13","#0c343d","#073763","#20124d","#4c1130"]],maxSelectionSize:10,hideAfterPaletteSelect:!0,move:function(e){t.callback(t.id,e.toHexString()),ecEditor.getService(ServiceConstants.TELEMETRY_SERVICE).interact({type:"click",subtype:"move",target:"colorpicker",pluginid:n.manifest.id,pluginver:n.manifest.ver,objectid:t.id,stage:ecEditor.getCurrentStage().id})}}),ecEditor.jQuery("#"+t.id+" input").attr("colorpicker","added")),t&&t.color?ecEditor.jQuery("#"+t.id+" input").spectrum("set",t.color):ecEditor.jQuery("#"+t.id+" input").spectrum("set","#000000")}}))},function(e,t){(function(){$.fn.treePicker=function(e){var t,n,i,r,a,o,s,l,u,c,d,h,p,f,g,m,v,y,b,_,T,E,C,w;return w=$(this),p=[],d=[],_={},0!=$("#"+e.nodeName).length&&$("#"+e.nodeName).remove(),l=$("<div id="+e.nodeName+' class="ui tree-picker small modal">\n  <div class="header">\n    '+e.name+'\n\n    <div class="ui menu">\n      <a class="active tree item">\n        <i class="list icon"></i> Concepts\n      </a>\n      <a class="picked item">\n        <i class="checkmark icon"></i> Selected Concepts <span class="count"></span>\n      </a>\n    </div>\n  </div>\n  <div class="ui search form">\n    <div class="field">\n      <div class="ui icon input">\n        <input type="text" placeholder="Search">\n        <i class="search icon"></i>\n      </div>\n    </div>\n  </div>\n  <div class="content">\n    <div class="ui active inverted dimmer"><div class="ui text loader">Loading data</div></div>\n    <div class="tree-tab">\n      <div style="height: 300px"></div>\n    </div>\n\n    <div class="search-tab">\n    </div>\n\n    <div class="picked-tab">\n    </div>\n  </div>\n  <div class="actions">\n    <a class="pick-search"><i class="checkmark icon"></i> Choose All</a>\n    <a class="unpick-search"><i class="remove icon"></i> Remove All</a>\n    <a class="unpick-picked"><i class="remove icon"></i> Remove All</a>\n    \n    <a class="ui button close cancel">Cancel</a>\n<a class="ui blue button accept">Done</a>\n  </div>\n</div>').modal({duration:200,closable:!1,allowMultiple:!0,onDeny:function(){return n.onCancel&&n.onCancel(),!0}}),i=$(".count",l),_={tree:$(".tree-tab",l),search:$(".search-tab",l),picked:$(".picked-tab",l)},t={pickSearch:$(".actions .pick-search",l),unpickSearch:$(".actions .unpick-search",l),unpickPicked:$(".actions .unpick-picked",l)},n={childrenKey:"nodes",singlePick:!1,minSearchQueryLength:3,hidden:function(e){return!1},disabled:function(e){return!1},displayFormat:function(t){return e.name+" (Выбрано "+t.length+")"},onCancel:function(){return!1}},$.extend(n,e),r=function(){return console.log("Concept selector initializing...."),n.data&&(d=n.data),n.picked?n.picked=n.picked:w.attr("data-picked-ids")&&w.attr("data-picked-ids").split(","),n.picked?d.length?(C(),w.html(n.displayFormat(p))):w.html(n.displayFormat(n.picked)):w.html(n.displayFormat([])),w.unbind("click"),w.on("click",function(e){return console.log("click event received",d),l.modal("show"),b(),d.length?($(".ui.active.dimmer",l).removeClass("active"),o(d)):n.url?s(n.url,{},function(e){return $(".ui.active.dimmer",l).removeClass("active"),o(e)}):void 0}),$(".actions .accept",l).on("click",function(e){return l.modal("hide"),n.onSubmit&&n.onSubmit(p),w.html(n.displayFormat(p))}),t.pickSearch.on("click",function(e){return $(".search-tab .node:not(.picked) .name",l).trigger("click")}),t.unpickSearch.on("click",function(e){return $(".search-tab .node.picked .name",l).trigger("click")}),t.unpickPicked.on("click",function(e){var t;$(".node.picked",l).removeClass("picked"),p=n.picked=[],E(),t=m([],{height:"300px",overflowY:"auto"}),_.picked.show().html(t)}),$(".menu .tree",l).on("click",function(e){return b()}),$(".menu .picked",l).on("click",function(e){return v()}),console.log("Concept selector initialized"),$(".search input",l).on("keyup",function(e){return y($(this).val())})},s=function(e,t,n){return null==t&&(t={}),$.get(e,t,function(e){return d=e.constructor===String?$.parseJSON(e):e,n(d)})},o=function(e){var t;return C(),t=m(e,{height:"300px",overflowY:"auto"}),_.tree.html(t),a(t)},C=function(){var e,t,i,r,a,o;if(n.picked){for(p=[],a=[],e=0,i=(r=n.picked).length;e<i;e++)t=r[e],(o=f(d,function(e){return""+e.id==""+t})).length?a.push(p.push(o[0])):a.push(void 0);return a}},b=function(){return $(".menu .item",l).removeClass("active"),$(".menu .tree",l).addClass("active"),_.tree.show(),_.search.hide(),_.picked.hide(),l.attr("data-mode","tree")},y=function(e){var t,i,r=[];return null!==e&&e.length>=n.minSearchQueryLength?(t=f(d,function(t){return t.name&&t.name.toLowerCase().indexOf(e.toLowerCase())>-1}),ecEditor._.forEach(t,function(e){"selectable"===e.selectable&&r.push(e)}),i=g(t=r,{height:"300px",overflowY:"auto"}),$(".menu .item",l).removeClass("active"),_.search.show().html(i),_.tree.hide(),_.picked.hide(),l.attr("data-mode","search"),a(i),$(".name",i).each(function(){var t,n;return t=$(this).text(),n=RegExp("("+e+")","gi"),t=t.replace(n,"<strong class='search-query'>$1</strong>"),$(this).html(t)})):b()},v=function(){var e;return e=g(p,{height:"300px",overflowY:"auto"}),$(".menu .item",l).removeClass("active"),$(".menu .picked",l).addClass("active"),_.picked.show().html(e),_.tree.hide(),_.search.hide(),l.attr("data-mode","picked"),initializeNodeListForSelected(e)},m=function(e,t){var i,r,a,o,s;for(null==t&&(t={}),s=$('<div class="ui tree-picker tree"></div>').css(t),i=0,r=e.length;i<r;i++)a=e[i],n.hidden(a)||(o=$('<div class="node" data-id="'+a.id+'" data-name="'+a.name+'">\n  <div class="head '+a.selectable+'">\n    <i class="add circle icon"></i>\n    <i class="minus circle icon"></i>\n    <i class="radio icon"></i>\n    <a class="name">'+a.name+'</a>\n    <i class="checkmark icon"></i>\n  </div>\n  <div class="content"></div>\n</div>').appendTo(s),n.disabled(a)&&o.addClass("disabled"),a[n.childrenKey]&&a[n.childrenKey].length?$(".content",o).append(m(a[n.childrenKey])):o.addClass("childless"));return s},g=function(e,t){var i,r,a,o,s;for(null==t&&(t={}),a=$('<div class="ui tree-picker list"></div>').css(t),i=0,r=e.length;i<r;i++)o=e[i],n.hidden(o)||(s=$('<div class="node" data-id="'+o.id+'" data-name="'+o.name+'">\n  <div class="head '+o.selectable+'">\n    <a class="name">'+o.name+'</a>\n    <i class="checkmark icon"></i>\n  </div>\n  <div class="content"></div>\n</div>').appendTo(a),n.disabled(o)&&s.addClass("disabled"));return a},a=function(e){return $(".node",e).each(function(){var e,t,n;return n=$(this),clickHead=$(">.head.selectable",n),t=$(">.head",n),e=$(">.content",n),$(">.name",clickHead).on("click",function(e){return u(n)}),c(n)&&n.addClass("picked"),n.hasClass("childless")||(t.hasClass("selectable")?$(">.icon",t).on("click",function(t){return n.toggleClass("opened"),e.slideToggle()}):$(t).on("click",function(t){return n.toggleClass("opened"),e.slideToggle()})),E()})},initializeNodeListForSelected=function(e){return $(".node",e).each(function(){var e,t,n;return n=$(this),clickHead=$(">.head",n),t=$(">.head",n),e=$(">.content",n),$(">.name",clickHead).on("click",function(e){return u(n)}),c(n)&&n.addClass("picked"),n.hasClass("childless")||$(">.icon",t).on("click",function(t){return n.toggleClass("opened"),e.slideToggle()}),E()})},u=function(e){if(!e.hasClass("disabled"))return n.singlePick&&($(".node.picked",l).removeClass("picked"),p=[]),e.toggleClass("picked"),e.hasClass("picked")?h(e):T(e)},h=function(e){var t;return n.picked=null,t=e.attr("data-id"),p.push({id:t,name:e.attr("data-name")}),E(),$(".node[data-id="+t+"]",l).addClass("picked")},T=function(e){var t;return n.picked=null,t=e.attr("data-id"),p=p.filter(function(e){return""+e.id!=""+t}),E(),$(".node[data-id="+t+"]",l).removeClass("picked")},c=function(e){return p.filter(function(t){return""+t.id===e.attr("data-id")}).length},E=function(){return w.attr("data-picked-ids",p.map(function(e){return e.id})),p.length?(i.closest(".item").addClass("highlighted"),i.html("("+p.length+")")):(i.closest(".item").removeClass("highlighted"),i.html(""))},f=function(e,t){var i,r,a,o;for(o=[],i=0,r=e.length;i<r;i++)t(a=e[i])&&o.push({id:a.id,name:a.name,selectable:a.selectable}),a[n.childrenKey]&&a[n.childrenKey].length&&(o=o.concat(f(a[n.childrenKey],t)));return o},r()}}).call(this),org.ekstep.pluginframework.pluginManager.registerPlugin({id:"org.ekstep.conceptselector",ver:"1.1",author:"Santhosh Vasabhaktula",title:"Concept Selector Plugin",description:"",publishedDate:"",editor:{main:"editor/plugin.js",dependencies:[{type:"js",src:"editor/semantic-ui-tree-picker.js"},{type:"css",src:"editor/semantic-ui-tree-picker.css"}]}},org.ekstep.contenteditor.basePlugin.extend({conceptData:[],callback:void 0,limit:500,selectors:[],concepts:[],initialize:function(){ecEditor.addEventListener(this.manifest.id+":init",this.initConceptBrowser,this)},initData:function(e,t){e=e||this;var n=[];function i(e,t){var n=[];return ecEditor._.forEach(t,function(r){var a;null!=r.parent&&r.parent[0]==e&&((a={}).id=r.identifier,a.name=r.name,a.selectable="selectable",a.nodes=i(r.identifier,t),n.push(a))}),ecEditor._.uniqBy(n,"id")}ecEditor.getService("search").search({request:{filters:{objectType:["Dimension","Domain"]}}},function(r,a){!r&&a.data&&a.data.result&&ecEditor._.isArray(a.data.result.domains)&&ecEditor._.forEach(a.data.result.domains,function(t){var r={},o=(r.id=t.identifier,r.name=t.name,[]);ecEditor._.forEach(i(t.identifier,a.data.result.dimensions),function(t){var n={};n.id=t.id,n.name=t.name,n.nodes=i(t.id,e.concepts),o.push(n)}),r.nodes=o,n.push(r)}),t&&t()}),this.conceptData=n},getConcept:function(e,t,n,i){n=n||this;var r={request:{filters:{objectType:["Concept"]},offset:e=e||0,limit:t}};ecEditor.getService("search").search(r,function(r,a){!r&&a.data&&a.data.result&&ecEditor._.isArray(a.data.result.concepts)&&(ecEditor._.forEach(a.data.result.concepts,function(e){n.concepts.push(e)}),a.data.result.count>a.data.result.concepts.length+e&&(e+=a.data.result.concepts.length)!==a.data.result.count?n.getConcept(e,t,n,i):i(n))})},initConceptBrowser:function(e,t){var n=this;n.concepts.length?-1==n.selectors.indexOf(t.element)&&setTimeout(function(){ecEditor.jQuery("#"+t.element).treePicker({data:n.conceptData,name:"Concepts",picked:t.selectedConcepts,onSubmit:function(e){t.callback(e),t.selectedConcepts=_.map(e,"id"),n.generateTelemetry({type:"click",subtype:"submit",target:"ConceptSelectorSubmit"})},onCancel:function(){n.initConceptBrowser(e,t)},nodeName:"conceptSelector_"+t.element,minSearchQueryLength:1})},1e3):n.getConcept(0,n.limit,n,function(){n.initData(n,function(){-1==n.selectors.indexOf(t.element)&&setTimeout(function(){ecEditor.jQuery("#"+t.element).treePicker({data:n.conceptData,name:"Concepts",picked:t.selectedConcepts,onSubmit:function(e){t.callback(e),t.selectedConcepts=_.map(e,"id"),n.generateTelemetry({type:"click",subtype:"submit",target:"ConceptSelectorSubmit"})},onCancel:function(){n.initConceptBrowser(e,t)},nodeName:"conceptSelector_"+t.element,minSearchQueryLength:1})},1e3)})})},generateTelemetry:function(e){e&&ecEditor.getService("telemetry").interact({type:e.type,subtype:e.subtype,id:e.target,pageid:org.ekstep.contenteditor.api.getCurrentStage().id||"",target:{id:e.targetid||"",type:"plugin",ver:""},plugin:{id:this.manifest.id,ver:this.manifest.ver,category:"core"},ver:"3.0"})}}))},function(e,t){!function(e,t,n){"use strict";var i,r,a,o,s,l={};function u(e,t,n){var i,r=e.runtimeStyle&&e.runtimeStyle[t],a=e.style;return!/^-?[0-9]+\.?[0-9]*(?:px)?$/i.test(n)&&/^-?\d/.test(n)&&(i=a.left,r&&(e.runtimeStyle.left=e.currentStyle.left),a.left="fontSize"===t?"1em":n||0,n=a.pixelLeft+"px",a.left=i,r&&(e.runtimeStyle.left=r)),/^(thin|medium|thick)$/i.test(n)?n:Math.round(parseFloat(n))+"px"}function c(e){return parseInt(e,10)}function d(e,t,n,i,r,a){var o,s,u,c,d=l.Util.getCSS(t,e,r);if(1===d.length&&(c=d[0],(d=[])[0]=c,d[1]=c),-1!==d[0].toString().indexOf("%"))u=parseFloat(d[0])/100,s=n.width*u,"backgroundSize"!==e&&(s-=(a||i).width*u);else if("backgroundSize"===e)if("auto"===d[0])s=i.width;else if(/contain|cover/.test(d[0])){var h=l.Util.resizeBounds(i.width,i.height,n.width,n.height,d[0]);s=h.width,o=h.height}else s=parseInt(d[0],10);else s=parseInt(d[0],10);return"auto"===d[1]?o=s/i.width*i.height:-1!==d[1].toString().indexOf("%")?(u=parseFloat(d[1])/100,o=n.height*u,"backgroundSize"!==e&&(o-=(a||i).height*u)):o=parseInt(d[1],10),[s,o]}l.Util={},l.Util.log=function(t){l.logging&&e.console&&e.console.log&&e.console.log(t)},l.Util.trimText=(r=String.prototype.trim,function(e){return r?r.apply(e):((e||"")+"").replace(/^\s+|\s+$/g,"")}),l.Util.asFloat=function(e){return parseFloat(e)},a=/((rgba|rgb)\([^\)]+\)(\s-?\d+px){0,})/g,o=/(-?\d+px)|(#.+)|(rgb\(.+\))|(rgba\(.+\))/g,l.Util.parseTextShadows=function(e){if(!e||"none"===e)return[];for(var t=e.match(a),n=[],i=0;t&&i<t.length;i++){var r=t[i].match(o);n.push({color:r[0],offsetX:r[1]?r[1].replace("px",""):0,offsetY:r[2]?r[2].replace("px",""):0,blur:r[3]?r[3].replace("px",""):0})}return n},l.Util.parseBackgroundImage=function(e){var t,n,i,r,a,o,s,l,u=[],c=0,d=0,h=function(){t&&('"'===n.substr(0,1)&&(n=n.substr(1,n.length-2)),n&&l.push(n),"-"===t.substr(0,1)&&(r=t.indexOf("-",1)+1)>0&&(i=t.substr(0,r),t=t.substr(r)),u.push({prefix:i,method:t.toLowerCase(),value:a,args:l})),l=[],t=i=n=a=""};h();for(var p=0,f=e.length;p<f;p++)if(o=e[p],!(0===c&&" \r\n\t".indexOf(o)>-1)){switch(o){case'"':s?s===o&&(s=null):s=o;break;case"(":if(s)break;if(0===c){c=1,a+=o;continue}d++;break;case")":if(s)break;if(1===c){if(0===d){c=0,a+=o,h();continue}d--}break;case",":if(s)break;if(0===c){h();continue}if(1===c&&0===d&&!t.match(/^url$/i)){l.push(n),n="",a+=o;continue}}a+=o,0===c?t+=o:n+=o}return h(),u},l.Util.Bounds=function(e){var t,n={};return e.getBoundingClientRect&&(t=e.getBoundingClientRect(),n.top=t.top,n.bottom=t.bottom||t.top+t.height,n.left=t.left,n.width=e.offsetWidth,n.height=e.offsetHeight),n},l.Util.OffsetBounds=function(e){var t=e.offsetParent?l.Util.OffsetBounds(e.offsetParent):{top:0,left:0};return{top:e.offsetTop+t.top,bottom:e.offsetTop+e.offsetHeight+t.top,left:e.offsetLeft+t.left,width:e.offsetWidth,height:e.offsetHeight}},l.Util.getCSS=function(e,r,a){void 0!==e&&(i=t.defaultView.getComputedStyle(e,null));var o=i[r];if(/^background(Size|Position)$/.test(r))return function(e,t,i,r){if(e=(e=(e||"").split(","))[r||0]||e[0]||"auto",e=l.Util.trimText(e).split(" "),"backgroundSize"!==i||e[0]&&!e[0].match(/cover|contain|auto/)){if(e[0]=-1===e[0].indexOf("%")?u(t,i+"X",e[0]):e[0],e[1]===n){if("backgroundSize"===i)return e[1]="auto",e;e[1]=e[0]}e[1]=-1===e[1].indexOf("%")?u(t,i+"Y",e[1]):e[1]}return e}(o,e,r,a);if(/border(Top|Bottom)(Left|Right)Radius/.test(r)){var s=o.split(" ");return s.length<=1&&(s[1]=s[0]),s.map(c)}return o},l.Util.resizeBounds=function(e,t,n,i,r){var a,o,s=e/t;return r&&"auto"!==r?n/i<s^"contain"===r?(o=i,a=i*s):(a=n,o=n/s):(a=n,o=i),{width:a,height:o}},l.Util.BackgroundPosition=function(e,t,n,i,r){var a=d("backgroundPosition",e,t,n,i,r);return{left:a[0],top:a[1]}},l.Util.BackgroundSize=function(e,t,n,i){var r=d("backgroundSize",e,t,n,i);return{width:r[0],height:r[1]}},l.Util.Extend=function(e,t){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);return t},l.Util.Children=function(e){var t,i,r;try{t=e.nodeName&&"IFRAME"===e.nodeName.toUpperCase()?e.contentDocument||e.contentWindow.document:(i=e.childNodes,r=[],null!==i&&function(e,t){var i=e.length,r=0;if("number"==typeof t.length)for(var a=t.length;r<a;r++)e[i++]=t[r];else for(;t[r]!==n;)e[i++]=t[r++];e.length=i}(r,i),r)}catch(e){l.Util.log("html2canvas.Util.Children failed with exception: "+e.message),t=[]}return t},l.Util.isTransparent=function(e){return"transparent"===e||"rgba(0, 0, 0, 0)"===e},l.Util.Font=(s={},function(e,t,i){if(s[e+"-"+t]!==n)return s[e+"-"+t];var r,a,o=i.createElement("div"),l=i.createElement("img"),u=i.createElement("span");return o.style.visibility="hidden",o.style.fontFamily=e,o.style.fontSize=t,o.style.margin=0,o.style.padding=0,i.body.appendChild(o),l.src="data:image/gif;base64,R0lGODlhAQABAIABAP///wAAACwAAAAAAQABAAACAkQBADs=",l.width=1,l.height=1,l.style.margin=0,l.style.padding=0,l.style.verticalAlign="baseline",u.style.fontFamily=e,u.style.fontSize=t,u.style.margin=0,u.style.padding=0,u.appendChild(i.createTextNode("Hidden Text")),o.appendChild(u),o.appendChild(l),r=l.offsetTop-u.offsetTop+1,o.removeChild(u),o.appendChild(i.createTextNode("Hidden Text")),o.style.lineHeight="normal",l.style.verticalAlign="super",a={baseline:r,lineWidth:1,middle:l.offsetTop-o.offsetTop+1},s[e+"-"+t]=a,i.body.removeChild(o),a}),function(){var e=l.Util,n={};l.Generate=n;var i=[/^(-webkit-linear-gradient)\(([a-z\s]+)([\w\d\.\s,%\(\)]+)\)$/,/^(-o-linear-gradient)\(([a-z\s]+)([\w\d\.\s,%\(\)]+)\)$/,/^(-webkit-gradient)\((linear|radial),\s((?:\d{1,3}%?)\s(?:\d{1,3}%?),\s(?:\d{1,3}%?)\s(?:\d{1,3}%?))([\w\d\.\s,%\(\)\-]+)\)$/,/^(-moz-linear-gradient)\(((?:\d{1,3}%?)\s(?:\d{1,3}%?))([\w\d\.\s,%\(\)]+)\)$/,/^(-webkit-radial-gradient)\(((?:\d{1,3}%?)\s(?:\d{1,3}%?)),\s(\w+)\s([a-z\-]+)([\w\d\.\s,%\(\)]+)\)$/,/^(-moz-radial-gradient)\(((?:\d{1,3}%?)\s(?:\d{1,3}%?)),\s(\w+)\s?([a-z\-]*)([\w\d\.\s,%\(\)]+)\)$/,/^(-o-radial-gradient)\(((?:\d{1,3}%?)\s(?:\d{1,3}%?)),\s(\w+)\s([a-z\-]+)([\w\d\.\s,%\(\)]+)\)$/];function r(t){return function(n){try{t.addColorStop(n.stop,n.color)}catch(t){e.log(["failed to add color stop: ",t,"; tried to add: ",n])}}}n.parseGradient=function(e,t){var n,r,a,o,s,l,u,c,d,h,p,f,g=i.length;for(r=0;r<g&&!(a=e.match(i[r]));r+=1);if(a)switch(a[1]){case"-webkit-linear-gradient":case"-o-linear-gradient":if(n={type:"linear",x0:null,y0:null,x1:null,y1:null,colorStops:[]},s=a[2].match(/\w+/g))for(l=s.length,r=0;r<l;r+=1)switch(s[r]){case"top":n.y0=0,n.y1=t.height;break;case"right":n.x0=t.width,n.x1=0;break;case"bottom":n.y0=t.height,n.y1=0;break;case"left":n.x0=0,n.x1=t.width}if(null===n.x0&&null===n.x1&&(n.x0=n.x1=t.width/2),null===n.y0&&null===n.y1&&(n.y0=n.y1=t.height/2),s=a[3].match(/((?:rgb|rgba)\(\d{1,3},\s\d{1,3},\s\d{1,3}(?:,\s[0-9\.]+)?\)(?:\s\d{1,3}(?:%|px))?)+/g))for(l=s.length,u=1/Math.max(l-1,1),r=0;r<l;r+=1)(c=s[r].match(/((?:rgb|rgba)\(\d{1,3},\s\d{1,3},\s\d{1,3}(?:,\s[0-9\.]+)?\))\s*(\d{1,3})?(%|px)?/))[2]?(o=parseFloat(c[2]),"%"===c[3]?o/=100:o/=t.width):o=r*u,n.colorStops.push({color:c[1],stop:o});break;case"-webkit-gradient":if(n={type:"radial"===a[2]?"circle":a[2],x0:0,y0:0,x1:0,y1:0,colorStops:[]},(s=a[3].match(/(\d{1,3})%?\s(\d{1,3})%?,\s(\d{1,3})%?\s(\d{1,3})%?/))&&(n.x0=s[1]*t.width/100,n.y0=s[2]*t.height/100,n.x1=s[3]*t.width/100,n.y1=s[4]*t.height/100),s=a[4].match(/((?:from|to|color-stop)\((?:[0-9\.]+,\s)?(?:rgb|rgba)\(\d{1,3},\s\d{1,3},\s\d{1,3}(?:,\s[0-9\.]+)?\)\))+/g))for(l=s.length,r=0;r<l;r+=1)c=s[r].match(/(from|to|color-stop)\(([0-9\.]+)?(?:,\s)?((?:rgb|rgba)\(\d{1,3},\s\d{1,3},\s\d{1,3}(?:,\s[0-9\.]+)?\))\)/),o=parseFloat(c[2]),"from"===c[1]&&(o=0),"to"===c[1]&&(o=1),n.colorStops.push({color:c[3],stop:o});break;case"-moz-linear-gradient":if(n={type:"linear",x0:0,y0:0,x1:0,y1:0,colorStops:[]},(s=a[2].match(/(\d{1,3})%?\s(\d{1,3})%?/))&&(n.x0=s[1]*t.width/100,n.y0=s[2]*t.height/100,n.x1=t.width-n.x0,n.y1=t.height-n.y0),s=a[3].match(/((?:rgb|rgba)\(\d{1,3},\s\d{1,3},\s\d{1,3}(?:,\s[0-9\.]+)?\)(?:\s\d{1,3}%)?)+/g))for(l=s.length,u=1/Math.max(l-1,1),r=0;r<l;r+=1)(c=s[r].match(/((?:rgb|rgba)\(\d{1,3},\s\d{1,3},\s\d{1,3}(?:,\s[0-9\.]+)?\))\s*(\d{1,3})?(%)?/))[2]?(o=parseFloat(c[2]),c[3]&&(o/=100)):o=r*u,n.colorStops.push({color:c[1],stop:o});break;case"-webkit-radial-gradient":case"-moz-radial-gradient":case"-o-radial-gradient":if(n={type:"circle",x0:0,y0:0,x1:t.width,y1:t.height,cx:0,cy:0,rx:0,ry:0,colorStops:[]},(s=a[2].match(/(\d{1,3})%?\s(\d{1,3})%?/))&&(n.cx=s[1]*t.width/100,n.cy=s[2]*t.height/100),s=a[3].match(/\w+/),c=a[4].match(/[a-z\-]*/),s&&c)switch(c[0]){case"farthest-corner":case"cover":case"":d=Math.sqrt(Math.pow(n.cx,2)+Math.pow(n.cy,2)),h=Math.sqrt(Math.pow(n.cx,2)+Math.pow(n.y1-n.cy,2)),p=Math.sqrt(Math.pow(n.x1-n.cx,2)+Math.pow(n.y1-n.cy,2)),f=Math.sqrt(Math.pow(n.x1-n.cx,2)+Math.pow(n.cy,2)),n.rx=n.ry=Math.max(d,h,p,f);break;case"closest-corner":d=Math.sqrt(Math.pow(n.cx,2)+Math.pow(n.cy,2)),h=Math.sqrt(Math.pow(n.cx,2)+Math.pow(n.y1-n.cy,2)),p=Math.sqrt(Math.pow(n.x1-n.cx,2)+Math.pow(n.y1-n.cy,2)),f=Math.sqrt(Math.pow(n.x1-n.cx,2)+Math.pow(n.cy,2)),n.rx=n.ry=Math.min(d,h,p,f);break;case"farthest-side":"circle"===s[0]?n.rx=n.ry=Math.max(n.cx,n.cy,n.x1-n.cx,n.y1-n.cy):(n.type=s[0],n.rx=Math.max(n.cx,n.x1-n.cx),n.ry=Math.max(n.cy,n.y1-n.cy));break;case"closest-side":case"contain":"circle"===s[0]?n.rx=n.ry=Math.min(n.cx,n.cy,n.x1-n.cx,n.y1-n.cy):(n.type=s[0],n.rx=Math.min(n.cx,n.x1-n.cx),n.ry=Math.min(n.cy,n.y1-n.cy))}if(s=a[5].match(/((?:rgb|rgba)\(\d{1,3},\s\d{1,3},\s\d{1,3}(?:,\s[0-9\.]+)?\)(?:\s\d{1,3}(?:%|px))?)+/g))for(l=s.length,u=1/Math.max(l-1,1),r=0;r<l;r+=1)(c=s[r].match(/((?:rgb|rgba)\(\d{1,3},\s\d{1,3},\s\d{1,3}(?:,\s[0-9\.]+)?\))\s*(\d{1,3})?(%|px)?/))[2]?(o=parseFloat(c[2]),"%"===c[3]?o/=100:o/=t.width):o=r*u,n.colorStops.push({color:c[1],stop:o})}return n},n.Gradient=function(e,n){if(0!==n.width&&0!==n.height){var i,a,o=t.createElement("canvas"),s=o.getContext("2d");if(o.width=n.width,o.height=n.height,i=l.Generate.parseGradient(e,n))switch(i.type){case"linear":a=s.createLinearGradient(i.x0,i.y0,i.x1,i.y1),i.colorStops.forEach(r(a)),s.fillStyle=a,s.fillRect(0,0,n.width,n.height);break;case"circle":a=s.createRadialGradient(i.cx,i.cy,0,i.cx,i.cy,i.rx),i.colorStops.forEach(r(a)),s.fillStyle=a,s.fillRect(0,0,n.width,n.height);break;case"ellipse":var u=t.createElement("canvas"),c=u.getContext("2d"),d=Math.max(i.rx,i.ry),h=2*d;u.width=u.height=h,a=c.createRadialGradient(i.rx,i.ry,0,i.rx,i.ry,d),i.colorStops.forEach(r(a)),c.fillStyle=a,c.fillRect(0,0,h,h),s.fillStyle=i.colorStops[i.colorStops.length-1].color,s.fillRect(0,0,o.width,o.height),s.drawImage(u,i.cx-i.rx,i.cy-i.ry,2*i.rx,2*i.ry)}return o}},n.ListAlpha=function(e){var t,n="";do{t=e%26,n=String.fromCharCode(t+64)+n,e/=26}while(26*e>26);return n},n.ListRoman=function(e){var t,n=["M","CM","D","CD","C","XC","L","XL","X","IX","V","IV","I"],i=[1e3,900,500,400,100,90,50,40,10,9,5,4,1],r="",a=n.length;if(e<=0||e>=4e3)return e;for(t=0;t<a;t+=1)for(;e>=i[t];)e-=i[t],r+=n[t];return r}}(),l.Parse=function(i,r){e.scroll(0,0);var a=r.elements===n?t.body:r.elements[0],o=a.ownerDocument,s=l.Util,u=s.Support(r,o),c=new RegExp("("+r.ignoreElements+")"),d=o.body,h=s.getCSS,p="___html2canvas___pseudoelement",f=o.createElement("style");function g(e,t){var n=parseInt(h(e,t),10);return isNaN(n)?0:n}function m(e,t,n,i,r,a){"transparent"!==a&&(e.setVariable("fillStyle",a),e.fillRect(t,n,i,r))}function v(e,t,n){if(e.length>0)return t+n.toUpperCase()}function y(e,t,n,i){null!==e&&s.trimText(e).length>0&&i.fillText(e,t,n)}function b(e,t,n,i){var r=h(t,"fontWeight"),a=h(t,"fontFamily"),l=h(t,"fontSize"),u=s.parseTextShadows(h(t,"textShadow"));switch(parseInt(r,10)){case 401:r="bold";break;case 400:r="normal"}if(e.setVariable("fillStyle",i),e.setVariable("font",[h(t,"fontStyle"),h(t,"fontVariant"),r,l,a].join(" ")),e.setVariable("textAlign","left"),u.length&&(e.setVariable("shadowColor",u[0].color),e.setVariable("shadowOffsetX",u[0].offsetX),e.setVariable("shadowOffsetY",u[0].offsetY),e.setVariable("shadowBlur",u[0].blur)),"none"!==n)return s.Font(a,l,o)}function _(e,t,n,i,r){var a;if(u.rangeBounds&&!r)"none"===n&&0===s.trimText(t).length||(a=function(e,t,n){var i=o.createRange();return i.setStart(t,n),i.setEnd(t,n+e.length),i.getBoundingClientRect()}(t,e.node,e.textOffset)),e.textOffset+=t.length;else if(e.node&&"string"==typeof e.node.nodeValue){var l=i?e.node.splitText(t.length):null;a=function(e,t){var n=e.parentNode,i=o.createElement("wrapper"),r=e.cloneNode(!0);i.appendChild(e.cloneNode(!0)),n.replaceChild(i,e);var a=t?s.OffsetBounds(i):s.Bounds(i);return n.replaceChild(r,i),a}(e.node,r),e.node=l}return a}function T(e,t,n){var i,a,o,l=n.ctx,u=h(e,"color"),c=h(e,"textDecoration"),d=h(e,"textAlign"),p={node:t,textOffset:0};s.trimText(t.nodeValue).length>0&&(t.nodeValue=function(e,t){switch(t){case"lowercase":return e.toLowerCase();case"capitalize":return e.replace(/(^|\s|:|-|\(|\))([a-z])/g,v);case"uppercase":return e.toUpperCase();default:return e}}(t.nodeValue,h(e,"textTransform")),d=d.replace(["-webkit-auto"],["auto"]),a=!r.letterRendering&&/^(left|right|justify|auto)$/.test(d)&&(o=h(e,"letterSpacing"),/^(normal|none|0px)$/.test(o))?t.nodeValue.split(/(\b| )/):t.nodeValue.split(""),i=b(l,e,c,u),r.chinese&&a.forEach(function(e,t){/.*[\u4E00-\u9FA5].*$/.test(e)&&((e=e.split("")).unshift(t,1),a.splice.apply(a,e))}),a.forEach(function(e,t){var r=_(p,e,c,t<a.length-1,n.transform.matrix);r&&(y(e,r.left,r.bottom,l),function(e,t,n,i,r){switch(c){case"underline":m(e,n.left,Math.round(n.top+i.baseline+i.lineWidth),n.width,1,r);break;case"overline":m(e,n.left,Math.round(n.top),n.width,1,r);break;case"line-through":m(e,n.left,Math.ceil(n.top+i.middle+i.lineWidth),n.width,1,r)}}(l,0,r,i,u))}))}function E(e,t,n){var i,r,a=t.ctx,u=h(e,"listStyleType");if(/^(decimal|decimal-leading-zero|upper-alpha|upper-latin|upper-roman|lower-alpha|lower-greek|lower-latin|lower-roman)$/i.test(u)){if(r=function(e,t){var n,i,r=o.createElement("boundelement");return r.style.display="inline",n=e.style.listStyleType,e.style.listStyleType="none",r.appendChild(o.createTextNode(t)),e.insertBefore(r,e.firstChild),i=s.Bounds(r),e.removeChild(r),e.style.listStyleType=n,i}(e,i=function(e,t){var n,i=function(e){var t=-1,n=1,i=e.parentNode.childNodes;if(e.parentNode){for(;i[++t]!==e;)1===i[t].nodeType&&n++;return n}return-1}(e);switch(t){case"decimal":n=i;break;case"decimal-leading-zero":n=1===i.toString().length?i="0"+i.toString():i.toString();break;case"upper-roman":n=l.Generate.ListRoman(i);break;case"lower-roman":n=l.Generate.ListRoman(i).toLowerCase();break;case"lower-alpha":n=l.Generate.ListAlpha(i).toLowerCase();break;case"upper-alpha":n=l.Generate.ListAlpha(i)}return n+". "}(e,u)),b(a,e,"none",h(e,"color")),"inside"!==h(e,"listStylePosition"))return;a.setVariable("textAlign","left"),y(i,n.left,r.bottom,a)}}function C(e){var t=i[e];return!(!t||!0!==t.succeeded)&&t.img}function w(e,t){var n=Math.max(e.left,t.left),i=Math.max(e.top,t.top);return{left:n,top:i,width:Math.min(e.left+e.width,t.left+t.width)-n,height:Math.min(e.top+e.height,t.top+t.height)-i}}function k(e,t,n,i,r){var a=g(t,"paddingLeft"),o=g(t,"paddingTop"),s=g(t,"paddingRight"),l=g(t,"paddingBottom");P(e,n,0,0,n.width,n.height,i.left+a+r[3].width,i.top+o+r[0].width,i.width-(r[1].width+r[3].width+a+s),i.height-(r[0].width+r[2].width+o+l))}f.innerHTML="."+p+'-before:before { content: "" !important; display: none !important; }.'+p+'-after:after { content: "" !important; display: none !important; }',d.appendChild(f),i=i||{};var S,I=(S=(Math.sqrt(2)-1)/3*4,function(e,t,n,i){var r=n*S,a=i*S,o=e+n,s=t+i;return{topLeft:O({x:e,y:s},{x:e,y:s-a},{x:o-r,y:t},{x:o,y:t}),topRight:O({x:e,y:t},{x:e+r,y:t},{x:o,y:s-a},{x:o,y:s}),bottomRight:O({x:o,y:t},{x:o,y:t+a},{x:e+r,y:s},{x:e,y:s}),bottomLeft:O({x:o,y:s},{x:o-r,y:s},{x:e,y:t+a},{x:e,y:t})}});function O(e,t,n,i){var r=function(e,t,n){return{x:e.x+(t.x-e.x)*n,y:e.y+(t.y-e.y)*n}};return{start:e,startControl:t,endControl:n,end:i,subdivide:function(a){var o=r(e,t,a),s=r(t,n,a),l=r(n,i,a),u=r(o,s,a),c=r(s,l,a),d=r(u,c,a);return[O(e,o,u,d),O(d,c,l,i)]},curveTo:function(e){e.push(["bezierCurve",t.x,t.y,n.x,n.y,i.x,i.y])},curveToReversed:function(i){i.push(["bezierCurve",n.x,n.y,t.x,t.y,e.x,e.y])}}}function D(e,t,n,i,r,a,o){t[0]>0||t[1]>0?(e.push(["line",i[0].start.x,i[0].start.y]),i[0].curveTo(e),i[1].curveTo(e)):e.push(["line",a,o]),(n[0]>0||n[1]>0)&&e.push(["line",r[0].start.x,r[0].start.y])}function R(e,t,n,i,r,a,o){var s=[];return t[0]>0||t[1]>0?(s.push(["line",i[1].start.x,i[1].start.y]),i[1].curveTo(s)):s.push(["line",e.c1[0],e.c1[1]]),n[0]>0||n[1]>0?(s.push(["line",a[0].start.x,a[0].start.y]),a[0].curveTo(s),s.push(["line",o[0].end.x,o[0].end.y]),o[0].curveToReversed(s)):(s.push(["line",e.c2[0],e.c2[1]]),s.push(["line",e.c3[0],e.c3[1]])),t[0]>0||t[1]>0?(s.push(["line",r[1].end.x,r[1].end.y]),r[1].curveToReversed(s)):s.push(["line",e.c4[0],e.c4[1]]),s}function x(e,t){var n=e.drawShape();return t.forEach(function(e,t){n[0===t?"moveTo":e[0]+"To"].apply(null,e.slice(1))}),n}function A(e,t,n){var i,r,a=o.createElement("valuewrap");["lineHeight","textAlign","fontFamily","color","fontSize","paddingLeft","paddingTop","width","height","border","borderLeftWidth","borderTopWidth"].forEach(function(t){try{a.style[t]=h(e,t)}catch(e){s.log("html2canvas: Parse: Exception caught in renderFormValue: "+e.message)}}),a.style.borderColor="black",a.style.borderStyle="solid",a.style.display="block",a.style.position="absolute",(/^(submit|reset|button|text|password)$/.test(e.type)||"SELECT"===e.nodeName)&&(a.style.lineHeight=h(e,"height")),a.style.top=t.top+"px",a.style.left=t.left+"px",(i="SELECT"===e.nodeName?(e.options[e.selectedIndex]||0).text:e.value)||(i=e.placeholder),r=o.createTextNode(i),a.appendChild(r),d.appendChild(a),T(e,r,n),d.removeChild(a)}function P(e){e.drawImage.apply(e,Array.prototype.slice.call(arguments,1))}function L(n,i){var r=e.getComputedStyle(n,i);if(r&&r.content&&"none"!==r.content&&"-moz-alt-content"!==r.content&&"none"!==r.display){var a=r.content+"",o=a.substr(0,1);o===a.substr(a.length-1)&&o.match(/'|"/)&&(a=a.substr(1,a.length-2));var l="url"===a.substr(0,3),u=t.createElement(l?"img":"span");return u.className=p+"-before "+p+"-after",Object.keys(r).filter(N).forEach(function(e){try{u.style[e]=r[e]}catch(t){s.log(["Tried to assign readonly property ",e,"Error:",t])}}),l?u.src=s.parseBackgroundImage(a)[0].args[0]:u.innerHTML=a,u}}function N(t){return isNaN(e.parseInt(t,10))}function M(e,t,n,i){var r=Math.round(i.left+n.left),a=Math.round(i.top+n.top);e.createPattern(t),e.translate(r,a),e.fill(),e.translate(-r,-a)}function K(e,t,n,i,r,a,o,s){var l=[];l.push(["line",Math.round(r),Math.round(a)]),l.push(["line",Math.round(r+o),Math.round(a)]),l.push(["line",Math.round(r+o),Math.round(s+a)]),l.push(["line",Math.round(r),Math.round(s+a)]),x(e,l),e.save(),e.clip(),M(e,t,n,i),e.restore()}function $(e,t,n,i,r){var a=s.BackgroundSize(e,t,i,r),l=s.BackgroundPosition(e,t,i,r,a),u=h(e,"backgroundRepeat").split(",").map(s.trimText);switch(i=function(e,t){if(e.width===t.width&&e.height===t.height)return e;var n=o.createElement("canvas");return n.width=t.width,n.height=t.height,P(n.getContext("2d"),e,0,0,e.width,e.height,0,0,t.width,t.height),n}(i,a),u=u[r]||u[0]){case"repeat-x":K(n,i,l,t,t.left,t.top+l.top,99999,i.height);break;case"repeat-y":K(n,i,l,t,t.left+l.left,t.top,i.width,99999);break;case"no-repeat":K(n,i,l,t,t.left+l.left,t.top+l.top,i.width,i.height);break;default:M(n,i,l,{top:t.top,left:t.left,width:i.width,height:i.height})}}function j(e){return e.replace("px","")}var B,F,U,V=/(matrix)\((.+)\)/;function q(e,t,n,i){var a,l,u,c=(a=t?n.width:Math.max(Math.max(o.body.scrollWidth,o.documentElement.scrollWidth),Math.max(o.body.offsetWidth,o.documentElement.offsetWidth),Math.max(o.body.clientWidth,o.documentElement.clientWidth)),l=t?n.height:Math.max(Math.max(o.body.scrollHeight,o.documentElement.scrollHeight),Math.max(o.body.offsetHeight,o.documentElement.offsetHeight),Math.max(o.body.clientHeight,o.documentElement.clientHeight)),{storage:u=[],width:a,height:l,clip:function(){u.push({type:"function",name:"clip",arguments:arguments})},translate:function(){u.push({type:"function",name:"translate",arguments:arguments})},fill:function(){u.push({type:"function",name:"fill",arguments:arguments})},save:function(){u.push({type:"function",name:"save",arguments:arguments})},restore:function(){u.push({type:"function",name:"restore",arguments:arguments})},fillRect:function(){u.push({type:"function",name:"fillRect",arguments:arguments})},createPattern:function(){u.push({type:"function",name:"createPattern",arguments:arguments})},drawShape:function(){var e=[];return u.push({type:"function",name:"drawShape",arguments:e}),{moveTo:function(){e.push({name:"moveTo",arguments:arguments})},lineTo:function(){e.push({name:"lineTo",arguments:arguments})},arcTo:function(){e.push({name:"arcTo",arguments:arguments})},bezierCurveTo:function(){e.push({name:"bezierCurveTo",arguments:arguments})},quadraticCurveTo:function(){e.push({name:"quadraticCurveTo",arguments:arguments})}}},drawImage:function(){u.push({type:"function",name:"drawImage",arguments:arguments})},fillText:function(){u.push({type:"function",name:"fillText",arguments:arguments})},setVariable:function(e,t){return u.push({type:"variable",name:e,arguments:t}),t}}),d={ctx:c,opacity:function(e,t,n){return c.setVariable("globalAlpha",h(t,"opacity")*(n?n.opacity:1))}(0,e,t),cssPosition:h(e,"position"),borders:function(e){return["Top","Right","Bottom","Left"].map(function(t){return{width:g(e,"border"+t+"Width"),color:h(e,"border"+t+"Color")}})}(e),transform:i,clip:t&&t.clip?s.Extend({},t.clip):null};return function(e,t,n){var i,r="static"!==t.cssPosition,a=r?h(e,"zIndex"):"auto",o=h(e,"opacity"),s="none"!==h(e,"cssFloat");t.zIndex=i={zindex:a,children:[]},i.isPositioned=r,i.isFloated=s,i.opacity=o,i.ownStacking="auto"!==a||o<1,n&&n.zIndex.children.push(t)}(e,d,t),!0===r.useOverflow&&!0===/(hidden|scroll|auto)/.test(h(e,"overflow"))&&!1===/(BODY)/i.test(e.nodeName)&&(d.clip=d.clip?w(d.clip,n):n),d}function H(e,t,n,i){var r,a=function(e,t){var n,i=h(e,"transform")||h(e,"-webkit-transform")||h(e,"-moz-transform")||h(e,"-ms-transform")||h(e,"-o-transform"),r=h(e,"transform-origin")||h(e,"-webkit-transform-origin")||h(e,"-moz-transform-origin")||h(e,"-ms-transform-origin")||h(e,"-o-transform-origin")||"0px 0px";if(r=r.split(" ").map(j).map(s.asFloat),i&&"none"!==i){var a=i.match(V);if(a)switch(a[1]){case"matrix":n=a[2].split(",").map(s.trimText).map(s.asFloat)}}return{origin:r,matrix:n}}(e),o=function(e,t){var n=t.matrix?s.OffsetBounds(e):s.Bounds(e);return t.origin[0]+=n.left,t.origin[1]+=n.top,n}(e,a),l=q(e,t,o,a),u=l.borders,d=l.ctx,f=function(e,t,n){var i={left:t.left+e[3].width,top:t.top+e[0].width,width:t.width-(e[1].width+e[3].width),height:t.height-(e[0].width+e[2].width)};return n&&(i=w(i,n)),i}(u,o,l.clip),g=function(e,t,n){var i,r,a,o,s,l,u=t.left,c=t.top,d=t.width,p=t.height,f=function(e){return["TopLeft","TopRight","BottomRight","BottomLeft"].map(function(t){return h(e,"border"+t+"Radius")})}(e),g=function(e,t,n){var i=e.left,r=e.top,a=e.width,o=e.height,s=t[0][0],l=t[0][1],u=t[1][0],c=t[1][1],d=t[2][0],h=t[2][1],p=t[3][0],f=t[3][1],g=a-u,m=o-h,v=a-d,y=o-f;return{topLeftOuter:I(i,r,s,l).topLeft.subdivide(.5),topLeftInner:I(i+n[3].width,r+n[0].width,Math.max(0,s-n[3].width),Math.max(0,l-n[0].width)).topLeft.subdivide(.5),topRightOuter:I(i+g,r,u,c).topRight.subdivide(.5),topRightInner:I(i+Math.min(g,a+n[3].width),r+n[0].width,g>a+n[3].width?0:u-n[3].width,c-n[0].width).topRight.subdivide(.5),bottomRightOuter:I(i+v,r+m,d,h).bottomRight.subdivide(.5),bottomRightInner:I(i+Math.min(v,a+n[3].width),r+Math.min(m,o+n[0].width),Math.max(0,d-n[1].width),Math.max(0,h-n[2].width)).bottomRight.subdivide(.5),bottomLeftOuter:I(i,r+y,p,f).bottomLeft.subdivide(.5),bottomLeftInner:I(i+n[3].width,r+y,Math.max(0,p-n[3].width),Math.max(0,f-n[2].width)).bottomLeft.subdivide(.5)}}(t,f,n),m={clip:function(e,t,n,i,r){var a=[];switch(h(e,"backgroundClip")){case"content-box":case"padding-box":D(a,i[0],i[1],t.topLeftInner,t.topRightInner,r.left+n[3].width,r.top+n[0].width),D(a,i[1],i[2],t.topRightInner,t.bottomRightInner,r.left+r.width-n[1].width,r.top+n[0].width),D(a,i[2],i[3],t.bottomRightInner,t.bottomLeftInner,r.left+r.width-n[1].width,r.top+r.height-n[2].width),D(a,i[3],i[0],t.bottomLeftInner,t.topLeftInner,r.left+n[3].width,r.top+r.height-n[2].width);break;default:D(a,i[0],i[1],t.topLeftOuter,t.topRightOuter,r.left,r.top),D(a,i[1],i[2],t.topRightOuter,t.bottomRightOuter,r.left+r.width,r.top),D(a,i[2],i[3],t.bottomRightOuter,t.bottomLeftOuter,r.left+r.width,r.top+r.height),D(a,i[3],i[0],t.bottomLeftOuter,t.topLeftOuter,r.left,r.top+r.height)}return a}(e,g,n,f,t),borders:[]};for(i=0;i<4;i++)if(n[i].width>0){switch(r=u,a=c,o=d,s=p-n[2].width,i){case 0:s=n[0].width,l=R({c1:[r,a],c2:[r+o,a],c3:[r+o-n[1].width,a+s],c4:[r+n[3].width,a+s]},f[0],f[1],g.topLeftOuter,g.topLeftInner,g.topRightOuter,g.topRightInner);break;case 1:l=R({c1:[(r=u+d-n[1].width)+(o=n[1].width),a],c2:[r+o,a+s+n[2].width],c3:[r,a+s],c4:[r,a+n[0].width]},f[1],f[2],g.topRightOuter,g.topRightInner,g.bottomRightOuter,g.bottomRightInner);break;case 2:l=R({c1:[r+o,(a=a+p-n[2].width)+(s=n[2].width)],c2:[r,a+s],c3:[r+n[3].width,a],c4:[r+o-n[3].width,a]},f[2],f[3],g.bottomRightOuter,g.bottomRightInner,g.bottomLeftOuter,g.bottomLeftInner);break;case 3:o=n[3].width,l=R({c1:[r,a+s+n[2].width],c2:[r,a],c3:[r+o,a+n[0].width],c4:[r+o,a+s]},f[3],f[0],g.bottomLeftOuter,g.bottomLeftInner,g.topLeftOuter,g.topLeftInner)}m.borders.push({args:l,color:n[i].color})}return m}(e,o,u),v=c.test(e.nodeName)?"#efefef":h(e,"backgroundColor");switch(x(d,g.clip),d.save(),d.clip(),f.height>0&&f.width>0&&!i?(function(e,t,n){m(d,t.left,t.top,t.width,t.height,n)}(0,o,v),function(e,t,n){for(var i,r=h(e,"backgroundImage"),a=s.parseBackgroundImage(r),o=a.length;o--;)(r=a[o]).args&&0!==r.args.length&&((i=C("url"===r.method?r.args[0]:r.value))?$(e,t,n,i,o):s.log("html2canvas: Error loading background:",r))}(e,f,d)):i&&(l.backgroundColor=v),d.restore(),g.borders.forEach(function(e){!function(e,t,n){"transparent"!==n&&(e.setVariable("fillStyle",n),x(e,t),e.fill())}(d,e.args,e.color)}),n||function(e,t){var n=L(e,":before"),i=L(e,":after");(n||i)&&(n&&(e.className+=" "+p+"-before",e.parentNode.insertBefore(n,e),z(n,t,!0),e.parentNode.removeChild(n),e.className=e.className.replace(p+"-before","").trim()),i&&(e.className+=" "+p+"-after",e.appendChild(i),z(i,t,!0),e.removeChild(i),e.className=e.className.replace(p+"-after","").trim()))}(e,l),e.nodeName){case"IMG":(r=C(e.getAttribute("src")))?k(d,e,r,o,u):s.log("html2canvas: Error loading <img>:"+e.getAttribute("src"));break;case"INPUT":/^(text|url|email|submit|button|reset)$/.test(e.type)&&(e.value||e.placeholder||"").length>0&&A(e,o,l);break;case"TEXTAREA":(e.value||e.placeholder||"").length>0&&A(e,o,l);break;case"SELECT":(e.options||e.placeholder||"").length>0&&A(e,o,l);break;case"LI":E(e,l,f);break;case"CANVAS":k(d,e,e,o,u)}return l}function z(e,t,n){(function(e){return"none"!==h(e,"display")&&"hidden"!==h(e,"visibility")&&!e.hasAttribute("data-html2canvas-ignore")})(e)&&(t=H(e,t,n,!1)||t,c.test(e.nodeName)||W(e,t,n))}function W(e,t,n){s.Children(e).forEach(function(i){i.nodeType===i.ELEMENT_NODE?z(i,t,n):i.nodeType===i.TEXT_NODE&&T(e,i,t)})}return B=h(t.documentElement,"backgroundColor"),W(a,U=H(a,null,!1,F=s.isTransparent(B)&&a===t.body)),F&&(B=U.backgroundColor),d.removeChild(f),{backgroundColor:B,stack:U}},l.Preload=function(i){var r,a,o,s,u={numLoaded:0,numFailed:0,numTotal:0,cleanupDone:!1},c=l.Util,d=0,h=i.elements[0]||t.body,p=h.ownerDocument,f=h.getElementsByTagName("img"),g=f.length,m=p.createElement("a"),v=(new Image).crossOrigin!==n;function y(){c.log("html2canvas: start: images: "+u.numLoaded+" / "+u.numTotal+" (failed: "+u.numFailed+")"),!u.firstRun&&u.numLoaded>=u.numTotal&&(c.log("Finished loading images: # "+u.numTotal+" (failed: "+u.numFailed+")"),"function"==typeof i.complete&&i.complete(u))}function b(t,r,a){var o,s,l=i.proxy;m.href=t,t=m.href,o="html2canvas_"+d++,a.callbackname=o,l.indexOf("?")>-1?l+="&":l+="?",l+="url="+encodeURIComponent(t)+"&callback="+o,s=p.createElement("script"),e[o]=function(t){"error:"===t.substring(0,6)?(a.succeeded=!1,u.numLoaded++,u.numFailed++,y()):(C(r,a),r.src=t),e[o]=n;try{delete e[o]}catch(e){}s.parentNode.removeChild(s),s=null,delete a.script,delete a.callbackname},s.setAttribute("type","text/javascript"),s.setAttribute("src",l),a.script=s,e.document.body.appendChild(s)}function _(t,n){var i=e.getComputedStyle(t,n),r=i.content;"url"===r.substr(0,3)&&a.loadImage(l.Util.parseBackgroundImage(r)[0].args[0]),E(i.backgroundImage,t)}function T(e){return e&&e.method&&e.args&&e.args.length>0}function E(e,t){var i;l.Util.parseBackgroundImage(e).filter(T).forEach(function(e){"url"===e.method?a.loadImage(e.args[0]):e.method.match(/\-?gradient$/)&&(i===n&&(i=l.Util.Bounds(t)),function(e,t){var i=l.Generate.Gradient(e,t);i!==n&&(u[e]={img:i,succeeded:!0},u.numTotal++,u.numLoaded++,y())}(e.value,i))})}function C(t,r){t.onload=function(){r.timer!==n&&e.clearTimeout(r.timer),u.numLoaded++,r.succeeded=!0,t.onerror=t.onload=null,y()},t.onerror=function(){if("anonymous"===t.crossOrigin&&(e.clearTimeout(r.timer),i.proxy)){var n=t.src;return t=new Image,r.img=t,t.src=n,void b(t.src,t,r)}u.numLoaded++,u.numFailed++,r.succeeded=!1,t.onerror=t.onload=null,y()}}for(m.href=e.location.href,r=m.protocol+m.host,a={loadImage:function(e){var t,a,o;e&&u[e]===n&&(t=new Image,e.match(/data:image\/.*;base64,/i)?(t.src=e.replace(/url\(['"]{0,}|['"]{0,}\)$/gi,""),a=u[e]={img:t},u.numTotal++,C(t,a)):(o=e,m.href=o,m.href=m.href,m.protocol+m.host===r||!0===i.allowTaint?(a=u[e]={img:t},u.numTotal++,C(t,a),t.src=e):v&&!i.allowTaint&&i.useCORS?(t.crossOrigin="anonymous",a=u[e]={img:t},u.numTotal++,C(t,a),t.src=e):i.proxy&&(a=u[e]={img:t},u.numTotal++,b(e,t,a))))},cleanupDOM:function(r){var a,o;if(!u.cleanupDone){for(o in r&&"string"==typeof r?c.log("html2canvas: Cleanup because: "+r):c.log("html2canvas: Cleanup after timeout: "+i.timeout+" ms."),u)if(u.hasOwnProperty(o)&&"object"==typeof(a=u[o])&&a.callbackname&&a.succeeded===n){e[a.callbackname]=n;try{delete e[a.callbackname]}catch(e){}a.script&&a.script.parentNode&&(a.script.setAttribute("src","about:blank"),a.script.parentNode.removeChild(a.script)),u.numLoaded++,u.numFailed++,c.log("html2canvas: Cleaned up failed img: '"+o+"' Steps: "+u.numLoaded+" / "+u.numTotal)}e.stop!==n?e.stop():t.execCommand!==n&&t.execCommand("Stop",!1),t.close!==n&&t.close(),u.cleanupDone=!0,r&&"string"==typeof r||y()}},renderingDone:function(){s&&e.clearTimeout(s)}},i.timeout>0&&(s=e.setTimeout(a.cleanupDOM,i.timeout)),c.log("html2canvas: Preload starts: finding background-images"),u.firstRun=!0,function e(t){var i,r=!1;try{c.Children(t).forEach(e)}catch(e){}try{r=t.nodeType}catch(e){r=!1,c.log("html2canvas: failed to access some element's nodeType - Exception: "+e.message)}if(1===r||r===n){_(i=t,":before"),_(i,":after");try{E(c.getCSS(t,"backgroundImage"),t)}catch(e){c.log("html2canvas: failed to get background-image - Exception: "+e.message)}E(t)}}(h),c.log("html2canvas: Preload: Finding images"),o=0;o<g;o+=1)a.loadImage(f[o].getAttribute("src"));return u.firstRun=!1,c.log("html2canvas: Preload: Done."),u.numTotal===u.numLoaded&&y(),a},l.Renderer=function(e,i){return function(e){var t;if("string"==typeof i.renderer&&l.Renderer[e]!==n)t=l.Renderer[e](i);else{if("function"!=typeof e)throw new Error("Unknown renderer");t=e(i)}if("function"!=typeof t)throw new Error("Invalid renderer defined");return t}(i.renderer)(e,i,t,function(e){var t=[];return function e(n){Object.keys(n).sort().forEach(function(i){var r=[],a=[],o=[],s=[];n[i].forEach(function(e){e.node.zIndex.isPositioned||e.node.zIndex.opacity<1?o.push(e):e.node.zIndex.isFloated?a.push(e):r.push(e)}),function e(t){t.forEach(function(t){s.push(t),t.children&&e(t.children)})}(r.concat(a,o)),s.forEach(function(n){n.context?e(n.context):t.push(n.node)})})}(function(e){var t={};return function e(t,i,r){var a="auto"===i.zIndex.zindex?0:Number(i.zIndex.zindex),o=t,s=i.zIndex.isPositioned,l=i.zIndex.isFloated,u={node:i},c=r;i.zIndex.ownStacking?(o=u.context={"!":[{node:i,children:[]}]},c=n):(s||l)&&(c=u.children=[]),0===a&&r?r.push(u):(t[a]||(t[a]=[]),t[a].push(u)),i.zIndex.children.forEach(function(t){e(o,t,c)})}(t,e),t}(e)),t}(e.stack),l)},l.Util.Support=function(e,t){return{rangeBounds:(a=!1,t.createRange&&(i=t.createRange()).getBoundingClientRect&&((r=t.createElement("boundtest")).style.height="123px",r.style.display="block",t.body.appendChild(r),i.selectNode(r),123===i.getBoundingClientRect().height&&(a=!0),t.body.removeChild(r)),a),svgRendering:e.svgRendering&&function(){var e=new Image,i=t.createElement("canvas"),r=i.getContext!==n&&i.getContext("2d");if(!1===r)return!1;i.width=i.height=10,e.src=["data:image/svg+xml,","<svg xmlns='http://www.w3.org/2000/svg' width='10' height='10'>","<foreignObject width='10' height='10'>","<div xmlns='http://www.w3.org/1999/xhtml' style='width:10;height:10;'>","sup","</div>","</foreignObject>","</svg>"].join("");try{r.drawImage(e,0,0),i.toDataURL()}catch(e){return!1}return l.Util.log("html2canvas: Parse: SVG powered rendering available"),!0}()};var i,r,a},e.html2canvas=function(t,n){var i,r,a={logging:!1,elements:t=t.length?t:[t],background:"#fff",proxy:null,timeout:0,useCORS:!1,allowTaint:!1,svgRendering:!1,ignoreElements:"IFRAME|OBJECT|PARAM",useOverflow:!0,letterRendering:!1,chinese:!1,width:null,height:null,taintTest:!0,renderer:"Canvas"};return a=l.Util.Extend(n,a),l.logging=a.logging,a.complete=function(e){"function"==typeof a.onpreloaded&&!1===a.onpreloaded(e)||(i=l.Parse(e,a),"function"==typeof a.onparsed&&!1===a.onparsed(i)||(r=l.Renderer(i,a),"function"==typeof a.onrendered&&a.onrendered(r)))},e.setTimeout(function(){l.Preload(a)},0),{render:function(e,t){return l.Renderer(e,l.Util.Extend(t,a))},parse:function(e,t){return l.Parse(e,l.Util.Extend(t,a))},preload:function(e){return l.Preload(l.Util.Extend(e,a))},log:l.Util.log}},e.html2canvas.log=l.Util.log,e.html2canvas.Renderer={Canvas:n},l.Renderer.Canvas=function(e){e=e||{};var i=t,r=[],a=t.createElement("canvas"),o=a.getContext("2d"),s=l.Util,u=e.canvas||i.createElement("canvas");function c(t,n){switch(n.type){case"variable":t[n.name]=n.arguments;break;case"function":switch(n.name){case"createPattern":if(n.arguments[0].width>0&&n.arguments[0].height>0)try{t.fillStyle=t.createPattern(n.arguments[0],"repeat")}catch(e){s.log("html2canvas: Renderer: Error creating pattern",e.message)}break;case"drawShape":!function(e,t){e.beginPath(),t.forEach(function(t){e[t.name].apply(e,t.arguments)}),e.closePath()}(t,n.arguments);break;case"drawImage":n.arguments[8]>0&&n.arguments[7]>0&&(!e.taintTest||e.taintTest&&function(e){if(-1===r.indexOf(e.arguments[0].src)){o.drawImage(e.arguments[0],0,0);try{o.getImageData(0,0,1,1)}catch(e){return a=i.createElement("canvas"),o=a.getContext("2d"),!1}r.push(e.arguments[0].src)}return!0}(n))&&t.drawImage.apply(t,n.arguments);break;default:t[n.name].apply(t,n.arguments)}}}return function(e,t,i,r,a){var o,l,d,h=u.getContext("2d"),p=e.stack;return u.width=u.style.width=t.width||p.ctx.width,u.height=u.style.height=t.height||p.ctx.height,d=h.fillStyle,h.fillStyle=s.isTransparent(p.backgroundColor)&&t.background!==n?t.background:e.backgroundColor,h.fillRect(0,0,u.width,u.height),h.fillStyle=d,r.forEach(function(e){h.textBaseline="bottom",h.save(),e.transform.matrix&&(h.translate(e.transform.origin[0],e.transform.origin[1]),h.transform.apply(h,e.transform.matrix),h.translate(-e.transform.origin[0],-e.transform.origin[1])),e.clip&&(h.beginPath(),h.rect(e.clip.left,e.clip.top,e.clip.width,e.clip.height),h.clip()),e.ctx.storage&&e.ctx.storage.forEach(function(e){c(h,e)}),h.restore()}),s.log("html2canvas: Renderer: Canvas renderer done - returning canvas obj"),1===t.elements.length&&"object"==typeof t.elements[0]&&"BODY"!==t.elements[0].nodeName?(l=a.Util.Bounds(t.elements[0]),(o=i.createElement("canvas")).width=Math.ceil(l.width),o.height=Math.ceil(l.height),(h=o.getContext("2d")).drawImage(u,l.left,l.top,l.width,l.height,0,0,l.width,l.height),u=null,o):u}}}(window,document),org.ekstep.pluginframework.pluginManager.registerPlugin({id:"org.ekstep.stage",ver:"1.0",author:"Santhosh Vasabhaktula",title:"Stage Plugin",description:"",publishedDate:"",editor:{main:"editor/plugin.js",dependencies:[{type:"js",src:"editor/libs/html2canvas.js"}],help:{src:"editor/help.md",dataType:"text"},menu:[{id:"stage",category:"main",type:"icon",toolTip:"Add Slide",title:"Stage",iconClass:"icon-newstage icon",onclick:{id:"stage:create",data:{position:"afterCurrent"}},submenu:[{id:"beginning",type:"icon",title:"Beginning",iconClass:"fast backward icon",onclick:{id:"stage:create",data:{position:"beginning"}}},{id:"end",type:"icon",title:"End",iconClass:"fast forward icon",onclick:{id:"stage:create",data:{position:"end"}}},{id:"front",type:"icon",title:"After current",iconClass:"forward icon",onclick:{id:"stage:create",data:{position:"afterCurrent"}}},{id:"back",type:"icon",title:"Before current",iconClass:"backward icon",onclick:{id:"stage:create",data:{position:"beforeCurrent"}}}]}],configManifest:[{propertyName:"genieControls",title:"Show Player Control",description:"Toggle genie controls",dataType:"boolean",required:!0,defaultValue:!0},{propertyName:"instructions",title:"Teacher Instructions",description:"Teacher Instructions",dataType:"textarea",required:!0,defaultValue:""},{propertyName:"color",title:"Background color",description:"Slide Background color",dataType:"colorpicker",required:!0,defaultValue:"#FFFFFF"}]},dependencies:[{type:"plugin",plugin:"org.ekstep.navigation",ver:"1.0",scope:"renderer"}]},org.ekstep.contenteditor.basePlugin.extend({type:"stage",thumbnail:void 0,onclick:void 0,currentObject:void 0,canvas:void 0,initialize:function(){ecEditor.addEventListener("stage:create",this.createStage,this),ecEditor.addEventListener("object:modified",this.modified,this),ecEditor.addEventListener("stage:modified",this.modified,this),ecEditor.addEventListener("object:selected",this.objectSelected,this),ecEditor.addEventListener("object:removed",this.objectRemoved,this)},createStage:function(e,t){ecEditor.instantiatePlugin(this.manifest.id,t)},newInstance:function(){var e;this.onclick={id:"stage:select",data:{stageId:this.id}},this.ondelete={id:"stage:delete",data:{stageId:this.id}},this.duplicate={id:"stage:duplicate",data:{stageId:this.id}},this.editorData.stageECML?(e=JSON.parse(this.editorData.stageECML.config.__cdata),this.addConfig("color",e.color||"#FFFFFF"),this.setSlideBackground(e.color||"#FFFFFF")):this.addConfig("color",this.config.color||"#FFFFFF"),ecEditor.addStage(this),this.attributes={x:0,y:0,w:720,h:405,id:this.id},this.addConfig("instructions",this.getParam("instructions")||"")},getOnClick:function(){return{id:"stage:select",data:{stageId:this.id,prevStageId:ecEditor.getCurrentStage().id}}},setCanvas:function(e){this.canvas=e},addChild:function(e){this.children.push(e),e.editorObj&&(this.canvas.add(e.editorObj),e.editorObj.selectable&&this.canvas.setActiveObject(e.editorObj),this.setThumbnail(),ecEditor.dispatchEvent("stage:modified",{id:e.id}))},setThumbnail:function(){var e;org.ekstep.contenteditor.stageManager.contentLoading?this.thumbnail=this.canvas.toDataURL({format:"jpeg",quality:.1}):((e=ecEditor.getCurrentStage()).canvas,html2canvas($("#canvas-wrapper"),{onrendered:function(t){e.thumbnail=t.toDataURL({format:"jpeg",quality:.1}),org.ekstep.contenteditor.stageManager.thumbnails[e.id]=e.thumbnail,t=ecEditor.getAngularScope(),ecEditor.ngSafeApply(t)}}))},updateZIndex:function(){var e=this;ecEditor._.forEach(this.children,function(t){t.editorObj?t.attributes["z-index"]=e.canvas.getObjects().indexOf(t.editorObj):t.attributes["z-index"]=_.isUndefined(t.attributes["z-index"])?e.canvas.getObjects().length:t.attributes["z-index"]})},render:function(e){var t=this;org.ekstep.contenteditor.stageManager.clearCanvas(e),this.children=ecEditor._.sortBy(this.children,[function(e){return e.getAttribute("z-index")}]),ecEditor._.forEach(this.children,function(t){t.render(e)}),this.config.color&&e.setBackgroundColor(this.config.color,e.renderAll.bind(e)),e.renderAll(),ecEditor.dispatchEvent("stage:render:complete",{stageId:this.id}),org.ekstep.contenteditor.stageManager.contentLoading?this.thumbnail=e.toDataURL({format:"jpeg",quality:.1}):(t=this,html2canvas($("#canvas-wrapper"),{onrendered:function(e){t.thumbnail=e.toDataURL({format:"jpeg",quality:.1}),e=ecEditor.getAngularScope(),ecEditor.ngSafeApply(e)},timeout:0})),ecEditor.refreshStages(),ecEditor.dispatchEvent("stage:render:complete",{stageId:this.id})},modified:function(e,t){ecEditor.getCurrentStage().updateZIndex(),ecEditor.getCurrentStage().setThumbnail(),ecEditor.refreshStages()},objectSelected:function(e,t){var n;ecEditor._.isUndefined(this.currentObject)||this.currentObject===t.id||(n=ecEditor.getPluginInstance(this.currentObject),ecEditor.getCanvas().trigger("selection:cleared",{target:n.editorObj})),this.currentObject=t.id},objectRemoved:function(e,t){this.currentObject=void 0},destroyOnLoad:function(e,t,n){var i=this;e==i.children.length?(t.clear(),i.render(t),$("#"+i.id).remove(),n()):setTimeout(function(){i.destroyOnLoad(e,t,n)},1e3)},getConfigManifest:function(){return this.manifest.editor.configManifest},getConfig:function(){var e=this._super();return e.genieControls=ecEditor.getAngularScope().showGenieControls,e},onConfigChange:function(e,t){switch(e){case"instructions":this.addParam("instructions",t);break;case"genieControls":var n;t!==ecEditor.getAngularScope().showGenieControls&&(n=ecEditor.getAngularScope(),ecEditor.ngSafeApply(n,function(){n.toggleGenieControl()}));break;case"color":this.setSlideBackground(t),ecEditor.dispatchEvent("stage:modified"),ecEditor.render(),ecEditor.dispatchEvent("object:modified",{target:ecEditor.getEditorObject()})}},setSlideBackground:function(e){var t;ecEditor._.forEach(ecEditor.getCurrentStage().children,function(e){"slidebackground"==e.attributes.subtype&&(t=e)}),t?t.attributes.fill=e:"#FFFFFF"!==e&&ecEditor.instantiatePlugin("org.ekstep.shape",{type:"rect",subtype:"slidebackground",x:0,y:0,fill:e,w:100,h:100,stroke:"rgba(255, 255, 255, 0)",strokeWidth:1,opacity:1,"z-index":-999},ecEditor.getCurrentStage()),ecEditor.getCurrentStage().canvas.backgroundColor=e,this.config.color=e},updateThumbnail:function(){$("<canvas>").attr({id:this.id}).css({width:"720px",height:"405px"}).appendTo("#thumbnailCanvasContainer"),canvas=new fabric.Canvas(this.id,{backgroundColor:"#FFFFFF",preserveObjectStacking:!0,width:720,height:405}),this.render(canvas),ecEditor.jQuery("#"+this.id).remove()}}))},function(e,t,n){fabric.ITextbox=fabric.util.createClass(fabric.Textbox,fabric.Observable,{type:"i-textbox",initialize:function(e,t){this.ctx=fabric.util.createCanvasElement().getContext("2d"),this.callSuper("initialize",e,t)},_measureText:function(e,t,n,i){return e.measureText(t).width},_measureLine:function(e,t){var n,i=this._textLines[t],r=e.measureText(i).width,a=0;return 0!==this.charSpacing&&(a=(i.split("").length-1)*this._getWidthOfCharSpacing()),(n=r+a)>0?n:0},_setTextStyles:function(e){e.textAlign="left",e.font=this._getFontDeclaration()}}),fabric.ITextbox.fromObject=function(e){return new fabric.ITextbox(e.text,fabric.util.object.clone(e))},fabric.ITextbox.instances=[];var i=function(){var e=ecEditor.jQuery("#authoringTextEditor"),t=ecEditor.jQuery("#authoringTextEditorBtn"),n=ecEditor.jQuery("#authoringTextEditorCancel"),i=ecEditor.jQuery("<div>",{style:"margin-top: 6px; margin-right: 6px;"});function r(){ecEditor.getPluginInstance(pluginId).editorObj.remove(),ecEditor.render(),ecEditor.dispatchEvent("object:modified",{id:pluginId})}function a(){$buttonGrp.hide(),n.hide(),e.hide(),t.hide(),ecEditor.jQuery("#toolbarOptions").show()}function o(e){e&&ecEditor.getService(ServiceConstants.TELEMETRY_SERVICE).interact({id:e.id,type:e.type,subtype:e.subtype,target:e.target,pluginid:"org.ekstep.text",pluginver:"1.0",objectid:"",stage:ecEditor.getCurrentStage().id})}return $buttonGrp=ecEditor.jQuery("<div>",{class:"ui buttons",id:"texteditorBtnGrp",style:"float: right;"}),$orBtn=ecEditor.jQuery("<div>",{class:"or"}),pluginId=void 0,editorText=void 0,{showEditor:function(s){if(pluginId=s,editorText=ecEditor.getPluginInstance(pluginId).editorObj.text,e.length)e.show().val(editorText);else{var l=ecEditor.jQuery("<div>",{class:"ui form",id:"textEditorContainer",style:"margin-left: 10px; margin-top: 10px;"});l.css({top:ecEditor.jQuery("#canvas").offset().top,left:ecEditor.jQuery("#canvas").offset().left,position:"absolute"});var u=ecEditor.jQuery("<div>",{class:"field"});l.appendTo("body"),u.appendTo(l),ecEditor.jQuery(document.createElement("textarea")).text(editorText).attr({id:"authoringTextEditor",placeholder:"Add text here",rows:12}).css({width:"30.5em"}).appendTo(u),e=ecEditor.jQuery("#authoringTextEditor"),i.insertAfter(e),i.append($buttonGrp)}t.length?t.show():t=ecEditor.jQuery("<button>",{text:"Done",id:"authoringTextEditorBtn",class:"ui primary button"}).click(function(){o({id:"button",type:"click",subtype:"done",target:"addString"}),a(),e.val().trim().length?(ecEditor.getPluginInstance(pluginId).editorObj.text=e.val(),ecEditor.getPluginInstance(pluginId).config.text=e.val(),ecEditor.render(),ecEditor.dispatchEvent("object:modified",{target:ecEditor.getPluginInstance(pluginId).editorObj}),ecEditor.jQuery("#toolbarOptions").show()):r(),e.val("")}),n.length?n.show():n=ecEditor.jQuery("<button>",{text:"Cancel",id:"authoringTextEditorCancel",class:"ui secondary button"}).click(function(){o({id:"button",type:"click",subtype:"cancel",target:"cancelTextEditor"}),a(),editorText.trim().length||r()}),$buttonGrp.append(n),$buttonGrp.append($orBtn),$buttonGrp.append(t),$buttonGrp.show();var c=ecEditor.getAngularScope();ecEditor.ngSafeApply(c,function(){c.configStyle=""})},hide:function(){e.val("").hide(),$buttonGrp.hide(),t.hide(),n.hide();var i=ecEditor.getAngularScope();ecEditor.ngSafeApply(i,function(){i.configStyle=""})},generateTelemetry:o}}();org.ekstep.text={},org.ekstep.text.MultilineTransliterator=Class.extend({error:"error",init:function(e,t){this.$q=e,this.transliterateService=t},transliterate:function(e,t,n){var i=this,r=this.$q,a=_.map(e.split("\n"),encodeURI);(function(e){return r.all(function(e,t){if(angular.isArray(e))return e.map(t);var n={};return Object.keys(e).forEach(function(i,r){n[i]=t(e[i])}),n}(e,function(e){return e.then?e.then(function(e){return{state:"fulfilled",value:e}},function(e){return{state:"rejected",reason:e}}):{state:"fulfilled",value:e}}))})(_.map(a,function(e){var n={};return n.text=e,n.languages=[t],""==e&&(n.text=" "),function(e,t){var n=r.defer();return e(t,function(e,t){e?n.reject(e):n.resolve(t)}),n.promise}(i.transliterateService.getTransliteration.bind(i.transliterateService),n)})).then(function(e){i.error="";var r=_.map(e,function(e,n){if("fulfilled"==e.state&&void 0!=e.value.data.result.transliterations[t]){var r=e.value.data.result.transliterations[t].output;return r?decodeURIComponent(r):(i.error="Transliteration unavailable at the moment",decodeURIComponent(a[n]))}return i.error="Transliteration unavailable at the moment",decodeURIComponent(a[n])}).join("\n");n(i.error,r)})}}),org.ekstep.text.MultilineTransliterator.create=function(e,t){return new org.ekstep.text.MultilineTransliterator(e,t)},org.ekstep.text.WordExtractor=Class.extend({extractText:function(){var e=org.ekstep.contenteditor.api.getCurrentObject();if(e&&"org.ekstep.text"==e.manifest.id)return e.editorObj.text}}),window.TextWYSIWYG=function(){function e(e,t){switch(e){case _constants.lineHeight:_textInstance.attributes.lineHeight=t,_textInstance.editorObj.lineHeight=t;break;case _constants.align:_textInstance.attributes.align=t,_textInstance.editorObj.setTextAlign(t);break;case _constants.offsetY:_textInstance.attributes.offsetY=t}}return fontMap={NotoSans:{offsetY:.04,lineHeight:1},NotoSansKannada:{offsetY:.24,lineHeight:1},NotoNastaliqUrdu:{offsetY:-.65,align:"right",lineHeight:2},default:{offsetY:.2,lineHeight:1}},_constants={textType:"text",lineHeight:"lineHeight",align:"align",offsetY:"offsetY",default:"default"},_textInstance=void 0,{setInstance:function(t){if(t.attributes.textType===_constants.textType){_textInstance=t;var n=fontMap[_textInstance.attributes.fontFamily]||fontMap[_constants.default];e(_constants.lineHeight,n.lineHeight),e(_constants.offsetY,n.offsetY),ecEditor.render()}},resetProperties:function(e){delete e.attributes.offsetY,delete e.attributes.lineHeight,delete e.editorObj.lineHeight}}}(),org.ekstep.pluginframework.pluginManager.registerPlugin({id:"org.ekstep.text",ver:"1.2",shortId:"org.ekstep.text",displayName:"Text",author:"Santhosh Vasabhaktula",title:"Text Plugin",description:"",publishedDate:"",editor:{main:"editor/plugin.js",dependencies:[{type:"js",src:"editor/texteditor.js"},{type:"js",src:"editor/multilineTransliterator.js"},{type:"js",src:"editor/textWYSIWYG.js"},{type:"css",src:"editor/style/plugin.css"}],views:[{template:"./delete_confirmation_dialog.html",controller:""},{template:"./transliterationconfig.html",controller:"./transliterationapp.js"}],menu:[{id:"org.ekstep.text",category:"main",type:"icon",toolTip:"Add Text",title:"Text",iconClass:"fa fa-font",onclick:{id:"org.ekstep.text:create",data:{__text:"",x:10,y:20,fontFamily:"'Noto Sans', 'Noto Sans Bengali', 'Noto Sans Malayalam', 'Noto Sans Gurmukhi', 'Noto Sans Devanagari', 'Noto Sans Gujarati', 'Noto Sans Telugu', 'Noto Sans Tamil', 'Noto Sans Kannada', 'Noto Sans Oriya', 'Noto Nastaliq Urdu', -apple-system, BlinkMacSystemFont, Roboto, Oxygen-Sans, Ubuntu, Cantarell, 'Helvetica Neue'",fontSize:18,minWidth:20,w:35,maxWidth:500,fill:"#000000",fontStyle:"normal",fontWeight:"normal",stroke:"rgba(255, 255, 255, 0)",strokeWidth:1,opacity:1,editable:!1,lineHeight:1,version:"V2",offsetY:.2}},submenu:[{id:"beginning",type:"icon",title:"Add Richtext",iconClass:"",onclick:{id:"org.ekstep.richtext:showpopup"}}]}],behaviour:{rotatable:!0},configManifest:[{type:"custom_template",controllerURL:"editor/config-controller.js",templateURL:"editor/configTemplate.html"}],help:{src:"editor/help.md",dataType:"text"},"init-data":{__text:"",x:10,y:20,"font-family":"'Noto Sans', 'Noto Sans Bengali', 'Noto Sans Malayalam', 'Noto Sans Gurmukhi', 'Noto Sans Devanagari', 'Noto Sans Gujarati', 'Noto Sans Telugu', 'Noto Sans Tamil', 'Noto Sans Kannada', 'Noto Sans Oriya', 'Noto Nastaliq Urdu', -apple-system, BlinkMacSystemFont, Roboto, Oxygen-Sans, Ubuntu, Cantarell, 'Helvetica Neue'",fontSize:18,minWidth:20,w:35,maxWidth:500,fill:"#000000",fontStyle:"normal",fontWeight:"normal"}},renderer:{main:"renderer/supertextplugin.js"}},org.ekstep.contenteditor.basePlugin.extend({type:"org.ekstep.text",magicNumber:1920,editorWidth:720,supportedFonts:["NotoSans","NotoSansBengali","NotoSansDevanagari","NotoSansGujarati","NotoSansGurmukhi","NotoSansKannada","NotoSansMalayalam","NotoSansOriya","NotoSansTamil","NotoSansTelugu","NotoNastaliqUrdu"],constants:{v2supportedText:"text",createJsLineHeight:1.3},initialize:function(){var e=this;ecEditor.addEventListener(this.type+":showpopup",this.loadHtml,this),ecEditor.addEventListener("object:unselected",this.objectUnselected,this),ecEditor.addEventListener("stage:unselect",this.stageUnselect,this),ecEditor.addEventListener(this.type+":readalong:show",this.showReadalong,this),ecEditor.addEventListener(this.type+":wordinfo:show",this.showWordInfo,this),ecEditor.addEventListener(this.type+":delete:enhancement",this.deleteEnhancement,this),ecEditor.addEventListener(this.type+":modified",this.modifyText,this),ecEditor.resolvePluginResource(e.manifest.id,e.manifest.ver,"editor/delete_confirmation_dialog.html"),ecEditor.getService("popup").loadNgModules(n(37),void 0,!0),ecEditor.resolvePluginResource(e.manifest.id,e.manifest.ver,"editor/transliterationconfig.html"),ecEditor.resolvePluginResource(e.manifest.id,e.manifest.ver,"editor/transliterationapp.js"),org.ekstep.contenteditor.api.getService(ServiceConstants.POPUP_SERVICE).loadNgModules(n(38),n(39),!0)},modifyText:function(e){this.checkMigrate(),this.dblClickHandler(e)},checkMigrate:function(){this.isV2Plugin(ecEditor.getCurrentObject())||ecEditor.dispatchEvent(this.type+":migrate",ecEditor.getCurrentObject())},loadHtml:function(){var e=this;org.ekstep.contenteditor.api.getService(ServiceConstants.POPUP_SERVICE).open({template:"transliteration",controller:"transliterationController",controllerAs:"$ctrl",resolve:{instance:function(){return e}},width:900,showClose:!1})},createTransliteratedText:function(e){var t=org.ekstep.contenteditor.api.getCurrentObject();e={__text:e,x:30,y:30,w:300,h:500,fontFamily:"NotoSans",fontSize:18,minWidth:20,maxWidth:500,fill:"#000"},t&&(e.x=t.attributes.x,e.y=t.attributes.y,e.w=t.attributes.w,e.h=t.attributes.h,e.fontFamily=t.attributes.fontFamily,e.fontSize=t.attributes.fontSize,e.minWidth=t.attributes.minWidth,e.maxWidth=t.attributes.maxWidth,e.color=t.attributes.color,this.pixelToPercent(e),e=this.getOffsetPosition(e)),org.ekstep.contenteditor.api.instantiatePlugin(t.type,e,org.ekstep.contenteditor.api.getCurrentStage())},getOffsetPosition:function(e){return e.x+e.w<50?e.x=50:50<=e.x?e.x=12:e.y+e.h<50?e.y=50:50<=e.y?e.y=12:(e.x+=20,e.y+=20),e},newInstance:function(){var e=this.convertToFabric(this.attributes);delete e.__text,ecEditor._.isUndefined(this.config.text)&&(this.config.text=ecEditor._.isUndefined(this.attributes.__text)?"":this.attributes.__text),ecEditor._.isUndefined(this.attributes.__text)||delete this.attributes.__text,e.editable=!1,this.editorObj=new fabric.ITextbox(this.config.text,e),""==this.config.text&&i.showEditor(this.id),ecEditor._.isUndefined(this.attributes.timings)&&"readalong"!==this.attributes.textType?ecEditor._.isUndefined(this.attributes.words)&&"wordinfo"!==this.attributes.textType?this.attributes.textType="text":(this.addMedia({id:"org.ekstep.text.popuptint",src:ecEditor.resolvePluginResource(this.manifest.id,this.manifest.ver,"assets/popuptint.png"),type:"image",assetId:"org.ekstep.text.popuptint"}),this.addWordinfoconfigManifest(this)):(ecEditor._.isUndefined(this.attributes.textType)&&(this.attributes.textType="readalong",this.config.audio=this.attributes.audio,this.config.timings=this.attributes.timings,this.config.highlight=this.attributes.highlight,this.config.autoplay=this.attributes.autoplay,(e=ecEditor.getMedia(this.attributes.audio)).src=org.ekstep.contenteditor.mediaManager.getMediaOriginURL(e.src),ecEditor._.isUndefined(e.preload)&&(e.preload=!0),this.config.audioObj=e),this.addMedia(this.config.audioObj),this.addReadalongconfigManifest(this)),this.isV2Plugin()&&TextWYSIWYG.setInstance(this)},selected:function(e){fabric.util.addListener(fabric.document,"dblclick",this.dblClickHandler)},deselected:function(e,t,n){fabric.util.removeListener(fabric.document,"dblclick",this.dblClickHandler)},objectUnselected:function(e,t){fabric.util.removeListener(fabric.document,"dblclick",this.dblClickHandler)},dblClickHandler:function(e){var t=ecEditor.getCurrentObject().editorObj.getBoundingRect(),n=ecEditor.jQuery("#canvas").offset().left+ecEditor.getCurrentObject().editorObj.left,r=n+ecEditor.getCurrentObject().editorObj.width,a=ecEditor.jQuery("#canvas").offset().top+ecEditor.getCurrentObject().editorObj.top,o=a+ecEditor.getCurrentObject().editorObj.height;_.isObject(t)&&(n=ecEditor.jQuery("#canvas").offset().left+t.left,eftEnd=n+t.width,o=(a=ecEditor.jQuery("#canvas").offset().top+t.top)+t.height),e.clientX>n&&e.clientX<r&&e.clientY>a&&e.clientY<o&&i.showEditor(ecEditor.getEditorObject().id),i.generateTelemetry({type:"click",subtype:"doubleClick",target:"textEditor"})},stageUnselect:function(e){i.hide()},getAttributes:function(){var e=ecEditor._.omit(ecEditor._.clone(this.attributes),["top","left","width","height","fontFamily","fontfamily","fontSize","fontstyle","fontweight","scaleX","scaleY"]),t=(e.font=this.editorObj.get("fontFamily"),e.fontsize=this.updateFontSize(this.editorObj.get("fontSize"),!1),ecEditor._.isUndefined(this.editorObj.get("fontWeight"))||"bold"!==this.editorObj.get("fontWeight")?"":"bold"),n=ecEditor._.isUndefined(this.editorObj.get("fontStyle"))||"italic"!==this.editorObj.get("fontStyle")?"":"italic";return e.weight=(t+" "+n).trim(),e},onConfigChange:function(e,t){switch(e){case"fontweight":this.editorObj.setFontWeight(t?"bold":"normal"),this.attributes.fontweight=t;break;case"fontstyle":this.editorObj.setFontStyle(t?"italic":"normal"),this.attributes.fontstyle=t;break;case"fontfamily":this.editorObj.setFontFamily(t),this.attributes.fontFamily=t,this.attributes.fontfamily=t;break;case"fontsize":this.editorObj.setFontSize(t),this.attributes.fontSize=t;break;case"textcolor":this.editorObj.setFill(t),this.attributes.color=t;break;case"align":this.editorObj.setTextAlign(t),this.attributes.align=t;break;case"highlightcolorpicker":this.config.highlight=t;break;case"autoplay":this.config.autoplay=t;break;case"wordfontcolorpicker":this.config.wordfontcolor=t;break;case"wordhighlightcolorpicker":this.config.wordhighlightcolor=t;break;case"wordunderlinecolorpicker":this.config.wordunderlinecolor=t}this.isV2Plugin()&&TextWYSIWYG.setInstance(this),ecEditor.render(),ecEditor.dispatchEvent("object:modified",{target:ecEditor.getEditorObject()})},getConfig:function(){var e=this._super();return e.color=this.attributes.color||this.attributes.fill,e.fontfamily=this.attributes.fontFamily,e.fontsize=this.attributes.fontSize,e.fontweight=this.attributes.fontweight||!1,e.fontstyle=this.attributes.fontstyle||!1,e.align=this.attributes.align||"left",e},getProperties:function(){var e=ecEditor._.omitBy(ecEditor._.clone(this.attributes),ecEditor._.isObject);return delete(e=ecEditor._.omitBy(e,ecEditor._.isNaN)).__text,e.text=this.editorObj.text,this.pixelToPercent(e),e},updateFontSize:function(e,t){var n,i;return t?(n=this.attributes.w*(this.magicNumber/100),i=this.editorWidth*this.attributes.w/100,parseInt(Math.round(e*(i/n)).toString())):(n=this.editorObj.width/this.magicNumber*100,i=this.editorObj.width/this.editorWidth*100,t=e*(this.editorObj.scaleX||1),parseFloat((i/n*t).toFixed(2)))},convertToFabric:function(e){var t,n=ecEditor._.clone(e);return e.x&&(n.left=e.x),e.y&&(n.top=e.y),e.w&&(n.width=e.w),e.h&&(n.height=e.h),e.color&&(n.fill=e.color),e.weight&&ecEditor._.includes(e.weight,"bold")?(n.fontWeight="bold",e.fontweight=!0):e.fontweight=!1,e.weight&&ecEditor._.includes(e.weight,"italic")?(n.fontStyle="italic",e.fontstyle=!0):e.fontstyle=!1,e.font&&(n.fontFamily=e.font,e.fontFamily=e.font),e.fontsize&&(t=this.updateFontSize(e.fontsize,!0),n.fontSize=t,e.fontSize=t),e.align&&(n.textAlign=e.align,n.align=e.align),e.rotate&&(n.angle=e.rotate),this.isV2Plugin()||delete n.lineHeight,n},getConfigManifest:function(){var e=this._super();return ecEditor._.remove(e,function(e){return"stroke"===e.propertyName}),e},showReadalong:function(){var e=ecEditor.getCurrentObject();ecEditor.dispatchEvent("org.ekstep.readalongbrowser:showpopup",{textObj:e,callback:this.convertTexttoReadalong})},convertTexttoReadalong:function(e){var t=ecEditor.getCurrentObject(),n=ecEditor.getPluginInstance(t.id);TextWYSIWYG.resetProperties(t),t.config.text=t.editorObj.text=e.text,t.config.audio=e.audio,t.config.timings=e.timings,t.config.highlight=e.highlight,t.config.audioObj=e.audioObj,t.config.autoplay=e.autoplay,t.attributes.autoplay=e.autoplay,t.attributes.textType="readalong",i.hide(),e=e.audioObj,ecEditor._.isUndefined(e)||(e.src=org.ekstep.contenteditor.mediaManager.getMediaOriginURL(e.src)),t.addMedia(e),n.addReadalongconfigManifest(t),ecEditor.dispatchEvent("config:show"),ecEditor.render()},showWordInfo:function(){var e=ecEditor.getCurrentObject();ecEditor.dispatchEvent("org.ekstep.wordinfobrowser:showpopup",{textObj:e,callback:this.convertTexttoWordinfo})},convertTexttoWordinfo:function(e,t){var n=ecEditor.getCurrentObject(),i=ecEditor.getPluginInstance(n.id);TextWYSIWYG.resetProperties(n),n.data=t,n.config.text=n.editorObj.text=e.text,n.config.words=e.words,n.config.wordfontcolor=e.wordfontcolor,n.config.wordhighlightcolor=e.wordhighlightcolor,n.config.wordunderlinecolor=e.wordunderlinecolor,n.attributes.textType="wordinfo",n.addMedia({id:"org.ekstep.text.popuptint",src:ecEditor.resolvePluginResource(i.manifest.id,i.manifest.ver,"assets/popuptint.png"),type:"image",assetId:"org.ekstep.text.popuptint"}),i.addWordinfoconfigManifest(n),ecEditor.dispatchEvent("config:show"),ecEditor.render()},deleteEnhancement:function(){ecEditor.getService("popup").open({template:"deleteConfirmationDialog",controller:["$scope",function(e){e.warningMessage="readalong"==ecEditor.getCurrentObject().attributes.textType?"Read-Along":"Word Info Popup",e.delete=function(){e.closeThisDialog();var t=ecEditor.getCurrentObject();"readalong"==t.attributes.textType?(delete t.config.audio,delete t.config.timings,delete t.config.highlight,delete t.config.audioObj,delete t.config.autoplay,delete t.attributes.autoplay):(delete t.data,delete t.config.words,delete t.config.wordfontcolor,delete t.config.wordhighlightcolor,delete t.config.wordunderlinecolor),t.attributes.textType="text",ecEditor.dispatchEvent("config:show"),this.isV2Plugin()&&TextWYSIWYG.setInstance(this),ecEditor.render()}}],width:520,showClose:!1,closeByEscape:!1,closeByDocument:!1})},addReadalongconfigManifest:function(e){ecEditor.dispatchEvent("org.ekstep.text:addReadAlong",e)},addWordinfoconfigManifest:function(e){ecEditor.dispatchEvent("org.ekstep.text:addWordInfo",e)},getMedia:function(){return"text"===this.attributes.textType?{}:this._super()},toECML:function(){var e=this._super();return e.textType!==this.constants.v2supportedText&&(e.lineHeight=this.constants.createJsLineHeight),e},fromECML:function(){this._super(this.editorData),this.attributes.textType!==this.constants.v2supportedText&&delete this.attributes.lineHeight},isV2Plugin:function(e){return!(!(e=e||this).attributes.version||"V2"!==e.attributes.version)}}))},function(e,t){e.exports='<script type="text/ng-template" id="deleteConfirmationDialog">\n    <div class="ui container" style="margin: 0px;">\n        <div style="margin: 30px 10px 25px 0px;">\n            <div style=" display: inline;"><i class="huge warning sign yellow icon"></i></div>\n            <div style="text-align: center;margin: 10px;font-size: 17px;color: #5f5c5c; display: inline;" class="meta">\n                Are you sure you want to remove {{warningMessage}}?\n            </div>\n        </div>\n        <div style="margin-left: 139px;">\n            <button class="ui  primary button" ng-click="delete()">Okay</button>\n            <button class="ui  secondary orange button" ng-click="closeThisDialog()">Cancel</button>\n        </div>\n    </div>\n<\/script>'},function(e,t){e.exports='<script type="text/ng-template" ng-app="transliterationapp" ng-controller="transliterationController as $ctrl" id="transliteration">\n    <style type="text/css">\n    .filters-container {\n        padding: 8px 10px 4px 18px;\n        background: #f1f1f1;\n    }\n\n    .textWrapper {\n        font-size: 26px;\n        overflow-x: auto;\n        white-space: nowrap;\n        background-color: #efefef;\n        height: 75px;\n        display: flex;\n        align-items: center;\n    }\n\n    .helptext {\n        color: #ccc;\n    }\n\n    .words-div: {\n        width: 100%;\n    }\n\n    .words-list {\n        width: 22%;\n        float: left;\n        margin: 4px;\n    }\n\n    .panel {\n        margin-bottom: 20px;\n        background-color: #fff;\n        border: 1px solid transparent;\n        border-radius: 4px;\n        box-shadow: 0 1px 1px rgba(0, 0, 0, .05);\n    }\n\n    .panel-heading {\n        border: 0px;\n        color: #000;\n        background: #BAD9D4;\n        padding: 20px 15px;\n    }\n\n    .panel-body {\n        padding: 15px;\n    }\n\n    #div1 {\n        float: left;\n        margin: 10px;\n        padding: 10px;\n        border: solid 2px;\n        border-color: #C0C0C0;\n    }\n\n    .dragDiv {\n        margin: 20px;\n    }\n\n    .cursor-pointer {\n        cursor: pointer;\n    }\n\n    .error-msg {\n        color: red;\n    }\n\n    .ui.modal {\n        top: 10%;\n    }\n\n    .bottom-margin {\n        margin-bottom: 4%;\n    }\n\n    .top-margin {\n        margin-top: 6.4%;\n    }\n    .bottom-margin-leftText{\n        margin-bottom: 1.6%;\n    }\n    .ui.form textarea.no-resize {\n        resize: none;\n    }\n\n    .lang-dropdown {\n        width: 15vw;\n        margin-left:21%;\n    }\n\n    .textloader {\n        width: 100%;\n        height: 100%;\n        position: absolute;\n        top: 50;\n        left: 0;\n    }\n\n    .centerSpinner {\n        margin-top: 25%;\n    }\n\n    .warningText {\n        float: left;\n        padding-top: 1.5%;\n        padding-left:0.5%;\n        color: red;\n    }\n\n    .warningIcon {\n        padding-top: 1.5%;\n    }\n    .dropdownPos{\n        margin-left:21%;\n    }\n    .snapLeft{\n        padding-left:0% !important;\n    }\n    .snapRight{\n        padding-right:0% !important;\n    }\n\n    .ui.steps .step .title {\n        font-size: 1.5em;\n    }\n    .ui.steps .step .description{\n        font-size: 1.1em;\n    }\n    </style>\n    <div class="ui modal large active">\n        <h4 class="ui header">\n          <i class="browser icon"></i>\n          <div class="content">\n            Transliterator\n            <div class="sub header">Select an Indian language</div>\n          </div>\n        </h4>\n        <div class="content">\n            <div>\n                <div class="ui two column horizontally padded grid">\n                    <div class="six wide column snapLeft">\n                        <div class="row top-margin bottom-margin-leftText">\n                            <div call="field label">Original text:</div>\n                        </div>\n                        <div class="row bottom-margin">\n                            <div class="column">\n                                <div class="field ui fluid labeled input form">\n                                    <textarea class="no-resize" ng-model="$ctrl.originalText" cols="5" rows="16"></textarea>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                    <div class="snapRight six wide column">\n                        <div class="row bottom-margin">\n                            <select class="ui dropdown lang-dropdown" ng-model="$ctrl.selectedLanguage" ng-options="lang as lang.name for lang in $ctrl.languages">\n                                <option value="">Select language</option>\n                            </select>\n                            <div class="ui buttons pull-right">\n                                <button class="ui blue button" ng-click="$ctrl.transliterate()" ng-disabled="$ctrl.originalText == \'\' || $ctrl.selectedLanguage == null" type="button"> Transliterate </button>\n                            </div>\n                        </div>\n                        <div class="row bottom-margin">\n                            <div class="column">\n                                <div class="field ui fluid labeled input form">\n                                    <div class="textloader centerSpinner" ng-show="$ctrl.isLoading">\n                                        <div class="ui active centered inline loader"></div>\n                                    </div>\n                                    <div class="textloader">\n                                        <textarea class="no-resize" ng-model="$ctrl.transliteratedText" cols="5" rows="16"></textarea>\n                                    </div>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            </div>\n        </div>\n        <div class="actions">\n            <div class="warningText" ng-show="$ctrl.showError" ng-model="$ctrl.errorMsg">\n                <i class="warning sign icon warningIcon label"></i> {{$ctrl.errorMsg}}\n            </div>\n            <div class="ui buttons">\n                <button class="ui orange button" ng-click="$ctrl.cancel()" type="button">Cancel</button>\n                <div class="or"></div>\n                <button class="ui blue button" type="button" ng-disabled="$ctrl.transliteratedText == undefined || $ctrl.transliteratedText == \'\'" ng-click="$ctrl.addToStage()">Add to Stage</button>\n            </div>\n        </div>\n    </div>\n'},function(e,t,n){"use strict";angular.module("transliterationapp",[]).controller("transliterationController",["$scope","instance","$q",function(e,t,n){var i=this;i.originalText="",i.transliteratedText=void 0,i.languages=[],i.selectedLanguage=null,i.isLoading=!1,i.showError=!1,i.errorMsg="";var r=org.ekstep.contenteditor.api.getService(ServiceConstants.LANGUAGE_SERVICE),a=org.ekstep.text.MultilineTransliterator.create(n,r),o=new org.ekstep.text.WordExtractor;i.originalText=o.extractText(),i.transliterate=function(){var e=this;e.isLoading=!0,i.showError=!1,i.transliteratedText="",a.transliterate(i.originalText,i.selectedLanguage.code,function(t,n){i.transliteratedText=n,e.isLoading=!1,t&&(i.showError=!0,i.errorMsg=t)})},i.addToStage=function(){t.createTransliteratedText(i.transliteratedText),e.closeThisDialog()},r.getLanguages(function(e,t){e||(i.languages=_.map(t.data.result.languages,function(e){return{name:e.name,code:e.code}}))}),i.cancel=function(){e.closeThisDialog()}}])},function(e,t){org.ekstep.pluginframework.pluginManager.registerPlugin({id:"org.ekstep.shape",ver:"1.0",shortId:"shape",displayName:"Shape",author:"Santhosh Vasabhaktula",title:"Shape Plugin",description:"",publishedDate:"",editor:{main:"editor/plugin.js",dependencies:[],menu:[{id:"shape",category:"main",type:"icon",toolTip:"Add Shapes",title:"Shapes",iconClass:"icon-shape icon",submenu:[{id:"triangle",type:"icon",toolTip:"Add Triangle",title:"Triangle",iconClass:"icon-triangle icon",onclick:{id:"org.ekstep.shape:create",data:{type:"triangle",x:20,y:20,fill:"#00FF00",w:14,h:25,stroke:"rgba(255, 255, 255, 0)",strokeWidth:1,opacity:1}}},{id:"rectangle",type:"icon",toolTip:"Add Rectangle",title:"Rectangle",iconClass:"icon-rectangle icon",onclick:{id:"org.ekstep.shape:create",data:{type:"rect",x:10,y:20,fill:"#FFFF00",w:14,h:25,stroke:"rgba(255, 255, 255, 0)",strokeWidth:1,opacity:1}}},{id:"circle",type:"icon",toolTip:"Add Circle",title:"Circle",iconClass:"icon-circle icon",onclick:{id:"org.ekstep.shape:create",data:{type:"ellipse",x:15,y:15,fill:"#00FF00",w:18,h:32,stroke:"rgba(255, 255, 255, 0)",strokeWidth:1,opacity:1}}},{id:"rounded-rectangle",type:"icon",toolTip:"Add Rounded Rectangle",title:"Rounded Rectangle",iconClass:"icon-roundedrect icon",onclick:{id:"org.ekstep.shape:create",data:{type:"roundrect",x:20,y:20,fill:"#FF0000",w:14,h:25,radius:10,stroke:"rgba(255, 255, 255, 0)",strokeWidth:1,opacity:1}}},{id:"star",type:"icon",toolTip:"Add Star",title:"Star",iconClass:"star icon",onclick:{id:"org.ekstep.shape:create",data:{type:"star",x:20,y:20,fill:"#FF0000",w:14,h:25,corners:5,stroke:"rgba(255, 255, 255, 0)",strokeWidth:1,opacity:1}}},{id:"polygon",type:"icon",toolTip:"Add Polygon",title:"Polygon",iconClass:"first order icon",onclick:{id:"org.ekstep.shape:create",data:{type:"polygon",x:20,y:20,fill:"#FF0000",w:14,h:25,sides:5,stroke:"rgba(255, 255, 255, 0)",strokeWidth:1,opacity:1}}},{id:"trapezium",type:"icon",toolTip:"Add Trapezium",title:"Trapezium",iconClass:"road icon",onclick:{id:"org.ekstep.shape:create",data:{type:"trapezium",x:20,y:20,fill:"#FF0000",w:14,h:25,stroke:"rgba(255, 255, 255, 0)",strokeWidth:1,opacity:1}}},{id:"rarrow",type:"icon",toolTip:"Add Arrow",title:"Arrow",iconClass:"long right arrow icon",onclick:{id:"org.ekstep.shape:create",data:{type:"rarrow",x:20,y:20,fill:"#000000",w:30,h:25,stroke:"rgba(255, 255, 255, 0)",strokeWidth:1,opacity:1}}},{id:"harrow",type:"icon",toolTip:"Add double arrow",title:"Double Arrow",iconClass:"resize horizontal icon",onclick:{id:"org.ekstep.shape:create",data:{type:"harrow",x:20,y:20,fill:"#000000",w:30,h:25,stroke:"rgba(255, 255, 255, 0)",strokeWidth:1,opacity:1}}}]}],behaviour:{rotatable:!0},configManifest:[{propertyName:"color",title:"Fill Color",description:"Choose a color from the color picker",dataType:"colorpicker",required:!0,defaultValue:"#000000"},{propertyName:"opacity",title:"Transparency",description:"Set the transparency for element",dataType:"rangeslider",labelSuffix:"%",required:!0,defaultValue:100,minimumValue:0,maximumValue:100}],help:{src:"editor/help.md",dataType:"text"},"init-data":{type:"rect",x:10,y:20,fill:"#FFFF00",w:14,h:25}}},org.ekstep.contenteditor.basePlugin.extend({type:"shape",_points:void 0,shapeType:void 0,initialize:function(){},newInstance:function(){var e=this.convertToFabric(this.attributes);switch(this.attributes.type){case"ellipse":e.rx=e.w/2,e.ry=e.h/2,this.shapeType="ellipse",this.editorObj=new fabric.Ellipse(e);break;case"roundrect":this.manifest.editor.configManifest.push({propertyName:"radius",title:"Radius",placeholder:"Radius",description:"Input radius for the rounded rectangle",dataType:"input",valueType:"number",required:!1,defaultValue:10,minimumValue:0}),this.shapeType="roundrect",this.editorObj=new fabric.Rect(e);break;case"rect":this.shapeType="rect","slidebackground"!==e.subtype&&(this.editorObj=new fabric.Rect(e));break;case"triangle":e.sides=3,this.shapeType="3polygon",this.drawShape(this.shapeType,e);break;case"star":this.manifest.editor.configManifest.push({propertyName:"corners",title:"Corners",placeholder:"Corners",description:"No of corners for the star",dataType:"rangeslider",valueType:"number",required:!1,defaultValue:5,minimumValue:4,maximumValue:10});var t=e.corners;this.shapeType=t+"star",this.drawShape(this.shapeType,e);break;case"polygon":this.manifest.editor.configManifest.push({propertyName:"sides",title:"Sides",placeholder:"Sides",description:"No of sides for the shape",dataType:"rangeslider",valueType:"number",required:!1,defaultValue:5,minimumValue:4,maximumValue:10}),t=e.sides,this.shapeType=t+"polygon",this.drawShape(this.shapeType,e);break;case"trapezium":this.shapeType="trapezium",this.drawShape(this.shapeType,e);break;case"rarrow":this.shapeType="rarrow",this.drawShape(this.shapeType,e);break;case"harrow":this.shapeType="harrow",this.drawShape(this.shapeType,e)}this.editorObj&&this.editorObj.setFill(e.fill)},onConfigChange:function(e,t){switch(e){case"color":this.editorObj.setFill(t),this.attributes.fill=t;break;case"radius":"ellipse"==this.attributes.type&&(this.editorObj.set({w:2*t}),this.editorObj.set({h:2*t}),this.attributes.w=2*t,this.attributes.h=2*t),this.editorObj.set({rx:t}),this.editorObj.set({ry:t}),this.attributes.radius=t;break;case"sides":var n=t,i=(this.shapeType=n+"polygon",this.shapes[this.shapeType]);this.attributes.sides=n,this.editorObj.set({points:i});break;case"corners":n=t,this.shapeType=n+"star",i=this.shapes[this.shapeType],this.attributes.corners=n,this.editorObj.set({points:i})}ecEditor.render(),ecEditor.dispatchEvent("object:modified",{target:ecEditor.getEditorObject()})},getConfig:function(){var e=this._super();return e.color=this.attributes.fill,"roundrect"==this.attributes.type&&(e.radius=this.editorObj.rx),"ellipse"==this.attributes.type&&(e.radius=this.editorObj.rx),this.attributes.corners&&(e.corners=this.attributes.corners),this.attributes.sides&&(e.sides=this.attributes.sides),e.points=this.shapes[this.shapeType],e},drawShape:function(e,t){this._points=_.cloneDeep(this.shapes[e]),this.toPixel(this._points),t.strokeLineJoin="bevil",this.editorObj=new fabric.Polygon(this._points,t)},toPixel:function(e){var t=this;return e&&e.forEach(function(e){e.x=t.attributes.w*e.x/100,e.y=t.attributes.h*e.y/100}),e},changed:function(e,t,n){"roundrect"==e.attributes.type&&(e.editorObj.setWidth(e.editorObj.getWidth()-e.editorObj.getStrokeWidth()),e.editorObj.setHeight(e.editorObj.getHeight()-e.editorObj.getStrokeWidth()),e.editorObj.setScaleX(1),e.editorObj.setScaleY(1))},shapes:{"4star":[{x:100,y:50},{x:62.7,y:62.7},{x:50,y:100},{x:37.3,y:62.7},{x:0,y:50},{x:37.3,y:37.3},{x:50,y:0},{x:62.7,y:37.3}],"5star":[{x:50,y:0},{x:60.9,y:35},{x:100,y:35},{x:67.6,y:60},{x:79.4,y:100},{x:50,y:72},{x:20.6,y:100},{x:32.4,y:60},{x:0,y:35},{x:39.1,y:35}],"6star":[{x:50,y:100},{x:35,y:76},{x:0,y:75},{x:20,y:50},{x:0,y:25},{x:35,y:24},{x:50,y:0},{x:65,y:24},{x:100,y:25},{x:80,y:50},{x:100,y:75},{x:65,y:76}],"7star":[{x:100,y:59.8},{x:74,y:68},{x:72.9,y:100},{x:50.8,y:80},{x:29.6,y:100},{x:27.1,y:69.4},{x:0,y:62.5},{x:20.6,y:44.1},{x:10,y:19.9},{x:36.2,y:23.3},{x:48.6,y:0},{x:62.3,y:22.6},{x:88.2,y:17.7},{x:79,y:42.5}],"8star":[{x:100,y:50},{x:82.3,y:63.4},{x:85.4,y:85.4},{x:63.4,y:82.3},{x:50,y:100},{x:36.6,y:82.3},{x:14.6,y:85.4},{x:17.7,y:63.4},{x:0,y:50},{x:17.7,y:36.6},{x:14.6,y:14.6},{x:36.6,y:17.7},{x:50,y:0},{x:63.4,y:17.7},{x:85.4,y:14.6},{x:82.3,y:36.6}],"9star":[{x:100,y:40.2},{x:84.6,y:55.3},{x:93.8,y:74},{x:73.1,y:76.3},{x:68.1,y:100},{x:50.8,y:85},{x:33.9,y:100},{x:28.1,y:77.3},{x:7.3,y:75.9},{x:15.7,y:56.8},{x:0,y:42.4},{x:19.3,y:33.2},{x:17,y:12.4},{x:37.3,y:17.4},{x:48.9,y:0},{x:61.3,y:16.9},{x:81.3,y:11},{x:79.9,y:31.8}],"10star":[{x:100,y:65.5},{x:78.3,y:70.6},{x:79.4,y:90.5},{x:60.8,y:83.3},{x:50,y:100},{x:39.2,y:83.3},{x:20.6,y:90.5},{x:21.7,y:70.6},{x:0,y:65.5},{x:15,y:50},{x:0,y:34.5},{x:21.7,y:29.4},{x:20.6,y:9.5},{x:39.2,y:16.7},{x:50,y:0},{x:60.8,y:16.7},{x:79.4,y:9.5},{x:78.3,y:29.4},{x:100,y:34.5},{x:85,y:50}],"3polygon":[{x:50,y:0},{x:100,y:100},{x:0,y:100}],"4polygon":[{x:50,y:0},{x:100,y:50},{x:50,y:100},{x:0,y:50}],"5polygon":[{x:50,y:0},{x:100,y:34.5},{x:79.4,y:100},{x:20.6,y:100},{x:0,y:34.5}],"6polygon":[{x:100,y:50},{x:75,y:100},{x:25,y:100},{x:0,y:50},{x:25,y:0},{x:75,y:0}],"7polygon":[{x:50,y:0},{x:89.1,y:18.8},{x:100,y:61.1},{x:71.7,y:100},{x:28.3,y:100},{x:0,y:61.1},{x:10.9,y:18.8}],"8polygon":[{x:100,y:69.1},{x:69.1,y:100},{x:30.9,y:100},{x:0,y:69.1},{x:0,y:30.9},{x:30.9,y:0},{x:69.1,y:0},{x:100,y:30.9}],"9polygon":[{x:50,y:0},{x:82.1,y:11.7},{x:100,y:41.3},{x:93.3,y:75},{x:67.1,y:100},{x:32.9,y:100},{x:6.7,y:75},{x:0,y:41.3},{x:17.9,y:11.7}],"10polygon":[{x:100,y:50},{x:90.5,y:79.4},{x:65.5,y:100},{x:34.5,y:100},{x:9.5,y:79.4},{x:0,y:50},{x:9.5,y:20.6},{x:34.5,y:0},{x:65.5,y:0},{x:90.5,y:20.6}],trapezium:[{x:25,y:0},{x:75,y:0},{x:100,y:100},{x:0,y:100}],rarrow:[{x:0,y:25},{x:75,y:25},{x:75,y:0},{x:100,y:50},{x:75,y:100},{x:75,y:75},{x:0,y:75}],harrow:[{x:0,y:50},{x:25,y:0},{x:25,y:25},{x:75,y:25},{x:75,y:0},{x:100,y:50},{x:75,y:100},{x:75,y:75},{x:25,y:75},{x:25,y:100}]}}))},function(e,t,n){e.exports=function(e,t){e=e&&e.hasOwnProperty("default")?e.default:e,t=t&&t.hasOwnProperty("default")?t.default:t;var n="7.6.2";function i(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e.__proto__=t}function r(e,t){return(r=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function a(e,t,n){return(a=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}()?Reflect.construct:function(e,t,n){var i=[null];i.push.apply(i,t);var a=new(Function.bind.apply(e,i));return n&&r(a,n.prototype),a}).apply(null,arguments)}function o(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function s(e,t){return t||(t=e.slice(0)),e.raw=t,e}var l=[],u=function(t,n){return function(i,r,a){var o=n.levels[r],s=new RegExp("^("+o+")$");if("log"!==i&&a.unshift(i.toUpperCase()+":"),a.unshift(t+":"),l&&l.push([].concat(a)),e.console){var u=e.console[i];u||"debug"!==i||(u=e.console.info||e.console.log),u&&o&&s.test(i)&&u[Array.isArray(a)?"apply":"call"](e.console,a)}}},c=function e(t){var n,i="info",r=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];n("log",i,t)};return n=u(t,r),r.createLogger=function(n){return e(t+": "+n)},r.levels={all:"debug|log|warn|error",off:"",debug:"debug|log|warn|error",info:"log|warn|error",warn:"warn|error",error:"error",DEFAULT:i},r.level=function(e){if("string"==typeof e){if(!r.levels.hasOwnProperty(e))throw new Error('"'+e+'" in not a valid log level');i=e}return i},(r.history=function(){return l?[].concat(l):[]}).filter=function(e){return(l||[]).filter(function(t){return new RegExp(".*"+e+".*").test(t[0])})},r.history.clear=function(){l&&(l.length=0)},r.history.disable=function(){null!==l&&(l.length=0,l=null)},r.history.enable=function(){null===l&&(l=[])},r.error=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return n("error",i,t)},r.warn=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return n("warn",i,t)},r.debug=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return n("debug",i,t)},r}("VIDEOJS"),d=c.createLogger;function h(e){return e.replace(/\n\r?\s*/g,"")}var p=function(e){for(var t="",n=0;n<arguments.length;n++)t+=h(e[n])+(arguments[n+1]||"");return t},f=Object.prototype.toString,g=function(e){return y(e)?Object.keys(e):[]};function m(e,t){g(e).forEach(function(n){return t(e[n],n)})}function v(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];return Object.assign?Object.assign.apply(Object,[e].concat(n)):(n.forEach(function(t){t&&m(t,function(t,n){e[n]=t})}),e)}function y(e){return!!e&&"object"==typeof e}function b(e){return y(e)&&"[object Object]"===f.call(e)&&e.constructor===Object}function _(t,n){if(!t||!n)return"";if("function"==typeof e.getComputedStyle){var i=e.getComputedStyle(t);return i?i.getPropertyValue(n)||i[n]:""}return""}function T(){var e=s(["Setting attributes in the second argument of createEl()\n                has been deprecated. Use the third argument instead.\n                createEl(type, properties, attributes). Attempting to set "," to ","."]);return T=function(){return e},e}function E(e){return"string"==typeof e&&/\S/.test(e)}function C(e){if(/\s/.test(e))throw new Error("class has illegal whitespace characters")}function w(){return t===e.document}function k(e){return y(e)&&1===e.nodeType}function S(){try{return e.parent!==e.self}catch(e){return!0}}function I(e){return function(n,i){if(!E(n))return t[e](null);E(i)&&(i=t.querySelector(i));var r=k(i)?i:t;return r[e]&&r[e](n)}}function O(e,n,i,r){void 0===e&&(e="div"),void 0===n&&(n={}),void 0===i&&(i={});var a=t.createElement(e);return Object.getOwnPropertyNames(n).forEach(function(e){var t=n[e];-1!==e.indexOf("aria-")||"role"===e||"type"===e?(c.warn(p(T(),e,t)),a.setAttribute(e,t)):"textContent"===e?D(a,t):a[e]=t}),Object.getOwnPropertyNames(i).forEach(function(e){a.setAttribute(e,i[e])}),r&&G(a,r),a}function D(e,t){return void 0===e.textContent?e.innerText=t:e.textContent=t,e}function R(e,t){t.firstChild?t.insertBefore(e,t.firstChild):t.appendChild(e)}function x(e,t){return C(t),e.classList?e.classList.contains(t):(n=t,new RegExp("(^|\\s)"+n+"($|\\s)")).test(e.className);var n}function A(e,t){return e.classList?e.classList.add(t):x(e,t)||(e.className=(e.className+" "+t).trim()),e}function P(e,t){return e.classList?e.classList.remove(t):(C(t),e.className=e.className.split(/\s+/).filter(function(e){return e!==t}).join(" ")),e}function L(e,t,n){var i=x(e,t);if("function"==typeof n&&(n=n(e,t)),"boolean"!=typeof n&&(n=!i),n!==i)return n?A(e,t):P(e,t),e}function N(e,t){Object.getOwnPropertyNames(t).forEach(function(n){var i=t[n];null===i||void 0===i||!1===i?e.removeAttribute(n):e.setAttribute(n,!0===i?"":i)})}function M(e){var t={};if(e&&e.attributes&&e.attributes.length>0)for(var n=e.attributes,i=n.length-1;i>=0;i--){var r=n[i].name,a=n[i].value;"boolean"!=typeof e[r]&&-1===",autoplay,controls,playsinline,loop,muted,default,defaultMuted,".indexOf(","+r+",")||(a=null!==a),t[r]=a}return t}function K(e,t){return e.getAttribute(t)}function $(e,t,n){e.setAttribute(t,n)}function j(e,t){e.removeAttribute(t)}function B(){t.body.focus(),t.onselectstart=function(){return!1}}function F(){t.onselectstart=function(){return!0}}function U(e){if(e&&e.getBoundingClientRect&&e.parentNode){var t=e.getBoundingClientRect(),n={};return["bottom","height","left","right","top","width"].forEach(function(e){void 0!==t[e]&&(n[e]=t[e])}),n.height||(n.height=parseFloat(_(e,"height"))),n.width||(n.width=parseFloat(_(e,"width"))),n}}function V(n){var i;if(n.getBoundingClientRect&&n.parentNode&&(i=n.getBoundingClientRect()),!i)return{left:0,top:0};var r=t.documentElement,a=t.body,o=r.clientLeft||a.clientLeft||0,s=e.pageXOffset||a.scrollLeft,l=i.left+s-o,u=r.clientTop||a.clientTop||0,c=e.pageYOffset||a.scrollTop,d=i.top+c-u;return{left:Math.round(l),top:Math.round(d)}}function q(e,t){var n={},i=V(e),r=e.offsetWidth,a=e.offsetHeight,o=i.top,s=i.left,l=t.pageY,u=t.pageX;return t.changedTouches&&(u=t.changedTouches[0].pageX,l=t.changedTouches[0].pageY),n.y=Math.max(0,Math.min(1,(o-l+a)/a)),n.x=Math.max(0,Math.min(1,(u-s)/r)),n}function H(e){return y(e)&&3===e.nodeType}function z(e){for(;e.firstChild;)e.removeChild(e.firstChild);return e}function W(e){return"function"==typeof e&&(e=e()),(Array.isArray(e)?e:[e]).map(function(e){return"function"==typeof e&&(e=e()),k(e)||H(e)?e:"string"==typeof e&&/\S/.test(e)?t.createTextNode(e):void 0}).filter(function(e){return e})}function G(e,t){return W(t).forEach(function(t){return e.appendChild(t)}),e}function X(e,t){return G(z(e),t)}function Y(e){return void 0===e.button&&void 0===e.buttons||0===e.button&&void 0===e.buttons||"mouseup"===e.type&&0===e.button&&0===e.buttons||0===e.button&&1===e.buttons}var Q=I("querySelector"),J=I("querySelectorAll"),Z=Object.freeze({isReal:w,isEl:k,isInFrame:S,createEl:O,textContent:D,prependTo:R,hasClass:x,addClass:A,removeClass:P,toggleClass:L,setAttributes:N,getAttributes:M,getAttribute:K,setAttribute:$,removeAttribute:j,blockTextSelection:B,unblockTextSelection:F,getBoundingClientRect:U,findPosition:V,getPointerPosition:q,isTextNode:H,emptyEl:z,normalizeContent:W,appendContent:G,insertContent:X,isSingleLeftClick:Y,$:Q,$$:J}),ee=new WeakMap,te=1;function ne(){return te++}function ie(e,t){if(ee.has(e)){var n=ee.get(e);0===n.handlers[t].length&&(delete n.handlers[t],e.removeEventListener?e.removeEventListener(t,n.dispatcher,!1):e.detachEvent&&e.detachEvent("on"+t,n.dispatcher)),Object.getOwnPropertyNames(n.handlers).length<=0&&(delete n.handlers,delete n.dispatcher,delete n.disabled),0===Object.getOwnPropertyNames(n).length&&ee.delete(e)}}function re(e,t,n,i){n.forEach(function(n){e(t,n,i)})}function ae(n){function i(){return!0}function r(){return!1}if(!n||!n.isPropagationStopped){var a=n||e.event;for(var o in n={},a)"layerX"!==o&&"layerY"!==o&&"keyLocation"!==o&&"webkitMovementX"!==o&&"webkitMovementY"!==o&&("returnValue"===o&&a.preventDefault||(n[o]=a[o]));if(n.target||(n.target=n.srcElement||t),n.relatedTarget||(n.relatedTarget=n.fromElement===n.target?n.toElement:n.fromElement),n.preventDefault=function(){a.preventDefault&&a.preventDefault(),n.returnValue=!1,a.returnValue=!1,n.defaultPrevented=!0},n.defaultPrevented=!1,n.stopPropagation=function(){a.stopPropagation&&a.stopPropagation(),n.cancelBubble=!0,a.cancelBubble=!0,n.isPropagationStopped=i},n.isPropagationStopped=r,n.stopImmediatePropagation=function(){a.stopImmediatePropagation&&a.stopImmediatePropagation(),n.isImmediatePropagationStopped=i,n.stopPropagation()},n.isImmediatePropagationStopped=r,null!==n.clientX&&void 0!==n.clientX){var s=t.documentElement,l=t.body;n.pageX=n.clientX+(s&&s.scrollLeft||l&&l.scrollLeft||0)-(s&&s.clientLeft||l&&l.clientLeft||0),n.pageY=n.clientY+(s&&s.scrollTop||l&&l.scrollTop||0)-(s&&s.clientTop||l&&l.clientTop||0)}n.which=n.charCode||n.keyCode,null!==n.button&&void 0!==n.button&&(n.button=1&n.button?0:4&n.button?1:2&n.button?2:0)}return n}var oe=!1;!function(){try{var t=Object.defineProperty({},"passive",{get:function(){oe=!0}});e.addEventListener("test",null,t),e.removeEventListener("test",null,t)}catch(e){}}();var se=["touchstart","touchmove"];function le(e,t,n){if(Array.isArray(t))return re(le,e,t,n);ee.has(e)||ee.set(e,{});var i=ee.get(e);if(i.handlers||(i.handlers={}),i.handlers[t]||(i.handlers[t]=[]),n.guid||(n.guid=ne()),i.handlers[t].push(n),i.dispatcher||(i.disabled=!1,i.dispatcher=function(t,n){if(!i.disabled){t=ae(t);var r=i.handlers[t.type];if(r)for(var a=r.slice(0),o=0,s=a.length;o<s&&!t.isImmediatePropagationStopped();o++)try{a[o].call(e,t,n)}catch(e){c.error(e)}}}),1===i.handlers[t].length)if(e.addEventListener){var r=!1;oe&&se.indexOf(t)>-1&&(r={passive:!0}),e.addEventListener(t,i.dispatcher,r)}else e.attachEvent&&e.attachEvent("on"+t,i.dispatcher)}function ue(e,t,n){if(ee.has(e)){var i=ee.get(e);if(i.handlers){if(Array.isArray(t))return re(ue,e,t,n);var r=function(e,t){i.handlers[t]=[],ie(e,t)};if(void 0!==t){var a=i.handlers[t];if(a)if(n){if(n.guid)for(var o=0;o<a.length;o++)a[o].guid===n.guid&&a.splice(o--,1);ie(e,t)}else r(e,t)}else for(var s in i.handlers)Object.prototype.hasOwnProperty.call(i.handlers||{},s)&&r(e,s)}}}function ce(e,t,n){var i=ee.has(e)?ee.get(e):{},r=e.parentNode||e.ownerDocument;if("string"==typeof t?t={type:t,target:e}:t.target||(t.target=e),t=ae(t),i.dispatcher&&i.dispatcher.call(e,t,n),r&&!t.isPropagationStopped()&&!0===t.bubbles)ce.call(null,r,t,n);else if(!r&&!t.defaultPrevented&&t.target&&t.target[t.type]){ee.has(t.target)||ee.set(t.target,{});var a=ee.get(t.target);t.target[t.type]&&(a.disabled=!0,"function"==typeof t.target[t.type]&&t.target[t.type](),a.disabled=!1)}return!t.defaultPrevented}function de(e,t,n){if(Array.isArray(t))return re(de,e,t,n);var i=function i(){ue(e,t,i),n.apply(this,arguments)};i.guid=n.guid=n.guid||ne(),le(e,t,i)}function he(e,t,n){var i=function i(){ue(e,t,i),n.apply(this,arguments)};i.guid=n.guid=n.guid||ne(),le(e,t,i)}var pe,fe=Object.freeze({fixEvent:ae,on:le,off:ue,trigger:ce,one:de,any:he}),ge=!1,me=function(){if(w()&&!1!==pe.options.autoSetup){var e=Array.prototype.slice.call(t.getElementsByTagName("video")),n=Array.prototype.slice.call(t.getElementsByTagName("audio")),i=Array.prototype.slice.call(t.getElementsByTagName("video-js")),r=e.concat(n,i);if(r&&r.length>0)for(var a=0,o=r.length;a<o;a++){var s=r[a];if(!s||!s.getAttribute){ve(1);break}if(void 0===s.player)null!==s.getAttribute("data-setup")&&pe(s)}else ge||ve(1)}};function ve(t,n){n&&(pe=n),e.setTimeout(me,t)}w()&&"complete"===t.readyState?ge=!0:de(e,"load",function(){ge=!0});var ye,be=function(e){var n=t.createElement("style");return n.className=e,n},_e=function(e,t){e.styleSheet?e.styleSheet.cssText=t:e.textContent=t},Te=30,Ee=function(e,t,n){t.guid||(t.guid=ne());var i=t.bind(e);return i.guid=n?n+"_"+t.guid:t.guid,i},Ce=function(t,n){var i=e.performance.now();return function(){var r=e.performance.now();r-i>=n&&(t.apply(void 0,arguments),i=r)}},we=function(t,n,i,r){var a;void 0===r&&(r=e);var o=function(){var e=this,o=arguments,s=function(){a=null,s=null,i||t.apply(e,o)};!a&&i&&t.apply(e,o),r.clearTimeout(a),a=r.setTimeout(s,n)};return o.cancel=function(){r.clearTimeout(a),a=null},o},ke=function(){};ke.prototype.allowedEvents_={},ke.prototype.on=function(e,t){var n=this.addEventListener;this.addEventListener=function(){},le(this,e,t),this.addEventListener=n},ke.prototype.addEventListener=ke.prototype.on,ke.prototype.off=function(e,t){ue(this,e,t)},ke.prototype.removeEventListener=ke.prototype.off,ke.prototype.one=function(e,t){var n=this.addEventListener;this.addEventListener=function(){},de(this,e,t),this.addEventListener=n},ke.prototype.any=function(e,t){var n=this.addEventListener;this.addEventListener=function(){},he(this,e,t),this.addEventListener=n},ke.prototype.trigger=function(e){var t=e.type||e;"string"==typeof e&&(e={type:t}),e=ae(e),this.allowedEvents_[t]&&this["on"+t]&&this["on"+t](e),ce(this,e)},ke.prototype.dispatchEvent=ke.prototype.trigger,ke.prototype.queueTrigger=function(t){var n=this;ye||(ye=new Map);var i=t.type||t,r=ye.get(this);r||(r=new Map,ye.set(this,r));var a=r.get(i);r.delete(i),e.clearTimeout(a);var o=e.setTimeout(function(){0===r.size&&(r=null,ye.delete(n)),n.trigger(t)},0);r.set(i,o)};var Se=function(e){return e instanceof ke||!!e.eventBusEl_&&["on","one","off","trigger"].every(function(t){return"function"==typeof e[t]})},Ie=function(e){return"string"==typeof e&&/\S/.test(e)||Array.isArray(e)&&!!e.length},Oe=function(e){if(!e.nodeName&&!Se(e))throw new Error("Invalid target; must be a DOM node or evented object.")},De=function(e){if(!Ie(e))throw new Error("Invalid event type; must be a non-empty string or array.")},Re=function(e){if("function"!=typeof e)throw new Error("Invalid listener; must be a function.")},xe=function(e,t){var n,i,r,a=t.length<3||t[0]===e||t[0]===e.eventBusEl_;return a?(n=e.eventBusEl_,t.length>=3&&t.shift(),i=t[0],r=t[1]):(n=t[0],i=t[1],r=t[2]),Oe(n),De(i),Re(r),{isTargetingSelf:a,target:n,type:i,listener:r=Ee(e,r)}},Ae=function(e,t,n,i){Oe(e),e.nodeName?fe[t](e,n,i):e[t](n,i)},Pe={on:function(){for(var e=this,t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];var r=xe(this,n),a=r.isTargetingSelf,o=r.target,s=r.type,l=r.listener;if(Ae(o,"on",s,l),!a){var u=function(){return e.off(o,s,l)};u.guid=l.guid;var c=function(){return e.off("dispose",u)};c.guid=l.guid,Ae(this,"on","dispose",u),Ae(o,"on","dispose",c)}},one:function(){for(var e=this,t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];var r=xe(this,n),a=r.isTargetingSelf,o=r.target,s=r.type,l=r.listener;if(a)Ae(o,"one",s,l);else{var u=function t(){e.off(o,s,t);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];l.apply(null,i)};u.guid=l.guid,Ae(o,"one",s,u)}},any:function(){for(var e=this,t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];var r=xe(this,n),a=r.isTargetingSelf,o=r.target,s=r.type,l=r.listener;if(a)Ae(o,"any",s,l);else{var u=function t(){e.off(o,s,t);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];l.apply(null,i)};u.guid=l.guid,Ae(o,"any",s,u)}},off:function(e,t,n){if(!e||Ie(e))ue(this.eventBusEl_,e,t);else{var i=e,r=t;Oe(i),De(r),Re(n),n=Ee(this,n),this.off("dispose",n),i.nodeName?(ue(i,r,n),ue(i,"dispose",n)):Se(i)&&(i.off(r,n),i.off("dispose",n))}},trigger:function(e,t){return ce(this.eventBusEl_,e,t)}};function Le(t,n){void 0===n&&(n={});var i=n.eventBusKey;if(i){if(!t[i].nodeName)throw new Error('The eventBusKey "'+i+'" does not refer to an element.');t.eventBusEl_=t[i]}else t.eventBusEl_=O("span",{className:"vjs-event-bus"});return v(t,Pe),t.eventedCallbacks&&t.eventedCallbacks.forEach(function(e){e()}),t.on("dispose",function(){t.off(),e.setTimeout(function(){t.eventBusEl_=null},0)}),t}var Ne={state:{},setState:function(e){var t,n=this;return"function"==typeof e&&(e=e()),m(e,function(e,i){n.state[i]!==e&&((t=t||{})[i]={from:n.state[i],to:e}),n.state[i]=e}),t&&Se(this)&&this.trigger({changes:t,type:"statechanged"}),t}};function Me(e,t){return v(e,Ne),e.state=v({},e.state,t),"function"==typeof e.handleStateChanged&&Se(e)&&e.on("statechanged",e.handleStateChanged),e}var Ke=function(e){return"string"!=typeof e?e:e.replace(/./,function(e){return e.toLowerCase()})},$e=function(e){return"string"!=typeof e?e:e.replace(/./,function(e){return e.toUpperCase()})};function je(){for(var e={},t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];return n.forEach(function(t){t&&m(t,function(t,n){b(t)?(b(e[n])||(e[n]={}),e[n]=je(e[n],t)):e[n]=t})}),e}var Be=function(){function t(e,t,n){if(!e&&this.play?this.player_=e=this:this.player_=e,this.parentComponent_=null,this.options_=je({},this.options_),t=this.options_=je(this.options_,t),this.id_=t.id||t.el&&t.el.id,!this.id_){var i=e&&e.id&&e.id()||"no_player";this.id_=i+"_component_"+ne()}this.name_=t.name||null,t.el?this.el_=t.el:!1!==t.createEl&&(this.el_=this.createEl()),!1!==t.evented&&Le(this,{eventBusKey:this.el_?"el_":null}),Me(this,this.constructor.defaultState),this.children_=[],this.childIndex_={},this.childNameIndex_={},this.setTimeoutIds_=new Set,this.setIntervalIds_=new Set,this.rafIds_=new Set,this.clearingTimersOnDispose_=!1,!1!==t.initChildren&&this.initChildren(),this.ready(n),!1!==t.reportTouchActivity&&this.enableTouchActivity()}var n=t.prototype;return n.dispose=function(){if(this.trigger({type:"dispose",bubbles:!1}),this.children_)for(var e=this.children_.length-1;e>=0;e--)this.children_[e].dispose&&this.children_[e].dispose();this.children_=null,this.childIndex_=null,this.childNameIndex_=null,this.parentComponent_=null,this.el_&&(this.el_.parentNode&&this.el_.parentNode.removeChild(this.el_),ee.has(this.el_)&&ee.delete(this.el_),this.el_=null),this.player_=null},n.player=function(){return this.player_},n.options=function(e){return e?(this.options_=je(this.options_,e),this.options_):this.options_},n.el=function(){return this.el_},n.createEl=function(e,t,n){return O(e,t,n)},n.localize=function(e,t,n){void 0===n&&(n=e);var i=this.player_.language&&this.player_.language(),r=this.player_.languages&&this.player_.languages(),a=r&&r[i],o=i&&i.split("-")[0],s=r&&r[o],l=n;return a&&a[e]?l=a[e]:s&&s[e]&&(l=s[e]),t&&(l=l.replace(/\{(\d+)\}/g,function(e,n){var i=t[n-1],r=i;return void 0===i&&(r=e),r})),l},n.contentEl=function(){return this.contentEl_||this.el_},n.id=function(){return this.id_},n.name=function(){return this.name_},n.children=function(){return this.children_},n.getChildById=function(e){return this.childIndex_[e]},n.getChild=function(e){if(e)return this.childNameIndex_[e]},n.addChild=function(e,n,i){var r,a;if(void 0===n&&(n={}),void 0===i&&(i=this.children_.length),"string"==typeof e){a=$e(e);var o=n.componentClass||a;n.name=a;var s=t.getComponent(o);if(!s)throw new Error("Component "+o+" does not exist");if("function"!=typeof s)return null;r=new s(this.player_||this,n)}else r=e;if(r.parentComponent_&&r.parentComponent_.removeChild(r),this.children_.splice(i,0,r),r.parentComponent_=this,"function"==typeof r.id&&(this.childIndex_[r.id()]=r),(a=a||r.name&&$e(r.name()))&&(this.childNameIndex_[a]=r,this.childNameIndex_[Ke(a)]=r),"function"==typeof r.el&&r.el()){var l=this.contentEl().children[i]||null;this.contentEl().insertBefore(r.el(),l)}return r},n.removeChild=function(e){if("string"==typeof e&&(e=this.getChild(e)),e&&this.children_){for(var t=!1,n=this.children_.length-1;n>=0;n--)if(this.children_[n]===e){t=!0,this.children_.splice(n,1);break}if(t){e.parentComponent_=null,this.childIndex_[e.id()]=null,this.childNameIndex_[$e(e.name())]=null,this.childNameIndex_[Ke(e.name())]=null;var i=e.el();i&&i.parentNode===this.contentEl()&&this.contentEl().removeChild(e.el())}}},n.initChildren=function(){var e=this,n=this.options_.children;if(n){var i,r=this.options_,a=t.getComponent("Tech");(i=Array.isArray(n)?n:Object.keys(n)).concat(Object.keys(this.options_).filter(function(e){return!i.some(function(t){return"string"==typeof t?e===t:e===t.name})})).map(function(t){var i,r;return"string"==typeof t?r=n[i=t]||e.options_[i]||{}:(i=t.name,r=t),{name:i,opts:r}}).filter(function(e){var n=t.getComponent(e.opts.componentClass||$e(e.name));return n&&!a.isTech(n)}).forEach(function(t){var n=t.name,i=t.opts;if(void 0!==r[n]&&(i=r[n]),!1!==i){!0===i&&(i={}),i.playerOptions=e.options_.playerOptions;var a=e.addChild(n,i);a&&(e[n]=a)}})}},n.buildCSSClass=function(){return""},n.ready=function(e,t){if(void 0===t&&(t=!1),e)return this.isReady_?void(t?e.call(this):this.setTimeout(e,1)):(this.readyQueue_=this.readyQueue_||[],void this.readyQueue_.push(e))},n.triggerReady=function(){this.isReady_=!0,this.setTimeout(function(){var e=this.readyQueue_;this.readyQueue_=[],e&&e.length>0&&e.forEach(function(e){e.call(this)},this),this.trigger("ready")},1)},n.$=function(e,t){return Q(e,t||this.contentEl())},n.$$=function(e,t){return J(e,t||this.contentEl())},n.hasClass=function(e){return x(this.el_,e)},n.addClass=function(e){A(this.el_,e)},n.removeClass=function(e){P(this.el_,e)},n.toggleClass=function(e,t){L(this.el_,e,t)},n.show=function(){this.removeClass("vjs-hidden")},n.hide=function(){this.addClass("vjs-hidden")},n.lockShowing=function(){this.addClass("vjs-lock-showing")},n.unlockShowing=function(){this.removeClass("vjs-lock-showing")},n.getAttribute=function(e){return K(this.el_,e)},n.setAttribute=function(e,t){$(this.el_,e,t)},n.removeAttribute=function(e){j(this.el_,e)},n.width=function(e,t){return this.dimension("width",e,t)},n.height=function(e,t){return this.dimension("height",e,t)},n.dimensions=function(e,t){this.width(e,!0),this.height(t)},n.dimension=function(e,t,n){if(void 0!==t)return null!==t&&t==t||(t=0),-1!==(""+t).indexOf("%")||-1!==(""+t).indexOf("px")?this.el_.style[e]=t:this.el_.style[e]="auto"===t?"":t+"px",void(n||this.trigger("componentresize"));if(!this.el_)return 0;var i=this.el_.style[e],r=i.indexOf("px");return-1!==r?parseInt(i.slice(0,r),10):parseInt(this.el_["offset"+$e(e)],10)},n.currentDimension=function(e){var t=0;if("width"!==e&&"height"!==e)throw new Error("currentDimension only accepts width or height value");if(t=_(this.el_,e),0===(t=parseFloat(t))||isNaN(t)){var n="offset"+$e(e);t=this.el_[n]}return t},n.currentDimensions=function(){return{width:this.currentDimension("width"),height:this.currentDimension("height")}},n.currentWidth=function(){return this.currentDimension("width")},n.currentHeight=function(){return this.currentDimension("height")},n.focus=function(){this.el_.focus()},n.blur=function(){this.el_.blur()},n.handleKeyDown=function(e){this.player_&&(e.stopPropagation(),this.player_.handleKeyDown(e))},n.handleKeyPress=function(e){this.handleKeyDown(e)},n.emitTapEvents=function(){var t,n=0,i=null;this.on("touchstart",function(r){1===r.touches.length&&(i={pageX:r.touches[0].pageX,pageY:r.touches[0].pageY},n=e.performance.now(),t=!0)}),this.on("touchmove",function(e){if(e.touches.length>1)t=!1;else if(i){var n=e.touches[0].pageX-i.pageX,r=e.touches[0].pageY-i.pageY;Math.sqrt(n*n+r*r)>10&&(t=!1)}});var r=function(){t=!1};this.on("touchleave",r),this.on("touchcancel",r),this.on("touchend",function(r){(i=null,!0===t)&&(e.performance.now()-n<200&&(r.preventDefault(),this.trigger("tap")))})},n.enableTouchActivity=function(){if(this.player()&&this.player().reportUserActivity){var e,t=Ee(this.player(),this.player().reportUserActivity);this.on("touchstart",function(){t(),this.clearInterval(e),e=this.setInterval(t,250)});var n=function(n){t(),this.clearInterval(e)};this.on("touchmove",t),this.on("touchend",n),this.on("touchcancel",n)}},n.setTimeout=function(t,n){var i,r=this;return t=Ee(this,t),this.clearTimersOnDispose_(),i=e.setTimeout(function(){r.setTimeoutIds_.has(i)&&r.setTimeoutIds_.delete(i),t()},n),this.setTimeoutIds_.add(i),i},n.clearTimeout=function(t){return this.setTimeoutIds_.has(t)&&(this.setTimeoutIds_.delete(t),e.clearTimeout(t)),t},n.setInterval=function(t,n){t=Ee(this,t),this.clearTimersOnDispose_();var i=e.setInterval(t,n);return this.setIntervalIds_.add(i),i},n.clearInterval=function(t){return this.setIntervalIds_.has(t)&&(this.setIntervalIds_.delete(t),e.clearInterval(t)),t},n.requestAnimationFrame=function(t){var n,i=this;return this.supportsRaf_?(this.clearTimersOnDispose_(),t=Ee(this,t),n=e.requestAnimationFrame(function(){i.rafIds_.has(n)&&i.rafIds_.delete(n),t()}),this.rafIds_.add(n),n):this.setTimeout(t,1e3/60)},n.cancelAnimationFrame=function(t){return this.supportsRaf_?(this.rafIds_.has(t)&&(this.rafIds_.delete(t),e.cancelAnimationFrame(t)),t):this.clearTimeout(t)},n.clearTimersOnDispose_=function(){var e=this;this.clearingTimersOnDispose_||(this.clearingTimersOnDispose_=!0,this.one("dispose",function(){[["rafIds_","cancelAnimationFrame"],["setTimeoutIds_","clearTimeout"],["setIntervalIds_","clearInterval"]].forEach(function(t){var n=t[0],i=t[1];e[n].forEach(e[i],e)}),e.clearingTimersOnDispose_=!1}))},t.registerComponent=function(e,n){if("string"!=typeof e||!e)throw new Error('Illegal component name, "'+e+'"; must be a non-empty string.');var i=t.getComponent("Tech"),r=i&&i.isTech(n),a=t===n||t.prototype.isPrototypeOf(n.prototype);if(r||!a)throw new Error('Illegal component, "'+e+'"; '+(r?"techs must be registered using Tech.registerTech()":"must be a Component subclass")+".");e=$e(e),t.components_||(t.components_={});var o=t.getComponent("Player");if("Player"===e&&o&&o.players){var s=o.players,l=Object.keys(s);if(s&&l.length>0&&l.map(function(e){return s[e]}).every(Boolean))throw new Error("Can not register Player component after player has been created.")}return t.components_[e]=n,t.components_[Ke(e)]=n,n},t.getComponent=function(e){if(e&&t.components_)return t.components_[e]},t}();Be.prototype.supportsRaf_="function"==typeof e.requestAnimationFrame&&"function"==typeof e.cancelAnimationFrame,Be.registerComponent("Component",Be);var Fe,Ue=e.navigator&&e.navigator.userAgent||"",Ve=/AppleWebKit\/([\d.]+)/i.exec(Ue),qe=Ve?parseFloat(Ve.pop()):null,He=/iPad/i.test(Ue),ze=/iPhone/i.test(Ue)&&!He,We=/iPod/i.test(Ue),Ge=ze||He||We,Xe=(Fe=Ue.match(/OS (\d+)_/i))&&Fe[1]?Fe[1]:null,Ye=/Android/i.test(Ue),Qe=function(){var e=Ue.match(/Android (\d+)(?:\.(\d+))?(?:\.(\d+))*/i);if(!e)return null;var t=e[1]&&parseFloat(e[1]),n=e[2]&&parseFloat(e[2]);return t&&n?parseFloat(e[1]+"."+e[2]):t||null}(),Je=Ye&&Qe<5&&qe<537,Ze=/Firefox/i.test(Ue),et=/Edge/i.test(Ue),tt=!et&&(/Chrome/i.test(Ue)||/CriOS/i.test(Ue)),nt=function(){var e=Ue.match(/(Chrome|CriOS)\/(\d+)/);return e&&e[2]?parseFloat(e[2]):null}(),it=function(){var e=/MSIE\s(\d+)\.\d/.exec(Ue),t=e&&parseFloat(e[1]);return!t&&/Trident\/7.0/i.test(Ue)&&/rv:11.0/.test(Ue)&&(t=11),t}(),rt=/Safari/i.test(Ue)&&!tt&&!Ye&&!et,at=(rt||Ge)&&!tt,ot=/Windows/i.test(Ue),st=w()&&("ontouchstart"in e||e.navigator.maxTouchPoints||e.DocumentTouch&&e.document instanceof e.DocumentTouch),lt=Object.freeze({IS_IPAD:He,IS_IPHONE:ze,IS_IPOD:We,IS_IOS:Ge,IOS_VERSION:Xe,IS_ANDROID:Ye,ANDROID_VERSION:Qe,IS_NATIVE_ANDROID:Je,IS_FIREFOX:Ze,IS_EDGE:et,IS_CHROME:tt,CHROME_VERSION:nt,IE_VERSION:it,IS_SAFARI:rt,IS_ANY_SAFARI:at,IS_WINDOWS:ot,TOUCH_ENABLED:st});function ut(e,t,n,i){return function(e,t,n){if("number"!=typeof t||t<0||t>n)throw new Error("Failed to execute '"+e+"' on 'TimeRanges': The index provided ("+t+") is non-numeric or out of bounds (0-"+n+").")}(e,i,n.length-1),n[i][t]}function ct(e){return void 0===e||0===e.length?{length:0,start:function(){throw new Error("This TimeRanges object is empty")},end:function(){throw new Error("This TimeRanges object is empty")}}:{length:e.length,start:ut.bind(null,"start",0,e),end:ut.bind(null,"end",1,e)}}function dt(e,t){return Array.isArray(e)?ct(e):void 0===e||void 0===t?ct():ct([[e,t]])}function ht(e,t){var n,i,r=0;if(!t)return 0;e&&e.length||(e=dt(0,0));for(var a=0;a<e.length;a++)n=e.start(a),(i=e.end(a))>t&&(i=t),r+=i-n;return r/t}for(var pt,ft={prefixed:!0},gt=[["requestFullscreen","exitFullscreen","fullscreenElement","fullscreenEnabled","fullscreenchange","fullscreenerror","fullscreen"],["webkitRequestFullscreen","webkitExitFullscreen","webkitFullscreenElement","webkitFullscreenEnabled","webkitfullscreenchange","webkitfullscreenerror","-webkit-full-screen"],["mozRequestFullScreen","mozCancelFullScreen","mozFullScreenElement","mozFullScreenEnabled","mozfullscreenchange","mozfullscreenerror","-moz-full-screen"],["msRequestFullscreen","msExitFullscreen","msFullscreenElement","msFullscreenEnabled","MSFullscreenChange","MSFullscreenError","-ms-fullscreen"]],mt=gt[0],vt=0;vt<gt.length;vt++)if(gt[vt][1]in t){pt=gt[vt];break}if(pt){for(var yt=0;yt<pt.length;yt++)ft[mt[yt]]=pt[yt];ft.prefixed=pt[0]!==mt[0]}function bt(e){if(e instanceof bt)return e;"number"==typeof e?this.code=e:"string"==typeof e?this.message=e:y(e)&&("number"==typeof e.code&&(this.code=e.code),v(this,e)),this.message||(this.message=bt.defaultMessages[this.code]||"")}bt.prototype.code=0,bt.prototype.message="",bt.prototype.status=null,bt.errorTypes=["MEDIA_ERR_CUSTOM","MEDIA_ERR_ABORTED","MEDIA_ERR_NETWORK","MEDIA_ERR_DECODE","MEDIA_ERR_SRC_NOT_SUPPORTED","MEDIA_ERR_ENCRYPTED"],bt.defaultMessages={1:"You aborted the media playback",2:"A network error caused the media download to fail part-way.",3:"The media playback was aborted due to a corruption problem or because the media used features your browser did not support.",4:"The media could not be loaded, either because the server or network failed or because the format is not supported.",5:"The media is encrypted and we do not have the keys to decrypt it."};for(var _t=0;_t<bt.errorTypes.length;_t++)bt[bt.errorTypes[_t]]=_t,bt.prototype[bt.errorTypes[_t]]=_t;function Tt(e){return void 0!==e&&null!==e&&"function"==typeof e.then}function Et(e){Tt(e)&&e.then(null,function(e){})}var Ct=function(e){return["kind","label","language","id","inBandMetadataTrackDispatchType","mode","src"].reduce(function(t,n,i){return e[n]&&(t[n]=e[n]),t},{cues:e.cues&&Array.prototype.map.call(e.cues,function(e){return{startTime:e.startTime,endTime:e.endTime,text:e.text,id:e.id}})})},wt=function(e){var t=e.$$("track"),n=Array.prototype.map.call(t,function(e){return e.track});return Array.prototype.map.call(t,function(e){var t=Ct(e.track);return e.src&&(t.src=e.src),t}).concat(Array.prototype.filter.call(e.textTracks(),function(e){return-1===n.indexOf(e)}).map(Ct))},kt=function(e,t){return e.forEach(function(e){var n=t.addRemoteTextTrack(e).track;!e.src&&e.cues&&e.cues.forEach(function(e){return n.addCue(e)})}),t.textTracks()};function St(e,t){return e(t={exports:{}},t.exports),t.exports}var It=St(function(e,t){function n(e){if(e&&"object"==typeof e){var t=e.which||e.keyCode||e.charCode;t&&(e=t)}if("number"==typeof e)return o[e];var n,a=String(e);return(n=i[a.toLowerCase()])?n:(n=r[a.toLowerCase()])||(1===a.length?a.charCodeAt(0):void 0)}n.isEventKey=function(e,t){if(e&&"object"==typeof e){var n=e.which||e.keyCode||e.charCode;if(null===n||void 0===n)return!1;if("string"==typeof t){var a;if(a=i[t.toLowerCase()])return a===n;if(a=r[t.toLowerCase()])return a===n}else if("number"==typeof t)return t===n;return!1}};var i=(t=e.exports=n).code=t.codes={backspace:8,tab:9,enter:13,shift:16,ctrl:17,alt:18,"pause/break":19,"caps lock":20,esc:27,space:32,"page up":33,"page down":34,end:35,home:36,left:37,up:38,right:39,down:40,insert:45,delete:46,command:91,"left command":91,"right command":93,"numpad *":106,"numpad +":107,"numpad -":109,"numpad .":110,"numpad /":111,"num lock":144,"scroll lock":145,"my computer":182,"my calculator":183,";":186,"=":187,",":188,"-":189,".":190,"/":191,"`":192,"[":219,"\\":220,"]":221,"'":222},r=t.aliases={windows:91,"⇧":16,"⌥":18,"⌃":17,"⌘":91,ctl:17,control:17,option:18,pause:19,break:19,caps:20,return:13,escape:27,spc:32,spacebar:32,pgup:33,pgdn:34,ins:45,del:46,cmd:91};for(a=97;a<123;a++)i[String.fromCharCode(a)]=a-32;for(var a=48;a<58;a++)i[a-48]=a;for(a=1;a<13;a++)i["f"+a]=a+111;for(a=0;a<10;a++)i["numpad "+a]=a+96;var o=t.names=t.title={};for(a in i)o[i[a]]=a;for(var s in r)i[s]=r[s]}),Ot=(It.code,It.codes,It.aliases,It.names,It.title,"vjs-modal-dialog"),Dt=function(n){function r(e,t){var i;return(i=n.call(this,e,t)||this).opened_=i.hasBeenOpened_=i.hasBeenFilled_=!1,i.closeable(!i.options_.uncloseable),i.content(i.options_.content),i.contentEl_=O("div",{className:Ot+"-content"},{role:"document"}),i.descEl_=O("p",{className:Ot+"-description vjs-control-text",id:i.el().getAttribute("aria-describedby")}),D(i.descEl_,i.description()),i.el_.appendChild(i.descEl_),i.el_.appendChild(i.contentEl_),i}i(r,n);var a=r.prototype;return a.createEl=function(){return n.prototype.createEl.call(this,"div",{className:this.buildCSSClass(),tabIndex:-1},{"aria-describedby":this.id()+"_description","aria-hidden":"true","aria-label":this.label(),role:"dialog"})},a.dispose=function(){this.contentEl_=null,this.descEl_=null,this.previouslyActiveEl_=null,n.prototype.dispose.call(this)},a.buildCSSClass=function(){return Ot+" vjs-hidden "+n.prototype.buildCSSClass.call(this)},a.label=function(){return this.localize(this.options_.label||"Modal Window")},a.description=function(){var e=this.options_.description||this.localize("This is a modal window.");return this.closeable()&&(e+=" "+this.localize("This modal can be closed by pressing the Escape key or activating the close button.")),e},a.open=function(){if(!this.opened_){var e=this.player();this.trigger("beforemodalopen"),this.opened_=!0,(this.options_.fillAlways||!this.hasBeenOpened_&&!this.hasBeenFilled_)&&this.fill(),this.wasPlaying_=!e.paused(),this.options_.pauseOnOpen&&this.wasPlaying_&&e.pause(),this.on("keydown",this.handleKeyDown),this.hadControls_=e.controls(),e.controls(!1),this.show(),this.conditionalFocus_(),this.el().setAttribute("aria-hidden","false"),this.trigger("modalopen"),this.hasBeenOpened_=!0}},a.opened=function(e){return"boolean"==typeof e&&this[e?"open":"close"](),this.opened_},a.close=function(){if(this.opened_){var e=this.player();this.trigger("beforemodalclose"),this.opened_=!1,this.wasPlaying_&&this.options_.pauseOnOpen&&e.play(),this.off("keydown",this.handleKeyDown),this.hadControls_&&e.controls(!0),this.hide(),this.el().setAttribute("aria-hidden","true"),this.trigger("modalclose"),this.conditionalBlur_(),this.options_.temporary&&this.dispose()}},a.closeable=function(e){if("boolean"==typeof e){var t=this.closeable_=!!e,n=this.getChild("closeButton");if(t&&!n){var i=this.contentEl_;this.contentEl_=this.el_,n=this.addChild("closeButton",{controlText:"Close Modal Dialog"}),this.contentEl_=i,this.on(n,"close",this.close)}!t&&n&&(this.off(n,"close",this.close),this.removeChild(n),n.dispose())}return this.closeable_},a.fill=function(){this.fillWith(this.content())},a.fillWith=function(e){var t=this.contentEl(),n=t.parentNode,i=t.nextSibling;this.trigger("beforemodalfill"),this.hasBeenFilled_=!0,n.removeChild(t),this.empty(),X(t,e),this.trigger("modalfill"),i?n.insertBefore(t,i):n.appendChild(t);var r=this.getChild("closeButton");r&&n.appendChild(r.el_)},a.empty=function(){this.trigger("beforemodalempty"),z(this.contentEl()),this.trigger("modalempty")},a.content=function(e){return void 0!==e&&(this.content_=e),this.content_},a.conditionalFocus_=function(){var e=t.activeElement,n=this.player_.el_;this.previouslyActiveEl_=null,(n.contains(e)||n===e)&&(this.previouslyActiveEl_=e,this.focus())},a.conditionalBlur_=function(){this.previouslyActiveEl_&&(this.previouslyActiveEl_.focus(),this.previouslyActiveEl_=null)},a.handleKeyDown=function(e){if(e.stopPropagation(),It.isEventKey(e,"Escape")&&this.closeable())return e.preventDefault(),void this.close();if(It.isEventKey(e,"Tab")){for(var n,i=this.focusableEls_(),r=this.el_.querySelector(":focus"),a=0;a<i.length;a++)if(r===i[a]){n=a;break}t.activeElement===this.el_&&(n=0),e.shiftKey&&0===n?(i[i.length-1].focus(),e.preventDefault()):e.shiftKey||n!==i.length-1||(i[0].focus(),e.preventDefault())}},a.focusableEls_=function(){var t=this.el_.querySelectorAll("*");return Array.prototype.filter.call(t,function(t){return(t instanceof e.HTMLAnchorElement||t instanceof e.HTMLAreaElement)&&t.hasAttribute("href")||(t instanceof e.HTMLInputElement||t instanceof e.HTMLSelectElement||t instanceof e.HTMLTextAreaElement||t instanceof e.HTMLButtonElement)&&!t.hasAttribute("disabled")||t instanceof e.HTMLIFrameElement||t instanceof e.HTMLObjectElement||t instanceof e.HTMLEmbedElement||t.hasAttribute("tabindex")&&-1!==t.getAttribute("tabindex")||t.hasAttribute("contenteditable")})},r}(Be);Dt.prototype.options_={pauseOnOpen:!0,temporary:!0},Be.registerComponent("ModalDialog",Dt);var Rt=function(e){function t(t){var n;void 0===t&&(t=[]),(n=e.call(this)||this).tracks_=[],Object.defineProperty(o(n),"length",{get:function(){return this.tracks_.length}});for(var i=0;i<t.length;i++)n.addTrack(t[i]);return n}i(t,e);var n=t.prototype;return n.addTrack=function(e){var t=this.tracks_.length;""+t in this||Object.defineProperty(this,t,{get:function(){return this.tracks_[t]}}),-1===this.tracks_.indexOf(e)&&(this.tracks_.push(e),this.trigger({track:e,type:"addtrack",target:this}))},n.removeTrack=function(e){for(var t,n=0,i=this.length;n<i;n++)if(this[n]===e){(t=this[n]).off&&t.off(),this.tracks_.splice(n,1);break}t&&this.trigger({track:t,type:"removetrack",target:this})},n.getTrackById=function(e){for(var t=null,n=0,i=this.length;n<i;n++){var r=this[n];if(r.id===e){t=r;break}}return t},t}(ke);for(var xt in Rt.prototype.allowedEvents_={change:"change",addtrack:"addtrack",removetrack:"removetrack"},Rt.prototype.allowedEvents_)Rt.prototype["on"+xt]=null;var At,Pt=function(e,t){for(var n=0;n<e.length;n++)Object.keys(e[n]).length&&t.id!==e[n].id&&(e[n].enabled=!1)},Lt=function(e){function t(t){var n;void 0===t&&(t=[]);for(var i=t.length-1;i>=0;i--)if(t[i].enabled){Pt(t,t[i]);break}return(n=e.call(this,t)||this).changing_=!1,n}i(t,e);var n=t.prototype;return n.addTrack=function(t){var n=this;t.enabled&&Pt(this,t),e.prototype.addTrack.call(this,t),t.addEventListener&&(t.enabledChange_=function(){n.changing_||(n.changing_=!0,Pt(n,t),n.changing_=!1,n.trigger("change"))},t.addEventListener("enabledchange",t.enabledChange_))},n.removeTrack=function(t){e.prototype.removeTrack.call(this,t),t.removeEventListener&&t.enabledChange_&&(t.removeEventListener("enabledchange",t.enabledChange_),t.enabledChange_=null)},t}(Rt),Nt=function(e,t){for(var n=0;n<e.length;n++)Object.keys(e[n]).length&&t.id!==e[n].id&&(e[n].selected=!1)},Mt=function(e){function t(t){var n;void 0===t&&(t=[]);for(var i=t.length-1;i>=0;i--)if(t[i].selected){Nt(t,t[i]);break}return(n=e.call(this,t)||this).changing_=!1,Object.defineProperty(o(n),"selectedIndex",{get:function(){for(var e=0;e<this.length;e++)if(this[e].selected)return e;return-1},set:function(){}}),n}i(t,e);var n=t.prototype;return n.addTrack=function(t){var n=this;t.selected&&Nt(this,t),e.prototype.addTrack.call(this,t),t.addEventListener&&(t.selectedChange_=function(){n.changing_||(n.changing_=!0,Nt(n,t),n.changing_=!1,n.trigger("change"))},t.addEventListener("selectedchange",t.selectedChange_))},n.removeTrack=function(t){e.prototype.removeTrack.call(this,t),t.removeEventListener&&t.selectedChange_&&(t.removeEventListener("selectedchange",t.selectedChange_),t.selectedChange_=null)},t}(Rt),Kt=function(e){function t(){return e.apply(this,arguments)||this}i(t,e);var n=t.prototype;return n.addTrack=function(t){var n=this;e.prototype.addTrack.call(this,t),this.queueChange_||(this.queueChange_=function(){return n.queueTrigger("change")}),this.triggerSelectedlanguagechange||(this.triggerSelectedlanguagechange_=function(){return n.trigger("selectedlanguagechange")}),t.addEventListener("modechange",this.queueChange_),-1===["metadata","chapters"].indexOf(t.kind)&&t.addEventListener("modechange",this.triggerSelectedlanguagechange_)},n.removeTrack=function(t){e.prototype.removeTrack.call(this,t),t.removeEventListener&&(this.queueChange_&&t.removeEventListener("modechange",this.queueChange_),this.selectedlanguagechange_&&t.removeEventListener("modechange",this.triggerSelectedlanguagechange_))},t}(Rt),$t=function(){function e(e){void 0===e&&(e=[]),this.trackElements_=[],Object.defineProperty(this,"length",{get:function(){return this.trackElements_.length}});for(var t=0,n=e.length;t<n;t++)this.addTrackElement_(e[t])}var t=e.prototype;return t.addTrackElement_=function(e){var t=this.trackElements_.length;""+t in this||Object.defineProperty(this,t,{get:function(){return this.trackElements_[t]}}),-1===this.trackElements_.indexOf(e)&&this.trackElements_.push(e)},t.getTrackElementByTrack_=function(e){for(var t,n=0,i=this.trackElements_.length;n<i;n++)if(e===this.trackElements_[n].track){t=this.trackElements_[n];break}return t},t.removeTrackElement_=function(e){for(var t=0,n=this.trackElements_.length;t<n;t++)if(e===this.trackElements_[t]){this.trackElements_[t].track&&"function"==typeof this.trackElements_[t].track.off&&this.trackElements_[t].track.off(),"function"==typeof this.trackElements_[t].off&&this.trackElements_[t].off(),this.trackElements_.splice(t,1);break}},e}(),jt=function(){function e(t){e.prototype.setCues_.call(this,t),Object.defineProperty(this,"length",{get:function(){return this.length_}})}var t=e.prototype;return t.setCues_=function(e){var t=this.length||0,n=0,i=e.length;this.cues_=e,this.length_=e.length;var r=function(e){""+e in this||Object.defineProperty(this,""+e,{get:function(){return this.cues_[e]}})};if(t<i)for(n=t;n<i;n++)r.call(this,n)},t.getCueById=function(e){for(var t=null,n=0,i=this.length;n<i;n++){var r=this[n];if(r.id===e){t=r;break}}return t},e}(),Bt={alternative:"alternative",captions:"captions",main:"main",sign:"sign",subtitles:"subtitles",commentary:"commentary"},Ft={alternative:"alternative",descriptions:"descriptions",main:"main","main-desc":"main-desc",translation:"translation",commentary:"commentary"},Ut={subtitles:"subtitles",captions:"captions",descriptions:"descriptions",chapters:"chapters",metadata:"metadata"},Vt={disabled:"disabled",hidden:"hidden",showing:"showing"},qt=function(e){function t(t){var n;void 0===t&&(t={}),n=e.call(this)||this;var i={id:t.id||"vjs_track_"+ne(),kind:t.kind||"",label:t.label||"",language:t.language||""},r=function(e){Object.defineProperty(o(n),e,{get:function(){return i[e]},set:function(){}})};for(var a in i)r(a);return n}return i(t,e),t}(ke),Ht=function(n){var i=["protocol","hostname","port","pathname","search","hash","host"],r=t.createElement("a");r.href=n;var a,o=""===r.host&&"file:"!==r.protocol;o&&((a=t.createElement("div")).innerHTML='<a href="'+n+'"></a>',r=a.firstChild,a.setAttribute("style","display:none; position:absolute;"),t.body.appendChild(a));for(var s={},l=0;l<i.length;l++)s[i[l]]=r[i[l]];return"http:"===s.protocol&&(s.host=s.host.replace(/:80$/,"")),"https:"===s.protocol&&(s.host=s.host.replace(/:443$/,"")),s.protocol||(s.protocol=e.location.protocol),o&&t.body.removeChild(a),s},zt=function(e){if(!e.match(/^https?:\/\//)){var n=t.createElement("div");n.innerHTML='<a href="'+e+'">x</a>',e=n.firstChild.href}return e},Wt=function(e){if("string"==typeof e){var t=/^(\/?)([\s\S]*?)((?:\.{1,2}|[^\/]+?)(\.([^\.\/\?]+)))(?:[\/]*|[\?].*)$/.exec(e);if(t)return t.pop().toLowerCase()}return""},Gt=function(t){var n=e.location,i=Ht(t);return(":"===i.protocol?n.protocol:i.protocol)+i.host!==n.protocol+n.host},Xt=Object.freeze({parseUrl:Ht,getAbsoluteURL:zt,getFileExtension:Wt,isCrossOrigin:Gt}),Yt=function(e){var t=Qt.call(e);return"[object Function]"===t||"function"==typeof e&&"[object RegExp]"!==t||"undefined"!=typeof window&&(e===window.setTimeout||e===window.alert||e===window.confirm||e===window.prompt)},Qt=Object.prototype.toString,Jt=Array.prototype.slice,Zt=Object.prototype.toString,en=Function.prototype.bind||function(e){var t=this;if("function"!=typeof t||"[object Function]"!==Zt.call(t))throw new TypeError("Function.prototype.bind called on incompatible "+t);for(var n,i=Jt.call(arguments,1),r=Math.max(0,t.length-i.length),a=[],o=0;o<r;o++)a.push("$"+o);if(n=Function("binder","return function ("+a.join(",")+"){ return binder.apply(this,arguments); }")(function(){if(this instanceof n){var r=t.apply(this,i.concat(Jt.call(arguments)));return Object(r)===r?r:this}return t.apply(e,i.concat(Jt.call(arguments)))}),t.prototype){var s=function(){};s.prototype=t.prototype,n.prototype=new s,s.prototype=null}return n},tn=Object.prototype.toString,nn=function(e){var t=tn.call(e),n="[object Arguments]"===t;return n||(n="[object Array]"!==t&&null!==e&&"object"==typeof e&&"number"==typeof e.length&&e.length>=0&&"[object Function]"===tn.call(e.callee)),n};if(!Object.keys){var rn=Object.prototype.hasOwnProperty,an=Object.prototype.toString,on=nn,sn=Object.prototype.propertyIsEnumerable,ln=!sn.call({toString:null},"toString"),un=sn.call(function(){},"prototype"),cn=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],dn=function(e){var t=e.constructor;return t&&t.prototype===e},hn={$applicationCache:!0,$console:!0,$external:!0,$frame:!0,$frameElement:!0,$frames:!0,$innerHeight:!0,$innerWidth:!0,$onmozfullscreenchange:!0,$onmozfullscreenerror:!0,$outerHeight:!0,$outerWidth:!0,$pageXOffset:!0,$pageYOffset:!0,$parent:!0,$scrollLeft:!0,$scrollTop:!0,$scrollX:!0,$scrollY:!0,$self:!0,$webkitIndexedDB:!0,$webkitStorageInfo:!0,$window:!0},pn=function(){if("undefined"==typeof window)return!1;for(var e in window)try{if(!hn["$"+e]&&rn.call(window,e)&&null!==window[e]&&"object"==typeof window[e])try{dn(window[e])}catch(e){return!0}}catch(e){return!0}return!1}();At=function(e){var t=null!==e&&"object"==typeof e,n="[object Function]"===an.call(e),i=on(e),r=t&&"[object String]"===an.call(e),a=[];if(!t&&!n&&!i)throw new TypeError("Object.keys called on a non-object");var o=un&&n;if(r&&e.length>0&&!rn.call(e,0))for(var s=0;s<e.length;++s)a.push(String(s));if(i&&e.length>0)for(var l=0;l<e.length;++l)a.push(String(l));else for(var u in e)o&&"prototype"===u||!rn.call(e,u)||a.push(String(u));if(ln)for(var c=function(e){if("undefined"==typeof window||!pn)return dn(e);try{return dn(e)}catch(e){return!1}}(e),d=0;d<cn.length;++d)c&&"constructor"===cn[d]||!rn.call(e,cn[d])||a.push(cn[d]);return a}}var fn=At,gn=Array.prototype.slice,mn=Object.keys,vn=mn?function(e){return mn(e)}:fn,yn=Object.keys;vn.shim=function(){Object.keys?function(){var e=Object.keys(arguments);return e&&e.length===arguments.length}(1,2)||(Object.keys=function(e){return nn(e)?yn(gn.call(e)):yn(e)}):Object.keys=vn;return Object.keys||vn};var bn=vn,_n="function"==typeof Symbol&&"symbol"==typeof Symbol("foo"),Tn=Object.prototype.toString,En=Array.prototype.concat,Cn=Object.defineProperty,wn=Cn&&function(){var e={};try{for(var t in Cn(e,"x",{enumerable:!1,value:e}),e)return!1;return e.x===e}catch(e){return!1}}(),kn=function(e,t,n,i){var r;t in e&&("function"!=typeof(r=i)||"[object Function]"!==Tn.call(r)||!i())||(wn?Cn(e,t,{configurable:!0,enumerable:!1,value:n,writable:!0}):e[t]=n)},Sn=function(e,t){var n=arguments.length>2?arguments[2]:{},i=bn(t);_n&&(i=En.call(i,Object.getOwnPropertySymbols(t)));for(var r=0;r<i.length;r+=1)kn(e,i[r],t[i[r]],n[i[r]])};Sn.supportsDescriptors=!!wn;var In=Sn,On=Object.getOwnPropertyDescriptor?function(){return Object.getOwnPropertyDescriptor(arguments,"callee").get}():function(){throw new TypeError},Dn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator,Rn=Object.getPrototypeOf||function(e){return e.__proto__},xn="undefined"==typeof Uint8Array?void 0:Rn(Uint8Array),An={"$ %Array%":Array,"$ %ArrayBuffer%":"undefined"==typeof ArrayBuffer?void 0:ArrayBuffer,"$ %ArrayBufferPrototype%":"undefined"==typeof ArrayBuffer?void 0:ArrayBuffer.prototype,"$ %ArrayIteratorPrototype%":Dn?Rn([][Symbol.iterator]()):void 0,"$ %ArrayPrototype%":Array.prototype,"$ %ArrayProto_entries%":Array.prototype.entries,"$ %ArrayProto_forEach%":Array.prototype.forEach,"$ %ArrayProto_keys%":Array.prototype.keys,"$ %ArrayProto_values%":Array.prototype.values,"$ %AsyncFromSyncIteratorPrototype%":void 0,"$ %AsyncFunction%":void 0,"$ %AsyncFunctionPrototype%":void 0,"$ %AsyncGenerator%":void 0,"$ %AsyncGeneratorFunction%":void 0,"$ %AsyncGeneratorPrototype%":void 0,"$ %AsyncIteratorPrototype%":void 0,"$ %Atomics%":"undefined"==typeof Atomics?void 0:Atomics,"$ %Boolean%":Boolean,"$ %BooleanPrototype%":Boolean.prototype,"$ %DataView%":"undefined"==typeof DataView?void 0:DataView,"$ %DataViewPrototype%":"undefined"==typeof DataView?void 0:DataView.prototype,"$ %Date%":Date,"$ %DatePrototype%":Date.prototype,"$ %decodeURI%":decodeURI,"$ %decodeURIComponent%":decodeURIComponent,"$ %encodeURI%":encodeURI,"$ %encodeURIComponent%":encodeURIComponent,"$ %Error%":Error,"$ %ErrorPrototype%":Error.prototype,"$ %eval%":eval,"$ %EvalError%":EvalError,"$ %EvalErrorPrototype%":EvalError.prototype,"$ %Float32Array%":"undefined"==typeof Float32Array?void 0:Float32Array,"$ %Float32ArrayPrototype%":"undefined"==typeof Float32Array?void 0:Float32Array.prototype,"$ %Float64Array%":"undefined"==typeof Float64Array?void 0:Float64Array,"$ %Float64ArrayPrototype%":"undefined"==typeof Float64Array?void 0:Float64Array.prototype,"$ %Function%":Function,"$ %FunctionPrototype%":Function.prototype,"$ %Generator%":void 0,"$ %GeneratorFunction%":void 0,"$ %GeneratorPrototype%":void 0,"$ %Int8Array%":"undefined"==typeof Int8Array?void 0:Int8Array,"$ %Int8ArrayPrototype%":"undefined"==typeof Int8Array?void 0:Int8Array.prototype,"$ %Int16Array%":"undefined"==typeof Int16Array?void 0:Int16Array,"$ %Int16ArrayPrototype%":"undefined"==typeof Int16Array?void 0:Int8Array.prototype,"$ %Int32Array%":"undefined"==typeof Int32Array?void 0:Int32Array,"$ %Int32ArrayPrototype%":"undefined"==typeof Int32Array?void 0:Int32Array.prototype,"$ %isFinite%":isFinite,"$ %isNaN%":isNaN,"$ %IteratorPrototype%":Dn?Rn(Rn([][Symbol.iterator]())):void 0,"$ %JSON%":JSON,"$ %JSONParse%":JSON.parse,"$ %Map%":"undefined"==typeof Map?void 0:Map,"$ %MapIteratorPrototype%":"undefined"!=typeof Map&&Dn?Rn((new Map)[Symbol.iterator]()):void 0,"$ %MapPrototype%":"undefined"==typeof Map?void 0:Map.prototype,"$ %Math%":Math,"$ %Number%":Number,"$ %NumberPrototype%":Number.prototype,"$ %Object%":Object,"$ %ObjectPrototype%":Object.prototype,"$ %ObjProto_toString%":Object.prototype.toString,"$ %ObjProto_valueOf%":Object.prototype.valueOf,"$ %parseFloat%":parseFloat,"$ %parseInt%":parseInt,"$ %Promise%":"undefined"==typeof Promise?void 0:Promise,"$ %PromisePrototype%":"undefined"==typeof Promise?void 0:Promise.prototype,"$ %PromiseProto_then%":"undefined"==typeof Promise?void 0:Promise.prototype.then,"$ %Promise_all%":"undefined"==typeof Promise?void 0:Promise.all,"$ %Promise_reject%":"undefined"==typeof Promise?void 0:Promise.reject,"$ %Promise_resolve%":"undefined"==typeof Promise?void 0:Promise.resolve,"$ %Proxy%":"undefined"==typeof Proxy?void 0:Proxy,"$ %RangeError%":RangeError,"$ %RangeErrorPrototype%":RangeError.prototype,"$ %ReferenceError%":ReferenceError,"$ %ReferenceErrorPrototype%":ReferenceError.prototype,"$ %Reflect%":"undefined"==typeof Reflect?void 0:Reflect,"$ %RegExp%":RegExp,"$ %RegExpPrototype%":RegExp.prototype,"$ %Set%":"undefined"==typeof Set?void 0:Set,"$ %SetIteratorPrototype%":"undefined"!=typeof Set&&Dn?Rn((new Set)[Symbol.iterator]()):void 0,"$ %SetPrototype%":"undefined"==typeof Set?void 0:Set.prototype,"$ %SharedArrayBuffer%":"undefined"==typeof SharedArrayBuffer?void 0:SharedArrayBuffer,"$ %SharedArrayBufferPrototype%":"undefined"==typeof SharedArrayBuffer?void 0:SharedArrayBuffer.prototype,"$ %String%":String,"$ %StringIteratorPrototype%":Dn?Rn(""[Symbol.iterator]()):void 0,"$ %StringPrototype%":String.prototype,"$ %Symbol%":Dn?Symbol:void 0,"$ %SymbolPrototype%":Dn?Symbol.prototype:void 0,"$ %SyntaxError%":SyntaxError,"$ %SyntaxErrorPrototype%":SyntaxError.prototype,"$ %ThrowTypeError%":On,"$ %TypedArray%":xn,"$ %TypedArrayPrototype%":xn?xn.prototype:void 0,"$ %TypeError%":TypeError,"$ %TypeErrorPrototype%":TypeError.prototype,"$ %Uint8Array%":"undefined"==typeof Uint8Array?void 0:Uint8Array,"$ %Uint8ArrayPrototype%":"undefined"==typeof Uint8Array?void 0:Uint8Array.prototype,"$ %Uint8ClampedArray%":"undefined"==typeof Uint8ClampedArray?void 0:Uint8ClampedArray,"$ %Uint8ClampedArrayPrototype%":"undefined"==typeof Uint8ClampedArray?void 0:Uint8ClampedArray.prototype,"$ %Uint16Array%":"undefined"==typeof Uint16Array?void 0:Uint16Array,"$ %Uint16ArrayPrototype%":"undefined"==typeof Uint16Array?void 0:Uint16Array.prototype,"$ %Uint32Array%":"undefined"==typeof Uint32Array?void 0:Uint32Array,"$ %Uint32ArrayPrototype%":"undefined"==typeof Uint32Array?void 0:Uint32Array.prototype,"$ %URIError%":URIError,"$ %URIErrorPrototype%":URIError.prototype,"$ %WeakMap%":"undefined"==typeof WeakMap?void 0:WeakMap,"$ %WeakMapPrototype%":"undefined"==typeof WeakMap?void 0:WeakMap.prototype,"$ %WeakSet%":"undefined"==typeof WeakSet?void 0:WeakSet,"$ %WeakSetPrototype%":"undefined"==typeof WeakSet?void 0:WeakSet.prototype},Pn=function(e,t){if(arguments.length>1&&"boolean"!=typeof t)throw new TypeError('"allowMissing" argument must be a boolean');var n="$ "+e;if(!(n in An))throw new SyntaxError("intrinsic "+e+" does not exist!");if(void 0===An[n]&&!t)throw new TypeError("intrinsic "+e+" exists, but is not available. Please file an issue!");return An[n]},Ln=(en.call(Function.call,Object.prototype.hasOwnProperty),Pn("%TypeError%"),Pn("%SyntaxError%"),Number.isNaN,Number.isNaN||function(e){return e!=e}),Nn=(Number.isFinite,Function.prototype.toString),Mn=/^\s*class\b/,Kn=function(e){try{var t=Nn.call(e);return Mn.test(t)}catch(e){return!1}},$n=Object.prototype.toString,jn="function"==typeof Symbol&&"symbol"==typeof Symbol.toStringTag,Bn=function(e){if(!e)return!1;if("function"!=typeof e&&"object"!=typeof e)return!1;if("function"==typeof e&&!e.prototype)return!0;if(jn)return function(e){try{return!Kn(e)&&(Nn.call(e),!0)}catch(e){return!1}}(e);if(Kn(e))return!1;var t=$n.call(e);return"[object Function]"===t||"[object GeneratorFunction]"===t},Fn=(Object.prototype.toString,Pn("%Object%"),Pn("%TypeError%")),Un=Pn("%String%"),Vn=function(e){return Un(e)},qn=function(e,t){if(null==e)throw new Fn(t||"Cannot call method on "+e);return e},Hn=en.call(Function.call,String.prototype.replace),zn=/^[\x09\x0A\x0B\x0C\x0D\x20\xA0\u1680\u180E\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200A\u202F\u205F\u3000\u2028\u2029\uFEFF]+/,Wn=/[\x09\x0A\x0B\x0C\x0D\x20\xA0\u1680\u180E\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200A\u202F\u205F\u3000\u2028\u2029\uFEFF]+$/,Gn=function(){var e=Vn(qn(this));return Hn(Hn(e,zn,""),Wn,"")},Xn=function(){return String.prototype.trim&&"​"==="​".trim()?String.prototype.trim:Gn},Yn=en.call(Function.call,Xn());In(Yn,{getPolyfill:Xn,implementation:Gn,shim:function(){var e=Xn();return In(String.prototype,{trim:e},{trim:function(){return String.prototype.trim!==e}}),e}});var Qn=Yn,Jn=Object.prototype.toString,Zn=Object.prototype.hasOwnProperty,ei=function(e){if(!e)return{};var t={};return function(e,t,n){if(!Bn(t))throw new TypeError("iterator must be a function");var i;arguments.length>=3&&(i=n),"[object Array]"===Jn.call(e)?function(e,t,n){for(var i=0,r=e.length;i<r;i++)Zn.call(e,i)&&(null==n?t(e[i],i,e):t.call(n,e[i],i,e))}(e,t,i):"string"==typeof e?function(e,t,n){for(var i=0,r=e.length;i<r;i++)null==n?t(e.charAt(i),i,e):t.call(n,e.charAt(i),i,e)}(e,t,i):function(e,t,n){for(var i in e)Zn.call(e,i)&&(null==n?t(e[i],i,e):t.call(n,e[i],i,e))}(e,t,i)}(Qn(e).split("\n"),function(e){var n,i=e.indexOf(":"),r=Qn(e.slice(0,i)).toLowerCase(),a=Qn(e.slice(i+1));void 0===t[r]?t[r]=a:(n=t[r],"[object Array]"===Object.prototype.toString.call(n)?t[r].push(a):t[r]=[t[r],a])}),t},ti=function(){for(var e={},t=0;t<arguments.length;t++){var n=arguments[t];for(var i in n)ni.call(n,i)&&(e[i]=n[i])}return e},ni=Object.prototype.hasOwnProperty,ii=ai;function ri(e,t,n){var i=e;return Yt(t)?(n=t,"string"==typeof e&&(i={uri:e})):i=ti(t,{uri:e}),i.callback=n,i}function ai(e,t,n){return oi(t=ri(e,t,n))}function oi(e){if(void 0===e.callback)throw new Error("callback argument missing");var t=!1,n=function(n,i,r){t||(t=!0,e.callback(n,i,r))};function i(e){return clearTimeout(l),e instanceof Error||(e=new Error(""+(e||"Unknown XMLHttpRequest Error"))),e.statusCode=0,n(e,g)}function r(){if(!o){var t;clearTimeout(l),t=e.useXDR&&void 0===s.status?200:1223===s.status?204:s.status;var i=g,r=null;return 0!==t?(i={body:function(){var e=void 0;if(e=s.response?s.response:s.responseText||function(e){if("document"===e.responseType)return e.responseXML;var t=e.responseXML&&"parsererror"===e.responseXML.documentElement.nodeName;return""!==e.responseType||t?null:e.responseXML}(s),f)try{e=JSON.parse(e)}catch(e){}return e}(),statusCode:t,method:c,headers:{},url:u,rawRequest:s},s.getAllResponseHeaders&&(i.headers=ei(s.getAllResponseHeaders()))):r=new Error("Internal XMLHttpRequest Error"),n(r,i,i.body)}}var a,o,s=e.xhr||null;s||(s=e.cors||e.useXDR?new ai.XDomainRequest:new ai.XMLHttpRequest);var l,u=s.url=e.uri||e.url,c=s.method=e.method||"GET",d=e.body||e.data,h=s.headers=e.headers||{},p=!!e.sync,f=!1,g={body:void 0,headers:{},statusCode:0,method:c,url:u,rawRequest:s};if("json"in e&&!1!==e.json&&(f=!0,h.accept||h.Accept||(h.Accept="application/json"),"GET"!==c&&"HEAD"!==c&&(h["content-type"]||h["Content-Type"]||(h["Content-Type"]="application/json"),d=JSON.stringify(!0===e.json?d:e.json))),s.onreadystatechange=function(){4===s.readyState&&setTimeout(r,0)},s.onload=r,s.onerror=i,s.onprogress=function(){},s.onabort=function(){o=!0},s.ontimeout=i,s.open(c,u,!p,e.username,e.password),p||(s.withCredentials=!!e.withCredentials),!p&&e.timeout>0&&(l=setTimeout(function(){if(!o){o=!0,s.abort("timeout");var e=new Error("XMLHttpRequest timeout");e.code="ETIMEDOUT",i(e)}},e.timeout)),s.setRequestHeader)for(a in h)h.hasOwnProperty(a)&&s.setRequestHeader(a,h[a]);else if(e.headers&&!function(e){for(var t in e)if(e.hasOwnProperty(t))return!1;return!0}(e.headers))throw new Error("Headers cannot be set on an XDomainRequest object");return"responseType"in e&&(s.responseType=e.responseType),"beforeSend"in e&&"function"==typeof e.beforeSend&&e.beforeSend(s),s.send(d||null),s}ai.XMLHttpRequest=e.XMLHttpRequest||function(){},ai.XDomainRequest="withCredentials"in new ai.XMLHttpRequest?ai.XMLHttpRequest:e.XDomainRequest,function(e,t){for(var n=0;n<e.length;n++)t(e[n])}(["get","put","post","patch","head","delete"],function(e){ai["delete"===e?"del":e]=function(t,n,i){return(n=ri(t,n,i)).method=e.toUpperCase(),oi(n)}});var si=function(t,n){var i=new e.WebVTT.Parser(e,e.vttjs,e.WebVTT.StringDecoder()),r=[];i.oncue=function(e){n.addCue(e)},i.onparsingerror=function(e){r.push(e)},i.onflush=function(){n.trigger({type:"loadeddata",target:n})},i.parse(t),r.length>0&&(e.console&&e.console.groupCollapsed&&e.console.groupCollapsed("Text Track parsing errors for "+n.src),r.forEach(function(e){return c.error(e)}),e.console&&e.console.groupEnd&&e.console.groupEnd()),i.flush()},li=function(t,n){var i={uri:t},r=Gt(t);r&&(i.cors=r),ii(i,Ee(this,function(t,i,r){if(t)return c.error(t,i);n.loaded_=!0,"function"!=typeof e.WebVTT?n.tech_&&n.tech_.any(["vttjsloaded","vttjserror"],function(e){if("vttjserror"!==e.type)return si(r,n);c.error("vttjs failed to load, stopping trying to process "+n.src)}):si(r,n)}))},ui=function(t){function n(e){var n;if(void 0===e&&(e={}),!e.tech)throw new Error("A tech was not provided.");var i=je(e,{kind:Ut[e.kind]||"subtitles",language:e.language||e.srclang||""}),r=Vt[i.mode]||"disabled",a=i.default;"metadata"!==i.kind&&"chapters"!==i.kind||(r="hidden"),(n=t.call(this,i)||this).tech_=i.tech,n.cues_=[],n.activeCues_=[];var s=new jt(n.cues_),l=new jt(n.activeCues_),u=!1,c=Ee(o(n),function(){this.activeCues=this.activeCues,u&&(this.trigger("cuechange"),u=!1)});return"disabled"!==r&&n.tech_.ready(function(){n.tech_.on("timeupdate",c)},!0),Object.defineProperties(o(n),{default:{get:function(){return a},set:function(){}},mode:{get:function(){return r},set:function(e){var t=this;Vt[e]&&("disabled"!==(r=e)?this.tech_.ready(function(){t.tech_.on("timeupdate",c)},!0):this.tech_.off("timeupdate",c),this.trigger("modechange"))}},cues:{get:function(){return this.loaded_?s:null},set:function(){}},activeCues:{get:function(){if(!this.loaded_)return null;if(0===this.cues.length)return l;for(var e=this.tech_.currentTime(),t=[],n=0,i=this.cues.length;n<i;n++){var r=this.cues[n];r.startTime<=e&&r.endTime>=e?t.push(r):r.startTime===r.endTime&&r.startTime<=e&&r.startTime+.5>=e&&t.push(r)}if(u=!1,t.length!==this.activeCues_.length)u=!0;else for(var a=0;a<t.length;a++)-1===this.activeCues_.indexOf(t[a])&&(u=!0);return this.activeCues_=t,l.setCues_(this.activeCues_),l},set:function(){}}}),i.src?(n.src=i.src,li(i.src,o(n))):n.loaded_=!0,n}i(n,t);var r=n.prototype;return r.addCue=function(t){var n=t;if(e.vttjs&&!(t instanceof e.vttjs.VTTCue)){for(var i in n=new e.vttjs.VTTCue(t.startTime,t.endTime,t.text),t)i in n||(n[i]=t[i]);n.id=t.id,n.originalCue_=t}for(var r=this.tech_.textTracks(),a=0;a<r.length;a++)r[a]!==this&&r[a].removeCue(n);this.cues_.push(n),this.cues.setCues_(this.cues_)},r.removeCue=function(e){for(var t=this.cues_.length;t--;){var n=this.cues_[t];if(n===e||n.originalCue_&&n.originalCue_===e){this.cues_.splice(t,1),this.cues.setCues_(this.cues_);break}}},n}(qt);ui.prototype.allowedEvents_={cuechange:"cuechange"};var ci=function(e){function t(t){var n;void 0===t&&(t={});var i=je(t,{kind:Ft[t.kind]||""});n=e.call(this,i)||this;var r=!1;return Object.defineProperty(o(n),"enabled",{get:function(){return r},set:function(e){"boolean"==typeof e&&e!==r&&(r=e,this.trigger("enabledchange"))}}),i.enabled&&(n.enabled=i.enabled),n.loaded_=!0,n}return i(t,e),t}(qt),di=function(e){function t(t){var n;void 0===t&&(t={});var i=je(t,{kind:Bt[t.kind]||""});n=e.call(this,i)||this;var r=!1;return Object.defineProperty(o(n),"selected",{get:function(){return r},set:function(e){"boolean"==typeof e&&e!==r&&(r=e,this.trigger("selectedchange"))}}),i.selected&&(n.selected=i.selected),n}return i(t,e),t}(qt),hi=0,pi=2,fi=function(e){function t(t){var n,i;void 0===t&&(t={}),n=e.call(this)||this;var r=new ui(t);return n.kind=r.kind,n.src=r.src,n.srclang=r.language,n.label=r.label,n.default=r.default,Object.defineProperties(o(n),{readyState:{get:function(){return i}},track:{get:function(){return r}}}),i=hi,r.addEventListener("loadeddata",function(){i=pi,n.trigger({type:"load",target:o(n)})}),n}return i(t,e),t}(ke);fi.prototype.allowedEvents_={load:"load"},fi.NONE=hi,fi.LOADING=1,fi.LOADED=pi,fi.ERROR=3;var gi={audio:{ListClass:Lt,TrackClass:ci,capitalName:"Audio"},video:{ListClass:Mt,TrackClass:di,capitalName:"Video"},text:{ListClass:Kt,TrackClass:ui,capitalName:"Text"}};Object.keys(gi).forEach(function(e){gi[e].getterName=e+"Tracks",gi[e].privateName=e+"Tracks_"});var mi={remoteText:{ListClass:Kt,TrackClass:ui,capitalName:"RemoteText",getterName:"remoteTextTracks",privateName:"remoteTextTracks_"},remoteTextEl:{ListClass:$t,TrackClass:fi,capitalName:"RemoteTextTrackEls",getterName:"remoteTextTrackEls",privateName:"remoteTextTrackEls_"}},vi=je(gi,mi);mi.names=Object.keys(mi),gi.names=Object.keys(gi),vi.names=[].concat(mi.names).concat(gi.names);var yi=Object.create||function(){function e(){}return function(t){if(1!==arguments.length)throw new Error("Object.create shim only accepts one parameter.");return e.prototype=t,new e}}();function bi(e,t){this.name="ParsingError",this.code=e.code,this.message=t||e.message}function _i(e){function t(e,t,n,i){return 3600*(0|e)+60*(0|t)+(0|n)+(0|i)/1e3}var n=e.match(/^(\d+):(\d{2})(:\d{2})?\.(\d{3})/);return n?n[3]?t(n[1],n[2],n[3].replace(":",""),n[4]):n[1]>59?t(n[1],n[2],0,n[4]):t(0,n[1],n[2],n[4]):null}function Ti(){this.values=yi(null)}function Ei(e,t,n,i){var r=i?e.split(i):[e];for(var a in r)if("string"==typeof r[a]){var o=r[a].split(n);if(2===o.length)t(o[0],o[1])}}function Ci(e,t,n){var i=e;function r(){var t=_i(e);if(null===t)throw new bi(bi.Errors.BadTimeStamp,"Malformed timestamp: "+i);return e=e.replace(/^[^\sa-zA-Z-]+/,""),t}function a(){e=e.replace(/^\s+/,"")}if(a(),t.startTime=r(),a(),"--\x3e"!==e.substr(0,3))throw new bi(bi.Errors.BadTimeStamp,"Malformed time stamp (time stamps must be separated by '--\x3e'): "+i);e=e.substr(3),a(),t.endTime=r(),a(),function(e,t){var i=new Ti;Ei(e,function(e,t){switch(e){case"region":for(var r=n.length-1;r>=0;r--)if(n[r].id===t){i.set(e,n[r].region);break}break;case"vertical":i.alt(e,t,["rl","lr"]);break;case"line":var a=t.split(","),o=a[0];i.integer(e,o),i.percent(e,o)&&i.set("snapToLines",!1),i.alt(e,o,["auto"]),2===a.length&&i.alt("lineAlign",a[1],["start","middle","end"]);break;case"position":a=t.split(","),i.percent(e,a[0]),2===a.length&&i.alt("positionAlign",a[1],["start","middle","end"]);break;case"size":i.percent(e,t);break;case"align":i.alt(e,t,["start","middle","end","left","right"])}},/:/,/\s/),t.region=i.get("region",null),t.vertical=i.get("vertical",""),t.line=i.get("line","auto"),t.lineAlign=i.get("lineAlign","start"),t.snapToLines=i.get("snapToLines",!0),t.size=i.get("size",100),t.align=i.get("align","middle"),t.position=i.get("position",{start:0,left:0,middle:50,end:100,right:100},t.align),t.positionAlign=i.get("positionAlign",{start:"start",left:"start",middle:"middle",end:"end",right:"end"},t.align)}(e,t)}bi.prototype=yi(Error.prototype),bi.prototype.constructor=bi,bi.Errors={BadSignature:{code:0,message:"Malformed WebVTT signature."},BadTimeStamp:{code:1,message:"Malformed time stamp."}},Ti.prototype={set:function(e,t){this.get(e)||""===t||(this.values[e]=t)},get:function(e,t,n){return n?this.has(e)?this.values[e]:t[n]:this.has(e)?this.values[e]:t},has:function(e){return e in this.values},alt:function(e,t,n){for(var i=0;i<n.length;++i)if(t===n[i]){this.set(e,t);break}},integer:function(e,t){/^-?\d+$/.test(t)&&this.set(e,parseInt(t,10))},percent:function(e,t){return!!(t.match(/^([\d]{1,3})(\.[\d]*)?%$/)&&(t=parseFloat(t))>=0&&t<=100)&&(this.set(e,t),!0)}};var wi={"&amp;":"&","&lt;":"<","&gt;":">","&lrm;":"‎","&rlm;":"‏","&nbsp;":" "},ki={c:"span",i:"i",b:"b",u:"u",ruby:"ruby",rt:"rt",v:"span",lang:"span"},Si={v:"title",lang:"lang"},Ii={rt:"ruby"};function Oi(e,t){function n(){if(!t)return null;var e,n=t.match(/^([^<]*)(<[^>]*>?)?/);return e=n[1]?n[1]:n[2],t=t.substr(e.length),e}function i(e){return wi[e]}function r(e){for(;p=e.match(/&(amp|lt|gt|lrm|rlm|nbsp);/);)e=e.replace(p[0],i);return e}function a(e,t){return!Ii[t.localName]||Ii[t.localName]===e.localName}function o(t,n){var i=ki[t];if(!i)return null;var r=e.document.createElement(i);r.localName=i;var a=Si[t];return a&&n&&(r[a]=n.trim()),r}for(var s,l=e.document.createElement("div"),u=l,c=[];null!==(s=n());)if("<"!==s[0])u.appendChild(e.document.createTextNode(r(s)));else{if("/"===s[1]){c.length&&c[c.length-1]===s.substr(2).replace(">","")&&(c.pop(),u=u.parentNode);continue}var d,h=_i(s.substr(1,s.length-2));if(h){d=e.document.createProcessingInstruction("timestamp",h),u.appendChild(d);continue}var p=s.match(/^<([^.\s/0-9>]+)(\.[^\s\\>]+)?([^>\\]+)?(\\?)>?$/);if(!p)continue;if(!(d=o(p[1],p[3])))continue;if(!a(u,d))continue;p[2]&&(d.className=p[2].substr(1).replace("."," ")),c.push(p[1]),u.appendChild(d),u=d}return l}var Di=[[1470,1470],[1472,1472],[1475,1475],[1478,1478],[1488,1514],[1520,1524],[1544,1544],[1547,1547],[1549,1549],[1563,1563],[1566,1610],[1645,1647],[1649,1749],[1765,1766],[1774,1775],[1786,1805],[1807,1808],[1810,1839],[1869,1957],[1969,1969],[1984,2026],[2036,2037],[2042,2042],[2048,2069],[2074,2074],[2084,2084],[2088,2088],[2096,2110],[2112,2136],[2142,2142],[2208,2208],[2210,2220],[8207,8207],[64285,64285],[64287,64296],[64298,64310],[64312,64316],[64318,64318],[64320,64321],[64323,64324],[64326,64449],[64467,64829],[64848,64911],[64914,64967],[65008,65020],[65136,65140],[65142,65276],[67584,67589],[67592,67592],[67594,67637],[67639,67640],[67644,67644],[67647,67669],[67671,67679],[67840,67867],[67872,67897],[67903,67903],[67968,68023],[68030,68031],[68096,68096],[68112,68115],[68117,68119],[68121,68147],[68160,68167],[68176,68184],[68192,68223],[68352,68405],[68416,68437],[68440,68466],[68472,68479],[68608,68680],[126464,126467],[126469,126495],[126497,126498],[126500,126500],[126503,126503],[126505,126514],[126516,126519],[126521,126521],[126523,126523],[126530,126530],[126535,126535],[126537,126537],[126539,126539],[126541,126543],[126545,126546],[126548,126548],[126551,126551],[126553,126553],[126555,126555],[126557,126557],[126559,126559],[126561,126562],[126564,126564],[126567,126570],[126572,126578],[126580,126583],[126585,126588],[126590,126590],[126592,126601],[126603,126619],[126625,126627],[126629,126633],[126635,126651],[1114109,1114109]];function Ri(e){for(var t=0;t<Di.length;t++){var n=Di[t];if(e>=n[0]&&e<=n[1])return!0}return!1}function xi(){}function Ai(e,t,n){xi.call(this),this.cue=t,this.cueDiv=Oi(e,t.text);var i={color:"rgba(255, 255, 255, 1)",backgroundColor:"rgba(0, 0, 0, 0.8)",position:"relative",left:0,right:0,top:0,bottom:0,display:"inline",writingMode:""===t.vertical?"horizontal-tb":"lr"===t.vertical?"vertical-lr":"vertical-rl",unicodeBidi:"plaintext"};this.applyStyles(i,this.cueDiv),this.div=e.document.createElement("div"),i={direction:function(e){var t=[],n="";if(!e||!e.childNodes)return"ltr";function i(e,t){for(var n=t.childNodes.length-1;n>=0;n--)e.push(t.childNodes[n])}function r(e){if(!e||!e.length)return null;var t=e.pop(),n=t.textContent||t.innerText;if(n){var a=n.match(/^.*(\n|\r)/);return a?(e.length=0,a[0]):n}return"ruby"===t.tagName?r(e):t.childNodes?(i(e,t),r(e)):void 0}for(i(t,e);n=r(t);)for(var a=0;a<n.length;a++)if(Ri(n.charCodeAt(a)))return"rtl";return"ltr"}(this.cueDiv),writingMode:""===t.vertical?"horizontal-tb":"lr"===t.vertical?"vertical-lr":"vertical-rl",unicodeBidi:"plaintext",textAlign:"middle"===t.align?"center":t.align,font:n.font,whiteSpace:"pre-line",position:"absolute"},this.applyStyles(i),this.div.appendChild(this.cueDiv);var r=0;switch(t.positionAlign){case"start":r=t.position;break;case"middle":r=t.position-t.size/2;break;case"end":r=t.position-t.size}""===t.vertical?this.applyStyles({left:this.formatStyle(r,"%"),width:this.formatStyle(t.size,"%")}):this.applyStyles({top:this.formatStyle(r,"%"),height:this.formatStyle(t.size,"%")}),this.move=function(e){this.applyStyles({top:this.formatStyle(e.top,"px"),bottom:this.formatStyle(e.bottom,"px"),left:this.formatStyle(e.left,"px"),right:this.formatStyle(e.right,"px"),height:this.formatStyle(e.height,"px"),width:this.formatStyle(e.width,"px")})}}function Pi(e){var t,n,i,r;if(e.div){n=e.div.offsetHeight,i=e.div.offsetWidth,r=e.div.offsetTop;var a=(a=e.div.childNodes)&&(a=a[0])&&a.getClientRects&&a.getClientRects();e=e.div.getBoundingClientRect(),t=a?Math.max(a[0]&&a[0].height||0,e.height/a.length):0}this.left=e.left,this.right=e.right,this.top=e.top||r,this.height=e.height||n,this.bottom=e.bottom||r+(e.height||n),this.width=e.width||i,this.lineHeight=void 0!==t?t:e.lineHeight}function Li(e,t,n,i){var r=new Pi(t),a=t.cue,o=function(e){if("number"==typeof e.line&&(e.snapToLines||e.line>=0&&e.line<=100))return e.line;if(!e.track||!e.track.textTrackList||!e.track.textTrackList.mediaElement)return-1;for(var t=e.track,n=t.textTrackList,i=0,r=0;r<n.length&&n[r]!==t;r++)"showing"===n[r].mode&&i++;return-1*++i}(a),s=[];if(a.snapToLines){var l;switch(a.vertical){case"":s=["+y","-y"],l="height";break;case"rl":s=["+x","-x"],l="width";break;case"lr":s=["-x","+x"],l="width"}var u=r.lineHeight,c=u*Math.round(o),d=n[l]+u,h=s[0];Math.abs(c)>d&&(c=c<0?-1:1,c*=Math.ceil(d/u)*u),o<0&&(c+=""===a.vertical?n.height:n.width,s=s.reverse()),r.move(h,c)}else{var p=r.lineHeight/n.height*100;switch(a.lineAlign){case"middle":o-=p/2;break;case"end":o-=p}switch(a.vertical){case"":t.applyStyles({top:t.formatStyle(o,"%")});break;case"rl":t.applyStyles({left:t.formatStyle(o,"%")});break;case"lr":t.applyStyles({right:t.formatStyle(o,"%")})}s=["+y","-x","+x","-y"],r=new Pi(t)}var f=function(e,t){for(var r,a=new Pi(e),o=1,s=0;s<t.length;s++){for(;e.overlapsOppositeAxis(n,t[s])||e.within(n)&&e.overlapsAny(i);)e.move(t[s]);if(e.within(n))return e;var l=e.intersectPercentage(n);o>l&&(r=new Pi(e),o=l),e=new Pi(a)}return r||a}(r,s);t.move(f.toCSSCompatValues(n))}function Ni(){}xi.prototype.applyStyles=function(e,t){for(var n in t=t||this.div,e)e.hasOwnProperty(n)&&(t.style[n]=e[n])},xi.prototype.formatStyle=function(e,t){return 0===e?0:e+t},Ai.prototype=yi(xi.prototype),Ai.prototype.constructor=Ai,Pi.prototype.move=function(e,t){switch(t=void 0!==t?t:this.lineHeight,e){case"+x":this.left+=t,this.right+=t;break;case"-x":this.left-=t,this.right-=t;break;case"+y":this.top+=t,this.bottom+=t;break;case"-y":this.top-=t,this.bottom-=t}},Pi.prototype.overlaps=function(e){return this.left<e.right&&this.right>e.left&&this.top<e.bottom&&this.bottom>e.top},Pi.prototype.overlapsAny=function(e){for(var t=0;t<e.length;t++)if(this.overlaps(e[t]))return!0;return!1},Pi.prototype.within=function(e){return this.top>=e.top&&this.bottom<=e.bottom&&this.left>=e.left&&this.right<=e.right},Pi.prototype.overlapsOppositeAxis=function(e,t){switch(t){case"+x":return this.left<e.left;case"-x":return this.right>e.right;case"+y":return this.top<e.top;case"-y":return this.bottom>e.bottom}},Pi.prototype.intersectPercentage=function(e){return Math.max(0,Math.min(this.right,e.right)-Math.max(this.left,e.left))*Math.max(0,Math.min(this.bottom,e.bottom)-Math.max(this.top,e.top))/(this.height*this.width)},Pi.prototype.toCSSCompatValues=function(e){return{top:this.top-e.top,bottom:e.bottom-this.bottom,left:this.left-e.left,right:e.right-this.right,height:this.height,width:this.width}},Pi.getSimpleBoxPosition=function(e){var t=e.div?e.div.offsetHeight:e.tagName?e.offsetHeight:0,n=e.div?e.div.offsetWidth:e.tagName?e.offsetWidth:0,i=e.div?e.div.offsetTop:e.tagName?e.offsetTop:0;return{left:(e=e.div?e.div.getBoundingClientRect():e.tagName?e.getBoundingClientRect():e).left,right:e.right,top:e.top||i,height:e.height||t,bottom:e.bottom||i+(e.height||t),width:e.width||n}},Ni.StringDecoder=function(){return{decode:function(e){if(!e)return"";if("string"!=typeof e)throw new Error("Error - expected string data.");return decodeURIComponent(encodeURIComponent(e))}}},Ni.convertCueToDOMTree=function(e,t){return e&&t?Oi(e,t):null},Ni.processCues=function(e,t,n){if(!e||!t||!n)return null;for(;n.firstChild;)n.removeChild(n.firstChild);var i=e.document.createElement("div");if(i.style.position="absolute",i.style.left="0",i.style.right="0",i.style.top="0",i.style.bottom="0",i.style.margin="1.5%",n.appendChild(i),function(e){for(var t=0;t<e.length;t++)if(e[t].hasBeenReset||!e[t].displayState)return!0;return!1}(t)){var r=[],a=Pi.getSimpleBoxPosition(i),o={font:Math.round(.05*a.height*100)/100+"px sans-serif"};!function(){for(var n,s,l=0;l<t.length;l++)s=t[l],n=new Ai(e,s,o),i.appendChild(n.div),Li(0,n,a,r),s.displayState=n.div,r.push(Pi.getSimpleBoxPosition(n))}()}else for(var s=0;s<t.length;s++)i.appendChild(t[s].displayState)},Ni.Parser=function(e,t,n){n||(n=t,t={}),t||(t={}),this.window=e,this.vttjs=t,this.state="INITIAL",this.buffer="",this.decoder=n||new TextDecoder("utf8"),this.regionList=[]},Ni.Parser.prototype={reportOrThrowError:function(e){if(!(e instanceof bi))throw e;this.onparsingerror&&this.onparsingerror(e)},parse:function(e){var t=this;function n(){for(var e=t.buffer,n=0;n<e.length&&"\r"!==e[n]&&"\n"!==e[n];)++n;var i=e.substr(0,n);return"\r"===e[n]&&++n,"\n"===e[n]&&++n,t.buffer=e.substr(n),i}function i(e){e.match(/X-TIMESTAMP-MAP/)?Ei(e,function(e,n){switch(e){case"X-TIMESTAMP-MAP":i=n,r=new Ti,Ei(i,function(e,t){switch(e){case"MPEGT":r.integer(e+"S",t);break;case"LOCA":r.set(e+"L",_i(t))}},/[^\d]:/,/,/),t.ontimestampmap&&t.ontimestampmap({MPEGTS:r.get("MPEGTS"),LOCAL:r.get("LOCAL")})}var i,r},/=/):Ei(e,function(e,n){switch(e){case"Region":!function(e){var n=new Ti;if(Ei(e,function(e,t){switch(e){case"id":n.set(e,t);break;case"width":n.percent(e,t);break;case"lines":n.integer(e,t);break;case"regionanchor":case"viewportanchor":var i=t.split(",");if(2!==i.length)break;var r=new Ti;if(r.percent("x",i[0]),r.percent("y",i[1]),!r.has("x")||!r.has("y"))break;n.set(e+"X",r.get("x")),n.set(e+"Y",r.get("y"));break;case"scroll":n.alt(e,t,["up"])}},/=/,/\s/),n.has("id")){var i=new(t.vttjs.VTTRegion||t.window.VTTRegion);i.width=n.get("width",100),i.lines=n.get("lines",3),i.regionAnchorX=n.get("regionanchorX",0),i.regionAnchorY=n.get("regionanchorY",100),i.viewportAnchorX=n.get("viewportanchorX",0),i.viewportAnchorY=n.get("viewportanchorY",100),i.scroll=n.get("scroll",""),t.onregion&&t.onregion(i),t.regionList.push({id:n.get("id"),region:i})}}(n)}},/:/)}e&&(t.buffer+=t.decoder.decode(e,{stream:!0}));try{var r;if("INITIAL"===t.state){if(!/\r\n|\n/.test(t.buffer))return this;var a=(r=n()).match(/^WEBVTT([ \t].*)?$/);if(!a||!a[0])throw new bi(bi.Errors.BadSignature);t.state="HEADER"}for(var o=!1;t.buffer;){if(!/\r\n|\n/.test(t.buffer))return this;switch(o?o=!1:r=n(),t.state){case"HEADER":/:/.test(r)?i(r):r||(t.state="ID");continue;case"NOTE":r||(t.state="ID");continue;case"ID":if(/^NOTE($|[ \t])/.test(r)){t.state="NOTE";break}if(!r)continue;if(t.cue=new(t.vttjs.VTTCue||t.window.VTTCue)(0,0,""),t.state="CUE",-1===r.indexOf("--\x3e")){t.cue.id=r;continue}case"CUE":try{Ci(r,t.cue,t.regionList)}catch(e){t.reportOrThrowError(e),t.cue=null,t.state="BADCUE";continue}t.state="CUETEXT";continue;case"CUETEXT":var s=-1!==r.indexOf("--\x3e");if(!r||s&&(o=!0)){t.oncue&&t.oncue(t.cue),t.cue=null,t.state="ID";continue}t.cue.text&&(t.cue.text+="\n"),t.cue.text+=r;continue;case"BADCUE":r||(t.state="ID");continue}}}catch(e){t.reportOrThrowError(e),"CUETEXT"===t.state&&t.cue&&t.oncue&&t.oncue(t.cue),t.cue=null,t.state="INITIAL"===t.state?"BADWEBVTT":"BADCUE"}return this},flush:function(){try{if(this.buffer+=this.decoder.decode(),(this.cue||"HEADER"===this.state)&&(this.buffer+="\n\n",this.parse()),"INITIAL"===this.state)throw new bi(bi.Errors.BadSignature)}catch(e){this.reportOrThrowError(e)}return this.onflush&&this.onflush(),this}};var Mi=Ni,Ki="auto",$i={"":1,lr:1,rl:1},ji={start:1,middle:1,end:1,left:1,right:1};function Bi(e){return"string"==typeof e&&(!!ji[e.toLowerCase()]&&e.toLowerCase())}function Fi(e,t,n){this.hasBeenReset=!1;var i="",r=!1,a=e,o=t,s=n,l=null,u="",c=!0,d="auto",h="start",p=50,f="middle",g=50,m="middle";Object.defineProperties(this,{id:{enumerable:!0,get:function(){return i},set:function(e){i=""+e}},pauseOnExit:{enumerable:!0,get:function(){return r},set:function(e){r=!!e}},startTime:{enumerable:!0,get:function(){return a},set:function(e){if("number"!=typeof e)throw new TypeError("Start time must be set to a number.");a=e,this.hasBeenReset=!0}},endTime:{enumerable:!0,get:function(){return o},set:function(e){if("number"!=typeof e)throw new TypeError("End time must be set to a number.");o=e,this.hasBeenReset=!0}},text:{enumerable:!0,get:function(){return s},set:function(e){s=""+e,this.hasBeenReset=!0}},region:{enumerable:!0,get:function(){return l},set:function(e){l=e,this.hasBeenReset=!0}},vertical:{enumerable:!0,get:function(){return u},set:function(e){var t=function(e){return"string"==typeof e&&!!$i[e.toLowerCase()]&&e.toLowerCase()}(e);if(!1===t)throw new SyntaxError("An invalid or illegal string was specified.");u=t,this.hasBeenReset=!0}},snapToLines:{enumerable:!0,get:function(){return c},set:function(e){c=!!e,this.hasBeenReset=!0}},line:{enumerable:!0,get:function(){return d},set:function(e){if("number"!=typeof e&&e!==Ki)throw new SyntaxError("An invalid number or illegal string was specified.");d=e,this.hasBeenReset=!0}},lineAlign:{enumerable:!0,get:function(){return h},set:function(e){var t=Bi(e);if(!t)throw new SyntaxError("An invalid or illegal string was specified.");h=t,this.hasBeenReset=!0}},position:{enumerable:!0,get:function(){return p},set:function(e){if(e<0||e>100)throw new Error("Position must be between 0 and 100.");p=e,this.hasBeenReset=!0}},positionAlign:{enumerable:!0,get:function(){return f},set:function(e){var t=Bi(e);if(!t)throw new SyntaxError("An invalid or illegal string was specified.");f=t,this.hasBeenReset=!0}},size:{enumerable:!0,get:function(){return g},set:function(e){if(e<0||e>100)throw new Error("Size must be between 0 and 100.");g=e,this.hasBeenReset=!0}},align:{enumerable:!0,get:function(){return m},set:function(e){var t=Bi(e);if(!t)throw new SyntaxError("An invalid or illegal string was specified.");m=t,this.hasBeenReset=!0}}}),this.displayState=void 0}Fi.prototype.getCueAsHTML=function(){return WebVTT.convertCueToDOMTree(window,this.text)};var Ui=Fi,Vi={"":!0,up:!0};function qi(e){return"number"==typeof e&&e>=0&&e<=100}var Hi=function(){var e=100,t=3,n=0,i=100,r=0,a=100,o="";Object.defineProperties(this,{width:{enumerable:!0,get:function(){return e},set:function(t){if(!qi(t))throw new Error("Width must be between 0 and 100.");e=t}},lines:{enumerable:!0,get:function(){return t},set:function(e){if("number"!=typeof e)throw new TypeError("Lines must be set to a number.");t=e}},regionAnchorY:{enumerable:!0,get:function(){return i},set:function(e){if(!qi(e))throw new Error("RegionAnchorX must be between 0 and 100.");i=e}},regionAnchorX:{enumerable:!0,get:function(){return n},set:function(e){if(!qi(e))throw new Error("RegionAnchorY must be between 0 and 100.");n=e}},viewportAnchorY:{enumerable:!0,get:function(){return a},set:function(e){if(!qi(e))throw new Error("ViewportAnchorY must be between 0 and 100.");a=e}},viewportAnchorX:{enumerable:!0,get:function(){return r},set:function(e){if(!qi(e))throw new Error("ViewportAnchorX must be between 0 and 100.");r=e}},scroll:{enumerable:!0,get:function(){return o},set:function(e){var t=function(e){return"string"==typeof e&&!!Vi[e.toLowerCase()]&&e.toLowerCase()}(e);if(!1===t)throw new SyntaxError("An invalid or illegal string was specified.");o=t}}})},zi=St(function(t){var n=t.exports={WebVTT:Mi,VTTCue:Ui,VTTRegion:Hi};e.vttjs=n,e.WebVTT=n.WebVTT;var i=n.VTTCue,r=n.VTTRegion,a=e.VTTCue,o=e.VTTRegion;n.shim=function(){e.VTTCue=i,e.VTTRegion=r},n.restore=function(){e.VTTCue=a,e.VTTRegion=o},e.VTTCue||n.shim()});zi.WebVTT,zi.VTTCue,zi.VTTRegion;var Wi=function(n){function r(e,t){var i;return void 0===e&&(e={}),void 0===t&&(t=function(){}),e.reportTouchActivity=!1,(i=n.call(this,null,e,t)||this).hasStarted_=!1,i.on("playing",function(){this.hasStarted_=!0}),i.on("loadstart",function(){this.hasStarted_=!1}),vi.names.forEach(function(t){var n=vi[t];e&&e[n.getterName]&&(i[n.privateName]=e[n.getterName])}),i.featuresProgressEvents||i.manualProgressOn(),i.featuresTimeupdateEvents||i.manualTimeUpdatesOn(),["Text","Audio","Video"].forEach(function(t){!1===e["native"+t+"Tracks"]&&(i["featuresNative"+t+"Tracks"]=!1)}),!1===e.nativeCaptions||!1===e.nativeTextTracks?i.featuresNativeTextTracks=!1:!0!==e.nativeCaptions&&!0!==e.nativeTextTracks||(i.featuresNativeTextTracks=!0),i.featuresNativeTextTracks||i.emulateTextTracks(),i.autoRemoteTextTracks_=new vi.text.ListClass,i.initTrackListeners(),e.nativeControlsForTouch||i.emitTapEvents(),i.constructor&&(i.name_=i.constructor.name||"Unknown Tech"),i}i(r,n);var a=r.prototype;return a.triggerSourceset=function(e){var t=this;this.isReady_||this.one("ready",function(){return t.setTimeout(function(){return t.triggerSourceset(e)},1)}),this.trigger({src:e,type:"sourceset"})},a.manualProgressOn=function(){this.on("durationchange",this.onDurationChange),this.manualProgress=!0,this.one("ready",this.trackProgress)},a.manualProgressOff=function(){this.manualProgress=!1,this.stopTrackingProgress(),this.off("durationchange",this.onDurationChange)},a.trackProgress=function(e){this.stopTrackingProgress(),this.progressInterval=this.setInterval(Ee(this,function(){var e=this.bufferedPercent();this.bufferedPercent_!==e&&this.trigger("progress"),this.bufferedPercent_=e,1===e&&this.stopTrackingProgress()}),500)},a.onDurationChange=function(e){this.duration_=this.duration()},a.buffered=function(){return dt(0,0)},a.bufferedPercent=function(){return ht(this.buffered(),this.duration_)},a.stopTrackingProgress=function(){this.clearInterval(this.progressInterval)},a.manualTimeUpdatesOn=function(){this.manualTimeUpdates=!0,this.on("play",this.trackCurrentTime),this.on("pause",this.stopTrackingCurrentTime)},a.manualTimeUpdatesOff=function(){this.manualTimeUpdates=!1,this.stopTrackingCurrentTime(),this.off("play",this.trackCurrentTime),this.off("pause",this.stopTrackingCurrentTime)},a.trackCurrentTime=function(){this.currentTimeInterval&&this.stopTrackingCurrentTime(),this.currentTimeInterval=this.setInterval(function(){this.trigger({type:"timeupdate",target:this,manuallyTriggered:!0})},250)},a.stopTrackingCurrentTime=function(){this.clearInterval(this.currentTimeInterval),this.trigger({type:"timeupdate",target:this,manuallyTriggered:!0})},a.dispose=function(){this.clearTracks(gi.names),this.manualProgress&&this.manualProgressOff(),this.manualTimeUpdates&&this.manualTimeUpdatesOff(),n.prototype.dispose.call(this)},a.clearTracks=function(e){var t=this;(e=[].concat(e)).forEach(function(e){for(var n=t[e+"Tracks"]()||[],i=n.length;i--;){var r=n[i];"text"===e&&t.removeRemoteTextTrack(r),n.removeTrack(r)}})},a.cleanupAutoTextTracks=function(){for(var e=this.autoRemoteTextTracks_||[],t=e.length;t--;){var n=e[t];this.removeRemoteTextTrack(n)}},a.reset=function(){},a.error=function(e){return void 0!==e&&(this.error_=new bt(e),this.trigger("error")),this.error_},a.played=function(){return this.hasStarted_?dt(0,0):dt()},a.setCurrentTime=function(){this.manualTimeUpdates&&this.trigger({type:"timeupdate",target:this,manuallyTriggered:!0})},a.initTrackListeners=function(){var e=this;gi.names.forEach(function(t){var n=gi[t],i=function(){e.trigger(t+"trackchange")},r=e[n.getterName]();r.addEventListener("removetrack",i),r.addEventListener("addtrack",i),e.on("dispose",function(){r.removeEventListener("removetrack",i),r.removeEventListener("addtrack",i)})})},a.addWebVttScript_=function(){var n=this;if(!e.WebVTT)if(t.body.contains(this.el())){if(!this.options_["vtt.js"]&&b(zi)&&Object.keys(zi).length>0)return void this.trigger("vttjsloaded");var i=t.createElement("script");i.src=this.options_["vtt.js"]||"https://vjs.zencdn.net/vttjs/0.14.1/vtt.min.js",i.onload=function(){n.trigger("vttjsloaded")},i.onerror=function(){n.trigger("vttjserror")},this.on("dispose",function(){i.onload=null,i.onerror=null}),e.WebVTT=!0,this.el().parentNode.appendChild(i)}else this.ready(this.addWebVttScript_)},a.emulateTextTracks=function(){var e=this,t=this.textTracks(),n=this.remoteTextTracks(),i=function(e){return t.addTrack(e.track)},r=function(e){return t.removeTrack(e.track)};n.on("addtrack",i),n.on("removetrack",r),this.addWebVttScript_();var a=function(){return e.trigger("texttrackchange")},o=function(){a();for(var e=0;e<t.length;e++){var n=t[e];n.removeEventListener("cuechange",a),"showing"===n.mode&&n.addEventListener("cuechange",a)}};o(),t.addEventListener("change",o),t.addEventListener("addtrack",o),t.addEventListener("removetrack",o),this.on("dispose",function(){n.off("addtrack",i),n.off("removetrack",r),t.removeEventListener("change",o),t.removeEventListener("addtrack",o),t.removeEventListener("removetrack",o);for(var e=0;e<t.length;e++){t[e].removeEventListener("cuechange",a)}})},a.addTextTrack=function(e,t,n){if(!e)throw new Error("TextTrack kind is required but was not provided");return function(e,t,n,i,r){void 0===r&&(r={});var a=e.textTracks();r.kind=t,n&&(r.label=n),i&&(r.language=i),r.tech=e;var o=new vi.text.TrackClass(r);return a.addTrack(o),o}(this,e,t,n)},a.createRemoteTextTrack=function(e){var t=je(e,{tech:this});return new mi.remoteTextEl.TrackClass(t)},a.addRemoteTextTrack=function(e,t){var n=this;void 0===e&&(e={});var i=this.createRemoteTextTrack(e);return!0!==t&&!1!==t&&(c.warn('Calling addRemoteTextTrack without explicitly setting the "manualCleanup" parameter to `true` is deprecated and default to `false` in future version of video.js'),t=!0),this.remoteTextTrackEls().addTrackElement_(i),this.remoteTextTracks().addTrack(i.track),!0!==t&&this.ready(function(){return n.autoRemoteTextTracks_.addTrack(i.track)}),i},a.removeRemoteTextTrack=function(e){var t=this.remoteTextTrackEls().getTrackElementByTrack_(e);this.remoteTextTrackEls().removeTrackElement_(t),this.remoteTextTracks().removeTrack(e),this.autoRemoteTextTracks_.removeTrack(e)},a.getVideoPlaybackQuality=function(){return{}},a.requestPictureInPicture=function(){var t=this.options_.Promise||e.Promise;if(t)return t.reject()},a.setPoster=function(){},a.playsinline=function(){},a.setPlaysinline=function(){},a.overrideNativeAudioTracks=function(){},a.overrideNativeVideoTracks=function(){},a.canPlayType=function(){return""},r.canPlayType=function(){return""},r.canPlaySource=function(e,t){return r.canPlayType(e.type)},r.isTech=function(e){return e.prototype instanceof r||e instanceof r||e===r},r.registerTech=function(e,t){if(r.techs_||(r.techs_={}),!r.isTech(t))throw new Error("Tech "+e+" must be a Tech");if(!r.canPlayType)throw new Error("Techs must have a static canPlayType method on them");if(!r.canPlaySource)throw new Error("Techs must have a static canPlaySource method on them");return e=$e(e),r.techs_[e]=t,r.techs_[Ke(e)]=t,"Tech"!==e&&r.defaultTechOrder_.push(e),t},r.getTech=function(t){if(t)return r.techs_&&r.techs_[t]?r.techs_[t]:(t=$e(t),e&&e.videojs&&e.videojs[t]?(c.warn("The "+t+" tech was added to the videojs object when it should be registered using videojs.registerTech(name, tech)"),e.videojs[t]):void 0)},r}(Be);vi.names.forEach(function(e){var t=vi[e];Wi.prototype[t.getterName]=function(){return this[t.privateName]=this[t.privateName]||new t.ListClass,this[t.privateName]}}),Wi.prototype.featuresVolumeControl=!0,Wi.prototype.featuresMuteControl=!0,Wi.prototype.featuresFullscreenResize=!1,Wi.prototype.featuresPlaybackRate=!1,Wi.prototype.featuresProgressEvents=!1,Wi.prototype.featuresSourceset=!1,Wi.prototype.featuresTimeupdateEvents=!1,Wi.prototype.featuresNativeTextTracks=!1,Wi.withSourceHandlers=function(e){e.registerSourceHandler=function(t,n){var i=e.sourceHandlers;i||(i=e.sourceHandlers=[]),void 0===n&&(n=i.length),i.splice(n,0,t)},e.canPlayType=function(t){for(var n,i=e.sourceHandlers||[],r=0;r<i.length;r++)if(n=i[r].canPlayType(t))return n;return""},e.selectSourceHandler=function(t,n){for(var i=e.sourceHandlers||[],r=0;r<i.length;r++)if(i[r].canHandleSource(t,n))return i[r];return null},e.canPlaySource=function(t,n){var i=e.selectSourceHandler(t,n);return i?i.canHandleSource(t,n):""},["seekable","seeking","duration"].forEach(function(e){var t=this[e];"function"==typeof t&&(this[e]=function(){return this.sourceHandler_&&this.sourceHandler_[e]?this.sourceHandler_[e].apply(this.sourceHandler_,arguments):t.apply(this,arguments)})},e.prototype),e.prototype.setSource=function(t){var n=e.selectSourceHandler(t,this.options_);n||(e.nativeSourceHandler?n=e.nativeSourceHandler:c.error("No source handler found for the current source.")),this.disposeSourceHandler(),this.off("dispose",this.disposeSourceHandler),n!==e.nativeSourceHandler&&(this.currentSource_=t),this.sourceHandler_=n.handleSource(t,this,this.options_),this.one("dispose",this.disposeSourceHandler)},e.prototype.disposeSourceHandler=function(){this.currentSource_&&(this.clearTracks(["audio","video"]),this.currentSource_=null),this.cleanupAutoTextTracks(),this.sourceHandler_&&(this.sourceHandler_.dispose&&this.sourceHandler_.dispose(),this.sourceHandler_=null)}},Be.registerComponent("Tech",Wi),Wi.registerTech("Tech",Wi),Wi.defaultTechOrder_=[];var Gi={},Xi={},Yi={};function Qi(e,t,n,i){void 0===i&&(i=null);var r="call"+$e(n),a=e.reduce(tr(r),i),o=a===Yi,s=o?null:t[n](a);return function(e,t,n,i){for(var r=e.length-1;r>=0;r--){var a=e[r];a[t]&&a[t](i,n)}}(e,n,s,o),s}var Ji={buffered:1,currentTime:1,duration:1,seekable:1,played:1,paused:1,volume:1},Zi={setCurrentTime:1,setVolume:1},er={play:1,pause:1};function tr(e){return function(t,n){return t===Yi?Yi:n[e]?n[e](t):t}}var nr={opus:"video/ogg",ogv:"video/ogg",mp4:"video/mp4",mov:"video/mp4",m4v:"video/mp4",mkv:"video/x-matroska",m4a:"audio/mp4",mp3:"audio/mpeg",aac:"audio/aac",oga:"audio/ogg",m3u8:"application/x-mpegURL",jpg:"image/jpeg",jpeg:"image/jpeg",gif:"image/gif",png:"image/png",svg:"image/svg+xml",webp:"image/webp"},ir=function(e){void 0===e&&(e="");var t=Wt(e);return nr[t.toLowerCase()]||""};function rr(e){if(!e.type){var t=ir(e.src);t&&(e.type=t)}return e}var ar=function(e){function t(t,n,i){var r,a=je({createEl:!1},n);if(r=e.call(this,t,a,i)||this,n.playerOptions.sources&&0!==n.playerOptions.sources.length)t.src(n.playerOptions.sources);else for(var o=0,s=n.playerOptions.techOrder;o<s.length;o++){var l=$e(s[o]),u=Wi.getTech(l);if(l||(u=Be.getComponent(l)),u&&u.isSupported()){t.loadTech_(l);break}}return r}return i(t,e),t}(Be);Be.registerComponent("MediaLoader",ar);var or=function(e){function t(t,n){var i;return(i=e.call(this,t,n)||this).emitTapEvents(),i.enable(),i}i(t,e);var n=t.prototype;return n.createEl=function(t,n,i){void 0===t&&(t="div"),void 0===n&&(n={}),void 0===i&&(i={}),n=v({innerHTML:'<span aria-hidden="true" class="vjs-icon-placeholder"></span>',className:this.buildCSSClass(),tabIndex:0},n),"button"===t&&c.error("Creating a ClickableComponent with an HTML element of "+t+" is not supported; use a Button instead."),i=v({role:"button"},i),this.tabIndex_=n.tabIndex;var r=e.prototype.createEl.call(this,t,n,i);return this.createControlTextEl(r),r},n.dispose=function(){this.controlTextEl_=null,e.prototype.dispose.call(this)},n.createControlTextEl=function(e){return this.controlTextEl_=O("span",{className:"vjs-control-text"},{"aria-live":"polite"}),e&&e.appendChild(this.controlTextEl_),this.controlText(this.controlText_,e),this.controlTextEl_},n.controlText=function(e,t){if(void 0===t&&(t=this.el()),void 0===e)return this.controlText_||"Need Text";var n=this.localize(e);this.controlText_=e,D(this.controlTextEl_,n),this.nonIconControl||t.setAttribute("title",n)},n.buildCSSClass=function(){return"vjs-control vjs-button "+e.prototype.buildCSSClass.call(this)},n.enable=function(){this.enabled_||(this.enabled_=!0,this.removeClass("vjs-disabled"),this.el_.setAttribute("aria-disabled","false"),void 0!==this.tabIndex_&&this.el_.setAttribute("tabIndex",this.tabIndex_),this.on(["tap","click"],this.handleClick),this.on("keydown",this.handleKeyDown))},n.disable=function(){this.enabled_=!1,this.addClass("vjs-disabled"),this.el_.setAttribute("aria-disabled","true"),void 0!==this.tabIndex_&&this.el_.removeAttribute("tabIndex"),this.off(["tap","click"],this.handleClick),this.off("keydown",this.handleKeyDown)},n.handleClick=function(e){},n.handleKeyDown=function(t){It.isEventKey(t,"Space")||It.isEventKey(t,"Enter")?(t.preventDefault(),t.stopPropagation(),this.trigger("click")):e.prototype.handleKeyDown.call(this,t)},t}(Be);Be.registerComponent("ClickableComponent",or);var sr=function(e){function t(t,n){var i;return(i=e.call(this,t,n)||this).update(),t.on("posterchange",Ee(o(i),i.update)),i}i(t,e);var n=t.prototype;return n.dispose=function(){this.player().off("posterchange",this.update),e.prototype.dispose.call(this)},n.createEl=function(){return O("div",{className:"vjs-poster",tabIndex:-1})},n.update=function(e){var t=this.player().poster();this.setSrc(t),t?this.show():this.hide()},n.setSrc=function(e){var t="";e&&(t='url("'+e+'")'),this.el_.style.backgroundImage=t},n.handleClick=function(e){this.player_.controls()&&(this.player_.tech(!0)&&this.player_.tech(!0).focus(),this.player_.paused()?Et(this.player_.play()):this.player_.pause())},t}(or);Be.registerComponent("PosterImage",sr);var lr={monospace:"monospace",sansSerif:"sans-serif",serif:"serif",monospaceSansSerif:'"Andale Mono", "Lucida Console", monospace',monospaceSerif:'"Courier New", monospace',proportionalSansSerif:"sans-serif",proportionalSerif:"serif",casual:'"Comic Sans MS", Impact, fantasy',script:'"Monotype Corsiva", cursive',smallcaps:'"Andale Mono", "Lucida Console", monospace, sans-serif'};function ur(e,t){var n;if(4===e.length)n=e[1]+e[1]+e[2]+e[2]+e[3]+e[3];else{if(7!==e.length)throw new Error("Invalid color code provided, "+e+"; must be formatted as e.g. #f0e or #f604e2.");n=e.slice(1)}return"rgba("+parseInt(n.slice(0,2),16)+","+parseInt(n.slice(2,4),16)+","+parseInt(n.slice(4,6),16)+","+t+")"}function cr(e,t,n){try{e.style[t]=n}catch(e){return}}var dr=function(t){function n(n,i,r){var a;a=t.call(this,n,i,r)||this;var s=Ee(o(a),a.updateDisplay);return n.on("loadstart",Ee(o(a),a.toggleDisplay)),n.on("texttrackchange",s),n.on("loadedmetadata",Ee(o(a),a.preselectTrack)),n.ready(Ee(o(a),function(){if(n.tech_&&n.tech_.featuresNativeTextTracks)this.hide();else{n.on("fullscreenchange",s),n.on("playerresize",s),e.addEventListener("orientationchange",s),n.on("dispose",function(){return e.removeEventListener("orientationchange",s)});for(var t=this.options_.playerOptions.tracks||[],i=0;i<t.length;i++)this.player_.addRemoteTextTrack(t[i],!0);this.preselectTrack()}})),a}i(n,t);var r=n.prototype;return r.preselectTrack=function(){for(var e,t,n,i={captions:1,subtitles:1},r=this.player_.textTracks(),a=this.player_.cache_.selectedLanguage,o=0;o<r.length;o++){var s=r[o];a&&a.enabled&&a.language&&a.language===s.language&&s.kind in i?s.kind===a.kind?n=s:n||(n=s):a&&!a.enabled?(n=null,e=null,t=null):s.default&&("descriptions"!==s.kind||e?s.kind in i&&!t&&(t=s):e=s)}n?n.mode="showing":t?t.mode="showing":e&&(e.mode="showing")},r.toggleDisplay=function(){this.player_.tech_&&this.player_.tech_.featuresNativeTextTracks?this.hide():this.show()},r.createEl=function(){return t.prototype.createEl.call(this,"div",{className:"vjs-text-track-display"},{"aria-live":"off","aria-atomic":"true"})},r.clearDisplay=function(){"function"==typeof e.WebVTT&&e.WebVTT.processCues(e,[],this.el_)},r.updateDisplay=function(){var e=this.player_.textTracks(),t=this.options_.allowMultipleShowingTracks;if(this.clearDisplay(),t){for(var n=[],i=0;i<e.length;++i){var r=e[i];"showing"===r.mode&&n.push(r)}this.updateForTrack(n)}else{for(var a=null,o=null,s=e.length;s--;){var l=e[s];"showing"===l.mode&&("descriptions"===l.kind?a=l:o=l)}o?("off"!==this.getAttribute("aria-live")&&this.setAttribute("aria-live","off"),this.updateForTrack(o)):a&&("assertive"!==this.getAttribute("aria-live")&&this.setAttribute("aria-live","assertive"),this.updateForTrack(a))}},r.updateDisplayState=function(t){for(var n=this.player_.textTrackSettings.getValues(),i=t.activeCues,r=i.length;r--;){var a=i[r];if(a){var o=a.displayState;if(n.color&&(o.firstChild.style.color=n.color),n.textOpacity&&cr(o.firstChild,"color",ur(n.color||"#fff",n.textOpacity)),n.backgroundColor&&(o.firstChild.style.backgroundColor=n.backgroundColor),n.backgroundOpacity&&cr(o.firstChild,"backgroundColor",ur(n.backgroundColor||"#000",n.backgroundOpacity)),n.windowColor&&(n.windowOpacity?cr(o,"backgroundColor",ur(n.windowColor,n.windowOpacity)):o.style.backgroundColor=n.windowColor),n.edgeStyle&&("dropshadow"===n.edgeStyle?o.firstChild.style.textShadow="2px 2px 3px #222, 2px 2px 4px #222, 2px 2px 5px #222":"raised"===n.edgeStyle?o.firstChild.style.textShadow="1px 1px #222, 2px 2px #222, 3px 3px #222":"depressed"===n.edgeStyle?o.firstChild.style.textShadow="1px 1px #ccc, 0 1px #ccc, -1px -1px #222, 0 -1px #222":"uniform"===n.edgeStyle&&(o.firstChild.style.textShadow="0 0 4px #222, 0 0 4px #222, 0 0 4px #222, 0 0 4px #222")),n.fontPercent&&1!==n.fontPercent){var s=e.parseFloat(o.style.fontSize);o.style.fontSize=s*n.fontPercent+"px",o.style.height="auto",o.style.top="auto",o.style.bottom="2px"}n.fontFamily&&"default"!==n.fontFamily&&("small-caps"===n.fontFamily?o.firstChild.style.fontVariant="small-caps":o.firstChild.style.fontFamily=lr[n.fontFamily])}}},r.updateForTrack=function(t){if(Array.isArray(t)||(t=[t]),"function"==typeof e.WebVTT&&!t.every(function(e){return!e.activeCues})){for(var n=[],i=0;i<t.length;++i)for(var r=t[i],a=0;a<r.activeCues.length;++a)n.push(r.activeCues[a]);e.WebVTT.processCues(e,n,this.el_);for(var o=0;o<t.length;++o){for(var s=t[o],l=0;l<s.activeCues.length;++l){var u=s.activeCues[l].displayState;A(u,"vjs-text-track-cue"),A(u,"vjs-text-track-cue-"+(s.language?s.language:o))}this.player_.textTrackSettings&&this.updateDisplayState(s)}}},n}(Be);Be.registerComponent("TextTrackDisplay",dr);var hr=function(e){function t(){return e.apply(this,arguments)||this}return i(t,e),t.prototype.createEl=function(){var t=this.player_.isAudio(),n=this.localize(t?"Audio Player":"Video Player"),i=O("span",{className:"vjs-control-text",innerHTML:this.localize("{1} is loading.",[n])}),r=e.prototype.createEl.call(this,"div",{className:"vjs-loading-spinner",dir:"ltr"});return r.appendChild(i),r},t}(Be);Be.registerComponent("LoadingSpinner",hr);var pr=function(e){function t(){return e.apply(this,arguments)||this}i(t,e);var n=t.prototype;return n.createEl=function(e,t,n){void 0===t&&(t={}),void 0===n&&(n={}),t=v({innerHTML:'<span aria-hidden="true" class="vjs-icon-placeholder"></span>',className:this.buildCSSClass()},t),n=v({type:"button"},n);var i=Be.prototype.createEl.call(this,"button",t,n);return this.createControlTextEl(i),i},n.addChild=function(e,t){void 0===t&&(t={});var n=this.constructor.name;return c.warn("Adding an actionable (user controllable) child to a Button ("+n+") is not supported; use a ClickableComponent instead."),Be.prototype.addChild.call(this,e,t)},n.enable=function(){e.prototype.enable.call(this),this.el_.removeAttribute("disabled")},n.disable=function(){e.prototype.disable.call(this),this.el_.setAttribute("disabled","disabled")},n.handleKeyDown=function(t){It.isEventKey(t,"Space")||It.isEventKey(t,"Enter")?t.stopPropagation():e.prototype.handleKeyDown.call(this,t)},t}(or);Be.registerComponent("Button",pr);var fr=function(e){function t(t,n){var i;return(i=e.call(this,t,n)||this).mouseused_=!1,i.on("mousedown",i.handleMouseDown),i}i(t,e);var n=t.prototype;return n.buildCSSClass=function(){return"vjs-big-play-button"},n.handleClick=function(e){var t=this.player_.play();if(this.mouseused_&&e.clientX&&e.clientY)return Et(t),void(this.player_.tech(!0)&&this.player_.tech(!0).focus());var n=this.player_.getChild("controlBar"),i=n&&n.getChild("playToggle");if(i){var r=function(){return i.focus()};Tt(t)?t.then(r,function(){}):this.setTimeout(r,1)}else this.player_.tech(!0).focus()},n.handleKeyDown=function(t){this.mouseused_=!1,e.prototype.handleKeyDown.call(this,t)},n.handleMouseDown=function(e){this.mouseused_=!0},t}(pr);fr.prototype.controlText_="Play Video",Be.registerComponent("BigPlayButton",fr);var gr=function(e){function t(t,n){var i;return(i=e.call(this,t,n)||this).controlText(n&&n.controlText||i.localize("Close")),i}i(t,e);var n=t.prototype;return n.buildCSSClass=function(){return"vjs-close-button "+e.prototype.buildCSSClass.call(this)},n.handleClick=function(e){this.trigger({type:"close",bubbles:!1})},n.handleKeyDown=function(t){It.isEventKey(t,"Esc")?(t.preventDefault(),t.stopPropagation(),this.trigger("click")):e.prototype.handleKeyDown.call(this,t)},t}(pr);Be.registerComponent("CloseButton",gr);var mr=function(e){function t(t,n){var i;return void 0===n&&(n={}),i=e.call(this,t,n)||this,n.replay=void 0===n.replay||n.replay,i.on(t,"play",i.handlePlay),i.on(t,"pause",i.handlePause),n.replay&&i.on(t,"ended",i.handleEnded),i}i(t,e);var n=t.prototype;return n.buildCSSClass=function(){return"vjs-play-control "+e.prototype.buildCSSClass.call(this)},n.handleClick=function(e){this.player_.paused()?this.player_.play():this.player_.pause()},n.handleSeeked=function(e){this.removeClass("vjs-ended"),this.player_.paused()?this.handlePause(e):this.handlePlay(e)},n.handlePlay=function(e){this.removeClass("vjs-ended"),this.removeClass("vjs-paused"),this.addClass("vjs-playing"),this.controlText("Pause")},n.handlePause=function(e){this.removeClass("vjs-playing"),this.addClass("vjs-paused"),this.controlText("Play")},n.handleEnded=function(e){this.removeClass("vjs-playing"),this.addClass("vjs-ended"),this.controlText("Replay"),this.one(this.player_,"seeked",this.handleSeeked)},t}(pr);mr.prototype.controlText_="Play",Be.registerComponent("PlayToggle",mr);var vr=function(e,t){e=e<0?0:e;var n=Math.floor(e%60),i=Math.floor(e/60%60),r=Math.floor(e/3600),a=Math.floor(t/60%60),o=Math.floor(t/3600);return(isNaN(e)||e===1/0)&&(r=i=n="-"),(r=r>0||o>0?r+":":"")+(i=((r||a>=10)&&i<10?"0"+i:i)+":")+(n<10?"0"+n:n)},yr=vr;function br(e,t){return void 0===t&&(t=e),yr(e,t)}var _r=function(e){function n(t,n){var i;return(i=e.call(this,t,n)||this).throttledUpdateContent=Ce(Ee(o(i),i.updateContent),Te),i.on(t,"timeupdate",i.throttledUpdateContent),i}i(n,e);var r=n.prototype;return r.createEl=function(){var t=this.buildCSSClass(),n=e.prototype.createEl.call(this,"div",{className:t+" vjs-time-control vjs-control",innerHTML:'<span class="vjs-control-text" role="presentation">'+this.localize(this.labelText_)+" </span>"});return this.contentEl_=O("span",{className:t+"-display"},{"aria-live":"off",role:"presentation"}),this.updateTextNode_(),n.appendChild(this.contentEl_),n},r.dispose=function(){this.contentEl_=null,this.textNode_=null,e.prototype.dispose.call(this)},r.updateTextNode_=function(){if(this.contentEl_){for(;this.contentEl_.firstChild;)this.contentEl_.removeChild(this.contentEl_.firstChild);this.textNode_=t.createTextNode(this.formattedTime_||this.formatTime_(0)),this.contentEl_.appendChild(this.textNode_)}},r.formatTime_=function(e){return br(e)},r.updateFormattedTime_=function(e){var t=this.formatTime_(e);t!==this.formattedTime_&&(this.formattedTime_=t,this.requestAnimationFrame(this.updateTextNode_))},r.updateContent=function(e){},n}(Be);_r.prototype.labelText_="Time",_r.prototype.controlText_="Time",Be.registerComponent("TimeDisplay",_r);var Tr=function(e){function t(t,n){var i;return(i=e.call(this,t,n)||this).on(t,"ended",i.handleEnded),i}i(t,e);var n=t.prototype;return n.buildCSSClass=function(){return"vjs-current-time"},n.updateContent=function(e){var t=this.player_.scrubbing()?this.player_.getCache().currentTime:this.player_.currentTime();this.updateFormattedTime_(t)},n.handleEnded=function(e){this.player_.duration()&&this.updateFormattedTime_(this.player_.duration())},t}(_r);Tr.prototype.labelText_="Current Time",Tr.prototype.controlText_="Current Time",Be.registerComponent("CurrentTimeDisplay",Tr);var Er=function(e){function t(t,n){var i;return(i=e.call(this,t,n)||this).on(t,"durationchange",i.updateContent),i.on(t,"loadstart",i.updateContent),i.on(t,"loadedmetadata",i.throttledUpdateContent),i}i(t,e);var n=t.prototype;return n.buildCSSClass=function(){return"vjs-duration"},n.updateContent=function(e){var t=this.player_.duration();this.duration_!==t&&(this.duration_=t,this.updateFormattedTime_(t))},t}(_r);Er.prototype.labelText_="Duration",Er.prototype.controlText_="Duration",Be.registerComponent("DurationDisplay",Er);var Cr=function(e){function t(){return e.apply(this,arguments)||this}return i(t,e),t.prototype.createEl=function(){return e.prototype.createEl.call(this,"div",{className:"vjs-time-control vjs-time-divider",innerHTML:"<div><span>/</span></div>"},{"aria-hidden":!0})},t}(Be);Be.registerComponent("TimeDivider",Cr);var wr=function(e){function t(t,n){var i;return(i=e.call(this,t,n)||this).on(t,"durationchange",i.throttledUpdateContent),i.on(t,"ended",i.handleEnded),i}i(t,e);var n=t.prototype;return n.buildCSSClass=function(){return"vjs-remaining-time"},n.createEl=function(){var t=e.prototype.createEl.call(this);return t.insertBefore(O("span",{},{"aria-hidden":!0},"-"),this.contentEl_),t},n.updateContent=function(e){"number"==typeof this.player_.duration()&&(this.player_.remainingTimeDisplay?this.updateFormattedTime_(this.player_.remainingTimeDisplay()):this.updateFormattedTime_(this.player_.remainingTime()))},n.handleEnded=function(e){this.player_.duration()&&this.updateFormattedTime_(0)},t}(_r);wr.prototype.labelText_="Remaining Time",wr.prototype.controlText_="Remaining Time",Be.registerComponent("RemainingTimeDisplay",wr);var kr=function(e){function t(t,n){var i;return(i=e.call(this,t,n)||this).updateShowing(),i.on(i.player(),"durationchange",i.updateShowing),i}i(t,e);var n=t.prototype;return n.createEl=function(){var t=e.prototype.createEl.call(this,"div",{className:"vjs-live-control vjs-control"});return this.contentEl_=O("div",{className:"vjs-live-display",innerHTML:'<span class="vjs-control-text">'+this.localize("Stream Type")+" </span>"+this.localize("LIVE")},{"aria-live":"off"}),t.appendChild(this.contentEl_),t},n.dispose=function(){this.contentEl_=null,e.prototype.dispose.call(this)},n.updateShowing=function(e){this.player().duration()===1/0?this.show():this.hide()},t}(Be);Be.registerComponent("LiveDisplay",kr);var Sr=function(e){function t(t,n){var i;return(i=e.call(this,t,n)||this).updateLiveEdgeStatus(),i.player_.liveTracker&&i.on(i.player_.liveTracker,"liveedgechange",i.updateLiveEdgeStatus),i}i(t,e);var n=t.prototype;return n.createEl=function(){var t=e.prototype.createEl.call(this,"button",{className:"vjs-seek-to-live-control vjs-control"});return this.textEl_=O("span",{className:"vjs-seek-to-live-text",innerHTML:this.localize("LIVE")},{"aria-hidden":"true"}),t.appendChild(this.textEl_),t},n.updateLiveEdgeStatus=function(e){!this.player_.liveTracker||this.player_.liveTracker.atLiveEdge()?(this.setAttribute("aria-disabled",!0),this.addClass("vjs-at-live-edge"),this.controlText("Seek to live, currently playing live")):(this.setAttribute("aria-disabled",!1),this.removeClass("vjs-at-live-edge"),this.controlText("Seek to live, currently behind live"))},n.handleClick=function(){this.player_.liveTracker.seekToLiveEdge()},n.dispose=function(){this.player_.liveTracker&&this.off(this.player_.liveTracker,"liveedgechange",this.updateLiveEdgeStatus),this.textEl_=null,e.prototype.dispose.call(this)},t}(pr);Sr.prototype.controlText_="Seek to live, currently playing live",Be.registerComponent("SeekToLive",Sr);var Ir=function(e){function t(t,n){var i;return(i=e.call(this,t,n)||this).bar=i.getChild(i.options_.barName),i.vertical(!!i.options_.vertical),i.enable(),i}i(t,e);var n=t.prototype;return n.enabled=function(){return this.enabled_},n.enable=function(){this.enabled()||(this.on("mousedown",this.handleMouseDown),this.on("touchstart",this.handleMouseDown),this.on("keydown",this.handleKeyDown),this.on("click",this.handleClick),this.on(this.player_,"controlsvisible",this.update),this.playerEvent&&this.on(this.player_,this.playerEvent,this.update),this.removeClass("disabled"),this.setAttribute("tabindex",0),this.enabled_=!0)},n.disable=function(){if(this.enabled()){var e=this.bar.el_.ownerDocument;this.off("mousedown",this.handleMouseDown),this.off("touchstart",this.handleMouseDown),this.off("keydown",this.handleKeyDown),this.off("click",this.handleClick),this.off(this.player_,"controlsvisible",this.update),this.off(e,"mousemove",this.handleMouseMove),this.off(e,"mouseup",this.handleMouseUp),this.off(e,"touchmove",this.handleMouseMove),this.off(e,"touchend",this.handleMouseUp),this.removeAttribute("tabindex"),this.addClass("disabled"),this.playerEvent&&this.off(this.player_,this.playerEvent,this.update),this.enabled_=!1}},n.createEl=function(t,n,i){return void 0===n&&(n={}),void 0===i&&(i={}),n.className=n.className+" vjs-slider",n=v({tabIndex:0},n),i=v({role:"slider","aria-valuenow":0,"aria-valuemin":0,"aria-valuemax":100,tabIndex:0},i),e.prototype.createEl.call(this,t,n,i)},n.handleMouseDown=function(e){var t=this.bar.el_.ownerDocument;"mousedown"===e.type&&e.preventDefault(),"touchstart"!==e.type||tt||e.preventDefault(),B(),this.addClass("vjs-sliding"),this.trigger("slideractive"),this.on(t,"mousemove",this.handleMouseMove),this.on(t,"mouseup",this.handleMouseUp),this.on(t,"touchmove",this.handleMouseMove),this.on(t,"touchend",this.handleMouseUp),this.handleMouseMove(e)},n.handleMouseMove=function(e){},n.handleMouseUp=function(){var e=this.bar.el_.ownerDocument;F(),this.removeClass("vjs-sliding"),this.trigger("sliderinactive"),this.off(e,"mousemove",this.handleMouseMove),this.off(e,"mouseup",this.handleMouseUp),this.off(e,"touchmove",this.handleMouseMove),this.off(e,"touchend",this.handleMouseUp),this.update()},n.update=function(){if(this.el_){var e=this.getPercent(),t=this.bar;if(t){("number"!=typeof e||e!=e||e<0||e===1/0)&&(e=0);var n=(100*e).toFixed(2)+"%",i=t.el().style,r=this.vertical()?"height":"width";return i[r]!==n&&(i[r]=n),e}}},n.calculateDistance=function(e){var t=q(this.el_,e);return this.vertical()?t.y:t.x},n.handleKeyDown=function(t){It.isEventKey(t,"Left")||It.isEventKey(t,"Down")?(t.preventDefault(),t.stopPropagation(),this.stepBack()):It.isEventKey(t,"Right")||It.isEventKey(t,"Up")?(t.preventDefault(),t.stopPropagation(),this.stepForward()):e.prototype.handleKeyDown.call(this,t)},n.handleClick=function(e){e.stopPropagation(),e.preventDefault()},n.vertical=function(e){if(void 0===e)return this.vertical_||!1;this.vertical_=!!e,this.vertical_?this.addClass("vjs-slider-vertical"):this.addClass("vjs-slider-horizontal")},t}(Be);Be.registerComponent("Slider",Ir);var Or=function(e){function t(t,n){var i;return(i=e.call(this,t,n)||this).partEls_=[],i.on(t,"progress",i.update),i}i(t,e);var n=t.prototype;return n.createEl=function(){return e.prototype.createEl.call(this,"div",{className:"vjs-load-progress",innerHTML:'<span class="vjs-control-text"><span>'+this.localize("Loaded")+'</span>: <span class="vjs-control-text-loaded-percentage">0%</span></span>'})},n.dispose=function(){this.partEls_=null,e.prototype.dispose.call(this)},n.update=function(e){var t=this.player_.liveTracker,n=this.player_.buffered(),i=t&&t.isLive()?t.seekableEnd():this.player_.duration(),r=this.player_.bufferedEnd(),a=this.partEls_,o=this.$(".vjs-control-text-loaded-percentage"),s=function(e,t,n){var i=e/t||0;return i=100*(i>=1?1:i),n&&(i=i.toFixed(2)),i+"%"};this.el_.style.width=s(r,i),D(o,s(r,i,!0));for(var l=0;l<n.length;l++){var u=n.start(l),c=n.end(l),d=a[l];d||(d=this.el_.appendChild(O()),a[l]=d),d.style.left=s(u,r),d.style.width=s(c-u,r)}for(var h=a.length;h>n.length;h--)this.el_.removeChild(a[h-1]);a.length=n.length},t}(Be);Be.registerComponent("LoadProgressBar",Or);var Dr=function(e){function t(t,n){var i;return(i=e.call(this,t,n)||this).update=Ce(Ee(o(i),i.update),Te),i}i(t,e);var n=t.prototype;return n.createEl=function(){return e.prototype.createEl.call(this,"div",{className:"vjs-time-tooltip"},{"aria-hidden":"true"})},n.update=function(e,t,n){var i=U(this.el_),r=U(this.player_.el()),a=e.width*t;if(r&&i){var o=e.left-r.left+a,s=e.width-a+(r.right-e.right),l=i.width/2;o<l?l+=l-o:s<l&&(l=s),l<0?l=0:l>i.width&&(l=i.width),this.el_.style.right="-"+l+"px",this.write(n)}},n.write=function(e){D(this.el_,e)},n.updateTime=function(e,t,n,i){var r=this;this.rafId_&&this.cancelAnimationFrame(this.rafId_),this.rafId_=this.requestAnimationFrame(function(){var a,o=r.player_.duration();if(r.player_.liveTracker&&r.player_.liveTracker.isLive()){var s=r.player_.liveTracker.liveWindow(),l=s-t*s;a=(l<1?"":"-")+br(l,s)}else a=br(n,o);r.update(e,t,a),i&&i()})},t}(Be);Be.registerComponent("TimeTooltip",Dr);var Rr=function(e){function t(t,n){var i;return(i=e.call(this,t,n)||this).update=Ce(Ee(o(i),i.update),Te),i}i(t,e);var n=t.prototype;return n.createEl=function(){return e.prototype.createEl.call(this,"div",{className:"vjs-play-progress vjs-slider-bar"},{"aria-hidden":"true"})},n.update=function(e,t){var n=this.getChild("timeTooltip");if(n){var i=this.player_.scrubbing()?this.player_.getCache().currentTime:this.player_.currentTime();n.updateTime(e,t,i)}},t}(Be);Rr.prototype.options_={children:[]},Ge||Ye||Rr.prototype.options_.children.push("timeTooltip"),Be.registerComponent("PlayProgressBar",Rr);var xr=function(e){function t(t,n){var i;return(i=e.call(this,t,n)||this).update=Ce(Ee(o(i),i.update),Te),i}i(t,e);var n=t.prototype;return n.createEl=function(){return e.prototype.createEl.call(this,"div",{className:"vjs-mouse-display"})},n.update=function(e,t){var n=this,i=t*this.player_.duration();this.getChild("timeTooltip").updateTime(e,t,i,function(){n.el_.style.left=e.width*t+"px"})},t}(Be);xr.prototype.options_={children:["timeTooltip"]},Be.registerComponent("MouseTimeDisplay",xr);var Ar=function(e){function n(t,n){var i;return(i=e.call(this,t,n)||this).setEventHandlers_(),i}i(n,e);var r=n.prototype;return r.setEventHandlers_=function(){this.update=Ce(Ee(this,this.update),30),this.on(this.player_,"timeupdate",this.update),this.on(this.player_,"ended",this.handleEnded),this.on(this.player_,"durationchange",this.update),this.player_.liveTracker&&this.on(this.player_.liveTracker,"liveedgechange",this.update),this.updateInterval=null,this.on(this.player_,["playing"],this.enableInterval_),this.on(this.player_,["ended","pause","waiting"],this.disableInterval_),"hidden"in t&&"visibilityState"in t&&this.on(t,"visibilitychange",this.toggleVisibility_)},r.toggleVisibility_=function(e){t.hidden?this.disableInterval_(e):(this.enableInterval_(),this.requestAnimationFrame(this.update))},r.enableInterval_=function(){var e=this;this.clearInterval(this.updateInterval),this.updateInterval=this.setInterval(function(){e.requestAnimationFrame(e.update)},30)},r.disableInterval_=function(e){this.player_.liveTracker&&this.player_.liveTracker.isLive()&&"ended"!==e.type||this.clearInterval(this.updateInterval)},r.createEl=function(){return e.prototype.createEl.call(this,"div",{className:"vjs-progress-holder"},{"aria-label":this.localize("Progress Bar")})},r.update_=function(e,t){var n=this.player_.liveTracker,i=this.player_.duration();n&&n.isLive()&&(i=this.player_.liveTracker.liveCurrentTime()),this.el_.setAttribute("aria-valuenow",(100*t).toFixed(2)),this.el_.setAttribute("aria-valuetext",this.localize("progress bar timing: currentTime={1} duration={2}",[br(e,i),br(i,i)],"{1} of {2}")),this.bar&&this.bar.update(U(this.el_),t)},r.update=function(t){if(null!==this.el().offsetParent){var n=e.prototype.update.call(this);return this.update_(this.getCurrentTime_(),n),n}},r.getCurrentTime_=function(){return this.player_.scrubbing()?this.player_.getCache().currentTime:this.player_.currentTime()},r.handleEnded=function(e){this.update_(this.player_.duration(),1)},r.getPercent=function(){var e,t=this.getCurrentTime_(),n=this.player_.liveTracker;return n&&n.isLive()?(e=(t-n.seekableStart())/n.liveWindow(),n.atLiveEdge()&&(e=1)):e=t/this.player_.duration(),e>=1?1:e||0},r.handleMouseDown=function(t){Y(t)&&(t.stopPropagation(),this.player_.scrubbing(!0),this.videoWasPlaying=!this.player_.paused(),this.player_.pause(),e.prototype.handleMouseDown.call(this,t))},r.handleMouseMove=function(e){if(Y(e)){var t,n=this.calculateDistance(e),i=this.player_.liveTracker;if(i&&i.isLive()){var r=i.seekableStart(),a=i.liveCurrentTime();if((t=r+n*i.liveWindow())>=a&&(t=a),t<=r&&(t=r+.1),t===1/0)return}else(t=n*this.player_.duration())===this.player_.duration()&&(t-=.1);this.player_.currentTime(t)}},r.enable=function(){e.prototype.enable.call(this);var t=this.getChild("mouseTimeDisplay");t&&t.show()},r.disable=function(){e.prototype.disable.call(this);var t=this.getChild("mouseTimeDisplay");t&&t.hide()},r.handleMouseUp=function(t){e.prototype.handleMouseUp.call(this,t),t&&t.stopPropagation(),this.player_.scrubbing(!1),this.player_.trigger({type:"timeupdate",target:this,manuallyTriggered:!0}),this.videoWasPlaying&&Et(this.player_.play())},r.stepForward=function(){this.player_.currentTime(this.player_.currentTime()+5)},r.stepBack=function(){this.player_.currentTime(this.player_.currentTime()-5)},r.handleAction=function(e){this.player_.paused()?this.player_.play():this.player_.pause()},r.handleKeyDown=function(t){if(It.isEventKey(t,"Space")||It.isEventKey(t,"Enter"))t.preventDefault(),t.stopPropagation(),this.handleAction(t);else if(It.isEventKey(t,"Home"))t.preventDefault(),t.stopPropagation(),this.player_.currentTime(0);else if(It.isEventKey(t,"End"))t.preventDefault(),t.stopPropagation(),this.player_.currentTime(this.player_.duration());else if(/^[0-9]$/.test(It(t))){t.preventDefault(),t.stopPropagation();var n=10*(It.codes[It(t)]-It.codes[0])/100;this.player_.currentTime(this.player_.duration()*n)}else It.isEventKey(t,"PgDn")?(t.preventDefault(),t.stopPropagation(),this.player_.currentTime(this.player_.currentTime()-60)):It.isEventKey(t,"PgUp")?(t.preventDefault(),t.stopPropagation(),this.player_.currentTime(this.player_.currentTime()+60)):e.prototype.handleKeyDown.call(this,t)},n}(Ir);Ar.prototype.options_={children:["loadProgressBar","playProgressBar"],barName:"playProgressBar"},Ge||Ye||Ar.prototype.options_.children.splice(1,0,"mouseTimeDisplay"),Be.registerComponent("SeekBar",Ar);var Pr=function(e){function t(t,n){var i;return(i=e.call(this,t,n)||this).handleMouseMove=Ce(Ee(o(i),i.handleMouseMove),Te),i.throttledHandleMouseSeek=Ce(Ee(o(i),i.handleMouseSeek),Te),i.enable(),i}i(t,e);var n=t.prototype;return n.createEl=function(){return e.prototype.createEl.call(this,"div",{className:"vjs-progress-control vjs-control"})},n.handleMouseMove=function(e){var t=this.getChild("seekBar");if(t){var n=t.getChild("mouseTimeDisplay"),i=t.el(),r=U(i),a=q(i,e).x;a>1?a=1:a<0&&(a=0),n&&n.update(r,a)}},n.handleMouseSeek=function(e){var t=this.getChild("seekBar");t&&t.handleMouseMove(e)},n.enabled=function(){return this.enabled_},n.disable=function(){this.children().forEach(function(e){return e.disable&&e.disable()}),this.enabled()&&(this.off(["mousedown","touchstart"],this.handleMouseDown),this.off(this.el_,"mousemove",this.handleMouseMove),this.handleMouseUp(),this.addClass("disabled"),this.enabled_=!1)},n.enable=function(){this.children().forEach(function(e){return e.enable&&e.enable()}),this.enabled()||(this.on(["mousedown","touchstart"],this.handleMouseDown),this.on(this.el_,"mousemove",this.handleMouseMove),this.removeClass("disabled"),this.enabled_=!0)},n.handleMouseDown=function(e){var t=this.el_.ownerDocument,n=this.getChild("seekBar");n&&n.handleMouseDown(e),this.on(t,"mousemove",this.throttledHandleMouseSeek),this.on(t,"touchmove",this.throttledHandleMouseSeek),this.on(t,"mouseup",this.handleMouseUp),this.on(t,"touchend",this.handleMouseUp)},n.handleMouseUp=function(e){var t=this.el_.ownerDocument,n=this.getChild("seekBar");n&&n.handleMouseUp(e),this.off(t,"mousemove",this.throttledHandleMouseSeek),this.off(t,"touchmove",this.throttledHandleMouseSeek),this.off(t,"mouseup",this.handleMouseUp),this.off(t,"touchend",this.handleMouseUp)},t}(Be);Pr.prototype.options_={children:["seekBar"]},Be.registerComponent("ProgressControl",Pr);var Lr=function(e){function n(n,i){var r;return(r=e.call(this,n,i)||this).on(n,["enterpictureinpicture","leavepictureinpicture"],r.handlePictureInPictureChange),t.pictureInPictureEnabled||r.disable(),r}i(n,e);var r=n.prototype;return r.buildCSSClass=function(){return"vjs-picture-in-picture-control "+e.prototype.buildCSSClass.call(this)},r.handlePictureInPictureChange=function(e){this.player_.isInPictureInPicture()?this.controlText("Exit Picture-in-Picture"):this.controlText("Picture-in-Picture")},r.handleClick=function(e){this.player_.isInPictureInPicture()?this.player_.exitPictureInPicture():this.player_.requestPictureInPicture()},n}(pr);Lr.prototype.controlText_="Picture-in-Picture",Be.registerComponent("PictureInPictureToggle",Lr);var Nr=function(e){function n(n,i){var r;return(r=e.call(this,n,i)||this).on(n,"fullscreenchange",r.handleFullscreenChange),!1===t[n.fsApi_.fullscreenEnabled]&&r.disable(),r}i(n,e);var r=n.prototype;return r.buildCSSClass=function(){return"vjs-fullscreen-control "+e.prototype.buildCSSClass.call(this)},r.handleFullscreenChange=function(e){this.player_.isFullscreen()?this.controlText("Non-Fullscreen"):this.controlText("Fullscreen")},r.handleClick=function(e){this.player_.isFullscreen()?this.player_.exitFullscreen():this.player_.requestFullscreen()},n}(pr);Nr.prototype.controlText_="Fullscreen",Be.registerComponent("FullscreenToggle",Nr);var Mr=function(e,t){t.tech_&&!t.tech_.featuresVolumeControl&&e.addClass("vjs-hidden"),e.on(t,"loadstart",function(){t.tech_.featuresVolumeControl?e.removeClass("vjs-hidden"):e.addClass("vjs-hidden")})},Kr=function(e){function t(){return e.apply(this,arguments)||this}return i(t,e),t.prototype.createEl=function(){return e.prototype.createEl.call(this,"div",{className:"vjs-volume-level",innerHTML:'<span class="vjs-control-text"></span>'})},t}(Be);Be.registerComponent("VolumeLevel",Kr);var $r=function(e){function t(t,n){var i;return(i=e.call(this,t,n)||this).on("slideractive",i.updateLastVolume_),i.on(t,"volumechange",i.updateARIAAttributes),t.ready(function(){return i.updateARIAAttributes()}),i}i(t,e);var n=t.prototype;return n.createEl=function(){return e.prototype.createEl.call(this,"div",{className:"vjs-volume-bar vjs-slider-bar"},{"aria-label":this.localize("Volume Level"),"aria-live":"polite"})},n.handleMouseDown=function(t){Y(t)&&e.prototype.handleMouseDown.call(this,t)},n.handleMouseMove=function(e){Y(e)&&(this.checkMuted(),this.player_.volume(this.calculateDistance(e)))},n.checkMuted=function(){this.player_.muted()&&this.player_.muted(!1)},n.getPercent=function(){return this.player_.muted()?0:this.player_.volume()},n.stepForward=function(){this.checkMuted(),this.player_.volume(this.player_.volume()+.1)},n.stepBack=function(){this.checkMuted(),this.player_.volume(this.player_.volume()-.1)},n.updateARIAAttributes=function(e){var t=this.player_.muted()?0:this.volumeAsPercentage_();this.el_.setAttribute("aria-valuenow",t),this.el_.setAttribute("aria-valuetext",t+"%")},n.volumeAsPercentage_=function(){return Math.round(100*this.player_.volume())},n.updateLastVolume_=function(){var e=this,t=this.player_.volume();this.one("sliderinactive",function(){0===e.player_.volume()&&e.player_.lastVolume_(t)})},t}(Ir);$r.prototype.options_={children:["volumeLevel"],barName:"volumeLevel"},$r.prototype.playerEvent="volumechange",Be.registerComponent("VolumeBar",$r);var jr=function(e){function t(t,n){var i;return void 0===n&&(n={}),n.vertical=n.vertical||!1,(void 0===n.volumeBar||b(n.volumeBar))&&(n.volumeBar=n.volumeBar||{},n.volumeBar.vertical=n.vertical),i=e.call(this,t,n)||this,Mr(o(i),t),i.throttledHandleMouseMove=Ce(Ee(o(i),i.handleMouseMove),Te),i.on("mousedown",i.handleMouseDown),i.on("touchstart",i.handleMouseDown),i.on(i.volumeBar,["focus","slideractive"],function(){i.volumeBar.addClass("vjs-slider-active"),i.addClass("vjs-slider-active"),i.trigger("slideractive")}),i.on(i.volumeBar,["blur","sliderinactive"],function(){i.volumeBar.removeClass("vjs-slider-active"),i.removeClass("vjs-slider-active"),i.trigger("sliderinactive")}),i}i(t,e);var n=t.prototype;return n.createEl=function(){var t="vjs-volume-horizontal";return this.options_.vertical&&(t="vjs-volume-vertical"),e.prototype.createEl.call(this,"div",{className:"vjs-volume-control vjs-control "+t})},n.handleMouseDown=function(e){var t=this.el_.ownerDocument;this.on(t,"mousemove",this.throttledHandleMouseMove),this.on(t,"touchmove",this.throttledHandleMouseMove),this.on(t,"mouseup",this.handleMouseUp),this.on(t,"touchend",this.handleMouseUp)},n.handleMouseUp=function(e){var t=this.el_.ownerDocument;this.off(t,"mousemove",this.throttledHandleMouseMove),this.off(t,"touchmove",this.throttledHandleMouseMove),this.off(t,"mouseup",this.handleMouseUp),this.off(t,"touchend",this.handleMouseUp)},n.handleMouseMove=function(e){this.volumeBar.handleMouseMove(e)},t}(Be);jr.prototype.options_={children:["volumeBar"]},Be.registerComponent("VolumeControl",jr);var Br=function(e,t){t.tech_&&!t.tech_.featuresMuteControl&&e.addClass("vjs-hidden"),e.on(t,"loadstart",function(){t.tech_.featuresMuteControl?e.removeClass("vjs-hidden"):e.addClass("vjs-hidden")})},Fr=function(e){function t(t,n){var i;return i=e.call(this,t,n)||this,Br(o(i),t),i.on(t,["loadstart","volumechange"],i.update),i}i(t,e);var n=t.prototype;return n.buildCSSClass=function(){return"vjs-mute-control "+e.prototype.buildCSSClass.call(this)},n.handleClick=function(e){var t=this.player_.volume(),n=this.player_.lastVolume_();if(0===t){var i=n<.1?.1:n;this.player_.volume(i),this.player_.muted(!1)}else this.player_.muted(!this.player_.muted())},n.update=function(e){this.updateIcon_(),this.updateControlText_()},n.updateIcon_=function(){var e=this.player_.volume(),t=3;Ge&&this.player_.tech_&&this.player_.tech_.el_&&this.player_.muted(this.player_.tech_.el_.muted),0===e||this.player_.muted()?t=0:e<.33?t=1:e<.67&&(t=2);for(var n=0;n<4;n++)P(this.el_,"vjs-vol-"+n);A(this.el_,"vjs-vol-"+t)},n.updateControlText_=function(){var e=this.player_.muted()||0===this.player_.volume()?"Unmute":"Mute";this.controlText()!==e&&this.controlText(e)},t}(pr);Fr.prototype.controlText_="Mute",Be.registerComponent("MuteToggle",Fr);var Ur=function(e){function t(t,n){var i;return void 0===n&&(n={}),void 0!==n.inline?n.inline=n.inline:n.inline=!0,(void 0===n.volumeControl||b(n.volumeControl))&&(n.volumeControl=n.volumeControl||{},n.volumeControl.vertical=!n.inline),(i=e.call(this,t,n)||this).on(t,["loadstart"],i.volumePanelState_),i.on(i.volumeControl,["slideractive"],i.sliderActive_),i.on(i.volumeControl,["sliderinactive"],i.sliderInactive_),i}i(t,e);var n=t.prototype;return n.sliderActive_=function(){this.addClass("vjs-slider-active")},n.sliderInactive_=function(){this.removeClass("vjs-slider-active")},n.volumePanelState_=function(){this.volumeControl.hasClass("vjs-hidden")&&this.muteToggle.hasClass("vjs-hidden")&&this.addClass("vjs-hidden"),this.volumeControl.hasClass("vjs-hidden")&&!this.muteToggle.hasClass("vjs-hidden")&&this.addClass("vjs-mute-toggle-only")},n.createEl=function(){var t="vjs-volume-panel-horizontal";return this.options_.inline||(t="vjs-volume-panel-vertical"),e.prototype.createEl.call(this,"div",{className:"vjs-volume-panel vjs-control "+t})},t}(Be);Ur.prototype.options_={children:["muteToggle","volumeControl"]},Be.registerComponent("VolumePanel",Ur);var Vr=function(e){function n(t,n){var i;return i=e.call(this,t,n)||this,n&&(i.menuButton_=n.menuButton),i.focusedChild_=-1,i.on("keydown",i.handleKeyDown),i.boundHandleBlur_=Ee(o(i),i.handleBlur),i.boundHandleTapClick_=Ee(o(i),i.handleTapClick),i}i(n,e);var r=n.prototype;return r.addEventListenerForItem=function(e){e instanceof Be&&(this.on(e,"blur",this.boundHandleBlur_),this.on(e,["tap","click"],this.boundHandleTapClick_))},r.removeEventListenerForItem=function(e){e instanceof Be&&(this.off(e,"blur",this.boundHandleBlur_),this.off(e,["tap","click"],this.boundHandleTapClick_))},r.removeChild=function(t){"string"==typeof t&&(t=this.getChild(t)),this.removeEventListenerForItem(t),e.prototype.removeChild.call(this,t)},r.addItem=function(e){var t=this.addChild(e);t&&this.addEventListenerForItem(t)},r.createEl=function(){var t=this.options_.contentElType||"ul";this.contentEl_=O(t,{className:"vjs-menu-content"}),this.contentEl_.setAttribute("role","menu");var n=e.prototype.createEl.call(this,"div",{append:this.contentEl_,className:"vjs-menu"});return n.appendChild(this.contentEl_),le(n,"click",function(e){e.preventDefault(),e.stopImmediatePropagation()}),n},r.dispose=function(){this.contentEl_=null,this.boundHandleBlur_=null,this.boundHandleTapClick_=null,e.prototype.dispose.call(this)},r.handleBlur=function(e){var n=e.relatedTarget||t.activeElement;if(!this.children().some(function(e){return e.el()===n})){var i=this.menuButton_;i&&i.buttonPressed_&&n!==i.el().firstChild&&i.unpressButton()}},r.handleTapClick=function(e){if(this.menuButton_){this.menuButton_.unpressButton();var t=this.children();if(!Array.isArray(t))return;var n=t.filter(function(t){return t.el()===e.target})[0];if(!n)return;"CaptionSettingsMenuItem"!==n.name()&&this.menuButton_.focus()}},r.handleKeyDown=function(e){It.isEventKey(e,"Left")||It.isEventKey(e,"Down")?(e.preventDefault(),e.stopPropagation(),this.stepForward()):(It.isEventKey(e,"Right")||It.isEventKey(e,"Up"))&&(e.preventDefault(),e.stopPropagation(),this.stepBack())},r.stepForward=function(){var e=0;void 0!==this.focusedChild_&&(e=this.focusedChild_+1),this.focus(e)},r.stepBack=function(){var e=0;void 0!==this.focusedChild_&&(e=this.focusedChild_-1),this.focus(e)},r.focus=function(e){void 0===e&&(e=0);var t=this.children().slice();t.length&&t[0].className&&/vjs-menu-title/.test(t[0].className)&&t.shift(),t.length>0&&(e<0?e=0:e>=t.length&&(e=t.length-1),this.focusedChild_=e,t[e].el_.focus())},n}(Be);Be.registerComponent("Menu",Vr);var qr=function(e){function t(t,n){var i;void 0===n&&(n={}),(i=e.call(this,t,n)||this).menuButton_=new pr(t,n),i.menuButton_.controlText(i.controlText_),i.menuButton_.el_.setAttribute("aria-haspopup","true");var r=pr.prototype.buildCSSClass();return i.menuButton_.el_.className=i.buildCSSClass()+" "+r,i.menuButton_.removeClass("vjs-control"),i.addChild(i.menuButton_),i.update(),i.enabled_=!0,i.on(i.menuButton_,"tap",i.handleClick),i.on(i.menuButton_,"click",i.handleClick),i.on(i.menuButton_,"keydown",i.handleKeyDown),i.on(i.menuButton_,"mouseenter",function(){i.menu.show()}),i.on("keydown",i.handleSubmenuKeyDown),i}i(t,e);var n=t.prototype;return n.update=function(){var e=this.createMenu();this.menu&&(this.menu.dispose(),this.removeChild(this.menu)),this.menu=e,this.addChild(e),this.buttonPressed_=!1,this.menuButton_.el_.setAttribute("aria-expanded","false"),this.items&&this.items.length<=this.hideThreshold_?this.hide():this.show()},n.createMenu=function(){var e=new Vr(this.player_,{menuButton:this});if(this.hideThreshold_=0,this.options_.title){var t=O("li",{className:"vjs-menu-title",innerHTML:$e(this.options_.title),tabIndex:-1});this.hideThreshold_+=1;var n=new Be(this.player_,{el:t});e.addItem(n)}if(this.items=this.createItems(),this.items)for(var i=0;i<this.items.length;i++)e.addItem(this.items[i]);return e},n.createItems=function(){},n.createEl=function(){return e.prototype.createEl.call(this,"div",{className:this.buildWrapperCSSClass()},{})},n.buildWrapperCSSClass=function(){var t="vjs-menu-button";return!0===this.options_.inline?t+="-inline":t+="-popup","vjs-menu-button "+t+" "+pr.prototype.buildCSSClass()+" "+e.prototype.buildCSSClass.call(this)},n.buildCSSClass=function(){var t="vjs-menu-button";return!0===this.options_.inline?t+="-inline":t+="-popup","vjs-menu-button "+t+" "+e.prototype.buildCSSClass.call(this)},n.controlText=function(e,t){return void 0===t&&(t=this.menuButton_.el()),this.menuButton_.controlText(e,t)},n.handleClick=function(e){this.buttonPressed_?this.unpressButton():this.pressButton()},n.focus=function(){this.menuButton_.focus()},n.blur=function(){this.menuButton_.blur()},n.handleKeyDown=function(e){It.isEventKey(e,"Esc")||It.isEventKey(e,"Tab")?(this.buttonPressed_&&this.unpressButton(),It.isEventKey(e,"Tab")||(e.preventDefault(),this.menuButton_.focus())):(It.isEventKey(e,"Up")||It.isEventKey(e,"Down"))&&(this.buttonPressed_||(e.preventDefault(),this.pressButton()))},n.handleSubmenuKeyPress=function(e){this.handleSubmenuKeyDown(e)},n.handleSubmenuKeyDown=function(e){(It.isEventKey(e,"Esc")||It.isEventKey(e,"Tab"))&&(this.buttonPressed_&&this.unpressButton(),It.isEventKey(e,"Tab")||(e.preventDefault(),this.menuButton_.focus()))},n.pressButton=function(){if(this.enabled_){if(this.buttonPressed_=!0,this.menu.show(),this.menu.lockShowing(),this.menuButton_.el_.setAttribute("aria-expanded","true"),Ge&&S())return;this.menu.focus()}},n.unpressButton=function(){this.enabled_&&(this.buttonPressed_=!1,this.menu.unlockShowing(),this.menu.hide(),this.menuButton_.el_.setAttribute("aria-expanded","false"))},n.disable=function(){this.unpressButton(),this.enabled_=!1,this.addClass("vjs-disabled"),this.menuButton_.disable()},n.enable=function(){this.enabled_=!0,this.removeClass("vjs-disabled"),this.menuButton_.enable()},t}(Be);Be.registerComponent("MenuButton",qr);var Hr=function(e){function t(t,n){var i,r=n.tracks;if((i=e.call(this,t,n)||this).items.length<=1&&i.hide(),!r)return o(i);var a=Ee(o(i),i.update);return r.addEventListener("removetrack",a),r.addEventListener("addtrack",a),i.player_.on("ready",a),i.player_.on("dispose",function(){r.removeEventListener("removetrack",a),r.removeEventListener("addtrack",a)}),i}return i(t,e),t}(qr);Be.registerComponent("TrackButton",Hr);var zr=["Tab","Esc","Up","Down","Right","Left"],Wr=function(e){function t(t,n){var i;return(i=e.call(this,t,n)||this).selectable=n.selectable,i.isSelected_=n.selected||!1,i.multiSelectable=n.multiSelectable,i.selected(i.isSelected_),i.selectable?i.multiSelectable?i.el_.setAttribute("role","menuitemcheckbox"):i.el_.setAttribute("role","menuitemradio"):i.el_.setAttribute("role","menuitem"),i}i(t,e);var n=t.prototype;return n.createEl=function(t,n,i){return this.nonIconControl=!0,e.prototype.createEl.call(this,"li",v({className:"vjs-menu-item",innerHTML:'<span class="vjs-menu-item-text">'+this.localize(this.options_.label)+"</span>",tabIndex:-1},n),i)},n.handleKeyDown=function(t){zr.some(function(e){return It.isEventKey(t,e)})||e.prototype.handleKeyDown.call(this,t)},n.handleClick=function(e){this.selected(!0)},n.selected=function(e){this.selectable&&(e?(this.addClass("vjs-selected"),this.el_.setAttribute("aria-checked","true"),this.controlText(", selected"),this.isSelected_=!0):(this.removeClass("vjs-selected"),this.el_.setAttribute("aria-checked","false"),this.controlText(""),this.isSelected_=!1))},t}(or);Be.registerComponent("MenuItem",Wr);var Gr=function(n){function r(i,r){var a,s=r.track,l=i.textTracks();r.label=s.label||s.language||"Unknown",r.selected="showing"===s.mode,(a=n.call(this,i,r)||this).track=s,a.kinds=(r.kinds||[r.kind||a.track.kind]).filter(Boolean);var u,c=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];a.handleTracksChange.apply(o(a),t)},d=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];a.handleSelectedLanguageChange.apply(o(a),t)};return i.on(["loadstart","texttrackchange"],c),l.addEventListener("change",c),l.addEventListener("selectedlanguagechange",d),a.on("dispose",function(){i.off(["loadstart","texttrackchange"],c),l.removeEventListener("change",c),l.removeEventListener("selectedlanguagechange",d)}),void 0===l.onchange&&a.on(["tap","click"],function(){if("object"!=typeof e.Event)try{u=new e.Event("change")}catch(e){}u||(u=t.createEvent("Event")).initEvent("change",!0,!0),l.dispatchEvent(u)}),a.handleTracksChange(),a}i(r,n);var a=r.prototype;return a.handleClick=function(e){var t=this.track,i=this.player_.textTracks();if(n.prototype.handleClick.call(this,e),i)for(var r=0;r<i.length;r++){var a=i[r];-1!==this.kinds.indexOf(a.kind)&&(a===t?"showing"!==a.mode&&(a.mode="showing"):"disabled"!==a.mode&&(a.mode="disabled"))}},a.handleTracksChange=function(e){var t="showing"===this.track.mode;t!==this.isSelected_&&this.selected(t)},a.handleSelectedLanguageChange=function(e){if("showing"===this.track.mode){var t=this.player_.cache_.selectedLanguage;if(t&&t.enabled&&t.language===this.track.language&&t.kind!==this.track.kind)return;this.player_.cache_.selectedLanguage={enabled:!0,language:this.track.language,kind:this.track.kind}}},a.dispose=function(){this.track=null,n.prototype.dispose.call(this)},r}(Wr);Be.registerComponent("TextTrackMenuItem",Gr);var Xr=function(e){function t(t,n){return n.track={player:t,kind:n.kind,kinds:n.kinds,default:!1,mode:"disabled"},n.kinds||(n.kinds=[n.kind]),n.label?n.track.label=n.label:n.track.label=n.kinds.join(" and ")+" off",n.selectable=!0,n.multiSelectable=!1,e.call(this,t,n)||this}i(t,e);var n=t.prototype;return n.handleTracksChange=function(e){for(var t=this.player().textTracks(),n=!0,i=0,r=t.length;i<r;i++){var a=t[i];if(this.options_.kinds.indexOf(a.kind)>-1&&"showing"===a.mode){n=!1;break}}n!==this.isSelected_&&this.selected(n)},n.handleSelectedLanguageChange=function(e){for(var t=this.player().textTracks(),n=!0,i=0,r=t.length;i<r;i++){var a=t[i];if(["captions","descriptions","subtitles"].indexOf(a.kind)>-1&&"showing"===a.mode){n=!1;break}}n&&(this.player_.cache_.selectedLanguage={enabled:!1})},t}(Gr);Be.registerComponent("OffTextTrackMenuItem",Xr);var Yr=function(e){function t(t,n){return void 0===n&&(n={}),n.tracks=t.textTracks(),e.call(this,t,n)||this}return i(t,e),t.prototype.createItems=function(e,t){var n;void 0===e&&(e=[]),void 0===t&&(t=Gr),this.label_&&(n=this.label_+" off"),e.push(new Xr(this.player_,{kinds:this.kinds_,kind:this.kind_,label:n})),this.hideThreshold_+=1;var i=this.player_.textTracks();Array.isArray(this.kinds_)||(this.kinds_=[this.kind_]);for(var r=0;r<i.length;r++){var a=i[r];if(this.kinds_.indexOf(a.kind)>-1){var o=new t(this.player_,{track:a,kinds:this.kinds_,kind:this.kind_,selectable:!0,multiSelectable:!1});o.addClass("vjs-"+a.kind+"-menu-item"),e.push(o)}}return e},t}(Hr);Be.registerComponent("TextTrackButton",Yr);var Qr=function(e){function t(t,n){var i,r=n.track,a=n.cue,s=t.currentTime();return n.selectable=!0,n.multiSelectable=!1,n.label=a.text,n.selected=a.startTime<=s&&s<a.endTime,(i=e.call(this,t,n)||this).track=r,i.cue=a,r.addEventListener("cuechange",Ee(o(i),i.update)),i}i(t,e);var n=t.prototype;return n.handleClick=function(t){e.prototype.handleClick.call(this),this.player_.currentTime(this.cue.startTime),this.update(this.cue.startTime)},n.update=function(e){var t=this.cue,n=this.player_.currentTime();this.selected(t.startTime<=n&&n<t.endTime)},t}(Wr);Be.registerComponent("ChaptersTrackMenuItem",Qr);var Jr=function(e){function t(t,n,i){return e.call(this,t,n,i)||this}i(t,e);var n=t.prototype;return n.buildCSSClass=function(){return"vjs-chapters-button "+e.prototype.buildCSSClass.call(this)},n.buildWrapperCSSClass=function(){return"vjs-chapters-button "+e.prototype.buildWrapperCSSClass.call(this)},n.update=function(t){this.track_&&(!t||"addtrack"!==t.type&&"removetrack"!==t.type)||this.setTrack(this.findChaptersTrack()),e.prototype.update.call(this)},n.setTrack=function(e){if(this.track_!==e){if(this.updateHandler_||(this.updateHandler_=this.update.bind(this)),this.track_){var t=this.player_.remoteTextTrackEls().getTrackElementByTrack_(this.track_);t&&t.removeEventListener("load",this.updateHandler_),this.track_=null}if(this.track_=e,this.track_){this.track_.mode="hidden";var n=this.player_.remoteTextTrackEls().getTrackElementByTrack_(this.track_);n&&n.addEventListener("load",this.updateHandler_)}}},n.findChaptersTrack=function(){for(var e=this.player_.textTracks()||[],t=e.length-1;t>=0;t--){var n=e[t];if(n.kind===this.kind_)return n}},n.getMenuCaption=function(){return this.track_&&this.track_.label?this.track_.label:this.localize($e(this.kind_))},n.createMenu=function(){return this.options_.title=this.getMenuCaption(),e.prototype.createMenu.call(this)},n.createItems=function(){var e=[];if(!this.track_)return e;var t=this.track_.cues;if(!t)return e;for(var n=0,i=t.length;n<i;n++){var r=t[n],a=new Qr(this.player_,{track:this.track_,cue:r});e.push(a)}return e},t}(Yr);Jr.prototype.kind_="chapters",Jr.prototype.controlText_="Chapters",Be.registerComponent("ChaptersButton",Jr);var Zr=function(e){function t(t,n,i){var r;r=e.call(this,t,n,i)||this;var a=t.textTracks(),s=Ee(o(r),r.handleTracksChange);return a.addEventListener("change",s),r.on("dispose",function(){a.removeEventListener("change",s)}),r}i(t,e);var n=t.prototype;return n.handleTracksChange=function(e){for(var t=this.player().textTracks(),n=!1,i=0,r=t.length;i<r;i++){var a=t[i];if(a.kind!==this.kind_&&"showing"===a.mode){n=!0;break}}n?this.disable():this.enable()},n.buildCSSClass=function(){return"vjs-descriptions-button "+e.prototype.buildCSSClass.call(this)},n.buildWrapperCSSClass=function(){return"vjs-descriptions-button "+e.prototype.buildWrapperCSSClass.call(this)},t}(Yr);Zr.prototype.kind_="descriptions",Zr.prototype.controlText_="Descriptions",Be.registerComponent("DescriptionsButton",Zr);var ea=function(e){function t(t,n,i){return e.call(this,t,n,i)||this}i(t,e);var n=t.prototype;return n.buildCSSClass=function(){return"vjs-subtitles-button "+e.prototype.buildCSSClass.call(this)},n.buildWrapperCSSClass=function(){return"vjs-subtitles-button "+e.prototype.buildWrapperCSSClass.call(this)},t}(Yr);ea.prototype.kind_="subtitles",ea.prototype.controlText_="Subtitles",Be.registerComponent("SubtitlesButton",ea);var ta=function(e){function t(t,n){var i;return n.track={player:t,kind:n.kind,label:n.kind+" settings",selectable:!1,default:!1,mode:"disabled"},n.selectable=!1,n.name="CaptionSettingsMenuItem",(i=e.call(this,t,n)||this).addClass("vjs-texttrack-settings"),i.controlText(", opens "+n.kind+" settings dialog"),i}return i(t,e),t.prototype.handleClick=function(e){this.player().getChild("textTrackSettings").open()},t}(Gr);Be.registerComponent("CaptionSettingsMenuItem",ta);var na=function(e){function t(t,n,i){return e.call(this,t,n,i)||this}i(t,e);var n=t.prototype;return n.buildCSSClass=function(){return"vjs-captions-button "+e.prototype.buildCSSClass.call(this)},n.buildWrapperCSSClass=function(){return"vjs-captions-button "+e.prototype.buildWrapperCSSClass.call(this)},n.createItems=function(){var t=[];return this.player().tech_&&this.player().tech_.featuresNativeTextTracks||!this.player().getChild("textTrackSettings")||(t.push(new ta(this.player_,{kind:this.kind_})),this.hideThreshold_+=1),e.prototype.createItems.call(this,t)},t}(Yr);na.prototype.kind_="captions",na.prototype.controlText_="Captions",Be.registerComponent("CaptionsButton",na);var ia=function(e){function t(){return e.apply(this,arguments)||this}return i(t,e),t.prototype.createEl=function(t,n,i){var r='<span class="vjs-menu-item-text">'+this.localize(this.options_.label);return"captions"===this.options_.track.kind&&(r+='\n        <span aria-hidden="true" class="vjs-icon-placeholder"></span>\n        <span class="vjs-control-text"> '+this.localize("Captions")+"</span>\n      "),r+="</span>",e.prototype.createEl.call(this,t,v({innerHTML:r},n),i)},t}(Gr);Be.registerComponent("SubsCapsMenuItem",ia);var ra=function(e){function t(t,n){var i;return void 0===n&&(n={}),(i=e.call(this,t,n)||this).label_="subtitles",["en","en-us","en-ca","fr-ca"].indexOf(i.player_.language_)>-1&&(i.label_="captions"),i.menuButton_.controlText($e(i.label_)),i}i(t,e);var n=t.prototype;return n.buildCSSClass=function(){return"vjs-subs-caps-button "+e.prototype.buildCSSClass.call(this)},n.buildWrapperCSSClass=function(){return"vjs-subs-caps-button "+e.prototype.buildWrapperCSSClass.call(this)},n.createItems=function(){var t=[];return this.player().tech_&&this.player().tech_.featuresNativeTextTracks||!this.player().getChild("textTrackSettings")||(t.push(new ta(this.player_,{kind:this.label_})),this.hideThreshold_+=1),e.prototype.createItems.call(this,t,ia)},t}(Yr);ra.prototype.kinds_=["captions","subtitles"],ra.prototype.controlText_="Subtitles",Be.registerComponent("SubsCapsButton",ra);var aa=function(e){function t(t,n){var i,r=n.track,a=t.audioTracks();n.label=r.label||r.language||"Unknown",n.selected=r.enabled,(i=e.call(this,t,n)||this).track=r,i.addClass("vjs-"+r.kind+"-menu-item");var s=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];i.handleTracksChange.apply(o(i),t)};return a.addEventListener("change",s),i.on("dispose",function(){a.removeEventListener("change",s)}),i}i(t,e);var n=t.prototype;return n.createEl=function(t,n,i){var r='<span class="vjs-menu-item-text">'+this.localize(this.options_.label);return"main-desc"===this.options_.track.kind&&(r+='\n        <span aria-hidden="true" class="vjs-icon-placeholder"></span>\n        <span class="vjs-control-text"> '+this.localize("Descriptions")+"</span>\n      "),r+="</span>",e.prototype.createEl.call(this,t,v({innerHTML:r},n),i)},n.handleClick=function(t){var n=this.player_.audioTracks();e.prototype.handleClick.call(this,t);for(var i=0;i<n.length;i++){var r=n[i];r.enabled=r===this.track}},n.handleTracksChange=function(e){this.selected(this.track.enabled)},t}(Wr);Be.registerComponent("AudioTrackMenuItem",aa);var oa=function(e){function t(t,n){return void 0===n&&(n={}),n.tracks=t.audioTracks(),e.call(this,t,n)||this}i(t,e);var n=t.prototype;return n.buildCSSClass=function(){return"vjs-audio-button "+e.prototype.buildCSSClass.call(this)},n.buildWrapperCSSClass=function(){return"vjs-audio-button "+e.prototype.buildWrapperCSSClass.call(this)},n.createItems=function(e){void 0===e&&(e=[]),this.hideThreshold_=1;for(var t=this.player_.audioTracks(),n=0;n<t.length;n++){var i=t[n];e.push(new aa(this.player_,{track:i,selectable:!0,multiSelectable:!1}))}return e},t}(Hr);oa.prototype.controlText_="Audio Track",Be.registerComponent("AudioTrackButton",oa);var sa=function(e){function t(t,n){var i,r=n.rate,a=parseFloat(r,10);return n.label=r,n.selected=1===a,n.selectable=!0,n.multiSelectable=!1,(i=e.call(this,t,n)||this).label=r,i.rate=a,i.on(t,"ratechange",i.update),i}i(t,e);var n=t.prototype;return n.handleClick=function(t){e.prototype.handleClick.call(this),this.player().playbackRate(this.rate)},n.update=function(e){this.selected(this.player().playbackRate()===this.rate)},t}(Wr);sa.prototype.contentElType="button",Be.registerComponent("PlaybackRateMenuItem",sa);var la=function(e){function t(t,n){var i;return(i=e.call(this,t,n)||this).updateVisibility(),i.updateLabel(),i.on(t,"loadstart",i.updateVisibility),i.on(t,"ratechange",i.updateLabel),i}i(t,e);var n=t.prototype;return n.createEl=function(){var t=e.prototype.createEl.call(this);return this.labelEl_=O("div",{className:"vjs-playback-rate-value",innerHTML:"1x"}),t.appendChild(this.labelEl_),t},n.dispose=function(){this.labelEl_=null,e.prototype.dispose.call(this)},n.buildCSSClass=function(){return"vjs-playback-rate "+e.prototype.buildCSSClass.call(this)},n.buildWrapperCSSClass=function(){return"vjs-playback-rate "+e.prototype.buildWrapperCSSClass.call(this)},n.createMenu=function(){var e=new Vr(this.player()),t=this.playbackRates();if(t)for(var n=t.length-1;n>=0;n--)e.addChild(new sa(this.player(),{rate:t[n]+"x"}));return e},n.updateARIAAttributes=function(){this.el().setAttribute("aria-valuenow",this.player().playbackRate())},n.handleClick=function(e){for(var t=this.player().playbackRate(),n=this.playbackRates(),i=n[0],r=0;r<n.length;r++)if(n[r]>t){i=n[r];break}this.player().playbackRate(i)},n.playbackRates=function(){return this.options_.playbackRates||this.options_.playerOptions&&this.options_.playerOptions.playbackRates},n.playbackRateSupported=function(){return this.player().tech_&&this.player().tech_.featuresPlaybackRate&&this.playbackRates()&&this.playbackRates().length>0},n.updateVisibility=function(e){this.playbackRateSupported()?this.removeClass("vjs-hidden"):this.addClass("vjs-hidden")},n.updateLabel=function(e){this.playbackRateSupported()&&(this.labelEl_.innerHTML=this.player().playbackRate()+"x")},t}(qr);la.prototype.controlText_="Playback Rate",Be.registerComponent("PlaybackRateMenuButton",la);var ua=function(e){function t(){return e.apply(this,arguments)||this}i(t,e);var n=t.prototype;return n.buildCSSClass=function(){return"vjs-spacer "+e.prototype.buildCSSClass.call(this)},n.createEl=function(){return e.prototype.createEl.call(this,"div",{className:this.buildCSSClass()})},t}(Be);Be.registerComponent("Spacer",ua);var ca=function(e){function t(){return e.apply(this,arguments)||this}i(t,e);var n=t.prototype;return n.buildCSSClass=function(){return"vjs-custom-control-spacer "+e.prototype.buildCSSClass.call(this)},n.createEl=function(){var t=e.prototype.createEl.call(this,{className:this.buildCSSClass()});return t.innerHTML=" ",t},t}(ua);Be.registerComponent("CustomControlSpacer",ca);var da=function(e){function t(){return e.apply(this,arguments)||this}return i(t,e),t.prototype.createEl=function(){return e.prototype.createEl.call(this,"div",{className:"vjs-control-bar",dir:"ltr"})},t}(Be);da.prototype.options_={children:["playToggle","volumePanel","currentTimeDisplay","timeDivider","durationDisplay","progressControl","liveDisplay","seekToLive","remainingTimeDisplay","customControlSpacer","playbackRateMenuButton","chaptersButton","descriptionsButton","subsCapsButton","audioTrackButton","fullscreenToggle"]},"exitPictureInPicture"in t&&da.prototype.options_.children.splice(da.prototype.options_.children.length-1,0,"pictureInPictureToggle"),Be.registerComponent("ControlBar",da);var ha=function(e){function t(t,n){var i;return(i=e.call(this,t,n)||this).on(t,"error",i.open),i}i(t,e);var n=t.prototype;return n.buildCSSClass=function(){return"vjs-error-display "+e.prototype.buildCSSClass.call(this)},n.content=function(){var e=this.player().error();return e?this.localize(e.message):""},t}(Dt);ha.prototype.options_=je(Dt.prototype.options_,{pauseOnOpen:!1,fillAlways:!0,temporary:!1,uncloseable:!0}),Be.registerComponent("ErrorDisplay",ha);var pa=["#000","Black"],fa=["#00F","Blue"],ga=["#0FF","Cyan"],ma=["#0F0","Green"],va=["#F0F","Magenta"],ya=["#F00","Red"],ba=["#FFF","White"],_a=["#FF0","Yellow"],Ta=["1","Opaque"],Ea=["0.5","Semi-Transparent"],Ca=["0","Transparent"],wa={backgroundColor:{selector:".vjs-bg-color > select",id:"captions-background-color-%s",label:"Color",options:[pa,ba,ya,ma,fa,_a,va,ga]},backgroundOpacity:{selector:".vjs-bg-opacity > select",id:"captions-background-opacity-%s",label:"Transparency",options:[Ta,Ea,Ca]},color:{selector:".vjs-fg-color > select",id:"captions-foreground-color-%s",label:"Color",options:[ba,pa,ya,ma,fa,_a,va,ga]},edgeStyle:{selector:".vjs-edge-style > select",id:"%s",label:"Text Edge Style",options:[["none","None"],["raised","Raised"],["depressed","Depressed"],["uniform","Uniform"],["dropshadow","Dropshadow"]]},fontFamily:{selector:".vjs-font-family > select",id:"captions-font-family-%s",label:"Font Family",options:[["proportionalSansSerif","Proportional Sans-Serif"],["monospaceSansSerif","Monospace Sans-Serif"],["proportionalSerif","Proportional Serif"],["monospaceSerif","Monospace Serif"],["casual","Casual"],["script","Script"],["small-caps","Small Caps"]]},fontPercent:{selector:".vjs-font-percent > select",id:"captions-font-size-%s",label:"Font Size",options:[["0.50","50%"],["0.75","75%"],["1.00","100%"],["1.25","125%"],["1.50","150%"],["1.75","175%"],["2.00","200%"],["3.00","300%"],["4.00","400%"]],default:2,parser:function(e){return"1.00"===e?null:Number(e)}},textOpacity:{selector:".vjs-text-opacity > select",id:"captions-foreground-opacity-%s",label:"Transparency",options:[Ta,Ea]},windowColor:{selector:".vjs-window-color > select",id:"captions-window-color-%s",label:"Color"},windowOpacity:{selector:".vjs-window-opacity > select",id:"captions-window-opacity-%s",label:"Transparency",options:[Ca,Ea,Ta]}};function ka(e,t){if(t&&(e=t(e)),e&&"none"!==e)return e}wa.windowColor.options=wa.backgroundColor.options;var Sa=function(t){function n(e,n){var i;return n.temporary=!1,(i=t.call(this,e,n)||this).updateDisplay=Ee(o(i),i.updateDisplay),i.fill(),i.hasBeenOpened_=i.hasBeenFilled_=!0,i.endDialog=O("p",{className:"vjs-control-text",textContent:i.localize("End of dialog window.")}),i.el().appendChild(i.endDialog),i.setDefaults(),void 0===n.persistTextTrackSettings&&(i.options_.persistTextTrackSettings=i.options_.playerOptions.persistTextTrackSettings),i.on(i.$(".vjs-done-button"),"click",function(){i.saveSettings(),i.close()}),i.on(i.$(".vjs-default-button"),"click",function(){i.setDefaults(),i.updateDisplay()}),m(wa,function(e){i.on(i.$(e.selector),"change",i.updateDisplay)}),i.options_.persistTextTrackSettings&&i.restoreSettings(),i}i(n,t);var r=n.prototype;return r.dispose=function(){this.endDialog=null,t.prototype.dispose.call(this)},r.createElSelect_=function(e,t,n){var i=this;void 0===t&&(t=""),void 0===n&&(n="label");var r=wa[e],a=r.id.replace("%s",this.id_),o=[t,a].join(" ").trim();return["<"+n+' id="'+a+'" class="'+("label"===n?"vjs-label":"")+'">',this.localize(r.label),"</"+n+">",'<select aria-labelledby="'+o+'">'].concat(r.options.map(function(e){var t=a+"-"+e[1].replace(/\W+/g,"");return['<option id="'+t+'" value="'+e[0]+'" ','aria-labelledby="'+o+" "+t+'">',i.localize(e[1]),"</option>"].join("")})).concat("</select>").join("")},r.createElFgColor_=function(){var e="captions-text-legend-"+this.id_;return['<fieldset class="vjs-fg-color vjs-track-setting">','<legend id="'+e+'">',this.localize("Text"),"</legend>",this.createElSelect_("color",e),'<span class="vjs-text-opacity vjs-opacity">',this.createElSelect_("textOpacity",e),"</span>","</fieldset>"].join("")},r.createElBgColor_=function(){var e="captions-background-"+this.id_;return['<fieldset class="vjs-bg-color vjs-track-setting">','<legend id="'+e+'">',this.localize("Background"),"</legend>",this.createElSelect_("backgroundColor",e),'<span class="vjs-bg-opacity vjs-opacity">',this.createElSelect_("backgroundOpacity",e),"</span>","</fieldset>"].join("")},r.createElWinColor_=function(){var e="captions-window-"+this.id_;return['<fieldset class="vjs-window-color vjs-track-setting">','<legend id="'+e+'">',this.localize("Window"),"</legend>",this.createElSelect_("windowColor",e),'<span class="vjs-window-opacity vjs-opacity">',this.createElSelect_("windowOpacity",e),"</span>","</fieldset>"].join("")},r.createElColors_=function(){return O("div",{className:"vjs-track-settings-colors",innerHTML:[this.createElFgColor_(),this.createElBgColor_(),this.createElWinColor_()].join("")})},r.createElFont_=function(){return O("div",{className:"vjs-track-settings-font",innerHTML:['<fieldset class="vjs-font-percent vjs-track-setting">',this.createElSelect_("fontPercent","","legend"),"</fieldset>",'<fieldset class="vjs-edge-style vjs-track-setting">',this.createElSelect_("edgeStyle","","legend"),"</fieldset>",'<fieldset class="vjs-font-family vjs-track-setting">',this.createElSelect_("fontFamily","","legend"),"</fieldset>"].join("")})},r.createElControls_=function(){var e=this.localize("restore all settings to the default values");return O("div",{className:"vjs-track-settings-controls",innerHTML:['<button type="button" class="vjs-default-button" title="'+e+'">',this.localize("Reset"),'<span class="vjs-control-text"> '+e+"</span>","</button>",'<button type="button" class="vjs-done-button">'+this.localize("Done")+"</button>"].join("")})},r.content=function(){return[this.createElColors_(),this.createElFont_(),this.createElControls_()]},r.label=function(){return this.localize("Caption Settings Dialog")},r.description=function(){return this.localize("Beginning of dialog window. Escape will cancel and close the window.")},r.buildCSSClass=function(){return t.prototype.buildCSSClass.call(this)+" vjs-text-track-settings"},r.getValues=function(){var e,t,n,i=this;return e=wa,t=function(e,t,n){var r,a,o=(r=i.$(t.selector),a=t.parser,ka(r.options[r.options.selectedIndex].value,a));return void 0!==o&&(e[n]=o),e},void 0===(n={})&&(n=0),g(e).reduce(function(n,i){return t(n,e[i],i)},n)},r.setValues=function(e){var t=this;m(wa,function(n,i){!function(e,t,n){if(t)for(var i=0;i<e.options.length;i++)if(ka(e.options[i].value,n)===t){e.selectedIndex=i;break}}(t.$(n.selector),e[i],n.parser)})},r.setDefaults=function(){var e=this;m(wa,function(t){var n=t.hasOwnProperty("default")?t.default:0;e.$(t.selector).selectedIndex=n})},r.restoreSettings=function(){var t;try{t=JSON.parse(e.localStorage.getItem("vjs-text-track-settings"))}catch(e){c.warn(e)}t&&this.setValues(t)},r.saveSettings=function(){if(this.options_.persistTextTrackSettings){var t=this.getValues();try{Object.keys(t).length?e.localStorage.setItem("vjs-text-track-settings",JSON.stringify(t)):e.localStorage.removeItem("vjs-text-track-settings")}catch(e){c.warn(e)}}},r.updateDisplay=function(){var e=this.player_.getChild("textTrackDisplay");e&&e.updateDisplay()},r.conditionalBlur_=function(){this.previouslyActiveEl_=null;var e=this.player_.controlBar,t=e&&e.subsCapsButton,n=e&&e.captionsButton;t?t.focus():n&&n.focus()},n}(Dt);Be.registerComponent("TextTrackSettings",Sa);var Ia=function(t){function n(n,i){var r,a=i.ResizeObserver||e.ResizeObserver;null===i.ResizeObserver&&(a=!1);var s=je({createEl:!a,reportTouchActivity:!1},i);return(r=t.call(this,n,s)||this).ResizeObserver=i.ResizeObserver||e.ResizeObserver,r.loadListener_=null,r.resizeObserver_=null,r.debouncedHandler_=we(function(){r.resizeHandler()},100,!1,o(r)),a?(r.resizeObserver_=new r.ResizeObserver(r.debouncedHandler_),r.resizeObserver_.observe(n.el())):(r.loadListener_=function(){if(r.el_&&r.el_.contentWindow){var e=r.debouncedHandler_,t=r.unloadListener_=function(){ue(this,"resize",e),ue(this,"unload",t),t=null};le(r.el_.contentWindow,"unload",t),le(r.el_.contentWindow,"resize",e)}},r.one("load",r.loadListener_)),r}i(n,t);var r=n.prototype;return r.createEl=function(){return t.prototype.createEl.call(this,"iframe",{className:"vjs-resize-manager",tabIndex:-1},{"aria-hidden":"true"})},r.resizeHandler=function(){this.player_&&this.player_.trigger&&this.player_.trigger("playerresize")},r.dispose=function(){this.debouncedHandler_&&this.debouncedHandler_.cancel(),this.resizeObserver_&&(this.player_.el()&&this.resizeObserver_.unobserve(this.player_.el()),this.resizeObserver_.disconnect()),this.loadListener_&&this.off("load",this.loadListener_),this.el_&&this.el_.contentWindow&&this.unloadListener_&&this.unloadListener_.call(this.el_.contentWindow),this.ResizeObserver=null,this.resizeObserver=null,this.debouncedHandler_=null,this.loadListener_=null,t.prototype.dispose.call(this)},n}(Be);Be.registerComponent("ResizeManager",Ia);var Oa=function(e){function n(n,i){var r,a=je({createEl:!1},i);return(r=e.call(this,n,a)||this).reset_(),r.on(r.player_,"durationchange",r.handleDurationchange),it&&"hidden"in t&&"visibilityState"in t&&r.on(t,"visibilitychange",r.handleVisibilityChange),r}i(n,e);var r=n.prototype;return r.handleVisibilityChange=function(){this.player_.duration()===1/0&&(t.hidden?this.stopTracking():this.startTracking())},r.isBehind_=function(){if(!this.timeupdateSeen_)return!1;var e=this.liveCurrentTime(),t=this.player_.currentTime(),n=this.seekableIncrement_;return e!==1/0&&e-(2*n+.07)>=t},r.trackLive_=function(){this.pastSeekEnd_=this.pastSeekEnd_;var e=this.player_.seekable();if(e&&e.length){var t=this.seekableEnd();t!==this.lastSeekEnd_&&(this.lastSeekEnd_&&(this.seekableIncrement_=Math.abs(t-this.lastSeekEnd_)),this.pastSeekEnd_=0,this.lastSeekEnd_=t,this.trigger("seekableendchange")),this.pastSeekEnd_=this.pastSeekEnd()+.03,this.isBehind_()!==this.behindLiveEdge()&&(this.behindLiveEdge_=this.isBehind_(),this.trigger("liveedgechange"))}},r.handleDurationchange=function(){this.player_.duration()===1/0?this.startTracking():this.stopTracking()},r.startTracking=function(){var e=this;this.isTracking()||(this.timeupdateSeen_||(this.timeupdateSeen_=this.player_.hasStarted()),this.trackingInterval_=this.setInterval(this.trackLive_,30),this.trackLive_(),this.on(this.player_,"play",this.trackLive_),this.on(this.player_,"pause",this.trackLive_),this.timeupdateSeen_||(this.one(this.player_,"play",this.handlePlay),this.handleTimeupdate=function(){e.timeupdateSeen_=!0,e.handleTimeupdate=null},this.one(this.player_,"timeupdate",this.handleTimeupdate)))},r.handlePlay=function(){this.one(this.player_,"timeupdate",this.seekToLiveEdge)},r.reset_=function(){this.pastSeekEnd_=0,this.lastSeekEnd_=null,this.behindLiveEdge_=null,this.timeupdateSeen_=!1,this.clearInterval(this.trackingInterval_),this.trackingInterval_=null,this.seekableIncrement_=12,this.off(this.player_,"play",this.trackLive_),this.off(this.player_,"pause",this.trackLive_),this.off(this.player_,"play",this.handlePlay),this.off(this.player_,"timeupdate",this.seekToLiveEdge),this.handleTimeupdate&&(this.off(this.player_,"timeupdate",this.handleTimeupdate),this.handleTimeupdate=null)},r.stopTracking=function(){this.isTracking()&&this.reset_()},r.seekableEnd=function(){for(var e=this.player_.seekable(),t=[],n=e?e.length:0;n--;)t.push(e.end(n));return t.length?t.sort()[t.length-1]:1/0},r.seekableStart=function(){for(var e=this.player_.seekable(),t=[],n=e?e.length:0;n--;)t.push(e.start(n));return t.length?t.sort()[0]:0},r.liveWindow=function(){var e=this.liveCurrentTime();return e===1/0?1/0:e-this.seekableStart()},r.isLive=function(){return this.isTracking()},r.atLiveEdge=function(){return!this.behindLiveEdge()},r.liveCurrentTime=function(){return this.pastSeekEnd()+this.seekableEnd()},r.pastSeekEnd=function(){return this.pastSeekEnd_},r.behindLiveEdge=function(){return this.behindLiveEdge_},r.isTracking=function(){return"number"==typeof this.trackingInterval_},r.seekToLiveEdge=function(){this.atLiveEdge()||(this.player_.currentTime(this.liveCurrentTime()),this.player_.paused()&&this.player_.play())},r.dispose=function(){this.stopTracking(),e.prototype.dispose.call(this)},n}(Be);Be.registerComponent("LiveTracker",Oa);var Da=function(e){var t=e.el();if(t.hasAttribute("src"))return e.triggerSourceset(t.src),!0;var n=e.$$("source"),i=[],r="";if(!n.length)return!1;for(var a=0;a<n.length;a++){var o=n[a].src;o&&-1===i.indexOf(o)&&i.push(o)}return!!i.length&&(1===i.length&&(r=i[0]),e.triggerSourceset(r),!0)},Ra=Object.defineProperty({},"innerHTML",{get:function(){return this.cloneNode(!0).innerHTML},set:function(n){var i=t.createElement(this.nodeName.toLowerCase());i.innerHTML=n;for(var r=t.createDocumentFragment();i.childNodes.length;)r.appendChild(i.childNodes[0]);return this.innerText="",e.Element.prototype.appendChild.call(this,r),this.innerHTML}}),xa=function(e,t){for(var n={},i=0;i<e.length&&!((n=Object.getOwnPropertyDescriptor(e[i],t))&&n.set&&n.get);i++);return n.enumerable=!0,n.configurable=!0,n},Aa=function(t){var n=t.el();if(!n.resetSourceWatch_){var i={},r=function(t){return xa([t.el(),e.HTMLMediaElement.prototype,e.Element.prototype,Ra],"innerHTML")}(t),a=function(e){return function(){for(var i=arguments.length,r=new Array(i),a=0;a<i;a++)r[a]=arguments[a];var o=e.apply(n,r);return Da(t),o}};["append","appendChild","insertAdjacentHTML"].forEach(function(e){n[e]&&(i[e]=n[e],n[e]=a(i[e]))}),Object.defineProperty(n,"innerHTML",je(r,{set:a(r.set)})),n.resetSourceWatch_=function(){n.resetSourceWatch_=null,Object.keys(i).forEach(function(e){n[e]=i[e]}),Object.defineProperty(n,"innerHTML",r)},t.one("sourceset",n.resetSourceWatch_)}},Pa=Object.defineProperty({},"src",{get:function(){return this.hasAttribute("src")?zt(e.Element.prototype.getAttribute.call(this,"src")):""},set:function(t){return e.Element.prototype.setAttribute.call(this,"src",t),t}});function La(){var e=s(["Text Tracks are being loaded from another origin but the crossorigin attribute isn't used.\n            This may prevent text tracks from loading."]);return La=function(){return e},e}var Na=function(n){function r(e,t){var i;i=n.call(this,e,t)||this;var r=e.source,a=!1;if(r&&(i.el_.currentSrc!==r.src||e.tag&&3===e.tag.initNetworkState_)?i.setSource(r):i.handleLateInit_(i.el_),e.enableSourceset&&i.setupSourcesetHandling_(),i.el_.hasChildNodes()){for(var o=i.el_.childNodes,s=o.length,l=[];s--;){var u=o[s];"track"===u.nodeName.toLowerCase()&&(i.featuresNativeTextTracks?(i.remoteTextTrackEls().addTrackElement_(u),i.remoteTextTracks().addTrack(u.track),i.textTracks().addTrack(u.track),a||i.el_.hasAttribute("crossorigin")||!Gt(u.src)||(a=!0)):l.push(u))}for(var d=0;d<l.length;d++)i.el_.removeChild(l[d])}return i.proxyNativeTracks_(),i.featuresNativeTextTracks&&a&&c.warn(p(La())),i.restoreMetadataTracksInIOSNativePlayer_(),(st||ze||Je)&&!0===e.nativeControlsForTouch&&i.setControls(!0),i.proxyWebkitFullscreen_(),i.triggerReady(),i}i(r,n);var a=r.prototype;return a.dispose=function(){this.el_&&this.el_.resetSourceset_&&this.el_.resetSourceset_(),r.disposeMediaElement(this.el_),this.options_=null,n.prototype.dispose.call(this)},a.setupSourcesetHandling_=function(){!function(t){if(t.featuresSourceset){var n=t.el();if(!n.resetSourceset_){var i=function(t){return xa([t.el(),e.HTMLMediaElement.prototype,Pa],"src")}(t),r=n.setAttribute,a=n.load;Object.defineProperty(n,"src",je(i,{set:function(e){var r=i.set.call(n,e);return t.triggerSourceset(n.src),r}})),n.setAttribute=function(e,i){var a=r.call(n,e,i);return/src/i.test(e)&&t.triggerSourceset(n.src),a},n.load=function(){var e=a.call(n);return Da(t)||(t.triggerSourceset(""),Aa(t)),e},n.currentSrc?t.triggerSourceset(n.currentSrc):Da(t)||Aa(t),n.resetSourceset_=function(){n.resetSourceset_=null,n.load=a,n.setAttribute=r,Object.defineProperty(n,"src",i),n.resetSourceWatch_&&n.resetSourceWatch_()}}}}(this)},a.restoreMetadataTracksInIOSNativePlayer_=function(){var e,t=this.textTracks(),n=function(){e=[];for(var n=0;n<t.length;n++){var i=t[n];"metadata"===i.kind&&e.push({track:i,storedMode:i.mode})}};n(),t.addEventListener("change",n),this.on("dispose",function(){return t.removeEventListener("change",n)});var i=function n(){for(var i=0;i<e.length;i++){var r=e[i];"disabled"===r.track.mode&&r.track.mode!==r.storedMode&&(r.track.mode=r.storedMode)}t.removeEventListener("change",n)};this.on("webkitbeginfullscreen",function(){t.removeEventListener("change",n),t.removeEventListener("change",i),t.addEventListener("change",i)}),this.on("webkitendfullscreen",function(){t.removeEventListener("change",n),t.addEventListener("change",n),t.removeEventListener("change",i)})},a.overrideNative_=function(e,t){var n=this;if(t===this["featuresNative"+e+"Tracks"]){var i=e.toLowerCase();this[i+"TracksListeners_"]&&Object.keys(this[i+"TracksListeners_"]).forEach(function(e){n.el()[i+"Tracks"].removeEventListener(e,n[i+"TracksListeners_"][e])}),this["featuresNative"+e+"Tracks"]=!t,this[i+"TracksListeners_"]=null,this.proxyNativeTracksForType_(i)}},a.overrideNativeAudioTracks=function(e){this.overrideNative_("Audio",e)},a.overrideNativeVideoTracks=function(e){this.overrideNative_("Video",e)},a.proxyNativeTracksForType_=function(e){var t=this,n=gi[e],i=this.el()[n.getterName],r=this[n.getterName]();if(this["featuresNative"+n.capitalName+"Tracks"]&&i&&i.addEventListener){var a={change:function(e){r.trigger({type:"change",target:r,currentTarget:r,srcElement:r})},addtrack:function(e){r.addTrack(e.track)},removetrack:function(e){r.removeTrack(e.track)}},o=function(){for(var e=[],t=0;t<r.length;t++){for(var n=!1,a=0;a<i.length;a++)if(i[a]===r[t]){n=!0;break}n||e.push(r[t])}for(;e.length;)r.removeTrack(e.shift())};this[n.getterName+"Listeners_"]=a,Object.keys(a).forEach(function(e){var n=a[e];i.addEventListener(e,n),t.on("dispose",function(t){return i.removeEventListener(e,n)})}),this.on("loadstart",o),this.on("dispose",function(e){return t.off("loadstart",o)})}},a.proxyNativeTracks_=function(){var e=this;gi.names.forEach(function(t){e.proxyNativeTracksForType_(t)})},a.createEl=function(){var e=this.options_.tag;if(!e||!this.options_.playerElIngest&&!this.movingMediaElementInDOM){if(e){var n=e.cloneNode(!0);e.parentNode&&e.parentNode.insertBefore(n,e),r.disposeMediaElement(e),e=n}else{e=t.createElement("video");var i=je({},this.options_.tag&&M(this.options_.tag));st&&!0===this.options_.nativeControlsForTouch||delete i.controls,N(e,v(i,{id:this.options_.techId,class:"vjs-tech"}))}e.playerId=this.options_.playerId}void 0!==this.options_.preload&&$(e,"preload",this.options_.preload);for(var a=["loop","muted","playsinline","autoplay"],o=0;o<a.length;o++){var s=a[o],l=this.options_[s];void 0!==l&&(l?$(e,s,s):j(e,s),e[s]=l)}return e},a.handleLateInit_=function(e){if(0!==e.networkState&&3!==e.networkState){if(0===e.readyState){var t=!1,n=function(){t=!0};this.on("loadstart",n);var i=function(){t||this.trigger("loadstart")};return this.on("loadedmetadata",i),void this.ready(function(){this.off("loadstart",n),this.off("loadedmetadata",i),t||this.trigger("loadstart")})}var r=["loadstart"];r.push("loadedmetadata"),e.readyState>=2&&r.push("loadeddata"),e.readyState>=3&&r.push("canplay"),e.readyState>=4&&r.push("canplaythrough"),this.ready(function(){r.forEach(function(e){this.trigger(e)},this)})}},a.setCurrentTime=function(e){try{this.el_.currentTime=e}catch(e){c(e,"Video is not ready. (Video.js)")}},a.duration=function(){var e=this;return this.el_.duration===1/0&&Ye&&tt&&0===this.el_.currentTime?(this.on("timeupdate",function t(){e.el_.currentTime>0&&(e.el_.duration===1/0&&e.trigger("durationchange"),e.off("timeupdate",t))}),NaN):this.el_.duration||NaN},a.width=function(){return this.el_.offsetWidth},a.height=function(){return this.el_.offsetHeight},a.proxyWebkitFullscreen_=function(){var e=this;if("webkitDisplayingFullscreen"in this.el_){var t=function(){this.trigger("fullscreenchange",{isFullscreen:!1})},n=function(){"webkitPresentationMode"in this.el_&&"picture-in-picture"!==this.el_.webkitPresentationMode&&(this.one("webkitendfullscreen",t),this.trigger("fullscreenchange",{isFullscreen:!0}))};this.on("webkitbeginfullscreen",n),this.on("dispose",function(){e.off("webkitbeginfullscreen",n),e.off("webkitendfullscreen",t)})}},a.supportsFullScreen=function(){if("function"==typeof this.el_.webkitEnterFullScreen){var t=e.navigator&&e.navigator.userAgent||"";if(/Android/.test(t)||!/Chrome|Mac OS X 10.5/.test(t))return!0}return!1},a.enterFullScreen=function(){var e=this.el_;e.paused&&e.networkState<=e.HAVE_METADATA?(this.el_.play(),this.setTimeout(function(){e.pause(),e.webkitEnterFullScreen()},0)):e.webkitEnterFullScreen()},a.exitFullScreen=function(){this.el_.webkitExitFullScreen()},a.requestPictureInPicture=function(){return this.el_.requestPictureInPicture()},a.src=function(e){if(void 0===e)return this.el_.src;this.setSrc(e)},a.reset=function(){r.resetMediaElement(this.el_)},a.currentSrc=function(){return this.currentSource_?this.currentSource_.src:this.el_.currentSrc},a.setControls=function(e){this.el_.controls=!!e},a.addTextTrack=function(e,t,i){return this.featuresNativeTextTracks?this.el_.addTextTrack(e,t,i):n.prototype.addTextTrack.call(this,e,t,i)},a.createRemoteTextTrack=function(e){if(!this.featuresNativeTextTracks)return n.prototype.createRemoteTextTrack.call(this,e);var i=t.createElement("track");return e.kind&&(i.kind=e.kind),e.label&&(i.label=e.label),(e.language||e.srclang)&&(i.srclang=e.language||e.srclang),e.default&&(i.default=e.default),e.id&&(i.id=e.id),e.src&&(i.src=e.src),i},a.addRemoteTextTrack=function(e,t){var i=n.prototype.addRemoteTextTrack.call(this,e,t);return this.featuresNativeTextTracks&&this.el().appendChild(i),i},a.removeRemoteTextTrack=function(e){if(n.prototype.removeRemoteTextTrack.call(this,e),this.featuresNativeTextTracks)for(var t=this.$$("track"),i=t.length;i--;)e!==t[i]&&e!==t[i].track||this.el().removeChild(t[i])},a.getVideoPlaybackQuality=function(){if("function"==typeof this.el().getVideoPlaybackQuality)return this.el().getVideoPlaybackQuality();var t={};return void 0!==this.el().webkitDroppedFrameCount&&void 0!==this.el().webkitDecodedFrameCount&&(t.droppedVideoFrames=this.el().webkitDroppedFrameCount,t.totalVideoFrames=this.el().webkitDecodedFrameCount),e.performance&&"function"==typeof e.performance.now?t.creationTime=e.performance.now():e.performance&&e.performance.timing&&"number"==typeof e.performance.timing.navigationStart&&(t.creationTime=e.Date.now()-e.performance.timing.navigationStart),t},r}(Wi);if(w()){Na.TEST_VID=t.createElement("video");var Ma=t.createElement("track");Ma.kind="captions",Ma.srclang="en",Ma.label="English",Na.TEST_VID.appendChild(Ma)}Na.isSupported=function(){try{Na.TEST_VID.volume=.5}catch(e){return!1}return!(!Na.TEST_VID||!Na.TEST_VID.canPlayType)},Na.canPlayType=function(e){return Na.TEST_VID.canPlayType(e)},Na.canPlaySource=function(e,t){return Na.canPlayType(e.type)},Na.canControlVolume=function(){try{var e=Na.TEST_VID.volume;return Na.TEST_VID.volume=e/2+.1,e!==Na.TEST_VID.volume}catch(e){return!1}},Na.canMuteVolume=function(){try{var e=Na.TEST_VID.muted;return Na.TEST_VID.muted=!e,Na.TEST_VID.muted?$(Na.TEST_VID,"muted","muted"):j(Na.TEST_VID,"muted"),e!==Na.TEST_VID.muted}catch(e){return!1}},Na.canControlPlaybackRate=function(){if(Ye&&tt&&nt<58)return!1;try{var e=Na.TEST_VID.playbackRate;return Na.TEST_VID.playbackRate=e/2+.1,e!==Na.TEST_VID.playbackRate}catch(e){return!1}},Na.canOverrideAttributes=function(){try{var e=function(){};Object.defineProperty(t.createElement("video"),"src",{get:e,set:e}),Object.defineProperty(t.createElement("audio"),"src",{get:e,set:e}),Object.defineProperty(t.createElement("video"),"innerHTML",{get:e,set:e}),Object.defineProperty(t.createElement("audio"),"innerHTML",{get:e,set:e})}catch(e){return!1}return!0},Na.supportsNativeTextTracks=function(){return at||Ge&&tt},Na.supportsNativeVideoTracks=function(){return!(!Na.TEST_VID||!Na.TEST_VID.videoTracks)},Na.supportsNativeAudioTracks=function(){return!(!Na.TEST_VID||!Na.TEST_VID.audioTracks)},Na.Events=["loadstart","suspend","abort","error","emptied","stalled","loadedmetadata","loadeddata","canplay","canplaythrough","playing","waiting","seeking","seeked","ended","durationchange","timeupdate","progress","play","pause","ratechange","resize","volumechange"],Na.prototype.featuresVolumeControl=Na.canControlVolume(),Na.prototype.featuresMuteControl=Na.canMuteVolume(),Na.prototype.featuresPlaybackRate=Na.canControlPlaybackRate(),Na.prototype.featuresSourceset=Na.canOverrideAttributes(),Na.prototype.movingMediaElementInDOM=!Ge,Na.prototype.featuresFullscreenResize=!0,Na.prototype.featuresProgressEvents=!0,Na.prototype.featuresTimeupdateEvents=!0,Na.prototype.featuresNativeTextTracks=Na.supportsNativeTextTracks(),Na.prototype.featuresNativeVideoTracks=Na.supportsNativeVideoTracks(),Na.prototype.featuresNativeAudioTracks=Na.supportsNativeAudioTracks();var Ka=Na.TEST_VID&&Na.TEST_VID.constructor.prototype.canPlayType,$a=/^application\/(?:x-|vnd\.apple\.)mpegurl/i;function ja(){var e=s(["\n        Using the tech directly can be dangerous. I hope you know what you're doing.\n        See https://github.com/videojs/video.js/issues/2617 for more info.\n      "]);return ja=function(){return e},e}Na.patchCanPlayType=function(){Qe>=4&&!Ze&&!tt&&(Na.TEST_VID.constructor.prototype.canPlayType=function(e){return e&&$a.test(e)?"maybe":Ka.call(this,e)})},Na.unpatchCanPlayType=function(){var e=Na.TEST_VID.constructor.prototype.canPlayType;return Na.TEST_VID.constructor.prototype.canPlayType=Ka,e},Na.patchCanPlayType(),Na.disposeMediaElement=function(e){if(e){for(e.parentNode&&e.parentNode.removeChild(e);e.hasChildNodes();)e.removeChild(e.firstChild);e.removeAttribute("src"),"function"==typeof e.load&&function(){try{e.load()}catch(e){}}()}},Na.resetMediaElement=function(e){if(e){for(var t=e.querySelectorAll("source"),n=t.length;n--;)e.removeChild(t[n]);e.removeAttribute("src"),"function"==typeof e.load&&function(){try{e.load()}catch(e){}}()}},["muted","defaultMuted","autoplay","controls","loop","playsinline"].forEach(function(e){Na.prototype[e]=function(){return this.el_[e]||this.el_.hasAttribute(e)}}),["muted","defaultMuted","autoplay","loop","playsinline"].forEach(function(e){Na.prototype["set"+$e(e)]=function(t){this.el_[e]=t,t?this.el_.setAttribute(e,e):this.el_.removeAttribute(e)}}),["paused","currentTime","buffered","volume","poster","preload","error","seeking","seekable","ended","playbackRate","defaultPlaybackRate","played","networkState","readyState","videoWidth","videoHeight"].forEach(function(e){Na.prototype[e]=function(){return this.el_[e]}}),["volume","src","poster","preload","playbackRate","defaultPlaybackRate"].forEach(function(e){Na.prototype["set"+$e(e)]=function(t){this.el_[e]=t}}),["pause","load","play"].forEach(function(e){Na.prototype[e]=function(){return this.el_[e]()}}),Wi.withSourceHandlers(Na),Na.nativeSourceHandler={},Na.nativeSourceHandler.canPlayType=function(e){try{return Na.TEST_VID.canPlayType(e)}catch(e){return""}},Na.nativeSourceHandler.canHandleSource=function(e,t){if(e.type)return Na.nativeSourceHandler.canPlayType(e.type);if(e.src){var n=Wt(e.src);return Na.nativeSourceHandler.canPlayType("video/"+n)}return""},Na.nativeSourceHandler.handleSource=function(e,t,n){t.setSrc(e.src)},Na.nativeSourceHandler.dispose=function(){},Na.registerSourceHandler(Na.nativeSourceHandler),Wi.registerTech("Html5",Na);var Ba=["progress","abort","suspend","emptied","stalled","loadedmetadata","loadeddata","timeupdate","resize","volumechange","texttrackchange"],Fa={canplay:"CanPlay",canplaythrough:"CanPlayThrough",playing:"Playing",seeked:"Seeked"},Ua=["tiny","xsmall","small","medium","large","xlarge","huge"],Va={};Ua.forEach(function(e){var t="x"===e.charAt(0)?"x-"+e.substring(1):e;Va[e]="vjs-layout-"+t});var qa={tiny:210,xsmall:320,small:425,medium:768,large:1440,xlarge:2560,huge:1/0},Ha=function(r){function a(e,t,i){var s;if(e.id=e.id||t.id||"vjs_video_"+ne(),(t=v(a.getTagSettings(e),t)).initChildren=!1,t.createEl=!1,t.evented=!1,t.reportTouchActivity=!1,!t.language)if("function"==typeof e.closest){var l=e.closest("[lang]");l&&l.getAttribute&&(t.language=l.getAttribute("lang"))}else for(var u=e;u&&1===u.nodeType;){if(M(u).hasOwnProperty("lang")){t.language=u.getAttribute("lang");break}u=u.parentNode}if((s=r.call(this,null,t,i)||this).boundDocumentFullscreenChange_=Ee(o(s),s.documentFullscreenChange_),s.boundFullWindowOnEscKey_=Ee(o(s),s.fullWindowOnEscKey),s.log=d(s.id_),s.fsApi_=ft,s.isPosterFromTech_=!1,s.queuedCallbacks_=[],s.isReady_=!1,s.hasStarted_=!1,s.userActive_=!1,!s.options_||!s.options_.techOrder||!s.options_.techOrder.length)throw new Error("No techOrder specified. Did you overwrite videojs.options instead of just changing the properties you want to override?");if(s.tag=e,s.tagAttributes=e&&M(e),s.language(s.options_.language),t.languages){var c={};Object.getOwnPropertyNames(t.languages).forEach(function(e){c[e.toLowerCase()]=t.languages[e]}),s.languages_=c}else s.languages_=a.prototype.options_.languages;s.resetCache_(),s.poster_=t.poster||"",s.controls_=!!t.controls,e.controls=!1,e.removeAttribute("controls"),s.changingSrc_=!1,s.playCallbacks_=[],s.playTerminatedQueue_=[],e.hasAttribute("autoplay")?s.autoplay(!0):s.autoplay(s.options_.autoplay),t.plugins&&Object.keys(t.plugins).forEach(function(e){if("function"!=typeof s[e])throw new Error('plugin "'+e+'" does not exist')}),s.scrubbing_=!1,s.el_=s.createEl(),Le(o(s),{eventBusKey:"el_"}),s.fluid_&&s.on("playerreset",s.updateStyleEl_);var h=je(s.options_);t.plugins&&Object.keys(t.plugins).forEach(function(e){s[e](t.plugins[e])}),s.options_.playerOptions=h,s.middleware_=[],s.initChildren(),s.isAudio("audio"===e.nodeName.toLowerCase()),s.controls()?s.addClass("vjs-controls-enabled"):s.addClass("vjs-controls-disabled"),s.el_.setAttribute("role","region"),s.isAudio()?s.el_.setAttribute("aria-label",s.localize("Audio Player")):s.el_.setAttribute("aria-label",s.localize("Video Player")),s.isAudio()&&s.addClass("vjs-audio"),s.flexNotSupported_()&&s.addClass("vjs-no-flex"),st&&s.addClass("vjs-touch-enabled"),Ge||s.addClass("vjs-workinghover"),a.players[s.id_]=o(s);var p=n.split(".")[0];return s.addClass("vjs-v"+p),s.userActive(!0),s.reportUserActivity(),s.one("play",s.listenForUserActivity_),s.on("stageclick",s.handleStageClick_),s.on("keydown",s.handleKeyDown),s.breakpoints(s.options_.breakpoints),s.responsive(s.options_.responsive),s}i(a,r);var s=a.prototype;return s.dispose=function(){var e=this;this.trigger("dispose"),this.off("dispose"),ue(t,this.fsApi_.fullscreenchange,this.boundDocumentFullscreenChange_),ue(t,"keydown",this.boundFullWindowOnEscKey_),this.styleEl_&&this.styleEl_.parentNode&&(this.styleEl_.parentNode.removeChild(this.styleEl_),this.styleEl_=null),a.players[this.id_]=null,this.tag&&this.tag.player&&(this.tag.player=null),this.el_&&this.el_.player&&(this.el_.player=null),this.tech_&&(this.tech_.dispose(),this.isPosterFromTech_=!1,this.poster_=""),this.playerElIngest_&&(this.playerElIngest_=null),this.tag&&(this.tag=null),Xi[this.id()]=null,vi.names.forEach(function(t){var n=vi[t],i=e[n.getterName]();i&&i.off&&i.off()}),r.prototype.dispose.call(this)},s.createEl=function(){var n,i=this.tag,a=this.playerElIngest_=i.parentNode&&i.parentNode.hasAttribute&&i.parentNode.hasAttribute("data-vjs-player"),o="video-js"===this.tag.tagName.toLowerCase();a?n=this.el_=i.parentNode:o||(n=this.el_=r.prototype.createEl.call(this,"div"));var s=M(i);if(o){for(n=this.el_=i,i=this.tag=t.createElement("video");n.children.length;)i.appendChild(n.firstChild);x(n,"video-js")||A(n,"video-js"),n.appendChild(i),a=this.playerElIngest_=n,Object.keys(n).forEach(function(e){i[e]=n[e]})}if(i.setAttribute("tabindex","-1"),s.tabindex="-1",(it||tt&&ot)&&(i.setAttribute("role","application"),s.role="application"),i.removeAttribute("width"),i.removeAttribute("height"),"width"in s&&delete s.width,"height"in s&&delete s.height,Object.getOwnPropertyNames(s).forEach(function(e){o&&"class"===e||n.setAttribute(e,s[e]),o&&i.setAttribute(e,s[e])}),i.playerId=i.id,i.id+="_html5_api",i.className="vjs-tech",i.player=n.player=this,this.addClass("vjs-paused"),!0!==e.VIDEOJS_NO_DYNAMIC_STYLE){this.styleEl_=be("vjs-styles-dimensions");var l=Q(".vjs-styles-defaults"),u=Q("head");u.insertBefore(this.styleEl_,l?l.nextSibling:u.firstChild)}this.fill_=!1,this.fluid_=!1,this.width(this.options_.width),this.height(this.options_.height),this.fill(this.options_.fill),this.fluid(this.options_.fluid),this.aspectRatio(this.options_.aspectRatio);for(var c=i.getElementsByTagName("a"),d=0;d<c.length;d++){var h=c.item(d);A(h,"vjs-hidden"),h.setAttribute("hidden","hidden")}return i.initNetworkState_=i.networkState,i.parentNode&&!a&&i.parentNode.insertBefore(n,i),R(i,n),this.children_.unshift(i),this.el_.setAttribute("lang",this.language_),this.el_=n,n},s.width=function(e){return this.dimension("width",e)},s.height=function(e){return this.dimension("height",e)},s.dimension=function(e,t){var n=e+"_";if(void 0===t)return this[n]||0;if(""===t)return this[n]=void 0,void this.updateStyleEl_();var i=parseFloat(t);isNaN(i)?c.error('Improper value "'+t+'" supplied for for '+e):(this[n]=i,this.updateStyleEl_())},s.fluid=function(e){if(void 0===e)return!!this.fluid_;var t,n;this.fluid_=!!e,Se(this)&&this.off("playerreset",this.updateStyleEl_),e?(this.addClass("vjs-fluid"),this.fill(!1),Se(t=function(){this.on("playerreset",this.updateStyleEl_)})?n():(t.eventedCallbacks||(t.eventedCallbacks=[]),t.eventedCallbacks.push(n))):this.removeClass("vjs-fluid"),this.updateStyleEl_()},s.fill=function(e){if(void 0===e)return!!this.fill_;this.fill_=!!e,e?(this.addClass("vjs-fill"),this.fluid(!1)):this.removeClass("vjs-fill")},s.aspectRatio=function(e){if(void 0===e)return this.aspectRatio_;if(!/^\d+\:\d+$/.test(e))throw new Error("Improper value supplied for aspect ratio. The format should be width:height, for example 16:9.");this.aspectRatio_=e,this.fluid(!0),this.updateStyleEl_()},s.updateStyleEl_=function(){if(!0!==e.VIDEOJS_NO_DYNAMIC_STYLE){var t,n,i,r=(void 0!==this.aspectRatio_&&"auto"!==this.aspectRatio_?this.aspectRatio_:this.videoWidth()>0?this.videoWidth()+":"+this.videoHeight():"16:9").split(":"),a=r[1]/r[0];t=void 0!==this.width_?this.width_:void 0!==this.height_?this.height_/a:this.videoWidth()||300,n=void 0!==this.height_?this.height_:t*a,i=/^[^a-zA-Z]/.test(this.id())?"dimensions-"+this.id():this.id()+"-dimensions",this.addClass(i),_e(this.styleEl_,"\n      ."+i+" {\n        width: "+t+"px;\n        height: "+n+"px;\n      }\n\n      ."+i+".vjs-fluid {\n        padding-top: "+100*a+"%;\n      }\n    ")}else{var o="number"==typeof this.width_?this.width_:this.options_.width,s="number"==typeof this.height_?this.height_:this.options_.height,l=this.tech_&&this.tech_.el();l&&(o>=0&&(l.width=o),s>=0&&(l.height=s))}},s.loadTech_=function(e,t){var n=this;this.tech_&&this.unloadTech_();var i=$e(e),r=e.charAt(0).toLowerCase()+e.slice(1);"Html5"!==i&&this.tag&&(Wi.getTech("Html5").disposeMediaElement(this.tag),this.tag.player=null,this.tag=null),this.techName_=i,this.isReady_=!1;var a={source:t,autoplay:"string"!=typeof this.autoplay()&&this.autoplay(),nativeControlsForTouch:this.options_.nativeControlsForTouch,playerId:this.id(),techId:this.id()+"_"+r+"_api",playsinline:this.options_.playsinline,preload:this.options_.preload,loop:this.options_.loop,muted:this.options_.muted,poster:this.poster(),language:this.language(),playerElIngest:this.playerElIngest_||!1,"vtt.js":this.options_["vtt.js"],canOverridePoster:!!this.options_.techCanOverridePoster,enableSourceset:this.options_.enableSourceset,Promise:this.options_.Promise};vi.names.forEach(function(e){var t=vi[e];a[t.getterName]=n[t.privateName]}),v(a,this.options_[i]),v(a,this.options_[r]),v(a,this.options_[e.toLowerCase()]),this.tag&&(a.tag=this.tag),t&&t.src===this.cache_.src&&this.cache_.currentTime>0&&(a.startTime=this.cache_.currentTime);var o=Wi.getTech(e);if(!o)throw new Error("No Tech named '"+i+"' exists! '"+i+"' should be registered using videojs.registerTech()'");this.tech_=new o(a),this.tech_.ready(Ee(this,this.handleTechReady_),!0),kt(this.textTracksJson_||[],this.tech_),Ba.forEach(function(e){n.on(n.tech_,e,n["handleTech"+$e(e)+"_"])}),Object.keys(Fa).forEach(function(e){n.on(n.tech_,e,function(t){0===n.tech_.playbackRate()&&n.tech_.seeking()?n.queuedCallbacks_.push({callback:n["handleTech"+Fa[e]+"_"].bind(n),event:t}):n["handleTech"+Fa[e]+"_"](t)})}),this.on(this.tech_,"loadstart",this.handleTechLoadStart_),this.on(this.tech_,"sourceset",this.handleTechSourceset_),this.on(this.tech_,"waiting",this.handleTechWaiting_),this.on(this.tech_,"ended",this.handleTechEnded_),this.on(this.tech_,"seeking",this.handleTechSeeking_),this.on(this.tech_,"play",this.handleTechPlay_),this.on(this.tech_,"firstplay",this.handleTechFirstPlay_),this.on(this.tech_,"pause",this.handleTechPause_),this.on(this.tech_,"durationchange",this.handleTechDurationChange_),this.on(this.tech_,"fullscreenchange",this.handleTechFullscreenChange_),this.on(this.tech_,"enterpictureinpicture",this.handleTechEnterPictureInPicture_),this.on(this.tech_,"leavepictureinpicture",this.handleTechLeavePictureInPicture_),this.on(this.tech_,"error",this.handleTechError_),this.on(this.tech_,"loadedmetadata",this.updateStyleEl_),this.on(this.tech_,"posterchange",this.handleTechPosterChange_),this.on(this.tech_,"textdata",this.handleTechTextData_),this.on(this.tech_,"ratechange",this.handleTechRateChange_),this.usingNativeControls(this.techGet_("controls")),this.controls()&&!this.usingNativeControls()&&this.addTechControlsListeners_(),this.tech_.el().parentNode===this.el()||"Html5"===i&&this.tag||R(this.tech_.el(),this.el()),this.tag&&(this.tag.player=null,this.tag=null)},s.unloadTech_=function(){var e=this;vi.names.forEach(function(t){var n=vi[t];e[n.privateName]=e[n.getterName]()}),this.textTracksJson_=wt(this.tech_),this.isReady_=!1,this.tech_.dispose(),this.tech_=!1,this.isPosterFromTech_&&(this.poster_="",this.trigger("posterchange")),this.isPosterFromTech_=!1},s.tech=function(e){return void 0===e&&c.warn(p(ja())),this.tech_},s.addTechControlsListeners_=function(){this.removeTechControlsListeners_(),this.on(this.tech_,"mouseup",this.handleTechClick_),this.on(this.tech_,"dblclick",this.handleTechDoubleClick_),this.on(this.tech_,"touchstart",this.handleTechTouchStart_),this.on(this.tech_,"touchmove",this.handleTechTouchMove_),this.on(this.tech_,"touchend",this.handleTechTouchEnd_),this.on(this.tech_,"tap",this.handleTechTap_)},s.removeTechControlsListeners_=function(){this.off(this.tech_,"tap",this.handleTechTap_),this.off(this.tech_,"touchstart",this.handleTechTouchStart_),this.off(this.tech_,"touchmove",this.handleTechTouchMove_),this.off(this.tech_,"touchend",this.handleTechTouchEnd_),this.off(this.tech_,"mouseup",this.handleTechClick_),this.off(this.tech_,"dblclick",this.handleTechDoubleClick_)},s.handleTechReady_=function(){this.triggerReady(),this.cache_.volume&&this.techCall_("setVolume",this.cache_.volume),this.handleTechPosterChange_(),this.handleTechDurationChange_()},s.handleTechLoadStart_=function(){this.removeClass("vjs-ended"),this.removeClass("vjs-seeking"),this.error(null),this.handleTechDurationChange_(),this.paused()?(this.hasStarted(!1),this.trigger("loadstart")):(this.trigger("loadstart"),this.trigger("firstplay")),this.manualAutoplay_(this.autoplay())},s.manualAutoplay_=function(e){var t=this;if(this.tech_&&"string"==typeof e){var n,i=function(){var e=t.muted();t.muted(!0);var n=function(){t.muted(e)};t.playTerminatedQueue_.push(n);var i=t.play();if(Tt(i))return i.catch(n)};if("any"===e&&!0!==this.muted()?Tt(n=this.play())&&(n=n.catch(i)):n="muted"===e&&!0!==this.muted()?i():this.play(),Tt(n))return n.then(function(){t.trigger({type:"autoplay-success",autoplay:e})}).catch(function(n){t.trigger({type:"autoplay-failure",autoplay:e})})}},s.updateSourceCaches_=function(e){void 0===e&&(e="");var t=e,n="";"string"!=typeof t&&(t=e.src,n=e.type),this.cache_.source=this.cache_.source||{},this.cache_.sources=this.cache_.sources||[],t&&!n&&(n=function(e,t){if(!t)return"";if(e.cache_.source.src===t&&e.cache_.source.type)return e.cache_.source.type;var n=e.cache_.sources.filter(function(e){return e.src===t});if(n.length)return n[0].type;for(var i=e.$$("source"),r=0;r<i.length;r++){var a=i[r];if(a.type&&a.src&&a.src===t)return a.type}return ir(t)}(this,t)),this.cache_.source=je({},e,{src:t,type:n});for(var i=this.cache_.sources.filter(function(e){return e.src&&e.src===t}),r=[],a=this.$$("source"),o=[],s=0;s<a.length;s++){var l=M(a[s]);r.push(l),l.src&&l.src===t&&o.push(l.src)}o.length&&!i.length?this.cache_.sources=r:i.length||(this.cache_.sources=[this.cache_.source]),this.cache_.src=t},s.handleTechSourceset_=function(e){var t=this;if(!this.changingSrc_){var n=function(e){return t.updateSourceCaches_(e)},i=this.currentSource().src,r=e.src;i&&!/^blob:/.test(i)&&/^blob:/.test(r)&&(!this.lastSource_||this.lastSource_.tech!==r&&this.lastSource_.player!==i)&&(n=function(){}),n(r),e.src||this.tech_.any(["sourceset","loadstart"],function(e){if("sourceset"!==e.type){var n=t.techGet("currentSrc");t.lastSource_.tech=n,t.updateSourceCaches_(n)}})}this.lastSource_={player:this.currentSource().src,tech:e.src},this.trigger({src:e.src,type:"sourceset"})},s.hasStarted=function(e){if(void 0===e)return this.hasStarted_;e!==this.hasStarted_&&(this.hasStarted_=e,this.hasStarted_?(this.addClass("vjs-has-started"),this.trigger("firstplay")):this.removeClass("vjs-has-started"))},s.handleTechPlay_=function(){this.removeClass("vjs-ended"),this.removeClass("vjs-paused"),this.addClass("vjs-playing"),this.hasStarted(!0),this.trigger("play")},s.handleTechRateChange_=function(){this.tech_.playbackRate()>0&&0===this.cache_.lastPlaybackRate&&(this.queuedCallbacks_.forEach(function(e){return e.callback(e.event)}),this.queuedCallbacks_=[]),this.cache_.lastPlaybackRate=this.tech_.playbackRate(),this.trigger("ratechange")},s.handleTechWaiting_=function(){var e=this;this.addClass("vjs-waiting"),this.trigger("waiting");var t=this.currentTime();this.on("timeupdate",function n(){t!==e.currentTime()&&(e.removeClass("vjs-waiting"),e.off("timeupdate",n))})},s.handleTechCanPlay_=function(){this.removeClass("vjs-waiting"),this.trigger("canplay")},s.handleTechCanPlayThrough_=function(){this.removeClass("vjs-waiting"),this.trigger("canplaythrough")},s.handleTechPlaying_=function(){this.removeClass("vjs-waiting"),this.trigger("playing")},s.handleTechSeeking_=function(){this.addClass("vjs-seeking"),this.trigger("seeking")},s.handleTechSeeked_=function(){this.removeClass("vjs-seeking"),this.removeClass("vjs-ended"),this.trigger("seeked")},s.handleTechFirstPlay_=function(){this.options_.starttime&&(c.warn("Passing the `starttime` option to the player will be deprecated in 6.0"),this.currentTime(this.options_.starttime)),this.addClass("vjs-has-started"),this.trigger("firstplay")},s.handleTechPause_=function(){this.removeClass("vjs-playing"),this.addClass("vjs-paused"),this.trigger("pause")},s.handleTechEnded_=function(){this.addClass("vjs-ended"),this.options_.loop?(this.currentTime(0),this.play()):this.paused()||this.pause(),this.trigger("ended")},s.handleTechDurationChange_=function(){this.duration(this.techGet_("duration"))},s.handleTechClick_=function(e){Y(e)&&this.controls_&&(this.paused()?Et(this.play()):this.pause())},s.handleTechDoubleClick_=function(e){this.controls_&&(Array.prototype.some.call(this.$$(".vjs-control-bar, .vjs-modal-dialog"),function(t){return t.contains(e.target)})||void 0!==this.options_&&void 0!==this.options_.userActions&&void 0!==this.options_.userActions.doubleClick&&!1===this.options_.userActions.doubleClick||(void 0!==this.options_&&void 0!==this.options_.userActions&&"function"==typeof this.options_.userActions.doubleClick?this.options_.userActions.doubleClick.call(this,e):this.isFullscreen()?this.exitFullscreen():this.requestFullscreen()))},s.handleTechTap_=function(){this.userActive(!this.userActive())},s.handleTechTouchStart_=function(){this.userWasActive=this.userActive()},s.handleTechTouchMove_=function(){this.userWasActive&&this.reportUserActivity()},s.handleTechTouchEnd_=function(e){e.preventDefault()},s.handleStageClick_=function(){this.reportUserActivity()},s.toggleFullscreenClass_=function(){this.isFullscreen()?this.addClass("vjs-fullscreen"):this.removeClass("vjs-fullscreen")},s.documentFullscreenChange_=function(e){var n=this.el(),i=t[this.fsApi_.fullscreenElement]===n;!i&&n.matches?i=n.matches(":"+this.fsApi_.fullscreen):!i&&n.msMatchesSelector&&(i=n.msMatchesSelector(":"+this.fsApi_.fullscreen)),this.isFullscreen(i),!1===this.isFullscreen()&&ue(t,this.fsApi_.fullscreenchange,this.boundDocumentFullscreenChange_),this.fsApi_.prefixed&&this.trigger("fullscreenchange")},s.handleTechFullscreenChange_=function(e,t){t&&this.isFullscreen(t.isFullscreen),this.trigger("fullscreenchange")},s.togglePictureInPictureClass_=function(){this.isInPictureInPicture()?this.addClass("vjs-picture-in-picture"):this.removeClass("vjs-picture-in-picture")},s.handleTechEnterPictureInPicture_=function(e){this.isInPictureInPicture(!0)},s.handleTechLeavePictureInPicture_=function(e){this.isInPictureInPicture(!1)},s.handleTechError_=function(){var e=this.tech_.error();this.error(e)},s.handleTechTextData_=function(){var e=null;arguments.length>1&&(e=arguments[1]),this.trigger("textdata",e)},s.getCache=function(){return this.cache_},s.resetCache_=function(){this.cache_={currentTime:0,inactivityTimeout:this.options_.inactivityTimeout,duration:NaN,lastVolume:1,lastPlaybackRate:this.defaultPlaybackRate(),media:null,src:"",source:{},sources:[],volume:1}},s.techCall_=function(e,t){this.ready(function(){if(e in Zi)return function(e,t,n,i){return t[n](e.reduce(tr(n),i))}(this.middleware_,this.tech_,e,t);if(e in er)return Qi(this.middleware_,this.tech_,e,t);try{this.tech_&&this.tech_[e](t)}catch(e){throw c(e),e}},!0)},s.techGet_=function(e){if(this.tech_&&this.tech_.isReady_){if(e in Ji)return function(e,t,n){return e.reduceRight(tr(n),t[n]())}(this.middleware_,this.tech_,e);if(e in er)return Qi(this.middleware_,this.tech_,e);try{return this.tech_[e]()}catch(t){if(void 0===this.tech_[e])throw c("Video.js: "+e+" method not defined for "+this.techName_+" playback technology.",t),t;if("TypeError"===t.name)throw c("Video.js: "+e+" unavailable on "+this.techName_+" playback technology element.",t),this.tech_.isReady_=!1,t;throw c(t),t}}},s.play=function(){var t=this,n=this.options_.Promise||e.Promise;return n?new n(function(e){t.play_(e)}):this.play_()},s.play_=function(e){var t=this;void 0===e&&(e=Et),this.playCallbacks_.push(e);var n=Boolean(!this.changingSrc_&&(this.src()||this.currentSrc()));if(this.waitToPlay_&&(this.off(["ready","loadstart"],this.waitToPlay_),this.waitToPlay_=null),!this.isReady_||!n)return this.waitToPlay_=function(e){t.play_()},this.one(["ready","loadstart"],this.waitToPlay_),void(n||!at&&!Ge||this.load());var i=this.techGet_("play");null===i?this.runPlayTerminatedQueue_():this.runPlayCallbacks_(i)},s.runPlayTerminatedQueue_=function(){var e=this.playTerminatedQueue_.slice(0);this.playTerminatedQueue_=[],e.forEach(function(e){e()})},s.runPlayCallbacks_=function(e){var t=this.playCallbacks_.slice(0);this.playCallbacks_=[],this.playTerminatedQueue_=[],t.forEach(function(t){t(e)})},s.pause=function(){this.techCall_("pause")},s.paused=function(){return!1!==this.techGet_("paused")},s.played=function(){return this.techGet_("played")||dt(0,0)},s.scrubbing=function(e){if(void 0===e)return this.scrubbing_;this.scrubbing_=!!e,e?this.addClass("vjs-scrubbing"):this.removeClass("vjs-scrubbing")},s.currentTime=function(e){return void 0!==e?(e<0&&(e=0),void this.techCall_("setCurrentTime",e)):(this.cache_.currentTime=this.techGet_("currentTime")||0,this.cache_.currentTime)},s.duration=function(e){if(void 0===e)return void 0!==this.cache_.duration?this.cache_.duration:NaN;(e=parseFloat(e))<0&&(e=1/0),e!==this.cache_.duration&&(this.cache_.duration=e,e===1/0?(this.addClass("vjs-live"),this.options_.liveui&&this.player_.liveTracker&&this.addClass("vjs-liveui")):(this.removeClass("vjs-live"),this.removeClass("vjs-liveui")),isNaN(e)||this.trigger("durationchange"))},s.remainingTime=function(){return this.duration()-this.currentTime()},s.remainingTimeDisplay=function(){return Math.floor(this.duration())-Math.floor(this.currentTime())},s.buffered=function(){var e=this.techGet_("buffered");return e&&e.length||(e=dt(0,0)),e},s.bufferedPercent=function(){return ht(this.buffered(),this.duration())},s.bufferedEnd=function(){var e=this.buffered(),t=this.duration(),n=e.end(e.length-1);return n>t&&(n=t),n},s.volume=function(e){var t;return void 0!==e?(t=Math.max(0,Math.min(1,parseFloat(e))),this.cache_.volume=t,this.techCall_("setVolume",t),void(t>0&&this.lastVolume_(t))):(t=parseFloat(this.techGet_("volume")),isNaN(t)?1:t)},s.muted=function(e){if(void 0===e)return this.techGet_("muted")||!1;this.techCall_("setMuted",e)},s.defaultMuted=function(e){return void 0!==e?this.techCall_("setDefaultMuted",e):this.techGet_("defaultMuted")||!1},s.lastVolume_=function(e){if(void 0===e||0===e)return this.cache_.lastVolume;this.cache_.lastVolume=e},s.supportsFullScreen=function(){return this.techGet_("supportsFullScreen")||!1},s.isFullscreen=function(e){return void 0!==e?(this.isFullscreen_=!!e,void this.toggleFullscreenClass_()):!!this.isFullscreen_},s.requestFullscreen=function(e){var n;this.isFullscreen(!0),this.fsApi_.requestFullscreen?(le(t,this.fsApi_.fullscreenchange,this.boundDocumentFullscreenChange_),this.fsApi_.prefixed||(n=this.options_.fullscreen&&this.options_.fullscreen.options||{},void 0!==e&&(n=e)),Et(this.el_[this.fsApi_.requestFullscreen](n))):this.tech_.supportsFullScreen()?this.techCall_("enterFullScreen"):(this.enterFullWindow(),this.trigger("fullscreenchange"))},s.exitFullscreen=function(){this.isFullscreen(!1),this.fsApi_.requestFullscreen?Et(t[this.fsApi_.exitFullscreen]()):this.tech_.supportsFullScreen()?this.techCall_("exitFullScreen"):(this.exitFullWindow(),this.trigger("fullscreenchange"))},s.enterFullWindow=function(){this.isFullWindow=!0,this.docOrigOverflow=t.documentElement.style.overflow,le(t,"keydown",this.boundFullWindowOnEscKey_),t.documentElement.style.overflow="hidden",A(t.body,"vjs-full-window"),this.trigger("enterFullWindow")},s.fullWindowOnEscKey=function(e){It.isEventKey(e,"Esc")&&(!0===this.isFullscreen()?this.exitFullscreen():this.exitFullWindow())},s.exitFullWindow=function(){this.isFullWindow=!1,ue(t,"keydown",this.boundFullWindowOnEscKey_),t.documentElement.style.overflow=this.docOrigOverflow,P(t.body,"vjs-full-window"),this.trigger("exitFullWindow")},s.isInPictureInPicture=function(e){return void 0!==e?(this.isInPictureInPicture_=!!e,void this.togglePictureInPictureClass_()):!!this.isInPictureInPicture_},s.requestPictureInPicture=function(){if("pictureInPictureEnabled"in t)return this.techGet_("requestPictureInPicture")},s.exitPictureInPicture=function(){if("pictureInPictureEnabled"in t)return t.exitPictureInPicture()},s.handleKeyDown=function(e){var t,n,i=this.options_.userActions;i&&i.hotkeys&&(("input"===(n=(t=this.el_.ownerDocument.activeElement).tagName.toLowerCase())?-1===["button","checkbox","hidden","radio","reset","submit"].indexOf(t.type):-1!==["textarea"].indexOf(n))||("function"==typeof i.hotkeys?i.hotkeys.call(this,e):this.handleHotkeys(e)))},s.handleHotkeys=function(e){var n=this.options_.userActions?this.options_.userActions.hotkeys:{},i=n.fullscreenKey,r=void 0===i?function(e){return It.isEventKey(e,"f")}:i,a=n.muteKey,o=void 0===a?function(e){return It.isEventKey(e,"m")}:a,s=n.playPauseKey,l=void 0===s?function(e){return It.isEventKey(e,"k")||It.isEventKey(e,"Space")}:s;if(r.call(this,e)){e.preventDefault(),e.stopPropagation();var u=Be.getComponent("FullscreenToggle");!1!==t[this.fsApi_.fullscreenEnabled]&&u.prototype.handleClick.call(this,e)}else if(o.call(this,e)){e.preventDefault(),e.stopPropagation(),Be.getComponent("MuteToggle").prototype.handleClick.call(this,e)}else if(l.call(this,e)){e.preventDefault(),e.stopPropagation(),Be.getComponent("PlayToggle").prototype.handleClick.call(this,e)}},s.canPlayType=function(e){for(var t,n=0,i=this.options_.techOrder;n<i.length;n++){var r=i[n],a=Wi.getTech(r);if(a||(a=Be.getComponent(r)),a){if(a.isSupported()&&(t=a.canPlayType(e)))return t}else c.error('The "'+r+'" tech is undefined. Skipped browser support check for that tech.')}return""},s.selectSource=function(e){var t,n=this,i=this.options_.techOrder.map(function(e){return[e,Wi.getTech(e)]}).filter(function(e){var t=e[0],n=e[1];return n?n.isSupported():(c.error('The "'+t+'" tech is undefined. Skipped browser support check for that tech.'),!1)}),r=function(e,t,n){var i;return e.some(function(e){return t.some(function(t){if(i=n(e,t))return!0})}),i},a=function(e,t){var i=e[0];if(e[1].canPlaySource(t,n.options_[i.toLowerCase()]))return{source:t,tech:i}};return(this.options_.sourceOrder?r(e,i,(t=a,function(e,n){return t(n,e)})):r(i,e,a))||!1},s.src=function(e){var t=this;if(void 0===e)return this.cache_.src||"";var n=function e(t){if(Array.isArray(t)){var n=[];t.forEach(function(t){t=e(t),Array.isArray(t)?n=n.concat(t):y(t)&&n.push(t)}),t=n}else t="string"==typeof t&&t.trim()?[rr({src:t})]:y(t)&&"string"==typeof t.src&&t.src&&t.src.trim()?[rr(t)]:[];return t}(e);n.length?(this.changingSrc_=!0,this.cache_.sources=n,this.updateSourceCaches_(n[0]),function(e,t,n){e.setTimeout(function(){return function e(t,n,i,r,a,o){void 0===t&&(t={}),void 0===n&&(n=[]),void 0===a&&(a=[]),void 0===o&&(o=!1);var s=n,l=s[0],u=s.slice(1);if("string"==typeof l)e(t,Gi[l],i,r,a,o);else if(l){var c=function(e,t){var n=Xi[e.id()],i=null;if(void 0===n||null===n)return i=t(e),Xi[e.id()]=[[t,i]],i;for(var r=0;r<n.length;r++){var a=n[r],o=a[0],s=a[1];o===t&&(i=s)}return null===i&&(i=t(e),n.push([t,i])),i}(r,l);if(!c.setSource)return a.push(c),e(t,u,i,r,a,o);c.setSource(v({},t),function(n,s){if(n)return e(t,u,i,r,a,o);a.push(c),e(s,t.type===s.type?u:Gi[s.type],i,r,a,o)})}else u.length?e(t,u,i,r,a,o):o?i(t,a):e(t,Gi["*"],i,r,a,!0)}(t,Gi[t.type],n,e)},1)}(this,n[0],function(e,i){var r,a;if(t.middleware_=i,t.cache_.sources=n,t.updateSourceCaches_(e),t.src_(e))return n.length>1?t.src(n.slice(1)):(t.changingSrc_=!1,t.setTimeout(function(){this.error({code:4,message:this.localize(this.options_.notSupportedMessage)})},0),void t.triggerReady());r=i,a=t.tech_,r.forEach(function(e){return e.setTech&&e.setTech(a)})})):this.setTimeout(function(){this.error({code:4,message:this.localize(this.options_.notSupportedMessage)})},0)},s.src_=function(e){var t,n,i=this,r=this.selectSource([e]);return!r||(t=r.tech,n=this.techName_,$e(t)!==$e(n)?(this.changingSrc_=!0,this.loadTech_(r.tech,r.source),this.tech_.ready(function(){i.changingSrc_=!1}),!1):(this.ready(function(){this.tech_.constructor.prototype.hasOwnProperty("setSource")?this.techCall_("setSource",e):this.techCall_("src",e.src),this.changingSrc_=!1},!0),!1))},s.load=function(){this.techCall_("load")},s.reset=function(){var t=this,n=this.options_.Promise||e.Promise;this.paused()||!n?this.doReset_():Et(this.play().then(function(){return t.doReset_()}))},s.doReset_=function(){this.tech_&&this.tech_.clearTracks("text"),this.resetCache_(),this.poster(""),this.loadTech_(this.options_.techOrder[0],null),this.techCall_("reset"),this.resetControlBarUI_(),Se(this)&&this.trigger("playerreset")},s.resetControlBarUI_=function(){this.resetProgressBar_(),this.resetPlaybackRate_(),this.resetVolumeBar_()},s.resetProgressBar_=function(){this.currentTime(0);var e=this.controlBar,t=e.durationDisplay,n=e.remainingTimeDisplay;t&&t.updateContent(),n&&n.updateContent()},s.resetPlaybackRate_=function(){this.playbackRate(this.defaultPlaybackRate()),this.handleTechRateChange_()},s.resetVolumeBar_=function(){this.volume(1),this.trigger("volumechange")},s.currentSources=function(){var e=this.currentSource(),t=[];return 0!==Object.keys(e).length&&t.push(e),this.cache_.sources||t},s.currentSource=function(){return this.cache_.source||{}},s.currentSrc=function(){return this.currentSource()&&this.currentSource().src||""},s.currentType=function(){return this.currentSource()&&this.currentSource().type||""},s.preload=function(e){return void 0!==e?(this.techCall_("setPreload",e),void(this.options_.preload=e)):this.techGet_("preload")},s.autoplay=function(e){if(void 0===e)return this.options_.autoplay||!1;var t;"string"==typeof e&&/(any|play|muted)/.test(e)?(this.options_.autoplay=e,this.manualAutoplay_(e),t=!1):this.options_.autoplay=!!e,t=void 0===t?this.options_.autoplay:t,this.tech_&&this.techCall_("setAutoplay",t)},s.playsinline=function(e){return void 0!==e?(this.techCall_("setPlaysinline",e),this.options_.playsinline=e,this):this.techGet_("playsinline")},s.loop=function(e){return void 0!==e?(this.techCall_("setLoop",e),void(this.options_.loop=e)):this.techGet_("loop")},s.poster=function(e){if(void 0===e)return this.poster_;e||(e=""),e!==this.poster_&&(this.poster_=e,this.techCall_("setPoster",e),this.isPosterFromTech_=!1,this.trigger("posterchange"))},s.handleTechPosterChange_=function(){if((!this.poster_||this.options_.techCanOverridePoster)&&this.tech_&&this.tech_.poster){var e=this.tech_.poster()||"";e!==this.poster_&&(this.poster_=e,this.isPosterFromTech_=!0,this.trigger("posterchange"))}},s.controls=function(e){if(void 0===e)return!!this.controls_;e=!!e,this.controls_!==e&&(this.controls_=e,this.usingNativeControls()&&this.techCall_("setControls",e),this.controls_?(this.removeClass("vjs-controls-disabled"),this.addClass("vjs-controls-enabled"),this.trigger("controlsenabled"),this.usingNativeControls()||this.addTechControlsListeners_()):(this.removeClass("vjs-controls-enabled"),this.addClass("vjs-controls-disabled"),this.trigger("controlsdisabled"),this.usingNativeControls()||this.removeTechControlsListeners_()))},s.usingNativeControls=function(e){if(void 0===e)return!!this.usingNativeControls_;e=!!e,this.usingNativeControls_!==e&&(this.usingNativeControls_=e,this.usingNativeControls_?(this.addClass("vjs-using-native-controls"),this.trigger("usingnativecontrols")):(this.removeClass("vjs-using-native-controls"),this.trigger("usingcustomcontrols")))},s.error=function(e){if(void 0===e)return this.error_||null;if(this.options_.suppressNotSupportedError&&e&&e.message&&e.message===this.localize(this.options_.notSupportedMessage)){var t=function(){this.error(e)};return this.options_.suppressNotSupportedError=!1,this.any(["click","touchstart"],t),void this.one("loadstart",function(){this.off(["click","touchstart"],t)})}if(null===e)return this.error_=e,this.removeClass("vjs-error"),void(this.errorDisplay&&this.errorDisplay.close());this.error_=new bt(e),this.addClass("vjs-error"),c.error("(CODE:"+this.error_.code+" "+bt.errorTypes[this.error_.code]+")",this.error_.message,this.error_),this.trigger("error")},s.reportUserActivity=function(e){this.userActivity_=!0},s.userActive=function(e){if(void 0===e)return this.userActive_;if((e=!!e)!==this.userActive_){if(this.userActive_=e,this.userActive_)return this.userActivity_=!0,this.removeClass("vjs-user-inactive"),this.addClass("vjs-user-active"),void this.trigger("useractive");this.tech_&&this.tech_.one("mousemove",function(e){e.stopPropagation(),e.preventDefault()}),this.userActivity_=!1,this.removeClass("vjs-user-active"),this.addClass("vjs-user-inactive"),this.trigger("userinactive")}},s.listenForUserActivity_=function(){var e,t,n,i=Ee(this,this.reportUserActivity);this.on("mousedown",function(){i(),this.clearInterval(e),e=this.setInterval(i,250)}),this.on("mousemove",function(e){e.screenX===t&&e.screenY===n||(t=e.screenX,n=e.screenY,i())}),this.on("mouseup",function(t){i(),this.clearInterval(e)});var r,a=this.getChild("controlBar");!a||Ge||Ye||(a.on("mouseenter",function(e){this.player().cache_.inactivityTimeout=this.player().options_.inactivityTimeout,this.player().options_.inactivityTimeout=0}),a.on("mouseleave",function(e){this.player().options_.inactivityTimeout=this.player().cache_.inactivityTimeout})),this.on("keydown",i),this.on("keyup",i),this.setInterval(function(){if(this.userActivity_){this.userActivity_=!1,this.userActive(!0),this.clearTimeout(r);var e=this.options_.inactivityTimeout;e<=0||(r=this.setTimeout(function(){this.userActivity_||this.userActive(!1)},e))}},250)},s.playbackRate=function(e){if(void 0===e)return this.tech_&&this.tech_.featuresPlaybackRate?this.cache_.lastPlaybackRate||this.techGet_("playbackRate"):1;this.techCall_("setPlaybackRate",e)},s.defaultPlaybackRate=function(e){return void 0!==e?this.techCall_("setDefaultPlaybackRate",e):this.tech_&&this.tech_.featuresPlaybackRate?this.techGet_("defaultPlaybackRate"):1},s.isAudio=function(e){if(void 0===e)return!!this.isAudio_;this.isAudio_=!!e},s.addTextTrack=function(e,t,n){if(this.tech_)return this.tech_.addTextTrack(e,t,n)},s.addRemoteTextTrack=function(e,t){if(this.tech_)return this.tech_.addRemoteTextTrack(e,t)},s.removeRemoteTextTrack=function(e){void 0===e&&(e={});var t=e.track;if(t||(t=e),this.tech_)return this.tech_.removeRemoteTextTrack(t)},s.getVideoPlaybackQuality=function(){return this.techGet_("getVideoPlaybackQuality")},s.videoWidth=function(){return this.tech_&&this.tech_.videoWidth&&this.tech_.videoWidth()||0},s.videoHeight=function(){return this.tech_&&this.tech_.videoHeight&&this.tech_.videoHeight()||0},s.language=function(e){if(void 0===e)return this.language_;this.language_=String(e).toLowerCase()},s.languages=function(){return je(a.prototype.options_.languages,this.languages_)},s.toJSON=function(){var e=je(this.options_),t=e.tracks;e.tracks=[];for(var n=0;n<t.length;n++){var i=t[n];(i=je(i)).player=void 0,e.tracks[n]=i}return e},s.createModal=function(e,t){var n=this;(t=t||{}).content=e||"";var i=new Dt(this,t);return this.addChild(i),i.on("dispose",function(){n.removeChild(i)}),i.open(),i},s.updateCurrentBreakpoint_=function(){if(this.responsive())for(var e=this.currentBreakpoint(),t=this.currentWidth(),n=0;n<Ua.length;n++){var i=Ua[n];if(t<=this.breakpoints_[i]){if(e===i)return;e&&this.removeClass(Va[e]),this.addClass(Va[i]),this.breakpoint_=i;break}}},s.removeCurrentBreakpoint_=function(){var e=this.currentBreakpointClass();this.breakpoint_="",e&&this.removeClass(e)},s.breakpoints=function(e){return void 0===e?v(this.breakpoints_):(this.breakpoint_="",this.breakpoints_=v({},qa,e),this.updateCurrentBreakpoint_(),v(this.breakpoints_))},s.responsive=function(e){return void 0===e?this.responsive_:(e=Boolean(e))!==this.responsive_?(this.responsive_=e,e?(this.on("playerresize",this.updateCurrentBreakpoint_),this.updateCurrentBreakpoint_()):(this.off("playerresize",this.updateCurrentBreakpoint_),this.removeCurrentBreakpoint_()),e):void 0},s.currentBreakpoint=function(){return this.breakpoint_},s.currentBreakpointClass=function(){return Va[this.breakpoint_]||""},s.loadMedia=function(e,t){var n=this;if(e&&"object"==typeof e){this.reset(),this.cache_.media=je(e);var i=this.cache_.media,r=i.artwork,a=i.poster,o=i.src,s=i.textTracks;!r&&a&&(this.cache_.media.artwork=[{src:a,type:ir(a)}]),o&&this.src(o),a&&this.poster(a),Array.isArray(s)&&s.forEach(function(e){return n.addRemoteTextTrack(e,!1)}),this.ready(t)}},s.getMedia=function(){if(!this.cache_.media){var e=this.poster(),t={src:this.currentSources(),textTracks:Array.prototype.map.call(this.remoteTextTracks(),function(e){return{kind:e.kind,label:e.label,language:e.language,src:e.src}})};return e&&(t.poster=e,t.artwork=[{src:t.poster,type:ir(t.poster)}]),t}return je(this.cache_.media)},a.getTagSettings=function(e){var t={sources:[],tracks:[]},n=M(e),i=n["data-setup"];if(x(e,"vjs-fill")&&(n.fill=!0),x(e,"vjs-fluid")&&(n.fluid=!0),null!==i){var r=function(e,t){var n,i=null;try{n=JSON.parse(e,t)}catch(e){i=e}return[i,n]}(i||"{}"),a=r[0],o=r[1];a&&c.error(a),v(n,o)}if(v(t,n),e.hasChildNodes())for(var s=e.childNodes,l=0,u=s.length;l<u;l++){var d=s[l],h=d.nodeName.toLowerCase();"source"===h?t.sources.push(M(d)):"track"===h&&t.tracks.push(M(d))}return t},s.flexNotSupported_=function(){var e=t.createElement("i");return!("flexBasis"in e.style||"webkitFlexBasis"in e.style||"mozFlexBasis"in e.style||"msFlexBasis"in e.style||"msFlexOrder"in e.style)},a}(Be);vi.names.forEach(function(e){var t=vi[e];Ha.prototype[t.getterName]=function(){return this.tech_?this.tech_[t.getterName]():(this[t.privateName]=this[t.privateName]||new t.ListClass,this[t.privateName])}}),Ha.players={};var za=e.navigator;Ha.prototype.options_={techOrder:Wi.defaultTechOrder_,html5:{},flash:{},inactivityTimeout:2e3,playbackRates:[],liveui:!1,children:["mediaLoader","posterImage","textTrackDisplay","loadingSpinner","bigPlayButton","liveTracker","controlBar","errorDisplay","textTrackSettings","resizeManager"],language:za&&(za.languages&&za.languages[0]||za.userLanguage||za.language)||"en",languages:{},notSupportedMessage:"No compatible source was found for this media.",fullscreen:{options:{navigationUI:"hide"}},breakpoints:{},responsive:!1},["ended","seeking","seekable","networkState","readyState"].forEach(function(e){Ha.prototype[e]=function(){return this.techGet_(e)}}),Ba.forEach(function(e){Ha.prototype["handleTech"+$e(e)+"_"]=function(){return this.trigger(e)}}),Be.registerComponent("Player",Ha);var Wa={},Ga=function(e){return Wa.hasOwnProperty(e)},Xa=function(e){return Ga(e)?Wa[e]:void 0},Ya=function(e,t){e.activePlugins_=e.activePlugins_||{},e.activePlugins_[t]=!0},Qa=function(e,t,n){var i=(n?"before":"")+"pluginsetup";e.trigger(i,t),e.trigger(i+":"+t.name,t)},Ja=function(e,t){return t.prototype.name=e,function(){Qa(this,{name:e,plugin:t,instance:null},!0);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];var o=a(t,[this].concat(i));return this[e]=function(){return o},Qa(this,o.getEventHash()),o}},Za=function(){function e(t){if(this.constructor===e)throw new Error("Plugin must be sub-classed; not directly instantiated.");this.player=t,Le(this),delete this.trigger,Me(this,this.constructor.defaultState),Ya(t,this.name),this.dispose=Ee(this,this.dispose),t.on("dispose",this.dispose)}var t=e.prototype;return t.version=function(){return this.constructor.VERSION},t.getEventHash=function(e){return void 0===e&&(e={}),e.name=this.name,e.plugin=this.constructor,e.instance=this,e},t.trigger=function(e,t){return void 0===t&&(t={}),ce(this.eventBusEl_,e,this.getEventHash(t))},t.handleStateChanged=function(e){},t.dispose=function(){var e=this.name,t=this.player;this.trigger("dispose"),this.off(),t.off("dispose",this.dispose),t.activePlugins_[e]=!1,this.player=this.state=null,t[e]=Ja(e,Wa[e])},e.isBasic=function(t){var n="string"==typeof t?Xa(t):t;return"function"==typeof n&&!e.prototype.isPrototypeOf(n.prototype)},e.registerPlugin=function(t,n){if("string"!=typeof t)throw new Error('Illegal plugin name, "'+t+'", must be a string, was '+typeof t+".");if(Ga(t))c.warn('A plugin named "'+t+'" already exists. You may want to avoid re-registering plugins!');else if(Ha.prototype.hasOwnProperty(t))throw new Error('Illegal plugin name, "'+t+'", cannot share a name with an existing player method!');if("function"!=typeof n)throw new Error('Illegal plugin for "'+t+'", must be a function, was '+typeof n+".");return Wa[t]=n,"plugin"!==t&&(e.isBasic(n)?Ha.prototype[t]=function(e,t){var n=function(){Qa(this,{name:e,plugin:t,instance:null},!0);var n=t.apply(this,arguments);return Ya(this,e),Qa(this,{name:e,plugin:t,instance:n}),n};return Object.keys(t).forEach(function(e){n[e]=t[e]}),n}(t,n):Ha.prototype[t]=Ja(t,n)),n},e.deregisterPlugin=function(e){if("plugin"===e)throw new Error("Cannot de-register base plugin.");Ga(e)&&(delete Wa[e],delete Ha.prototype[e])},e.getPlugins=function(e){var t;return void 0===e&&(e=Object.keys(Wa)),e.forEach(function(e){var n=Xa(e);n&&((t=t||{})[e]=n)}),t},e.getPluginVersion=function(e){var t=Xa(e);return t&&t.VERSION||""},e}();Za.getPlugin=Xa,Za.BASE_PLUGIN_NAME="plugin",Za.registerPlugin("plugin",Za),Ha.prototype.usingPlugin=function(e){return!!this.activePlugins_&&!0===this.activePlugins_[e]},Ha.prototype.hasPlugin=function(e){return!!Ga(e)};var eo=function(e){return 0===e.indexOf("#")?e.slice(1):e};function to(e,t,n){var i=to.getPlayer(e);if(i)return t&&c.warn('Player "'+e+'" is already initialised. Options will not be applied.'),n&&i.ready(n),i;var r="string"==typeof e?Q("#"+eo(e)):e;if(!k(r))throw new TypeError("The element or ID supplied is not valid. (videojs)");r.ownerDocument.defaultView&&r.ownerDocument.body.contains(r)||c.warn("The element supplied is not included in the DOM"),t=t||{},to.hooks("beforesetup").forEach(function(e){var n=e(r,je(t));y(n)&&!Array.isArray(n)?t=je(t,n):c.error("please return an object in beforesetup hooks")});var a=Be.getComponent("Player");return i=new a(r,t,n),to.hooks("setup").forEach(function(e){return e(i)}),i}if(to.hooks_={},to.hooks=function(e,t){return to.hooks_[e]=to.hooks_[e]||[],t&&(to.hooks_[e]=to.hooks_[e].concat(t)),to.hooks_[e]},to.hook=function(e,t){to.hooks(e,t)},to.hookOnce=function(e,t){to.hooks(e,[].concat(t).map(function(t){return function n(){return to.removeHook(e,n),t.apply(void 0,arguments)}}))},to.removeHook=function(e,t){var n=to.hooks(e).indexOf(t);return!(n<=-1||(to.hooks_[e]=to.hooks_[e].slice(),to.hooks_[e].splice(n,1),0))},!0!==e.VIDEOJS_NO_DYNAMIC_STYLE&&w()){var no=Q(".vjs-styles-defaults");if(!no){no=be("vjs-styles-defaults");var io=Q("head");io&&io.insertBefore(no,io.firstChild),_e(no,"\n      .video-js {\n        width: 300px;\n        height: 150px;\n      }\n\n      .vjs-fluid {\n        padding-top: 56.25%\n      }\n    ")}}ve(1,to),to.VERSION=n,to.options=Ha.prototype.options_,to.getPlayers=function(){return Ha.players},to.getPlayer=function(e){var t,n=Ha.players;if("string"==typeof e){var i=eo(e),r=n[i];if(r)return r;t=Q("#"+i)}else t=e;if(k(t)){var a=t,o=a.player,s=a.playerId;if(o||n[s])return o||n[s]}},to.getAllPlayers=function(){return Object.keys(Ha.players).map(function(e){return Ha.players[e]}).filter(Boolean)},to.players=Ha.players,to.getComponent=Be.getComponent,to.registerComponent=function(e,t){Wi.isTech(t)&&c.warn("The "+e+" tech was registered as a component. It should instead be registered using videojs.registerTech(name, tech)"),Be.registerComponent.call(Be,e,t)},to.getTech=Wi.getTech,to.registerTech=Wi.registerTech,to.use=function(e,t){Gi[e]=Gi[e]||[],Gi[e].push(t)},Object.defineProperty(to,"middleware",{value:{},writeable:!1,enumerable:!0}),Object.defineProperty(to.middleware,"TERMINATOR",{value:Yi,writeable:!1,enumerable:!0}),to.browser=lt,to.TOUCH_ENABLED=st,to.extend=function(e,t){void 0===t&&(t={});var n=function(){e.apply(this,arguments)},i={};for(var r in"object"==typeof t?(t.constructor!==Object.prototype.constructor&&(n=t.constructor),i=t):"function"==typeof t&&(n=t),function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(e.super_=t)}(n,e),i)i.hasOwnProperty(r)&&(n.prototype[r]=i[r]);return n},to.mergeOptions=je,to.bind=Ee,to.registerPlugin=Za.registerPlugin,to.deregisterPlugin=Za.deregisterPlugin,to.plugin=function(e,t){return c.warn("videojs.plugin() is deprecated; use videojs.registerPlugin() instead"),Za.registerPlugin(e,t)},to.getPlugins=Za.getPlugins,to.getPlugin=Za.getPlugin,to.getPluginVersion=Za.getPluginVersion,to.addLanguage=function(e,t){var n;return e=(""+e).toLowerCase(),to.options.languages=je(to.options.languages,((n={})[e]=t,n)),to.options.languages[e]},to.log=c,to.createLogger=d,to.createTimeRange=to.createTimeRanges=dt,to.formatTime=br,to.setFormatTime=function(e){yr=e},to.resetFormatTime=function(){yr=vr},to.parseUrl=Ht,to.isCrossOrigin=Gt,to.EventTarget=ke,to.on=le,to.one=de,to.off=ue,to.trigger=ce,to.xhr=ii,to.TextTrack=ui,to.AudioTrack=ci,to.VideoTrack=di,["isEl","isTextNode","createEl","hasClass","addClass","removeClass","toggleClass","setAttributes","getAttributes","emptyEl","appendContent","insertContent"].forEach(function(e){to[e]=function(){return c.warn("videojs."+e+"() is deprecated; use videojs.dom."+e+"() instead"),Z[e].apply(null,arguments)}}),to.computedStyle=_,to.dom=Z,to.url=Xt;var ro=St(function(e,t){var n,i,r,a,o;n=/^((?:[a-zA-Z0-9+\-.]+:)?)(\/\/[^\/?#]*)?((?:[^\/\?#]*\/)*.*?)??(;.*?)?(\?.*?)?(#.*?)?$/,i=/^([^\/?#]*)(.*)$/,r=/(?:\/|^)\.(?=\/)/g,a=/(?:\/|^)\.\.\/(?!\.\.\/).*?(?=\/)/g,o={buildAbsoluteURL:function(e,t,n){if(n=n||{},e=e.trim(),!(t=t.trim())){if(!n.alwaysNormalize)return e;var r=o.parseURL(e);if(!r)throw new Error("Error trying to parse base URL.");return r.path=o.normalizePath(r.path),o.buildURLFromParts(r)}var a=o.parseURL(t);if(!a)throw new Error("Error trying to parse relative URL.");if(a.scheme)return n.alwaysNormalize?(a.path=o.normalizePath(a.path),o.buildURLFromParts(a)):t;var s=o.parseURL(e);if(!s)throw new Error("Error trying to parse base URL.");if(!s.netLoc&&s.path&&"/"!==s.path[0]){var l=i.exec(s.path);s.netLoc=l[1],s.path=l[2]}s.netLoc&&!s.path&&(s.path="/");var u={scheme:s.scheme,netLoc:a.netLoc,path:null,params:a.params,query:a.query,fragment:a.fragment};if(!a.netLoc&&(u.netLoc=s.netLoc,"/"!==a.path[0]))if(a.path){var c=s.path,d=c.substring(0,c.lastIndexOf("/")+1)+a.path;u.path=o.normalizePath(d)}else u.path=s.path,a.params||(u.params=s.params,a.query||(u.query=s.query));return null===u.path&&(u.path=n.alwaysNormalize?o.normalizePath(a.path):a.path),o.buildURLFromParts(u)},parseURL:function(e){var t=n.exec(e);return t?{scheme:t[1]||"",netLoc:t[2]||"",path:t[3]||"",params:t[4]||"",query:t[5]||"",fragment:t[6]||""}:null},normalizePath:function(e){for(e=e.split("").reverse().join("").replace(r,"");e.length!==(e=e.replace(a,"")).length;);return e.split("").reverse().join("")},buildURLFromParts:function(e){return e.scheme+e.netLoc+e.path+e.params+e.query+e.fragment}},e.exports=o});
/*! @name m3u8-parser @version 4.3.0 @license Apache-2.0 */function ao(){return(ao=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e}).apply(this,arguments)}function oo(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e.__proto__=t}function so(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var lo,uo,co,ho,po,fo,go,mo,vo,yo,bo,_o,To,Eo,Co,wo,ko,So,Io,Oo,Do,Ro,xo,Ao,Po,Lo,No,Mo,Ko,$o,jo,Bo,Fo,Uo,Vo,qo,Ho,zo,Wo,Go,Xo,Yo,Qo,Jo,Zo,es=function(){function e(){this.listeners={}}var t=e.prototype;return t.on=function(e,t){this.listeners[e]||(this.listeners[e]=[]),this.listeners[e].push(t)},t.off=function(e,t){if(!this.listeners[e])return!1;var n=this.listeners[e].indexOf(t);return this.listeners[e].splice(n,1),n>-1},t.trigger=function(e){var t,n,i,r=this.listeners[e];if(r)if(2===arguments.length)for(n=r.length,t=0;t<n;++t)r[t].call(this,arguments[1]);else for(i=Array.prototype.slice.call(arguments,1),n=r.length,t=0;t<n;++t)r[t].apply(this,i)},t.dispose=function(){this.listeners={}},t.pipe=function(e){this.on("data",function(t){e.push(t)})},e}(),ts=function(e){function t(){var t;return(t=e.call(this)||this).buffer="",t}return oo(t,e),t.prototype.push=function(e){var t;for(this.buffer+=e,t=this.buffer.indexOf("\n");t>-1;t=this.buffer.indexOf("\n"))this.trigger("data",this.buffer.substring(0,t)),this.buffer=this.buffer.substring(t+1)},t}(es),ns=function(e){for(var t,n=e.split(new RegExp('(?:^|,)((?:[^=]*)=(?:"[^"]*"|[^,]*))')),i={},r=n.length;r--;)""!==n[r]&&((t=/([^=]*)=(.*)/.exec(n[r]).slice(1))[0]=t[0].replace(/^\s+|\s+$/g,""),t[1]=t[1].replace(/^\s+|\s+$/g,""),t[1]=t[1].replace(/^['"](.*)['"]$/g,"$1"),i[t[0]]=t[1]);return i},is=function(e){function t(){var t;return(t=e.call(this)||this).customParsers=[],t.tagMappers=[],t}oo(t,e);var n=t.prototype;return n.push=function(e){var t,n,i=this;if(0!==(e=e.trim()).length)if("#"===e[0]){this.tagMappers.reduce(function(t,n){var i=n(e);return i===e?t:t.concat([i])},[e]).forEach(function(e){for(var r=0;r<i.customParsers.length;r++)if(i.customParsers[r].call(i,e))return;if(0===e.indexOf("#EXT"))if(e=e.replace("\r",""),t=/^#EXTM3U/.exec(e))i.trigger("data",{type:"tag",tagType:"m3u"});else{if(t=/^#EXTINF:?([0-9\.]*)?,?(.*)?$/.exec(e))return n={type:"tag",tagType:"inf"},t[1]&&(n.duration=parseFloat(t[1])),t[2]&&(n.title=t[2]),void i.trigger("data",n);if(t=/^#EXT-X-TARGETDURATION:?([0-9.]*)?/.exec(e))return n={type:"tag",tagType:"targetduration"},t[1]&&(n.duration=parseInt(t[1],10)),void i.trigger("data",n);if(t=/^#ZEN-TOTAL-DURATION:?([0-9.]*)?/.exec(e))return n={type:"tag",tagType:"totalduration"},t[1]&&(n.duration=parseInt(t[1],10)),void i.trigger("data",n);if(t=/^#EXT-X-VERSION:?([0-9.]*)?/.exec(e))return n={type:"tag",tagType:"version"},t[1]&&(n.version=parseInt(t[1],10)),void i.trigger("data",n);if(t=/^#EXT-X-MEDIA-SEQUENCE:?(\-?[0-9.]*)?/.exec(e))return n={type:"tag",tagType:"media-sequence"},t[1]&&(n.number=parseInt(t[1],10)),void i.trigger("data",n);if(t=/^#EXT-X-DISCONTINUITY-SEQUENCE:?(\-?[0-9.]*)?/.exec(e))return n={type:"tag",tagType:"discontinuity-sequence"},t[1]&&(n.number=parseInt(t[1],10)),void i.trigger("data",n);if(t=/^#EXT-X-PLAYLIST-TYPE:?(.*)?$/.exec(e))return n={type:"tag",tagType:"playlist-type"},t[1]&&(n.playlistType=t[1]),void i.trigger("data",n);if(t=/^#EXT-X-BYTERANGE:?([0-9.]*)?@?([0-9.]*)?/.exec(e))return n={type:"tag",tagType:"byterange"},t[1]&&(n.length=parseInt(t[1],10)),t[2]&&(n.offset=parseInt(t[2],10)),void i.trigger("data",n);if(t=/^#EXT-X-ALLOW-CACHE:?(YES|NO)?/.exec(e))return n={type:"tag",tagType:"allow-cache"},t[1]&&(n.allowed=!/NO/.test(t[1])),void i.trigger("data",n);if(t=/^#EXT-X-MAP:?(.*)$/.exec(e)){if(n={type:"tag",tagType:"map"},t[1]){var a=ns(t[1]);if(a.URI&&(n.uri=a.URI),a.BYTERANGE){var o=a.BYTERANGE.split("@"),s=o[0],l=o[1];n.byterange={},s&&(n.byterange.length=parseInt(s,10)),l&&(n.byterange.offset=parseInt(l,10))}}i.trigger("data",n)}else if(t=/^#EXT-X-STREAM-INF:?(.*)$/.exec(e)){if(n={type:"tag",tagType:"stream-inf"},t[1]){if(n.attributes=ns(t[1]),n.attributes.RESOLUTION){var u=n.attributes.RESOLUTION.split("x"),c={};u[0]&&(c.width=parseInt(u[0],10)),u[1]&&(c.height=parseInt(u[1],10)),n.attributes.RESOLUTION=c}n.attributes.BANDWIDTH&&(n.attributes.BANDWIDTH=parseInt(n.attributes.BANDWIDTH,10)),n.attributes["PROGRAM-ID"]&&(n.attributes["PROGRAM-ID"]=parseInt(n.attributes["PROGRAM-ID"],10))}i.trigger("data",n)}else{if(t=/^#EXT-X-MEDIA:?(.*)$/.exec(e))return n={type:"tag",tagType:"media"},t[1]&&(n.attributes=ns(t[1])),void i.trigger("data",n);if(t=/^#EXT-X-ENDLIST/.exec(e))i.trigger("data",{type:"tag",tagType:"endlist"});else if(t=/^#EXT-X-DISCONTINUITY/.exec(e))i.trigger("data",{type:"tag",tagType:"discontinuity"});else{if(t=/^#EXT-X-PROGRAM-DATE-TIME:?(.*)$/.exec(e))return n={type:"tag",tagType:"program-date-time"},t[1]&&(n.dateTimeString=t[1],n.dateTimeObject=new Date(t[1])),void i.trigger("data",n);if(t=/^#EXT-X-KEY:?(.*)$/.exec(e))return n={type:"tag",tagType:"key"},t[1]&&(n.attributes=ns(t[1]),n.attributes.IV&&("0x"===n.attributes.IV.substring(0,2).toLowerCase()&&(n.attributes.IV=n.attributes.IV.substring(2)),n.attributes.IV=n.attributes.IV.match(/.{8}/g),n.attributes.IV[0]=parseInt(n.attributes.IV[0],16),n.attributes.IV[1]=parseInt(n.attributes.IV[1],16),n.attributes.IV[2]=parseInt(n.attributes.IV[2],16),n.attributes.IV[3]=parseInt(n.attributes.IV[3],16),n.attributes.IV=new Uint32Array(n.attributes.IV))),void i.trigger("data",n);if(t=/^#EXT-X-START:?(.*)$/.exec(e))return n={type:"tag",tagType:"start"},t[1]&&(n.attributes=ns(t[1]),n.attributes["TIME-OFFSET"]=parseFloat(n.attributes["TIME-OFFSET"]),n.attributes.PRECISE=/YES/.test(n.attributes.PRECISE)),void i.trigger("data",n);if(t=/^#EXT-X-CUE-OUT-CONT:?(.*)?$/.exec(e))return n={type:"tag",tagType:"cue-out-cont"},t[1]?n.data=t[1]:n.data="",void i.trigger("data",n);if(t=/^#EXT-X-CUE-OUT:?(.*)?$/.exec(e))return n={type:"tag",tagType:"cue-out"},t[1]?n.data=t[1]:n.data="",void i.trigger("data",n);if(t=/^#EXT-X-CUE-IN:?(.*)?$/.exec(e))return n={type:"tag",tagType:"cue-in"},t[1]?n.data=t[1]:n.data="",void i.trigger("data",n);i.trigger("data",{type:"tag",data:e.slice(4)})}}}else i.trigger("data",{type:"comment",text:e.slice(1)})})}else this.trigger("data",{type:"uri",uri:e})},n.addParser=function(e){var t=this,n=e.expression,i=e.customType,r=e.dataParser,a=e.segment;"function"!=typeof r&&(r=function(e){return e}),this.customParsers.push(function(e){if(n.exec(e))return t.trigger("data",{type:"custom",data:r(e),customType:i,segment:a}),!0})},n.addTagMapper=function(e){var t=e.expression,n=e.map;this.tagMappers.push(function(e){return t.test(e)?n(e):e})},t}(es),rs=function(e){function t(){var t;(t=e.call(this)||this).lineStream=new ts,t.parseStream=new is,t.lineStream.pipe(t.parseStream);var n,i,r=so(so(t)),a=[],o={},s={AUDIO:{},VIDEO:{},"CLOSED-CAPTIONS":{},SUBTITLES:{}},l=0;return t.manifest={allowCache:!0,discontinuityStarts:[],segments:[]},t.parseStream.on("data",function(e){var t,u;({tag:function(){(({"allow-cache":function(){this.manifest.allowCache=e.allowed,"allowed"in e||(this.trigger("info",{message:"defaulting allowCache to YES"}),this.manifest.allowCache=!0)},byterange:function(){var t={};"length"in e&&(o.byterange=t,t.length=e.length,"offset"in e||(this.trigger("info",{message:"defaulting offset to zero"}),e.offset=0)),"offset"in e&&(o.byterange=t,t.offset=e.offset)},endlist:function(){this.manifest.endList=!0},inf:function(){"mediaSequence"in this.manifest||(this.manifest.mediaSequence=0,this.trigger("info",{message:"defaulting media sequence to zero"})),"discontinuitySequence"in this.manifest||(this.manifest.discontinuitySequence=0,this.trigger("info",{message:"defaulting discontinuity sequence to zero"})),e.duration>0&&(o.duration=e.duration),0===e.duration&&(o.duration=.01,this.trigger("info",{message:"updating zero segment duration to a small value"})),this.manifest.segments=a},key:function(){e.attributes?"NONE"!==e.attributes.METHOD?e.attributes.URI?(e.attributes.METHOD||this.trigger("warn",{message:"defaulting key method to AES-128"}),i={method:e.attributes.METHOD||"AES-128",uri:e.attributes.URI},void 0!==e.attributes.IV&&(i.iv=e.attributes.IV)):this.trigger("warn",{message:"ignoring key declaration without URI"}):i=null:this.trigger("warn",{message:"ignoring key declaration without attribute list"})},"media-sequence":function(){isFinite(e.number)?this.manifest.mediaSequence=e.number:this.trigger("warn",{message:"ignoring invalid media sequence: "+e.number})},"discontinuity-sequence":function(){isFinite(e.number)?(this.manifest.discontinuitySequence=e.number,l=e.number):this.trigger("warn",{message:"ignoring invalid discontinuity sequence: "+e.number})},"playlist-type":function(){/VOD|EVENT/.test(e.playlistType)?this.manifest.playlistType=e.playlistType:this.trigger("warn",{message:"ignoring unknown playlist type: "+e.playlist})},map:function(){n={},e.uri&&(n.uri=e.uri),e.byterange&&(n.byterange=e.byterange)},"stream-inf":function(){this.manifest.playlists=a,this.manifest.mediaGroups=this.manifest.mediaGroups||s,e.attributes?(o.attributes||(o.attributes={}),ao(o.attributes,e.attributes)):this.trigger("warn",{message:"ignoring empty stream-inf attributes"})},media:function(){if(this.manifest.mediaGroups=this.manifest.mediaGroups||s,e.attributes&&e.attributes.TYPE&&e.attributes["GROUP-ID"]&&e.attributes.NAME){var n=this.manifest.mediaGroups[e.attributes.TYPE];n[e.attributes["GROUP-ID"]]=n[e.attributes["GROUP-ID"]]||{},t=n[e.attributes["GROUP-ID"]],(u={default:/yes/i.test(e.attributes.DEFAULT)}).default?u.autoselect=!0:u.autoselect=/yes/i.test(e.attributes.AUTOSELECT),e.attributes.LANGUAGE&&(u.language=e.attributes.LANGUAGE),e.attributes.URI&&(u.uri=e.attributes.URI),e.attributes["INSTREAM-ID"]&&(u.instreamId=e.attributes["INSTREAM-ID"]),e.attributes.CHARACTERISTICS&&(u.characteristics=e.attributes.CHARACTERISTICS),e.attributes.FORCED&&(u.forced=/yes/i.test(e.attributes.FORCED)),t[e.attributes.NAME]=u}else this.trigger("warn",{message:"ignoring incomplete or missing media group"})},discontinuity:function(){l+=1,o.discontinuity=!0,this.manifest.discontinuityStarts.push(a.length)},"program-date-time":function(){void 0===this.manifest.dateTimeString&&(this.manifest.dateTimeString=e.dateTimeString,this.manifest.dateTimeObject=e.dateTimeObject),o.dateTimeString=e.dateTimeString,o.dateTimeObject=e.dateTimeObject},targetduration:function(){!isFinite(e.duration)||e.duration<0?this.trigger("warn",{message:"ignoring invalid target duration: "+e.duration}):this.manifest.targetDuration=e.duration},totalduration:function(){!isFinite(e.duration)||e.duration<0?this.trigger("warn",{message:"ignoring invalid total duration: "+e.duration}):this.manifest.totalDuration=e.duration},start:function(){e.attributes&&!isNaN(e.attributes["TIME-OFFSET"])?this.manifest.start={timeOffset:e.attributes["TIME-OFFSET"],precise:e.attributes.PRECISE}:this.trigger("warn",{message:"ignoring start declaration without appropriate attribute list"})},"cue-out":function(){o.cueOut=e.data},"cue-out-cont":function(){o.cueOutCont=e.data},"cue-in":function(){o.cueIn=e.data}})[e.tagType]||function(){}).call(r)},uri:function(){o.uri=e.uri,a.push(o),!this.manifest.targetDuration||"duration"in o||(this.trigger("warn",{message:"defaulting segment duration to the target duration"}),o.duration=this.manifest.targetDuration),i&&(o.key=i),o.timeline=l,n&&(o.map=n),o={}},comment:function(){},custom:function(){e.segment?(o.custom=o.custom||{},o.custom[e.customType]=e.data):(this.manifest.custom=this.manifest.custom||{},this.manifest.custom[e.customType]=e.data)}})[e.type].call(r)}),t}oo(t,e);var n=t.prototype;return n.push=function(e){this.lineStream.push(e)},n.end=function(){this.lineStream.push("\n")},n.addParser=function(e){this.parseStream.addParser(e)},n.addTagMapper=function(e){this.parseStream.addTagMapper(e)},t}(es),as=function(e){return!!e&&"object"==typeof e},os=function e(){for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];return n.reduce(function(t,n){return Object.keys(n).forEach(function(i){Array.isArray(t[i])&&Array.isArray(n[i])?t[i]=t[i].concat(n[i]):as(t[i])&&as(n[i])?t[i]=e(t[i],n[i]):t[i]=n[i]}),t},{})},ss=function(e){return e.reduce(function(e,t){return e.concat(t)},[])},ls=function(e){if(!e.length)return[];for(var t=[],n=0;n<e.length;n++)t.push(e[n]);return t},us="INVALID_NUMBER_OF_PERIOD",cs="DASH_EMPTY_MANIFEST",ds="DASH_INVALID_XML",hs="NO_BASE_URL",ps="SEGMENT_TIME_UNSPECIFIED",fs="UNSUPPORTED_UTC_TIMING_SCHEME",gs=(function(e,t){var n,i,r,a,o;n=/^((?:[a-zA-Z0-9+\-.]+:)?)(\/\/[^\/?#]*)?((?:[^\/\?#]*\/)*.*?)??(;.*?)?(\?.*?)?(#.*?)?$/,i=/^([^\/?#]*)(.*)$/,r=/(?:\/|^)\.(?=\/)/g,a=/(?:\/|^)\.\.\/(?!\.\.\/).*?(?=\/)/g,o={buildAbsoluteURL:function(e,t,n){if(n=n||{},e=e.trim(),!(t=t.trim())){if(!n.alwaysNormalize)return e;var r=o.parseURL(e);if(!r)throw new Error("Error trying to parse base URL.");return r.path=o.normalizePath(r.path),o.buildURLFromParts(r)}var a=o.parseURL(t);if(!a)throw new Error("Error trying to parse relative URL.");if(a.scheme)return n.alwaysNormalize?(a.path=o.normalizePath(a.path),o.buildURLFromParts(a)):t;var s=o.parseURL(e);if(!s)throw new Error("Error trying to parse base URL.");if(!s.netLoc&&s.path&&"/"!==s.path[0]){var l=i.exec(s.path);s.netLoc=l[1],s.path=l[2]}s.netLoc&&!s.path&&(s.path="/");var u={scheme:s.scheme,netLoc:a.netLoc,path:null,params:a.params,query:a.query,fragment:a.fragment};if(!a.netLoc&&(u.netLoc=s.netLoc,"/"!==a.path[0]))if(a.path){var c=s.path,d=c.substring(0,c.lastIndexOf("/")+1)+a.path;u.path=o.normalizePath(d)}else u.path=s.path,a.params||(u.params=s.params,a.query||(u.query=s.query));return null===u.path&&(u.path=n.alwaysNormalize?o.normalizePath(a.path):a.path),o.buildURLFromParts(u)},parseURL:function(e){var t=n.exec(e);return t?{scheme:t[1]||"",netLoc:t[2]||"",path:t[3]||"",params:t[4]||"",query:t[5]||"",fragment:t[6]||""}:null},normalizePath:function(e){for(e=e.split("").reverse().join("").replace(r,"");e.length!==(e=e.replace(a,"")).length;);return e.split("").reverse().join("")},buildURLFromParts:function(e){return e.scheme+e.netLoc+e.path+e.params+e.query+e.fragment}},e.exports=o}(lo={exports:{}}),lo.exports),ms=function(t,n){return/^[a-z]+:/i.test(n)?n:(/\/\//i.test(t)||(t=gs.buildAbsoluteURL(e.location.href,t)),gs.buildAbsoluteURL(t,n))},vs=function(e){var t=e.baseUrl,n=void 0===t?"":t,i=e.source,r=void 0===i?"":i,a=e.range,o=void 0===a?"":a,s=e.indexRange,l=void 0===s?"":s,u={uri:r,resolvedUri:ms(n||"",r)};if(o||l){var c=(o||l).split("-"),d=parseInt(c[0],10),h=parseInt(c[1],10);u.byterange={length:h-d+1,offset:d}}return u},ys={static:function(e){var t=e.duration,n=e.timescale,i=void 0===n?1:n,r=e.sourceDuration;return{start:0,end:Math.ceil(r/(t/i))}},dynamic:function(e){var t=e.NOW,n=e.clientOffset,i=e.availabilityStartTime,r=e.timescale,a=void 0===r?1:r,o=e.duration,s=e.start,l=void 0===s?0:s,u=e.minimumUpdatePeriod,c=void 0===u?0:u,d=e.timeShiftBufferDepth,h=void 0===d?1/0:d,p=(t+n)/1e3,f=i+l,g=p+c-f,m=Math.ceil(g*a/o),v=Math.floor((p-f-h)*a/o),y=Math.floor((p-f)*a/o);return{start:Math.max(0,v),end:Math.min(m,y)}}},bs=function(e){var t=e.type,n=void 0===t?"static":t,i=e.duration,r=e.timescale,a=void 0===r?1:r,o=e.sourceDuration,s=ys[n](e),l=s.start,u=function(e,t){for(var n=[],i=l;i<t;i++)n.push(i);return n}(0,s.end).map(function(e){return function(t,n){var i=e.duration,r=e.timescale,a=void 0===r?1:r,o=e.periodIndex,s=e.startNumber;return{number:(void 0===s?1:s)+t,duration:i/a,timeline:o,time:n*i}}}(e));if("static"===n){var c=u.length-1;u[c].duration=o-i/a*c}return u},_s=function(e){var t=e.baseUrl,n=e.initialization,i=void 0===n?{}:n,r=e.sourceDuration,a=e.timescale,o=void 0===a?1:a,s=e.indexRange,l=void 0===s?"":s,u=e.duration;if(!t)throw new Error(hs);var c=vs({baseUrl:t,source:i.sourceURL,range:i.range}),d=vs({baseUrl:t,source:t,indexRange:l});if(d.map=c,u){var h=bs(e);h.length&&(d.duration=h[0].duration,d.timeline=h[0].timeline)}else r&&(d.duration=r/o,d.timeline=0);return d.number=0,[d]},Ts=function(e,t,n){for(var i=e.sidx.map?e.sidx.map:null,r=e.sidx.duration,a=e.timeline||0,o=e.sidx.byterange,s=o.offset+o.length,l=t.timescale,u=t.references.filter(function(e){return 1!==e.referenceType}),c=[],d=s+t.firstOffset,h=0;h<u.length;h++){var p=t.references[h],f=p.referencedSize,g=p.subsegmentDuration,m=_s({baseUrl:n,timescale:l,timeline:a,periodIndex:a,duration:g,sourceDuration:r,indexRange:d+"-"+(d+f-1)})[0];i&&(m.map=i),c.push(m),d+=f}return e.segments=c,e},Es=function(e){var t;return(t=e.reduce(function(e,t){var n,i=t.attributes.id+(t.attributes.lang||"");return e[i]?(t.segments[0]&&(t.segments[0].discontinuity=!0),(n=e[i].segments).push.apply(n,t.segments),t.attributes.contentProtection&&(e[i].attributes.contentProtection=t.attributes.contentProtection)):e[i]=t,e},{}),Object.keys(t).map(function(e){return t[e]})).map(function(e){var t,n;return e.discontinuityStarts=(t=e.segments,n="discontinuity",t.reduce(function(e,t,i){return t[n]&&e.push(i),e},[])),e})},Cs=function(e,t){if(void 0===t&&(t={}),!Object.keys(t).length)return e;for(var n in e){var i=e[n];if(i.sidx){var r=i.sidx.uri+"-"+(s=(o=i.sidx.byterange).offset+o.length-1,o.offset+"-"+s),a=t[r]&&t[r].sidx;i.sidx&&a&&Ts(i,a,i.sidx.resolvedUri)}}var o,s;return e},ws=function(e){var t,n=e.attributes,i=e.segments,r=e.sidx,a={attributes:(t={NAME:n.id,AUDIO:"audio",SUBTITLES:"subs",RESOLUTION:{width:n.width,height:n.height},CODECS:n.codecs,BANDWIDTH:n.bandwidth},t["PROGRAM-ID"]=1,t),uri:"",endList:"static"===(n.type||"static"),timeline:n.periodIndex,resolvedUri:"",targetDuration:n.duration,segments:i,mediaSequence:i.length?i[0].number:1};return n.contentProtection&&(a.contentProtection=n.contentProtection),r&&(a.sidx=r),a},ks=function(e,t,n){var i=e.NOW,r=e.clientOffset,a=e.availabilityStartTime,o=e.timescale,s=void 0===o?1:o,l=e.start,u=void 0===l?0:l,c=e.minimumUpdatePeriod,d=(i+r)/1e3+(void 0===c?0:c)-(a+u);return Math.ceil((d*s-t)/n)},Ss=function(e,t){for(var n=e.type,i=void 0===n?"static":n,r=e.minimumUpdatePeriod,a=void 0===r?0:r,o=e.media,s=void 0===o?"":o,l=e.sourceDuration,u=e.timescale,c=void 0===u?1:u,d=e.startNumber,h=void 0===d?1:d,p=e.periodIndex,f=[],g=-1,m=0;m<t.length;m++){var v=t[m],y=v.d,b=v.r||0,_=v.t||0;g<0&&(g=_),_&&_>g&&(g=_);var T=void 0;if(b<0){var E=m+1;T=E===t.length?"dynamic"===i&&a>0&&s.indexOf("$Number$")>0?ks(e,g,y):(l*c-g)/y:(t[E].t-g)/y}else T=b+1;for(var C=h+f.length+T,w=h+f.length;w<C;)f.push({number:w,duration:y/c,time:g,timeline:p}),g+=y,w++}return f},Is=/\$([A-z]*)(?:(%0)([0-9]+)d)?\$/g,Os=function(e,t){return e.replace(Is,function(e){return function(t,n,i,r){if("$$"===t)return"$";if(void 0===e[n])return t;var a=""+e[n];return"RepresentationID"===n?a:(r=i?parseInt(r,10):1,a.length>=r?a:""+new Array(r-a.length+1).join("0")+a)}}(t))},Ds=function(e,t){var n={RepresentationID:e.id,Bandwidth:e.bandwidth||0},i=e.initialization,r=void 0===i?{sourceURL:"",range:""}:i,a=vs({baseUrl:e.baseUrl,source:Os(r.sourceURL,n),range:r.range});return function(e,t){return e.duration||t?e.duration?bs(e):Ss(e,t):[{number:e.startNumber||1,duration:e.sourceDuration,time:0,timeline:e.periodIndex}]}(e,t).map(function(t){n.Number=t.number,n.Time=t.time;var i=Os(e.media||"",n);return{uri:i,timeline:t.timeline,duration:t.duration,resolvedUri:ms(e.baseUrl||"",i),map:a,number:t.number}})},Rs=function(e,t){var n=e.duration,i=e.segmentUrls,r=void 0===i?[]:i;if(!n&&!t||n&&t)throw new Error(ps);var a,o=r.map(function(t){return function(e,t){var n=e.baseUrl,i=e.initialization,r=void 0===i?{}:i,a=vs({baseUrl:n,source:r.sourceURL,range:r.range}),o=vs({baseUrl:n,source:t.media,range:t.mediaRange});return o.map=a,o}(e,t)});return n&&(a=bs(e)),t&&(a=Ss(e,t)),a.map(function(e,t){if(o[t]){var n=o[t];return n.timeline=e.timeline,n.duration=e.duration,n.number=e.number,n}}).filter(function(e){return e})},xs=function(e){var t,n,i=e.attributes,r=e.segmentInfo;r.template?(n=Ds,t=os(i,r.template)):r.base?(n=_s,t=os(i,r.base)):r.list&&(n=Rs,t=os(i,r.list));var a={attributes:i};if(!n)return a;var o=n(t,r.timeline);if(t.duration){var s=t,l=s.duration,u=s.timescale,c=void 0===u?1:u;t.duration=l/c}else o.length?t.duration=o.reduce(function(e,t){return Math.max(e,Math.ceil(t.duration))},0):t.duration=0;return a.attributes=t,a.segments=o,r.base&&t.indexRange&&(a.sidx=o[0],a.segments=[]),a},As=function(e,t){return ls(e.childNodes).filter(function(e){return e.tagName===t})},Ps=function(e){return e.textContent.trim()},Ls=function(e){var t=/P(?:(\d*)Y)?(?:(\d*)M)?(?:(\d*)D)?(?:T(?:(\d*)H)?(?:(\d*)M)?(?:([\d.]*)S)?)?/.exec(e);if(!t)return 0;var n=t.slice(1),i=n[0],r=n[1],a=n[2],o=n[3],s=n[4],l=n[5];return 31536e3*parseFloat(i||0)+2592e3*parseFloat(r||0)+86400*parseFloat(a||0)+3600*parseFloat(o||0)+60*parseFloat(s||0)+parseFloat(l||0)},Ns={mediaPresentationDuration:function(e){return Ls(e)},availabilityStartTime:function(e){return/^\d+-\d+-\d+T\d+:\d+:\d+(\.\d+)?$/.test(t=e)&&(t+="Z"),Date.parse(t)/1e3;var t},minimumUpdatePeriod:function(e){return Ls(e)},timeShiftBufferDepth:function(e){return Ls(e)},start:function(e){return Ls(e)},width:function(e){return parseInt(e,10)},height:function(e){return parseInt(e,10)},bandwidth:function(e){return parseInt(e,10)},startNumber:function(e){return parseInt(e,10)},timescale:function(e){return parseInt(e,10)},duration:function(e){var t=parseInt(e,10);return isNaN(t)?Ls(e):t},d:function(e){return parseInt(e,10)},t:function(e){return parseInt(e,10)},r:function(e){return parseInt(e,10)},DEFAULT:function(e){return e}},Ms=function(e){return e&&e.attributes?ls(e.attributes).reduce(function(e,t){var n=Ns[t.name]||Ns.DEFAULT;return e[t.name]=n(t.value),e},{}):{}},Ks={"urn:uuid:1077efec-c0b2-4d02-ace3-3c1e52e2fb4b":"org.w3.clearkey","urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed":"com.widevine.alpha","urn:uuid:9a04f079-9840-4286-ab92-e65be0885f95":"com.microsoft.playready","urn:uuid:f239e769-efa3-4850-9c16-a903c6932efb":"com.adobe.primetime"},$s=function(e,t){return t.length?ss(e.map(function(e){return t.map(function(t){return ms(e,Ps(t))})})):e},js=function(e){var t=As(e,"SegmentTemplate")[0],n=As(e,"SegmentList")[0],i=n&&As(n,"SegmentURL").map(function(e){return os({tag:"SegmentURL"},Ms(e))}),r=As(e,"SegmentBase")[0],a=n||t,o=a&&As(a,"SegmentTimeline")[0],s=n||r||t,l=s&&As(s,"Initialization")[0],u=t&&Ms(t);u&&l?u.initialization=l&&Ms(l):u&&u.initialization&&(u.initialization={sourceURL:u.initialization});var c={template:u,timeline:o&&As(o,"S").map(function(e){return Ms(e)}),list:n&&os(Ms(n),{segmentUrls:i,initialization:Ms(l)}),base:r&&os(Ms(r),{initialization:Ms(l)})};return Object.keys(c).forEach(function(e){c[e]||delete c[e]}),c},Bs=function(t){return t.reduce(function(t,n){var i=Ms(n),r=Ks[i.schemeIdUri];if(r){t[r]={attributes:i};var a=As(n,"cenc:pssh")[0];if(a){var o=Ps(a),s=o&&function(t){for(var n=e.atob(t),i=new Uint8Array(n.length),r=0;r<n.length;r++)i[r]=n.charCodeAt(r);return i}(o);t[r].pssh=s}}return t},{})},Fs=function(t,n){void 0===n&&(n={});var i=n,r=i.manifestUri,a=void 0===r?"":r,o=i.NOW,s=void 0===o?Date.now():o,l=i.clientOffset,u=void 0===l?0:l,c=As(t,"Period");if(!c.length)throw new Error(us);var d=Ms(t),h=$s([a],As(t,"BaseURL"));return d.sourceDuration=d.mediaPresentationDuration||0,d.NOW=s,d.clientOffset=u,ss(c.map(function(t,n){return function(i,r){var a=$s(n,As(i,"BaseURL")),o=Ms(i),s=parseInt(o.id,10),l=e.isNaN(s)?r:s,u=os(t,{periodIndex:l}),c=As(i,"AdaptationSet"),d=js(i);return ss(c.map(function(e,t,n){return function(i){var r=Ms(i),a=$s(t,As(i,"BaseURL")),o=As(i,"Role")[0],s={role:Ms(o)},l=os(e,r,s),u=Bs(As(i,"ContentProtection"));Object.keys(u).length&&(l=os(l,{contentProtection:u}));var c=js(i),d=As(i,"Representation"),h=os(n,c);return ss(d.map(function(e,t,n){return function(i){var r=As(i,"BaseURL"),a=$s(t,r),o=os(e,Ms(i)),s=js(i);return a.map(function(e){return{segmentInfo:os(n,s),attributes:os(o,{baseUrl:e})}})}}(l,a,h)))}}(u,a,d)))}}(d,h)))},Us=function(t){if(""===t)throw new Error(cs);var n=(new e.DOMParser).parseFromString(t,"application/xml"),i=n&&"MPD"===n.documentElement.tagName?n.documentElement:null;if(!i||i&&i.getElementsByTagName("parsererror").length>0)throw new Error(ds);return i},Vs=function(e,t){return void 0===t&&(t={}),function(e,t){var n;if(void 0===t&&(t={}),!e.length)return{};var i=e[0].attributes,r=i.sourceDuration,a=i.minimumUpdatePeriod,o=void 0===a?0:a,s=Es(e.filter(function(e){var t=e.attributes;return"video/mp4"===t.mimeType||"video"===t.contentType})).map(ws),l=Es(e.filter(function(e){var t=e.attributes;return"audio/mp4"===t.mimeType||"audio"===t.contentType})),u=e.filter(function(e){var t=e.attributes;return"text/vtt"===t.mimeType||"text"===t.contentType}),c={allowCache:!0,discontinuityStarts:[],segments:[],endList:!0,mediaGroups:(n={AUDIO:{},VIDEO:{}},n["CLOSED-CAPTIONS"]={},n.SUBTITLES={},n),uri:"",duration:r,playlists:Cs(s,t),minimumUpdatePeriod:1e3*o};return l.length&&(c.mediaGroups.AUDIO.audio=function(e,t){void 0===t&&(t={});var n,i=l.reduce(function(e,i){var r=i.attributes.role&&i.attributes.role.value||"",a=i.attributes.lang||"",o="main";if(a){var s=r?" ("+r+")":"";o=""+i.attributes.lang+s}return e[o]&&e[o].playlists[0].attributes.BANDWIDTH>i.attributes.bandwidth?e:(e[o]={language:a,autoselect:!0,default:"main"===r,playlists:Cs([function(e){var t,n=e.attributes,i=e.segments,r=e.sidx,a={attributes:(t={NAME:n.id,BANDWIDTH:n.bandwidth,CODECS:n.codecs},t["PROGRAM-ID"]=1,t),uri:"",endList:"static"===(n.type||"static"),timeline:n.periodIndex,resolvedUri:"",targetDuration:n.duration,segments:i,mediaSequence:i.length?i[0].number:1};return n.contentProtection&&(a.contentProtection=n.contentProtection),r&&(a.sidx=r),a}(i)],t),uri:""},void 0===n&&"main"===r&&((n=i).default=!0),e)},{});return n||(i[Object.keys(i)[0]].default=!0),i}(0,t)),u.length&&(c.mediaGroups.SUBTITLES.subs=function(e,t){return void 0===t&&(t={}),u.reduce(function(e,n){var i,r,a,o,s=n.attributes.lang||"text";return e[s]?e:(e[s]={language:s,default:!1,autoselect:!1,playlists:Cs([(i=n,a=i.attributes,o=i.segments,void 0===o&&(o=[{uri:a.baseUrl,timeline:a.periodIndex,resolvedUri:a.baseUrl||"",duration:a.sourceDuration,number:0}],a.duration=a.sourceDuration),{attributes:(r={NAME:a.id,BANDWIDTH:a.bandwidth},r["PROGRAM-ID"]=1,r),uri:"",endList:"static"===(a.type||"static"),timeline:a.periodIndex,resolvedUri:a.baseUrl||"",targetDuration:a.duration,segments:o,mediaSequence:o.length?o[0].number:1})],t),uri:""},e)},{})}(0,t)),c}(Fs(Us(e),t).map(xs),t.sidxMapping)},qs=function(e){return e>>>0},Hs={findBox:uo=function(e,t){var n,i,r,a,o,s=[];if(!t.length)return null;for(n=0;n<e.byteLength;)i=qs(e[n]<<24|e[n+1]<<16|e[n+2]<<8|e[n+3]),r=co(e.subarray(n+4,n+8)),a=i>1?n+i:e.byteLength,r===t[0]&&(1===t.length?s.push(e.subarray(n+8,a)):(o=uo(e.subarray(n+8,a),t.slice(1))).length&&(s=s.concat(o))),n=a;return s},parseType:co=function(e){var t="";return t+=String.fromCharCode(e[0]),t+=String.fromCharCode(e[1]),(t+=String.fromCharCode(e[2]))+String.fromCharCode(e[3])},timescale:function(e){return uo(e,["moov","trak"]).reduce(function(e,t){var n,i,r,a,o;return(n=uo(t,["tkhd"])[0])?(i=n[0],a=qs(n[r=0===i?12:20]<<24|n[r+1]<<16|n[r+2]<<8|n[r+3]),(o=uo(t,["mdia","mdhd"])[0])?(r=0===(i=o[0])?12:20,e[a]=qs(o[r]<<24|o[r+1]<<16|o[r+2]<<8|o[r+3]),e):null):null},{})},startTime:function(e,t){var n,i,r;return n=uo(t,["moof","traf"]),i=[].concat.apply([],n.map(function(t){return uo(t,["tfhd"]).map(function(n){var i,r;return i=qs(n[4]<<24|n[5]<<16|n[6]<<8|n[7]),r=e[i]||9e4,(uo(t,["tfdt"]).map(function(e){var t,n;return t=e[0],n=qs(e[4]<<24|e[5]<<16|e[6]<<8|e[7]),1===t&&(n*=Math.pow(2,32),n+=qs(e[8]<<24|e[9]<<16|e[10]<<8|e[11])),n})[0]||1/0)/r})})),r=Math.min.apply(null,i),isFinite(r)?r:0},videoTrackIds:function(e){var t=[];return uo(e,["moov","trak"]).forEach(function(e){var n=uo(e,["mdia","hdlr"]),i=uo(e,["tkhd"]);n.forEach(function(e,n){var r,a,o=co(e.subarray(8,12)),s=i[n];"vide"===o&&(a=0===(r=new DataView(s.buffer,s.byteOffset,s.byteLength)).getUint8(0)?r.getUint32(12):r.getUint32(20),t.push(a))})}),t}},zs=Hs.parseType,Ws=function(e){return new Date(1e3*e-20828448e5)},Gs=function(e){return{isLeading:(12&e[0])>>>2,dependsOn:3&e[0],isDependedOn:(192&e[1])>>>6,hasRedundancy:(48&e[1])>>>4,paddingValue:(14&e[1])>>>1,isNonSyncSample:1&e[1],degradationPriority:e[2]<<8|e[3]}},Xs={avc1:function(e){var t=new DataView(e.buffer,e.byteOffset,e.byteLength);return{dataReferenceIndex:t.getUint16(6),width:t.getUint16(24),height:t.getUint16(26),horizresolution:t.getUint16(28)+t.getUint16(30)/16,vertresolution:t.getUint16(32)+t.getUint16(34)/16,frameCount:t.getUint16(40),depth:t.getUint16(74),config:ho(e.subarray(78,e.byteLength))}},avcC:function(e){var t,n,i,r,a=new DataView(e.buffer,e.byteOffset,e.byteLength),o={configurationVersion:e[0],avcProfileIndication:e[1],profileCompatibility:e[2],avcLevelIndication:e[3],lengthSizeMinusOne:3&e[4],sps:[],pps:[]},s=31&e[5];for(i=6,r=0;r<s;r++)n=a.getUint16(i),i+=2,o.sps.push(new Uint8Array(e.subarray(i,i+n))),i+=n;for(t=e[i],i++,r=0;r<t;r++)n=a.getUint16(i),i+=2,o.pps.push(new Uint8Array(e.subarray(i,i+n))),i+=n;return o},btrt:function(e){var t=new DataView(e.buffer,e.byteOffset,e.byteLength);return{bufferSizeDB:t.getUint32(0),maxBitrate:t.getUint32(4),avgBitrate:t.getUint32(8)}},esds:function(e){return{version:e[0],flags:new Uint8Array(e.subarray(1,4)),esId:e[6]<<8|e[7],streamPriority:31&e[8],decoderConfig:{objectProfileIndication:e[11],streamType:e[12]>>>2&63,bufferSize:e[13]<<16|e[14]<<8|e[15],maxBitrate:e[16]<<24|e[17]<<16|e[18]<<8|e[19],avgBitrate:e[20]<<24|e[21]<<16|e[22]<<8|e[23],decoderConfigDescriptor:{tag:e[24],length:e[25],audioObjectType:e[26]>>>3&31,samplingFrequencyIndex:(7&e[26])<<1|e[27]>>>7&1,channelConfiguration:e[27]>>>3&15}}}},ftyp:function(e){for(var t=new DataView(e.buffer,e.byteOffset,e.byteLength),n={majorBrand:zs(e.subarray(0,4)),minorVersion:t.getUint32(4),compatibleBrands:[]},i=8;i<e.byteLength;)n.compatibleBrands.push(zs(e.subarray(i,i+4))),i+=4;return n},dinf:function(e){return{boxes:ho(e)}},dref:function(e){return{version:e[0],flags:new Uint8Array(e.subarray(1,4)),dataReferences:ho(e.subarray(8))}},hdlr:function(e){var t={version:new DataView(e.buffer,e.byteOffset,e.byteLength).getUint8(0),flags:new Uint8Array(e.subarray(1,4)),handlerType:zs(e.subarray(8,12)),name:""},n=8;for(n=24;n<e.byteLength;n++){if(0===e[n]){n++;break}t.name+=String.fromCharCode(e[n])}return t.name=decodeURIComponent(escape(t.name)),t},mdat:function(e){return{byteLength:e.byteLength,nals:function(e){var t,n,i=new DataView(e.buffer,e.byteOffset,e.byteLength),r=[];for(t=0;t+4<e.length;t+=n)if(n=i.getUint32(t),t+=4,n<=0)r.push("<span style='color:red;'>MALFORMED DATA</span>");else switch(31&e[t]){case 1:r.push("slice_layer_without_partitioning_rbsp");break;case 5:r.push("slice_layer_without_partitioning_rbsp_idr");break;case 6:r.push("sei_rbsp");break;case 7:r.push("seq_parameter_set_rbsp");break;case 8:r.push("pic_parameter_set_rbsp");break;case 9:r.push("access_unit_delimiter_rbsp");break;default:r.push("UNKNOWN NAL - "+e[t]&31)}return r}(e)}},mdhd:function(e){var t,n=new DataView(e.buffer,e.byteOffset,e.byteLength),i=4,r={version:n.getUint8(0),flags:new Uint8Array(e.subarray(1,4)),language:""};return 1===r.version?(i+=4,r.creationTime=Ws(n.getUint32(i)),i+=8,r.modificationTime=Ws(n.getUint32(i)),i+=4,r.timescale=n.getUint32(i),i+=8,r.duration=n.getUint32(i)):(r.creationTime=Ws(n.getUint32(i)),i+=4,r.modificationTime=Ws(n.getUint32(i)),i+=4,r.timescale=n.getUint32(i),i+=4,r.duration=n.getUint32(i)),i+=4,t=n.getUint16(i),r.language+=String.fromCharCode(96+(t>>10)),r.language+=String.fromCharCode(96+((992&t)>>5)),r.language+=String.fromCharCode(96+(31&t)),r},mdia:function(e){return{boxes:ho(e)}},mfhd:function(e){return{version:e[0],flags:new Uint8Array(e.subarray(1,4)),sequenceNumber:e[4]<<24|e[5]<<16|e[6]<<8|e[7]}},minf:function(e){return{boxes:ho(e)}},mp4a:function(e){var t=new DataView(e.buffer,e.byteOffset,e.byteLength),n={dataReferenceIndex:t.getUint16(6),channelcount:t.getUint16(16),samplesize:t.getUint16(18),samplerate:t.getUint16(24)+t.getUint16(26)/65536};return e.byteLength>28&&(n.streamDescriptor=ho(e.subarray(28))[0]),n},moof:function(e){return{boxes:ho(e)}},moov:function(e){return{boxes:ho(e)}},mvex:function(e){return{boxes:ho(e)}},mvhd:function(e){var t=new DataView(e.buffer,e.byteOffset,e.byteLength),n=4,i={version:t.getUint8(0),flags:new Uint8Array(e.subarray(1,4))};return 1===i.version?(n+=4,i.creationTime=Ws(t.getUint32(n)),n+=8,i.modificationTime=Ws(t.getUint32(n)),n+=4,i.timescale=t.getUint32(n),n+=8,i.duration=t.getUint32(n)):(i.creationTime=Ws(t.getUint32(n)),n+=4,i.modificationTime=Ws(t.getUint32(n)),n+=4,i.timescale=t.getUint32(n),n+=4,i.duration=t.getUint32(n)),n+=4,i.rate=t.getUint16(n)+t.getUint16(n+2)/16,n+=4,i.volume=t.getUint8(n)+t.getUint8(n+1)/8,n+=2,n+=2,n+=8,i.matrix=new Uint32Array(e.subarray(n,n+36)),n+=36,n+=24,i.nextTrackId=t.getUint32(n),i},pdin:function(e){var t=new DataView(e.buffer,e.byteOffset,e.byteLength);return{version:t.getUint8(0),flags:new Uint8Array(e.subarray(1,4)),rate:t.getUint32(4),initialDelay:t.getUint32(8)}},sdtp:function(e){var t,n={version:e[0],flags:new Uint8Array(e.subarray(1,4)),samples:[]};for(t=4;t<e.byteLength;t++)n.samples.push({dependsOn:(48&e[t])>>4,isDependedOn:(12&e[t])>>2,hasRedundancy:3&e[t]});return n},sidx:function(e){var t,n=new DataView(e.buffer,e.byteOffset,e.byteLength),i={version:e[0],flags:new Uint8Array(e.subarray(1,4)),references:[],referenceId:n.getUint32(4),timescale:n.getUint32(8),earliestPresentationTime:n.getUint32(12),firstOffset:n.getUint32(16)},r=n.getUint16(22);for(t=24;r;t+=12,r--)i.references.push({referenceType:(128&e[t])>>>7,referencedSize:2147483647&n.getUint32(t),subsegmentDuration:n.getUint32(t+4),startsWithSap:!!(128&e[t+8]),sapType:(112&e[t+8])>>>4,sapDeltaTime:268435455&n.getUint32(t+8)});return i},smhd:function(e){return{version:e[0],flags:new Uint8Array(e.subarray(1,4)),balance:e[4]+e[5]/256}},stbl:function(e){return{boxes:ho(e)}},stco:function(e){var t,n=new DataView(e.buffer,e.byteOffset,e.byteLength),i={version:e[0],flags:new Uint8Array(e.subarray(1,4)),chunkOffsets:[]},r=n.getUint32(4);for(t=8;r;t+=4,r--)i.chunkOffsets.push(n.getUint32(t));return i},stsc:function(e){var t,n=new DataView(e.buffer,e.byteOffset,e.byteLength),i=n.getUint32(4),r={version:e[0],flags:new Uint8Array(e.subarray(1,4)),sampleToChunks:[]};for(t=8;i;t+=12,i--)r.sampleToChunks.push({firstChunk:n.getUint32(t),samplesPerChunk:n.getUint32(t+4),sampleDescriptionIndex:n.getUint32(t+8)});return r},stsd:function(e){return{version:e[0],flags:new Uint8Array(e.subarray(1,4)),sampleDescriptions:ho(e.subarray(8))}},stsz:function(e){var t,n=new DataView(e.buffer,e.byteOffset,e.byteLength),i={version:e[0],flags:new Uint8Array(e.subarray(1,4)),sampleSize:n.getUint32(4),entries:[]};for(t=12;t<e.byteLength;t+=4)i.entries.push(n.getUint32(t));return i},stts:function(e){var t,n=new DataView(e.buffer,e.byteOffset,e.byteLength),i={version:e[0],flags:new Uint8Array(e.subarray(1,4)),timeToSamples:[]},r=n.getUint32(4);for(t=8;r;t+=8,r--)i.timeToSamples.push({sampleCount:n.getUint32(t),sampleDelta:n.getUint32(t+4)});return i},styp:function(e){return Xs.ftyp(e)},tfdt:function(e){var t={version:e[0],flags:new Uint8Array(e.subarray(1,4)),baseMediaDecodeTime:e[4]<<24|e[5]<<16|e[6]<<8|e[7]};return 1===t.version&&(t.baseMediaDecodeTime*=Math.pow(2,32),t.baseMediaDecodeTime+=e[8]<<24|e[9]<<16|e[10]<<8|e[11]),t},tfhd:function(e){var t,n=new DataView(e.buffer,e.byteOffset,e.byteLength),i={version:e[0],flags:new Uint8Array(e.subarray(1,4)),trackId:n.getUint32(4)},r=1&i.flags[2],a=2&i.flags[2],o=8&i.flags[2],s=16&i.flags[2],l=32&i.flags[2],u=65536&i.flags[0],c=131072&i.flags[0];return t=8,r&&(t+=4,i.baseDataOffset=n.getUint32(12),t+=4),a&&(i.sampleDescriptionIndex=n.getUint32(t),t+=4),o&&(i.defaultSampleDuration=n.getUint32(t),t+=4),s&&(i.defaultSampleSize=n.getUint32(t),t+=4),l&&(i.defaultSampleFlags=n.getUint32(t)),u&&(i.durationIsEmpty=!0),!r&&c&&(i.baseDataOffsetIsMoof=!0),i},tkhd:function(e){var t=new DataView(e.buffer,e.byteOffset,e.byteLength),n=4,i={version:t.getUint8(0),flags:new Uint8Array(e.subarray(1,4))};return 1===i.version?(n+=4,i.creationTime=Ws(t.getUint32(n)),n+=8,i.modificationTime=Ws(t.getUint32(n)),n+=4,i.trackId=t.getUint32(n),n+=4,n+=8,i.duration=t.getUint32(n)):(i.creationTime=Ws(t.getUint32(n)),n+=4,i.modificationTime=Ws(t.getUint32(n)),n+=4,i.trackId=t.getUint32(n),n+=4,n+=4,i.duration=t.getUint32(n)),n+=4,n+=8,i.layer=t.getUint16(n),n+=2,i.alternateGroup=t.getUint16(n),n+=2,i.volume=t.getUint8(n)+t.getUint8(n+1)/8,n+=2,n+=2,i.matrix=new Uint32Array(e.subarray(n,n+36)),n+=36,i.width=t.getUint16(n)+t.getUint16(n+2)/16,n+=4,i.height=t.getUint16(n)+t.getUint16(n+2)/16,i},traf:function(e){return{boxes:ho(e)}},trak:function(e){return{boxes:ho(e)}},trex:function(e){var t=new DataView(e.buffer,e.byteOffset,e.byteLength);return{version:e[0],flags:new Uint8Array(e.subarray(1,4)),trackId:t.getUint32(4),defaultSampleDescriptionIndex:t.getUint32(8),defaultSampleDuration:t.getUint32(12),defaultSampleSize:t.getUint32(16),sampleDependsOn:3&e[20],sampleIsDependedOn:(192&e[21])>>6,sampleHasRedundancy:(48&e[21])>>4,samplePaddingValue:(14&e[21])>>1,sampleIsDifferenceSample:!!(1&e[21]),sampleDegradationPriority:t.getUint16(22)}},trun:function(e){var t,n={version:e[0],flags:new Uint8Array(e.subarray(1,4)),samples:[]},i=new DataView(e.buffer,e.byteOffset,e.byteLength),r=1&n.flags[2],a=4&n.flags[2],o=1&n.flags[1],s=2&n.flags[1],l=4&n.flags[1],u=8&n.flags[1],c=i.getUint32(4),d=8;for(r&&(n.dataOffset=i.getInt32(d),d+=4),a&&c&&(t={flags:Gs(e.subarray(d,d+4))},d+=4,o&&(t.duration=i.getUint32(d),d+=4),s&&(t.size=i.getUint32(d),d+=4),u&&(t.compositionTimeOffset=i.getUint32(d),d+=4),n.samples.push(t),c--);c--;)t={},o&&(t.duration=i.getUint32(d),d+=4),s&&(t.size=i.getUint32(d),d+=4),l&&(t.flags=Gs(e.subarray(d,d+4)),d+=4),u&&(t.compositionTimeOffset=i.getUint32(d),d+=4),n.samples.push(t);return n},"url ":function(e){return{version:e[0],flags:new Uint8Array(e.subarray(1,4))}},vmhd:function(e){var t=new DataView(e.buffer,e.byteOffset,e.byteLength);return{version:e[0],flags:new Uint8Array(e.subarray(1,4)),graphicsmode:t.getUint16(4),opcolor:new Uint16Array([t.getUint16(6),t.getUint16(8),t.getUint16(10)])}}},Ys={inspect:ho=function(e){for(var t,n,i,r,a,o=0,s=[],l=new ArrayBuffer(e.length),u=new Uint8Array(l),c=0;c<e.length;++c)u[c]=e[c];for(t=new DataView(l);o<e.byteLength;)n=t.getUint32(o),i=zs(e.subarray(o+4,o+8)),r=n>1?o+n:e.byteLength,(a=(Xs[i]||function(e){return{data:e}})(e.subarray(o+8,r))).size=n,a.type=i,s.push(a),o=r;return s},textify:po=function(e,t){var n;return t=t||0,n=new Array(2*t+1).join(" "),e.map(function(e,i){return n+e.type+"\n"+Object.keys(e).filter(function(e){return"type"!==e&&"boxes"!==e}).map(function(t){var i=n+"  "+t+": ",r=e[t];if(r instanceof Uint8Array||r instanceof Uint32Array){var a=Array.prototype.slice.call(new Uint8Array(r.buffer,r.byteOffset,r.byteLength)).map(function(e){return" "+("00"+e.toString(16)).slice(-2)}).join("").match(/.{1,24}/g);return a?1===a.length?i+"<"+a.join("").slice(1)+">":i+"<\n"+a.map(function(e){return n+"  "+e}).join("\n")+"\n"+n+"  >":i+"<>"}return i+JSON.stringify(r,null,2).split("\n").map(function(e,t){return 0===t?e:n+"  "+e}).join("\n")}).join("\n")+(e.boxes?"\n"+po(e.boxes,t+1):"")}).join("\n")},parseTfdt:Xs.tfdt,parseHdlr:Xs.hdlr,parseTfhd:Xs.tfhd,parseTrun:Xs.trun,parseSidx:Xs.sidx},Qs=Math.pow(2,32)-1;(function(){var e;if(No={avc1:[],avcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],mvex:[],mvhd:[],sdtp:[],smhd:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],styp:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[]},"undefined"!=typeof Uint8Array){for(e in No)No.hasOwnProperty(e)&&(No[e]=[e.charCodeAt(0),e.charCodeAt(1),e.charCodeAt(2),e.charCodeAt(3)]);Mo=new Uint8Array(["i".charCodeAt(0),"s".charCodeAt(0),"o".charCodeAt(0),"m".charCodeAt(0)]),$o=new Uint8Array(["a".charCodeAt(0),"v".charCodeAt(0),"c".charCodeAt(0),"1".charCodeAt(0)]),Ko=new Uint8Array([0,0,0,1]),jo=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),Bo=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]),Fo={video:jo,audio:Bo},qo=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),Vo=new Uint8Array([0,0,0,0,0,0,0,0]),Ho=new Uint8Array([0,0,0,0,0,0,0,0]),zo=Ho,Wo=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),Go=Ho,Uo=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0])}})(),fo=function(e){var t,n,i=[],r=0;for(t=1;t<arguments.length;t++)i.push(arguments[t]);for(t=i.length;t--;)r+=i[t].byteLength;for(n=new Uint8Array(r+8),new DataView(n.buffer,n.byteOffset,n.byteLength).setUint32(0,n.byteLength),n.set(e,4),t=0,r=8;t<i.length;t++)n.set(i[t],r),r+=i[t].byteLength;return n},go=function(){return fo(No.dinf,fo(No.dref,qo))},mo=function(e){return fo(No.esds,new Uint8Array([0,0,0,0,3,25,0,0,0,4,17,64,21,0,6,0,0,0,218,192,0,0,218,192,5,2,e.audioobjecttype<<3|e.samplingfrequencyindex>>>1,e.samplingfrequencyindex<<7|e.channelcount<<3,6,1,2]))},Oo=function(e){return fo(No.hdlr,Fo[e])},Io=function(e){var t=new Uint8Array([0,0,0,0,0,0,0,2,0,0,0,3,0,1,95,144,e.duration>>>24&255,e.duration>>>16&255,e.duration>>>8&255,255&e.duration,85,196,0,0]);return e.samplerate&&(t[12]=e.samplerate>>>24&255,t[13]=e.samplerate>>>16&255,t[14]=e.samplerate>>>8&255,t[15]=255&e.samplerate),fo(No.mdhd,t)},So=function(e){return fo(No.mdia,Io(e),Oo(e.type),bo(e))},yo=function(e){return fo(No.mfhd,new Uint8Array([0,0,0,0,(4278190080&e)>>24,(16711680&e)>>16,(65280&e)>>8,255&e]))},bo=function(e){return fo(No.minf,"video"===e.type?fo(No.vmhd,Uo):fo(No.smhd,Vo),go(),Ro(e))},_o=function(e,t){for(var n=[],i=t.length;i--;)n[i]=Ao(t[i]);return fo.apply(null,[No.moof,yo(e)].concat(n))},To=function(e){for(var t=e.length,n=[];t--;)n[t]=wo(e[t]);return fo.apply(null,[No.moov,Co(4294967295)].concat(n).concat(Eo(e)))},Eo=function(e){for(var t=e.length,n=[];t--;)n[t]=Po(e[t]);return fo.apply(null,[No.mvex].concat(n))},Co=function(e){var t=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,2,0,1,95,144,(4278190080&e)>>24,(16711680&e)>>16,(65280&e)>>8,255&e,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return fo(No.mvhd,t)},Do=function(e){var t,n,i=e.samples||[],r=new Uint8Array(4+i.length);for(n=0;n<i.length;n++)t=i[n].flags,r[n+4]=t.dependsOn<<4|t.isDependedOn<<2|t.hasRedundancy;return fo(No.sdtp,r)},Ro=function(e){return fo(No.stbl,xo(e),fo(No.stts,Go),fo(No.stsc,zo),fo(No.stsz,Wo),fo(No.stco,Ho))},xo=function(e){return fo(No.stsd,new Uint8Array([0,0,0,0,0,0,0,1]),"video"===e.type?Jo(e):Zo(e))},Jo=function(e){var t,n=e.sps||[],i=e.pps||[],r=[],a=[];for(t=0;t<n.length;t++)r.push((65280&n[t].byteLength)>>>8),r.push(255&n[t].byteLength),r=r.concat(Array.prototype.slice.call(n[t]));for(t=0;t<i.length;t++)a.push((65280&i[t].byteLength)>>>8),a.push(255&i[t].byteLength),a=a.concat(Array.prototype.slice.call(i[t]));return fo(No.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,(65280&e.width)>>8,255&e.width,(65280&e.height)>>8,255&e.height,0,72,0,0,0,72,0,0,0,0,0,0,0,1,19,118,105,100,101,111,106,115,45,99,111,110,116,114,105,98,45,104,108,115,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),fo(No.avcC,new Uint8Array([1,e.profileIdc,e.profileCompatibility,e.levelIdc,255].concat([n.length]).concat(r).concat([i.length]).concat(a))),fo(No.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])))},Zo=function(e){return fo(No.mp4a,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,(65280&e.channelcount)>>8,255&e.channelcount,(65280&e.samplesize)>>8,255&e.samplesize,0,0,0,0,(65280&e.samplerate)>>8,255&e.samplerate,0,0]),mo(e))},ko=function(e){var t=new Uint8Array([0,0,0,7,0,0,0,0,0,0,0,0,(4278190080&e.id)>>24,(16711680&e.id)>>16,(65280&e.id)>>8,255&e.id,0,0,0,0,(4278190080&e.duration)>>24,(16711680&e.duration)>>16,(65280&e.duration)>>8,255&e.duration,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,(65280&e.width)>>8,255&e.width,0,0,(65280&e.height)>>8,255&e.height,0,0]);return fo(No.tkhd,t)},Ao=function(e){var t,n,i,r,a,o;return t=fo(No.tfhd,new Uint8Array([0,0,0,58,(4278190080&e.id)>>24,(16711680&e.id)>>16,(65280&e.id)>>8,255&e.id,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0])),a=Math.floor(e.baseMediaDecodeTime/(Qs+1)),o=Math.floor(e.baseMediaDecodeTime%(Qs+1)),n=fo(No.tfdt,new Uint8Array([1,0,0,0,a>>>24&255,a>>>16&255,a>>>8&255,255&a,o>>>24&255,o>>>16&255,o>>>8&255,255&o])),"audio"===e.type?(i=Lo(e,92),fo(No.traf,t,n,i)):(r=Do(e),i=Lo(e,r.length+92),fo(No.traf,t,n,i,r))},wo=function(e){return e.duration=e.duration||4294967295,fo(No.trak,ko(e),So(e))},Po=function(e){var t=new Uint8Array([0,0,0,0,(4278190080&e.id)>>24,(16711680&e.id)>>16,(65280&e.id)>>8,255&e.id,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]);return"video"!==e.type&&(t[t.length-1]=0),fo(No.trex,t)},Qo=function(e,t){var n=0,i=0,r=0,a=0;return e.length&&(void 0!==e[0].duration&&(n=1),void 0!==e[0].size&&(i=2),void 0!==e[0].flags&&(r=4),void 0!==e[0].compositionTimeOffset&&(a=8)),[0,0,n|i|r|a,1,(4278190080&e.length)>>>24,(16711680&e.length)>>>16,(65280&e.length)>>>8,255&e.length,(4278190080&t)>>>24,(16711680&t)>>>16,(65280&t)>>>8,255&t]},Yo=function(e,t){var n,i,r,a;for(t+=20+16*(i=e.samples||[]).length,n=Qo(i,t),a=0;a<i.length;a++)r=i[a],n=n.concat([(4278190080&r.duration)>>>24,(16711680&r.duration)>>>16,(65280&r.duration)>>>8,255&r.duration,(4278190080&r.size)>>>24,(16711680&r.size)>>>16,(65280&r.size)>>>8,255&r.size,r.flags.isLeading<<2|r.flags.dependsOn,r.flags.isDependedOn<<6|r.flags.hasRedundancy<<4|r.flags.paddingValue<<1|r.flags.isNonSyncSample,61440&r.flags.degradationPriority,15&r.flags.degradationPriority,(4278190080&r.compositionTimeOffset)>>>24,(16711680&r.compositionTimeOffset)>>>16,(65280&r.compositionTimeOffset)>>>8,255&r.compositionTimeOffset]);return fo(No.trun,new Uint8Array(n))},Xo=function(e,t){var n,i,r,a;for(t+=20+8*(i=e.samples||[]).length,n=Qo(i,t),a=0;a<i.length;a++)r=i[a],n=n.concat([(4278190080&r.duration)>>>24,(16711680&r.duration)>>>16,(65280&r.duration)>>>8,255&r.duration,(4278190080&r.size)>>>24,(16711680&r.size)>>>16,(65280&r.size)>>>8,255&r.size]);return fo(No.trun,new Uint8Array(n))},Lo=function(e,t){return"audio"===e.type?Xo(e,t):Yo(e,t)};var Js={ftyp:vo=function(){return fo(No.ftyp,Mo,Ko,Mo,$o)},mdat:function(e){return fo(No.mdat,e)},moof:_o,moov:To,initSegment:function(e){var t,n=vo(),i=To(e);return(t=new Uint8Array(n.byteLength+i.byteLength)).set(n),t.set(i,n.byteLength),t}},Zs=function(){this.init=function(){var e={};this.on=function(t,n){e[t]||(e[t]=[]),e[t]=e[t].concat(n)},this.off=function(t,n){var i;return!!e[t]&&(i=e[t].indexOf(n),e[t]=e[t].slice(),e[t].splice(i,1),i>-1)},this.trigger=function(t){var n,i,r,a;if(n=e[t])if(2===arguments.length)for(r=n.length,i=0;i<r;++i)n[i].call(this,arguments[1]);else{for(a=[],i=arguments.length,i=1;i<arguments.length;++i)a.push(arguments[i]);for(r=n.length,i=0;i<r;++i)n[i].apply(this,a)}},this.dispose=function(){e={}}}};Zs.prototype.pipe=function(e){return this.on("data",function(t){e.push(t)}),this.on("done",function(t){e.flush(t)}),e},Zs.prototype.push=function(e){this.trigger("data",e)},Zs.prototype.flush=function(e){this.trigger("done",e)};var el,tl,nl,il,rl,al=Zs,ol=function(e,t){var n={size:0,flags:{isLeading:0,dependsOn:1,isDependedOn:0,hasRedundancy:0,degradationPriority:0,isNonSyncSample:1}};return n.dataOffset=t,n.compositionTimeOffset=e.pts-e.dts,n.duration=e.duration,n.size=4*e.length,n.size+=e.byteLength,e.keyFrame&&(n.flags.dependsOn=2,n.flags.isNonSyncSample=0),n},sl=function(e){var t,n,i=[],r=[];for(i.byteLength=0,t=0;t<e.length;t++)"access_unit_delimiter_rbsp"===(n=e[t]).nalUnitType?(i.length&&(i.duration=n.dts-i.dts,r.push(i)),(i=[n]).byteLength=n.data.byteLength,i.pts=n.pts,i.dts=n.dts):("slice_layer_without_partitioning_rbsp_idr"===n.nalUnitType&&(i.keyFrame=!0),i.duration=n.dts-i.dts,i.byteLength+=n.data.byteLength,i.push(n));return r.length&&(!i.duration||i.duration<=0)&&(i.duration=r[r.length-1].duration),r.push(i),r},ll=function(e){var t,n,i=[],r=[];for(i.byteLength=0,i.nalCount=0,i.duration=0,i.pts=e[0].pts,i.dts=e[0].dts,r.byteLength=0,r.nalCount=0,r.duration=0,r.pts=e[0].pts,r.dts=e[0].dts,t=0;t<e.length;t++)(n=e[t]).keyFrame?(i.length&&(r.push(i),r.byteLength+=i.byteLength,r.nalCount+=i.nalCount,r.duration+=i.duration),(i=[n]).nalCount=n.length,i.byteLength=n.byteLength,i.pts=n.pts,i.dts=n.dts,i.duration=n.duration):(i.duration+=n.duration,i.nalCount+=n.length,i.byteLength+=n.byteLength,i.push(n));return r.length&&i.duration<=0&&(i.duration=r[r.length-1].duration),r.byteLength+=i.byteLength,r.nalCount+=i.nalCount,r.duration+=i.duration,r.push(i),r},ul=function(e){var t;return!e[0][0].keyFrame&&e.length>1&&(t=e.shift(),e.byteLength-=t.byteLength,e.nalCount-=t.nalCount,e[0][0].dts=t.dts,e[0][0].pts=t.pts,e[0][0].duration+=t.duration),e},cl=function(e,t){var n,i,r,a,o,s=t||0,l=[];for(n=0;n<e.length;n++)for(a=e[n],i=0;i<a.length;i++)o=a[i],s+=(r=ol(o,s)).size,l.push(r);return l},dl=function(e){var t,n,i,r,a,o,s=0,l=e.byteLength,u=e.nalCount,c=new Uint8Array(l+4*u),d=new DataView(c.buffer);for(t=0;t<e.length;t++)for(r=e[t],n=0;n<r.length;n++)for(a=r[n],i=0;i<a.length;i++)o=a[i],d.setUint32(s,o.data.byteLength),s+=4,c.set(o.data,s),s+=o.data.byteLength;return c},hl=[33,16,5,32,164,27],pl=[33,65,108,84,1,2,4,8,168,2,4,8,17,191,252],fl=function(e){for(var t=[];e--;)t.push(0);return t},gl={96000:[hl,[227,64],fl(154),[56]],88200:[hl,[231],fl(170),[56]],64000:[hl,[248,192],fl(240),[56]],48000:[hl,[255,192],fl(268),[55,148,128],fl(54),[112]],44100:[hl,[255,192],fl(268),[55,163,128],fl(84),[112]],32000:[hl,[255,192],fl(268),[55,234],fl(226),[112]],24000:[hl,[255,192],fl(268),[55,255,128],fl(268),[111,112],fl(126),[224]],16000:[hl,[255,192],fl(268),[55,255,128],fl(268),[111,255],fl(269),[223,108],fl(195),[1,192]],12000:[pl,fl(268),[3,127,248],fl(268),[6,255,240],fl(268),[13,255,224],fl(268),[27,253,128],fl(259),[56]],11025:[pl,fl(268),[3,127,248],fl(268),[6,255,240],fl(268),[13,255,224],fl(268),[27,255,192],fl(268),[55,175,128],fl(108),[112]],8000:[pl,fl(268),[3,121,16],fl(47),[7]]},ml=(rl=gl,Object.keys(rl).reduce(function(e,t){return e[t]=new Uint8Array(rl[t].reduce(function(e,t){return e.concat(t)},[])),e},{})),vl=(el=function(e){return 9e4*e},tl=function(e,t){return e*t},nl=function(e){return e/9e4},il=function(e,t){return e/t},function(e,t){return el(il(e,t))}),yl=function(e,t){return tl(nl(e),t)},bl=function(e,t,n,i){var r,a,o,s=0,l=0,u=0,c=0;if(t.length&&(r=vl(e.baseMediaDecodeTime,e.samplerate),s=Math.ceil(9e4/(e.samplerate/1024)),n&&i&&(l=r-Math.max(n,i),c=(u=Math.floor(l/s))*s),!(u<1||c>45e3))){for((a=ml[e.samplerate])||(a=t[0].data),o=0;o<u;o++)t.splice(o,0,{data:a});e.baseMediaDecodeTime-=Math.floor(yl(c,e.samplerate))}},_l=function(e,t,n){return t.minSegmentDts>=n?e:(t.minSegmentDts=1/0,e.filter(function(e){return e.dts>=n&&(t.minSegmentDts=Math.min(t.minSegmentDts,e.dts),t.minSegmentPts=t.minSegmentDts,!0)}))},Tl=function(e){var t,n,i=[];for(t=0;t<e.length;t++)n=e[t],i.push({size:n.data.byteLength,duration:1024});return i},El=function(e){var t,n,i=0,r=new Uint8Array(function(e){var t,n=0;for(t=0;t<e.length;t++)n+=e[t].data.byteLength;return n}(e));for(t=0;t<e.length;t++)n=e[t],r.set(n.data,i),i+=n.data.byteLength;return r},Cl=function(e){delete e.minSegmentDts,delete e.maxSegmentDts,delete e.minSegmentPts,delete e.maxSegmentPts},wl=function(e,t){var n,i=e.minSegmentDts;return t||(i-=e.timelineStartInfo.dts),n=e.timelineStartInfo.baseMediaDecodeTime,n+=i,n=Math.max(0,n),"audio"===e.type&&(n*=e.samplerate/9e4,n=Math.floor(n)),n},kl=function(e,t){"number"==typeof t.pts&&(void 0===e.timelineStartInfo.pts&&(e.timelineStartInfo.pts=t.pts),void 0===e.minSegmentPts?e.minSegmentPts=t.pts:e.minSegmentPts=Math.min(e.minSegmentPts,t.pts),void 0===e.maxSegmentPts?e.maxSegmentPts=t.pts:e.maxSegmentPts=Math.max(e.maxSegmentPts,t.pts)),"number"==typeof t.dts&&(void 0===e.timelineStartInfo.dts&&(e.timelineStartInfo.dts=t.dts),void 0===e.minSegmentDts?e.minSegmentDts=t.dts:e.minSegmentDts=Math.min(e.minSegmentDts,t.dts),void 0===e.maxSegmentDts?e.maxSegmentDts=t.dts:e.maxSegmentDts=Math.max(e.maxSegmentDts,t.dts))},Sl=function(e){for(var t=0,n={payloadType:-1,payloadSize:0},i=0,r=0;t<e.byteLength&&128!==e[t];){for(;255===e[t];)i+=255,t++;for(i+=e[t++];255===e[t];)r+=255,t++;if(r+=e[t++],!n.payload&&4===i){n.payloadType=i,n.payloadSize=r,n.payload=e.subarray(t,t+r);break}t+=r,i=0,r=0}return n},Il=function(e){return 181!==e.payload[0]?null:49!=(e.payload[1]<<8|e.payload[2])?null:"GA94"!==String.fromCharCode(e.payload[3],e.payload[4],e.payload[5],e.payload[6])?null:3!==e.payload[7]?null:e.payload.subarray(8,e.payload.length-1)},Ol=function(e,t){var n,i,r,a,o=[];if(!(64&t[0]))return o;for(i=31&t[0],n=0;n<i;n++)a={type:3&t[2+(r=3*n)],pts:e},4&t[r+2]&&(a.ccData=t[r+3]<<8|t[r+4],o.push(a));return o},Dl=function(e){for(var t,n,i=e.byteLength,r=[],a=1;a<i-2;)0===e[a]&&0===e[a+1]&&3===e[a+2]?(r.push(a+2),a+=2):a++;if(0===r.length)return e;t=i-r.length,n=new Uint8Array(t);var o=0;for(a=0;a<t;o++,a++)o===r[0]&&(o++,r.shift()),n[a]=e[o];return n},Rl=4,xl=function e(){e.prototype.init.call(this),this.captionPackets_=[],this.ccStreams_=[new Ml(0,0),new Ml(0,1),new Ml(1,0),new Ml(1,1)],this.reset(),this.ccStreams_.forEach(function(e){e.on("data",this.trigger.bind(this,"data")),e.on("done",this.trigger.bind(this,"done"))},this)};(xl.prototype=new al).push=function(e){var t,n,i;if("sei_rbsp"===e.nalUnitType&&(t=Sl(e.escapedRBSP)).payloadType===Rl&&(n=Il(t)))if(e.dts<this.latestDts_)this.ignoreNextEqualDts_=!0;else{if(e.dts===this.latestDts_&&this.ignoreNextEqualDts_)return this.numSameDts_--,void(this.numSameDts_||(this.ignoreNextEqualDts_=!1));i=Ol(e.pts,n),this.captionPackets_=this.captionPackets_.concat(i),this.latestDts_!==e.dts&&(this.numSameDts_=0),this.numSameDts_++,this.latestDts_=e.dts}},xl.prototype.flush=function(){this.captionPackets_.length?(this.captionPackets_.forEach(function(e,t){e.presortIndex=t}),this.captionPackets_.sort(function(e,t){return e.pts===t.pts?e.presortIndex-t.presortIndex:e.pts-t.pts}),this.captionPackets_.forEach(function(e){e.type<2&&this.dispatchCea608Packet(e)},this),this.captionPackets_.length=0,this.ccStreams_.forEach(function(e){e.flush()},this)):this.ccStreams_.forEach(function(e){e.flush()},this)},xl.prototype.reset=function(){this.latestDts_=null,this.ignoreNextEqualDts_=!1,this.numSameDts_=0,this.activeCea608Channel_=[null,null],this.ccStreams_.forEach(function(e){e.reset()})},xl.prototype.dispatchCea608Packet=function(e){this.setsTextOrXDSActive(e)?this.activeCea608Channel_[e.type]=null:this.setsChannel1Active(e)?this.activeCea608Channel_[e.type]=0:this.setsChannel2Active(e)&&(this.activeCea608Channel_[e.type]=1),null!==this.activeCea608Channel_[e.type]&&this.ccStreams_[(e.type<<1)+this.activeCea608Channel_[e.type]].push(e)},xl.prototype.setsChannel1Active=function(e){return 4096==(30720&e.ccData)},xl.prototype.setsChannel2Active=function(e){return 6144==(30720&e.ccData)},xl.prototype.setsTextOrXDSActive=function(e){return 256==(28928&e.ccData)||4138==(30974&e.ccData)||6186==(30974&e.ccData)};var Al={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,304:174,305:176,306:189,307:191,308:8482,309:162,310:163,311:9834,312:224,313:160,314:232,315:226,316:234,317:238,318:244,319:251,544:193,545:201,546:211,547:218,548:220,549:252,550:8216,551:161,552:42,553:39,554:8212,555:169,556:8480,557:8226,558:8220,559:8221,560:192,561:194,562:199,563:200,564:202,565:203,566:235,567:206,568:207,569:239,570:212,571:217,572:249,573:219,574:171,575:187,800:195,801:227,802:205,803:204,804:236,805:210,806:242,807:213,808:245,809:123,810:125,811:92,812:94,813:95,814:124,815:126,816:196,817:228,818:214,819:246,820:223,821:165,822:164,823:9474,824:197,825:229,826:216,827:248,828:9484,829:9488,830:9492,831:9496},Pl=function(e){return null===e?"":(e=Al[e]||e,String.fromCharCode(e))},Ll=[4352,4384,4608,4640,5376,5408,5632,5664,5888,5920,4096,4864,4896,5120,5152],Nl=function(){for(var e=[],t=15;t--;)e.push("");return e},Ml=function e(t,n){e.prototype.init.call(this),this.field_=t||0,this.dataChannel_=n||0,this.name_="CC"+(1+(this.field_<<1|this.dataChannel_)),this.setConstants(),this.reset(),this.push=function(e){var t,n,i,r,a;if((t=32639&e.ccData)!==this.lastControlCode_){if(4096==(61440&t)?this.lastControlCode_=t:t!==this.PADDING_&&(this.lastControlCode_=null),i=t>>>8,r=255&t,t!==this.PADDING_)if(t===this.RESUME_CAPTION_LOADING_)this.mode_="popOn";else if(t===this.END_OF_CAPTION_)this.mode_="popOn",this.clearFormatting(e.pts),this.flushDisplayed(e.pts),n=this.displayed_,this.displayed_=this.nonDisplayed_,this.nonDisplayed_=n,this.startPts_=e.pts;else if(t===this.ROLL_UP_2_ROWS_)this.rollUpRows_=2,this.setRollUp(e.pts);else if(t===this.ROLL_UP_3_ROWS_)this.rollUpRows_=3,this.setRollUp(e.pts);else if(t===this.ROLL_UP_4_ROWS_)this.rollUpRows_=4,this.setRollUp(e.pts);else if(t===this.CARRIAGE_RETURN_)this.clearFormatting(e.pts),this.flushDisplayed(e.pts),this.shiftRowsUp_(),this.startPts_=e.pts;else if(t===this.BACKSPACE_)"popOn"===this.mode_?this.nonDisplayed_[this.row_]=this.nonDisplayed_[this.row_].slice(0,-1):this.displayed_[this.row_]=this.displayed_[this.row_].slice(0,-1);else if(t===this.ERASE_DISPLAYED_MEMORY_)this.flushDisplayed(e.pts),this.displayed_=Nl();else if(t===this.ERASE_NON_DISPLAYED_MEMORY_)this.nonDisplayed_=Nl();else if(t===this.RESUME_DIRECT_CAPTIONING_)"paintOn"!==this.mode_&&(this.flushDisplayed(e.pts),this.displayed_=Nl()),this.mode_="paintOn",this.startPts_=e.pts;else if(this.isSpecialCharacter(i,r))a=Pl((i=(3&i)<<8)|r),this[this.mode_](e.pts,a),this.column_++;else if(this.isExtCharacter(i,r))"popOn"===this.mode_?this.nonDisplayed_[this.row_]=this.nonDisplayed_[this.row_].slice(0,-1):this.displayed_[this.row_]=this.displayed_[this.row_].slice(0,-1),a=Pl((i=(3&i)<<8)|r),this[this.mode_](e.pts,a),this.column_++;else if(this.isMidRowCode(i,r))this.clearFormatting(e.pts),this[this.mode_](e.pts," "),this.column_++,14==(14&r)&&this.addFormatting(e.pts,["i"]),1==(1&r)&&this.addFormatting(e.pts,["u"]);else if(this.isOffsetControlCode(i,r))this.column_+=3&r;else if(this.isPAC(i,r)){var o=Ll.indexOf(7968&t);"rollUp"===this.mode_&&(o-this.rollUpRows_+1<0&&(o=this.rollUpRows_-1),this.setRollUp(e.pts,o)),o!==this.row_&&(this.clearFormatting(e.pts),this.row_=o),1&r&&-1===this.formatting_.indexOf("u")&&this.addFormatting(e.pts,["u"]),16==(16&t)&&(this.column_=4*((14&t)>>1)),this.isColorPAC(r)&&14==(14&r)&&this.addFormatting(e.pts,["i"])}else this.isNormalChar(i)&&(0===r&&(r=null),a=Pl(i),a+=Pl(r),this[this.mode_](e.pts,a),this.column_+=a.length)}else this.lastControlCode_=null}};Ml.prototype=new al,Ml.prototype.flushDisplayed=function(e){var t=this.displayed_.map(function(e){try{return e.trim()}catch(e){return console.error("Skipping malformed caption."),""}}).join("\n").replace(/^\n+|\n+$/g,"");t.length&&this.trigger("data",{startPts:this.startPts_,endPts:e,text:t,stream:this.name_})},Ml.prototype.reset=function(){this.mode_="popOn",this.topRow_=0,this.startPts_=0,this.displayed_=Nl(),this.nonDisplayed_=Nl(),this.lastControlCode_=null,this.column_=0,this.row_=14,this.rollUpRows_=2,this.formatting_=[]},Ml.prototype.setConstants=function(){0===this.dataChannel_?(this.BASE_=16,this.EXT_=17,this.CONTROL_=(20|this.field_)<<8,this.OFFSET_=23):1===this.dataChannel_&&(this.BASE_=24,this.EXT_=25,this.CONTROL_=(28|this.field_)<<8,this.OFFSET_=31),this.PADDING_=0,this.RESUME_CAPTION_LOADING_=32|this.CONTROL_,this.END_OF_CAPTION_=47|this.CONTROL_,this.ROLL_UP_2_ROWS_=37|this.CONTROL_,this.ROLL_UP_3_ROWS_=38|this.CONTROL_,this.ROLL_UP_4_ROWS_=39|this.CONTROL_,this.CARRIAGE_RETURN_=45|this.CONTROL_,this.RESUME_DIRECT_CAPTIONING_=41|this.CONTROL_,this.BACKSPACE_=33|this.CONTROL_,this.ERASE_DISPLAYED_MEMORY_=44|this.CONTROL_,this.ERASE_NON_DISPLAYED_MEMORY_=46|this.CONTROL_},Ml.prototype.isSpecialCharacter=function(e,t){return e===this.EXT_&&t>=48&&t<=63},Ml.prototype.isExtCharacter=function(e,t){return(e===this.EXT_+1||e===this.EXT_+2)&&t>=32&&t<=63},Ml.prototype.isMidRowCode=function(e,t){return e===this.EXT_&&t>=32&&t<=47},Ml.prototype.isOffsetControlCode=function(e,t){return e===this.OFFSET_&&t>=33&&t<=35},Ml.prototype.isPAC=function(e,t){return e>=this.BASE_&&e<this.BASE_+8&&t>=64&&t<=127},Ml.prototype.isColorPAC=function(e){return e>=64&&e<=79||e>=96&&e<=127},Ml.prototype.isNormalChar=function(e){return e>=32&&e<=127},Ml.prototype.setRollUp=function(e,t){if("rollUp"!==this.mode_&&(this.row_=14,this.mode_="rollUp",this.flushDisplayed(e),this.nonDisplayed_=Nl(),this.displayed_=Nl()),void 0!==t&&t!==this.row_)for(var n=0;n<this.rollUpRows_;n++)this.displayed_[t-n]=this.displayed_[this.row_-n],this.displayed_[this.row_-n]="";void 0===t&&(t=this.row_),this.topRow_=t-this.rollUpRows_+1},Ml.prototype.addFormatting=function(e,t){this.formatting_=this.formatting_.concat(t);var n=t.reduce(function(e,t){return e+"<"+t+">"},"");this[this.mode_](e,n)},Ml.prototype.clearFormatting=function(e){if(this.formatting_.length){var t=this.formatting_.reverse().reduce(function(e,t){return e+"</"+t+">"},"");this.formatting_=[],this[this.mode_](e,t)}},Ml.prototype.popOn=function(e,t){var n=this.nonDisplayed_[this.row_];n+=t,this.nonDisplayed_[this.row_]=n},Ml.prototype.rollUp=function(e,t){var n=this.displayed_[this.row_];n+=t,this.displayed_[this.row_]=n},Ml.prototype.shiftRowsUp_=function(){var e;for(e=0;e<this.topRow_;e++)this.displayed_[e]="";for(e=this.row_+1;e<15;e++)this.displayed_[e]="";for(e=this.topRow_;e<this.row_;e++)this.displayed_[e]=this.displayed_[e+1];this.displayed_[this.row_]=""},Ml.prototype.paintOn=function(e,t){var n=this.displayed_[this.row_];n+=t,this.displayed_[this.row_]=n};var Kl={CaptionStream:xl,Cea608Stream:Ml},$l={H264_STREAM_TYPE:27,ADTS_STREAM_TYPE:15,METADATA_STREAM_TYPE:21},jl=function(e,t){var n=1;for(e>t&&(n=-1);Math.abs(t-e)>4294967296;)e+=8589934592*n;return e},Bl=function e(t){var n,i;e.prototype.init.call(this),this.type_=t,this.push=function(e){e.type===this.type_&&(void 0===i&&(i=e.dts),e.dts=jl(e.dts,i),e.pts=jl(e.pts,i),n=e.dts,this.trigger("data",e))},this.flush=function(){i=n,this.trigger("done")},this.discontinuity=function(){i=void 0,n=void 0}};Bl.prototype=new al;var Fl,Ul=Bl,Vl=jl,ql=function(e,t,n){var i,r="";for(i=t;i<n;i++)r+="%"+("00"+e[i].toString(16)).slice(-2);return r},Hl=function(e,t,n){return decodeURIComponent(ql(e,t,n))},zl=function(e){return e[0]<<21|e[1]<<14|e[2]<<7|e[3]},Wl={TXXX:function(e){var t;if(3===e.data[0]){for(t=1;t<e.data.length;t++)if(0===e.data[t]){e.description=Hl(e.data,1,t),e.value=Hl(e.data,t+1,e.data.length).replace(/\0*$/,"");break}e.data=e.value}},WXXX:function(e){var t;if(3===e.data[0])for(t=1;t<e.data.length;t++)if(0===e.data[t]){e.description=Hl(e.data,1,t),e.url=Hl(e.data,t+1,e.data.length);break}},PRIV:function(e){var t,n;for(t=0;t<e.data.length;t++)if(0===e.data[t]){e.owner=(n=e.data,unescape(ql(n,start,end)));break}e.privateData=e.data.subarray(t+1),e.data=e.privateData}};(Fl=function(e){var t,n={debug:!(!e||!e.debug),descriptor:e&&e.descriptor},i=0,r=[],a=0;if(Fl.prototype.init.call(this),this.dispatchType=$l.METADATA_STREAM_TYPE.toString(16),n.descriptor)for(t=0;t<n.descriptor.length;t++)this.dispatchType+=("00"+n.descriptor[t].toString(16)).slice(-2);this.push=function(e){var t,o,s,l,u;if("timed-metadata"===e.type)if(e.dataAlignmentIndicator&&(a=0,r.length=0),0===r.length&&(e.data.length<10||e.data[0]!=="I".charCodeAt(0)||e.data[1]!=="D".charCodeAt(0)||e.data[2]!=="3".charCodeAt(0)))n.debug&&console.log("Skipping unrecognized metadata packet");else if(r.push(e),a+=e.data.byteLength,1===r.length&&(i=zl(e.data.subarray(6,10)),i+=10),!(a<i)){for(t={data:new Uint8Array(i),frames:[],pts:r[0].pts,dts:r[0].dts},u=0;u<i;)t.data.set(r[0].data.subarray(0,i-u),u),u+=r[0].data.byteLength,a-=r[0].data.byteLength,r.shift();o=10,64&t.data[5]&&(o+=4,o+=zl(t.data.subarray(10,14)),i-=zl(t.data.subarray(16,20)));do{if((s=zl(t.data.subarray(o+4,o+8)))<1)return console.log("Malformed ID3 frame encountered. Skipping metadata parsing.");if((l={id:String.fromCharCode(t.data[o],t.data[o+1],t.data[o+2],t.data[o+3]),data:t.data.subarray(o+10,o+s+10)}).key=l.id,Wl[l.id]&&(Wl[l.id](l),"com.apple.streaming.transportStreamTimestamp"===l.owner)){var c=l.data,d=(1&c[3])<<30|c[4]<<22|c[5]<<14|c[6]<<6|c[7]>>>2;d*=4,d+=3&c[7],l.timeStamp=d,void 0===t.pts&&void 0===t.dts&&(t.pts=l.timeStamp,t.dts=l.timeStamp),this.trigger("timestamp",l)}t.frames.push(l),o+=10,o+=s}while(o<i);this.trigger("data",t)}}}).prototype=new al;var Gl,Xl,Yl,Ql=Fl,Jl=Ul;(Gl=function(){var e=new Uint8Array(188),t=0;Gl.prototype.init.call(this),this.push=function(n){var i,r=0,a=188;for(t?((i=new Uint8Array(n.byteLength+t)).set(e.subarray(0,t)),i.set(n,t),t=0):i=n;a<i.byteLength;)71!==i[r]||71!==i[a]?(r++,a++):(this.trigger("data",i.subarray(r,a)),r+=188,a+=188);r<i.byteLength&&(e.set(i.subarray(r),0),t=i.byteLength-r)},this.flush=function(){188===t&&71===e[0]&&(this.trigger("data",e),t=0),this.trigger("done")}}).prototype=new al,(Xl=function(){var e,t,n,i;Xl.prototype.init.call(this),i=this,this.packetsWaitingForPmt=[],this.programMapTable=void 0,e=function(e,i){var r=0;i.payloadUnitStartIndicator&&(r+=e[r]+1),"pat"===i.type?t(e.subarray(r),i):n(e.subarray(r),i)},t=function(e,t){t.section_number=e[7],t.last_section_number=e[8],i.pmtPid=(31&e[10])<<8|e[11],t.pmtPid=i.pmtPid},n=function(e,t){var n,r;if(1&e[5]){for(i.programMapTable={video:null,audio:null,"timed-metadata":{}},n=3+((15&e[1])<<8|e[2])-4,r=12+((15&e[10])<<8|e[11]);r<n;){var a=e[r],o=(31&e[r+1])<<8|e[r+2];a===$l.H264_STREAM_TYPE&&null===i.programMapTable.video?i.programMapTable.video=o:a===$l.ADTS_STREAM_TYPE&&null===i.programMapTable.audio?i.programMapTable.audio=o:a===$l.METADATA_STREAM_TYPE&&(i.programMapTable["timed-metadata"][o]=a),r+=5+((15&e[r+3])<<8|e[r+4])}t.programMapTable=i.programMapTable}},this.push=function(t){var n={},i=4;if(n.payloadUnitStartIndicator=!!(64&t[1]),n.pid=31&t[1],n.pid<<=8,n.pid|=t[2],(48&t[3])>>>4>1&&(i+=t[i]+1),0===n.pid)n.type="pat",e(t.subarray(i),n),this.trigger("data",n);else if(n.pid===this.pmtPid)for(n.type="pmt",e(t.subarray(i),n),this.trigger("data",n);this.packetsWaitingForPmt.length;)this.processPes_.apply(this,this.packetsWaitingForPmt.shift());else void 0===this.programMapTable?this.packetsWaitingForPmt.push([t,i,n]):this.processPes_(t,i,n)},this.processPes_=function(e,t,n){n.pid===this.programMapTable.video?n.streamType=$l.H264_STREAM_TYPE:n.pid===this.programMapTable.audio?n.streamType=$l.ADTS_STREAM_TYPE:n.streamType=this.programMapTable["timed-metadata"][n.pid],n.type="pes",n.data=e.subarray(t),this.trigger("data",n)}}).prototype=new al,Xl.STREAM_TYPES={h264:27,adts:15},(Yl=function(){var e=this,t={data:[],size:0},n={data:[],size:0},i={data:[],size:0},r=function(t,n,i){var r,a,o,s,l=new Uint8Array(t.size),u={type:n},c=0,d=0,h=!1;if(t.data.length&&!(t.size<9)){for(u.trackId=t.data[0].pid,c=0;c<t.data.length;c++)r=t.data[c],l.set(r.data,d),d+=r.data.byteLength;a=l,(o=u).packetLength=6+(a[4]<<8|a[5]),o.dataAlignmentIndicator=0!=(4&a[6]),192&(s=a[7])&&(o.pts=(14&a[9])<<27|(255&a[10])<<20|(254&a[11])<<12|(255&a[12])<<5|(254&a[13])>>>3,o.pts*=4,o.pts+=(6&a[13])>>>1,o.dts=o.pts,64&s&&(o.dts=(14&a[14])<<27|(255&a[15])<<20|(254&a[16])<<12|(255&a[17])<<5|(254&a[18])>>>3,o.dts*=4,o.dts+=(6&a[18])>>>1)),o.data=a.subarray(9+a[8]),h="video"===n||u.packetLength<=t.size,(i||h)&&(t.size=0,t.data.length=0),h&&e.trigger("data",u)}};Yl.prototype.init.call(this),this.push=function(a){({pat:function(){},pes:function(){var e,o;switch(a.streamType){case $l.H264_STREAM_TYPE:case $l.H264_STREAM_TYPE:e=t,o="video";break;case $l.ADTS_STREAM_TYPE:e=n,o="audio";break;case $l.METADATA_STREAM_TYPE:e=i,o="timed-metadata";break;default:return}a.payloadUnitStartIndicator&&r(e,o,!0),e.data.push(a),e.size+=a.data.byteLength},pmt:function(){var t={type:"metadata",tracks:[]},n=a.programMapTable;null!==n.video&&t.tracks.push({timelineStartInfo:{baseMediaDecodeTime:0},id:+n.video,codec:"avc",type:"video"}),null!==n.audio&&t.tracks.push({timelineStartInfo:{baseMediaDecodeTime:0},id:+n.audio,codec:"adts",type:"audio"}),e.trigger("data",t)}})[a.type]()},this.flush=function(){r(t,"video"),r(n,"audio"),r(i,"timed-metadata"),this.trigger("done")}}).prototype=new al;var Zl={PAT_PID:0,MP2T_PACKET_LENGTH:188,TransportPacketStream:Gl,TransportParseStream:Xl,ElementaryStream:Yl,TimestampRolloverStream:Jl,CaptionStream:Kl.CaptionStream,Cea608Stream:Kl.Cea608Stream,MetadataStream:Ql};for(var eu in $l)$l.hasOwnProperty(eu)&&(Zl[eu]=$l[eu]);var tu,nu=Zl,iu=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350];(tu=function(){var e;tu.prototype.init.call(this),this.push=function(t){var n,i,r,a,o,s,l=0,u=0;if("audio"===t.type)for(e?(a=e,(e=new Uint8Array(a.byteLength+t.data.byteLength)).set(a),e.set(t.data,a.byteLength)):e=t.data;l+5<e.length;)if(255===e[l]&&240==(246&e[l+1])){if(i=2*(1&~e[l+1]),n=(3&e[l+3])<<11|e[l+4]<<3|(224&e[l+5])>>5,s=9e4*(o=1024*(1+(3&e[l+6])))/iu[(60&e[l+2])>>>2],r=l+n,e.byteLength<r)return;if(this.trigger("data",{pts:t.pts+u*s,dts:t.dts+u*s,sampleCount:o,audioobjecttype:1+(e[l+2]>>>6&3),channelcount:(1&e[l+2])<<2|(192&e[l+3])>>>6,samplerate:iu[(60&e[l+2])>>>2],samplingfrequencyindex:(60&e[l+2])>>>2,samplesize:16,data:e.subarray(l+7+i,r)}),e.byteLength===r)return void(e=void 0);u++,e=e.subarray(r)}else l++},this.flush=function(){this.trigger("done")}}).prototype=new al;var ru,au,ou,su=tu;(au=function(){var e,t,n=0;au.prototype.init.call(this),this.push=function(i){var r;for(t?((r=new Uint8Array(t.byteLength+i.data.byteLength)).set(t),r.set(i.data,t.byteLength),t=r):t=i.data;n<t.byteLength-3;n++)if(1===t[n+2]){e=n+5;break}for(;e<t.byteLength;)switch(t[e]){case 0:if(0!==t[e-1]){e+=2;break}if(0!==t[e-2]){e++;break}n+3!==e-2&&this.trigger("data",t.subarray(n+3,e-2));do{e++}while(1!==t[e]&&e<t.length);n=e-2,e+=3;break;case 1:if(0!==t[e-1]||0!==t[e-2]){e+=3;break}this.trigger("data",t.subarray(n+3,e-2)),n=e-2,e+=3;break;default:e+=3}t=t.subarray(n),e-=n,n=0},this.flush=function(){t&&t.byteLength>3&&this.trigger("data",t.subarray(n+3)),t=null,n=0,this.trigger("done")}}).prototype=new al,ou={100:!0,110:!0,122:!0,244:!0,44:!0,83:!0,86:!0,118:!0,128:!0,138:!0,139:!0,134:!0},(ru=function(){var e,t,n,i,r,a,o,s=new au;ru.prototype.init.call(this),e=this,this.push=function(e){"video"===e.type&&(t=e.trackId,n=e.pts,i=e.dts,s.push(e))},s.on("data",function(o){var s={trackId:t,pts:n,dts:i,data:o};switch(31&o[0]){case 5:s.nalUnitType="slice_layer_without_partitioning_rbsp_idr";break;case 6:s.nalUnitType="sei_rbsp",s.escapedRBSP=r(o.subarray(1));break;case 7:s.nalUnitType="seq_parameter_set_rbsp",s.escapedRBSP=r(o.subarray(1)),s.config=a(s.escapedRBSP);break;case 8:s.nalUnitType="pic_parameter_set_rbsp";break;case 9:s.nalUnitType="access_unit_delimiter_rbsp"}e.trigger("data",s)}),s.on("done",function(){e.trigger("done")}),this.flush=function(){s.flush()},o=function(e,t){var n,i=8,r=8;for(n=0;n<e;n++)0!==r&&(r=(i+t.readExpGolomb()+256)%256),i=0===r?i:r},r=function(e){for(var t,n,i=e.byteLength,r=[],a=1;a<i-2;)0===e[a]&&0===e[a+1]&&3===e[a+2]?(r.push(a+2),a+=2):a++;if(0===r.length)return e;t=i-r.length,n=new Uint8Array(t);var o=0;for(a=0;a<t;o++,a++)o===r[0]&&(o++,r.shift()),n[a]=e[o];return n},a=function(e){var t,n,i,r,a,s,l,u,c,d,h,p,f,g=0,m=0,v=0,y=0,b=1;if(t=new function(e){var t=e.byteLength,n=0,i=0;this.length=function(){return 8*t},this.bitsAvailable=function(){return 8*t+i},this.loadWord=function(){var r=e.byteLength-t,a=new Uint8Array(4),o=Math.min(4,t);if(0===o)throw new Error("no bytes available");a.set(e.subarray(r,r+o)),n=new DataView(a.buffer).getUint32(0),i=8*o,t-=o},this.skipBits=function(e){var r;i>e?(n<<=e,i-=e):(e-=i,e-=8*(r=Math.floor(e/8)),t-=r,this.loadWord(),n<<=e,i-=e)},this.readBits=function(e){var r=Math.min(i,e),a=n>>>32-r;return(i-=r)>0?n<<=r:t>0&&this.loadWord(),(r=e-r)>0?a<<r|this.readBits(r):a},this.skipLeadingZeros=function(){var e;for(e=0;e<i;++e)if(0!=(n&2147483648>>>e))return n<<=e,i-=e,e;return this.loadWord(),e+this.skipLeadingZeros()},this.skipUnsignedExpGolomb=function(){this.skipBits(1+this.skipLeadingZeros())},this.skipExpGolomb=function(){this.skipBits(1+this.skipLeadingZeros())},this.readUnsignedExpGolomb=function(){var e=this.skipLeadingZeros();return this.readBits(e+1)-1},this.readExpGolomb=function(){var e=this.readUnsignedExpGolomb();return 1&e?1+e>>>1:-1*(e>>>1)},this.readBoolean=function(){return 1===this.readBits(1)},this.readUnsignedByte=function(){return this.readBits(8)},this.loadWord()}(e),n=t.readUnsignedByte(),r=t.readUnsignedByte(),i=t.readUnsignedByte(),t.skipUnsignedExpGolomb(),ou[n]&&(3===(a=t.readUnsignedExpGolomb())&&t.skipBits(1),t.skipUnsignedExpGolomb(),t.skipUnsignedExpGolomb(),t.skipBits(1),t.readBoolean()))for(h=3!==a?8:12,f=0;f<h;f++)t.readBoolean()&&o(f<6?16:64,t);if(t.skipUnsignedExpGolomb(),0===(s=t.readUnsignedExpGolomb()))t.readUnsignedExpGolomb();else if(1===s)for(t.skipBits(1),t.skipExpGolomb(),t.skipExpGolomb(),l=t.readUnsignedExpGolomb(),f=0;f<l;f++)t.skipExpGolomb();if(t.skipUnsignedExpGolomb(),t.skipBits(1),u=t.readUnsignedExpGolomb(),c=t.readUnsignedExpGolomb(),0===(d=t.readBits(1))&&t.skipBits(1),t.skipBits(1),t.readBoolean()&&(g=t.readUnsignedExpGolomb(),m=t.readUnsignedExpGolomb(),v=t.readUnsignedExpGolomb(),y=t.readUnsignedExpGolomb()),t.readBoolean()&&t.readBoolean()){switch(t.readUnsignedByte()){case 1:p=[1,1];break;case 2:p=[12,11];break;case 3:p=[10,11];break;case 4:p=[16,11];break;case 5:p=[40,33];break;case 6:p=[24,11];break;case 7:p=[20,11];break;case 8:p=[32,11];break;case 9:p=[80,33];break;case 10:p=[18,11];break;case 11:p=[15,11];break;case 12:p=[64,33];break;case 13:p=[160,99];break;case 14:p=[4,3];break;case 15:p=[3,2];break;case 16:p=[2,1];break;case 255:p=[t.readUnsignedByte()<<8|t.readUnsignedByte(),t.readUnsignedByte()<<8|t.readUnsignedByte()]}p&&(b=p[0]/p[1])}return{profileIdc:n,levelIdc:i,profileCompatibility:r,width:Math.ceil((16*(u+1)-2*g-2*m)*b),height:(2-d)*(c+1)*16-2*v-2*y}}}).prototype=new al;var lu,uu={H264Stream:ru,NalByteStream:au},cu=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350],du=function(e){return e[0]<<21|e[1]<<14|e[2]<<7|e[3]},hu={isLikelyAacData:function(e){return e[0]==="I".charCodeAt(0)&&e[1]==="D".charCodeAt(0)&&e[2]==="3".charCodeAt(0)},parseId3TagSize:function(e,t){var n=e[t+6]<<21|e[t+7]<<14|e[t+8]<<7|e[t+9];return(16&e[t+5])>>4?n+20:n+10},parseAdtsSize:function(e,t){var n=(224&e[t+5])>>5,i=e[t+4]<<3;return 6144&e[t+3]|i|n},parseType:function(e,t){return e[t]==="I".charCodeAt(0)&&e[t+1]==="D".charCodeAt(0)&&e[t+2]==="3".charCodeAt(0)?"timed-metadata":!0&e[t]&&240==(240&e[t+1])?"audio":null},parseSampleRate:function(e){for(var t=0;t+5<e.length;){if(255===e[t]&&240==(246&e[t+1]))return cu[(60&e[t+2])>>>2];t++}return null},parseAacTimestamp:function(e){var t,n,i;t=10,64&e[5]&&(t+=4,t+=du(e.subarray(10,14)));do{if((n=du(e.subarray(t+4,t+8)))<1)return null;if("PRIV"===String.fromCharCode(e[t],e[t+1],e[t+2],e[t+3])){i=e.subarray(t+10,t+n+10);for(var r=0;r<i.byteLength;r++)if(0===i[r]){if("com.apple.streaming.transportStreamTimestamp"===unescape(function(e,t,n){var i,r="";for(i=t;i<n;i++)r+="%"+("00"+e[i].toString(16)).slice(-2);return r}(bytes,start,end))){var a=i.subarray(r+1),o=(1&a[3])<<30|a[4]<<22|a[5]<<14|a[6]<<6|a[7]>>>2;return(o*=4)+(3&a[7])}break}}t+=10,t+=n}while(t<e.byteLength);return null}};(lu=function(){var e=new Uint8Array,t=0;lu.prototype.init.call(this),this.setTimestamp=function(e){t=e},this.push=function(n){var i,r,a,o,s=0,l=0;for(e.length?(o=e.length,(e=new Uint8Array(n.byteLength+o)).set(e.subarray(0,o)),e.set(n,o)):e=n;e.length-l>=3;)if(e[l]!=="I".charCodeAt(0)||e[l+1]!=="D".charCodeAt(0)||e[l+2]!=="3".charCodeAt(0))if(255!=(255&e[l])||240!=(240&e[l+1]))l++;else{if(e.length-l<7)break;if(l+(s=hu.parseAdtsSize(e,l))>e.length)break;a={type:"audio",data:e.subarray(l,l+s),pts:t,dts:t},this.trigger("data",a),l+=s}else{if(e.length-l<10)break;if(l+(s=hu.parseId3TagSize(e,l))>e.length)break;r={type:"timed-metadata",data:e.subarray(l,l+s)},this.trigger("data",r),l+=s}i=e.length-l,e=i>0?e.subarray(l):new Uint8Array}}).prototype=new al;var pu,fu,gu,mu,vu=lu,yu=uu.H264Stream,bu=hu.isLikelyAacData,_u=["audioobjecttype","channelcount","samplerate","samplingfrequencyindex","samplesize"],Tu=["width","height","profileIdc","levelIdc","profileCompatibility"],Eu=function(e,t){var n;if(e.length!==t.length)return!1;for(n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0},Cu=function(e,t,n,i,r,a){return{start:{dts:e,pts:e+(n-t)},end:{dts:e+(i-t),pts:e+(r-n)},prependedContentDuration:a,baseMediaDecodeTime:e}};(fu=function(e,t){var n=[],i=0,r=0,a=0,o=1/0;t=t||{},fu.prototype.init.call(this),this.push=function(t){kl(e,t),e&&_u.forEach(function(n){e[n]=t[n]}),n.push(t)},this.setEarliestDts=function(t){r=t-e.timelineStartInfo.baseMediaDecodeTime},this.setVideoBaseMediaDecodeTime=function(e){o=e},this.setAudioAppendStart=function(e){a=e},this.flush=function(){var s,l,u,c;0!==n.length?(s=_l(n,e,r),e.baseMediaDecodeTime=wl(e,t.keepOriginalTimestamps),bl(e,s,a,o),e.samples=Tl(s),u=Js.mdat(El(s)),n=[],l=Js.moof(i,[e]),c=new Uint8Array(l.byteLength+u.byteLength),i++,c.set(l),c.set(u,l.byteLength),Cl(e),this.trigger("data",{track:e,boxes:c}),this.trigger("done","AudioSegmentStream")):this.trigger("done","AudioSegmentStream")}}).prototype=new al,(pu=function(e,t){var n,i,r=0,a=[],o=[];t=t||{},pu.prototype.init.call(this),delete e.minPTS,this.gopCache_=[],this.push=function(t){kl(e,t),"seq_parameter_set_rbsp"!==t.nalUnitType||n||(n=t.config,e.sps=[t.data],Tu.forEach(function(t){e[t]=n[t]},this)),"pic_parameter_set_rbsp"!==t.nalUnitType||i||(i=t.data,e.pps=[t.data]),a.push(t)},this.flush=function(){for(var n,i,s,l,u,c,d,h,p=0;a.length&&"access_unit_delimiter_rbsp"!==a[0].nalUnitType;)a.shift();if(0===a.length)return this.resetStream_(),void this.trigger("done","VideoSegmentStream");if(n=sl(a),(s=ll(n))[0][0].keyFrame||((i=this.getGopForFusion_(a[0],e))?(p=i.duration,s.unshift(i),s.byteLength+=i.byteLength,s.nalCount+=i.nalCount,s.pts=i.pts,s.dts=i.dts,s.duration+=i.duration):s=ul(s)),o.length){var f;if(!(f=t.alignGopsAtEnd?this.alignGopsAtEnd_(s):this.alignGopsAtStart_(s)))return this.gopCache_.unshift({gop:s.pop(),pps:e.pps,sps:e.sps}),this.gopCache_.length=Math.min(6,this.gopCache_.length),a=[],this.resetStream_(),void this.trigger("done","VideoSegmentStream");Cl(e),s=f}kl(e,s),e.samples=cl(s),u=Js.mdat(dl(s)),e.baseMediaDecodeTime=wl(e,t.keepOriginalTimestamps),this.trigger("processedGopsInfo",s.map(function(e){return{pts:e.pts,dts:e.dts,byteLength:e.byteLength}})),d=s[0],h=s[s.length-1],this.trigger("segmentTimingInfo",Cu(e.baseMediaDecodeTime,d.dts,d.pts,h.dts+h.duration,h.pts+h.duration,p)),this.gopCache_.unshift({gop:s.pop(),pps:e.pps,sps:e.sps}),this.gopCache_.length=Math.min(6,this.gopCache_.length),a=[],this.trigger("baseMediaDecodeTime",e.baseMediaDecodeTime),this.trigger("timelineStartInfo",e.timelineStartInfo),l=Js.moof(r,[e]),c=new Uint8Array(l.byteLength+u.byteLength),r++,c.set(l),c.set(u,l.byteLength),this.trigger("data",{track:e,boxes:c}),this.resetStream_(),this.trigger("done","VideoSegmentStream")},this.resetStream_=function(){Cl(e),n=void 0,i=void 0},this.getGopForFusion_=function(t){var n,i,r,a,o,s=1/0;for(o=0;o<this.gopCache_.length;o++)r=(a=this.gopCache_[o]).gop,e.pps&&Eu(e.pps[0],a.pps[0])&&e.sps&&Eu(e.sps[0],a.sps[0])&&(r.dts<e.timelineStartInfo.dts||(n=t.dts-r.dts-r.duration)>=-1e4&&n<=45e3&&(!i||s>n)&&(i=a,s=n));return i?i.gop:null},this.alignGopsAtStart_=function(e){var t,n,i,r,a,s,l,u;for(a=e.byteLength,s=e.nalCount,l=e.duration,t=n=0;t<o.length&&n<e.length&&(i=o[t],r=e[n],i.pts!==r.pts);)r.pts>i.pts?t++:(n++,a-=r.byteLength,s-=r.nalCount,l-=r.duration);return 0===n?e:n===e.length?null:((u=e.slice(n)).byteLength=a,u.duration=l,u.nalCount=s,u.pts=u[0].pts,u.dts=u[0].dts,u)},this.alignGopsAtEnd_=function(e){var t,n,i,r,a,s,l;for(t=o.length-1,n=e.length-1,a=null,s=!1;t>=0&&n>=0;){if(i=o[t],r=e[n],i.pts===r.pts){s=!0;break}i.pts>r.pts?t--:(t===o.length-1&&(a=n),n--)}if(!s&&null===a)return null;if(0===(l=s?n:a))return e;var u=e.slice(l),c=u.reduce(function(e,t){return e.byteLength+=t.byteLength,e.duration+=t.duration,e.nalCount+=t.nalCount,e},{byteLength:0,duration:0,nalCount:0});return u.byteLength=c.byteLength,u.duration=c.duration,u.nalCount=c.nalCount,u.pts=u[0].pts,u.dts=u[0].dts,u},this.alignGopsWith=function(e){o=e}}).prototype=new al,(mu=function(e,t){this.numberOfTracks=0,this.metadataStream=t,void 0!==(e=e||{}).remux?this.remuxTracks=!!e.remux:this.remuxTracks=!0,"boolean"==typeof e.keepOriginalTimestamps&&(this.keepOriginalTimestamps=e.keepOriginalTimestamps),this.pendingTracks=[],this.videoTrack=null,this.pendingBoxes=[],this.pendingCaptions=[],this.pendingMetadata=[],this.pendingBytes=0,this.emittedTracks=0,mu.prototype.init.call(this),this.push=function(e){return e.text?this.pendingCaptions.push(e):e.frames?this.pendingMetadata.push(e):(this.pendingTracks.push(e.track),this.pendingBoxes.push(e.boxes),this.pendingBytes+=e.boxes.byteLength,"video"===e.track.type&&(this.videoTrack=e.track),void("audio"===e.track.type&&(this.audioTrack=e.track)))}}).prototype=new al,mu.prototype.flush=function(e){var t,n,i,r,a=0,o={captions:[],captionStreams:{},metadata:[],info:{}},s=0;if(this.pendingTracks.length<this.numberOfTracks){if("VideoSegmentStream"!==e&&"AudioSegmentStream"!==e)return;if(this.remuxTracks)return;if(0===this.pendingTracks.length)return this.emittedTracks++,void(this.emittedTracks>=this.numberOfTracks&&(this.trigger("done"),this.emittedTracks=0))}for(this.videoTrack?(s=this.videoTrack.timelineStartInfo.pts,Tu.forEach(function(e){o.info[e]=this.videoTrack[e]},this)):this.audioTrack&&(s=this.audioTrack.timelineStartInfo.pts,_u.forEach(function(e){o.info[e]=this.audioTrack[e]},this)),1===this.pendingTracks.length?o.type=this.pendingTracks[0].type:o.type="combined",this.emittedTracks+=this.pendingTracks.length,i=Js.initSegment(this.pendingTracks),o.initSegment=new Uint8Array(i.byteLength),o.initSegment.set(i),o.data=new Uint8Array(this.pendingBytes),r=0;r<this.pendingBoxes.length;r++)o.data.set(this.pendingBoxes[r],a),a+=this.pendingBoxes[r].byteLength;for(r=0;r<this.pendingCaptions.length;r++)(t=this.pendingCaptions[r]).startTime=t.startPts,this.keepOriginalTimestamps||(t.startTime-=s),t.startTime/=9e4,t.endTime=t.endPts,this.keepOriginalTimestamps||(t.endTime-=s),t.endTime/=9e4,o.captionStreams[t.stream]=!0,o.captions.push(t);for(r=0;r<this.pendingMetadata.length;r++)(n=this.pendingMetadata[r]).cueTime=n.pts,this.keepOriginalTimestamps||(n.cueTime-=s),n.cueTime/=9e4,o.metadata.push(n);o.metadata.dispatchType=this.metadataStream.dispatchType,this.pendingTracks.length=0,this.videoTrack=null,this.pendingBoxes.length=0,this.pendingCaptions.length=0,this.pendingBytes=0,this.pendingMetadata.length=0,this.trigger("data",o),this.emittedTracks>=this.numberOfTracks&&(this.trigger("done"),this.emittedTracks=0)},(gu=function(e){var t,n,i=this,r=!0;gu.prototype.init.call(this),e=e||{},this.baseMediaDecodeTime=e.baseMediaDecodeTime||0,this.transmuxPipeline_={},this.setupAacPipeline=function(){var t={};this.transmuxPipeline_=t,t.type="aac",t.metadataStream=new nu.MetadataStream,t.aacStream=new vu,t.audioTimestampRolloverStream=new nu.TimestampRolloverStream("audio"),t.timedMetadataTimestampRolloverStream=new nu.TimestampRolloverStream("timed-metadata"),t.adtsStream=new su,t.coalesceStream=new mu(e,t.metadataStream),t.headOfPipeline=t.aacStream,t.aacStream.pipe(t.audioTimestampRolloverStream).pipe(t.adtsStream),t.aacStream.pipe(t.timedMetadataTimestampRolloverStream).pipe(t.metadataStream).pipe(t.coalesceStream),t.metadataStream.on("timestamp",function(e){t.aacStream.setTimestamp(e.timeStamp)}),t.aacStream.on("data",function(r){"timed-metadata"!==r.type||t.audioSegmentStream||(n=n||{timelineStartInfo:{baseMediaDecodeTime:i.baseMediaDecodeTime},codec:"adts",type:"audio"},t.coalesceStream.numberOfTracks++,t.audioSegmentStream=new fu(n,e),t.adtsStream.pipe(t.audioSegmentStream).pipe(t.coalesceStream))}),t.coalesceStream.on("data",this.trigger.bind(this,"data")),t.coalesceStream.on("done",this.trigger.bind(this,"done"))},this.setupTsPipeline=function(){var r={};this.transmuxPipeline_=r,r.type="ts",r.metadataStream=new nu.MetadataStream,r.packetStream=new nu.TransportPacketStream,r.parseStream=new nu.TransportParseStream,r.elementaryStream=new nu.ElementaryStream,r.videoTimestampRolloverStream=new nu.TimestampRolloverStream("video"),r.audioTimestampRolloverStream=new nu.TimestampRolloverStream("audio"),r.timedMetadataTimestampRolloverStream=new nu.TimestampRolloverStream("timed-metadata"),r.adtsStream=new su,r.h264Stream=new yu,r.captionStream=new nu.CaptionStream,r.coalesceStream=new mu(e,r.metadataStream),r.headOfPipeline=r.packetStream,r.packetStream.pipe(r.parseStream).pipe(r.elementaryStream),r.elementaryStream.pipe(r.videoTimestampRolloverStream).pipe(r.h264Stream),r.elementaryStream.pipe(r.audioTimestampRolloverStream).pipe(r.adtsStream),r.elementaryStream.pipe(r.timedMetadataTimestampRolloverStream).pipe(r.metadataStream).pipe(r.coalesceStream),r.h264Stream.pipe(r.captionStream).pipe(r.coalesceStream),r.elementaryStream.on("data",function(a){var o;if("metadata"===a.type){for(o=a.tracks.length;o--;)t||"video"!==a.tracks[o].type?n||"audio"!==a.tracks[o].type||((n=a.tracks[o]).timelineStartInfo.baseMediaDecodeTime=i.baseMediaDecodeTime):(t=a.tracks[o]).timelineStartInfo.baseMediaDecodeTime=i.baseMediaDecodeTime;t&&!r.videoSegmentStream&&(r.coalesceStream.numberOfTracks++,r.videoSegmentStream=new pu(t,e),r.videoSegmentStream.on("timelineStartInfo",function(e){n&&(n.timelineStartInfo=e,r.audioSegmentStream.setEarliestDts(e.dts))}),r.videoSegmentStream.on("processedGopsInfo",i.trigger.bind(i,"gopInfo")),r.videoSegmentStream.on("segmentTimingInfo",i.trigger.bind(i,"videoSegmentTimingInfo")),r.videoSegmentStream.on("baseMediaDecodeTime",function(e){n&&r.audioSegmentStream.setVideoBaseMediaDecodeTime(e)}),r.h264Stream.pipe(r.videoSegmentStream).pipe(r.coalesceStream)),n&&!r.audioSegmentStream&&(r.coalesceStream.numberOfTracks++,r.audioSegmentStream=new fu(n,e),r.adtsStream.pipe(r.audioSegmentStream).pipe(r.coalesceStream))}}),r.coalesceStream.on("data",this.trigger.bind(this,"data")),r.coalesceStream.on("done",this.trigger.bind(this,"done"))},this.setBaseMediaDecodeTime=function(i){var r=this.transmuxPipeline_;e.keepOriginalTimestamps||(this.baseMediaDecodeTime=i),n&&(n.timelineStartInfo.dts=void 0,n.timelineStartInfo.pts=void 0,Cl(n),e.keepOriginalTimestamps||(n.timelineStartInfo.baseMediaDecodeTime=i),r.audioTimestampRolloverStream&&r.audioTimestampRolloverStream.discontinuity()),t&&(r.videoSegmentStream&&(r.videoSegmentStream.gopCache_=[],r.videoTimestampRolloverStream.discontinuity()),t.timelineStartInfo.dts=void 0,t.timelineStartInfo.pts=void 0,Cl(t),r.captionStream.reset(),e.keepOriginalTimestamps||(t.timelineStartInfo.baseMediaDecodeTime=i)),r.timedMetadataTimestampRolloverStream&&r.timedMetadataTimestampRolloverStream.discontinuity()},this.setAudioAppendStart=function(e){n&&this.transmuxPipeline_.audioSegmentStream.setAudioAppendStart(e)},this.alignGopsWith=function(e){t&&this.transmuxPipeline_.videoSegmentStream&&this.transmuxPipeline_.videoSegmentStream.alignGopsWith(e)},this.push=function(e){if(r){var t=bu(e);t&&"aac"!==this.transmuxPipeline_.type?this.setupAacPipeline():t||"ts"===this.transmuxPipeline_.type||this.setupTsPipeline(),r=!1}this.transmuxPipeline_.headOfPipeline.push(e)},this.flush=function(){r=!0,this.transmuxPipeline_.headOfPipeline.flush()},this.resetCaptions=function(){this.transmuxPipeline_.captionStream&&this.transmuxPipeline_.captionStream.reset()}}).prototype=new al;var wu=Dl,ku=Kl.CaptionStream,Su=function(e,t){for(var n=e,i=0;i<t.length;i++){var r=t[i];if(n<r.size)return r;n-=r.size}return null},Iu={generator:Js,probe:Hs,Transmuxer:gu,AudioSegmentStream:fu,VideoSegmentStream:pu,CaptionParser:function(){var e,t,n,i,r,a=!1;this.isInitialized=function(){return a},this.init=function(){e=new ku,a=!0,e.on("data",function(e){e.startTime=e.startPts/i,e.endTime=e.endPts/i,r.captions.push(e),r.captionStreams[e.stream]=!0})},this.isNewInit=function(e,t){return!(e&&0===e.length||t&&"object"==typeof t&&0===Object.keys(t).length||n===e[0]&&i===t[n])},this.parse=function(e,a,o){var s;if(!this.isInitialized())return null;if(!a||!o)return null;if(this.isNewInit(a,o))n=a[0],i=o[n];else if(!n||!i)return t.push(e),null;for(;t.length>0;){var l=t.shift();this.parse(l,a,o)}return null!==(s=function(e,t,n){return t?{seiNals:function(e,t){var n=Hs.findBox(e,["moof","traf"]),i={},r=[];return Hs.findBox(e,["mdat"]).forEach(function(e,t){var i=n[t];r.push({mdat:e,traf:i})}),r.forEach(function(e){var n,r,a=e.mdat,o=e.traf,s=Hs.findBox(o,["tfhd"]),l=Ys.parseTfhd(s[0]),u=l.trackId,c=Hs.findBox(o,["tfdt"]),d=c.length>0?Ys.parseTfdt(c[0]).baseMediaDecodeTime:0,h=Hs.findBox(o,["trun"]);t===u&&h.length>0&&(n=function(e,t,n){var i=d,r=n.defaultSampleDuration||0,a=n.defaultSampleSize||0,o=n.trackId,s=[];return e.forEach(function(e){var t=Ys.parseTrun(e).samples;t.forEach(function(e){void 0===e.duration&&(e.duration=r),void 0===e.size&&(e.size=a),e.trackId=o,e.dts=i,void 0===e.compositionTimeOffset&&(e.compositionTimeOffset=0),e.pts=i+e.compositionTimeOffset,i+=e.duration}),s=s.concat(t)}),s}(h,0,l),r=function(e,t,n){var i,r,a,o,s=new DataView(e.buffer,e.byteOffset,e.byteLength),l=[];for(r=0;r+4<e.length;r+=a)if(a=s.getUint32(r),r+=4,!(a<=0))switch(31&e[r]){case 6:var u=e.subarray(r+1,r+1+a),c=Su(r,t);i={nalUnitType:"sei_rbsp",size:a,data:u,escapedRBSP:wu(u),trackId:n},c?(i.pts=c.pts,i.dts=c.dts,o=c):(i.pts=o.pts,i.dts=o.dts),l.push(i)}return l}(a,n,u),i[u]||(i[u]=[]),i[u]=i[u].concat(r))}),i}(e,t)[t],timescale:n}:null}(e,n,i))&&s.seiNals?(this.pushNals(s.seiNals),this.flushStream(),r):null},this.pushNals=function(t){if(!this.isInitialized()||!t||0===t.length)return null;t.forEach(function(t){e.push(t)})},this.flushStream=function(){if(!this.isInitialized())return null;e.flush()},this.clearParsedCaptions=function(){r.captions=[],r.captionStreams={}},this.resetCaptionStream=function(){if(!this.isInitialized())return null;e.reset()},this.clearAllCaptions=function(){this.clearParsedCaptions(),this.resetCaptionStream()},this.reset=function(){t=[],n=null,i=null,r?this.clearParsedCaptions():r={captions:[],captionStreams:{}},this.resetCaptionStream()},this.reset()}}.CaptionParser,Ou=function(e){var t=31&e[1];return(t<<=8)|e[2]},Du=function(e){return!!(64&e[1])},Ru=function(e){var t=0;return(48&e[3])>>>4>1&&(t+=e[4]+1),t},xu=function(e){switch(e){case 5:return"slice_layer_without_partitioning_rbsp_idr";case 6:return"sei_rbsp";case 7:return"seq_parameter_set_rbsp";case 8:return"pic_parameter_set_rbsp";case 9:return"access_unit_delimiter_rbsp";default:return null}},Au={parseType:function(e,t){var n=Ou(e);return 0===n?"pat":n===t?"pmt":t?"pes":null},parsePat:function(e){var t=Du(e),n=4+Ru(e);return t&&(n+=e[n]+1),(31&e[n+10])<<8|e[n+11]},parsePmt:function(e){var t={},n=Du(e),i=4+Ru(e);if(n&&(i+=e[i]+1),1&e[i+5]){var r;r=3+((15&e[i+1])<<8|e[i+2])-4;for(var a=12+((15&e[i+10])<<8|e[i+11]);a<r;){var o=i+a;t[(31&e[o+1])<<8|e[o+2]]=e[o],a+=5+((15&e[o+3])<<8|e[o+4])}return t}},parsePayloadUnitStartIndicator:Du,parsePesType:function(e,t){switch(t[Ou(e)]){case $l.H264_STREAM_TYPE:return"video";case $l.ADTS_STREAM_TYPE:return"audio";case $l.METADATA_STREAM_TYPE:return"timed-metadata";default:return null}},parsePesTime:function(e){if(!Du(e))return null;var t=4+Ru(e);if(t>=e.byteLength)return null;var n,i=null;return 192&(n=e[t+7])&&((i={}).pts=(14&e[t+9])<<27|(255&e[t+10])<<20|(254&e[t+11])<<12|(255&e[t+12])<<5|(254&e[t+13])>>>3,i.pts*=4,i.pts+=(6&e[t+13])>>>1,i.dts=i.pts,64&n&&(i.dts=(14&e[t+14])<<27|(255&e[t+15])<<20|(254&e[t+16])<<12|(255&e[t+17])<<5|(254&e[t+18])>>>3,i.dts*=4,i.dts+=(6&e[t+18])>>>1)),i},videoPacketContainsKeyFrame:function(e){for(var t=4+Ru(e),n=e.subarray(t),i=0,r=0,a=!1;r<n.byteLength-3;r++)if(1===n[r+2]){i=r+5;break}for(;i<n.byteLength;)switch(n[i]){case 0:if(0!==n[i-1]){i+=2;break}if(0!==n[i-2]){i++;break}r+3!==i-2&&"slice_layer_without_partitioning_rbsp_idr"===xu(31&n[r+3])&&(a=!0);do{i++}while(1!==n[i]&&i<n.length);r=i-2,i+=3;break;case 1:if(0!==n[i-1]||0!==n[i-2]){i+=3;break}"slice_layer_without_partitioning_rbsp_idr"===xu(31&n[r+3])&&(a=!0),r=i-2,i+=3;break;default:i+=3}return n=n.subarray(r),i-=r,r=0,n&&n.byteLength>3&&"slice_layer_without_partitioning_rbsp_idr"===xu(31&n[r+3])&&(a=!0),a}},Pu=Vl,Lu={};Lu.ts=Au,Lu.aac=hu;var Nu=function(e,t,n){for(var i,r,a,o,s=0,l=188,u=!1;l<=e.byteLength;)if(71!==e[s]||71!==e[l]&&l!==e.byteLength)s++,l++;else{switch(i=e.subarray(s,l),Lu.ts.parseType(i,t.pid)){case"pes":r=Lu.ts.parsePesType(i,t.table),a=Lu.ts.parsePayloadUnitStartIndicator(i),"audio"===r&&a&&(o=Lu.ts.parsePesTime(i))&&(o.type="audio",n.audio.push(o),u=!0)}if(u)break;s+=188,l+=188}for(s=(l=e.byteLength)-188,u=!1;s>=0;)if(71!==e[s]||71!==e[l]&&l!==e.byteLength)s--,l--;else{switch(i=e.subarray(s,l),Lu.ts.parseType(i,t.pid)){case"pes":r=Lu.ts.parsePesType(i,t.table),a=Lu.ts.parsePayloadUnitStartIndicator(i),"audio"===r&&a&&(o=Lu.ts.parsePesTime(i))&&(o.type="audio",n.audio.push(o),u=!0)}if(u)break;s-=188,l-=188}},Mu=function(e,t,n){for(var i,r,a,o,s,l,u,c=0,d=188,h=!1,p={data:[],size:0};d<e.byteLength;)if(71!==e[c]||71!==e[d])c++,d++;else{switch(i=e.subarray(c,d),Lu.ts.parseType(i,t.pid)){case"pes":if(r=Lu.ts.parsePesType(i,t.table),a=Lu.ts.parsePayloadUnitStartIndicator(i),"video"===r&&(a&&!h&&(o=Lu.ts.parsePesTime(i))&&(o.type="video",n.video.push(o),h=!0),!n.firstKeyFrame)){if(a&&0!==p.size){for(s=new Uint8Array(p.size),l=0;p.data.length;)u=p.data.shift(),s.set(u,l),l+=u.byteLength;if(Lu.ts.videoPacketContainsKeyFrame(s)){var f=Lu.ts.parsePesTime(s);f?(n.firstKeyFrame=f,n.firstKeyFrame.type="video"):console.warn("Failed to extract PTS/DTS from PES at first keyframe. This could be an unusual TS segment, or else mux.js did not parse your TS segment correctly. If you know your TS segments do contain PTS/DTS on keyframes please file a bug report! You can try ffprobe to double check for yourself.")}p.size=0}p.data.push(i),p.size+=i.byteLength}}if(h&&n.firstKeyFrame)break;c+=188,d+=188}for(c=(d=e.byteLength)-188,h=!1;c>=0;)if(71!==e[c]||71!==e[d])c--,d--;else{switch(i=e.subarray(c,d),Lu.ts.parseType(i,t.pid)){case"pes":r=Lu.ts.parsePesType(i,t.table),a=Lu.ts.parsePayloadUnitStartIndicator(i),"video"===r&&a&&(o=Lu.ts.parsePesTime(i))&&(o.type="video",n.video.push(o),h=!0)}if(h)break;c-=188,d-=188}},Ku=function(e,t){var n;return(n=Lu.aac.isLikelyAacData(e)?function(e){for(var t,n=!1,i=0,r=null,a=null,o=0,s=0;e.length-s>=3;){switch(Lu.aac.parseType(e,s)){case"timed-metadata":if(e.length-s<10){n=!0;break}if((o=Lu.aac.parseId3TagSize(e,s))>e.length){n=!0;break}null===a&&(t=e.subarray(s,s+o),a=Lu.aac.parseAacTimestamp(t)),s+=o;break;case"audio":if(e.length-s<7){n=!0;break}if((o=Lu.aac.parseAdtsSize(e,s))>e.length){n=!0;break}null===r&&(t=e.subarray(s,s+o),r=Lu.aac.parseSampleRate(t)),i++,s+=o;break;default:s++}if(n)return null}if(null===r||null===a)return null;var l=9e4/r;return{audio:[{type:"audio",dts:a,pts:a},{type:"audio",dts:a+1024*i*l,pts:a+1024*i*l}]}}(e):function(e){var t={pid:null,table:null},n={};for(var i in function(e,t){for(var n,i=0,r=188;r<e.byteLength;)if(71!==e[i]||71!==e[r])i++,r++;else{switch(n=e.subarray(i,r),Lu.ts.parseType(n,t.pid)){case"pat":t.pid||(t.pid=Lu.ts.parsePat(n));break;case"pmt":t.table||(t.table=Lu.ts.parsePmt(n))}if(t.pid&&t.table)return;i+=188,r+=188}}(e,t),t.table)if(t.table.hasOwnProperty(i))switch(t.table[i]){case $l.H264_STREAM_TYPE:n.video=[],Mu(e,t,n),0===n.video.length&&delete n.video;break;case $l.ADTS_STREAM_TYPE:n.audio=[],Nu(e,t,n),0===n.audio.length&&delete n.audio}return n}(e))&&(n.audio||n.video)?(function(e,t){if(e.audio&&e.audio.length){var n=t;void 0===n&&(n=e.audio[0].dts),e.audio.forEach(function(e){e.dts=Pu(e.dts,n),e.pts=Pu(e.pts,n),e.dtsTime=e.dts/9e4,e.ptsTime=e.pts/9e4})}if(e.video&&e.video.length){var i=t;if(void 0===i&&(i=e.video[0].dts),e.video.forEach(function(e){e.dts=Pu(e.dts,i),e.pts=Pu(e.pts,i),e.dtsTime=e.dts/9e4,e.ptsTime=e.pts/9e4}),e.firstKeyFrame){var r=e.firstKeyFrame;r.dts=Pu(r.dts,i),r.pts=Pu(r.pts,i),r.dtsTime=r.dts/9e4,r.ptsTime=r.dts/9e4}}}(n,t),n):null},$u=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},ju=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),Bu=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t},Fu=function(){var e=[[[],[],[],[],[]],[[],[],[],[],[]]],t=e[0],n=e[1],i=t[4],r=n[4],a=void 0,o=void 0,s=void 0,l=[],u=[],c=void 0,d=void 0,h=void 0,p=void 0,f=void 0;for(a=0;a<256;a++)u[(l[a]=a<<1^283*(a>>7))^a]=a;for(o=s=0;!i[o];o^=c||1,s=u[s]||1)for(h=(h=s^s<<1^s<<2^s<<3^s<<4)>>8^255&h^99,i[o]=h,r[h]=o,f=16843009*l[d=l[c=l[o]]]^65537*d^257*c^16843008*o,p=257*l[h]^16843008*h,a=0;a<4;a++)t[a][o]=p=p<<24^p>>>8,n[a][h]=f=f<<24^f>>>8;for(a=0;a<5;a++)t[a]=t[a].slice(0),n[a]=n[a].slice(0);return e},Uu=null,Vu=function(){function e(t){$u(this,e),Uu||(Uu=Fu()),this._tables=[[Uu[0][0].slice(),Uu[0][1].slice(),Uu[0][2].slice(),Uu[0][3].slice(),Uu[0][4].slice()],[Uu[1][0].slice(),Uu[1][1].slice(),Uu[1][2].slice(),Uu[1][3].slice(),Uu[1][4].slice()]];var n=void 0,i=void 0,r=void 0,a=void 0,o=void 0,s=this._tables[0][4],l=this._tables[1],u=t.length,c=1;if(4!==u&&6!==u&&8!==u)throw new Error("Invalid aes key size");for(a=t.slice(0),o=[],this._key=[a,o],n=u;n<4*u+28;n++)r=a[n-1],(n%u==0||8===u&&n%u==4)&&(r=s[r>>>24]<<24^s[r>>16&255]<<16^s[r>>8&255]<<8^s[255&r],n%u==0&&(r=r<<8^r>>>24^c<<24,c=c<<1^283*(c>>7))),a[n]=a[n-u]^r;for(i=0;n;i++,n--)r=a[3&i?n:n-4],o[i]=n<=4||i<4?r:l[0][s[r>>>24]]^l[1][s[r>>16&255]]^l[2][s[r>>8&255]]^l[3][s[255&r]]}return e.prototype.decrypt=function(e,t,n,i,r,a){var o=this._key[1],s=e^o[0],l=i^o[1],u=n^o[2],c=t^o[3],d=void 0,h=void 0,p=void 0,f=o.length/4-2,g=void 0,m=4,v=this._tables[1],y=v[0],b=v[1],_=v[2],T=v[3],E=v[4];for(g=0;g<f;g++)d=y[s>>>24]^b[l>>16&255]^_[u>>8&255]^T[255&c]^o[m],h=y[l>>>24]^b[u>>16&255]^_[c>>8&255]^T[255&s]^o[m+1],p=y[u>>>24]^b[c>>16&255]^_[s>>8&255]^T[255&l]^o[m+2],c=y[c>>>24]^b[s>>16&255]^_[l>>8&255]^T[255&u]^o[m+3],m+=4,s=d,l=h,u=p;for(g=0;g<4;g++)r[(3&-g)+a]=E[s>>>24]<<24^E[l>>16&255]<<16^E[u>>8&255]<<8^E[255&c]^o[m++],d=s,s=l,l=u,u=c,c=d},e}(),qu=function(){function e(){$u(this,e),this.listeners={}}return e.prototype.on=function(e,t){this.listeners[e]||(this.listeners[e]=[]),this.listeners[e].push(t)},e.prototype.off=function(e,t){if(!this.listeners[e])return!1;var n=this.listeners[e].indexOf(t);return this.listeners[e].splice(n,1),n>-1},e.prototype.trigger=function(e){var t=this.listeners[e];if(t)if(2===arguments.length)for(var n=t.length,i=0;i<n;++i)t[i].call(this,arguments[1]);else for(var r=Array.prototype.slice.call(arguments,1),a=t.length,o=0;o<a;++o)t[o].apply(this,r)},e.prototype.dispose=function(){this.listeners={}},e.prototype.pipe=function(e){this.on("data",function(t){e.push(t)})},e}(),Hu=function(e){function t(){$u(this,t);var n=Bu(this,e.call(this,qu));return n.jobs=[],n.delay=1,n.timeout_=null,n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t.prototype.processJob_=function(){this.jobs.shift()(),this.jobs.length?this.timeout_=setTimeout(this.processJob_.bind(this),this.delay):this.timeout_=null},t.prototype.push=function(e){this.jobs.push(e),this.timeout_||(this.timeout_=setTimeout(this.processJob_.bind(this),this.delay))},t}(qu),zu=function(e){return e<<24|(65280&e)<<8|(16711680&e)>>8|e>>>24},Wu=function(e,t,n){var i=new Int32Array(e.buffer,e.byteOffset,e.byteLength>>2),r=new Vu(Array.prototype.slice.call(t)),a=new Uint8Array(e.byteLength),o=new Int32Array(a.buffer),s=void 0,l=void 0,u=void 0,c=void 0,d=void 0,h=void 0,p=void 0,f=void 0,g=void 0;for(s=n[0],l=n[1],u=n[2],c=n[3],g=0;g<i.length;g+=4)d=zu(i[g]),h=zu(i[g+1]),p=zu(i[g+2]),f=zu(i[g+3]),r.decrypt(d,h,p,f,o,g),o[g]=zu(o[g]^s),o[g+1]=zu(o[g+1]^l),o[g+2]=zu(o[g+2]^u),o[g+3]=zu(o[g+3]^c),s=d,l=h,u=p,c=f;return a},Gu=function(){function e(t,n,i,r){$u(this,e);var a=e.STEP,o=new Int32Array(t.buffer),s=new Uint8Array(t.byteLength),l=0;for(this.asyncStream_=new Hu,this.asyncStream_.push(this.decryptChunk_(o.subarray(l,l+a),n,i,s)),l=a;l<o.length;l+=a)i=new Uint32Array([zu(o[l-4]),zu(o[l-3]),zu(o[l-2]),zu(o[l-1])]),this.asyncStream_.push(this.decryptChunk_(o.subarray(l,l+a),n,i,s));this.asyncStream_.push(function(){var e;r(null,(e=s).subarray(0,e.byteLength-e[e.byteLength-1]))})}return e.prototype.decryptChunk_=function(e,t,n,i){return function(){var r=Wu(e,t,n);i.set(r,e.byteOffset)}},ju(e,null,[{key:"STEP",get:function(){return 32e3}}]),e}(),Xu=function(t,n){return/^[a-z]+:/i.test(n)?n:(/\/\//i.test(t)||(t=ro.buildAbsoluteURL(e.location.href,t)),ro.buildAbsoluteURL(t,n))},Yu=function(e,t,n){return e&&n.responseURL&&t!==n.responseURL?n.responseURL:t},Qu=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},Ju=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),Zu=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)},ec=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t},tc=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],i=!0,r=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(i=(o=s.next()).done)&&(n.push(o.value),!t||n.length!==t);i=!0);}catch(e){r=!0,a=e}finally{try{!i&&s.return&&s.return()}finally{if(r)throw a}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")},nc=to.mergeOptions,ic=to.EventTarget,rc=to.log,ac=function(e,t){["AUDIO","SUBTITLES"].forEach(function(n){for(var i in e.mediaGroups[n])for(var r in e.mediaGroups[n][i]){var a=e.mediaGroups[n][i][r];t(a,n,i,r)}})},oc=function(e,t){var n=nc(e,{}),i=n.playlists[t.uri];if(!i)return null;if(i.segments&&t.segments&&i.segments.length===t.segments.length&&i.endList===t.endList&&i.mediaSequence===t.mediaSequence)return null;var r=nc(i,t);i.segments&&(r.segments=function(e,t,n){var i=t.slice();n=n||0;for(var r=Math.min(e.length,t.length+n),a=n;a<r;a++)i[a-n]=nc(e[a],i[a-n]);return i}(i.segments,t.segments,t.mediaSequence-i.mediaSequence)),r.segments.forEach(function(e){!function(e,t){e.resolvedUri||(e.resolvedUri=Xu(t,e.uri)),e.key&&!e.key.resolvedUri&&(e.key.resolvedUri=Xu(t,e.key.uri)),e.map&&!e.map.resolvedUri&&(e.map.resolvedUri=Xu(t,e.map.uri))}(e,r.resolvedUri)});for(var a=0;a<n.playlists.length;a++)n.playlists[a].uri===t.uri&&(n.playlists[a]=r);return n.playlists[t.uri]=r,n},sc=function(e){for(var t=e.playlists.length;t--;){var n=e.playlists[t];e.playlists[n.uri]=n,n.resolvedUri=Xu(e.uri,n.uri),n.id=t,n.attributes||(n.attributes={},rc.warn("Invalid playlist STREAM-INF detected. Missing BANDWIDTH attribute."))}},lc=function(e){ac(e,function(t){t.uri&&(t.resolvedUri=Xu(e.uri,t.uri))})},uc=function(e,t){var n=e.segments[e.segments.length-1];return t&&n&&n.duration?1e3*n.duration:500*(e.targetDuration||10)},cc=function(t){function n(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};Qu(this,n);var r=ec(this,(n.__proto__||Object.getPrototypeOf(n)).call(this)),a=i.withCredentials,o=void 0!==a&&a,s=i.handleManifestRedirects,l=void 0!==s&&s;r.srcUrl=e,r.hls_=t,r.withCredentials=o,r.handleManifestRedirects=l;var u=t.options_;if(r.customTagParsers=u&&u.customTagParsers||[],r.customTagMappers=u&&u.customTagMappers||[],!r.srcUrl)throw new Error("A non-empty playlist URL is required");return r.state="HAVE_NOTHING",r.on("mediaupdatetimeout",function(){"HAVE_METADATA"===r.state&&(r.state="HAVE_CURRENT_METADATA",r.request=r.hls_.xhr({uri:Xu(r.master.uri,r.media().uri),withCredentials:r.withCredentials},function(e,t){if(r.request)return e?r.playlistRequestError(r.request,r.media().uri,"HAVE_METADATA"):void r.haveMetadata(r.request,r.media().uri)}))}),r}return Zu(n,ic),Ju(n,[{key:"playlistRequestError",value:function(e,t,n){this.request=null,n&&(this.state=n),this.error={playlist:this.master.playlists[t],status:e.status,message:"HLS playlist request error at URL: "+t+".",responseText:e.responseText,code:e.status>=500?4:2},this.trigger("error")}},{key:"haveMetadata",value:function(t,n){var i=this;this.request=null,this.state="HAVE_METADATA";var r=new rs;this.customTagParsers.forEach(function(e){return r.addParser(e)}),this.customTagMappers.forEach(function(e){return r.addTagMapper(e)}),r.push(t.responseText),r.end(),r.manifest.uri=n,r.manifest.attributes=r.manifest.attributes||{};var a=oc(this.master,r.manifest);this.targetDuration=r.manifest.targetDuration,a?(this.master=a,this.media_=this.master.playlists[r.manifest.uri]):this.trigger("playlistunchanged"),this.media().endList||(e.clearTimeout(this.mediaUpdateTimeout),this.mediaUpdateTimeout=e.setTimeout(function(){i.trigger("mediaupdatetimeout")},uc(this.media(),!!a))),this.trigger("loadedplaylist")}},{key:"dispose",value:function(){this.stopRequest(),e.clearTimeout(this.mediaUpdateTimeout),e.clearTimeout(this.finalRenditionTimeout)}},{key:"stopRequest",value:function(){if(this.request){var e=this.request;this.request=null,e.onreadystatechange=null,e.abort()}}},{key:"media",value:function(t,n){var i=this;if(!t)return this.media_;if("HAVE_NOTHING"===this.state)throw new Error("Cannot switch media playlist from "+this.state);if("string"==typeof t){if(!this.master.playlists[t])throw new Error("Unknown playlist URI: "+t);t=this.master.playlists[t]}if(e.clearTimeout(this.finalRenditionTimeout),n){var r=t.targetDuration/2*1e3||5e3;this.finalRenditionTimeout=e.setTimeout(this.media.bind(this,t,!1),r)}else{var a=this.state,o=!this.media_||t.uri!==this.media_.uri;if(this.master.playlists[t.uri].endList)return this.request&&(this.request.onreadystatechange=null,this.request.abort(),this.request=null),this.state="HAVE_METADATA",this.media_=t,void(o&&(this.trigger("mediachanging"),this.trigger("mediachange")));if(o){if(this.state="SWITCHING_MEDIA",this.request){if(t.resolvedUri===this.request.url)return;this.request.onreadystatechange=null,this.request.abort(),this.request=null}this.media_&&this.trigger("mediachanging"),this.request=this.hls_.xhr({uri:t.resolvedUri,withCredentials:this.withCredentials},function(e,n){if(i.request){if(t.resolvedUri=Yu(i.handleManifestRedirects,t.resolvedUri,n),e)return i.playlistRequestError(i.request,t.uri,a);i.haveMetadata(n,t.uri),"HAVE_MASTER"===a?i.trigger("loadedmetadata"):i.trigger("mediachange")}})}}}},{key:"pause",value:function(){this.stopRequest(),e.clearTimeout(this.mediaUpdateTimeout),"HAVE_NOTHING"===this.state&&(this.started=!1),"SWITCHING_MEDIA"===this.state?this.media_?this.state="HAVE_METADATA":this.state="HAVE_MASTER":"HAVE_CURRENT_METADATA"===this.state&&(this.state="HAVE_METADATA")}},{key:"load",value:function(t){var n=this;e.clearTimeout(this.mediaUpdateTimeout);var i=this.media();if(t){var r=i?i.targetDuration/2*1e3:5e3;this.mediaUpdateTimeout=e.setTimeout(function(){return n.load()},r)}else this.started?i&&!i.endList?this.trigger("mediaupdatetimeout"):this.trigger("loadedplaylist"):this.start()}},{key:"start",value:function(){var t=this;this.started=!0,this.request=this.hls_.xhr({uri:this.srcUrl,withCredentials:this.withCredentials},function(n,i){if(t.request){if(t.request=null,n)return t.error={status:i.status,message:"HLS playlist request error at URL: "+t.srcUrl+".",responseText:i.responseText,code:2},"HAVE_NOTHING"===t.state&&(t.started=!1),t.trigger("error");var r=new rs;return t.customTagParsers.forEach(function(e){return r.addParser(e)}),t.customTagMappers.forEach(function(e){return r.addTagMapper(e)}),r.push(i.responseText),r.end(),t.state="HAVE_MASTER",t.srcUrl=Yu(t.handleManifestRedirects,t.srcUrl,i),r.manifest.uri=t.srcUrl,r.manifest.playlists?(t.master=r.manifest,sc(t.master),lc(t.master),t.trigger("loadedplaylist"),void(t.request||t.media(r.manifest.playlists[0]))):(t.master={mediaGroups:{AUDIO:{},VIDEO:{},"CLOSED-CAPTIONS":{},SUBTITLES:{}},uri:e.location.href,playlists:[{uri:t.srcUrl,id:0,resolvedUri:t.srcUrl,attributes:{}}]},t.master.playlists[t.srcUrl]=t.master.playlists[0],t.haveMetadata(i,t.srcUrl),t.trigger("loadedmetadata"))}})}}]),n}(),dc=to.createTimeRange,hc=function(e,t,n){var i=void 0,r=void 0;return void 0===t&&(t=e.mediaSequence+e.segments.length),t<e.mediaSequence?0:(i=function(e,t){var n=0,i=t-e.mediaSequence,r=e.segments[i];if(r){if(void 0!==r.start)return{result:r.start,precise:!0};if(void 0!==r.end)return{result:r.end-r.duration,precise:!0}}for(;i--;){if(void 0!==(r=e.segments[i]).end)return{result:n+r.end,precise:!0};if(n+=r.duration,void 0!==r.start)return{result:n+r.start,precise:!0}}return{result:n,precise:!1}}(e,t)).precise?i.result:(r=function(e,t){for(var n=0,i=void 0,r=t-e.mediaSequence;r<e.segments.length;r++){if(void 0!==(i=e.segments[r]).start)return{result:i.start-n,precise:!0};if(n+=i.duration,void 0!==i.end)return{result:i.end-n,precise:!0}}return{result:-1,precise:!1}}(e,t)).precise?r.result:i.result+n},pc=function(t,n,i){if(!t)return 0;if("number"!=typeof i&&(i=0),void 0===n){if(t.totalDuration)return t.totalDuration;if(!t.endList)return e.Infinity}return hc(t,n,i)},fc=function(e,t,n){var i=0;if(t>n){var r=[n,t];t=r[0],n=r[1]}if(t<0){for(var a=t;a<Math.min(0,n);a++)i+=e.targetDuration;t=0}for(var o=t;o<n;o++)i+=e.segments[o].duration;return i},gc=function(e){if(!e.segments.length)return 0;for(var t=e.segments.length-1,n=e.segments[t].duration||e.targetDuration,i=n+2*e.targetDuration;t--&&!((n+=e.segments[t].duration)>=i););return Math.max(0,t)},mc=function(e,t,n){if(!e||!e.segments)return null;if(e.endList)return pc(e);if(null===t)return null;t=t||0;var i=n?gc(e):e.segments.length;return hc(e,e.mediaSequence+i,t)},vc=function(e){return e-Math.floor(e)==0},yc=function(e,t){if(vc(t))return t+.1*e;for(var n=t.toString().split(".")[1].length,i=1;i<=n;i++){var r=Math.pow(10,i),a=t*r;if(vc(a)||i===n)return(a+e)/r}},bc=yc.bind(null,1),_c=yc.bind(null,-1),Tc=function(e){return e.excludeUntil&&e.excludeUntil>Date.now()},Ec=function(e){return e.excludeUntil&&e.excludeUntil===1/0},Cc=function(e){var t=Tc(e);return!e.disabled&&!t},wc=function(e,t){return t.attributes&&t.attributes[e]},kc=function(e,t){if(1===e.playlists.length)return!0;var n=t.attributes.BANDWIDTH||Number.MAX_VALUE;return 0===e.playlists.filter(function(e){return!!Cc(e)&&(e.attributes.BANDWIDTH||0)<n}).length},Sc={duration:pc,seekable:function(e,t){var n=t||0,i=mc(e,t,!0);return null===i?dc():dc(n,i)},safeLiveIndex:gc,getMediaInfoForTime:function(e,t,n,i){var r=void 0,a=void 0,o=e.segments.length,s=t-i;if(s<0){if(n>0)for(r=n-1;r>=0;r--)if(a=e.segments[r],(s+=_c(a.duration))>0)return{mediaIndex:r,startTime:i-fc(e,n,r)};return{mediaIndex:0,startTime:t}}if(n<0){for(r=n;r<0;r++)if((s-=e.targetDuration)<0)return{mediaIndex:0,startTime:t};n=0}for(r=n;r<o;r++)if(a=e.segments[r],(s-=bc(a.duration))<0)return{mediaIndex:r,startTime:i+fc(e,n,r)};return{mediaIndex:o-1,startTime:t}},isEnabled:Cc,isDisabled:function(e){return e.disabled},isBlacklisted:Tc,isIncompatible:Ec,playlistEnd:mc,isAes:function(e){for(var t=0;t<e.segments.length;t++)if(e.segments[t].key)return!0;return!1},isFmp4:function(e){for(var t=0;t<e.segments.length;t++)if(e.segments[t].map)return!0;return!1},hasAttribute:wc,estimateSegmentRequestTime:function(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;return wc("BANDWIDTH",n)?(e*n.attributes.BANDWIDTH-8*i)/t:NaN},isLowestEnabledRendition:kc},Ic=to.xhr,Oc=to.mergeOptions,Dc=function(){return function e(t,n){t=Oc({timeout:45e3},t);var i=e.beforeRequest||to.Hls.xhr.beforeRequest;if(i&&"function"==typeof i){var r=i(t);r&&(t=r)}var a=Ic(t,function(e,t){var i=a.response;!e&&i&&(a.responseTime=Date.now(),a.roundTripTime=a.responseTime-a.requestTime,a.bytesReceived=i.byteLength||i.length,a.bandwidth||(a.bandwidth=Math.floor(a.bytesReceived/a.roundTripTime*8*1e3))),t.headers&&(a.responseHeaders=t.headers),e&&"ETIMEDOUT"===e.code&&(a.timedout=!0),e||a.aborted||200===t.statusCode||206===t.statusCode||0===t.statusCode||(e=new Error("XHR Failed with a response of: "+(a&&(i||a.responseText)))),n(e,a)}),o=a.abort;return a.abort=function(){return a.aborted=!0,o.apply(a,arguments)},a.uri=t.uri,a.requestTime=Date.now(),a}},Rc=function(e){var t,n,i={};return e.byterange&&(i.Range=(n=void 0,n=(t=e.byterange).offset+t.length-1,"bytes="+t.offset+"-"+n)),i},xc=function(e,t){return e.start(t)+"-"+e.end(t)},Ac=function(e,t){var n=e.toString(16);return"00".substring(0,2-n.length)+n+(t%2?" ":"")},Pc=function(e){return e>=32&&e<126?String.fromCharCode(e):"."},Lc=function(e){var t={};return Object.keys(e).forEach(function(n){var i=e[n];ArrayBuffer.isView(i)?t[n]={bytes:i.buffer,byteOffset:i.byteOffset,byteLength:i.byteLength}:t[n]=i}),t},Nc=function(e){var t=e.byterange||{length:1/0,offset:0};return[t.length,t.offset,e.resolvedUri].join(",")},Mc=function(e){return e.resolvedUri},Kc=function(e){for(var t=Array.prototype.slice.call(e),n="",i=0;i<t.length/16;i++)n+=t.slice(16*i,16*i+16).map(Ac).join("")+" "+t.slice(16*i,16*i+16).map(Pc).join("")+"\n";return n},$c=Object.freeze({createTransferableMessage:Lc,initSegmentId:Nc,segmentKeyId:Mc,hexDump:Kc,tagDump:function(e){var t=e.bytes;return Kc(t)},textRanges:function(e){var t="",n=void 0;for(n=0;n<e.length;n++)t+=xc(e,n)+" ";return t}}),jc=function(e,t){var n=[],i=void 0;if(e&&e.length)for(i=0;i<e.length;i++)t(e.start(i),e.end(i))&&n.push([e.start(i),e.end(i)]);return to.createTimeRanges(n)},Bc=function(e,t){return jc(e,function(e,n){return e-1/30<=t&&n+1/30>=t})},Fc=function(e,t){return jc(e,function(e){return e-1/30>=t})},Uc=function(e){var t=[];if(!e||!e.length)return"";for(var n=0;n<e.length;n++)t.push(e.start(n)+" => "+e.end(n));return t.join(", ")},Vc=function(e){for(var t=[],n=0;n<e.length;n++)t.push({start:e.start(n),end:e.end(n)});return t},qc=function(e,t,n){var i=void 0,r=void 0;if(n&&n.cues)for(i=n.cues.length;i--;)(r=n.cues[i]).startTime<=t&&r.endTime>=e&&n.removeCue(r)},Hc=function(e){return isNaN(e)||Math.abs(e)===1/0?Number.MAX_VALUE:e},zc=function(t,n,i){var r=e.WebKitDataCue||e.VTTCue;if(n&&n.forEach(function(e){var t=e.stream;this.inbandTextTracks_[t].addCue(new r(e.startTime+this.timestampOffset,e.endTime+this.timestampOffset,e.text))},t),i){var a=Hc(t.mediaSource_.duration);if(i.forEach(function(t){var n=t.cueTime+this.timestampOffset;!("number"!=typeof n||e.isNaN(n)||n<0)&&n<1/0&&t.frames.forEach(function(e){var t=new r(n,n,e.value||e.url||e.data||"");t.frame=e,t.value=e,function(e){Object.defineProperties(e.frame,{id:{get:function(){return to.log.warn("cue.frame.id is deprecated. Use cue.value.key instead."),e.value.key}},value:{get:function(){return to.log.warn("cue.frame.value is deprecated. Use cue.value.data instead."),e.value.data}},privateData:{get:function(){return to.log.warn("cue.frame.privateData is deprecated. Use cue.value.data instead."),e.value.data}}})}(t),this.metadataTrack_.addCue(t)},this)},t),t.metadataTrack_&&t.metadataTrack_.cues&&t.metadataTrack_.cues.length){for(var o=t.metadataTrack_.cues,s=[],l=0;l<o.length;l++)o[l]&&s.push(o[l]);var u=s.reduce(function(e,t){var n=e[t.startTime]||[];return n.push(t),e[t.startTime]=n,e},{}),c=Object.keys(u).sort(function(e,t){return Number(e)-Number(t)});c.forEach(function(e,t){var n=u[e],i=Number(c[t+1])||a;n.forEach(function(e){e.endTime=i})})}}},Wc="undefined"!=typeof window?window:{},Gc="undefined"==typeof Symbol?"__target":Symbol(),Xc="application/javascript",Yc=Wc.BlobBuilder||Wc.WebKitBlobBuilder||Wc.MozBlobBuilder||Wc.MSBlobBuilder,Qc=Wc.URL||Wc.webkitURL||Qc&&Qc.msURL,Jc=Wc.Worker;function Zc(e,t){return function(n){var i=this;if(!t)return new Jc(e);if(Jc&&!n){var r=id(t.toString().replace(/^function.+?{/,"").slice(0,-1));return this[Gc]=new Jc(r),function(e,t){if(e&&t){var n=e.terminate;e.objURL=t,e.terminate=function(){e.objURL&&Qc.revokeObjectURL(e.objURL),n.call(e)}}}(this[Gc],r),this[Gc]}var a={postMessage:function(e){i.onmessage&&setTimeout(function(){i.onmessage({data:e,target:a})})}};t.call(a),this.postMessage=function(e){setTimeout(function(){a.onmessage({data:e,target:i})})},this.isThisThread=!0}}if(Jc){var ed,td=id("self.onmessage = function () {}"),nd=new Uint8Array(1);try{(ed=new Jc(td)).postMessage(nd,[nd.buffer])}catch(e){Jc=null}finally{Qc.revokeObjectURL(td),ed&&ed.terminate()}}function id(e){try{return Qc.createObjectURL(new Blob([e],{type:Xc}))}catch(n){var t=new Yc;return t.append(e),Qc.createObjectURL(t.getBlob(type))}}var rd=new Zc("./transmuxer-worker.worker.js",function(e,t){var n=this;!function(){var e,t,i,r,a,o,s,l,u,c,d,h,p,f,g,m,v,y,b,_,T,E,C,w,k,S,I,O,D,R,x,A,P,L,N,M,K,$,j,B,F=Math.pow(2,32)-1;!function(){var e;if(E={avc1:[],avcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],mvex:[],mvhd:[],sdtp:[],smhd:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],styp:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[]},"undefined"!=typeof Uint8Array){for(e in E)E.hasOwnProperty(e)&&(E[e]=[e.charCodeAt(0),e.charCodeAt(1),e.charCodeAt(2),e.charCodeAt(3)]);C=new Uint8Array(["i".charCodeAt(0),"s".charCodeAt(0),"o".charCodeAt(0),"m".charCodeAt(0)]),k=new Uint8Array(["a".charCodeAt(0),"v".charCodeAt(0),"c".charCodeAt(0),"1".charCodeAt(0)]),w=new Uint8Array([0,0,0,1]),S=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),I=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]),O={video:S,audio:I},x=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),R=new Uint8Array([0,0,0,0,0,0,0,0]),A=new Uint8Array([0,0,0,0,0,0,0,0]),P=A,L=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),N=A,D=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0])}}(),e=function(e){var t,n,i=[],r=0;for(t=1;t<arguments.length;t++)i.push(arguments[t]);for(t=i.length;t--;)r+=i[t].byteLength;for(n=new Uint8Array(r+8),new DataView(n.buffer,n.byteOffset,n.byteLength).setUint32(0,n.byteLength),n.set(e,4),t=0,r=8;t<i.length;t++)n.set(i[t],r),r+=i[t].byteLength;return n},t=function(){return e(E.dinf,e(E.dref,x))},i=function(t){return e(E.esds,new Uint8Array([0,0,0,0,3,25,0,0,0,4,17,64,21,0,6,0,0,0,218,192,0,0,218,192,5,2,t.audioobjecttype<<3|t.samplingfrequencyindex>>>1,t.samplingfrequencyindex<<7|t.channelcount<<3,6,1,2]))},g=function(t){return e(E.hdlr,O[t])},f=function(t){var n=new Uint8Array([0,0,0,0,0,0,0,2,0,0,0,3,0,1,95,144,t.duration>>>24&255,t.duration>>>16&255,t.duration>>>8&255,255&t.duration,85,196,0,0]);return t.samplerate&&(n[12]=t.samplerate>>>24&255,n[13]=t.samplerate>>>16&255,n[14]=t.samplerate>>>8&255,n[15]=255&t.samplerate),e(E.mdhd,n)},p=function(t){return e(E.mdia,f(t),g(t.type),o(t))},a=function(t){return e(E.mfhd,new Uint8Array([0,0,0,0,(4278190080&t)>>24,(16711680&t)>>16,(65280&t)>>8,255&t]))},o=function(n){return e(E.minf,"video"===n.type?e(E.vmhd,D):e(E.smhd,R),t(),v(n))},s=function(t,n){for(var i=[],r=n.length;r--;)i[r]=b(n[r]);return e.apply(null,[E.moof,a(t)].concat(i))},l=function(t){for(var n=t.length,i=[];n--;)i[n]=d(t[n]);return e.apply(null,[E.moov,c(4294967295)].concat(i).concat(u(t)))},u=function(t){for(var n=t.length,i=[];n--;)i[n]=_(t[n]);return e.apply(null,[E.mvex].concat(i))},c=function(t){var n=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,2,0,1,95,144,(4278190080&t)>>24,(16711680&t)>>16,(65280&t)>>8,255&t,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return e(E.mvhd,n)},m=function(t){var n,i,r=t.samples||[],a=new Uint8Array(4+r.length);for(i=0;i<r.length;i++)n=r[i].flags,a[i+4]=n.dependsOn<<4|n.isDependedOn<<2|n.hasRedundancy;return e(E.sdtp,a)},v=function(t){return e(E.stbl,y(t),e(E.stts,N),e(E.stsc,P),e(E.stsz,L),e(E.stco,A))},y=function(t){return e(E.stsd,new Uint8Array([0,0,0,0,0,0,0,1]),"video"===t.type?M(t):K(t))},M=function(t){var n,i=t.sps||[],r=t.pps||[],a=[],o=[];for(n=0;n<i.length;n++)a.push((65280&i[n].byteLength)>>>8),a.push(255&i[n].byteLength),a=a.concat(Array.prototype.slice.call(i[n]));for(n=0;n<r.length;n++)o.push((65280&r[n].byteLength)>>>8),o.push(255&r[n].byteLength),o=o.concat(Array.prototype.slice.call(r[n]));return e(E.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,(65280&t.width)>>8,255&t.width,(65280&t.height)>>8,255&t.height,0,72,0,0,0,72,0,0,0,0,0,0,0,1,19,118,105,100,101,111,106,115,45,99,111,110,116,114,105,98,45,104,108,115,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),e(E.avcC,new Uint8Array([1,t.profileIdc,t.profileCompatibility,t.levelIdc,255].concat([i.length]).concat(a).concat([r.length]).concat(o))),e(E.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])))},K=function(t){return e(E.mp4a,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,(65280&t.channelcount)>>8,255&t.channelcount,(65280&t.samplesize)>>8,255&t.samplesize,0,0,0,0,(65280&t.samplerate)>>8,255&t.samplerate,0,0]),i(t))},h=function(t){var n=new Uint8Array([0,0,0,7,0,0,0,0,0,0,0,0,(4278190080&t.id)>>24,(16711680&t.id)>>16,(65280&t.id)>>8,255&t.id,0,0,0,0,(4278190080&t.duration)>>24,(16711680&t.duration)>>16,(65280&t.duration)>>8,255&t.duration,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,(65280&t.width)>>8,255&t.width,0,0,(65280&t.height)>>8,255&t.height,0,0]);return e(E.tkhd,n)},b=function(t){var n,i,r,a,o,s;return n=e(E.tfhd,new Uint8Array([0,0,0,58,(4278190080&t.id)>>24,(16711680&t.id)>>16,(65280&t.id)>>8,255&t.id,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0])),o=Math.floor(t.baseMediaDecodeTime/(F+1)),s=Math.floor(t.baseMediaDecodeTime%(F+1)),i=e(E.tfdt,new Uint8Array([1,0,0,0,o>>>24&255,o>>>16&255,o>>>8&255,255&o,s>>>24&255,s>>>16&255,s>>>8&255,255&s])),"audio"===t.type?(r=T(t,92),e(E.traf,n,i,r)):(a=m(t),r=T(t,a.length+92),e(E.traf,n,i,r,a))},d=function(t){return t.duration=t.duration||4294967295,e(E.trak,h(t),p(t))},_=function(t){var n=new Uint8Array([0,0,0,0,(4278190080&t.id)>>24,(16711680&t.id)>>16,(65280&t.id)>>8,255&t.id,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]);return"video"!==t.type&&(n[n.length-1]=0),e(E.trex,n)},B=function(e,t){var n=0,i=0,r=0,a=0;return e.length&&(void 0!==e[0].duration&&(n=1),void 0!==e[0].size&&(i=2),void 0!==e[0].flags&&(r=4),void 0!==e[0].compositionTimeOffset&&(a=8)),[0,0,n|i|r|a,1,(4278190080&e.length)>>>24,(16711680&e.length)>>>16,(65280&e.length)>>>8,255&e.length,(4278190080&t)>>>24,(16711680&t)>>>16,(65280&t)>>>8,255&t]},j=function(t,n){var i,r,a,o;for(n+=20+16*(r=t.samples||[]).length,i=B(r,n),o=0;o<r.length;o++)a=r[o],i=i.concat([(4278190080&a.duration)>>>24,(16711680&a.duration)>>>16,(65280&a.duration)>>>8,255&a.duration,(4278190080&a.size)>>>24,(16711680&a.size)>>>16,(65280&a.size)>>>8,255&a.size,a.flags.isLeading<<2|a.flags.dependsOn,a.flags.isDependedOn<<6|a.flags.hasRedundancy<<4|a.flags.paddingValue<<1|a.flags.isNonSyncSample,61440&a.flags.degradationPriority,15&a.flags.degradationPriority,(4278190080&a.compositionTimeOffset)>>>24,(16711680&a.compositionTimeOffset)>>>16,(65280&a.compositionTimeOffset)>>>8,255&a.compositionTimeOffset]);return e(E.trun,new Uint8Array(i))},$=function(t,n){var i,r,a,o;for(n+=20+8*(r=t.samples||[]).length,i=B(r,n),o=0;o<r.length;o++)a=r[o],i=i.concat([(4278190080&a.duration)>>>24,(16711680&a.duration)>>>16,(65280&a.duration)>>>8,255&a.duration,(4278190080&a.size)>>>24,(16711680&a.size)>>>16,(65280&a.size)>>>8,255&a.size]);return e(E.trun,new Uint8Array(i))},T=function(e,t){return"audio"===e.type?$(e,t):j(e,t)};var U,V,q={ftyp:r=function(){return e(E.ftyp,C,w,C,k)},mdat:function(t){return e(E.mdat,t)},moof:s,moov:l,initSegment:function(e){var t,n=r(),i=l(e);return(t=new Uint8Array(n.byteLength+i.byteLength)).set(n),t.set(i,n.byteLength),t}},H=function(e){return e>>>0},z={findBox:U=function(e,t){var n,i,r,a,o,s=[];if(!t.length)return null;for(n=0;n<e.byteLength;)i=H(e[n]<<24|e[n+1]<<16|e[n+2]<<8|e[n+3]),r=V(e.subarray(n+4,n+8)),a=i>1?n+i:e.byteLength,r===t[0]&&(1===t.length?s.push(e.subarray(n+8,a)):(o=U(e.subarray(n+8,a),t.slice(1))).length&&(s=s.concat(o))),n=a;return s},parseType:V=function(e){var t="";return t+=String.fromCharCode(e[0]),t+=String.fromCharCode(e[1]),(t+=String.fromCharCode(e[2]))+String.fromCharCode(e[3])},timescale:function(e){return U(e,["moov","trak"]).reduce(function(e,t){var n,i,r,a,o;return(n=U(t,["tkhd"])[0])?(i=n[0],a=H(n[r=0===i?12:20]<<24|n[r+1]<<16|n[r+2]<<8|n[r+3]),(o=U(t,["mdia","mdhd"])[0])?(r=0===(i=o[0])?12:20,e[a]=H(o[r]<<24|o[r+1]<<16|o[r+2]<<8|o[r+3]),e):null):null},{})},startTime:function(e,t){var n,i,r;return n=U(t,["moof","traf"]),i=[].concat.apply([],n.map(function(t){return U(t,["tfhd"]).map(function(n){var i,r;return i=H(n[4]<<24|n[5]<<16|n[6]<<8|n[7]),r=e[i]||9e4,(U(t,["tfdt"]).map(function(e){var t,n;return t=e[0],n=H(e[4]<<24|e[5]<<16|e[6]<<8|e[7]),1===t&&(n*=Math.pow(2,32),n+=H(e[8]<<24|e[9]<<16|e[10]<<8|e[11])),n})[0]||1/0)/r})})),r=Math.min.apply(null,i),isFinite(r)?r:0},videoTrackIds:function(e){var t=[];return U(e,["moov","trak"]).forEach(function(e){var n=U(e,["mdia","hdlr"]),i=U(e,["tkhd"]);n.forEach(function(e,n){var r,a,o=V(e.subarray(8,12)),s=i[n];"vide"===o&&(a=0===(r=new DataView(s.buffer,s.byteOffset,s.byteLength)).getUint8(0)?r.getUint32(12):r.getUint32(20),t.push(a))})}),t}},W=function(){this.init=function(){var e={};this.on=function(t,n){e[t]||(e[t]=[]),e[t]=e[t].concat(n)},this.off=function(t,n){var i;return!!e[t]&&(i=e[t].indexOf(n),e[t]=e[t].slice(),e[t].splice(i,1),i>-1)},this.trigger=function(t){var n,i,r,a;if(n=e[t])if(2===arguments.length)for(r=n.length,i=0;i<r;++i)n[i].call(this,arguments[1]);else{for(a=[],i=arguments.length,i=1;i<arguments.length;++i)a.push(arguments[i]);for(r=n.length,i=0;i<r;++i)n[i].apply(this,a)}},this.dispose=function(){e={}}}};W.prototype.pipe=function(e){return this.on("data",function(t){e.push(t)}),this.on("done",function(t){e.flush(t)}),e},W.prototype.push=function(e){this.trigger("data",e)},W.prototype.flush=function(e){this.trigger("done",e)};var G,X,Y,Q,J,Z=W,ee=function(e,t){var n={size:0,flags:{isLeading:0,dependsOn:1,isDependedOn:0,hasRedundancy:0,degradationPriority:0,isNonSyncSample:1}};return n.dataOffset=t,n.compositionTimeOffset=e.pts-e.dts,n.duration=e.duration,n.size=4*e.length,n.size+=e.byteLength,e.keyFrame&&(n.flags.dependsOn=2,n.flags.isNonSyncSample=0),n},te=function(e){var t,n,i=[],r=[];for(i.byteLength=0,t=0;t<e.length;t++)"access_unit_delimiter_rbsp"===(n=e[t]).nalUnitType?(i.length&&(i.duration=n.dts-i.dts,r.push(i)),(i=[n]).byteLength=n.data.byteLength,i.pts=n.pts,i.dts=n.dts):("slice_layer_without_partitioning_rbsp_idr"===n.nalUnitType&&(i.keyFrame=!0),i.duration=n.dts-i.dts,i.byteLength+=n.data.byteLength,i.push(n));return r.length&&(!i.duration||i.duration<=0)&&(i.duration=r[r.length-1].duration),r.push(i),r},ne=function(e){var t,n,i=[],r=[];for(i.byteLength=0,i.nalCount=0,i.duration=0,i.pts=e[0].pts,i.dts=e[0].dts,r.byteLength=0,r.nalCount=0,r.duration=0,r.pts=e[0].pts,r.dts=e[0].dts,t=0;t<e.length;t++)(n=e[t]).keyFrame?(i.length&&(r.push(i),r.byteLength+=i.byteLength,r.nalCount+=i.nalCount,r.duration+=i.duration),(i=[n]).nalCount=n.length,i.byteLength=n.byteLength,i.pts=n.pts,i.dts=n.dts,i.duration=n.duration):(i.duration+=n.duration,i.nalCount+=n.length,i.byteLength+=n.byteLength,i.push(n));return r.length&&i.duration<=0&&(i.duration=r[r.length-1].duration),r.byteLength+=i.byteLength,r.nalCount+=i.nalCount,r.duration+=i.duration,r.push(i),r},ie=function(e){var t;return!e[0][0].keyFrame&&e.length>1&&(t=e.shift(),e.byteLength-=t.byteLength,e.nalCount-=t.nalCount,e[0][0].dts=t.dts,e[0][0].pts=t.pts,e[0][0].duration+=t.duration),e},re=function(e,t){var n,i,r,a,o,s=t||0,l=[];for(n=0;n<e.length;n++)for(a=e[n],i=0;i<a.length;i++)o=a[i],s+=(r=ee(o,s)).size,l.push(r);return l},ae=function(e){var t,n,i,r,a,o,s=0,l=e.byteLength,u=e.nalCount,c=new Uint8Array(l+4*u),d=new DataView(c.buffer);for(t=0;t<e.length;t++)for(r=e[t],n=0;n<r.length;n++)for(a=r[n],i=0;i<a.length;i++)o=a[i],d.setUint32(s,o.data.byteLength),s+=4,c.set(o.data,s),s+=o.data.byteLength;return c},oe=[33,16,5,32,164,27],se=[33,65,108,84,1,2,4,8,168,2,4,8,17,191,252],le=function(e){for(var t=[];e--;)t.push(0);return t},ue={96000:[oe,[227,64],le(154),[56]],88200:[oe,[231],le(170),[56]],64000:[oe,[248,192],le(240),[56]],48000:[oe,[255,192],le(268),[55,148,128],le(54),[112]],44100:[oe,[255,192],le(268),[55,163,128],le(84),[112]],32000:[oe,[255,192],le(268),[55,234],le(226),[112]],24000:[oe,[255,192],le(268),[55,255,128],le(268),[111,112],le(126),[224]],16000:[oe,[255,192],le(268),[55,255,128],le(268),[111,255],le(269),[223,108],le(195),[1,192]],12000:[se,le(268),[3,127,248],le(268),[6,255,240],le(268),[13,255,224],le(268),[27,253,128],le(259),[56]],11025:[se,le(268),[3,127,248],le(268),[6,255,240],le(268),[13,255,224],le(268),[27,255,192],le(268),[55,175,128],le(108),[112]],8000:[se,le(268),[3,121,16],le(47),[7]]},ce=(G=ue,Object.keys(G).reduce(function(e,t){return e[t]=new Uint8Array(G[t].reduce(function(e,t){return e.concat(t)},[])),e},{})),de=(X=function(e){return 9e4*e},Y=function(e,t){return e*t},Q=function(e){return e/9e4},J=function(e,t){return e/t},function(e,t){return X(J(e,t))}),he=function(e,t){return Y(Q(e),t)},pe=function(e,t,n,i){var r,a,o,s=0,l=0,u=0,c=0;if(t.length&&(r=de(e.baseMediaDecodeTime,e.samplerate),s=Math.ceil(9e4/(e.samplerate/1024)),n&&i&&(l=r-Math.max(n,i),c=(u=Math.floor(l/s))*s),!(u<1||c>45e3))){for((a=ce[e.samplerate])||(a=t[0].data),o=0;o<u;o++)t.splice(o,0,{data:a});e.baseMediaDecodeTime-=Math.floor(he(c,e.samplerate))}},fe=function(e,t,n){return t.minSegmentDts>=n?e:(t.minSegmentDts=1/0,e.filter(function(e){return e.dts>=n&&(t.minSegmentDts=Math.min(t.minSegmentDts,e.dts),t.minSegmentPts=t.minSegmentDts,!0)}))},ge=function(e){var t,n,i=[];for(t=0;t<e.length;t++)n=e[t],i.push({size:n.data.byteLength,duration:1024});return i},me=function(e){var t,n,i=0,r=new Uint8Array(function(e){var t,n=0;for(t=0;t<e.length;t++)n+=e[t].data.byteLength;return n}(e));for(t=0;t<e.length;t++)n=e[t],r.set(n.data,i),i+=n.data.byteLength;return r},ve=function(e){delete e.minSegmentDts,delete e.maxSegmentDts,delete e.minSegmentPts,delete e.maxSegmentPts},ye=function(e,t){var n,i=e.minSegmentDts;return t||(i-=e.timelineStartInfo.dts),n=e.timelineStartInfo.baseMediaDecodeTime,n+=i,n=Math.max(0,n),"audio"===e.type&&(n*=e.samplerate/9e4,n=Math.floor(n)),n},be=function(e,t){"number"==typeof t.pts&&(void 0===e.timelineStartInfo.pts&&(e.timelineStartInfo.pts=t.pts),void 0===e.minSegmentPts?e.minSegmentPts=t.pts:e.minSegmentPts=Math.min(e.minSegmentPts,t.pts),void 0===e.maxSegmentPts?e.maxSegmentPts=t.pts:e.maxSegmentPts=Math.max(e.maxSegmentPts,t.pts)),"number"==typeof t.dts&&(void 0===e.timelineStartInfo.dts&&(e.timelineStartInfo.dts=t.dts),void 0===e.minSegmentDts?e.minSegmentDts=t.dts:e.minSegmentDts=Math.min(e.minSegmentDts,t.dts),void 0===e.maxSegmentDts?e.maxSegmentDts=t.dts:e.maxSegmentDts=Math.max(e.maxSegmentDts,t.dts))},_e=function(e){for(var t=0,n={payloadType:-1,payloadSize:0},i=0,r=0;t<e.byteLength&&128!==e[t];){for(;255===e[t];)i+=255,t++;for(i+=e[t++];255===e[t];)r+=255,t++;if(r+=e[t++],!n.payload&&4===i){n.payloadType=i,n.payloadSize=r,n.payload=e.subarray(t,t+r);break}t+=r,i=0,r=0}return n},Te=function(e){return 181!==e.payload[0]?null:49!=(e.payload[1]<<8|e.payload[2])?null:"GA94"!==String.fromCharCode(e.payload[3],e.payload[4],e.payload[5],e.payload[6])?null:3!==e.payload[7]?null:e.payload.subarray(8,e.payload.length-1)},Ee=function(e,t){var n,i,r,a,o=[];if(!(64&t[0]))return o;for(i=31&t[0],n=0;n<i;n++)a={type:3&t[2+(r=3*n)],pts:e},4&t[r+2]&&(a.ccData=t[r+3]<<8|t[r+4],o.push(a));return o},Ce=function(e){for(var t,n,i=e.byteLength,r=[],a=1;a<i-2;)0===e[a]&&0===e[a+1]&&3===e[a+2]?(r.push(a+2),a+=2):a++;if(0===r.length)return e;t=i-r.length,n=new Uint8Array(t);var o=0;for(a=0;a<t;o++,a++)o===r[0]&&(o++,r.shift()),n[a]=e[o];return n},we=4,ke=function e(){e.prototype.init.call(this),this.captionPackets_=[],this.ccStreams_=[new Re(0,0),new Re(0,1),new Re(1,0),new Re(1,1)],this.reset(),this.ccStreams_.forEach(function(e){e.on("data",this.trigger.bind(this,"data")),e.on("done",this.trigger.bind(this,"done"))},this)};(ke.prototype=new Z).push=function(e){var t,n,i;if("sei_rbsp"===e.nalUnitType&&(t=_e(e.escapedRBSP)).payloadType===we&&(n=Te(t)))if(e.dts<this.latestDts_)this.ignoreNextEqualDts_=!0;else{if(e.dts===this.latestDts_&&this.ignoreNextEqualDts_)return this.numSameDts_--,void(this.numSameDts_||(this.ignoreNextEqualDts_=!1));i=Ee(e.pts,n),this.captionPackets_=this.captionPackets_.concat(i),this.latestDts_!==e.dts&&(this.numSameDts_=0),this.numSameDts_++,this.latestDts_=e.dts}},ke.prototype.flush=function(){this.captionPackets_.length?(this.captionPackets_.forEach(function(e,t){e.presortIndex=t}),this.captionPackets_.sort(function(e,t){return e.pts===t.pts?e.presortIndex-t.presortIndex:e.pts-t.pts}),this.captionPackets_.forEach(function(e){e.type<2&&this.dispatchCea608Packet(e)},this),this.captionPackets_.length=0,this.ccStreams_.forEach(function(e){e.flush()},this)):this.ccStreams_.forEach(function(e){e.flush()},this)},ke.prototype.reset=function(){this.latestDts_=null,this.ignoreNextEqualDts_=!1,this.numSameDts_=0,this.activeCea608Channel_=[null,null],this.ccStreams_.forEach(function(e){e.reset()})},ke.prototype.dispatchCea608Packet=function(e){this.setsTextOrXDSActive(e)?this.activeCea608Channel_[e.type]=null:this.setsChannel1Active(e)?this.activeCea608Channel_[e.type]=0:this.setsChannel2Active(e)&&(this.activeCea608Channel_[e.type]=1),null!==this.activeCea608Channel_[e.type]&&this.ccStreams_[(e.type<<1)+this.activeCea608Channel_[e.type]].push(e)},ke.prototype.setsChannel1Active=function(e){return 4096==(30720&e.ccData)},ke.prototype.setsChannel2Active=function(e){return 6144==(30720&e.ccData)},ke.prototype.setsTextOrXDSActive=function(e){return 256==(28928&e.ccData)||4138==(30974&e.ccData)||6186==(30974&e.ccData)};var Se={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,304:174,305:176,306:189,307:191,308:8482,309:162,310:163,311:9834,312:224,313:160,314:232,315:226,316:234,317:238,318:244,319:251,544:193,545:201,546:211,547:218,548:220,549:252,550:8216,551:161,552:42,553:39,554:8212,555:169,556:8480,557:8226,558:8220,559:8221,560:192,561:194,562:199,563:200,564:202,565:203,566:235,567:206,568:207,569:239,570:212,571:217,572:249,573:219,574:171,575:187,800:195,801:227,802:205,803:204,804:236,805:210,806:242,807:213,808:245,809:123,810:125,811:92,812:94,813:95,814:124,815:126,816:196,817:228,818:214,819:246,820:223,821:165,822:164,823:9474,824:197,825:229,826:216,827:248,828:9484,829:9488,830:9492,831:9496},Ie=function(e){return null===e?"":(e=Se[e]||e,String.fromCharCode(e))},Oe=[4352,4384,4608,4640,5376,5408,5632,5664,5888,5920,4096,4864,4896,5120,5152],De=function(){for(var e=[],t=15;t--;)e.push("");return e},Re=function e(t,n){e.prototype.init.call(this),this.field_=t||0,this.dataChannel_=n||0,this.name_="CC"+(1+(this.field_<<1|this.dataChannel_)),this.setConstants(),this.reset(),this.push=function(e){var t,n,i,r,a;if((t=32639&e.ccData)!==this.lastControlCode_){if(4096==(61440&t)?this.lastControlCode_=t:t!==this.PADDING_&&(this.lastControlCode_=null),i=t>>>8,r=255&t,t!==this.PADDING_)if(t===this.RESUME_CAPTION_LOADING_)this.mode_="popOn";else if(t===this.END_OF_CAPTION_)this.mode_="popOn",this.clearFormatting(e.pts),this.flushDisplayed(e.pts),n=this.displayed_,this.displayed_=this.nonDisplayed_,this.nonDisplayed_=n,this.startPts_=e.pts;else if(t===this.ROLL_UP_2_ROWS_)this.rollUpRows_=2,this.setRollUp(e.pts);else if(t===this.ROLL_UP_3_ROWS_)this.rollUpRows_=3,this.setRollUp(e.pts);else if(t===this.ROLL_UP_4_ROWS_)this.rollUpRows_=4,this.setRollUp(e.pts);else if(t===this.CARRIAGE_RETURN_)this.clearFormatting(e.pts),this.flushDisplayed(e.pts),this.shiftRowsUp_(),this.startPts_=e.pts;else if(t===this.BACKSPACE_)"popOn"===this.mode_?this.nonDisplayed_[this.row_]=this.nonDisplayed_[this.row_].slice(0,-1):this.displayed_[this.row_]=this.displayed_[this.row_].slice(0,-1);else if(t===this.ERASE_DISPLAYED_MEMORY_)this.flushDisplayed(e.pts),this.displayed_=De();else if(t===this.ERASE_NON_DISPLAYED_MEMORY_)this.nonDisplayed_=De();else if(t===this.RESUME_DIRECT_CAPTIONING_)"paintOn"!==this.mode_&&(this.flushDisplayed(e.pts),this.displayed_=De()),this.mode_="paintOn",this.startPts_=e.pts;else if(this.isSpecialCharacter(i,r))a=Ie((i=(3&i)<<8)|r),this[this.mode_](e.pts,a),this.column_++;else if(this.isExtCharacter(i,r))"popOn"===this.mode_?this.nonDisplayed_[this.row_]=this.nonDisplayed_[this.row_].slice(0,-1):this.displayed_[this.row_]=this.displayed_[this.row_].slice(0,-1),a=Ie((i=(3&i)<<8)|r),this[this.mode_](e.pts,a),this.column_++;else if(this.isMidRowCode(i,r))this.clearFormatting(e.pts),this[this.mode_](e.pts," "),this.column_++,14==(14&r)&&this.addFormatting(e.pts,["i"]),1==(1&r)&&this.addFormatting(e.pts,["u"]);else if(this.isOffsetControlCode(i,r))this.column_+=3&r;else if(this.isPAC(i,r)){var o=Oe.indexOf(7968&t);"rollUp"===this.mode_&&(o-this.rollUpRows_+1<0&&(o=this.rollUpRows_-1),this.setRollUp(e.pts,o)),o!==this.row_&&(this.clearFormatting(e.pts),this.row_=o),1&r&&-1===this.formatting_.indexOf("u")&&this.addFormatting(e.pts,["u"]),16==(16&t)&&(this.column_=4*((14&t)>>1)),this.isColorPAC(r)&&14==(14&r)&&this.addFormatting(e.pts,["i"])}else this.isNormalChar(i)&&(0===r&&(r=null),a=Ie(i),a+=Ie(r),this[this.mode_](e.pts,a),this.column_+=a.length)}else this.lastControlCode_=null}};Re.prototype=new Z,Re.prototype.flushDisplayed=function(e){var t=this.displayed_.map(function(e){try{return e.trim()}catch(e){return console.error("Skipping malformed caption."),""}}).join("\n").replace(/^\n+|\n+$/g,"");t.length&&this.trigger("data",{startPts:this.startPts_,endPts:e,text:t,stream:this.name_})},Re.prototype.reset=function(){this.mode_="popOn",this.topRow_=0,this.startPts_=0,this.displayed_=De(),this.nonDisplayed_=De(),this.lastControlCode_=null,this.column_=0,this.row_=14,this.rollUpRows_=2,this.formatting_=[]},Re.prototype.setConstants=function(){0===this.dataChannel_?(this.BASE_=16,this.EXT_=17,this.CONTROL_=(20|this.field_)<<8,this.OFFSET_=23):1===this.dataChannel_&&(this.BASE_=24,this.EXT_=25,this.CONTROL_=(28|this.field_)<<8,this.OFFSET_=31),this.PADDING_=0,this.RESUME_CAPTION_LOADING_=32|this.CONTROL_,this.END_OF_CAPTION_=47|this.CONTROL_,this.ROLL_UP_2_ROWS_=37|this.CONTROL_,this.ROLL_UP_3_ROWS_=38|this.CONTROL_,this.ROLL_UP_4_ROWS_=39|this.CONTROL_,this.CARRIAGE_RETURN_=45|this.CONTROL_,this.RESUME_DIRECT_CAPTIONING_=41|this.CONTROL_,this.BACKSPACE_=33|this.CONTROL_,this.ERASE_DISPLAYED_MEMORY_=44|this.CONTROL_,this.ERASE_NON_DISPLAYED_MEMORY_=46|this.CONTROL_},Re.prototype.isSpecialCharacter=function(e,t){return e===this.EXT_&&t>=48&&t<=63},Re.prototype.isExtCharacter=function(e,t){return(e===this.EXT_+1||e===this.EXT_+2)&&t>=32&&t<=63},Re.prototype.isMidRowCode=function(e,t){return e===this.EXT_&&t>=32&&t<=47},Re.prototype.isOffsetControlCode=function(e,t){return e===this.OFFSET_&&t>=33&&t<=35},Re.prototype.isPAC=function(e,t){return e>=this.BASE_&&e<this.BASE_+8&&t>=64&&t<=127},Re.prototype.isColorPAC=function(e){return e>=64&&e<=79||e>=96&&e<=127},Re.prototype.isNormalChar=function(e){return e>=32&&e<=127},Re.prototype.setRollUp=function(e,t){if("rollUp"!==this.mode_&&(this.row_=14,this.mode_="rollUp",this.flushDisplayed(e),this.nonDisplayed_=De(),this.displayed_=De()),void 0!==t&&t!==this.row_)for(var n=0;n<this.rollUpRows_;n++)this.displayed_[t-n]=this.displayed_[this.row_-n],this.displayed_[this.row_-n]="";void 0===t&&(t=this.row_),this.topRow_=t-this.rollUpRows_+1},Re.prototype.addFormatting=function(e,t){this.formatting_=this.formatting_.concat(t);var n=t.reduce(function(e,t){return e+"<"+t+">"},"");this[this.mode_](e,n)},Re.prototype.clearFormatting=function(e){if(this.formatting_.length){var t=this.formatting_.reverse().reduce(function(e,t){return e+"</"+t+">"},"");this.formatting_=[],this[this.mode_](e,t)}},Re.prototype.popOn=function(e,t){var n=this.nonDisplayed_[this.row_];n+=t,this.nonDisplayed_[this.row_]=n},Re.prototype.rollUp=function(e,t){var n=this.displayed_[this.row_];n+=t,this.displayed_[this.row_]=n},Re.prototype.shiftRowsUp_=function(){var e;for(e=0;e<this.topRow_;e++)this.displayed_[e]="";for(e=this.row_+1;e<15;e++)this.displayed_[e]="";for(e=this.topRow_;e<this.row_;e++)this.displayed_[e]=this.displayed_[e+1];this.displayed_[this.row_]=""},Re.prototype.paintOn=function(e,t){var n=this.displayed_[this.row_];n+=t,this.displayed_[this.row_]=n};var xe={CaptionStream:ke,Cea608Stream:Re},Ae={H264_STREAM_TYPE:27,ADTS_STREAM_TYPE:15,METADATA_STREAM_TYPE:21},Pe=function(e,t){var n=1;for(e>t&&(n=-1);Math.abs(t-e)>4294967296;)e+=8589934592*n;return e},Le=function e(t){var n,i;e.prototype.init.call(this),this.type_=t,this.push=function(e){e.type===this.type_&&(void 0===i&&(i=e.dts),e.dts=Pe(e.dts,i),e.pts=Pe(e.pts,i),n=e.dts,this.trigger("data",e))},this.flush=function(){i=n,this.trigger("done")},this.discontinuity=function(){i=void 0,n=void 0}};Le.prototype=new Z;var Ne,Me=Le,Ke=function(e,t,n){var i,r="";for(i=t;i<n;i++)r+="%"+("00"+e[i].toString(16)).slice(-2);return r},$e=function(e,t,n){return decodeURIComponent(Ke(e,t,n))},je=function(e){return e[0]<<21|e[1]<<14|e[2]<<7|e[3]},Be={TXXX:function(e){var t;if(3===e.data[0]){for(t=1;t<e.data.length;t++)if(0===e.data[t]){e.description=$e(e.data,1,t),e.value=$e(e.data,t+1,e.data.length).replace(/\0*$/,"");break}e.data=e.value}},WXXX:function(e){var t;if(3===e.data[0])for(t=1;t<e.data.length;t++)if(0===e.data[t]){e.description=$e(e.data,1,t),e.url=$e(e.data,t+1,e.data.length);break}},PRIV:function(e){var t,n;for(t=0;t<e.data.length;t++)if(0===e.data[t]){e.owner=(n=e.data,unescape(Ke(n,start,end)));break}e.privateData=e.data.subarray(t+1),e.data=e.privateData}};(Ne=function(e){var t,n={debug:!(!e||!e.debug),descriptor:e&&e.descriptor},i=0,r=[],a=0;if(Ne.prototype.init.call(this),this.dispatchType=Ae.METADATA_STREAM_TYPE.toString(16),n.descriptor)for(t=0;t<n.descriptor.length;t++)this.dispatchType+=("00"+n.descriptor[t].toString(16)).slice(-2);this.push=function(e){var t,o,s,l,u;if("timed-metadata"===e.type)if(e.dataAlignmentIndicator&&(a=0,r.length=0),0===r.length&&(e.data.length<10||e.data[0]!=="I".charCodeAt(0)||e.data[1]!=="D".charCodeAt(0)||e.data[2]!=="3".charCodeAt(0)))n.debug&&console.log("Skipping unrecognized metadata packet");else if(r.push(e),a+=e.data.byteLength,1===r.length&&(i=je(e.data.subarray(6,10)),i+=10),!(a<i)){for(t={data:new Uint8Array(i),frames:[],pts:r[0].pts,dts:r[0].dts},u=0;u<i;)t.data.set(r[0].data.subarray(0,i-u),u),u+=r[0].data.byteLength,a-=r[0].data.byteLength,r.shift();o=10,64&t.data[5]&&(o+=4,o+=je(t.data.subarray(10,14)),i-=je(t.data.subarray(16,20)));do{if((s=je(t.data.subarray(o+4,o+8)))<1)return console.log("Malformed ID3 frame encountered. Skipping metadata parsing.");if((l={id:String.fromCharCode(t.data[o],t.data[o+1],t.data[o+2],t.data[o+3]),data:t.data.subarray(o+10,o+s+10)}).key=l.id,Be[l.id]&&(Be[l.id](l),"com.apple.streaming.transportStreamTimestamp"===l.owner)){var c=l.data,d=(1&c[3])<<30|c[4]<<22|c[5]<<14|c[6]<<6|c[7]>>>2;d*=4,d+=3&c[7],l.timeStamp=d,void 0===t.pts&&void 0===t.dts&&(t.pts=l.timeStamp,t.dts=l.timeStamp),this.trigger("timestamp",l)}t.frames.push(l),o+=10,o+=s}while(o<i);this.trigger("data",t)}}}).prototype=new Z;var Fe,Ue,Ve,qe=Ne,He=Me;(Fe=function(){var e=new Uint8Array(188),t=0;Fe.prototype.init.call(this),this.push=function(n){var i,r=0,a=188;for(t?((i=new Uint8Array(n.byteLength+t)).set(e.subarray(0,t)),i.set(n,t),t=0):i=n;a<i.byteLength;)71!==i[r]||71!==i[a]?(r++,a++):(this.trigger("data",i.subarray(r,a)),r+=188,a+=188);r<i.byteLength&&(e.set(i.subarray(r),0),t=i.byteLength-r)},this.flush=function(){188===t&&71===e[0]&&(this.trigger("data",e),t=0),this.trigger("done")}}).prototype=new Z,(Ue=function(){var e,t,n,i;Ue.prototype.init.call(this),i=this,this.packetsWaitingForPmt=[],this.programMapTable=void 0,e=function(e,i){var r=0;i.payloadUnitStartIndicator&&(r+=e[r]+1),"pat"===i.type?t(e.subarray(r),i):n(e.subarray(r),i)},t=function(e,t){t.section_number=e[7],t.last_section_number=e[8],i.pmtPid=(31&e[10])<<8|e[11],t.pmtPid=i.pmtPid},n=function(e,t){var n,r;if(1&e[5]){for(i.programMapTable={video:null,audio:null,"timed-metadata":{}},n=3+((15&e[1])<<8|e[2])-4,r=12+((15&e[10])<<8|e[11]);r<n;){var a=e[r],o=(31&e[r+1])<<8|e[r+2];a===Ae.H264_STREAM_TYPE&&null===i.programMapTable.video?i.programMapTable.video=o:a===Ae.ADTS_STREAM_TYPE&&null===i.programMapTable.audio?i.programMapTable.audio=o:a===Ae.METADATA_STREAM_TYPE&&(i.programMapTable["timed-metadata"][o]=a),r+=5+((15&e[r+3])<<8|e[r+4])}t.programMapTable=i.programMapTable}},this.push=function(t){var n={},i=4;if(n.payloadUnitStartIndicator=!!(64&t[1]),n.pid=31&t[1],n.pid<<=8,n.pid|=t[2],(48&t[3])>>>4>1&&(i+=t[i]+1),0===n.pid)n.type="pat",e(t.subarray(i),n),this.trigger("data",n);else if(n.pid===this.pmtPid)for(n.type="pmt",e(t.subarray(i),n),this.trigger("data",n);this.packetsWaitingForPmt.length;)this.processPes_.apply(this,this.packetsWaitingForPmt.shift());else void 0===this.programMapTable?this.packetsWaitingForPmt.push([t,i,n]):this.processPes_(t,i,n)},this.processPes_=function(e,t,n){n.pid===this.programMapTable.video?n.streamType=Ae.H264_STREAM_TYPE:n.pid===this.programMapTable.audio?n.streamType=Ae.ADTS_STREAM_TYPE:n.streamType=this.programMapTable["timed-metadata"][n.pid],n.type="pes",n.data=e.subarray(t),this.trigger("data",n)}}).prototype=new Z,Ue.STREAM_TYPES={h264:27,adts:15},(Ve=function(){var e=this,t={data:[],size:0},n={data:[],size:0},i={data:[],size:0},r=function(t,n,i){var r,a,o,s,l=new Uint8Array(t.size),u={type:n},c=0,d=0,h=!1;if(t.data.length&&!(t.size<9)){for(u.trackId=t.data[0].pid,c=0;c<t.data.length;c++)r=t.data[c],l.set(r.data,d),d+=r.data.byteLength;a=l,(o=u).packetLength=6+(a[4]<<8|a[5]),o.dataAlignmentIndicator=0!=(4&a[6]),192&(s=a[7])&&(o.pts=(14&a[9])<<27|(255&a[10])<<20|(254&a[11])<<12|(255&a[12])<<5|(254&a[13])>>>3,o.pts*=4,o.pts+=(6&a[13])>>>1,o.dts=o.pts,64&s&&(o.dts=(14&a[14])<<27|(255&a[15])<<20|(254&a[16])<<12|(255&a[17])<<5|(254&a[18])>>>3,o.dts*=4,o.dts+=(6&a[18])>>>1)),o.data=a.subarray(9+a[8]),h="video"===n||u.packetLength<=t.size,(i||h)&&(t.size=0,t.data.length=0),h&&e.trigger("data",u)}};Ve.prototype.init.call(this),this.push=function(a){({pat:function(){},pes:function(){var e,o;switch(a.streamType){case Ae.H264_STREAM_TYPE:case Ae.H264_STREAM_TYPE:e=t,o="video";break;case Ae.ADTS_STREAM_TYPE:e=n,o="audio";break;case Ae.METADATA_STREAM_TYPE:e=i,o="timed-metadata";break;default:return}a.payloadUnitStartIndicator&&r(e,o,!0),e.data.push(a),e.size+=a.data.byteLength},pmt:function(){var t={type:"metadata",tracks:[]},n=a.programMapTable;null!==n.video&&t.tracks.push({timelineStartInfo:{baseMediaDecodeTime:0},id:+n.video,codec:"avc",type:"video"}),null!==n.audio&&t.tracks.push({timelineStartInfo:{baseMediaDecodeTime:0},id:+n.audio,codec:"adts",type:"audio"}),e.trigger("data",t)}})[a.type]()},this.flush=function(){r(t,"video"),r(n,"audio"),r(i,"timed-metadata"),this.trigger("done")}}).prototype=new Z;var ze={PAT_PID:0,MP2T_PACKET_LENGTH:188,TransportPacketStream:Fe,TransportParseStream:Ue,ElementaryStream:Ve,TimestampRolloverStream:He,CaptionStream:xe.CaptionStream,Cea608Stream:xe.Cea608Stream,MetadataStream:qe};for(var We in Ae)Ae.hasOwnProperty(We)&&(ze[We]=Ae[We]);var Ge,Xe=ze,Ye=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350];(Ge=function(){var e;Ge.prototype.init.call(this),this.push=function(t){var n,i,r,a,o,s,l=0,u=0;if("audio"===t.type)for(e?(a=e,(e=new Uint8Array(a.byteLength+t.data.byteLength)).set(a),e.set(t.data,a.byteLength)):e=t.data;l+5<e.length;)if(255===e[l]&&240==(246&e[l+1])){if(i=2*(1&~e[l+1]),n=(3&e[l+3])<<11|e[l+4]<<3|(224&e[l+5])>>5,s=9e4*(o=1024*(1+(3&e[l+6])))/Ye[(60&e[l+2])>>>2],r=l+n,e.byteLength<r)return;if(this.trigger("data",{pts:t.pts+u*s,dts:t.dts+u*s,sampleCount:o,audioobjecttype:1+(e[l+2]>>>6&3),channelcount:(1&e[l+2])<<2|(192&e[l+3])>>>6,samplerate:Ye[(60&e[l+2])>>>2],samplingfrequencyindex:(60&e[l+2])>>>2,samplesize:16,data:e.subarray(l+7+i,r)}),e.byteLength===r)return void(e=void 0);u++,e=e.subarray(r)}else l++},this.flush=function(){this.trigger("done")}}).prototype=new Z;var Qe,Je,Ze,et=Ge;(Je=function(){var e,t,n=0;Je.prototype.init.call(this),this.push=function(i){var r;for(t?((r=new Uint8Array(t.byteLength+i.data.byteLength)).set(t),r.set(i.data,t.byteLength),t=r):t=i.data;n<t.byteLength-3;n++)if(1===t[n+2]){e=n+5;break}for(;e<t.byteLength;)switch(t[e]){case 0:if(0!==t[e-1]){e+=2;break}if(0!==t[e-2]){e++;break}n+3!==e-2&&this.trigger("data",t.subarray(n+3,e-2));do{e++}while(1!==t[e]&&e<t.length);n=e-2,e+=3;break;case 1:if(0!==t[e-1]||0!==t[e-2]){e+=3;break}this.trigger("data",t.subarray(n+3,e-2)),n=e-2,e+=3;break;default:e+=3}t=t.subarray(n),e-=n,n=0},this.flush=function(){t&&t.byteLength>3&&this.trigger("data",t.subarray(n+3)),t=null,n=0,this.trigger("done")}}).prototype=new Z,Ze={100:!0,110:!0,122:!0,244:!0,44:!0,83:!0,86:!0,118:!0,128:!0,138:!0,139:!0,134:!0},(Qe=function(){var e,t,n,i,r,a,o,s=new Je;Qe.prototype.init.call(this),e=this,this.push=function(e){"video"===e.type&&(t=e.trackId,n=e.pts,i=e.dts,s.push(e))},s.on("data",function(o){var s={trackId:t,pts:n,dts:i,data:o};switch(31&o[0]){case 5:s.nalUnitType="slice_layer_without_partitioning_rbsp_idr";break;case 6:s.nalUnitType="sei_rbsp",s.escapedRBSP=r(o.subarray(1));break;case 7:s.nalUnitType="seq_parameter_set_rbsp",s.escapedRBSP=r(o.subarray(1)),s.config=a(s.escapedRBSP);break;case 8:s.nalUnitType="pic_parameter_set_rbsp";break;case 9:s.nalUnitType="access_unit_delimiter_rbsp"}e.trigger("data",s)}),s.on("done",function(){e.trigger("done")}),this.flush=function(){s.flush()},o=function(e,t){var n,i=8,r=8;for(n=0;n<e;n++)0!==r&&(r=(i+t.readExpGolomb()+256)%256),i=0===r?i:r},r=function(e){for(var t,n,i=e.byteLength,r=[],a=1;a<i-2;)0===e[a]&&0===e[a+1]&&3===e[a+2]?(r.push(a+2),a+=2):a++;if(0===r.length)return e;t=i-r.length,n=new Uint8Array(t);var o=0;for(a=0;a<t;o++,a++)o===r[0]&&(o++,r.shift()),n[a]=e[o];return n},a=function(e){var t,n,i,r,a,s,l,u,c,d,h,p,f,g=0,m=0,v=0,y=0,b=1;if(t=new function(e){var t=e.byteLength,n=0,i=0;this.length=function(){return 8*t},this.bitsAvailable=function(){return 8*t+i},this.loadWord=function(){var r=e.byteLength-t,a=new Uint8Array(4),o=Math.min(4,t);if(0===o)throw new Error("no bytes available");a.set(e.subarray(r,r+o)),n=new DataView(a.buffer).getUint32(0),i=8*o,t-=o},this.skipBits=function(e){var r;i>e?(n<<=e,i-=e):(e-=i,e-=8*(r=Math.floor(e/8)),t-=r,this.loadWord(),n<<=e,i-=e)},this.readBits=function(e){var r=Math.min(i,e),a=n>>>32-r;return(i-=r)>0?n<<=r:t>0&&this.loadWord(),(r=e-r)>0?a<<r|this.readBits(r):a},this.skipLeadingZeros=function(){var e;for(e=0;e<i;++e)if(0!=(n&2147483648>>>e))return n<<=e,i-=e,e;return this.loadWord(),e+this.skipLeadingZeros()},this.skipUnsignedExpGolomb=function(){this.skipBits(1+this.skipLeadingZeros())},this.skipExpGolomb=function(){this.skipBits(1+this.skipLeadingZeros())},this.readUnsignedExpGolomb=function(){var e=this.skipLeadingZeros();return this.readBits(e+1)-1},this.readExpGolomb=function(){var e=this.readUnsignedExpGolomb();return 1&e?1+e>>>1:-1*(e>>>1)},this.readBoolean=function(){return 1===this.readBits(1)},this.readUnsignedByte=function(){return this.readBits(8)},this.loadWord()}(e),n=t.readUnsignedByte(),r=t.readUnsignedByte(),i=t.readUnsignedByte(),t.skipUnsignedExpGolomb(),Ze[n]&&(3===(a=t.readUnsignedExpGolomb())&&t.skipBits(1),t.skipUnsignedExpGolomb(),t.skipUnsignedExpGolomb(),t.skipBits(1),t.readBoolean()))for(h=3!==a?8:12,f=0;f<h;f++)t.readBoolean()&&o(f<6?16:64,t);if(t.skipUnsignedExpGolomb(),0===(s=t.readUnsignedExpGolomb()))t.readUnsignedExpGolomb();else if(1===s)for(t.skipBits(1),t.skipExpGolomb(),t.skipExpGolomb(),l=t.readUnsignedExpGolomb(),f=0;f<l;f++)t.skipExpGolomb();if(t.skipUnsignedExpGolomb(),t.skipBits(1),u=t.readUnsignedExpGolomb(),c=t.readUnsignedExpGolomb(),0===(d=t.readBits(1))&&t.skipBits(1),t.skipBits(1),t.readBoolean()&&(g=t.readUnsignedExpGolomb(),m=t.readUnsignedExpGolomb(),v=t.readUnsignedExpGolomb(),y=t.readUnsignedExpGolomb()),t.readBoolean()&&t.readBoolean()){switch(t.readUnsignedByte()){case 1:p=[1,1];break;case 2:p=[12,11];break;case 3:p=[10,11];break;case 4:p=[16,11];break;case 5:p=[40,33];break;case 6:p=[24,11];break;case 7:p=[20,11];break;case 8:p=[32,11];break;case 9:p=[80,33];break;case 10:p=[18,11];break;case 11:p=[15,11];break;case 12:p=[64,33];break;case 13:p=[160,99];break;case 14:p=[4,3];break;case 15:p=[3,2];break;case 16:p=[2,1];break;case 255:p=[t.readUnsignedByte()<<8|t.readUnsignedByte(),t.readUnsignedByte()<<8|t.readUnsignedByte()]}p&&(b=p[0]/p[1])}return{profileIdc:n,levelIdc:i,profileCompatibility:r,width:Math.ceil((16*(u+1)-2*g-2*m)*b),height:(2-d)*(c+1)*16-2*v-2*y}}}).prototype=new Z;var tt,nt={H264Stream:Qe,NalByteStream:Je},it=function(e){return e[0]==="I".charCodeAt(0)&&e[1]==="D".charCodeAt(0)&&e[2]==="3".charCodeAt(0)},rt=function(e,t){var n=e[t+6]<<21|e[t+7]<<14|e[t+8]<<7|e[t+9];return(16&e[t+5])>>4?n+20:n+10},at=function(e,t){var n=(224&e[t+5])>>5,i=e[t+4]<<3;return 6144&e[t+3]|i|n};(tt=function(){var e=new Uint8Array,t=0;tt.prototype.init.call(this),this.setTimestamp=function(e){t=e},this.push=function(n){var i,r,a,o,s=0,l=0;for(e.length?(o=e.length,(e=new Uint8Array(n.byteLength+o)).set(e.subarray(0,o)),e.set(n,o)):e=n;e.length-l>=3;)if(e[l]!=="I".charCodeAt(0)||e[l+1]!=="D".charCodeAt(0)||e[l+2]!=="3".charCodeAt(0))if(255!=(255&e[l])||240!=(240&e[l+1]))l++;else{if(e.length-l<7)break;if(l+(s=at(e,l))>e.length)break;a={type:"audio",data:e.subarray(l,l+s),pts:t,dts:t},this.trigger("data",a),l+=s}else{if(e.length-l<10)break;if(l+(s=rt(e,l))>e.length)break;r={type:"timed-metadata",data:e.subarray(l,l+s)},this.trigger("data",r),l+=s}i=e.length-l,e=i>0?e.subarray(l):new Uint8Array}}).prototype=new Z;var ot,st,lt,ut,ct=tt,dt=nt.H264Stream,ht=it,pt=["audioobjecttype","channelcount","samplerate","samplingfrequencyindex","samplesize"],ft=["width","height","profileIdc","levelIdc","profileCompatibility"],gt=function(e,t){var n;if(e.length!==t.length)return!1;for(n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0},mt=function(e,t,n,i,r,a){return{start:{dts:e,pts:e+(n-t)},end:{dts:e+(i-t),pts:e+(r-n)},prependedContentDuration:a,baseMediaDecodeTime:e}};(st=function(e,t){var n=[],i=0,r=0,a=0,o=1/0;t=t||{},st.prototype.init.call(this),this.push=function(t){be(e,t),e&&pt.forEach(function(n){e[n]=t[n]}),n.push(t)},this.setEarliestDts=function(t){r=t-e.timelineStartInfo.baseMediaDecodeTime},this.setVideoBaseMediaDecodeTime=function(e){o=e},this.setAudioAppendStart=function(e){a=e},this.flush=function(){var s,l,u,c;0!==n.length?(s=fe(n,e,r),e.baseMediaDecodeTime=ye(e,t.keepOriginalTimestamps),pe(e,s,a,o),e.samples=ge(s),u=q.mdat(me(s)),n=[],l=q.moof(i,[e]),c=new Uint8Array(l.byteLength+u.byteLength),i++,c.set(l),c.set(u,l.byteLength),ve(e),this.trigger("data",{track:e,boxes:c}),this.trigger("done","AudioSegmentStream")):this.trigger("done","AudioSegmentStream")}}).prototype=new Z,(ot=function(e,t){var n,i,r=0,a=[],o=[];t=t||{},ot.prototype.init.call(this),delete e.minPTS,this.gopCache_=[],this.push=function(t){be(e,t),"seq_parameter_set_rbsp"!==t.nalUnitType||n||(n=t.config,e.sps=[t.data],ft.forEach(function(t){e[t]=n[t]},this)),"pic_parameter_set_rbsp"!==t.nalUnitType||i||(i=t.data,e.pps=[t.data]),a.push(t)},this.flush=function(){for(var n,i,s,l,u,c,d,h,p=0;a.length&&"access_unit_delimiter_rbsp"!==a[0].nalUnitType;)a.shift();if(0===a.length)return this.resetStream_(),void this.trigger("done","VideoSegmentStream");if(n=te(a),(s=ne(n))[0][0].keyFrame||((i=this.getGopForFusion_(a[0],e))?(p=i.duration,s.unshift(i),s.byteLength+=i.byteLength,s.nalCount+=i.nalCount,s.pts=i.pts,s.dts=i.dts,s.duration+=i.duration):s=ie(s)),o.length){var f;if(!(f=t.alignGopsAtEnd?this.alignGopsAtEnd_(s):this.alignGopsAtStart_(s)))return this.gopCache_.unshift({gop:s.pop(),pps:e.pps,sps:e.sps}),this.gopCache_.length=Math.min(6,this.gopCache_.length),a=[],this.resetStream_(),void this.trigger("done","VideoSegmentStream");ve(e),s=f}be(e,s),e.samples=re(s),u=q.mdat(ae(s)),e.baseMediaDecodeTime=ye(e,t.keepOriginalTimestamps),this.trigger("processedGopsInfo",s.map(function(e){return{pts:e.pts,dts:e.dts,byteLength:e.byteLength}})),d=s[0],h=s[s.length-1],this.trigger("segmentTimingInfo",mt(e.baseMediaDecodeTime,d.dts,d.pts,h.dts+h.duration,h.pts+h.duration,p)),this.gopCache_.unshift({gop:s.pop(),pps:e.pps,sps:e.sps}),this.gopCache_.length=Math.min(6,this.gopCache_.length),a=[],this.trigger("baseMediaDecodeTime",e.baseMediaDecodeTime),this.trigger("timelineStartInfo",e.timelineStartInfo),l=q.moof(r,[e]),c=new Uint8Array(l.byteLength+u.byteLength),r++,c.set(l),c.set(u,l.byteLength),this.trigger("data",{track:e,boxes:c}),this.resetStream_(),this.trigger("done","VideoSegmentStream")},this.resetStream_=function(){ve(e),n=void 0,i=void 0},this.getGopForFusion_=function(t){var n,i,r,a,o,s=1/0;for(o=0;o<this.gopCache_.length;o++)r=(a=this.gopCache_[o]).gop,e.pps&&gt(e.pps[0],a.pps[0])&&e.sps&&gt(e.sps[0],a.sps[0])&&(r.dts<e.timelineStartInfo.dts||(n=t.dts-r.dts-r.duration)>=-1e4&&n<=45e3&&(!i||s>n)&&(i=a,s=n));return i?i.gop:null},this.alignGopsAtStart_=function(e){var t,n,i,r,a,s,l,u;for(a=e.byteLength,s=e.nalCount,l=e.duration,t=n=0;t<o.length&&n<e.length&&(i=o[t],r=e[n],i.pts!==r.pts);)r.pts>i.pts?t++:(n++,a-=r.byteLength,s-=r.nalCount,l-=r.duration);return 0===n?e:n===e.length?null:((u=e.slice(n)).byteLength=a,u.duration=l,u.nalCount=s,u.pts=u[0].pts,u.dts=u[0].dts,u)},this.alignGopsAtEnd_=function(e){var t,n,i,r,a,s,l;for(t=o.length-1,n=e.length-1,a=null,s=!1;t>=0&&n>=0;){if(i=o[t],r=e[n],i.pts===r.pts){s=!0;break}i.pts>r.pts?t--:(t===o.length-1&&(a=n),n--)}if(!s&&null===a)return null;if(0===(l=s?n:a))return e;var u=e.slice(l),c=u.reduce(function(e,t){return e.byteLength+=t.byteLength,e.duration+=t.duration,e.nalCount+=t.nalCount,e},{byteLength:0,duration:0,nalCount:0});return u.byteLength=c.byteLength,u.duration=c.duration,u.nalCount=c.nalCount,u.pts=u[0].pts,u.dts=u[0].dts,u},this.alignGopsWith=function(e){o=e}}).prototype=new Z,(ut=function(e,t){this.numberOfTracks=0,this.metadataStream=t,void 0!==(e=e||{}).remux?this.remuxTracks=!!e.remux:this.remuxTracks=!0,"boolean"==typeof e.keepOriginalTimestamps&&(this.keepOriginalTimestamps=e.keepOriginalTimestamps),this.pendingTracks=[],this.videoTrack=null,this.pendingBoxes=[],this.pendingCaptions=[],this.pendingMetadata=[],this.pendingBytes=0,this.emittedTracks=0,ut.prototype.init.call(this),this.push=function(e){return e.text?this.pendingCaptions.push(e):e.frames?this.pendingMetadata.push(e):(this.pendingTracks.push(e.track),this.pendingBoxes.push(e.boxes),this.pendingBytes+=e.boxes.byteLength,"video"===e.track.type&&(this.videoTrack=e.track),void("audio"===e.track.type&&(this.audioTrack=e.track)))}}).prototype=new Z,ut.prototype.flush=function(e){var t,n,i,r,a=0,o={captions:[],captionStreams:{},metadata:[],info:{}},s=0;if(this.pendingTracks.length<this.numberOfTracks){if("VideoSegmentStream"!==e&&"AudioSegmentStream"!==e)return;if(this.remuxTracks)return;if(0===this.pendingTracks.length)return this.emittedTracks++,void(this.emittedTracks>=this.numberOfTracks&&(this.trigger("done"),this.emittedTracks=0))}for(this.videoTrack?(s=this.videoTrack.timelineStartInfo.pts,ft.forEach(function(e){o.info[e]=this.videoTrack[e]},this)):this.audioTrack&&(s=this.audioTrack.timelineStartInfo.pts,pt.forEach(function(e){o.info[e]=this.audioTrack[e]},this)),1===this.pendingTracks.length?o.type=this.pendingTracks[0].type:o.type="combined",this.emittedTracks+=this.pendingTracks.length,i=q.initSegment(this.pendingTracks),o.initSegment=new Uint8Array(i.byteLength),o.initSegment.set(i),o.data=new Uint8Array(this.pendingBytes),r=0;r<this.pendingBoxes.length;r++)o.data.set(this.pendingBoxes[r],a),a+=this.pendingBoxes[r].byteLength;for(r=0;r<this.pendingCaptions.length;r++)(t=this.pendingCaptions[r]).startTime=t.startPts,this.keepOriginalTimestamps||(t.startTime-=s),t.startTime/=9e4,t.endTime=t.endPts,this.keepOriginalTimestamps||(t.endTime-=s),t.endTime/=9e4,o.captionStreams[t.stream]=!0,o.captions.push(t);for(r=0;r<this.pendingMetadata.length;r++)(n=this.pendingMetadata[r]).cueTime=n.pts,this.keepOriginalTimestamps||(n.cueTime-=s),n.cueTime/=9e4,o.metadata.push(n);o.metadata.dispatchType=this.metadataStream.dispatchType,this.pendingTracks.length=0,this.videoTrack=null,this.pendingBoxes.length=0,this.pendingCaptions.length=0,this.pendingBytes=0,this.pendingMetadata.length=0,this.trigger("data",o),this.emittedTracks>=this.numberOfTracks&&(this.trigger("done"),this.emittedTracks=0)},(lt=function(e){var t,n,i=this,r=!0;lt.prototype.init.call(this),e=e||{},this.baseMediaDecodeTime=e.baseMediaDecodeTime||0,this.transmuxPipeline_={},this.setupAacPipeline=function(){var t={};this.transmuxPipeline_=t,t.type="aac",t.metadataStream=new Xe.MetadataStream,t.aacStream=new ct,t.audioTimestampRolloverStream=new Xe.TimestampRolloverStream("audio"),t.timedMetadataTimestampRolloverStream=new Xe.TimestampRolloverStream("timed-metadata"),t.adtsStream=new et,t.coalesceStream=new ut(e,t.metadataStream),t.headOfPipeline=t.aacStream,t.aacStream.pipe(t.audioTimestampRolloverStream).pipe(t.adtsStream),t.aacStream.pipe(t.timedMetadataTimestampRolloverStream).pipe(t.metadataStream).pipe(t.coalesceStream),t.metadataStream.on("timestamp",function(e){t.aacStream.setTimestamp(e.timeStamp)}),t.aacStream.on("data",function(r){"timed-metadata"!==r.type||t.audioSegmentStream||(n=n||{timelineStartInfo:{baseMediaDecodeTime:i.baseMediaDecodeTime},codec:"adts",type:"audio"},t.coalesceStream.numberOfTracks++,t.audioSegmentStream=new st(n,e),t.adtsStream.pipe(t.audioSegmentStream).pipe(t.coalesceStream))}),t.coalesceStream.on("data",this.trigger.bind(this,"data")),t.coalesceStream.on("done",this.trigger.bind(this,"done"))},this.setupTsPipeline=function(){var r={};this.transmuxPipeline_=r,r.type="ts",r.metadataStream=new Xe.MetadataStream,r.packetStream=new Xe.TransportPacketStream,r.parseStream=new Xe.TransportParseStream,r.elementaryStream=new Xe.ElementaryStream,r.videoTimestampRolloverStream=new Xe.TimestampRolloverStream("video"),r.audioTimestampRolloverStream=new Xe.TimestampRolloverStream("audio"),r.timedMetadataTimestampRolloverStream=new Xe.TimestampRolloverStream("timed-metadata"),r.adtsStream=new et,r.h264Stream=new dt,r.captionStream=new Xe.CaptionStream,r.coalesceStream=new ut(e,r.metadataStream),r.headOfPipeline=r.packetStream,r.packetStream.pipe(r.parseStream).pipe(r.elementaryStream),r.elementaryStream.pipe(r.videoTimestampRolloverStream).pipe(r.h264Stream),r.elementaryStream.pipe(r.audioTimestampRolloverStream).pipe(r.adtsStream),r.elementaryStream.pipe(r.timedMetadataTimestampRolloverStream).pipe(r.metadataStream).pipe(r.coalesceStream),r.h264Stream.pipe(r.captionStream).pipe(r.coalesceStream),r.elementaryStream.on("data",function(a){var o;if("metadata"===a.type){for(o=a.tracks.length;o--;)t||"video"!==a.tracks[o].type?n||"audio"!==a.tracks[o].type||((n=a.tracks[o]).timelineStartInfo.baseMediaDecodeTime=i.baseMediaDecodeTime):(t=a.tracks[o]).timelineStartInfo.baseMediaDecodeTime=i.baseMediaDecodeTime;t&&!r.videoSegmentStream&&(r.coalesceStream.numberOfTracks++,r.videoSegmentStream=new ot(t,e),r.videoSegmentStream.on("timelineStartInfo",function(e){n&&(n.timelineStartInfo=e,r.audioSegmentStream.setEarliestDts(e.dts))}),r.videoSegmentStream.on("processedGopsInfo",i.trigger.bind(i,"gopInfo")),r.videoSegmentStream.on("segmentTimingInfo",i.trigger.bind(i,"videoSegmentTimingInfo")),r.videoSegmentStream.on("baseMediaDecodeTime",function(e){n&&r.audioSegmentStream.setVideoBaseMediaDecodeTime(e)}),r.h264Stream.pipe(r.videoSegmentStream).pipe(r.coalesceStream)),n&&!r.audioSegmentStream&&(r.coalesceStream.numberOfTracks++,r.audioSegmentStream=new st(n,e),r.adtsStream.pipe(r.audioSegmentStream).pipe(r.coalesceStream))}}),r.coalesceStream.on("data",this.trigger.bind(this,"data")),r.coalesceStream.on("done",this.trigger.bind(this,"done"))},this.setBaseMediaDecodeTime=function(i){var r=this.transmuxPipeline_;e.keepOriginalTimestamps||(this.baseMediaDecodeTime=i),n&&(n.timelineStartInfo.dts=void 0,n.timelineStartInfo.pts=void 0,ve(n),e.keepOriginalTimestamps||(n.timelineStartInfo.baseMediaDecodeTime=i),r.audioTimestampRolloverStream&&r.audioTimestampRolloverStream.discontinuity()),t&&(r.videoSegmentStream&&(r.videoSegmentStream.gopCache_=[],r.videoTimestampRolloverStream.discontinuity()),t.timelineStartInfo.dts=void 0,t.timelineStartInfo.pts=void 0,ve(t),r.captionStream.reset(),e.keepOriginalTimestamps||(t.timelineStartInfo.baseMediaDecodeTime=i)),r.timedMetadataTimestampRolloverStream&&r.timedMetadataTimestampRolloverStream.discontinuity()},this.setAudioAppendStart=function(e){n&&this.transmuxPipeline_.audioSegmentStream.setAudioAppendStart(e)},this.alignGopsWith=function(e){t&&this.transmuxPipeline_.videoSegmentStream&&this.transmuxPipeline_.videoSegmentStream.alignGopsWith(e)},this.push=function(e){if(r){var t=ht(e);t&&"aac"!==this.transmuxPipeline_.type?this.setupAacPipeline():t||"ts"===this.transmuxPipeline_.type||this.setupTsPipeline(),r=!1}this.transmuxPipeline_.headOfPipeline.push(e)},this.flush=function(){r=!0,this.transmuxPipeline_.headOfPipeline.flush()},this.resetCaptions=function(){this.transmuxPipeline_.captionStream&&this.transmuxPipeline_.captionStream.reset()}}).prototype=new Z;var vt,yt,bt={Transmuxer:lt,VideoSegmentStream:ot,AudioSegmentStream:st,AUDIO_PROPERTIES:pt,VIDEO_PROPERTIES:ft,generateVideoSegmentTimingInfo:mt},_t=z.parseType,Tt=function(e){return new Date(1e3*e-20828448e5)},Et=function(e){return{isLeading:(12&e[0])>>>2,dependsOn:3&e[0],isDependedOn:(192&e[1])>>>6,hasRedundancy:(48&e[1])>>>4,paddingValue:(14&e[1])>>>1,isNonSyncSample:1&e[1],degradationPriority:e[2]<<8|e[3]}},Ct={avc1:function(e){var t=new DataView(e.buffer,e.byteOffset,e.byteLength);return{dataReferenceIndex:t.getUint16(6),width:t.getUint16(24),height:t.getUint16(26),horizresolution:t.getUint16(28)+t.getUint16(30)/16,vertresolution:t.getUint16(32)+t.getUint16(34)/16,frameCount:t.getUint16(40),depth:t.getUint16(74),config:vt(e.subarray(78,e.byteLength))}},avcC:function(e){var t,n,i,r,a=new DataView(e.buffer,e.byteOffset,e.byteLength),o={configurationVersion:e[0],avcProfileIndication:e[1],profileCompatibility:e[2],avcLevelIndication:e[3],lengthSizeMinusOne:3&e[4],sps:[],pps:[]},s=31&e[5];for(i=6,r=0;r<s;r++)n=a.getUint16(i),i+=2,o.sps.push(new Uint8Array(e.subarray(i,i+n))),i+=n;for(t=e[i],i++,r=0;r<t;r++)n=a.getUint16(i),i+=2,o.pps.push(new Uint8Array(e.subarray(i,i+n))),i+=n;return o},btrt:function(e){var t=new DataView(e.buffer,e.byteOffset,e.byteLength);return{bufferSizeDB:t.getUint32(0),maxBitrate:t.getUint32(4),avgBitrate:t.getUint32(8)}},esds:function(e){return{version:e[0],flags:new Uint8Array(e.subarray(1,4)),esId:e[6]<<8|e[7],streamPriority:31&e[8],decoderConfig:{objectProfileIndication:e[11],streamType:e[12]>>>2&63,bufferSize:e[13]<<16|e[14]<<8|e[15],maxBitrate:e[16]<<24|e[17]<<16|e[18]<<8|e[19],avgBitrate:e[20]<<24|e[21]<<16|e[22]<<8|e[23],decoderConfigDescriptor:{tag:e[24],length:e[25],audioObjectType:e[26]>>>3&31,samplingFrequencyIndex:(7&e[26])<<1|e[27]>>>7&1,channelConfiguration:e[27]>>>3&15}}}},ftyp:function(e){for(var t=new DataView(e.buffer,e.byteOffset,e.byteLength),n={majorBrand:_t(e.subarray(0,4)),minorVersion:t.getUint32(4),compatibleBrands:[]},i=8;i<e.byteLength;)n.compatibleBrands.push(_t(e.subarray(i,i+4))),i+=4;return n},dinf:function(e){return{boxes:vt(e)}},dref:function(e){return{version:e[0],flags:new Uint8Array(e.subarray(1,4)),dataReferences:vt(e.subarray(8))}},hdlr:function(e){var t={version:new DataView(e.buffer,e.byteOffset,e.byteLength).getUint8(0),flags:new Uint8Array(e.subarray(1,4)),handlerType:_t(e.subarray(8,12)),name:""},n=8;for(n=24;n<e.byteLength;n++){if(0===e[n]){n++;break}t.name+=String.fromCharCode(e[n])}return t.name=decodeURIComponent(escape(t.name)),t},mdat:function(e){return{byteLength:e.byteLength,nals:function(e){var t,n,i=new DataView(e.buffer,e.byteOffset,e.byteLength),r=[];for(t=0;t+4<e.length;t+=n)if(n=i.getUint32(t),t+=4,n<=0)r.push("<span style='color:red;'>MALFORMED DATA</span>");else switch(31&e[t]){case 1:r.push("slice_layer_without_partitioning_rbsp");break;case 5:r.push("slice_layer_without_partitioning_rbsp_idr");break;case 6:r.push("sei_rbsp");break;case 7:r.push("seq_parameter_set_rbsp");break;case 8:r.push("pic_parameter_set_rbsp");break;case 9:r.push("access_unit_delimiter_rbsp");break;default:r.push("UNKNOWN NAL - "+e[t]&31)}return r}(e)}},mdhd:function(e){var t,n=new DataView(e.buffer,e.byteOffset,e.byteLength),i=4,r={version:n.getUint8(0),flags:new Uint8Array(e.subarray(1,4)),language:""};return 1===r.version?(i+=4,r.creationTime=Tt(n.getUint32(i)),i+=8,r.modificationTime=Tt(n.getUint32(i)),i+=4,r.timescale=n.getUint32(i),i+=8,r.duration=n.getUint32(i)):(r.creationTime=Tt(n.getUint32(i)),i+=4,r.modificationTime=Tt(n.getUint32(i)),i+=4,r.timescale=n.getUint32(i),i+=4,r.duration=n.getUint32(i)),i+=4,t=n.getUint16(i),r.language+=String.fromCharCode(96+(t>>10)),r.language+=String.fromCharCode(96+((992&t)>>5)),r.language+=String.fromCharCode(96+(31&t)),r},mdia:function(e){return{boxes:vt(e)}},mfhd:function(e){return{version:e[0],flags:new Uint8Array(e.subarray(1,4)),sequenceNumber:e[4]<<24|e[5]<<16|e[6]<<8|e[7]}},minf:function(e){return{boxes:vt(e)}},mp4a:function(e){var t=new DataView(e.buffer,e.byteOffset,e.byteLength),n={dataReferenceIndex:t.getUint16(6),channelcount:t.getUint16(16),samplesize:t.getUint16(18),samplerate:t.getUint16(24)+t.getUint16(26)/65536};return e.byteLength>28&&(n.streamDescriptor=vt(e.subarray(28))[0]),n},moof:function(e){return{boxes:vt(e)}},moov:function(e){return{boxes:vt(e)}},mvex:function(e){return{boxes:vt(e)}},mvhd:function(e){var t=new DataView(e.buffer,e.byteOffset,e.byteLength),n=4,i={version:t.getUint8(0),flags:new Uint8Array(e.subarray(1,4))};return 1===i.version?(n+=4,i.creationTime=Tt(t.getUint32(n)),n+=8,i.modificationTime=Tt(t.getUint32(n)),n+=4,i.timescale=t.getUint32(n),n+=8,i.duration=t.getUint32(n)):(i.creationTime=Tt(t.getUint32(n)),n+=4,i.modificationTime=Tt(t.getUint32(n)),n+=4,i.timescale=t.getUint32(n),n+=4,i.duration=t.getUint32(n)),n+=4,i.rate=t.getUint16(n)+t.getUint16(n+2)/16,n+=4,i.volume=t.getUint8(n)+t.getUint8(n+1)/8,n+=2,n+=2,n+=8,i.matrix=new Uint32Array(e.subarray(n,n+36)),n+=36,n+=24,i.nextTrackId=t.getUint32(n),i},pdin:function(e){var t=new DataView(e.buffer,e.byteOffset,e.byteLength);return{version:t.getUint8(0),flags:new Uint8Array(e.subarray(1,4)),rate:t.getUint32(4),initialDelay:t.getUint32(8)}},sdtp:function(e){var t,n={version:e[0],flags:new Uint8Array(e.subarray(1,4)),samples:[]};for(t=4;t<e.byteLength;t++)n.samples.push({dependsOn:(48&e[t])>>4,isDependedOn:(12&e[t])>>2,hasRedundancy:3&e[t]});return n},sidx:function(e){var t,n=new DataView(e.buffer,e.byteOffset,e.byteLength),i={version:e[0],flags:new Uint8Array(e.subarray(1,4)),references:[],referenceId:n.getUint32(4),timescale:n.getUint32(8),earliestPresentationTime:n.getUint32(12),firstOffset:n.getUint32(16)},r=n.getUint16(22);for(t=24;r;t+=12,r--)i.references.push({referenceType:(128&e[t])>>>7,referencedSize:2147483647&n.getUint32(t),subsegmentDuration:n.getUint32(t+4),startsWithSap:!!(128&e[t+8]),sapType:(112&e[t+8])>>>4,sapDeltaTime:268435455&n.getUint32(t+8)});return i},smhd:function(e){return{version:e[0],flags:new Uint8Array(e.subarray(1,4)),balance:e[4]+e[5]/256}},stbl:function(e){return{boxes:vt(e)}},stco:function(e){var t,n=new DataView(e.buffer,e.byteOffset,e.byteLength),i={version:e[0],flags:new Uint8Array(e.subarray(1,4)),chunkOffsets:[]},r=n.getUint32(4);for(t=8;r;t+=4,r--)i.chunkOffsets.push(n.getUint32(t));return i},stsc:function(e){var t,n=new DataView(e.buffer,e.byteOffset,e.byteLength),i=n.getUint32(4),r={version:e[0],flags:new Uint8Array(e.subarray(1,4)),sampleToChunks:[]};for(t=8;i;t+=12,i--)r.sampleToChunks.push({firstChunk:n.getUint32(t),samplesPerChunk:n.getUint32(t+4),sampleDescriptionIndex:n.getUint32(t+8)});return r},stsd:function(e){return{version:e[0],flags:new Uint8Array(e.subarray(1,4)),sampleDescriptions:vt(e.subarray(8))}},stsz:function(e){var t,n=new DataView(e.buffer,e.byteOffset,e.byteLength),i={version:e[0],flags:new Uint8Array(e.subarray(1,4)),sampleSize:n.getUint32(4),entries:[]};for(t=12;t<e.byteLength;t+=4)i.entries.push(n.getUint32(t));return i},stts:function(e){var t,n=new DataView(e.buffer,e.byteOffset,e.byteLength),i={version:e[0],flags:new Uint8Array(e.subarray(1,4)),timeToSamples:[]},r=n.getUint32(4);for(t=8;r;t+=8,r--)i.timeToSamples.push({sampleCount:n.getUint32(t),sampleDelta:n.getUint32(t+4)});return i},styp:function(e){return Ct.ftyp(e)},tfdt:function(e){var t={version:e[0],flags:new Uint8Array(e.subarray(1,4)),baseMediaDecodeTime:e[4]<<24|e[5]<<16|e[6]<<8|e[7]};return 1===t.version&&(t.baseMediaDecodeTime*=Math.pow(2,32),t.baseMediaDecodeTime+=e[8]<<24|e[9]<<16|e[10]<<8|e[11]),t},tfhd:function(e){var t,n=new DataView(e.buffer,e.byteOffset,e.byteLength),i={version:e[0],flags:new Uint8Array(e.subarray(1,4)),trackId:n.getUint32(4)},r=1&i.flags[2],a=2&i.flags[2],o=8&i.flags[2],s=16&i.flags[2],l=32&i.flags[2],u=65536&i.flags[0],c=131072&i.flags[0];return t=8,r&&(t+=4,i.baseDataOffset=n.getUint32(12),t+=4),a&&(i.sampleDescriptionIndex=n.getUint32(t),t+=4),o&&(i.defaultSampleDuration=n.getUint32(t),t+=4),s&&(i.defaultSampleSize=n.getUint32(t),t+=4),l&&(i.defaultSampleFlags=n.getUint32(t)),u&&(i.durationIsEmpty=!0),!r&&c&&(i.baseDataOffsetIsMoof=!0),i},tkhd:function(e){var t=new DataView(e.buffer,e.byteOffset,e.byteLength),n=4,i={version:t.getUint8(0),flags:new Uint8Array(e.subarray(1,4))};return 1===i.version?(n+=4,i.creationTime=Tt(t.getUint32(n)),n+=8,i.modificationTime=Tt(t.getUint32(n)),n+=4,i.trackId=t.getUint32(n),n+=4,n+=8,i.duration=t.getUint32(n)):(i.creationTime=Tt(t.getUint32(n)),n+=4,i.modificationTime=Tt(t.getUint32(n)),n+=4,i.trackId=t.getUint32(n),n+=4,n+=4,i.duration=t.getUint32(n)),n+=4,n+=8,i.layer=t.getUint16(n),n+=2,i.alternateGroup=t.getUint16(n),n+=2,i.volume=t.getUint8(n)+t.getUint8(n+1)/8,n+=2,n+=2,i.matrix=new Uint32Array(e.subarray(n,n+36)),n+=36,i.width=t.getUint16(n)+t.getUint16(n+2)/16,n+=4,i.height=t.getUint16(n)+t.getUint16(n+2)/16,i},traf:function(e){return{boxes:vt(e)}},trak:function(e){return{boxes:vt(e)}},trex:function(e){var t=new DataView(e.buffer,e.byteOffset,e.byteLength);return{version:e[0],flags:new Uint8Array(e.subarray(1,4)),trackId:t.getUint32(4),defaultSampleDescriptionIndex:t.getUint32(8),defaultSampleDuration:t.getUint32(12),defaultSampleSize:t.getUint32(16),sampleDependsOn:3&e[20],sampleIsDependedOn:(192&e[21])>>6,sampleHasRedundancy:(48&e[21])>>4,samplePaddingValue:(14&e[21])>>1,sampleIsDifferenceSample:!!(1&e[21]),sampleDegradationPriority:t.getUint16(22)}},trun:function(e){var t,n={version:e[0],flags:new Uint8Array(e.subarray(1,4)),samples:[]},i=new DataView(e.buffer,e.byteOffset,e.byteLength),r=1&n.flags[2],a=4&n.flags[2],o=1&n.flags[1],s=2&n.flags[1],l=4&n.flags[1],u=8&n.flags[1],c=i.getUint32(4),d=8;for(r&&(n.dataOffset=i.getInt32(d),d+=4),a&&c&&(t={flags:Et(e.subarray(d,d+4))},d+=4,o&&(t.duration=i.getUint32(d),d+=4),s&&(t.size=i.getUint32(d),d+=4),u&&(t.compositionTimeOffset=i.getUint32(d),d+=4),n.samples.push(t),c--);c--;)t={},o&&(t.duration=i.getUint32(d),d+=4),s&&(t.size=i.getUint32(d),d+=4),l&&(t.flags=Et(e.subarray(d,d+4)),d+=4),u&&(t.compositionTimeOffset=i.getUint32(d),d+=4),n.samples.push(t);return n},"url ":function(e){return{version:e[0],flags:new Uint8Array(e.subarray(1,4))}},vmhd:function(e){var t=new DataView(e.buffer,e.byteOffset,e.byteLength);return{version:e[0],flags:new Uint8Array(e.subarray(1,4)),graphicsmode:t.getUint16(4),opcolor:new Uint16Array([t.getUint16(6),t.getUint16(8),t.getUint16(10)])}}},wt={inspect:vt=function(e){for(var t,n,i,r,a,o=0,s=[],l=new ArrayBuffer(e.length),u=new Uint8Array(l),c=0;c<e.length;++c)u[c]=e[c];for(t=new DataView(l);o<e.byteLength;)n=t.getUint32(o),i=_t(e.subarray(o+4,o+8)),r=n>1?o+n:e.byteLength,(a=(Ct[i]||function(e){return{data:e}})(e.subarray(o+8,r))).size=n,a.type=i,s.push(a),o=r;return s},textify:yt=function(e,t){var n;return t=t||0,n=new Array(2*t+1).join(" "),e.map(function(e,i){return n+e.type+"\n"+Object.keys(e).filter(function(e){return"type"!==e&&"boxes"!==e}).map(function(t){var i=n+"  "+t+": ",r=e[t];if(r instanceof Uint8Array||r instanceof Uint32Array){var a=Array.prototype.slice.call(new Uint8Array(r.buffer,r.byteOffset,r.byteLength)).map(function(e){return" "+("00"+e.toString(16)).slice(-2)}).join("").match(/.{1,24}/g);return a?1===a.length?i+"<"+a.join("").slice(1)+">":i+"<\n"+a.map(function(e){return n+"  "+e}).join("\n")+"\n"+n+"  >":i+"<>"}return i+JSON.stringify(r,null,2).split("\n").map(function(e,t){return 0===t?e:n+"  "+e}).join("\n")}).join("\n")+(e.boxes?"\n"+yt(e.boxes,t+1):"")}).join("\n")},parseTfdt:Ct.tfdt,parseHdlr:Ct.hdlr,parseTfhd:Ct.tfhd,parseTrun:Ct.trun,parseSidx:Ct.sidx},kt=Ce,St=xe.CaptionStream,It=function(e,t){for(var n=e,i=0;i<t.length;i++){var r=t[i];if(n<r.size)return r;n-=r.size}return null},Ot={generator:q,probe:z,Transmuxer:bt.Transmuxer,AudioSegmentStream:bt.AudioSegmentStream,VideoSegmentStream:bt.VideoSegmentStream,CaptionParser:function(){var e,t,n,i,r,a=!1;this.isInitialized=function(){return a},this.init=function(){e=new St,a=!0,e.on("data",function(e){e.startTime=e.startPts/i,e.endTime=e.endPts/i,r.captions.push(e),r.captionStreams[e.stream]=!0})},this.isNewInit=function(e,t){return!(e&&0===e.length||t&&"object"==typeof t&&0===Object.keys(t).length||n===e[0]&&i===t[n])},this.parse=function(e,a,o){var s;if(!this.isInitialized())return null;if(!a||!o)return null;if(this.isNewInit(a,o))n=a[0],i=o[n];else if(!n||!i)return t.push(e),null;for(;t.length>0;){var l=t.shift();this.parse(l,a,o)}return null!==(s=function(e,t,n){return t?{seiNals:function(e,t){var n=z.findBox(e,["moof","traf"]),i={},r=[];return z.findBox(e,["mdat"]).forEach(function(e,t){var i=n[t];r.push({mdat:e,traf:i})}),r.forEach(function(e){var n,r,a=e.mdat,o=e.traf,s=z.findBox(o,["tfhd"]),l=wt.parseTfhd(s[0]),u=l.trackId,c=z.findBox(o,["tfdt"]),d=c.length>0?wt.parseTfdt(c[0]).baseMediaDecodeTime:0,h=z.findBox(o,["trun"]);t===u&&h.length>0&&(n=function(e,t,n){var i=d,r=n.defaultSampleDuration||0,a=n.defaultSampleSize||0,o=n.trackId,s=[];return e.forEach(function(e){var t=wt.parseTrun(e).samples;t.forEach(function(e){void 0===e.duration&&(e.duration=r),void 0===e.size&&(e.size=a),e.trackId=o,e.dts=i,void 0===e.compositionTimeOffset&&(e.compositionTimeOffset=0),e.pts=i+e.compositionTimeOffset,i+=e.duration}),s=s.concat(t)}),s}(h,0,l),r=function(e,t,n){var i,r,a,o,s=new DataView(e.buffer,e.byteOffset,e.byteLength),l=[];for(r=0;r+4<e.length;r+=a)if(a=s.getUint32(r),r+=4,!(a<=0))switch(31&e[r]){case 6:var u=e.subarray(r+1,r+1+a),c=It(r,t);i={nalUnitType:"sei_rbsp",size:a,data:u,escapedRBSP:kt(u),trackId:n},c?(i.pts=c.pts,i.dts=c.dts,o=c):(i.pts=o.pts,i.dts=o.dts),l.push(i)}return l}(a,n,u),i[u]||(i[u]=[]),i[u]=i[u].concat(r))}),i}(e,t)[t],timescale:n}:null}(e,n,i))&&s.seiNals?(this.pushNals(s.seiNals),this.flushStream(),r):null},this.pushNals=function(t){if(!this.isInitialized()||!t||0===t.length)return null;t.forEach(function(t){e.push(t)})},this.flushStream=function(){if(!this.isInitialized())return null;e.flush()},this.clearParsedCaptions=function(){r.captions=[],r.captionStreams={}},this.resetCaptionStream=function(){if(!this.isInitialized())return null;e.reset()},this.clearAllCaptions=function(){this.clearParsedCaptions(),this.resetCaptionStream()},this.reset=function(){t=[],n=null,i=null,r?this.clearParsedCaptions():r={captions:[],captionStreams:{}},this.resetCaptionStream()},this.reset()}},Dt=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},Rt=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),xt=function(){function e(t,n){Dt(this,e),this.options=n||{},this.self=t,this.init()}return Rt(e,[{key:"init",value:function(){var e,t;this.transmuxer&&this.transmuxer.dispose(),this.transmuxer=new Ot.Transmuxer(this.options),e=this.self,(t=this.transmuxer).on("data",function(t){var n=t.initSegment;t.initSegment={data:n.buffer,byteOffset:n.byteOffset,byteLength:n.byteLength};var i=t.data;t.data=i.buffer,e.postMessage({action:"data",segment:t,byteOffset:i.byteOffset,byteLength:i.byteLength},[t.data])}),t.captionStream&&t.captionStream.on("data",function(t){e.postMessage({action:"caption",data:t})}),t.on("done",function(t){e.postMessage({action:"done"})}),t.on("gopInfo",function(t){e.postMessage({action:"gopInfo",gopInfo:t})}),t.on("videoSegmentTimingInfo",function(t){e.postMessage({action:"videoSegmentTimingInfo",videoSegmentTimingInfo:t})})}},{key:"push",value:function(e){var t=new Uint8Array(e.data,e.byteOffset,e.byteLength);this.transmuxer.push(t)}},{key:"reset",value:function(){this.init()}},{key:"setTimestampOffset",value:function(e){var t=e.timestampOffset||0;this.transmuxer.setBaseMediaDecodeTime(Math.round(9e4*t))}},{key:"setAudioAppendStart",value:function(e){this.transmuxer.setAudioAppendStart(Math.ceil(9e4*e.appendStart))}},{key:"flush",value:function(e){this.transmuxer.flush()}},{key:"resetCaptions",value:function(){this.transmuxer.resetCaptions()}},{key:"alignGopsWith",value:function(e){this.transmuxer.alignGopsWith(e.gopsToAlignWith.slice())}}]),e}();new function(e){e.onmessage=function(t){"init"===t.data.action&&t.data.options?this.messageHandlers=new xt(e,t.data.options):(this.messageHandlers||(this.messageHandlers=new xt(e)),t.data&&t.data.action&&"init"!==t.data.action&&this.messageHandlers[t.data.action]&&this.messageHandlers[t.data.action](t.data))}}(n)}()}),ad={videoCodec:"avc1",videoObjectTypeIndicator:".4d400d",audioProfile:"2"},od=function(e){return e.map(function(e){return e.replace(/avc1\.(\d+)\.(\d+)/i,function(e,t,n){return"avc1."+("00"+Number(t).toString(16)).slice(-2)+"00"+("00"+Number(n).toString(16)).slice(-2)})})},sd=function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",n={codecCount:0};return n.codecCount=t.split(",").length,n.codecCount=n.codecCount||2,(e=/(^|\s|,)+(avc[13])([^ ,]*)/i.exec(t))&&(n.videoCodec=e[2],n.videoObjectTypeIndicator=e[3]),n.audioProfile=/(^|\s|,)+mp4a.[0-9A-Fa-f]+\.([0-9A-Fa-f]+)/i.exec(t),n.audioProfile=n.audioProfile&&n.audioProfile[2],n},ld=function(e,t,n){return e+"/"+t+'; codecs="'+n.filter(function(e){return!!e}).join(", ")+'"'},ud=function(e){return/mp4a\.\d+.\d+/i.test(e)},cd=function(e){return/avc1\.[\da-f]+/i.test(e)},dd=function(e,t,n){var i=null,r=null,a=0,o=[],s=[];if(!e&&!t)return to.createTimeRange();if(!e)return t.buffered;if(!t)return e.buffered;if(n)return e.buffered;if(0===e.buffered.length&&0===t.buffered.length)return to.createTimeRange();for(var l=e.buffered,u=t.buffered,c=l.length;c--;)o.push({time:l.start(c),type:"start"}),o.push({time:l.end(c),type:"end"});for(c=u.length;c--;)o.push({time:u.start(c),type:"start"}),o.push({time:u.end(c),type:"end"});for(o.sort(function(e,t){return e.time-t.time}),c=0;c<o.length;c++)"start"===o[c].type?2==++a&&(i=o[c].time):"end"===o[c].type&&1==--a&&(r=o[c].time),null!==i&&null!==r&&(s.push([i,r]),i=null,r=null);return to.createTimeRanges(s)},hd=function(e){function t(e,n){Qu(this,t);var i=ec(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,to.EventTarget));i.timestampOffset_=0,i.pendingBuffers_=[],i.bufferUpdating_=!1,i.mediaSource_=e,i.codecs_=n,i.audioCodec_=null,i.videoCodec_=null,i.audioDisabled_=!1,i.appendAudioInitSegment_=!0,i.gopBuffer_=[],i.timeMapping_=0,i.safeAppend_=to.browser.IE_VERSION>=11;var r={remux:!1,alignGopsAtEnd:i.safeAppend_};return i.codecs_.forEach(function(e){ud(e)?i.audioCodec_=e:cd(e)&&(i.videoCodec_=e)}),i.transmuxer_=new rd,i.transmuxer_.postMessage({action:"init",options:r}),i.transmuxer_.onmessage=function(e){return"data"===e.data.action?i.data_(e):"done"===e.data.action?i.done_(e):"gopInfo"===e.data.action?i.appendGopInfo_(e):"videoSegmentTimingInfo"===e.data.action?i.videoSegmentTimingInfo_(e.data.videoSegmentTimingInfo):void 0},Object.defineProperty(i,"timestampOffset",{get:function(){return this.timestampOffset_},set:function(e){"number"==typeof e&&e>=0&&(this.timestampOffset_=e,this.appendAudioInitSegment_=!0,this.gopBuffer_.length=0,this.timeMapping_=0,this.transmuxer_.postMessage({action:"setTimestampOffset",timestampOffset:e}))}}),Object.defineProperty(i,"appendWindowStart",{get:function(){return(this.videoBuffer_||this.audioBuffer_).appendWindowStart},set:function(e){this.videoBuffer_&&(this.videoBuffer_.appendWindowStart=e),this.audioBuffer_&&(this.audioBuffer_.appendWindowStart=e)}}),Object.defineProperty(i,"updating",{get:function(){return!!(this.bufferUpdating_||!this.audioDisabled_&&this.audioBuffer_&&this.audioBuffer_.updating||this.videoBuffer_&&this.videoBuffer_.updating)}}),Object.defineProperty(i,"buffered",{get:function(){return dd(this.videoBuffer_,this.audioBuffer_,this.audioDisabled_)}}),i}return Zu(t,e),Ju(t,[{key:"data_",value:function(e){var t=e.data.segment;t.data=new Uint8Array(t.data,e.data.byteOffset,e.data.byteLength),t.initSegment=new Uint8Array(t.initSegment.data,t.initSegment.byteOffset,t.initSegment.byteLength),function(e,t,n){var i=t.player_;if(n.captions&&n.captions.length)for(var r in e.inbandTextTracks_||(e.inbandTextTracks_={}),n.captionStreams)if(!e.inbandTextTracks_[r]){i.tech_.trigger({type:"usage",name:"hls-608"});var a=i.textTracks().getTrackById(r);e.inbandTextTracks_[r]=a||i.addRemoteTextTrack({kind:"captions",id:r,label:r},!1).track}n.metadata&&n.metadata.length&&!e.metadataTrack_&&(e.metadataTrack_=i.addRemoteTextTrack({kind:"metadata",label:"Timed Metadata"},!1).track,e.metadataTrack_.inBandMetadataTrackDispatchType=n.metadata.dispatchType)}(this,this.mediaSource_,t),this.pendingBuffers_.push(t)}},{key:"done_",value:function(e){"closed"!==this.mediaSource_.readyState?this.processPendingSegments_():this.pendingBuffers_.length=0}},{key:"videoSegmentTimingInfo_",value:function(e){var t={start:{decode:e.start.dts/9e4,presentation:e.start.pts/9e4},end:{decode:e.end.dts/9e4,presentation:e.end.pts/9e4},baseMediaDecodeTime:e.baseMediaDecodeTime/9e4};e.prependedContentDuration&&(t.prependedContentDuration=e.prependedContentDuration/9e4),this.trigger({type:"videoSegmentTimingInfo",videoSegmentTimingInfo:t})}},{key:"createRealSourceBuffers_",value:function(){var e=this,t=["audio","video"];t.forEach(function(n){if(e[n+"Codec_"]&&!e[n+"Buffer_"]){var i=null;if(e.mediaSource_[n+"Buffer_"])(i=e.mediaSource_[n+"Buffer_"]).updating=!1;else{var r=n+'/mp4;codecs="'+e[n+"Codec_"]+'"';i=function(e,t){var n=e.addSourceBuffer(t),i=Object.create(null);i.updating=!1,i.realBuffer_=n;var r=function(e){"function"==typeof n[e]?i[e]=function(){return n[e].apply(n,arguments)}:void 0===i[e]&&Object.defineProperty(i,e,{get:function(){return n[e]},set:function(t){return n[e]=t}})};for(var a in n)r(a);return i}(e.mediaSource_.nativeMediaSource_,r),e.mediaSource_[n+"Buffer_"]=i}e[n+"Buffer_"]=i,["update","updatestart","updateend"].forEach(function(r){i.addEventListener(r,function(){if("audio"!==n||!e.audioDisabled_)return"updateend"===r&&(e[n+"Buffer_"].updating=!1),t.every(function(t){return!("audio"!==t||!e.audioDisabled_)||n===t||!e[t+"Buffer_"]||!e[t+"Buffer_"].updating})?e.trigger(r):void 0})})}})}},{key:"appendBuffer",value:function(e){if(this.bufferUpdating_=!0,this.audioBuffer_&&this.audioBuffer_.buffered.length){var t=this.audioBuffer_.buffered;this.transmuxer_.postMessage({action:"setAudioAppendStart",appendStart:t.end(t.length-1)})}this.videoBuffer_&&this.transmuxer_.postMessage({action:"alignGopsWith",gopsToAlignWith:function(e,t,n){if(void 0===t||null===t||!e.length)return[];var i=Math.ceil(9e4*(t-n+3)),r=void 0;for(r=0;r<e.length&&!(e[r].pts>i);r++);return e.slice(r)}(this.gopBuffer_,this.mediaSource_.player_?this.mediaSource_.player_.currentTime():null,this.timeMapping_)}),this.transmuxer_.postMessage({action:"push",data:e.buffer,byteOffset:e.byteOffset,byteLength:e.byteLength},[e.buffer]),this.transmuxer_.postMessage({action:"flush"})}},{key:"appendGopInfo_",value:function(e){this.gopBuffer_=function(e,t,n){if(!t.length)return e;if(n)return t.slice();for(var i=t[0].pts,r=0;r<e.length&&!(e[r].pts>=i);r++);return e.slice(0,r).concat(t)}(this.gopBuffer_,e.data.gopInfo,this.safeAppend_)}},{key:"remove",value:function(e,t){if(this.videoBuffer_&&(this.videoBuffer_.updating=!0,this.videoBuffer_.remove(e,t),this.gopBuffer_=function(e,t,n,i){for(var r=Math.ceil(9e4*(t-i)),a=Math.ceil(9e4*(n-i)),o=e.slice(),s=e.length;s--&&!(e[s].pts<=a););if(-1===s)return o;for(var l=s+1;l--&&!(e[l].pts<=r););return l=Math.max(l,0),o.splice(l,s-l+1),o}(this.gopBuffer_,e,t,this.timeMapping_)),!this.audioDisabled_&&this.audioBuffer_&&(this.audioBuffer_.updating=!0,this.audioBuffer_.remove(e,t)),qc(e,t,this.metadataTrack_),this.inbandTextTracks_)for(var n in this.inbandTextTracks_)qc(e,t,this.inbandTextTracks_[n])}},{key:"processPendingSegments_",value:function(){var e={video:{segments:[],bytes:0},audio:{segments:[],bytes:0},captions:[],metadata:[]};e=this.pendingBuffers_.reduce(function(e,t){var n=t.type,i=t.data,r=t.initSegment;return e[n].segments.push(i),e[n].bytes+=i.byteLength,e[n].initSegment=r,t.captions&&(e.captions=e.captions.concat(t.captions)),t.info&&(e[n].info=t.info),t.metadata&&(e.metadata=e.metadata.concat(t.metadata)),e},e),this.videoBuffer_||this.audioBuffer_||(0===e.video.bytes&&(this.videoCodec_=null),0===e.audio.bytes&&(this.audioCodec_=null),this.createRealSourceBuffers_()),e.audio.info&&this.mediaSource_.trigger({type:"audioinfo",info:e.audio.info}),e.video.info&&this.mediaSource_.trigger({type:"videoinfo",info:e.video.info}),this.appendAudioInitSegment_&&(!this.audioDisabled_&&this.audioBuffer_&&(e.audio.segments.unshift(e.audio.initSegment),e.audio.bytes+=e.audio.initSegment.byteLength),this.appendAudioInitSegment_=!1);var t=!1;this.videoBuffer_&&e.video.bytes?(e.video.segments.unshift(e.video.initSegment),e.video.bytes+=e.video.initSegment.byteLength,this.concatAndAppendSegments_(e.video,this.videoBuffer_)):!this.videoBuffer_||!this.audioDisabled_&&this.audioBuffer_||(t=!0),zc(this,e.captions,e.metadata),!this.audioDisabled_&&this.audioBuffer_&&this.concatAndAppendSegments_(e.audio,this.audioBuffer_),this.pendingBuffers_.length=0,t&&this.trigger("updateend"),this.bufferUpdating_=!1}},{key:"concatAndAppendSegments_",value:function(e,t){var n=0,i=void 0;if(e.bytes){i=new Uint8Array(e.bytes),e.segments.forEach(function(e){i.set(e,n),n+=e.byteLength});try{t.updating=!0,t.appendBuffer(i)}catch(e){this.mediaSource_.player_&&this.mediaSource_.player_.error({code:-3,type:"APPEND_BUFFER_ERR",message:e.message,originalError:e})}}}},{key:"abort",value:function(){this.videoBuffer_&&this.videoBuffer_.abort(),!this.audioDisabled_&&this.audioBuffer_&&this.audioBuffer_.abort(),this.transmuxer_&&this.transmuxer_.postMessage({action:"reset"}),this.pendingBuffers_.length=0,this.bufferUpdating_=!1}}]),t}(to.EventTarget),pd=function(n){function i(){Qu(this,i);var n=ec(this,(i.__proto__||Object.getPrototypeOf(i)).call(this)),r=void 0;for(r in n.nativeMediaSource_=new e.MediaSource,n.nativeMediaSource_)r in i.prototype||"function"!=typeof n.nativeMediaSource_[r]||(n[r]=n.nativeMediaSource_[r].bind(n.nativeMediaSource_));return n.duration_=NaN,Object.defineProperty(n,"duration",{get:function(){return this.duration_===1/0?this.duration_:this.nativeMediaSource_.duration},set:function(e){this.duration_=e,e===1/0||(this.nativeMediaSource_.duration=e)}}),Object.defineProperty(n,"seekable",{get:function(){return this.duration_===1/0?to.createTimeRanges([[0,this.nativeMediaSource_.duration]]):this.nativeMediaSource_.seekable}}),Object.defineProperty(n,"readyState",{get:function(){return this.nativeMediaSource_.readyState}}),Object.defineProperty(n,"activeSourceBuffers",{get:function(){return this.activeSourceBuffers_}}),n.sourceBuffers=[],n.activeSourceBuffers_=[],n.updateActiveSourceBuffers_=function(){if(n.activeSourceBuffers_.length=0,1===n.sourceBuffers.length){var e=n.sourceBuffers[0];return e.appendAudioInitSegment_=!0,e.audioDisabled_=!e.audioCodec_,void n.activeSourceBuffers_.push(e)}for(var t=!1,i=!0,r=0;r<n.player_.audioTracks().length;r++){var a=n.player_.audioTracks()[r];if(a.enabled&&"main"!==a.kind){t=!0,i=!1;break}}n.sourceBuffers.forEach(function(e,r){if(e.appendAudioInitSegment_=!0,e.videoCodec_&&e.audioCodec_)e.audioDisabled_=t;else if(e.videoCodec_&&!e.audioCodec_)e.audioDisabled_=!0,i=!1;else if(!e.videoCodec_&&e.audioCodec_&&(e.audioDisabled_=r?i:!i,e.audioDisabled_))return;n.activeSourceBuffers_.push(e)})},n.onPlayerMediachange_=function(){n.sourceBuffers.forEach(function(e){e.appendAudioInitSegment_=!0})},n.onHlsReset_=function(){n.sourceBuffers.forEach(function(e){e.transmuxer_&&e.transmuxer_.postMessage({action:"resetCaptions"})})},n.onHlsSegmentTimeMapping_=function(e){n.sourceBuffers.forEach(function(t){return t.timeMapping_=e.mapping})},["sourceopen","sourceclose","sourceended"].forEach(function(e){this.nativeMediaSource_.addEventListener(e,this.trigger.bind(this))},n),n.on("sourceopen",function(e){var i=t.querySelector('[src="'+n.url_+'"]');i&&(n.player_=to(i.parentNode),n.player_&&(n.player_.tech_.on("hls-reset",n.onHlsReset_),n.player_.tech_.on("hls-segment-time-mapping",n.onHlsSegmentTimeMapping_),n.player_.audioTracks&&n.player_.audioTracks()&&(n.player_.audioTracks().on("change",n.updateActiveSourceBuffers_),n.player_.audioTracks().on("addtrack",n.updateActiveSourceBuffers_),n.player_.audioTracks().on("removetrack",n.updateActiveSourceBuffers_)),n.player_.on("mediachange",n.onPlayerMediachange_)))}),n.on("sourceended",function(e){for(var t=Hc(n.duration),i=0;i<n.sourceBuffers.length;i++){var r=n.sourceBuffers[i],a=r.metadataTrack_&&r.metadataTrack_.cues;a&&a.length&&(a[a.length-1].endTime=t)}}),n.on("sourceclose",function(e){this.sourceBuffers.forEach(function(e){e.transmuxer_&&e.transmuxer_.terminate()}),this.sourceBuffers.length=0,this.player_&&(this.player_.audioTracks&&this.player_.audioTracks()&&(this.player_.audioTracks().off("change",this.updateActiveSourceBuffers_),this.player_.audioTracks().off("addtrack",this.updateActiveSourceBuffers_),this.player_.audioTracks().off("removetrack",this.updateActiveSourceBuffers_)),this.player_.el_&&this.player_.off("mediachange",this.onPlayerMediachange_),this.player_.tech_&&this.player_.tech_.el_&&(this.player_.tech_.off("hls-reset",this.onHlsReset_),this.player_.tech_.off("hls-segment-time-mapping",this.onHlsSegmentTimeMapping_)))}),n}return Zu(i,n),Ju(i,[{key:"addSeekableRange_",value:function(e,t){var n=void 0;if(this.duration!==1/0)throw(n=new Error("MediaSource.addSeekableRange() can only be invoked when the duration is Infinity")).name="InvalidStateError",n.code=11,n;(t>this.nativeMediaSource_.duration||isNaN(this.nativeMediaSource_.duration))&&(this.nativeMediaSource_.duration=t)}},{key:"addSourceBuffer",value:function(e){var t=void 0,n=function(e){var t={type:"",parameters:{}},n=e.trim().split(";");return t.type=n.shift().trim(),n.forEach(function(e){var n=e.trim().split("=");if(n.length>1){var i=n[0].replace(/"/g,"").trim(),r=n[1].replace(/"/g,"").trim();t.parameters[i]=r}}),t}(e);if(/^(video|audio)\/mp2t$/i.test(n.type)){var i=[];n.parameters&&n.parameters.codecs&&(i=n.parameters.codecs.split(","),i=(i=od(i)).filter(function(e){return ud(e)||cd(e)})),0===i.length&&(i=["avc1.4d400d","mp4a.40.2"]),t=new hd(this,i),0!==this.sourceBuffers.length&&(this.sourceBuffers[0].createRealSourceBuffers_(),t.createRealSourceBuffers_(),this.sourceBuffers[0].audioDisabled_=!0)}else t=this.nativeMediaSource_.addSourceBuffer(e);return this.sourceBuffers.push(t),t}}]),i}(to.EventTarget),fd=0;to.mediaSources={};var gd=function(e,t){var n=to.mediaSources[e];if(!n)throw new Error("Media Source not found (Video.js)");n.trigger({type:"sourceopen",swfId:t})},md=function(){return!!e.MediaSource&&!!e.MediaSource.isTypeSupported&&e.MediaSource.isTypeSupported('video/mp4;codecs="avc1.4d400d,mp4a.40.2"')},vd=function(){if(this.MediaSource={open:gd,supportsNativeMediaSources:md},md())return new pd;throw new Error("Cannot use create a virtual MediaSource for this video")};vd.open=gd,vd.supportsNativeMediaSources=md;var yd={createObjectURL:function(t){var n=void 0;return t instanceof pd?(n=e.URL.createObjectURL(t.nativeMediaSource_),t.url_=n,n):t instanceof pd?(n="blob:vjs-media-source/"+fd,fd++,to.mediaSources[n]=t,n):(n=e.URL.createObjectURL(t),t.url_=n,n)}};to.MediaSource=vd,to.URL=yd;var bd=to.EventTarget,_d=to.mergeOptions,Td=function(e,t){for(var n=void 0,i=_d(e,{duration:t.duration,minimumUpdatePeriod:t.minimumUpdatePeriod}),r=0;r<t.playlists.length;r++){var a=oc(i,t.playlists[r]);a?i=a:n=!0}return ac(t,function(e,t,r,a){if(e.playlists&&e.playlists.length){var o=e.playlists[0].uri,s=oc(i,e.playlists[0]);s&&((i=s).mediaGroups[t][r][a].playlists[0]=i.playlists[o],n=!1)}}),n?null:i},Ed=function(e){var t=e.byterange.offset+e.byterange.length-1;return e.uri+"-"+e.byterange.offset+"-"+t},Cd=function(e,t){var n,i,r={};for(var a in e){var o=e[a].sidx;if(o){var s=Ed(o);if(!t[s])break;n=t[s].sidxInfo,i=o,(Boolean(!n.map&&!i.map)||Boolean(n.map&&i.map&&n.map.byterange.offset===i.map.byterange.offset&&n.map.byterange.length===i.map.byterange.length))&&n.uri===i.uri&&n.byterange.offset===i.byterange.offset&&n.byterange.length===i.byterange.length&&(r[s]=t[s])}}return r},wd=function(e,t,n,i,r){var a={uri:Yu(i.handleManifestRedirects,e.resolvedUri),byterange:e.byterange,playlist:t};return n(to.mergeOptions(a,{responseType:"arraybuffer",headers:Rc(a)}),r)},kd=function(t){function n(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=arguments[3];Qu(this,n);var a=ec(this,(n.__proto__||Object.getPrototypeOf(n)).call(this)),o=i.withCredentials,s=void 0!==o&&o,l=i.handleManifestRedirects,u=void 0!==l&&l;if(a.hls_=t,a.withCredentials=s,a.handleManifestRedirects=u,!e)throw new Error("A non-empty playlist URL or playlist is required");return a.on("minimumUpdatePeriod",function(){a.refreshXml_()}),a.on("mediaupdatetimeout",function(){a.refreshMedia_(a.media().uri)}),a.state="HAVE_NOTHING",a.loadedPlaylists_={},"string"==typeof e?(a.srcUrl=e,a.sidxMapping_={},ec(a)):(a.setupChildLoader(r,e),a)}return Zu(n,bd),Ju(n,[{key:"setupChildLoader",value:function(e,t){this.masterPlaylistLoader_=e,this.childPlaylist_=t}},{key:"dispose",value:function(){this.stopRequest(),this.loadedPlaylists_={},e.clearTimeout(this.minimumUpdatePeriodTimeout_),e.clearTimeout(this.mediaRequest_),e.clearTimeout(this.mediaUpdateTimeout)}},{key:"hasPendingRequest",value:function(){return this.request||this.mediaRequest_}},{key:"stopRequest",value:function(){if(this.request){var e=this.request;this.request=null,e.onreadystatechange=null,e.abort()}}},{key:"sidxRequestFinished_",value:function(e,t,n,i){var r=this;return function(a,o){if(r.request){if(r.request=null,a)return r.error={status:o.status,message:"DASH playlist request error at URL: "+e.uri,response:o.response,code:2},n&&(r.state=n),r.trigger("error"),i(t,null);var s=new Uint8Array(o.response),l=Ys.parseSidx(s.subarray(8));return i(t,l)}}}},{key:"media",value:function(t){var n=this;if(!t)return this.media_;if("HAVE_NOTHING"===this.state)throw new Error("Cannot switch media playlist from "+this.state);var i=this.state;if("string"==typeof t){if(!this.master.playlists[t])throw new Error("Unknown playlist URI: "+t);t=this.master.playlists[t]}var r=!this.media_||t.uri!==this.media_.uri;if(r&&this.loadedPlaylists_[t.uri]&&this.loadedPlaylists_[t.uri].endList)return this.state="HAVE_METADATA",this.media_=t,void(r&&(this.trigger("mediachanging"),this.trigger("mediachange")));if(r)if(this.media_&&this.trigger("mediachanging"),t.sidx){var a=void 0,o=void 0;this.masterPlaylistLoader_?(a=this.masterPlaylistLoader_.master,o=this.masterPlaylistLoader_.sidxMapping_):(a=this.master,o=this.sidxMapping_);var s=Ed(t.sidx);o[s]={sidxInfo:t.sidx},this.request=wd(t.sidx,t,this.hls_.xhr,{handleManifestRedirects:this.handleManifestRedirects},this.sidxRequestFinished_(t,a,i,function(e,r){if(!e||!r)throw new Error("failed to request sidx");o[s].sidx=r,n.haveMetadata({startingState:i,playlist:e.playlists[t.uri]})}))}else this.mediaRequest_=e.setTimeout(this.haveMetadata.bind(this,{startingState:i,playlist:t}),0)}},{key:"haveMetadata",value:function(e){var t=e.startingState,n=e.playlist;this.state="HAVE_METADATA",this.loadedPlaylists_[n.uri]=n,this.mediaRequest_=null,this.refreshMedia_(n.uri),"HAVE_MASTER"===t?this.trigger("loadedmetadata"):this.trigger("mediachange")}},{key:"pause",value:function(){this.stopRequest(),e.clearTimeout(this.mediaUpdateTimeout),e.clearTimeout(this.minimumUpdatePeriodTimeout_),"HAVE_NOTHING"===this.state&&(this.started=!1)}},{key:"load",value:function(t){var n=this;e.clearTimeout(this.mediaUpdateTimeout),e.clearTimeout(this.minimumUpdatePeriodTimeout_);var i=this.media();if(t){var r=i?i.targetDuration/2*1e3:5e3;this.mediaUpdateTimeout=e.setTimeout(function(){return n.load()},r)}else this.started?this.trigger("loadedplaylist"):this.start()}},{key:"parseMasterXml",value:function(){var e=Vs(this.masterXml_,{manifestUri:this.srcUrl,clientOffset:this.clientOffset_,sidxMapping:this.sidxMapping_});e.uri=this.srcUrl;for(var t=0;t<e.playlists.length;t++){var n="placeholder-uri-"+t;e.playlists[t].uri=n,e.playlists[n]=e.playlists[t]}return ac(e,function(t,n,i,r){if(t.playlists&&t.playlists.length){var a="placeholder-uri-"+n+"-"+i+"-"+r;t.playlists[0].uri=a,e.playlists[a]=t.playlists[0]}}),sc(e),lc(e),e}},{key:"start",value:function(){var t=this;this.started=!0,this.masterPlaylistLoader_?this.mediaRequest_=e.setTimeout(this.haveMaster_.bind(this),0):this.request=this.hls_.xhr({uri:this.srcUrl,withCredentials:this.withCredentials},function(e,n){if(t.request){if(t.request=null,e)return t.error={status:n.status,message:"DASH playlist request error at URL: "+t.srcUrl,responseText:n.responseText,code:2},"HAVE_NOTHING"===t.state&&(t.started=!1),t.trigger("error");t.masterXml_=n.responseText,n.responseHeaders&&n.responseHeaders.date?t.masterLoaded_=Date.parse(n.responseHeaders.date):t.masterLoaded_=Date.now(),t.srcUrl=Yu(t.handleManifestRedirects,t.srcUrl,n),t.syncClientServerClock_(t.onClientServerClockSync_.bind(t))}})}},{key:"syncClientServerClock_",value:function(e){var t=this,n=function(e){return function(e){var t=As(e,"UTCTiming")[0];if(!t)return null;var n=Ms(t);switch(n.schemeIdUri){case"urn:mpeg:dash:utc:http-head:2014":case"urn:mpeg:dash:utc:http-head:2012":n.method="HEAD";break;case"urn:mpeg:dash:utc:http-xsdate:2014":case"urn:mpeg:dash:utc:http-iso:2014":case"urn:mpeg:dash:utc:http-xsdate:2012":case"urn:mpeg:dash:utc:http-iso:2012":n.method="GET";break;case"urn:mpeg:dash:utc:direct:2014":case"urn:mpeg:dash:utc:direct:2012":n.method="DIRECT",n.value=Date.parse(n.value);break;case"urn:mpeg:dash:utc:http-ntp:2014":case"urn:mpeg:dash:utc:ntp:2014":case"urn:mpeg:dash:utc:sntp:2014":default:throw new Error(fs)}return n}(Us(e))}(this.masterXml_);return null===n?(this.clientOffset_=this.masterLoaded_-Date.now(),e()):"DIRECT"===n.method?(this.clientOffset_=n.value-Date.now(),e()):void(this.request=this.hls_.xhr({uri:Xu(this.srcUrl,n.value),method:n.method,withCredentials:this.withCredentials},function(i,r){if(t.request){if(i)return t.clientOffset_=t.masterLoaded_-Date.now(),e();var a;a="HEAD"===n.method?r.responseHeaders&&r.responseHeaders.date?Date.parse(r.responseHeaders.date):t.masterLoaded_:Date.parse(r.responseText),t.clientOffset_=a-Date.now(),e()}}))}},{key:"haveMaster_",value:function(){this.state="HAVE_MASTER",this.mediaRequest_=null,this.masterPlaylistLoader_?this.media_||this.media(this.childPlaylist_):(this.master=this.parseMasterXml(),this.trigger("loadedplaylist"))}},{key:"onClientServerClockSync_",value:function(){var t=this;this.haveMaster_(),this.hasPendingRequest()||this.media_||this.media(this.master.playlists[0]),this.master&&this.master.minimumUpdatePeriod&&(this.minimumUpdatePeriodTimeout_=e.setTimeout(function(){t.trigger("minimumUpdatePeriod")},this.master.minimumUpdatePeriod))}},{key:"refreshXml_",value:function(){var t=this;this.request=this.hls_.xhr({uri:this.srcUrl,withCredentials:this.withCredentials},function(n,i){if(t.request){if(t.request=null,n)return t.error={status:i.status,message:"DASH playlist request error at URL: "+t.srcUrl,responseText:i.responseText,code:2},"HAVE_NOTHING"===t.state&&(t.started=!1),t.trigger("error");t.masterXml_=i.responseText,t.sidxMapping_=function(e,t,n,i){var r=Vs(e,{manifestUri:t,clientOffset:n}),a=Cd(r.playlists,i);return ac(r,function(e,t,n,r){if(e.playlists&&e.playlists.length){var o=e.playlists;a=_d(a,Cd(o,i))}}),a}(t.masterXml_,t.srcUrl,t.clientOffset_,t.sidxMapping_);var r=t.parseMasterXml(),a=Td(t.master,r);if(a){var o=Ed(t.media().sidx);if(t.sidxMapping_[o])t.master=a;else{var s=t.media();t.request=wd(s.sidx,s,t.hls_.xhr,{handleManifestRedirects:t.handleManifestRedirects},t.sidxRequestFinished_(s,r,t.state,function(n,i){if(!n||!i)throw new Error("failed to request sidx on minimumUpdatePeriod");t.sidxMapping_[o].sidx=i,t.minimumUpdatePeriodTimeout_=e.setTimeout(function(){t.trigger("minimumUpdatePeriod")},t.master.minimumUpdatePeriod),t.refreshMedia_(t.media().uri)}))}}t.minimumUpdatePeriodTimeout_=e.setTimeout(function(){t.trigger("minimumUpdatePeriod")},t.master.minimumUpdatePeriod)}})}},{key:"refreshMedia_",value:function(t){var n=this;if(!t)throw new Error("refreshMedia_ must take a media uri");var i=void 0,r=void 0;this.masterPlaylistLoader_?(i=this.masterPlaylistLoader_.master,r=this.masterPlaylistLoader_.parseMasterXml()):(i=this.master,r=this.parseMasterXml());var a=Td(i,r);a?(this.masterPlaylistLoader_?this.masterPlaylistLoader_.master=a:this.master=a,this.media_=a.playlists[t]):(this.media_=r.playlists[t],this.trigger("playlistunchanged")),this.media().endList||(this.mediaUpdateTimeout=e.setTimeout(function(){n.trigger("mediaupdatetimeout")},uc(this.media(),!!a))),this.trigger("loadedplaylist")}}]),n}(),Sd=function(e){return to.log.debug?to.log.debug.bind(to,"VHS:",e+" >"):function(){}};function Id(){}var Od=function(){function e(t,n,i,r){Qu(this,e),this.callbacks_=[],this.pendingCallback_=null,this.timestampOffset_=0,this.mediaSource=t,this.processedAppend_=!1,this.type_=i,this.mimeType_=n,this.logger_=Sd("SourceUpdater["+i+"]["+n+"]"),"closed"===t.readyState?t.addEventListener("sourceopen",this.createSourceBuffer_.bind(this,n,r)):this.createSourceBuffer_(n,r)}return Ju(e,[{key:"createSourceBuffer_",value:function(e,t){var n=this;this.sourceBuffer_=this.mediaSource.addSourceBuffer(e),this.logger_("created SourceBuffer"),t&&(t.trigger("sourcebufferadded"),this.mediaSource.sourceBuffers.length<2)?t.on("sourcebufferadded",function(){n.start_()}):this.start_()}},{key:"start_",value:function(){var e=this;this.started_=!0,this.onUpdateendCallback_=function(){var t=e.pendingCallback_;e.pendingCallback_=null,e.sourceBuffer_.removing=!1,e.logger_("buffered ["+Uc(e.buffered())+"]"),t&&t(),e.runCallback_()},this.sourceBuffer_.addEventListener("updateend",this.onUpdateendCallback_),this.runCallback_()}},{key:"abort",value:function(e){var t=this;this.processedAppend_&&this.queueCallback_(function(){t.sourceBuffer_.abort()},e)}},{key:"appendBuffer",value:function(e,t){var n=this;this.processedAppend_=!0,this.queueCallback_(function(){e.videoSegmentTimingInfoCallback&&n.sourceBuffer_.addEventListener("videoSegmentTimingInfo",e.videoSegmentTimingInfoCallback),n.sourceBuffer_.appendBuffer(e.bytes)},function(){e.videoSegmentTimingInfoCallback&&n.sourceBuffer_.removeEventListener("videoSegmentTimingInfo",e.videoSegmentTimingInfoCallback),t()})}},{key:"buffered",value:function(){return this.sourceBuffer_?this.sourceBuffer_.buffered:to.createTimeRanges()}},{key:"remove",value:function(e,t){var n=this,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Id;this.processedAppend_&&this.queueCallback_(function(){n.logger_("remove ["+e+" => "+t+"]"),n.sourceBuffer_.removing=!0,n.sourceBuffer_.remove(e,t)},i)}},{key:"updating",value:function(){return!this.sourceBuffer_||this.sourceBuffer_.updating||!!this.pendingCallback_&&this.pendingCallback_!==Id}},{key:"timestampOffset",value:function(e){var t=this;return void 0!==e&&(this.queueCallback_(function(){t.sourceBuffer_.timestampOffset=e,t.runCallback_()}),this.timestampOffset_=e),this.timestampOffset_}},{key:"queueCallback_",value:function(e,t){this.callbacks_.push([e.bind(this),t]),this.runCallback_()}},{key:"runCallback_",value:function(){var e=void 0;!this.updating()&&this.callbacks_.length&&this.started_&&(e=this.callbacks_.shift(),this.pendingCallback_=e[1],e[0]())}},{key:"dispose",value:function(){var e=this,t=function t(){e.sourceBuffer_&&"open"===e.mediaSource.readyState&&e.sourceBuffer_.abort(),e.sourceBuffer_.removeEventListener("updateend",t)};this.sourceBuffer_.removeEventListener("updateend",this.onUpdateendCallback_),this.sourceBuffer_.removing?this.sourceBuffer_.addEventListener("updateend",t):t()}}]),e}(),Dd={GOAL_BUFFER_LENGTH:30,MAX_GOAL_BUFFER_LENGTH:60,GOAL_BUFFER_LENGTH_RATE:1,INITIAL_BANDWIDTH:4194304,BANDWIDTH_VARIANCE:1.2,BUFFER_LOW_WATER_LINE:0,MAX_BUFFER_LOW_WATER_LINE:30,BUFFER_LOW_WATER_LINE_RATE:1},Rd=2,xd=-101,Ad=-102,Pd=function(e){e.forEach(function(e){e.abort()})},Ld=function(e,t){return t.timedout?{status:t.status,message:"HLS request timed-out at URL: "+t.uri,code:xd,xhr:t}:t.aborted?{status:t.status,message:"HLS request aborted at URL: "+t.uri,code:Ad,xhr:t}:e?{status:t.status,message:"HLS request errored at URL: "+t.uri,code:Rd,xhr:t}:null},Nd=function(e,t,n,i,r,a,o){var s=[],l=function(e,t,n){var i=0,r=!1;return function(a,o){if(!r)return a?(r=!0,Pd(e),n(a,o)):(i+=1)===e.length?(o.endOfAllRequests=Date.now(),o.encryptedBytes?function(e,t,n){var i;e.addEventListener("message",function i(r){if(r.data.source===t.requestId){e.removeEventListener("message",i);var a=r.data.decrypted;return t.bytes=new Uint8Array(a.bytes,a.byteOffset,a.byteLength),n(null,t)}}),i=t.key.bytes.slice?t.key.bytes.slice():new Uint32Array(Array.prototype.slice.call(t.key.bytes)),e.postMessage(Lc({source:t.requestId,encrypted:t.encryptedBytes,key:i,iv:t.key.iv}),[t.encryptedBytes.buffer,i.buffer])}(t,o,n):n(null,o)):void 0}}(s,n,o);if(r.key&&!r.key.bytes){var u=to.mergeOptions(t,{uri:r.key.resolvedUri,responseType:"arraybuffer"}),c=function(e,t){return function(n,i){var r=i.response,a=Ld(n,i);if(a)return t(a,e);if(16!==r.byteLength)return t({status:i.status,message:"Invalid HLS key at URL: "+i.uri,code:Rd,xhr:i},e);var o=new DataView(r);return e.key.bytes=new Uint32Array([o.getUint32(0),o.getUint32(4),o.getUint32(8),o.getUint32(12)]),t(null,e)}}(r,l),d=e(u,c);s.push(d)}if(r.map&&!r.map.bytes){var h=to.mergeOptions(t,{uri:r.map.resolvedUri,responseType:"arraybuffer",headers:Rc(r.map)}),p=function(e,t,n){return function(i,r){var a=r.response,o=Ld(i,r);return o?n(o,e):0===a.byteLength?n({status:r.status,message:"Empty HLS segment content at URL: "+r.uri,code:Rd,xhr:r},e):(e.map.bytes=new Uint8Array(r.response),t&&!t.isInitialized()&&t.init(),e.map.timescales=Hs.timescale(e.map.bytes),e.map.videoTrackIds=Hs.videoTrackIds(e.map.bytes),n(null,e))}}(r,i,l),f=e(h,p);s.push(f)}var g=to.mergeOptions(t,{uri:r.resolvedUri,responseType:"arraybuffer",headers:Rc(r)}),m=function(e,t,n){return function(i,r){var a=r.response,o=Ld(i,r),s=void 0;return o?n(o,e):0===a.byteLength?n({status:r.status,message:"Empty HLS segment content at URL: "+r.uri,code:Rd,xhr:r},e):(e.stats=function(e){return{bandwidth:e.bandwidth,bytesReceived:e.bytesReceived||0,roundTripTime:e.roundTripTime||0}}(r),e.key?e.encryptedBytes=new Uint8Array(r.response):e.bytes=new Uint8Array(r.response),t&&e.map&&e.map.bytes&&(t.isInitialized()||t.init(),(s=t.parse(e.bytes,e.map.videoTrackIds,e.map.timescales))&&s.captions&&(e.captionStreams=s.captionStreams,e.fmp4Captions=s.captions)),n(null,e))}}(r,i,l),v=e(g,m);return v.addEventListener("progress",function(e,t){return function(n){var i,r,a;return e.stats=to.mergeOptions(e.stats,(r=(i=n).target,(a={bandwidth:1/0,bytesReceived:0,roundTripTime:Date.now()-r.requestTime||0}).bytesReceived=i.loaded,a.bandwidth=Math.floor(a.bytesReceived/a.roundTripTime*8*1e3),a)),!e.stats.firstBytesReceivedAt&&e.stats.bytesReceived&&(e.stats.firstBytesReceivedAt=Date.now()),t(n,e)}}(r,a)),s.push(v),function(){return Pd(s)}},Md=function(t,n){var i=void 0;return t&&(i=e.getComputedStyle(t))?i[n]:""},Kd=function(e,t){var n=e.slice();e.sort(function(e,i){var r=t(e,i);return 0===r?n.indexOf(e)-n.indexOf(i):r})},$d=function(t,n){var i=void 0,r=void 0;return t.attributes.BANDWIDTH&&(i=t.attributes.BANDWIDTH),i=i||e.Number.MAX_VALUE,n.attributes.BANDWIDTH&&(r=n.attributes.BANDWIDTH),i-(r=r||e.Number.MAX_VALUE)},jd=function(e){return"number"==typeof e&&isFinite(e)},Bd=function(t){function n(e){Qu(this,n);var t=ec(this,(n.__proto__||Object.getPrototypeOf(n)).call(this));if(!e)throw new TypeError("Initialization settings are required");if("function"!=typeof e.currentTime)throw new TypeError("No currentTime getter specified");if(!e.mediaSource)throw new TypeError("No MediaSource specified");return t.bandwidth=e.bandwidth,t.throughput={rate:0,count:0},t.roundTrip=NaN,t.resetStats_(),t.mediaIndex=null,t.hasPlayed_=e.hasPlayed,t.currentTime_=e.currentTime,t.seekable_=e.seekable,t.seeking_=e.seeking,t.duration_=e.duration,t.mediaSource_=e.mediaSource,t.hls_=e.hls,t.loaderType_=e.loaderType,t.startingMedia_=void 0,t.segmentMetadataTrack_=e.segmentMetadataTrack,t.goalBufferLength_=e.goalBufferLength,t.sourceType_=e.sourceType,t.inbandTextTracks_=e.inbandTextTracks,t.state_="INIT",t.checkBufferTimeout_=null,t.error_=void 0,t.currentTimeline_=-1,t.pendingSegment_=null,t.mimeType_=null,t.sourceUpdater_=null,t.xhrOptions_=null,t.activeInitSegmentId_=null,t.initSegments_={},t.cacheEncryptionKeys_=e.cacheEncryptionKeys,t.keyCache_={},"main"===t.loaderType_?t.captionParser_=new Iu:t.captionParser_=null,t.decrypter_=e.decrypter,t.syncController_=e.syncController,t.syncPoint_={segmentIndex:0,time:0},t.syncController_.on("syncinfoupdate",function(){return t.trigger("syncinfoupdate")}),t.mediaSource_.addEventListener("sourceopen",function(){return t.ended_=!1}),t.fetchAtBuffer_=!1,t.logger_=Sd("SegmentLoader["+t.loaderType_+"]"),Object.defineProperty(t,"state",{get:function(){return this.state_},set:function(e){e!==this.state_&&(this.logger_(this.state_+" -> "+e),this.state_=e)}}),t}return Zu(n,t),Ju(n,[{key:"resetStats_",value:function(){this.mediaBytesTransferred=0,this.mediaRequests=0,this.mediaRequestsAborted=0,this.mediaRequestsTimedout=0,this.mediaRequestsErrored=0,this.mediaTransferDuration=0,this.mediaSecondsLoaded=0}},{key:"dispose",value:function(){this.state="DISPOSED",this.pause(),this.abort_(),this.sourceUpdater_&&this.sourceUpdater_.dispose(),this.resetStats_(),this.captionParser_&&this.captionParser_.reset()}},{key:"abort",value:function(){"WAITING"===this.state?(this.abort_(),this.state="READY",this.paused()||this.monitorBuffer_()):this.pendingSegment_&&(this.pendingSegment_=null)}},{key:"abort_",value:function(){this.pendingSegment_&&this.pendingSegment_.abortRequests(),this.pendingSegment_=null}},{key:"error",value:function(e){return void 0!==e&&(this.error_=e),this.pendingSegment_=null,this.error_}},{key:"endOfStream",value:function(){this.ended_=!0,this.pause(),this.trigger("ended")}},{key:"buffered_",value:function(){return this.sourceUpdater_?this.sourceUpdater_.buffered():to.createTimeRanges()}},{key:"initSegment",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!e)return null;var n=Nc(e),i=this.initSegments_[n];return t&&!i&&e.bytes&&(this.initSegments_[n]=i={resolvedUri:e.resolvedUri,byterange:e.byterange,bytes:e.bytes,timescales:e.timescales,videoTrackIds:e.videoTrackIds}),i||e}},{key:"segmentKey",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!e)return null;var n=Mc(e),i=this.keyCache_[n];this.cacheEncryptionKeys_&&t&&!i&&e.bytes&&(this.keyCache_[n]=i={resolvedUri:e.resolvedUri,bytes:e.bytes});var r={resolvedUri:(i||e).resolvedUri};return i&&(r.bytes=i.bytes),r}},{key:"couldBeginLoading_",value:function(){return this.playlist_&&(this.sourceUpdater_||this.mimeType_&&"INIT"===this.state)&&!this.paused()}},{key:"load",value:function(){if(this.monitorBuffer_(),this.playlist_){if(this.syncController_.setDateTimeMapping(this.playlist_),"INIT"===this.state&&this.couldBeginLoading_())return this.init_();!this.couldBeginLoading_()||"READY"!==this.state&&"INIT"!==this.state||(this.state="READY")}}},{key:"init_",value:function(){return this.state="READY",this.sourceUpdater_=new Od(this.mediaSource_,this.mimeType_,this.loaderType_,this.sourceBufferEmitter_),this.resetEverything(),this.monitorBuffer_()}},{key:"playlist",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(e){var n=this.playlist_,i=this.pendingSegment_;this.playlist_=e,this.xhrOptions_=t,this.hasPlayed_()||(e.syncInfo={mediaSequence:e.mediaSequence,time:0});var r=null;if(n&&(n.id?r=n.id:n.uri&&(r=n.uri)),this.logger_("playlist update ["+r+" => "+(e.id||e.uri)+"]"),this.trigger("syncinfoupdate"),"INIT"===this.state&&this.couldBeginLoading_())return this.init_();if(n&&n.uri===e.uri){var a=e.mediaSequence-n.mediaSequence;this.logger_("live window shift ["+a+"]"),null!==this.mediaIndex&&(this.mediaIndex-=a),i&&(i.mediaIndex-=a,i.mediaIndex>=0&&(i.segment=e.segments[i.mediaIndex])),this.syncController_.saveExpiredSegmentInfo(n,e)}else null!==this.mediaIndex&&this.resyncLoader()}}},{key:"pause",value:function(){this.checkBufferTimeout_&&(e.clearTimeout(this.checkBufferTimeout_),this.checkBufferTimeout_=null)}},{key:"paused",value:function(){return null===this.checkBufferTimeout_}},{key:"mimeType",value:function(e,t){this.mimeType_||(this.mimeType_=e,this.sourceBufferEmitter_=t,"INIT"===this.state&&this.couldBeginLoading_()&&this.init_())}},{key:"resetEverything",value:function(e){this.ended_=!1,this.resetLoader(),this.remove(0,this.duration_(),e),this.captionParser_&&this.captionParser_.clearAllCaptions(),this.trigger("reseteverything")}},{key:"resetLoader",value:function(){this.fetchAtBuffer_=!1,this.resyncLoader()}},{key:"resyncLoader",value:function(){this.mediaIndex=null,this.syncPoint_=null,this.abort()}},{key:"remove",value:function(e,t,n){if(this.sourceUpdater_&&this.sourceUpdater_.remove(e,t,n),qc(e,t,this.segmentMetadataTrack_),this.inbandTextTracks_)for(var i in this.inbandTextTracks_)qc(e,t,this.inbandTextTracks_[i])}},{key:"monitorBuffer_",value:function(){this.checkBufferTimeout_&&e.clearTimeout(this.checkBufferTimeout_),this.checkBufferTimeout_=e.setTimeout(this.monitorBufferTick_.bind(this),1)}},{key:"monitorBufferTick_",value:function(){"READY"===this.state&&this.fillBuffer_(),this.checkBufferTimeout_&&e.clearTimeout(this.checkBufferTimeout_),this.checkBufferTimeout_=e.setTimeout(this.monitorBufferTick_.bind(this),500)}},{key:"fillBuffer_",value:function(){if(!this.sourceUpdater_.updating()){this.syncPoint_||(this.syncPoint_=this.syncController_.getSyncPoint(this.playlist_,this.duration_(),this.currentTimeline_,this.currentTime_()));var e=this.checkBuffer_(this.buffered_(),this.playlist_,this.mediaIndex,this.hasPlayed_(),this.currentTime_(),this.syncPoint_);e&&(this.isEndOfStream_(e.mediaIndex)?this.endOfStream():(e.mediaIndex!==this.playlist_.segments.length-1||"ended"!==this.mediaSource_.readyState||this.seeking_())&&(e.timeline!==this.currentTimeline_&&(this.syncController_.reset(),e.timestampOffset=e.startOfSegment,this.captionParser_&&this.captionParser_.clearAllCaptions()),this.loadSegment_(e)))}}},{key:"isEndOfStream_",value:function(e){return function(e,t,n){if(!e||!t)return!1;var i=n===e.segments.length;return e.endList&&"open"===t.readyState&&i}(arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.playlist_,this.mediaSource_,e)&&!this.sourceUpdater_.updating()}},{key:"checkBuffer_",value:function(e,t,n,i,r,a){var o=0,s=void 0;e.length&&(o=e.end(e.length-1));var l=Math.max(0,o-r);if(!t.segments.length)return null;if(l>=this.goalBufferLength_())return null;if(!i&&l>=1)return null;if(null===a)return n=this.getSyncSegmentCandidate_(t),this.generateSegmentInfo_(t,n,null,!0);if(null!==n){var u=t.segments[n];return s=u&&u.end?u.end:o,this.generateSegmentInfo_(t,n+1,s,!1)}if(this.fetchAtBuffer_){var c=Sc.getMediaInfoForTime(t,o,a.segmentIndex,a.time);n=c.mediaIndex,s=c.startTime}else{var d=Sc.getMediaInfoForTime(t,r,a.segmentIndex,a.time);n=d.mediaIndex,s=d.startTime}return this.generateSegmentInfo_(t,n,s,!1)}},{key:"getSyncSegmentCandidate_",value:function(e){var t=this;if(-1===this.currentTimeline_)return 0;var n=e.segments.map(function(e,t){return{timeline:e.timeline,segmentIndex:t}}).filter(function(e){return e.timeline===t.currentTimeline_});return n.length?n[Math.min(n.length-1,1)].segmentIndex:Math.max(e.segments.length-1,0)}},{key:"generateSegmentInfo_",value:function(e,t,n,i){if(t<0||t>=e.segments.length)return null;var r=e.segments[t];return{requestId:"segment-loader-"+Math.random(),uri:r.resolvedUri,mediaIndex:t,isSyncRequest:i,startOfSegment:n,playlist:e,bytes:null,encryptedBytes:null,timestampOffset:null,timeline:r.timeline,duration:r.duration,segment:r}}},{key:"abortRequestEarly_",value:function(e){if(this.hls_.tech_.paused()||!this.xhrOptions_.timeout||!this.playlist_.attributes.BANDWIDTH)return!1;if(Date.now()-(e.firstBytesReceivedAt||Date.now())<1e3)return!1;var t=this.currentTime_(),n=e.bandwidth,i=this.pendingSegment_.duration,r=Sc.estimateSegmentRequestTime(i,n,this.playlist_,e.bytesReceived),a=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return((e.length?e.end(e.length-1):0)-t)/n}(this.buffered_(),t,this.hls_.tech_.playbackRate())-1;if(r<=a)return!1;var o=function(e){var t=e.currentTime,n=e.bandwidth,i=e.duration,r=e.segmentDuration,a=e.timeUntilRebuffer,o=e.currentTimeline,s=e.syncController,l=e.master.playlists.filter(function(e){return!Sc.isIncompatible(e)}),u=l.filter(Sc.isEnabled);u.length||(u=l.filter(function(e){return!Sc.isDisabled(e)}));var c=u.filter(Sc.hasAttribute.bind(null,"BANDWIDTH")).map(function(e){var l=s.getSyncPoint(e,i,o,t)?1:2;return{playlist:e,rebufferingImpact:Sc.estimateSegmentRequestTime(r,n,e)*l-a}}),d=c.filter(function(e){return e.rebufferingImpact<=0});return Kd(d,function(e,t){return $d(t.playlist,e.playlist)}),d.length?d[0]:(Kd(c,function(e,t){return e.rebufferingImpact-t.rebufferingImpact}),c[0]||null)}({master:this.hls_.playlists.master,currentTime:t,bandwidth:n,duration:this.duration_(),segmentDuration:i,timeUntilRebuffer:a,currentTimeline:this.currentTimeline_,syncController:this.syncController_});if(o){var s=r-a-o.rebufferingImpact,l=.5;return a<=1/30&&(l=1),!(!o.playlist||o.playlist.uri===this.playlist_.uri||s<l||(this.bandwidth=o.playlist.attributes.BANDWIDTH*Dd.BANDWIDTH_VARIANCE+1,this.abort(),this.trigger("earlyabort"),0))}}},{key:"handleProgress_",value:function(e,t){this.pendingSegment_&&t.requestId===this.pendingSegment_.requestId&&!this.abortRequestEarly_(t.stats)&&this.trigger("progress")}},{key:"loadSegment_",value:function(e){this.state="WAITING",this.pendingSegment_=e,this.trimBackBuffer_(e),e.abortRequests=Nd(this.hls_.xhr,this.xhrOptions_,this.decrypter_,this.captionParser_,this.createSimplifiedSegmentObj_(e),this.handleProgress_.bind(this),this.segmentRequestFinished_.bind(this))}},{key:"trimBackBuffer_",value:function(e){var t=function(e,t,n){var i;return i=e.length&&e.start(0)>0&&e.start(0)<t?e.start(0):t-30,Math.min(i,t-n)}(this.seekable_(),this.currentTime_(),this.playlist_.targetDuration||10);t>0&&this.remove(0,t)}},{key:"createSimplifiedSegmentObj_",value:function(e){var t=e.segment,n={resolvedUri:t.resolvedUri,byterange:t.byterange,requestId:e.requestId};if(t.key){var i=t.key.iv||new Uint32Array([0,0,0,e.mediaIndex+e.playlist.mediaSequence]);n.key=this.segmentKey(t.key),n.key.iv=i}return t.map&&(n.map=this.initSegment(t.map)),n}},{key:"segmentRequestFinished_",value:function(e,t){if(this.mediaRequests+=1,t.stats&&(this.mediaBytesTransferred+=t.stats.bytesReceived,this.mediaTransferDuration+=t.stats.roundTripTime),this.pendingSegment_){if(t.requestId===this.pendingSegment_.requestId){if(e)return this.pendingSegment_=null,this.state="READY",e.code===Ad?void(this.mediaRequestsAborted+=1):(this.pause(),e.code===xd?(this.mediaRequestsTimedout+=1,this.bandwidth=1,this.roundTrip=NaN,void this.trigger("bandwidthupdate")):(this.mediaRequestsErrored+=1,this.error(e),void this.trigger("error")));this.bandwidth=t.stats.bandwidth,this.roundTrip=t.stats.roundTripTime,t.map&&(t.map=this.initSegment(t.map,!0)),t.key&&this.segmentKey(t.key,!0),this.processSegmentResponse_(t)}}else this.mediaRequestsAborted+=1}},{key:"processSegmentResponse_",value:function(e){var t=this.pendingSegment_;t.bytes=e.bytes,e.map&&(t.segment.map.bytes=e.map.bytes),t.endOfAllRequests=e.endOfAllRequests,e.fmp4Captions&&(function(e,t,n){for(var i in n)if(!e[i]){t.trigger({type:"usage",name:"hls-608"});var r=t.textTracks().getTrackById(i);e[i]=r||t.addRemoteTextTrack({kind:"captions",id:i,label:i},!1).track}}(this.inbandTextTracks_,this.hls_.tech_,e.captionStreams),function(e){var t=e.inbandTextTracks,n=e.captionArray,i=e.timestampOffset;if(n){var r=window.WebKitDataCue||window.VTTCue;n.forEach(function(e){var n=e.stream,a=e.startTime,o=e.endTime;t[n]&&(a+=i,o+=i,t[n].addCue(new r(a,o,e.text)))})}}({inbandTextTracks:this.inbandTextTracks_,captionArray:e.fmp4Captions,timestampOffset:0}),this.captionParser_&&this.captionParser_.clearParsedCaptions()),this.handleSegment_()}},{key:"handleSegment_",value:function(){var e,t,n,i=this;if(this.pendingSegment_){var r=this.pendingSegment_,a=r.segment,o=this.syncController_.probeSegmentInfo(r);void 0===this.startingMedia_&&o&&(o.containsAudio||o.containsVideo)&&(this.startingMedia_={containsAudio:o.containsAudio,containsVideo:o.containsVideo});var s=(e=this.loaderType_,t=this.startingMedia_,n=o,"main"===e&&t&&n?n.containsAudio||n.containsVideo?t.containsVideo&&!n.containsVideo?"Only audio found in segment when we expected video. We can't switch to audio only from a stream that had video. To get rid of this message, please add codec information to the manifest.":!t.containsVideo&&n.containsVideo?"Video found in segment when we expected only audio. We can't switch to a stream with video from an audio only stream. To get rid of this message, please add codec information to the manifest.":null:"Neither audio nor video found in segment.":null);if(s)return this.error({message:s,blacklistDuration:1/0}),void this.trigger("error");if(r.isSyncRequest)return this.trigger("syncinfoupdate"),this.pendingSegment_=null,void(this.state="READY");null!==r.timestampOffset&&r.timestampOffset!==this.sourceUpdater_.timestampOffset()&&(this.sourceUpdater_.timestampOffset(r.timestampOffset),this.trigger("timestampoffset"));var l=this.syncController_.mappingForTimeline(r.timeline);if(null!==l&&this.trigger({type:"segmenttimemapping",mapping:l}),this.state="APPENDING",a.map){var u=Nc(a.map);if(!this.activeInitSegmentId_||this.activeInitSegmentId_!==u){var c=this.initSegment(a.map);this.sourceUpdater_.appendBuffer({bytes:c.bytes},function(){i.activeInitSegmentId_=u})}}r.byteLength=r.bytes.byteLength,"number"==typeof a.start&&"number"==typeof a.end?this.mediaSecondsLoaded+=a.end-a.start:this.mediaSecondsLoaded+=a.duration,this.logger_(function(e){var t=e.segment,n=t.start,i=t.end,r=e.playlist,a=r.mediaSequence,o=r.id,s=r.segments,l=void 0===s?[]:s,u=e.mediaIndex,c=e.timeline;return["appending ["+u+"] of ["+a+", "+(a+l.length)+"] from playlist ["+o+"]","["+n+" => "+i+"] in timeline ["+c+"]"].join(" ")}(r)),this.sourceUpdater_.appendBuffer({bytes:r.bytes,videoSegmentTimingInfoCallback:this.handleVideoSegmentTimingInfo_.bind(this,r.requestId)},this.handleUpdateEnd_.bind(this))}else this.state="READY"}},{key:"handleVideoSegmentTimingInfo_",value:function(e,t){if(this.pendingSegment_&&e===this.pendingSegment_.requestId){var n=this.pendingSegment_.segment;n.videoTimingInfo||(n.videoTimingInfo={}),n.videoTimingInfo.transmuxerPrependedSeconds=t.videoSegmentTimingInfo.prependedContentDuration||0,n.videoTimingInfo.transmuxedPresentationStart=t.videoSegmentTimingInfo.start.presentation,n.videoTimingInfo.transmuxedPresentationEnd=t.videoSegmentTimingInfo.end.presentation,n.videoTimingInfo.baseMediaDecodeTime=t.videoSegmentTimingInfo.baseMediaDecodeTime}}},{key:"handleUpdateEnd_",value:function(){if(!this.pendingSegment_)return this.state="READY",void(this.paused()||this.monitorBuffer_());var e=this.pendingSegment_,t=e.segment,n=null!==this.mediaIndex;this.pendingSegment_=null,this.recordThroughput_(e),this.addSegmentMetadataCue_(e),this.state="READY",this.mediaIndex=e.mediaIndex,this.fetchAtBuffer_=!0,this.currentTimeline_=e.timeline,this.trigger("syncinfoupdate"),t.end&&this.currentTime_()-t.end>3*e.playlist.targetDuration?this.resetEverything():(n&&this.trigger("bandwidthupdate"),this.trigger("progress"),this.isEndOfStream_(e.mediaIndex+1,e.playlist)&&this.endOfStream(),this.paused()||this.monitorBuffer_())}},{key:"recordThroughput_",value:function(e){var t=this.throughput.rate,n=Date.now()-e.endOfAllRequests+1,i=Math.floor(e.byteLength/n*8*1e3);this.throughput.rate+=(i-t)/++this.throughput.count}},{key:"addSegmentMetadataCue_",value:function(t){if(this.segmentMetadataTrack_){var n=t.segment,i=n.start,r=n.end;if(jd(i)&&jd(r)){qc(i,r,this.segmentMetadataTrack_);var a=e.WebKitDataCue||e.VTTCue,o={custom:n.custom,dateTimeObject:n.dateTimeObject,dateTimeString:n.dateTimeString,bandwidth:t.playlist.attributes.BANDWIDTH,resolution:t.playlist.attributes.RESOLUTION,codecs:t.playlist.attributes.CODECS,byteLength:t.byteLength,uri:t.uri,timeline:t.timeline,playlist:t.playlist.uri,start:i,end:r},s=new a(i,r,JSON.stringify(o));s.value=o,this.segmentMetadataTrack_.addCue(s)}}}}]),n}(to.EventTarget),Fd=function(e){return decodeURIComponent(escape(String.fromCharCode.apply(null,e)))},Ud=new Uint8Array("\n\n".split("").map(function(e){return e.charCodeAt(0)})),Vd=function(t){function n(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Qu(this,n);var i=ec(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,e,t));return i.mediaSource_=null,i.subtitlesTrack_=null,i}return Zu(n,Bd),Ju(n,[{key:"buffered_",value:function(){if(!this.subtitlesTrack_||!this.subtitlesTrack_.cues.length)return to.createTimeRanges();var e=this.subtitlesTrack_.cues,t=e[0].startTime,n=e[e.length-1].startTime;return to.createTimeRanges([[t,n]])}},{key:"initSegment",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!e)return null;var n=Nc(e),i=this.initSegments_[n];if(t&&!i&&e.bytes){var r=Ud.byteLength+e.bytes.byteLength,a=new Uint8Array(r);a.set(e.bytes),a.set(Ud,e.bytes.byteLength),this.initSegments_[n]=i={resolvedUri:e.resolvedUri,byterange:e.byterange,bytes:a}}return i||e}},{key:"couldBeginLoading_",value:function(){return this.playlist_&&this.subtitlesTrack_&&!this.paused()}},{key:"init_",value:function(){return this.state="READY",this.resetEverything(),this.monitorBuffer_()}},{key:"track",value:function(e){return void 0===e?this.subtitlesTrack_:(this.subtitlesTrack_=e,"INIT"===this.state&&this.couldBeginLoading_()&&this.init_(),this.subtitlesTrack_)}},{key:"remove",value:function(e,t){qc(e,t,this.subtitlesTrack_)}},{key:"fillBuffer_",value:function(){var e=this;this.syncPoint_||(this.syncPoint_=this.syncController_.getSyncPoint(this.playlist_,this.duration_(),this.currentTimeline_,this.currentTime_()));var t=this.checkBuffer_(this.buffered_(),this.playlist_,this.mediaIndex,this.hasPlayed_(),this.currentTime_(),this.syncPoint_);if(t=this.skipEmptySegments_(t)){if(null===this.syncController_.timestampOffsetForTimeline(t.timeline))return this.syncController_.one("timestampoffset",function(){e.state="READY",e.paused()||e.monitorBuffer_()}),void(this.state="WAITING_ON_TIMELINE");this.loadSegment_(t)}}},{key:"skipEmptySegments_",value:function(e){for(;e&&e.segment.empty;)e=this.generateSegmentInfo_(e.playlist,e.mediaIndex+1,e.startOfSegment+e.duration,e.isSyncRequest);return e}},{key:"handleSegment_",value:function(){var t=this;if(this.pendingSegment_&&this.subtitlesTrack_){this.state="APPENDING";var n=this.pendingSegment_,i=n.segment;if("function"!=typeof e.WebVTT&&this.subtitlesTrack_&&this.subtitlesTrack_.tech_){var r=void 0,a=function(){t.subtitlesTrack_.tech_.off("vttjsloaded",r),t.error({message:"Error loading vtt.js"}),t.state="READY",t.pause(),t.trigger("error")};return r=function(){t.subtitlesTrack_.tech_.off("vttjserror",a),t.handleSegment_()},this.state="WAITING_ON_VTTJS",this.subtitlesTrack_.tech_.one("vttjsloaded",r),void this.subtitlesTrack_.tech_.one("vttjserror",a)}i.requested=!0;try{this.parseVTTCues_(n)}catch(e){return this.error({message:e.message}),this.state="READY",this.pause(),this.trigger("error")}if(this.updateTimeMapping_(n,this.syncController_.timelines[n.timeline],this.playlist_),n.isSyncRequest)return this.trigger("syncinfoupdate"),this.pendingSegment_=null,void(this.state="READY");n.byteLength=n.bytes.byteLength,this.mediaSecondsLoaded+=i.duration,n.cues.length&&this.remove(n.cues[0].endTime,n.cues[n.cues.length-1].endTime),n.cues.forEach(function(e){t.subtitlesTrack_.addCue(e)}),this.handleUpdateEnd_()}else this.state="READY"}},{key:"parseVTTCues_",value:function(t){var n=void 0,i=!1;"function"==typeof e.TextDecoder?n=new e.TextDecoder("utf8"):(n=e.WebVTT.StringDecoder(),i=!0);var r=new e.WebVTT.Parser(e,e.vttjs,n);if(t.cues=[],t.timestampmap={MPEGTS:0,LOCAL:0},r.oncue=t.cues.push.bind(t.cues),r.ontimestampmap=function(e){return t.timestampmap=e},r.onparsingerror=function(e){to.log.warn("Error encountered when parsing cues: "+e.message)},t.segment.map){var a=t.segment.map.bytes;i&&(a=Fd(a)),r.parse(a)}var o=t.bytes;i&&(o=Fd(o)),r.parse(o),r.flush()}},{key:"updateTimeMapping_",value:function(e,t,n){var i=e.segment;if(t)if(e.cues.length){var r=e.timestampmap,a=r.MPEGTS/9e4-r.LOCAL+t.mapping;if(e.cues.forEach(function(e){e.startTime+=a,e.endTime+=a}),!n.syncInfo){var o=e.cues[0].startTime,s=e.cues[e.cues.length-1].startTime;n.syncInfo={mediaSequence:n.mediaSequence+e.mediaIndex,time:Math.min(o,s-i.duration)}}}else i.empty=!0}}]),n}(),qd=function(e,t){for(var n=e.cues,i=0;i<n.length;i++){var r=n[i];if(t>=r.adStartTime&&t<=r.adEndTime)return r}return null},Hd=Ku,zd=[{name:"VOD",run:function(e,t,n,i,r){return n!==1/0?{time:0,segmentIndex:0}:null}},{name:"ProgramDateTime",run:function(e,t,n,i,r){if(!e.datetimeToDisplayTime)return null;var a=t.segments||[],o=null,s=null;r=r||0;for(var l=0;l<a.length;l++){var u=a[l];if(u.dateTimeObject){var c=u.dateTimeObject.getTime()/1e3+e.datetimeToDisplayTime,d=Math.abs(r-c);if(null!==s&&(0===d||s<d))break;s=d,o={time:c,segmentIndex:l}}}return o}},{name:"Segment",run:function(e,t,n,i,r){var a=t.segments||[],o=null,s=null;r=r||0;for(var l=0;l<a.length;l++){var u=a[l];if(u.timeline===i&&void 0!==u.start){var c=Math.abs(r-u.start);if(null!==s&&s<c)break;(!o||null===s||s>=c)&&(s=c,o={time:u.start,segmentIndex:l})}}return o}},{name:"Discontinuity",run:function(e,t,n,i,r){var a=null;if(r=r||0,t.discontinuityStarts&&t.discontinuityStarts.length)for(var o=null,s=0;s<t.discontinuityStarts.length;s++){var l=t.discontinuityStarts[s],u=t.discontinuitySequence+s+1,c=e.discontinuities[u];if(c){var d=Math.abs(r-c.time);if(null!==o&&o<d)break;(!a||null===o||o>=d)&&(o=d,a={time:c.time,segmentIndex:l})}}return a}},{name:"Playlist",run:function(e,t,n,i,r){return t.syncInfo?{time:t.syncInfo.time,segmentIndex:t.syncInfo.mediaSequence-t.mediaSequence}:null}}],Wd=function(e){function t(){Qu(this,t);var e=ec(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.inspectCache_=void 0,e.timelines=[],e.discontinuities=[],e.datetimeToDisplayTime=null,e.logger_=Sd("SyncController"),e}return Zu(t,e),Ju(t,[{key:"getSyncPoint",value:function(e,t,n,i){var r=this.runStrategies_(e,t,n,i);return r.length?this.selectSyncPoint_(r,{key:"time",value:i}):null}},{key:"getExpiredTime",value:function(e,t){if(!e||!e.segments)return null;var n=this.runStrategies_(e,t,e.discontinuitySequence,0);if(!n.length)return null;var i=this.selectSyncPoint_(n,{key:"segmentIndex",value:0});return i.segmentIndex>0&&(i.time*=-1),Math.abs(i.time+fc(e,i.segmentIndex,0))}},{key:"runStrategies_",value:function(e,t,n,i){for(var r=[],a=0;a<zd.length;a++){var o=zd[a],s=o.run(this,e,t,n,i);s&&(s.strategy=o.name,r.push({strategy:o.name,syncPoint:s}))}return r}},{key:"selectSyncPoint_",value:function(e,t){for(var n=e[0].syncPoint,i=Math.abs(e[0].syncPoint[t.key]-t.value),r=e[0].strategy,a=1;a<e.length;a++){var o=Math.abs(e[a].syncPoint[t.key]-t.value);o<i&&(i=o,n=e[a].syncPoint,r=e[a].strategy)}return this.logger_("syncPoint for ["+t.key+": "+t.value+"] chosen with strategy ["+r+"]: [time:"+n.time+", segmentIndex:"+n.segmentIndex+"]"),n}},{key:"saveExpiredSegmentInfo",value:function(e,t){for(var n=t.mediaSequence-e.mediaSequence-1;n>=0;n--){var i=e.segments[n];if(i&&void 0!==i.start){t.syncInfo={mediaSequence:e.mediaSequence+n,time:i.start},this.logger_("playlist refresh sync: [time:"+t.syncInfo.time+", mediaSequence: "+t.syncInfo.mediaSequence+"]"),this.trigger("syncinfoupdate");break}}}},{key:"setDateTimeMapping",value:function(e){if(!this.datetimeToDisplayTime&&e.segments&&e.segments.length&&e.segments[0].dateTimeObject){var t=e.segments[0].dateTimeObject.getTime()/1e3;this.datetimeToDisplayTime=-t}}},{key:"reset",value:function(){this.inspectCache_=void 0}},{key:"probeSegmentInfo",value:function(e){var t,n=e.segment,i=e.playlist;return(t=n.map?this.probeMp4Segment_(e):this.probeTsSegment_(e))&&this.calculateSegmentTimeMapping_(e,t)&&(this.saveDiscontinuitySyncInfo_(e),i.syncInfo||(i.syncInfo={mediaSequence:i.mediaSequence+e.mediaIndex,time:n.start})),t}},{key:"probeMp4Segment_",value:function(e){var t=e.segment,n=Hs.timescale(t.map.bytes),i=Hs.startTime(n,e.bytes);return null!==e.timestampOffset&&(e.timestampOffset-=i),{start:i,end:i+t.duration}}},{key:"probeTsSegment_",value:function(e){var t=Hd(e.bytes,this.inspectCache_),n=void 0,i=void 0;return t?(t.video&&2===t.video.length?(this.inspectCache_=t.video[1].dts,n=t.video[0].dtsTime,i=t.video[1].dtsTime):t.audio&&2===t.audio.length&&(this.inspectCache_=t.audio[1].dts,n=t.audio[0].dtsTime,i=t.audio[1].dtsTime),{start:n,end:i,containsVideo:t.video&&2===t.video.length,containsAudio:t.audio&&2===t.audio.length}):null}},{key:"timestampOffsetForTimeline",value:function(e){return void 0===this.timelines[e]?null:this.timelines[e].time}},{key:"mappingForTimeline",value:function(e){return void 0===this.timelines[e]?null:this.timelines[e].mapping}},{key:"calculateSegmentTimeMapping_",value:function(e,t){var n=e.segment,i=this.timelines[e.timeline];if(null!==e.timestampOffset)i={time:e.startOfSegment,mapping:e.startOfSegment-t.start},this.timelines[e.timeline]=i,this.trigger("timestampoffset"),this.logger_("time mapping for timeline "+e.timeline+": [time: "+i.time+"] [mapping: "+i.mapping+"]"),n.start=e.startOfSegment,n.end=t.end+i.mapping;else{if(!i)return!1;n.start=t.start+i.mapping,n.end=t.end+i.mapping}return!0}},{key:"saveDiscontinuitySyncInfo_",value:function(e){var t=e.playlist,n=e.segment;if(n.discontinuity)this.discontinuities[n.timeline]={time:n.start,accuracy:0};else if(t.discontinuityStarts&&t.discontinuityStarts.length)for(var i=0;i<t.discontinuityStarts.length;i++){var r=t.discontinuityStarts[i],a=t.discontinuitySequence+i+1,o=r-e.mediaIndex,s=Math.abs(o);if(!this.discontinuities[a]||this.discontinuities[a].accuracy>s){var l;l=o<0?n.start-fc(t,e.mediaIndex,r):n.end+fc(t,e.mediaIndex+1,r),this.discontinuities[a]={time:l,accuracy:s}}}}}]),t}(to.EventTarget),Gd=new Zc("./decrypter-worker.worker.js",function(e,t){var n,i,r,a,o,s,l,u,c,d;n=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},i=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t},a=function(){var e=[[[],[],[],[],[]],[[],[],[],[],[]]],t=e[0],n=e[1],i=t[4],r=n[4],a=void 0,o=void 0,s=void 0,l=[],u=[],c=void 0,d=void 0,h=void 0,p=void 0,f=void 0;for(a=0;a<256;a++)u[(l[a]=a<<1^283*(a>>7))^a]=a;for(o=s=0;!i[o];o^=c||1,s=u[s]||1)for(h=(h=s^s<<1^s<<2^s<<3^s<<4)>>8^255&h^99,i[o]=h,r[h]=o,f=16843009*l[d=l[c=l[o]]]^65537*d^257*c^16843008*o,p=257*l[h]^16843008*h,a=0;a<4;a++)t[a][o]=p=p<<24^p>>>8,n[a][h]=f=f<<24^f>>>8;for(a=0;a<5;a++)t[a]=t[a].slice(0),n[a]=n[a].slice(0);return e},o=null,s=function(){function e(t){n(this,e),o||(o=a()),this._tables=[[o[0][0].slice(),o[0][1].slice(),o[0][2].slice(),o[0][3].slice(),o[0][4].slice()],[o[1][0].slice(),o[1][1].slice(),o[1][2].slice(),o[1][3].slice(),o[1][4].slice()]];var i=void 0,r=void 0,s=void 0,l=void 0,u=void 0,c=this._tables[0][4],d=this._tables[1],h=t.length,p=1;if(4!==h&&6!==h&&8!==h)throw new Error("Invalid aes key size");for(l=t.slice(0),u=[],this._key=[l,u],i=h;i<4*h+28;i++)s=l[i-1],(i%h==0||8===h&&i%h==4)&&(s=c[s>>>24]<<24^c[s>>16&255]<<16^c[s>>8&255]<<8^c[255&s],i%h==0&&(s=s<<8^s>>>24^p<<24,p=p<<1^283*(p>>7))),l[i]=l[i-h]^s;for(r=0;i;r++,i--)s=l[3&r?i:i-4],u[r]=i<=4||r<4?s:d[0][c[s>>>24]]^d[1][c[s>>16&255]]^d[2][c[s>>8&255]]^d[3][c[255&s]]}return e.prototype.decrypt=function(e,t,n,i,r,a){var o=this._key[1],s=e^o[0],l=i^o[1],u=n^o[2],c=t^o[3],d=void 0,h=void 0,p=void 0,f=o.length/4-2,g=void 0,m=4,v=this._tables[1],y=v[0],b=v[1],_=v[2],T=v[3],E=v[4];for(g=0;g<f;g++)d=y[s>>>24]^b[l>>16&255]^_[u>>8&255]^T[255&c]^o[m],h=y[l>>>24]^b[u>>16&255]^_[c>>8&255]^T[255&s]^o[m+1],p=y[u>>>24]^b[c>>16&255]^_[s>>8&255]^T[255&l]^o[m+2],c=y[c>>>24]^b[s>>16&255]^_[l>>8&255]^T[255&u]^o[m+3],m+=4,s=d,l=h,u=p;for(g=0;g<4;g++)r[(3&-g)+a]=E[s>>>24]<<24^E[l>>16&255]<<16^E[u>>8&255]<<8^E[255&c]^o[m++],d=s,s=l,l=u,u=c,c=d},e}(),l=function(){function e(){n(this,e),this.listeners={}}return e.prototype.on=function(e,t){this.listeners[e]||(this.listeners[e]=[]),this.listeners[e].push(t)},e.prototype.off=function(e,t){if(!this.listeners[e])return!1;var n=this.listeners[e].indexOf(t);return this.listeners[e].splice(n,1),n>-1},e.prototype.trigger=function(e){var t=this.listeners[e];if(t)if(2===arguments.length)for(var n=t.length,i=0;i<n;++i)t[i].call(this,arguments[1]);else for(var r=Array.prototype.slice.call(arguments,1),a=t.length,o=0;o<a;++o)t[o].apply(this,r)},e.prototype.dispose=function(){this.listeners={}},e.prototype.pipe=function(e){this.on("data",function(t){e.push(t)})},e}(),u=function(e){function t(){n(this,t);var i=r(this,e.call(this,l));return i.jobs=[],i.delay=1,i.timeout_=null,i}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t.prototype.processJob_=function(){this.jobs.shift()(),this.jobs.length?this.timeout_=setTimeout(this.processJob_.bind(this),this.delay):this.timeout_=null},t.prototype.push=function(e){this.jobs.push(e),this.timeout_||(this.timeout_=setTimeout(this.processJob_.bind(this),this.delay))},t}(l),c=function(e){return e<<24|(65280&e)<<8|(16711680&e)>>8|e>>>24},d=function(){function e(t,i,r,a){n(this,e);var o=e.STEP,s=new Int32Array(t.buffer),l=new Uint8Array(t.byteLength),d=0;for(this.asyncStream_=new u,this.asyncStream_.push(this.decryptChunk_(s.subarray(d,d+o),i,r,l)),d=o;d<s.length;d+=o)r=new Uint32Array([c(s[d-4]),c(s[d-3]),c(s[d-2]),c(s[d-1])]),this.asyncStream_.push(this.decryptChunk_(s.subarray(d,d+o),i,r,l));this.asyncStream_.push(function(){var e;a(null,(e=l).subarray(0,e.byteLength-e[e.byteLength-1]))})}return e.prototype.decryptChunk_=function(e,t,n,i){return function(){var r=function(e,t,n){var i=new Int32Array(e.buffer,e.byteOffset,e.byteLength>>2),r=new s(Array.prototype.slice.call(t)),a=new Uint8Array(e.byteLength),o=new Int32Array(a.buffer),l=void 0,u=void 0,d=void 0,h=void 0,p=void 0,f=void 0,g=void 0,m=void 0,v=void 0;for(l=n[0],u=n[1],d=n[2],h=n[3],v=0;v<i.length;v+=4)p=c(i[v]),f=c(i[v+1]),g=c(i[v+2]),m=c(i[v+3]),r.decrypt(p,f,g,m,o,v),o[v]=c(o[v]^l),o[v+1]=c(o[v+1]^u),o[v+2]=c(o[v+2]^d),o[v+3]=c(o[v+3]^h),l=p,u=f,d=g,h=m;return a}(e,t,n);i.set(r,e.byteOffset)}},i(e,null,[{key:"STEP",get:function(){return 32e3}}]),e}(),new function(e){e.onmessage=function(t){var n=t.data,i=new Uint8Array(n.encrypted.bytes,n.encrypted.byteOffset,n.encrypted.byteLength),r=new Uint32Array(n.key.bytes,n.key.byteOffset,n.key.byteLength/4),a=new Uint32Array(n.iv.bytes,n.iv.byteOffset,n.iv.byteLength/4);new d(i,r,a,function(t,i){var r,a;e.postMessage((r={source:n.source,decrypted:i},a={},Object.keys(r).forEach(function(e){var t=r[e];ArrayBuffer.isView(t)?a[e]={bytes:t.buffer,byteOffset:t.byteOffset,byteLength:t.byteLength}:a[e]=t}),a),[i.buffer])})}}(this)}),Xd=function(e){var t=e.default?"main":"alternative";return e.characteristics&&e.characteristics.indexOf("public.accessibility.describes-video")>=0&&(t="main-desc"),t},Yd=function(e,t){e.abort(),e.pause(),t&&t.activePlaylistLoader&&(t.activePlaylistLoader.pause(),t.activePlaylistLoader=null)},Qd=function(e,t){t.activePlaylistLoader=e,e.load()},Jd={AUDIO:function(e,t){return function(){var n=t.segmentLoaders[e],i=t.mediaTypes[e],r=t.blacklistCurrentPlaylist;Yd(n,i);var a=i.activeTrack(),o=i.activeGroup(),s=(o.filter(function(e){return e.default})[0]||o[0]).id,l=i.tracks[s];if(a!==l){for(var u in to.log.warn("Problem encountered loading the alternate audio track.Switching back to default."),i.tracks)i.tracks[u].enabled=i.tracks[u]===l;i.onTrackChanged()}else r({message:"Problem encountered loading the default audio track."})}},SUBTITLES:function(e,t){return function(){var n=t.segmentLoaders[e],i=t.mediaTypes[e];to.log.warn("Problem encountered loading the subtitle track.Disabling subtitle track."),Yd(n,i);var r=i.activeTrack();r&&(r.mode="disabled"),i.onTrackChanged()}}},Zd={AUDIO:function(e,t,n){if(t){var i=n.tech,r=n.requestOptions,a=n.segmentLoaders[e];t.on("loadedmetadata",function(){var e=t.media();a.playlist(e,r),(!i.paused()||e.endList&&"none"!==i.preload())&&a.load()}),t.on("loadedplaylist",function(){a.playlist(t.media(),r),i.paused()||a.load()}),t.on("error",Jd[e](e,n))}},SUBTITLES:function(e,t,n){var i=n.tech,r=n.requestOptions,a=n.segmentLoaders[e],o=n.mediaTypes[e];t.on("loadedmetadata",function(){var e=t.media();a.playlist(e,r),a.track(o.activeTrack()),(!i.paused()||e.endList&&"none"!==i.preload())&&a.load()}),t.on("loadedplaylist",function(){a.playlist(t.media(),r),i.paused()||a.load()}),t.on("error",Jd[e](e,n))}},eh={AUDIO:function(e,t){var n=t.hls,i=t.sourceType,r=t.segmentLoaders[e],a=t.requestOptions,o=t.master.mediaGroups,s=t.mediaTypes[e],l=s.groups,u=s.tracks,c=t.masterPlaylistLoader;for(var d in o[e]&&0!==Object.keys(o[e]).length||(o[e]={main:{default:{default:!0}}}),o[e])for(var h in l[d]||(l[d]=[]),o[e][d]){var p,f=o[e][d][h];if(p=f.resolvedUri?new cc(f.resolvedUri,n,a):f.playlists&&"dash"===i?new kd(f.playlists[0],n,a,c):null,f=to.mergeOptions({id:h,playlistLoader:p},f),Zd[e](e,f.playlistLoader,t),l[d].push(f),void 0===u[h]){var g=new to.AudioTrack({id:h,kind:Xd(f),enabled:!1,language:f.language,default:f.default,label:h});u[h]=g}}r.on("error",Jd[e](e,t))},SUBTITLES:function(e,t){var n=t.tech,i=t.hls,r=t.sourceType,a=t.segmentLoaders[e],o=t.requestOptions,s=t.master.mediaGroups,l=t.mediaTypes[e],u=l.groups,c=l.tracks,d=t.masterPlaylistLoader;for(var h in s[e])for(var p in u[h]||(u[h]=[]),s[e][h])if(!s[e][h][p].forced){var f=s[e][h][p],g=void 0;if("hls"===r?g=new cc(f.resolvedUri,i,o):"dash"===r&&(g=new kd(f.playlists[0],i,o,d)),f=to.mergeOptions({id:p,playlistLoader:g},f),Zd[e](e,f.playlistLoader,t),u[h].push(f),void 0===c[p]){var m=n.addRemoteTextTrack({id:p,kind:"subtitles",default:f.default&&f.autoselect,language:f.language,label:p},!1).track;c[p]=m}}a.on("error",Jd[e](e,t))},"CLOSED-CAPTIONS":function(e,t){var n=t.tech,i=t.master.mediaGroups,r=t.mediaTypes[e],a=r.groups,o=r.tracks;for(var s in i[e])for(var l in a[s]||(a[s]=[]),i[e][s]){var u=i[e][s][l];if(u.instreamId.match(/CC\d/)&&(a[s].push(to.mergeOptions({id:l},u)),void 0===o[l])){var c=n.addRemoteTextTrack({id:u.instreamId,kind:"captions",default:u.default&&u.autoselect,language:u.language,label:l},!1).track;o[l]=c}}}},th={AUDIO:function(e,t){return function(){var n=t.mediaTypes[e].tracks;for(var i in n)if(n[i].enabled)return n[i];return null}},SUBTITLES:function(e,t){return function(){var n=t.mediaTypes[e].tracks;for(var i in n)if("showing"===n[i].mode)return n[i];return null}}},nh=function(){var e={};return["AUDIO","SUBTITLES","CLOSED-CAPTIONS"].forEach(function(t){e[t]={groups:{},tracks:{},activePlaylistLoader:null,activeGroup:Id,activeTrack:Id,onGroupChanged:Id,onTrackChanged:Id}}),e},ih=void 0,rh=["mediaRequests","mediaRequestsAborted","mediaRequestsTimedout","mediaRequestsErrored","mediaTransferDuration","mediaBytesTransferred"],ah=function(e){return this.audioSegmentLoader_[e]+this.mainSegmentLoader_[e]},oh=function(t){function n(e){Qu(this,n);var t=ec(this,(n.__proto__||Object.getPrototypeOf(n)).call(this)),i=e.url,r=e.handleManifestRedirects,a=e.withCredentials,o=e.tech,s=e.bandwidth,l=e.externHls,u=e.useCueTags,c=e.blacklistDuration,d=e.enableLowInitialPlaylist,h=e.sourceType,p=e.seekTo,f=e.cacheEncryptionKeys;if(!i)throw new Error("A non-empty playlist URL is required");ih=l,t.withCredentials=a,t.tech_=o,t.hls_=o.hls,t.seekTo_=p,t.sourceType_=h,t.useCueTags_=u,t.blacklistDuration=c,t.enableLowInitialPlaylist=d,t.useCueTags_&&(t.cueTagsTrack_=t.tech_.addTextTrack("metadata","ad-cues"),t.cueTagsTrack_.inBandMetadataTrackDispatchType=""),t.requestOptions_={withCredentials:a,handleManifestRedirects:r,timeout:null},t.mediaTypes_=nh(),t.mediaSource=new to.MediaSource,t.mediaSource.addEventListener("sourceopen",t.handleSourceOpen_.bind(t)),t.seekable_=to.createTimeRanges(),t.hasPlayed_=function(){return!1},t.syncController_=new Wd(e),t.segmentMetadataTrack_=o.addRemoteTextTrack({kind:"metadata",label:"segment-metadata"},!1).track,t.decrypter_=new Gd,t.inbandTextTracks_={};var g={hls:t.hls_,mediaSource:t.mediaSource,currentTime:t.tech_.currentTime.bind(t.tech_),seekable:function(){return t.seekable()},seeking:function(){return t.tech_.seeking()},duration:function(){return t.mediaSource.duration},hasPlayed:function(){return t.hasPlayed_()},goalBufferLength:function(){return t.goalBufferLength()},bandwidth:s,syncController:t.syncController_,decrypter:t.decrypter_,sourceType:t.sourceType_,inbandTextTracks:t.inbandTextTracks_,cacheEncryptionKeys:f};return t.masterPlaylistLoader_="dash"===t.sourceType_?new kd(i,t.hls_,t.requestOptions_):new cc(i,t.hls_,t.requestOptions_),t.setupMasterPlaylistLoaderListeners_(),t.mainSegmentLoader_=new Bd(to.mergeOptions(g,{segmentMetadataTrack:t.segmentMetadataTrack_,loaderType:"main"}),e),t.audioSegmentLoader_=new Bd(to.mergeOptions(g,{loaderType:"audio"}),e),t.subtitleSegmentLoader_=new Vd(to.mergeOptions(g,{loaderType:"vtt"}),e),t.setupSegmentLoaderListeners_(),rh.forEach(function(e){t[e+"_"]=ah.bind(t,e)}),t.logger_=Sd("MPC"),t.masterPlaylistLoader_.load(),t}return Zu(n,t),Ju(n,[{key:"setupMasterPlaylistLoaderListeners_",value:function(){var e=this;this.masterPlaylistLoader_.on("loadedmetadata",function(){var t=e.masterPlaylistLoader_.media(),n=1.5*t.targetDuration*1e3;kc(e.masterPlaylistLoader_.master,e.masterPlaylistLoader_.media())?e.requestOptions_.timeout=0:e.requestOptions_.timeout=n,t.endList&&"none"!==e.tech_.preload()&&(e.mainSegmentLoader_.playlist(t,e.requestOptions_),e.mainSegmentLoader_.load()),function(e){["AUDIO","SUBTITLES","CLOSED-CAPTIONS"].forEach(function(t){eh[t](t,e)});var t=e.mediaTypes,n=e.masterPlaylistLoader,i=e.tech,r=e.hls;["AUDIO","SUBTITLES"].forEach(function(n){t[n].activeGroup=function(e,t){return function(n){var i=t.masterPlaylistLoader,r=t.mediaTypes[e].groups,a=i.media();if(!a)return null;var o=null;return a.attributes[e]&&(o=r[a.attributes[e]]),o=o||r.main,void 0===n?o:null===n?null:o.filter(function(e){return e.id===n.id})[0]||null}}(n,e),t[n].activeTrack=th[n](n,e),t[n].onGroupChanged=function(e,t){return function(){var n=t.segmentLoaders,i=n[e],r=n.main,a=t.mediaTypes[e],o=a.activeTrack(),s=a.activeGroup(o),l=a.activePlaylistLoader;Yd(i,a),s&&(s.playlistLoader?(i.resyncLoader(),Qd(s.playlistLoader,a)):l&&r.resetEverything())}}(n,e),t[n].onTrackChanged=function(e,t){return function(){var n=t.segmentLoaders,i=n[e],r=n.main,a=t.mediaTypes[e],o=a.activeTrack(),s=a.activeGroup(o),l=a.activePlaylistLoader;Yd(i,a),s&&(s.playlistLoader?l!==s.playlistLoader?(i.track&&i.track(o),i.resetEverything(),Qd(s.playlistLoader,a)):Qd(s.playlistLoader,a):r.resetEverything())}}(n,e)});var a=t.AUDIO.activeGroup(),o=(a.filter(function(e){return e.default})[0]||a[0]).id;t.AUDIO.tracks[o].enabled=!0,t.AUDIO.onTrackChanged(),n.on("mediachange",function(){["AUDIO","SUBTITLES"].forEach(function(e){return t[e].onGroupChanged()})});var s=function(){t.AUDIO.onTrackChanged(),i.trigger({type:"usage",name:"hls-audio-change"})};for(var l in i.audioTracks().addEventListener("change",s),i.remoteTextTracks().addEventListener("change",t.SUBTITLES.onTrackChanged),r.on("dispose",function(){i.audioTracks().removeEventListener("change",s),i.remoteTextTracks().removeEventListener("change",t.SUBTITLES.onTrackChanged)}),i.clearTracks("audio"),t.AUDIO.tracks)i.audioTracks().addTrack(t.AUDIO.tracks[l])}({sourceType:e.sourceType_,segmentLoaders:{AUDIO:e.audioSegmentLoader_,SUBTITLES:e.subtitleSegmentLoader_,main:e.mainSegmentLoader_},tech:e.tech_,requestOptions:e.requestOptions_,masterPlaylistLoader:e.masterPlaylistLoader_,hls:e.hls_,master:e.master(),mediaTypes:e.mediaTypes_,blacklistCurrentPlaylist:e.blacklistCurrentPlaylist.bind(e)}),e.triggerPresenceUsage_(e.master(),t);try{e.setupSourceBuffers_()}catch(t){return to.log.warn("Failed to create SourceBuffers",t),e.mediaSource.endOfStream("decode")}e.setupFirstPlay(),!e.mediaTypes_.AUDIO.activePlaylistLoader||e.mediaTypes_.AUDIO.activePlaylistLoader.media()?e.trigger("selectedinitialmedia"):e.mediaTypes_.AUDIO.activePlaylistLoader.one("loadedmetadata",function(){e.trigger("selectedinitialmedia")})}),this.masterPlaylistLoader_.on("loadedplaylist",function(){var t=e.masterPlaylistLoader_.media();if(!t){e.excludeUnsupportedVariants_();var n=void 0;return e.enableLowInitialPlaylist&&(n=e.selectInitialPlaylist()),n||(n=e.selectPlaylist()),e.initialMedia_=n,void e.masterPlaylistLoader_.media(e.initialMedia_)}if(e.useCueTags_&&e.updateAdCues_(t),e.mainSegmentLoader_.playlist(t,e.requestOptions_),e.updateDuration(),e.tech_.paused()||(e.mainSegmentLoader_.load(),e.audioSegmentLoader_&&e.audioSegmentLoader_.load()),!t.endList){var i=function(){var t=e.seekable();0!==t.length&&e.mediaSource.addSeekableRange_(t.start(0),t.end(0))};e.duration()!==1/0?e.tech_.one("durationchange",function t(){e.duration()===1/0?i():e.tech_.one("durationchange",t)}):i()}}),this.masterPlaylistLoader_.on("error",function(){e.blacklistCurrentPlaylist(e.masterPlaylistLoader_.error)}),this.masterPlaylistLoader_.on("mediachanging",function(){e.mainSegmentLoader_.abort(),e.mainSegmentLoader_.pause()}),this.masterPlaylistLoader_.on("mediachange",function(){var t=e.masterPlaylistLoader_.media(),n=1.5*t.targetDuration*1e3;kc(e.masterPlaylistLoader_.master,e.masterPlaylistLoader_.media())?e.requestOptions_.timeout=0:e.requestOptions_.timeout=n,e.mainSegmentLoader_.playlist(t,e.requestOptions_),e.mainSegmentLoader_.load(),e.tech_.trigger({type:"mediachange",bubbles:!0})}),this.masterPlaylistLoader_.on("playlistunchanged",function(){var t=e.masterPlaylistLoader_.media();e.stuckAtPlaylistEnd_(t)&&(e.blacklistCurrentPlaylist({message:"Playlist no longer updating."}),e.tech_.trigger("playliststuck"))}),this.masterPlaylistLoader_.on("renditiondisabled",function(){e.tech_.trigger({type:"usage",name:"hls-rendition-disabled"})}),this.masterPlaylistLoader_.on("renditionenabled",function(){e.tech_.trigger({type:"usage",name:"hls-rendition-enabled"})})}},{key:"triggerPresenceUsage_",value:function(e,t){var n=e.mediaGroups||{},i=!0,r=Object.keys(n.AUDIO);for(var a in n.AUDIO)for(var o in n.AUDIO[a]){n.AUDIO[a][o].uri||(i=!1)}i&&this.tech_.trigger({type:"usage",name:"hls-demuxed"}),Object.keys(n.SUBTITLES).length&&this.tech_.trigger({type:"usage",name:"hls-webvtt"}),ih.Playlist.isAes(t)&&this.tech_.trigger({type:"usage",name:"hls-aes"}),ih.Playlist.isFmp4(t)&&this.tech_.trigger({type:"usage",name:"hls-fmp4"}),r.length&&Object.keys(n.AUDIO[r[0]]).length>1&&this.tech_.trigger({type:"usage",name:"hls-alternate-audio"}),this.useCueTags_&&this.tech_.trigger({type:"usage",name:"hls-playlist-cue-tags"})}},{key:"setupSegmentLoaderListeners_",value:function(){var e=this;this.mainSegmentLoader_.on("bandwidthupdate",function(){var t=e.selectPlaylist(),n=e.masterPlaylistLoader_.media(),i=e.tech_.buffered(),r=i.length?i.end(i.length-1)-e.tech_.currentTime():0,a=e.bufferLowWaterLine();(!n.endList||e.duration()<Dd.MAX_BUFFER_LOW_WATER_LINE||t.attributes.BANDWIDTH<n.attributes.BANDWIDTH||r>=a)&&e.masterPlaylistLoader_.media(t),e.tech_.trigger("bandwidthupdate")}),this.mainSegmentLoader_.on("progress",function(){e.trigger("progress")}),this.mainSegmentLoader_.on("error",function(){e.blacklistCurrentPlaylist(e.mainSegmentLoader_.error())}),this.mainSegmentLoader_.on("syncinfoupdate",function(){e.onSyncInfoUpdate_()}),this.mainSegmentLoader_.on("timestampoffset",function(){e.tech_.trigger({type:"usage",name:"hls-timestamp-offset"})}),this.audioSegmentLoader_.on("syncinfoupdate",function(){e.onSyncInfoUpdate_()}),this.mainSegmentLoader_.on("ended",function(){e.onEndOfStream()}),this.mainSegmentLoader_.on("earlyabort",function(){e.blacklistCurrentPlaylist({message:"Aborted early because there isn't enough bandwidth to complete the request without rebuffering."},120)}),this.mainSegmentLoader_.on("reseteverything",function(){e.tech_.trigger("hls-reset")}),this.mainSegmentLoader_.on("segmenttimemapping",function(t){e.tech_.trigger({type:"hls-segment-time-mapping",mapping:t.mapping})}),this.audioSegmentLoader_.on("ended",function(){e.onEndOfStream()})}},{key:"mediaSecondsLoaded_",value:function(){return Math.max(this.audioSegmentLoader_.mediaSecondsLoaded+this.mainSegmentLoader_.mediaSecondsLoaded)}},{key:"load",value:function(){this.mainSegmentLoader_.load(),this.mediaTypes_.AUDIO.activePlaylistLoader&&this.audioSegmentLoader_.load(),this.mediaTypes_.SUBTITLES.activePlaylistLoader&&this.subtitleSegmentLoader_.load()}},{key:"smoothQualityChange_",value:function(){var e=this.selectPlaylist();e!==this.masterPlaylistLoader_.media()&&(this.masterPlaylistLoader_.media(e),this.mainSegmentLoader_.resetLoader())}},{key:"fastQualityChange_",value:function(){var e=this,t=this.selectPlaylist();t!==this.masterPlaylistLoader_.media()&&(this.masterPlaylistLoader_.media(t),this.mainSegmentLoader_.resetEverything(function(){to.browser.IE_VERSION||to.browser.IS_EDGE?e.tech_.setCurrentTime(e.tech_.currentTime()+.04):e.tech_.setCurrentTime(e.tech_.currentTime())}))}},{key:"play",value:function(){if(!this.setupFirstPlay()){this.tech_.ended()&&this.seekTo_(0),this.hasPlayed_()&&this.load();var e=this.tech_.seekable();return this.tech_.duration()===1/0&&this.tech_.currentTime()<e.start(0)?this.seekTo_(e.end(e.length-1)):void 0}}},{key:"setupFirstPlay",value:function(){var e=this,t=this.masterPlaylistLoader_.media();if(!t||this.tech_.paused()||this.hasPlayed_())return!1;if(!t.endList){var n=this.seekable();if(!n.length)return!1;if(to.browser.IE_VERSION&&0===this.tech_.readyState())return this.tech_.one("loadedmetadata",function(){e.trigger("firstplay"),e.seekTo_(n.end(0)),e.hasPlayed_=function(){return!0}}),!1;this.trigger("firstplay"),this.seekTo_(n.end(0))}return this.hasPlayed_=function(){return!0},this.load(),!0}},{key:"handleSourceOpen_",value:function(){try{this.setupSourceBuffers_()}catch(e){return to.log.warn("Failed to create Source Buffers",e),this.mediaSource.endOfStream("decode")}if(this.tech_.autoplay()){var e=this.tech_.play();void 0!==e&&"function"==typeof e.then&&e.then(null,function(e){})}this.trigger("sourceopen")}},{key:"onEndOfStream",value:function(){var e=this.mainSegmentLoader_.ended_;if(this.mediaTypes_.AUDIO.activePlaylistLoader&&(e=!this.mainSegmentLoader_.startingMedia_||this.mainSegmentLoader_.startingMedia_.containsVideo?e&&this.audioSegmentLoader_.ended_:this.audioSegmentLoader_.ended_),e){this.logger_("calling mediaSource.endOfStream()");try{this.mediaSource.endOfStream()}catch(e){to.log.warn("Failed to call media source endOfStream",e)}}}},{key:"stuckAtPlaylistEnd_",value:function(e){if(!this.seekable().length)return!1;var t=this.syncController_.getExpiredTime(e,this.mediaSource.duration);if(null===t)return!1;var n=ih.Playlist.playlistEnd(e,t),i=this.tech_.currentTime(),r=this.tech_.buffered();if(!r.length)return n-i<=.1;var a=r.end(r.length-1);return a-i<=.1&&n-a<=.1}},{key:"blacklistCurrentPlaylist",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments[1],n=void 0,i=void 0;if(n=e.playlist||this.masterPlaylistLoader_.media(),t=t||e.blacklistDuration||this.blacklistDuration,!n){this.error=e;try{return this.mediaSource.endOfStream("network")}catch(e){return this.trigger("error")}}var r=1===this.masterPlaylistLoader_.master.playlists.filter(Cc).length,a=this.masterPlaylistLoader_.master.playlists;return 1===a.length?(to.log.warn("Problem encountered with the current HLS playlist. Trying again since it is the only playlist."),this.tech_.trigger("retryplaylist"),this.masterPlaylistLoader_.load(r)):(r&&(to.log.warn("Removing all playlists from the blacklist because the last rendition is about to be blacklisted."),a.forEach(function(e){e.excludeUntil!==1/0&&delete e.excludeUntil}),this.tech_.trigger("retryplaylist")),n.excludeUntil=Date.now()+1e3*t,this.tech_.trigger("blacklistplaylist"),this.tech_.trigger({type:"usage",name:"hls-rendition-blacklisted"}),i=this.selectPlaylist(),to.log.warn("Problem encountered with the current HLS playlist."+(e.message?" "+e.message:"")+" Switching to another playlist."),this.masterPlaylistLoader_.media(i,r))}},{key:"pauseLoading",value:function(){this.mainSegmentLoader_.pause(),this.mediaTypes_.AUDIO.activePlaylistLoader&&this.audioSegmentLoader_.pause(),this.mediaTypes_.SUBTITLES.activePlaylistLoader&&this.subtitleSegmentLoader_.pause()}},{key:"setCurrentTime",value:function(e){var t=Bc(this.tech_.buffered(),e);return this.masterPlaylistLoader_&&this.masterPlaylistLoader_.media()&&this.masterPlaylistLoader_.media().segments?t&&t.length?e:(this.mainSegmentLoader_.resetEverything(),this.mainSegmentLoader_.abort(),this.mediaTypes_.AUDIO.activePlaylistLoader&&(this.audioSegmentLoader_.resetEverything(),this.audioSegmentLoader_.abort()),this.mediaTypes_.SUBTITLES.activePlaylistLoader&&(this.subtitleSegmentLoader_.resetEverything(),this.subtitleSegmentLoader_.abort()),void this.load()):0}},{key:"duration",value:function(){return this.masterPlaylistLoader_?this.mediaSource?this.mediaSource.duration:ih.Playlist.duration(this.masterPlaylistLoader_.media()):0}},{key:"seekable",value:function(){return this.seekable_}},{key:"onSyncInfoUpdate_",value:function(){var e=void 0,t=void 0;if(this.masterPlaylistLoader_){var n=this.masterPlaylistLoader_.media();if(n){var i=this.syncController_.getExpiredTime(n,this.mediaSource.duration);if(null!==i&&0!==(e=ih.Playlist.seekable(n,i)).length){if(this.mediaTypes_.AUDIO.activePlaylistLoader){if(n=this.mediaTypes_.AUDIO.activePlaylistLoader.media(),null===(i=this.syncController_.getExpiredTime(n,this.mediaSource.duration)))return;if(0===(t=ih.Playlist.seekable(n,i)).length)return}var r=void 0,a=void 0;this.seekable_&&this.seekable_.length&&(r=this.seekable_.end(0),a=this.seekable_.start(0)),t?t.start(0)>e.end(0)||e.start(0)>t.end(0)?this.seekable_=e:this.seekable_=to.createTimeRanges([[t.start(0)>e.start(0)?t.start(0):e.start(0),t.end(0)<e.end(0)?t.end(0):e.end(0)]]):this.seekable_=e,this.seekable_&&this.seekable_.length&&this.seekable_.end(0)===r&&this.seekable_.start(0)===a||(this.logger_("seekable updated ["+Uc(this.seekable_)+"]"),this.tech_.trigger("seekablechanged"))}}}}},{key:"updateDuration",value:function(){var e=this,t=this.mediaSource.duration,n=ih.Playlist.duration(this.masterPlaylistLoader_.media()),i=this.tech_.buffered(),r=function t(){e.logger_("Setting duration from "+e.mediaSource.duration+" => "+n);try{e.mediaSource.duration=n}catch(e){to.log.warn("Failed to set media source duration",e)}e.tech_.trigger("durationchange"),e.mediaSource.removeEventListener("sourceopen",t)};i.length>0&&(n=Math.max(n,i.end(i.length-1))),t!==n&&("open"!==this.mediaSource.readyState?this.mediaSource.addEventListener("sourceopen",r):r())}},{key:"dispose",value:function(){var e=this;this.decrypter_.terminate(),this.masterPlaylistLoader_.dispose(),this.mainSegmentLoader_.dispose(),["AUDIO","SUBTITLES"].forEach(function(t){var n=e.mediaTypes_[t].groups;for(var i in n)n[i].forEach(function(e){e.playlistLoader&&e.playlistLoader.dispose()})}),this.audioSegmentLoader_.dispose(),this.subtitleSegmentLoader_.dispose()}},{key:"master",value:function(){return this.masterPlaylistLoader_.master}},{key:"media",value:function(){return this.masterPlaylistLoader_.media()||this.initialMedia_}},{key:"setupSourceBuffers_",value:function(){var e=this.masterPlaylistLoader_.media(),t=void 0;if(e&&"open"===this.mediaSource.readyState){if((t=function(e,t){var n=function(e){return e.segments&&e.segments.length&&e.segments[0].map?"mp4":"mp2t"}(t),i=function(e){var t=e.attributes||{};return t.CODECS?sd(t.CODECS):ad}(t),r=t.attributes||{},a=!0,o=!1;if(!t)return[];if(e.mediaGroups.AUDIO&&r.AUDIO){var s=e.mediaGroups.AUDIO[r.AUDIO];if(s)for(var l in o=!0,a=!1,s)if(!s[l].uri&&!s[l].playlists){a=!0;break}}o&&!i.audioProfile&&(a||(i.audioProfile=function(e,t){if(!e.mediaGroups.AUDIO||!t)return null;var n=e.mediaGroups.AUDIO[t];if(!n)return null;for(var i in n){var r=n[i];if(r.default&&r.playlists)return sd(r.playlists[0].attributes.CODECS).audioProfile}return null}(e,r.AUDIO)),i.audioProfile||(to.log.warn("Multiple audio tracks present but no audio codec string is specified. Attempting to use the default audio codec (mp4a.40.2)"),i.audioProfile=ad.audioProfile));var u={};i.videoCodec&&(u.video=""+i.videoCodec+i.videoObjectTypeIndicator),i.audioProfile&&(u.audio="mp4a.40."+i.audioProfile);var c=ld("audio",n,[u.audio]),d=ld("video",n,[u.video]),h=ld("video",n,[u.video,u.audio]);return o?!a&&u.video?[d,c]:a||u.video?[h,c]:[c,c]:u.video?[h]:[c]}(this.masterPlaylistLoader_.master,e)).length<1)return this.error="No compatible SourceBuffer configuration for the variant stream:"+e.resolvedUri,this.mediaSource.endOfStream("decode");this.configureLoaderMimeTypes_(t),this.excludeIncompatibleVariants_(e)}}},{key:"configureLoaderMimeTypes_",value:function(e){var t=e.length>1&&-1===e[0].indexOf(",")&&e[0]!==e[1]?new to.EventTarget:null;this.mainSegmentLoader_.mimeType(e[0],t),e[1]&&this.audioSegmentLoader_.mimeType(e[1],t)}},{key:"excludeUnsupportedVariants_",value:function(){this.master().playlists.forEach(function(t){var n;t.attributes.CODECS&&e.MediaSource&&e.MediaSource.isTypeSupported&&!e.MediaSource.isTypeSupported('video/mp4; codecs="'+(n=t.attributes.CODECS,n.replace(/avc1\.(\d+)\.(\d+)/i,function(e){return od([e])[0]}))+'"')&&(t.excludeUntil=1/0)})}},{key:"excludeIncompatibleVariants_",value:function(e){var t=2,n=null,i=void 0;e.attributes.CODECS&&(i=sd(e.attributes.CODECS),n=i.videoCodec,t=i.codecCount),this.master().playlists.forEach(function(e){var i={codecCount:2,videoCodec:null};e.attributes.CODECS&&(i=sd(e.attributes.CODECS)),i.codecCount!==t&&(e.excludeUntil=1/0),i.videoCodec!==n&&(e.excludeUntil=1/0)})}},{key:"updateAdCues_",value:function(t){var n=0,i=this.seekable();i.length&&(n=i.start(0)),function(t,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if(t.segments)for(var r=i,a=void 0,o=0;o<t.segments.length;o++){var s=t.segments[o];if(a||(a=qd(n,r+s.duration/2)),a){if("cueIn"in s){a.endTime=r,a.adEndTime=r,r+=s.duration,a=null;continue}if(r<a.endTime){r+=s.duration;continue}a.endTime+=s.duration}else if("cueOut"in s&&((a=new e.VTTCue(r,r+s.duration,s.cueOut)).adStartTime=r,a.adEndTime=r+parseFloat(s.cueOut),n.addCue(a)),"cueOutCont"in s){var l,u,c=s.cueOutCont.split("/").map(parseFloat),d=tc(c,2);l=d[0],u=d[1],(a=new e.VTTCue(r,r+s.duration,"")).adStartTime=r-l,a.adEndTime=a.adStartTime+u,n.addCue(a)}r+=s.duration}}(t,this.cueTagsTrack_,n)}},{key:"goalBufferLength",value:function(){var e=this.tech_.currentTime(),t=Dd.GOAL_BUFFER_LENGTH,n=Dd.GOAL_BUFFER_LENGTH_RATE,i=Math.max(t,Dd.MAX_GOAL_BUFFER_LENGTH);return Math.min(t+e*n,i)}},{key:"bufferLowWaterLine",value:function(){var e=this.tech_.currentTime(),t=Dd.BUFFER_LOW_WATER_LINE,n=Dd.BUFFER_LOW_WATER_LINE_RATE,i=Math.max(t,Dd.MAX_BUFFER_LOW_WATER_LINE);return Math.min(t+e*n,i)}}]),n}(to.EventTarget),sh=["seeking","seeked","pause","playing","error"],lh=function(){function t(n){var i=this;Qu(this,t),this.tech_=n.tech,this.seekable=n.seekable,this.seekTo=n.seekTo,this.allowSeeksWithinUnsafeLiveWindow=n.allowSeeksWithinUnsafeLiveWindow,this.media=n.media,this.consecutiveUpdates=0,this.lastRecordedTime=null,this.timer_=null,this.checkCurrentTimeTimeout_=null,this.logger_=Sd("PlaybackWatcher"),this.logger_("initialize");var r=function(){return i.monitorCurrentTime_()},a=function(){return i.techWaiting_()},o=function(){return i.cancelTimer_()},s=function(){return i.fixesBadSeeks_()};this.tech_.on("seekablechanged",s),this.tech_.on("waiting",a),this.tech_.on(sh,o),this.tech_.on("canplay",r),this.dispose=function(){i.logger_("dispose"),i.tech_.off("seekablechanged",s),i.tech_.off("waiting",a),i.tech_.off(sh,o),i.tech_.off("canplay",r),i.checkCurrentTimeTimeout_&&e.clearTimeout(i.checkCurrentTimeTimeout_),i.cancelTimer_()}}return Ju(t,[{key:"monitorCurrentTime_",value:function(){this.checkCurrentTime_(),this.checkCurrentTimeTimeout_&&e.clearTimeout(this.checkCurrentTimeTimeout_),this.checkCurrentTimeTimeout_=e.setTimeout(this.monitorCurrentTime_.bind(this),250)}},{key:"checkCurrentTime_",value:function(){if(this.tech_.seeking()&&this.fixesBadSeeks_())return this.consecutiveUpdates=0,void(this.lastRecordedTime=this.tech_.currentTime());if(!this.tech_.paused()&&!this.tech_.seeking()){var e=this.tech_.currentTime(),t=this.tech_.buffered();if(this.lastRecordedTime===e&&(!t.length||e+.1>=t.end(t.length-1)))return this.techWaiting_();this.consecutiveUpdates>=5&&e===this.lastRecordedTime?(this.consecutiveUpdates++,this.waiting_()):e===this.lastRecordedTime?this.consecutiveUpdates++:(this.consecutiveUpdates=0,this.lastRecordedTime=e)}}},{key:"cancelTimer_",value:function(){this.consecutiveUpdates=0,this.timer_&&(this.logger_("cancelTimer_"),clearTimeout(this.timer_)),this.timer_=null}},{key:"fixesBadSeeks_",value:function(){if(!this.tech_.seeking())return!1;var e=this.seekable(),t=this.tech_.currentTime(),n=void 0;this.afterSeekableWindow_(e,t,this.media(),this.allowSeeksWithinUnsafeLiveWindow)&&(n=e.end(e.length-1));this.beforeSeekableWindow_(e,t)&&(n=e.start(0)+.1);return void 0!==n&&(this.logger_("Trying to seek outside of seekable at time "+t+" with seekable range "+Uc(e)+". Seeking to "+n+"."),this.seekTo(n),!0)}},{key:"waiting_",value:function(){if(!this.techWaiting_()){var e=this.tech_.currentTime(),t=this.tech_.buffered(),n=Bc(t,e);return n.length&&e+3<=n.end(0)?(this.cancelTimer_(),this.seekTo(e),this.logger_("Stopped at "+e+" while inside a buffered region ["+n.start(0)+" -> "+n.end(0)+"]. Attempting to resume playback by seeking to the current time."),void this.tech_.trigger({type:"usage",name:"hls-unknown-waiting"})):void 0}}},{key:"techWaiting_",value:function(){var e=this.seekable(),t=this.tech_.currentTime();if(this.tech_.seeking()&&this.fixesBadSeeks_())return!0;if(this.tech_.seeking()||null!==this.timer_)return!0;if(this.beforeSeekableWindow_(e,t)){var n=e.end(e.length-1);return this.logger_("Fell out of live window at time "+t+". Seeking to live point (seekable end) "+n),this.cancelTimer_(),this.seekTo(n),this.tech_.trigger({type:"usage",name:"hls-live-resync"}),!0}var i=this.tech_.buffered(),r=Fc(i,t);if(this.videoUnderflow_(r,i,t))return this.cancelTimer_(),this.seekTo(t),this.tech_.trigger({type:"usage",name:"hls-video-underflow"}),!0;if(r.length>0){var a=r.start(0)-t;return this.logger_("Stopped at "+t+", setting timer for "+a+", seeking to "+r.start(0)),this.timer_=setTimeout(this.skipTheGap_.bind(this),1e3*a,t),!0}return!1}},{key:"afterSeekableWindow_",value:function(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(!e.length)return!1;var r=e.end(e.length-1)+.1;return!n.endList&&i&&(r=e.end(e.length-1)+3*n.targetDuration),t>r}},{key:"beforeSeekableWindow_",value:function(e,t){return!!(e.length&&e.start(0)>0&&t<e.start(0)-.1)}},{key:"videoUnderflow_",value:function(e,t,n){if(0===e.length){var i=this.gapFromVideoUnderflow_(t,n);if(i)return this.logger_("Encountered a gap in video from "+i.start+" to "+i.end+". Seeking to current time "+n),!0}return!1}},{key:"skipTheGap_",value:function(e){var t=this.tech_.buffered(),n=this.tech_.currentTime(),i=Fc(t,n);this.cancelTimer_(),0!==i.length&&n===e&&(this.logger_("skipTheGap_:","currentTime:",n,"scheduled currentTime:",e,"nextRange start:",i.start(0)),this.seekTo(i.start(0)+1/30),this.tech_.trigger({type:"usage",name:"hls-gap-skip"}))}},{key:"gapFromVideoUnderflow_",value:function(e,t){for(var n=function(e){if(e.length<2)return to.createTimeRanges();for(var t=[],n=1;n<e.length;n++){var i=e.end(n-1),r=e.start(n);t.push([i,r])}return to.createTimeRanges(t)}(e),i=0;i<n.length;i++){var r=n.start(i),a=n.end(i);if(t-r<4&&t-r>2)return{start:r,end:a}}return null}}]),t}(),uh={errorInterval:30,getSource:function(e){return e(this.tech({IWillNotUseThisInPlugins:!0}).currentSource_)}},ch=function(e){!function e(t,n){var i=0,r=0,a=to.mergeOptions(uh,n);t.ready(function(){t.trigger({type:"usage",name:"hls-error-reload-initialized"})});var o=function(){r&&t.currentTime(r)},s=function(e){null!==e&&void 0!==e&&(r=t.duration()!==1/0&&t.currentTime()||0,t.one("loadedmetadata",o),t.src(e),t.trigger({type:"usage",name:"hls-error-reload"}),t.play())},l=function(){if(Date.now()-i<1e3*a.errorInterval)t.trigger({type:"usage",name:"hls-error-reload-canceled"});else{if(a.getSource&&"function"==typeof a.getSource)return i=Date.now(),a.getSource.call(t,s);to.log.error("ERROR: reloadSourceOnError - The option getSource must be a function!")}},u=function e(){t.off("loadedmetadata",o),t.off("error",l),t.off("dispose",e)};t.on("error",l),t.on("dispose",u),t.reloadSourceOnError=function(n){u(),e(t,n)}}(this,e)};to.use("*",function(e){return{setSource:function(e,t){t(null,e)},setCurrentTime:function(t){return e.vhs&&e.currentSource().src===e.vhs.source_.src&&e.vhs.setCurrentTime(t),t},play:function(){e.vhs&&e.currentSource().src===e.vhs.source_.src&&e.vhs.setCurrentTime(e.tech_.currentTime())}}});var dh={PlaylistLoader:cc,Playlist:Sc,Decrypter:Gu,AsyncStream:Hu,decrypt:Wu,utils:$c,STANDARD_PLAYLIST_SELECTOR:function(){return function(t,n,i,r,a){var o=t.playlists.map(function(t){var n,i;return n=t.attributes.RESOLUTION&&t.attributes.RESOLUTION.width,i=t.attributes.RESOLUTION&&t.attributes.RESOLUTION.height,{bandwidth:t.attributes.BANDWIDTH||e.Number.MAX_VALUE,width:n,height:i,playlist:t}});Kd(o,function(e,t){return e.bandwidth-t.bandwidth});var s=(o=o.filter(function(e){return!Sc.isIncompatible(e.playlist)})).filter(function(e){return Sc.isEnabled(e.playlist)});s.length||(s=o.filter(function(e){return!Sc.isDisabled(e.playlist)}));var l=s.filter(function(e){return e.bandwidth*Dd.BANDWIDTH_VARIANCE<n}),u=l[l.length-1],c=l.filter(function(e){return e.bandwidth===u.bandwidth})[0];if(!1===a){var d=c||s[0]||o[0];return d?d.playlist:null}var h=l.filter(function(e){return e.width&&e.height});Kd(h,function(e,t){return e.width-t.width});var p=h.filter(function(e){return e.width===i&&e.height===r});u=p[p.length-1];var f=p.filter(function(e){return e.bandwidth===u.bandwidth})[0],g=void 0,m=void 0,v=void 0;f||(m=(g=h.filter(function(e){return e.width>i||e.height>r})).filter(function(e){return e.width===g[0].width&&e.height===g[0].height}),u=m[m.length-1],v=m.filter(function(e){return e.bandwidth===u.bandwidth})[0]);var y=v||f||c||s[0]||o[0];return y?y.playlist:null}(this.playlists.master,this.systemBandwidth,parseInt(Md(this.tech_.el(),"width"),10),parseInt(Md(this.tech_.el(),"height"),10),this.limitRenditionByPlayerDimensions)},INITIAL_PLAYLIST_SELECTOR:function(){var e=this.playlists.master.playlists.filter(Sc.isEnabled);return Kd(e,function(e,t){return $d(e,t)}),e.filter(function(e){return sd(e.attributes.CODECS).videoCodec})[0]||null},comparePlaylistBandwidth:$d,comparePlaylistResolution:function(t,n){var i=void 0,r=void 0;return t.attributes.RESOLUTION&&t.attributes.RESOLUTION.width&&(i=t.attributes.RESOLUTION.width),i=i||e.Number.MAX_VALUE,n.attributes.RESOLUTION&&n.attributes.RESOLUTION.width&&(r=n.attributes.RESOLUTION.width),i===(r=r||e.Number.MAX_VALUE)&&t.attributes.BANDWIDTH&&n.attributes.BANDWIDTH?t.attributes.BANDWIDTH-n.attributes.BANDWIDTH:i-r},xhr:Dc()};["GOAL_BUFFER_LENGTH","MAX_GOAL_BUFFER_LENGTH","GOAL_BUFFER_LENGTH_RATE","BUFFER_LOW_WATER_LINE","MAX_BUFFER_LOW_WATER_LINE","BUFFER_LOW_WATER_LINE_RATE","BANDWIDTH_VARIANCE"].forEach(function(e){Object.defineProperty(dh,e,{get:function(){return to.log.warn("using Hls."+e+" is UNSAFE be sure you know what you are doing"),Dd[e]},set:function(t){to.log.warn("using Hls."+e+" is UNSAFE be sure you know what you are doing"),"number"!=typeof t||t<0?to.log.warn("value of Hls."+e+" must be greater than or equal to 0"):Dd[e]=t}})});var hh=function(e){return/^(audio|video|application)\/(x-|vnd\.apple\.)?mpegurl/i.test(e)?"hls":/^application\/dash\+xml/i.test(e)?"dash":null},ph=function(e,t){for(var n=t.media(),i=-1,r=0;r<e.length;r++)if(e[r].id===n.uri){i=r;break}e.selectedIndex_=i,e.trigger({selectedIndex:i,type:"change"})};dh.canPlaySource=function(){return to.log.warn("HLS is no longer a tech. Please remove it from your player's techOrder.")};var fh,gh=function(){if(!window.localStorage)return null;var e=window.localStorage.getItem("videojs-vhs");if(!e)return null;try{return JSON.parse(e)}catch(e){return null}};dh.supportsNativeHls=(fh=t.createElement("video"),!!to.getTech("Html5").isSupported()&&["application/vnd.apple.mpegurl","audio/mpegurl","audio/x-mpegurl","application/x-mpegurl","video/x-mpegurl","video/mpegurl","application/mpegurl"].some(function(e){return/maybe|probably/i.test(fh.canPlayType(e))})),dh.supportsNativeDash=!!to.getTech("Html5").isSupported()&&/maybe|probably/i.test(t.createElement("video").canPlayType("application/dash+xml")),dh.supportsTypeNatively=function(e){return"hls"===e?dh.supportsNativeHls:"dash"===e&&dh.supportsNativeDash},dh.isSupported=function(){return to.log.warn("HLS is no longer a tech. Please remove it from your player's techOrder.")};var mh=function(e){function n(e,i,r){Qu(this,n);var a=ec(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,i,r.hls));if(i.options_&&i.options_.playerId){var o=to(i.options_.playerId);o.hasOwnProperty("hls")||Object.defineProperty(o,"hls",{get:function(){return to.log.warn("player.hls is deprecated. Use player.tech().hls instead."),i.trigger({type:"usage",name:"hls-player-access"}),a},configurable:!0}),o.vhs=a,o.dash=a,a.player_=o}if(a.tech_=i,a.source_=e,a.stats={},a.setOptions_(),a.options_.overrideNative&&i.overrideNativeAudioTracks&&i.overrideNativeVideoTracks)i.overrideNativeAudioTracks(!0),i.overrideNativeVideoTracks(!0);else if(a.options_.overrideNative&&(i.featuresNativeVideoTracks||i.featuresNativeAudioTracks))throw new Error("Overriding native HLS requires emulated tracks. See https://git.io/vMpjB");return a.on(t,["fullscreenchange","webkitfullscreenchange","mozfullscreenchange","MSFullscreenChange"],function(e){var n=t.fullscreenElement||t.webkitFullscreenElement||t.mozFullScreenElement||t.msFullscreenElement;n&&n.contains(a.tech_.el())&&a.masterPlaylistController_.smoothQualityChange_()}),a.on(a.tech_,"seeking",function(){0===this.tech_.currentTime()&&this.tech_.player_.loop()&&this.setCurrentTime(0)}),a.on(a.tech_,"error",function(){this.masterPlaylistController_&&this.masterPlaylistController_.pauseLoading()}),a.on(a.tech_,"play",a.play),a}return Zu(n,e),Ju(n,[{key:"setOptions_",value:function(){var e=this;if(this.options_.withCredentials=this.options_.withCredentials||!1,this.options_.handleManifestRedirects=this.options_.handleManifestRedirects||!1,this.options_.limitRenditionByPlayerDimensions=!1!==this.options_.limitRenditionByPlayerDimensions,this.options_.smoothQualityChange=this.options_.smoothQualityChange||!1,this.options_.useBandwidthFromLocalStorage=void 0!==this.source_.useBandwidthFromLocalStorage?this.source_.useBandwidthFromLocalStorage:this.options_.useBandwidthFromLocalStorage||!1,this.options_.customTagParsers=this.options_.customTagParsers||[],this.options_.customTagMappers=this.options_.customTagMappers||[],this.options_.cacheEncryptionKeys=this.options_.cacheEncryptionKeys||!1,"number"!=typeof this.options_.blacklistDuration&&(this.options_.blacklistDuration=300),"number"!=typeof this.options_.bandwidth&&this.options_.useBandwidthFromLocalStorage){var t=gh();t&&t.bandwidth&&(this.options_.bandwidth=t.bandwidth,this.tech_.trigger({type:"usage",name:"hls-bandwidth-from-local-storage"})),t&&t.throughput&&(this.options_.throughput=t.throughput,this.tech_.trigger({type:"usage",name:"hls-throughput-from-local-storage"}))}"number"!=typeof this.options_.bandwidth&&(this.options_.bandwidth=Dd.INITIAL_BANDWIDTH),this.options_.enableLowInitialPlaylist=this.options_.enableLowInitialPlaylist&&this.options_.bandwidth===Dd.INITIAL_BANDWIDTH,["withCredentials","limitRenditionByPlayerDimensions","bandwidth","smoothQualityChange","customTagParsers","customTagMappers","handleManifestRedirects","cacheEncryptionKeys"].forEach(function(t){void 0!==e.source_[t]&&(e.options_[t]=e.source_[t])}),this.limitRenditionByPlayerDimensions=this.options_.limitRenditionByPlayerDimensions}},{key:"src",value:function(e,t){var n=this;e&&(this.setOptions_(),this.options_.url=this.source_.src,this.options_.tech=this.tech_,this.options_.externHls=dh,this.options_.sourceType=hh(t),this.options_.seekTo=function(e){n.tech_.setCurrentTime(e),n.setCurrentTime(e)},this.masterPlaylistController_=new oh(this.options_),this.playbackWatcher_=new lh(to.mergeOptions(this.options_,{seekable:function(){return n.seekable()},media:function(){return n.masterPlaylistController_.media()}})),this.masterPlaylistController_.on("error",function(){to.players[n.tech_.options_.playerId].error(n.masterPlaylistController_.error)}),this.masterPlaylistController_.selectPlaylist=this.selectPlaylist?this.selectPlaylist.bind(this):dh.STANDARD_PLAYLIST_SELECTOR.bind(this),this.masterPlaylistController_.selectInitialPlaylist=dh.INITIAL_PLAYLIST_SELECTOR.bind(this),this.playlists=this.masterPlaylistController_.masterPlaylistLoader_,this.mediaSource=this.masterPlaylistController_.mediaSource,Object.defineProperties(this,{selectPlaylist:{get:function(){return this.masterPlaylistController_.selectPlaylist},set:function(e){this.masterPlaylistController_.selectPlaylist=e.bind(this)}},throughput:{get:function(){return this.masterPlaylistController_.mainSegmentLoader_.throughput.rate},set:function(e){this.masterPlaylistController_.mainSegmentLoader_.throughput.rate=e,this.masterPlaylistController_.mainSegmentLoader_.throughput.count=1}},bandwidth:{get:function(){return this.masterPlaylistController_.mainSegmentLoader_.bandwidth},set:function(e){this.masterPlaylistController_.mainSegmentLoader_.bandwidth=e,this.masterPlaylistController_.mainSegmentLoader_.throughput={rate:0,count:0}}},systemBandwidth:{get:function(){var e,t=1/(this.bandwidth||1);return e=this.throughput>0?1/this.throughput:0,Math.floor(1/(t+e))},set:function(){to.log.error('The "systemBandwidth" property is read-only')}}}),this.options_.bandwidth&&(this.bandwidth=this.options_.bandwidth),this.options_.throughput&&(this.throughput=this.options_.throughput),Object.defineProperties(this.stats,{bandwidth:{get:function(){return n.bandwidth||0},enumerable:!0},mediaRequests:{get:function(){return n.masterPlaylistController_.mediaRequests_()||0},enumerable:!0},mediaRequestsAborted:{get:function(){return n.masterPlaylistController_.mediaRequestsAborted_()||0},enumerable:!0},mediaRequestsTimedout:{get:function(){return n.masterPlaylistController_.mediaRequestsTimedout_()||0},enumerable:!0},mediaRequestsErrored:{get:function(){return n.masterPlaylistController_.mediaRequestsErrored_()||0},enumerable:!0},mediaTransferDuration:{get:function(){return n.masterPlaylistController_.mediaTransferDuration_()||0},enumerable:!0},mediaBytesTransferred:{get:function(){return n.masterPlaylistController_.mediaBytesTransferred_()||0},enumerable:!0},mediaSecondsLoaded:{get:function(){return n.masterPlaylistController_.mediaSecondsLoaded_()||0},enumerable:!0},buffered:{get:function(){return Vc(n.tech_.buffered())},enumerable:!0},currentTime:{get:function(){return n.tech_.currentTime()},enumerable:!0},currentSource:{get:function(){return n.tech_.currentSource_},enumerable:!0},currentTech:{get:function(){return n.tech_.name_},enumerable:!0},duration:{get:function(){return n.tech_.duration()},enumerable:!0},master:{get:function(){return n.playlists.master},enumerable:!0},playerDimensions:{get:function(){return n.tech_.currentDimensions()},enumerable:!0},seekable:{get:function(){return Vc(n.tech_.seekable())},enumerable:!0},timestamp:{get:function(){return Date.now()},enumerable:!0},videoPlaybackQuality:{get:function(){return n.tech_.getVideoPlaybackQuality()},enumerable:!0}}),this.tech_.one("canplay",this.masterPlaylistController_.setupFirstPlay.bind(this.masterPlaylistController_)),this.tech_.on("bandwidthupdate",function(){n.options_.useBandwidthFromLocalStorage&&function(e){if(!window.localStorage)return!1;var t=gh();t=t?to.mergeOptions(t,e):e;try{window.localStorage.setItem("videojs-vhs",JSON.stringify(t))}catch(e){return!1}}({bandwidth:n.bandwidth,throughput:Math.round(n.throughput)})}),this.masterPlaylistController_.on("selectedinitialmedia",function(){var e,t;t=(e=n).playlists,e.representations=function(){return t.master.playlists.filter(function(e){return!Ec(e)}).map(function(t,n){return new function e(t,n,i){Qu(this,e);var r,a,o,s=t.masterPlaylistController_,l=s[(t.options_.smoothQualityChange?"smooth":"fast")+"QualityChange_"].bind(s);if(n.attributes.RESOLUTION){var u=n.attributes.RESOLUTION;this.width=u.width,this.height=u.height}this.bandwidth=n.attributes.BANDWIDTH,this.id=i,this.enabled=(r=t.playlists,a=n.uri,o=l,function(e){var t=r.master.playlists[a],n=Ec(t),i=Cc(t);return void 0===e?i:(e?delete t.disabled:t.disabled=!0,e===i||n||(o(),e?r.trigger("renditionenabled"):r.trigger("renditiondisabled")),e)})}(e,t,t.uri)})},function(e){if("dash"===e.options_.sourceType){var t=to.players[e.tech_.options_.playerId];if(t.eme){var n=function(e,t,n){if(!e)return e;var i={};for(var r in e)i[r]={audioContentType:'audio/mp4; codecs="'+n.attributes.CODECS+'"',videoContentType:'video/mp4; codecs="'+t.attributes.CODECS+'"'},t.contentProtection&&t.contentProtection[r]&&t.contentProtection[r].pssh&&(i[r].pssh=t.contentProtection[r].pssh),"string"==typeof e[r]&&(i[r].url=e[r]);return to.mergeOptions(e,i)}(e.source_.keySystems,e.playlists.media(),e.masterPlaylistController_.mediaTypes_.AUDIO.activePlaylistLoader.media());n&&(t.currentSource().keySystems=n,t.eme.initializeMediaKeys&&t.eme.initializeMediaKeys())}}}(n)}),this.on(this.masterPlaylistController_,"progress",function(){this.tech_.trigger("progress")}),this.tech_.ready(function(){return n.setupQualityLevels_()}),this.tech_.el()&&this.tech_.src(to.URL.createObjectURL(this.masterPlaylistController_.mediaSource)))}},{key:"setupQualityLevels_",value:function(){var e=this,t=to.players[this.tech_.options_.playerId];t&&t.qualityLevels&&(this.qualityLevels_=t.qualityLevels(),this.masterPlaylistController_.on("selectedinitialmedia",function(){var t,n;t=e.qualityLevels_,(n=e).representations().forEach(function(e){t.addQualityLevel(e)}),ph(t,n.playlists)}),this.playlists.on("mediachange",function(){ph(e.qualityLevels_,e.playlists)}))}},{key:"play",value:function(){this.masterPlaylistController_.play()}},{key:"setCurrentTime",value:function(e){this.masterPlaylistController_.setCurrentTime(e)}},{key:"duration",value:function(){return this.masterPlaylistController_.duration()}},{key:"seekable",value:function(){return this.masterPlaylistController_.seekable()}},{key:"dispose",value:function(){this.playbackWatcher_&&this.playbackWatcher_.dispose(),this.masterPlaylistController_&&this.masterPlaylistController_.dispose(),this.qualityLevels_&&this.qualityLevels_.dispose(),this.player_&&(delete this.player_.vhs,delete this.player_.dash,delete this.player_.hls),this.tech_&&this.tech_.hls&&delete this.tech_.hls,function e(t,n,i){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,n);if(void 0===r){var a=Object.getPrototypeOf(t);return null===a?void 0:e(a,n,i)}if("value"in r)return r.value;var o=r.get;return void 0!==o?o.call(i):void 0}(n.prototype.__proto__||Object.getPrototypeOf(n.prototype),"dispose",this).call(this)}},{key:"convertToProgramTime",value:function(e,t){return function(e){var t=e.playlist,n=e.time,i=void 0===n?void 0:n,r=e.callback;if(!r)throw new Error("getProgramTime: callback must be provided");if(!t||void 0===i)return r({message:"getProgramTime: playlist and time must be provided"});var a=function(e,t){if(!t||!t.segments||0===t.segments.length)return null;for(var n=0,i=void 0,r=0;r<t.segments.length&&!(e<=(n=(i=t.segments[r]).videoTimingInfo?i.videoTimingInfo.transmuxedPresentationEnd:n+i.duration));r++);var a=t.segments[t.segments.length-1];if(a.videoTimingInfo&&a.videoTimingInfo.transmuxedPresentationEnd<e)return null;if(e>n){if(e>n+.25*a.duration)return null;i=a}return{segment:i,estimatedStart:i.videoTimingInfo?i.videoTimingInfo.transmuxedPresentationStart:n-i.duration,type:i.videoTimingInfo?"accurate":"estimate"}}(i,t);if(!a)return r({message:"valid programTime was not found"});if("estimate"===a.type)return r({message:"Accurate programTime could not be determined. Please seek to e.seekTime and try again",seekTime:a.estimatedStart});var o={mediaSeconds:i},s=function(e,t){if(!t.dateTimeObject)return null;var n=t.videoTimingInfo.transmuxerPrependedSeconds,i=e-(t.videoTimingInfo.transmuxedPresentationStart+n);return new Date(t.dateTimeObject.getTime()+1e3*i)}(i,a.segment);return s&&(o.programDateTime=s.toISOString()),r(null,o)}({playlist:this.masterPlaylistController_.media(),time:e,callback:t})}},{key:"seekToProgramTime",value:function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2;return function e(t){var n=t.programTime,i=t.playlist,r=t.retryCount,a=void 0===r?2:r,o=t.seekTo,s=t.pauseAfterSeek,l=void 0===s||s,u=t.tech,c=t.callback;if(!c)throw new Error("seekToProgramTime: callback must be provided");if(void 0===n||!i||!o)return c({message:"seekToProgramTime: programTime, seekTo and playlist must be provided"});if(!i.endList&&!u.hasStarted_)return c({message:"player must be playing a live stream to start buffering"});if(!function(e){if(!e.segments||0===e.segments.length)return!1;for(var t=0;t<e.segments.length;t++)if(!e.segments[t].dateTimeObject)return!1;return!0}(i))return c({message:"programDateTime tags must be provided in the manifest "+i.resolvedUri});var d=function(e,t){var n=void 0;try{n=new Date(e)}catch(e){return null}if(!t||!t.segments||0===t.segments.length)return null;var i=t.segments[0];if(n<i.dateTimeObject)return null;for(var r=0;r<t.segments.length-1&&(i=t.segments[r],!(n<t.segments[r+1].dateTimeObject));r++);var a,o=t.segments[t.segments.length-1],s=o.dateTimeObject,l=o.videoTimingInfo?(a=o.videoTimingInfo).transmuxedPresentationEnd-a.transmuxedPresentationStart-a.transmuxerPrependedSeconds:o.duration+.25*o.duration;return n>new Date(s.getTime()+1e3*l)?null:(n>s&&(i=o),{segment:i,estimatedStart:i.videoTimingInfo?i.videoTimingInfo.transmuxedPresentationStart:Sc.duration(t,t.mediaSequence+t.segments.indexOf(i)),type:i.videoTimingInfo?"accurate":"estimate"})}(n,i);if(!d)return c({message:n+" was not found in the stream"});var h=d.segment,p=function(e,t){var n=void 0,i=void 0;try{n=new Date(e),i=new Date(t)}catch(e){}var r=n.getTime();return(i.getTime()-r)/1e3}(h.dateTimeObject,n);if("estimate"===d.type)return 0===a?c({message:n+" is not buffered yet. Try again"}):(o(d.estimatedStart+p),void u.one("seeked",function(){e({programTime:n,playlist:i,retryCount:a-1,seekTo:o,pauseAfterSeek:l,tech:u,callback:c})}));var f=h.start+p;u.one("seeked",function(){return c(null,u.currentTime())}),l&&u.pause(),o(f)}({programTime:e,playlist:this.masterPlaylistController_.media(),retryCount:i,pauseAfterSeek:n,seekTo:this.options_.seekTo,tech:this.options_.tech,callback:t})}}]),n}(to.getComponent("Component")),vh={name:"videojs-http-streaming",VERSION:"1.10.3",canHandleSource:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=to.mergeOptions(to.options,t);return vh.canPlayType(e.type,n)},handleSource:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=to.mergeOptions(to.options,n);return t.hls=new mh(e,t,i),t.hls.xhr=Dc(),t.hls.src(e.src,e.type),t.hls},canPlayType:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=to.mergeOptions(to.options,t).hls.overrideNative,i=hh(e);return i&&(!dh.supportsTypeNatively(i)||n)?"maybe":""}};return void 0!==to.MediaSource&&void 0!==to.URL||(to.MediaSource=vd,to.URL=yd),vd.supportsNativeMediaSources()&&to.getTech("Html5").registerSourceHandler(vh,0),to.HlsHandler=mh,to.HlsSourceHandler=vh,to.Hls=dh,to.use||to.registerComponent("Hls",dh),to.options.hls=to.options.hls||{},to.registerPlugin?to.registerPlugin("reloadSourceOnError",ch):to.plugin("reloadSourceOnError",ch),to}(n(21),n(22)),e.exports=function(e){"use strict";var t,n,i,r,a,o,s,l,u=e.browser.IS_IOS||e.browser.IS_ANDROID,c=e.getTech("Tech"),d=e.extend(c,{constructor:function(e,t){c.call(this,e,t),this.setPoster(e.poster),this.setSrc(this.options_.source,!0),this.setTimeout(function(){this.el_&&(this.el_.parentNode.className+=" vjs-youtube",u&&(this.el_.parentNode.className+=" vjs-youtube-mobile"),d.isApiReady?this.initYTPlayer():d.apiReadyQueue.push(this))}.bind(this))},dispose:function(){if(this.ytPlayer)this.ytPlayer.stopVideo&&this.ytPlayer.stopVideo(),this.ytPlayer.destroy&&this.ytPlayer.destroy();else{var e=d.apiReadyQueue.indexOf(this);-1!==e&&d.apiReadyQueue.splice(e,1)}this.ytPlayer=null,this.el_.parentNode.className=this.el_.parentNode.className.replace(" vjs-youtube","").replace(" vjs-youtube-mobile",""),this.el_.parentNode.removeChild(this.el_),c.prototype.dispose.call(this)},createEl:function(){var e=document.createElement("div");e.setAttribute("id",this.options_.techId),e.setAttribute("style","width:100%;height:100%;top:0;left:0;position:absolute"),e.setAttribute("class","vjs-tech");var t=document.createElement("div");if(t.appendChild(e),!u&&!this.options_.ytControls){var n=document.createElement("div");n.setAttribute("class","vjs-iframe-blocker"),n.setAttribute("style","position:absolute;top:0;left:0;width:100%;height:100%"),n.onclick=function(){this.pause()}.bind(this),t.appendChild(n)}return t},initYTPlayer:function(){var e={controls:0,modestbranding:1,rel:0,showinfo:0,loop:this.options_.loop?1:0};if(void 0!==this.options_.autohide&&(e.autohide=this.options_.autohide),void 0!==this.options_.cc_load_policy&&(e.cc_load_policy=this.options_.cc_load_policy),void 0!==this.options_.ytControls&&(e.controls=this.options_.ytControls),void 0!==this.options_.disablekb&&(e.disablekb=this.options_.disablekb),void 0!==this.options_.end&&(e.end=this.options_.end),void 0!==this.options_.color&&(e.color=this.options_.color),e.controls?void 0!==this.options_.fs&&(e.fs=this.options_.fs):e.fs=0,void 0!==this.options_.end&&(e.end=this.options_.end),void 0!==this.options_.hl?e.hl=this.options_.hl:void 0!==this.options_.language&&(e.hl=this.options_.language.substr(0,2)),void 0!==this.options_.iv_load_policy&&(e.iv_load_policy=this.options_.iv_load_policy),void 0!==this.options_.list?e.list=this.options_.list:this.url&&void 0!==this.url.listId&&(e.list=this.url.listId),void 0!==this.options_.listType&&(e.listType=this.options_.listType),void 0!==this.options_.modestbranding&&(e.modestbranding=this.options_.modestbranding),void 0!==this.options_.playlist&&(e.playlist=this.options_.playlist),void 0!==this.options_.playsinline&&(e.playsinline=this.options_.playsinline),void 0!==this.options_.rel&&(e.rel=this.options_.rel),void 0!==this.options_.showinfo&&(e.showinfo=this.options_.showinfo),void 0!==this.options_.start&&(e.start=this.options_.start),void 0!==this.options_.theme&&(e.theme=this.options_.theme),void 0!==this.options_.customVars){var t=this.options_.customVars;Object.keys(t).forEach(function(n){e[n]=t[n]})}this.activeVideoId=this.url?this.url.videoId:null,this.activeList=e.list,this.ytPlayer=new YT.Player(this.options_.techId,{videoId:this.activeVideoId,playerVars:e,events:{onReady:this.onPlayerReady.bind(this),onPlaybackQualityChange:this.onPlayerPlaybackQualityChange.bind(this),onPlaybackRateChange:this.onPlayerPlaybackRateChange.bind(this),onStateChange:this.onPlayerStateChange.bind(this),onVolumeChange:this.onPlayerVolumeChange.bind(this),onError:this.onPlayerError.bind(this)}})},onPlayerReady:function(){this.options_.muted&&this.ytPlayer.mute(),this.ytPlayer.getAvailablePlaybackRates().length>1&&(this.featuresPlaybackRate=!0),this.playerReady_=!0,this.triggerReady(),this.playOnReady?this.play():this.cueOnReady&&(this.cueVideoById_(this.url.videoId),this.activeVideoId=this.url.videoId)},onPlayerPlaybackQualityChange:function(){},onPlayerPlaybackRateChange:function(){this.trigger("ratechange")},onPlayerStateChange:function(e){var t=e.data;if(t!==this.lastState&&!this.errorNumber)switch(this.lastState=t,t){case-1:this.trigger("loadstart"),this.trigger("loadedmetadata"),this.trigger("durationchange"),this.trigger("ratechange");break;case YT.PlayerState.ENDED:this.trigger("ended");break;case YT.PlayerState.PLAYING:this.trigger("timeupdate"),this.trigger("durationchange"),this.trigger("playing"),this.trigger("play"),this.isSeeking&&this.onSeeked();break;case YT.PlayerState.PAUSED:this.trigger("canplay"),this.isSeeking?this.onSeeked():this.trigger("pause");break;case YT.PlayerState.BUFFERING:this.player_.trigger("timeupdate"),this.player_.trigger("waiting")}},onPlayerVolumeChange:function(){this.trigger("volumechange")},onPlayerError:function(e){this.errorNumber=e.data,this.trigger("pause"),this.trigger("error")},error:function(){var e=1e3+this.errorNumber;switch(this.errorNumber){case 5:return{code:e,message:"Error while trying to play the video"};case 2:case 100:return{code:e,message:"Unable to find the video"};case 101:case 150:return{code:e,message:"Playback on other Websites has been disabled by the video owner."}}return{code:e,message:"YouTube unknown error ("+this.errorNumber+")"}},loadVideoById_:function(e){var t={videoId:e};this.options_.start&&(t.startSeconds=this.options_.start),this.options_.end&&(t.endEnd=this.options_.end),this.ytPlayer.loadVideoById(t)},cueVideoById_:function(e){var t={videoId:e};this.options_.start&&(t.startSeconds=this.options_.start),this.options_.end&&(t.endEnd=this.options_.end),this.ytPlayer.cueVideoById(t)},src:function(e){return e&&this.setSrc({src:e}),this.source},poster:function(){return u?null:this.poster_},setPoster:function(e){this.poster_=e},setSrc:function(e){e&&e.src&&(delete this.errorNumber,this.source=e,this.url=d.parseUrl(e.src),this.options_.poster||this.url.videoId&&(this.poster_="https://img.youtube.com/vi/"+this.url.videoId+"/0.jpg",this.trigger("posterchange"),this.checkHighResPoster()),this.options_.autoplay&&!u?this.isReady_?this.play():this.playOnReady=!0:this.activeVideoId!==this.url.videoId&&(this.isReady_?(this.cueVideoById_(this.url.videoId),this.activeVideoId=this.url.videoId):this.cueOnReady=!0))},autoplay:function(){return this.options_.autoplay},setAutoplay:function(e){this.options_.autoplay=e},loop:function(){return this.options_.loop},setLoop:function(e){this.options_.loop=e},play:function(){this.url&&this.url.videoId&&(this.wasPausedBeforeSeek=!1,this.isReady_?(this.url.listId&&(this.activeList===this.url.listId?this.ytPlayer.playVideo():(this.ytPlayer.loadPlaylist(this.url.listId),this.activeList=this.url.listId)),this.activeVideoId===this.url.videoId?this.ytPlayer.playVideo():(this.loadVideoById_(this.url.videoId),this.activeVideoId=this.url.videoId)):(this.trigger("waiting"),this.playOnReady=!0))},pause:function(){this.ytPlayer&&this.ytPlayer.pauseVideo()},paused:function(){return!this.ytPlayer||this.lastState!==YT.PlayerState.PLAYING&&this.lastState!==YT.PlayerState.BUFFERING},currentTime:function(){return this.ytPlayer?this.ytPlayer.getCurrentTime():0},setCurrentTime:function(e){this.lastState===YT.PlayerState.PAUSED&&(this.timeBeforeSeek=this.currentTime()),this.isSeeking||(this.wasPausedBeforeSeek=this.paused()),this.ytPlayer.seekTo(e,!0),this.trigger("timeupdate"),this.trigger("seeking"),this.isSeeking=!0,this.lastState===YT.PlayerState.PAUSED&&this.timeBeforeSeek!==e&&(clearInterval(this.checkSeekedInPauseInterval),this.checkSeekedInPauseInterval=setInterval(function(){this.lastState===YT.PlayerState.PAUSED&&this.isSeeking?this.currentTime()!==this.timeBeforeSeek&&(this.trigger("timeupdate"),this.onSeeked()):clearInterval(this.checkSeekedInPauseInterval)}.bind(this),250))},seeking:function(){return this.isSeeking},seekable:function(){return this.ytPlayer?e.createTimeRange(0,this.ytPlayer.getDuration()):e.createTimeRange()},onSeeked:function(){clearInterval(this.checkSeekedInPauseInterval),this.isSeeking=!1,this.wasPausedBeforeSeek&&this.pause(),this.trigger("seeked")},playbackRate:function(){return this.ytPlayer?this.ytPlayer.getPlaybackRate():1},setPlaybackRate:function(e){this.ytPlayer&&this.ytPlayer.setPlaybackRate(e)},duration:function(){return this.ytPlayer?this.ytPlayer.getDuration():0},currentSrc:function(){return this.source&&this.source.src},ended:function(){return!!this.ytPlayer&&this.lastState===YT.PlayerState.ENDED},volume:function(){return this.ytPlayer?this.ytPlayer.getVolume()/100:1},setVolume:function(e){this.ytPlayer&&this.ytPlayer.setVolume(100*e)},muted:function(){return!!this.ytPlayer&&this.ytPlayer.isMuted()},setMuted:function(e){this.ytPlayer&&(this.muted(!0),e?this.ytPlayer.mute():this.ytPlayer.unMute(),this.setTimeout(function(){this.trigger("volumechange")},50))},buffered:function(){if(!this.ytPlayer||!this.ytPlayer.getVideoLoadedFraction)return e.createTimeRange();var t=this.ytPlayer.getVideoLoadedFraction()*this.ytPlayer.getDuration();return e.createTimeRange(0,t)},preload:function(){},load:function(){},reset:function(){},supportsFullScreen:function(){return!0},checkHighResPoster:function(){var e="https://img.youtube.com/vi/"+this.url.videoId+"/maxresdefault.jpg";try{var t=new Image;t.onload=function(){if("naturalHeight"in t){if(t.naturalHeight<=90||t.naturalWidth<=120)return}else if(t.height<=90||t.width<=120)return;this.poster_=e,this.trigger("posterchange")}.bind(this),t.onerror=function(){},t.src=e}catch(e){}}});d.isSupported=function(){return!0},d.canPlaySource=function(e){return d.canPlayType(e.type)},d.canPlayType=function(e){return"video/youtube"===e},d.parseUrl=function(e){var t={videoId:null},n=e.match(/^.*(youtu.be\/|v\/|u\/\w\/|embed\/|watch\?v=|\&v=)([^#\&\?]*).*/);return n&&11===n[2].length&&(t.videoId=n[2]),(n=e.match(/[?&]list=([^#\&\?]+)/))&&n[1]&&(t.listId=n[1]),t},d.apiReadyQueue=[],"undefined"!=typeof document&&(r="https://www.youtube.com/iframe_api",a=function(){YT.ready(function(){d.isApiReady=!0;for(var e=0;e<d.apiReadyQueue.length;++e)d.apiReadyQueue[e].initYTPlayer()})},o=!1,s=document.createElement("script"),(l=document.getElementsByTagName("script")[0]).parentNode.insertBefore(s,l),s.onload=function(){o||(o=!0,a())},s.onreadystatechange=function(){o||"complete"!==this.readyState&&"loaded"!==this.readyState||(o=!0,a())},s.src=r,t=".vjs-youtube .vjs-iframe-blocker { display: none; }.vjs-youtube.vjs-user-inactive .vjs-iframe-blocker { display: block; }.vjs-youtube .vjs-poster { background-size: cover; }.vjs-youtube-mobile .vjs-big-play-button { display: none; }",n=document.head||document.getElementsByTagName("head")[0],(i=document.createElement("style")).type="text/css",i.styleSheet?i.styleSheet.cssText=t:i.appendChild(document.createTextNode(t)),n.appendChild(i)),void 0!==e.registerTech?e.registerTech("Youtube",d):e.registerComponent("Youtube",d)}(n(43)),org.ekstep.pluginframework.pluginManager.registerPlugin({id:"org.ekstep.video",ver:"1.5",author:"",title:"Video Plugin",description:"",publishedDate:"",type:"widget",editor:{main:"editor/plugin.js",menu:[{id:"videoPlugin",category:"main",type:"icon",toolTip:"Add Video",title:"Add Video",iconClass:"fa fa-play-circle-o",iconStyle:"",onclick:{id:"org.ekstep.video:assetbrowser:open"}}],dependencies:[{type:"css",src:"editor/videobrowser.css"},{type:"js",src:"editor/libs/video.js"},{type:"js",src:"editor/libs/videoyoutube.js"},{type:"css",src:"editor/libs/videojs.css"},{type:"plugin",plugin:"org.ekstep.assetbrowser",ver:"1.4"}],views:[{template:"./video.html",controller:"./videoapp.js"}],configManifest:[{propertyName:"autoplay",title:"Auto Play",description:"Auto play the video?",dataType:"boolean",defaultValue:!0},{propertyName:"controls",title:"Show Controls",description:"Show the play/pause controls on video?",dataType:"boolean",defaultValue:!0},{propertyName:"muted",title:"Mute Audio",description:"Mute the audio?",dataType:"boolean",required:!1}],help:{src:"editor/help.md",dataType:"text"},playable:!0,"init-data":{y:7.9,x:10.97,w:78.4,h:79.51,config:{autoplay:!0,controls:!1,muted:!1,visible:!0}}},renderer:{main:"renderer/videoplugin.js",dependencies:[{type:"js",src:"renderer/libs/video.js"},{type:"js",src:"renderer/libs/videoyoutube.js"},{type:"css",src:"renderer/libs/videojs.css"}],compatibilityVersion:4}},org.ekstep.contenteditor.basePlugin.extend({screenShot:void 0,initialize:function(){ecEditor.addEventListener(this.manifest.id+":assetbrowser:open",this.openBrowser,this),ecEditor.resolvePluginResource(this.manifest.id,this.manifest.ver,"editor/video.html"),ecEditor.resolvePluginResource(this.manifest.id,this.manifest.ver,"editor/videoapp.js"),ecEditor.getService("popup").loadNgModules(n(44),n(45),!0)},newInstance:function(){var e=this,t=this.parent,n=(this.parent=void 0,this.convertToFabric(this.attributes)),i=(this.editorObj=void 0,(i=this.media?this.media[this.attributes.asset]:void 0)&&i.src||console.log("media is not defined"),i&&i.src&&(i.src=this.isYoutubeURL(i.src)?i.src:ecEditor.getMediaReverseProxyURL(i.src)),ecEditor.resolvePluginResource(this.manifest.id,this.manifest.ver,"assets/maxresdefault.png"));i=ecEditor.getConfig("useProxyForURL")?"image/get/"+encodeURIComponent(i):i,fabric.Image.fromURL(i,function(n){e.editorObj=n,e.parent=t,e.postInit()},n)},openBrowser:function(){var e=this;ecEditor.dispatchEvent("org.ekstep.assetbrowser:show",{type:"video",search_filter:{},callback:function(t){t.y=7.9,t.x=10.97,t.w=78.4,t.h=79.51,t.config={autoplay:!0,controls:!0,muted:!1,visible:!0},ecEditor.dispatchEvent(e.manifest.id+":create",t)}})},getMedia:function(){var e=this,t={},n=e.getConfig().url||e.media[e.attributes.asset].src,i=e.isYoutubeURL(n);return t[e.attributes.asset||e.id]=i?{id:e.attributes.asset||e.id,src:n||"",assetId:e.attributes.asset,type:"youtube"}:{id:e.attributes.asset||e.id,src:n||"",type:"video"},t},isYoutubeURL:function(e){return!!e.match(/^(?:https?:\/\/)?(?:m\.|www\.)?(?:youtu\.be\/|youtube\.com\/(?:embed\/|v\/|watch\?v=|watch\?.+&v=))((\w|-){11})(?:\S+)?$/)},getYoutube:function(e,t,n,i){t={request:{filters:{objectType:"Content",mimeType:"video/x-youtube",status:["Live"],license:"Creative Commons Attribution (CC BY)"},limit:t,offset:n}},org.ekstep.contenteditor.api._.isUndefined(e)||(t.request.query=e),ecEditor.getService("search").search(t,function(e,t){e||"OK"!=t.data.responseCode?i(e,null):i(null,t)})},getPragmaValue:function(){var e=this;return e.isYoutubeURL(e.getConfig().url||e.media[e.attributes.asset].src)?"external":null},getCopy:function(){var e=this._super();return e.assetMedia=this.media[this.attributes.asset],e},getConfigManifest:function(){var e=this._super();return ecEditor._.remove(e,function(e){return"stroke"===e.propertyName||"visible"===e.propertyName}),e}}))},function(e,t){},function(e,t,n){
/**
 * @license
 * Video.js 7.6.2 <http://videojs.com/>
 * Copyright Brightcove, Inc. <https://www.brightcove.com/>
 * Available under Apache License Version 2.0
 * <https://github.com/videojs/video.js/blob/master/LICENSE>
 *
 * Includes vtt.js <https://github.com/mozilla/vtt.js>
 * Available under Apache License Version 2.0
 * <https://github.com/mozilla/vtt.js/blob/master/LICENSE>
 */
e.exports=function(e,t){e=e&&e.hasOwnProperty("default")?e.default:e,t=t&&t.hasOwnProperty("default")?t.default:t;var n="7.6.2";function i(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e.__proto__=t}function r(e,t){return(r=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function a(e,t,n){return(a=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}()?Reflect.construct:function(e,t,n){var i=[null];i.push.apply(i,t);var a=new(Function.bind.apply(e,i));return n&&r(a,n.prototype),a}).apply(null,arguments)}function o(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function s(e,t){return t||(t=e.slice(0)),e.raw=t,e}var l=[],u=function(t,n){return function(i,r,a){var o=n.levels[r],s=new RegExp("^("+o+")$");if("log"!==i&&a.unshift(i.toUpperCase()+":"),a.unshift(t+":"),l&&l.push([].concat(a)),e.console){var u=e.console[i];u||"debug"!==i||(u=e.console.info||e.console.log),u&&o&&s.test(i)&&u[Array.isArray(a)?"apply":"call"](e.console,a)}}},c=function e(t){var n,i="info",r=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];n("log",i,t)};return n=u(t,r),r.createLogger=function(n){return e(t+": "+n)},r.levels={all:"debug|log|warn|error",off:"",debug:"debug|log|warn|error",info:"log|warn|error",warn:"warn|error",error:"error",DEFAULT:i},r.level=function(e){if("string"==typeof e){if(!r.levels.hasOwnProperty(e))throw new Error('"'+e+'" in not a valid log level');i=e}return i},(r.history=function(){return l?[].concat(l):[]}).filter=function(e){return(l||[]).filter(function(t){return new RegExp(".*"+e+".*").test(t[0])})},r.history.clear=function(){l&&(l.length=0)},r.history.disable=function(){null!==l&&(l.length=0,l=null)},r.history.enable=function(){null===l&&(l=[])},r.error=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return n("error",i,t)},r.warn=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return n("warn",i,t)},r.debug=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return n("debug",i,t)},r}("VIDEOJS"),d=c.createLogger;function h(e){return e.replace(/\n\r?\s*/g,"")}var p=function(e){for(var t="",n=0;n<arguments.length;n++)t+=h(e[n])+(arguments[n+1]||"");return t},f=Object.prototype.toString,g=function(e){return y(e)?Object.keys(e):[]};function m(e,t){g(e).forEach(function(n){return t(e[n],n)})}function v(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];return Object.assign?Object.assign.apply(Object,[e].concat(n)):(n.forEach(function(t){t&&m(t,function(t,n){e[n]=t})}),e)}function y(e){return!!e&&"object"==typeof e}function b(e){return y(e)&&"[object Object]"===f.call(e)&&e.constructor===Object}function _(t,n){if(!t||!n)return"";if("function"==typeof e.getComputedStyle){var i=e.getComputedStyle(t);return i?i.getPropertyValue(n)||i[n]:""}return""}function T(){var e=s(["Setting attributes in the second argument of createEl()\n                has been deprecated. Use the third argument instead.\n                createEl(type, properties, attributes). Attempting to set "," to ","."]);return T=function(){return e},e}function E(e){return"string"==typeof e&&/\S/.test(e)}function C(e){if(/\s/.test(e))throw new Error("class has illegal whitespace characters")}function w(){return t===e.document}function k(e){return y(e)&&1===e.nodeType}function S(){try{return e.parent!==e.self}catch(e){return!0}}function I(e){return function(n,i){if(!E(n))return t[e](null);E(i)&&(i=t.querySelector(i));var r=k(i)?i:t;return r[e]&&r[e](n)}}function O(e,n,i,r){void 0===e&&(e="div"),void 0===n&&(n={}),void 0===i&&(i={});var a=t.createElement(e);return Object.getOwnPropertyNames(n).forEach(function(e){var t=n[e];-1!==e.indexOf("aria-")||"role"===e||"type"===e?(c.warn(p(T(),e,t)),a.setAttribute(e,t)):"textContent"===e?D(a,t):a[e]=t}),Object.getOwnPropertyNames(i).forEach(function(e){a.setAttribute(e,i[e])}),r&&G(a,r),a}function D(e,t){return void 0===e.textContent?e.innerText=t:e.textContent=t,e}function R(e,t){t.firstChild?t.insertBefore(e,t.firstChild):t.appendChild(e)}function x(e,t){return C(t),e.classList?e.classList.contains(t):(n=t,new RegExp("(^|\\s)"+n+"($|\\s)")).test(e.className);var n}function A(e,t){return e.classList?e.classList.add(t):x(e,t)||(e.className=(e.className+" "+t).trim()),e}function P(e,t){return e.classList?e.classList.remove(t):(C(t),e.className=e.className.split(/\s+/).filter(function(e){return e!==t}).join(" ")),e}function L(e,t,n){var i=x(e,t);if("function"==typeof n&&(n=n(e,t)),"boolean"!=typeof n&&(n=!i),n!==i)return n?A(e,t):P(e,t),e}function N(e,t){Object.getOwnPropertyNames(t).forEach(function(n){var i=t[n];null===i||void 0===i||!1===i?e.removeAttribute(n):e.setAttribute(n,!0===i?"":i)})}function M(e){var t={};if(e&&e.attributes&&e.attributes.length>0)for(var n=e.attributes,i=n.length-1;i>=0;i--){var r=n[i].name,a=n[i].value;"boolean"!=typeof e[r]&&-1===",autoplay,controls,playsinline,loop,muted,default,defaultMuted,".indexOf(","+r+",")||(a=null!==a),t[r]=a}return t}function K(e,t){return e.getAttribute(t)}function $(e,t,n){e.setAttribute(t,n)}function j(e,t){e.removeAttribute(t)}function B(){t.body.focus(),t.onselectstart=function(){return!1}}function F(){t.onselectstart=function(){return!0}}function U(e){if(e&&e.getBoundingClientRect&&e.parentNode){var t=e.getBoundingClientRect(),n={};return["bottom","height","left","right","top","width"].forEach(function(e){void 0!==t[e]&&(n[e]=t[e])}),n.height||(n.height=parseFloat(_(e,"height"))),n.width||(n.width=parseFloat(_(e,"width"))),n}}function V(n){var i;if(n.getBoundingClientRect&&n.parentNode&&(i=n.getBoundingClientRect()),!i)return{left:0,top:0};var r=t.documentElement,a=t.body,o=r.clientLeft||a.clientLeft||0,s=e.pageXOffset||a.scrollLeft,l=i.left+s-o,u=r.clientTop||a.clientTop||0,c=e.pageYOffset||a.scrollTop,d=i.top+c-u;return{left:Math.round(l),top:Math.round(d)}}function q(e,t){var n={},i=V(e),r=e.offsetWidth,a=e.offsetHeight,o=i.top,s=i.left,l=t.pageY,u=t.pageX;return t.changedTouches&&(u=t.changedTouches[0].pageX,l=t.changedTouches[0].pageY),n.y=Math.max(0,Math.min(1,(o-l+a)/a)),n.x=Math.max(0,Math.min(1,(u-s)/r)),n}function H(e){return y(e)&&3===e.nodeType}function z(e){for(;e.firstChild;)e.removeChild(e.firstChild);return e}function W(e){return"function"==typeof e&&(e=e()),(Array.isArray(e)?e:[e]).map(function(e){return"function"==typeof e&&(e=e()),k(e)||H(e)?e:"string"==typeof e&&/\S/.test(e)?t.createTextNode(e):void 0}).filter(function(e){return e})}function G(e,t){return W(t).forEach(function(t){return e.appendChild(t)}),e}function X(e,t){return G(z(e),t)}function Y(e){return void 0===e.button&&void 0===e.buttons||0===e.button&&void 0===e.buttons||"mouseup"===e.type&&0===e.button&&0===e.buttons||0===e.button&&1===e.buttons}var Q=I("querySelector"),J=I("querySelectorAll"),Z=Object.freeze({isReal:w,isEl:k,isInFrame:S,createEl:O,textContent:D,prependTo:R,hasClass:x,addClass:A,removeClass:P,toggleClass:L,setAttributes:N,getAttributes:M,getAttribute:K,setAttribute:$,removeAttribute:j,blockTextSelection:B,unblockTextSelection:F,getBoundingClientRect:U,findPosition:V,getPointerPosition:q,isTextNode:H,emptyEl:z,normalizeContent:W,appendContent:G,insertContent:X,isSingleLeftClick:Y,$:Q,$$:J}),ee=new WeakMap,te=1;function ne(){return te++}function ie(e,t){if(ee.has(e)){var n=ee.get(e);0===n.handlers[t].length&&(delete n.handlers[t],e.removeEventListener?e.removeEventListener(t,n.dispatcher,!1):e.detachEvent&&e.detachEvent("on"+t,n.dispatcher)),Object.getOwnPropertyNames(n.handlers).length<=0&&(delete n.handlers,delete n.dispatcher,delete n.disabled),0===Object.getOwnPropertyNames(n).length&&ee.delete(e)}}function re(e,t,n,i){n.forEach(function(n){e(t,n,i)})}function ae(n){function i(){return!0}function r(){return!1}if(!n||!n.isPropagationStopped){var a=n||e.event;for(var o in n={},a)"layerX"!==o&&"layerY"!==o&&"keyLocation"!==o&&"webkitMovementX"!==o&&"webkitMovementY"!==o&&("returnValue"===o&&a.preventDefault||(n[o]=a[o]));if(n.target||(n.target=n.srcElement||t),n.relatedTarget||(n.relatedTarget=n.fromElement===n.target?n.toElement:n.fromElement),n.preventDefault=function(){a.preventDefault&&a.preventDefault(),n.returnValue=!1,a.returnValue=!1,n.defaultPrevented=!0},n.defaultPrevented=!1,n.stopPropagation=function(){a.stopPropagation&&a.stopPropagation(),n.cancelBubble=!0,a.cancelBubble=!0,n.isPropagationStopped=i},n.isPropagationStopped=r,n.stopImmediatePropagation=function(){a.stopImmediatePropagation&&a.stopImmediatePropagation(),n.isImmediatePropagationStopped=i,n.stopPropagation()},n.isImmediatePropagationStopped=r,null!==n.clientX&&void 0!==n.clientX){var s=t.documentElement,l=t.body;n.pageX=n.clientX+(s&&s.scrollLeft||l&&l.scrollLeft||0)-(s&&s.clientLeft||l&&l.clientLeft||0),n.pageY=n.clientY+(s&&s.scrollTop||l&&l.scrollTop||0)-(s&&s.clientTop||l&&l.clientTop||0)}n.which=n.charCode||n.keyCode,null!==n.button&&void 0!==n.button&&(n.button=1&n.button?0:4&n.button?1:2&n.button?2:0)}return n}var oe=!1;!function(){try{var t=Object.defineProperty({},"passive",{get:function(){oe=!0}});e.addEventListener("test",null,t),e.removeEventListener("test",null,t)}catch(e){}}();var se=["touchstart","touchmove"];function le(e,t,n){if(Array.isArray(t))return re(le,e,t,n);ee.has(e)||ee.set(e,{});var i=ee.get(e);if(i.handlers||(i.handlers={}),i.handlers[t]||(i.handlers[t]=[]),n.guid||(n.guid=ne()),i.handlers[t].push(n),i.dispatcher||(i.disabled=!1,i.dispatcher=function(t,n){if(!i.disabled){t=ae(t);var r=i.handlers[t.type];if(r)for(var a=r.slice(0),o=0,s=a.length;o<s&&!t.isImmediatePropagationStopped();o++)try{a[o].call(e,t,n)}catch(e){c.error(e)}}}),1===i.handlers[t].length)if(e.addEventListener){var r=!1;oe&&se.indexOf(t)>-1&&(r={passive:!0}),e.addEventListener(t,i.dispatcher,r)}else e.attachEvent&&e.attachEvent("on"+t,i.dispatcher)}function ue(e,t,n){if(ee.has(e)){var i=ee.get(e);if(i.handlers){if(Array.isArray(t))return re(ue,e,t,n);var r=function(e,t){i.handlers[t]=[],ie(e,t)};if(void 0!==t){var a=i.handlers[t];if(a)if(n){if(n.guid)for(var o=0;o<a.length;o++)a[o].guid===n.guid&&a.splice(o--,1);ie(e,t)}else r(e,t)}else for(var s in i.handlers)Object.prototype.hasOwnProperty.call(i.handlers||{},s)&&r(e,s)}}}function ce(e,t,n){var i=ee.has(e)?ee.get(e):{},r=e.parentNode||e.ownerDocument;if("string"==typeof t?t={type:t,target:e}:t.target||(t.target=e),t=ae(t),i.dispatcher&&i.dispatcher.call(e,t,n),r&&!t.isPropagationStopped()&&!0===t.bubbles)ce.call(null,r,t,n);else if(!r&&!t.defaultPrevented&&t.target&&t.target[t.type]){ee.has(t.target)||ee.set(t.target,{});var a=ee.get(t.target);t.target[t.type]&&(a.disabled=!0,"function"==typeof t.target[t.type]&&t.target[t.type](),a.disabled=!1)}return!t.defaultPrevented}function de(e,t,n){if(Array.isArray(t))return re(de,e,t,n);var i=function i(){ue(e,t,i),n.apply(this,arguments)};i.guid=n.guid=n.guid||ne(),le(e,t,i)}function he(e,t,n){var i=function i(){ue(e,t,i),n.apply(this,arguments)};i.guid=n.guid=n.guid||ne(),le(e,t,i)}var pe,fe=Object.freeze({fixEvent:ae,on:le,off:ue,trigger:ce,one:de,any:he}),ge=!1,me=function(){if(w()&&!1!==pe.options.autoSetup){var e=Array.prototype.slice.call(t.getElementsByTagName("video")),n=Array.prototype.slice.call(t.getElementsByTagName("audio")),i=Array.prototype.slice.call(t.getElementsByTagName("video-js")),r=e.concat(n,i);if(r&&r.length>0)for(var a=0,o=r.length;a<o;a++){var s=r[a];if(!s||!s.getAttribute){ve(1);break}if(void 0===s.player)null!==s.getAttribute("data-setup")&&pe(s)}else ge||ve(1)}};function ve(t,n){n&&(pe=n),e.setTimeout(me,t)}w()&&"complete"===t.readyState?ge=!0:de(e,"load",function(){ge=!0});var ye,be=function(e){var n=t.createElement("style");return n.className=e,n},_e=function(e,t){e.styleSheet?e.styleSheet.cssText=t:e.textContent=t},Te=30,Ee=function(e,t,n){t.guid||(t.guid=ne());var i=t.bind(e);return i.guid=n?n+"_"+t.guid:t.guid,i},Ce=function(t,n){var i=e.performance.now();return function(){var r=e.performance.now();r-i>=n&&(t.apply(void 0,arguments),i=r)}},we=function(t,n,i,r){var a;void 0===r&&(r=e);var o=function(){var e=this,o=arguments,s=function(){a=null,s=null,i||t.apply(e,o)};!a&&i&&t.apply(e,o),r.clearTimeout(a),a=r.setTimeout(s,n)};return o.cancel=function(){r.clearTimeout(a),a=null},o},ke=function(){};ke.prototype.allowedEvents_={},ke.prototype.on=function(e,t){var n=this.addEventListener;this.addEventListener=function(){},le(this,e,t),this.addEventListener=n},ke.prototype.addEventListener=ke.prototype.on,ke.prototype.off=function(e,t){ue(this,e,t)},ke.prototype.removeEventListener=ke.prototype.off,ke.prototype.one=function(e,t){var n=this.addEventListener;this.addEventListener=function(){},de(this,e,t),this.addEventListener=n},ke.prototype.any=function(e,t){var n=this.addEventListener;this.addEventListener=function(){},he(this,e,t),this.addEventListener=n},ke.prototype.trigger=function(e){var t=e.type||e;"string"==typeof e&&(e={type:t}),e=ae(e),this.allowedEvents_[t]&&this["on"+t]&&this["on"+t](e),ce(this,e)},ke.prototype.dispatchEvent=ke.prototype.trigger,ke.prototype.queueTrigger=function(t){var n=this;ye||(ye=new Map);var i=t.type||t,r=ye.get(this);r||(r=new Map,ye.set(this,r));var a=r.get(i);r.delete(i),e.clearTimeout(a);var o=e.setTimeout(function(){0===r.size&&(r=null,ye.delete(n)),n.trigger(t)},0);r.set(i,o)};var Se=function(e){return e instanceof ke||!!e.eventBusEl_&&["on","one","off","trigger"].every(function(t){return"function"==typeof e[t]})},Ie=function(e){return"string"==typeof e&&/\S/.test(e)||Array.isArray(e)&&!!e.length},Oe=function(e){if(!e.nodeName&&!Se(e))throw new Error("Invalid target; must be a DOM node or evented object.")},De=function(e){if(!Ie(e))throw new Error("Invalid event type; must be a non-empty string or array.")},Re=function(e){if("function"!=typeof e)throw new Error("Invalid listener; must be a function.")},xe=function(e,t){var n,i,r,a=t.length<3||t[0]===e||t[0]===e.eventBusEl_;return a?(n=e.eventBusEl_,t.length>=3&&t.shift(),i=t[0],r=t[1]):(n=t[0],i=t[1],r=t[2]),Oe(n),De(i),Re(r),{isTargetingSelf:a,target:n,type:i,listener:r=Ee(e,r)}},Ae=function(e,t,n,i){Oe(e),e.nodeName?fe[t](e,n,i):e[t](n,i)},Pe={on:function(){for(var e=this,t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];var r=xe(this,n),a=r.isTargetingSelf,o=r.target,s=r.type,l=r.listener;if(Ae(o,"on",s,l),!a){var u=function(){return e.off(o,s,l)};u.guid=l.guid;var c=function(){return e.off("dispose",u)};c.guid=l.guid,Ae(this,"on","dispose",u),Ae(o,"on","dispose",c)}},one:function(){for(var e=this,t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];var r=xe(this,n),a=r.isTargetingSelf,o=r.target,s=r.type,l=r.listener;if(a)Ae(o,"one",s,l);else{var u=function t(){e.off(o,s,t);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];l.apply(null,i)};u.guid=l.guid,Ae(o,"one",s,u)}},any:function(){for(var e=this,t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];var r=xe(this,n),a=r.isTargetingSelf,o=r.target,s=r.type,l=r.listener;if(a)Ae(o,"any",s,l);else{var u=function t(){e.off(o,s,t);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];l.apply(null,i)};u.guid=l.guid,Ae(o,"any",s,u)}},off:function(e,t,n){if(!e||Ie(e))ue(this.eventBusEl_,e,t);else{var i=e,r=t;Oe(i),De(r),Re(n),n=Ee(this,n),this.off("dispose",n),i.nodeName?(ue(i,r,n),ue(i,"dispose",n)):Se(i)&&(i.off(r,n),i.off("dispose",n))}},trigger:function(e,t){return ce(this.eventBusEl_,e,t)}};function Le(t,n){void 0===n&&(n={});var i=n.eventBusKey;if(i){if(!t[i].nodeName)throw new Error('The eventBusKey "'+i+'" does not refer to an element.');t.eventBusEl_=t[i]}else t.eventBusEl_=O("span",{className:"vjs-event-bus"});return v(t,Pe),t.eventedCallbacks&&t.eventedCallbacks.forEach(function(e){e()}),t.on("dispose",function(){t.off(),e.setTimeout(function(){t.eventBusEl_=null},0)}),t}var Ne={state:{},setState:function(e){var t,n=this;return"function"==typeof e&&(e=e()),m(e,function(e,i){n.state[i]!==e&&((t=t||{})[i]={from:n.state[i],to:e}),n.state[i]=e}),t&&Se(this)&&this.trigger({changes:t,type:"statechanged"}),t}};function Me(e,t){return v(e,Ne),e.state=v({},e.state,t),"function"==typeof e.handleStateChanged&&Se(e)&&e.on("statechanged",e.handleStateChanged),e}var Ke=function(e){return"string"!=typeof e?e:e.replace(/./,function(e){return e.toLowerCase()})},$e=function(e){return"string"!=typeof e?e:e.replace(/./,function(e){return e.toUpperCase()})};function je(){for(var e={},t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];return n.forEach(function(t){t&&m(t,function(t,n){b(t)?(b(e[n])||(e[n]={}),e[n]=je(e[n],t)):e[n]=t})}),e}var Be=function(){function t(e,t,n){if(!e&&this.play?this.player_=e=this:this.player_=e,this.parentComponent_=null,this.options_=je({},this.options_),t=this.options_=je(this.options_,t),this.id_=t.id||t.el&&t.el.id,!this.id_){var i=e&&e.id&&e.id()||"no_player";this.id_=i+"_component_"+ne()}this.name_=t.name||null,t.el?this.el_=t.el:!1!==t.createEl&&(this.el_=this.createEl()),!1!==t.evented&&Le(this,{eventBusKey:this.el_?"el_":null}),Me(this,this.constructor.defaultState),this.children_=[],this.childIndex_={},this.childNameIndex_={},this.setTimeoutIds_=new Set,this.setIntervalIds_=new Set,this.rafIds_=new Set,this.clearingTimersOnDispose_=!1,!1!==t.initChildren&&this.initChildren(),this.ready(n),!1!==t.reportTouchActivity&&this.enableTouchActivity()}var n=t.prototype;return n.dispose=function(){if(this.trigger({type:"dispose",bubbles:!1}),this.children_)for(var e=this.children_.length-1;e>=0;e--)this.children_[e].dispose&&this.children_[e].dispose();this.children_=null,this.childIndex_=null,this.childNameIndex_=null,this.parentComponent_=null,this.el_&&(this.el_.parentNode&&this.el_.parentNode.removeChild(this.el_),ee.has(this.el_)&&ee.delete(this.el_),this.el_=null),this.player_=null},n.player=function(){return this.player_},n.options=function(e){return e?(this.options_=je(this.options_,e),this.options_):this.options_},n.el=function(){return this.el_},n.createEl=function(e,t,n){return O(e,t,n)},n.localize=function(e,t,n){void 0===n&&(n=e);var i=this.player_.language&&this.player_.language(),r=this.player_.languages&&this.player_.languages(),a=r&&r[i],o=i&&i.split("-")[0],s=r&&r[o],l=n;return a&&a[e]?l=a[e]:s&&s[e]&&(l=s[e]),t&&(l=l.replace(/\{(\d+)\}/g,function(e,n){var i=t[n-1],r=i;return void 0===i&&(r=e),r})),l},n.contentEl=function(){return this.contentEl_||this.el_},n.id=function(){return this.id_},n.name=function(){return this.name_},n.children=function(){return this.children_},n.getChildById=function(e){return this.childIndex_[e]},n.getChild=function(e){if(e)return this.childNameIndex_[e]},n.addChild=function(e,n,i){var r,a;if(void 0===n&&(n={}),void 0===i&&(i=this.children_.length),"string"==typeof e){a=$e(e);var o=n.componentClass||a;n.name=a;var s=t.getComponent(o);if(!s)throw new Error("Component "+o+" does not exist");if("function"!=typeof s)return null;r=new s(this.player_||this,n)}else r=e;if(r.parentComponent_&&r.parentComponent_.removeChild(r),this.children_.splice(i,0,r),r.parentComponent_=this,"function"==typeof r.id&&(this.childIndex_[r.id()]=r),(a=a||r.name&&$e(r.name()))&&(this.childNameIndex_[a]=r,this.childNameIndex_[Ke(a)]=r),"function"==typeof r.el&&r.el()){var l=this.contentEl().children[i]||null;this.contentEl().insertBefore(r.el(),l)}return r},n.removeChild=function(e){if("string"==typeof e&&(e=this.getChild(e)),e&&this.children_){for(var t=!1,n=this.children_.length-1;n>=0;n--)if(this.children_[n]===e){t=!0,this.children_.splice(n,1);break}if(t){e.parentComponent_=null,this.childIndex_[e.id()]=null,this.childNameIndex_[$e(e.name())]=null,this.childNameIndex_[Ke(e.name())]=null;var i=e.el();i&&i.parentNode===this.contentEl()&&this.contentEl().removeChild(e.el())}}},n.initChildren=function(){var e=this,n=this.options_.children;if(n){var i,r=this.options_,a=t.getComponent("Tech");(i=Array.isArray(n)?n:Object.keys(n)).concat(Object.keys(this.options_).filter(function(e){return!i.some(function(t){return"string"==typeof t?e===t:e===t.name})})).map(function(t){var i,r;return"string"==typeof t?r=n[i=t]||e.options_[i]||{}:(i=t.name,r=t),{name:i,opts:r}}).filter(function(e){var n=t.getComponent(e.opts.componentClass||$e(e.name));return n&&!a.isTech(n)}).forEach(function(t){var n=t.name,i=t.opts;if(void 0!==r[n]&&(i=r[n]),!1!==i){!0===i&&(i={}),i.playerOptions=e.options_.playerOptions;var a=e.addChild(n,i);a&&(e[n]=a)}})}},n.buildCSSClass=function(){return""},n.ready=function(e,t){if(void 0===t&&(t=!1),e)return this.isReady_?void(t?e.call(this):this.setTimeout(e,1)):(this.readyQueue_=this.readyQueue_||[],void this.readyQueue_.push(e))},n.triggerReady=function(){this.isReady_=!0,this.setTimeout(function(){var e=this.readyQueue_;this.readyQueue_=[],e&&e.length>0&&e.forEach(function(e){e.call(this)},this),this.trigger("ready")},1)},n.$=function(e,t){return Q(e,t||this.contentEl())},n.$$=function(e,t){return J(e,t||this.contentEl())},n.hasClass=function(e){return x(this.el_,e)},n.addClass=function(e){A(this.el_,e)},n.removeClass=function(e){P(this.el_,e)},n.toggleClass=function(e,t){L(this.el_,e,t)},n.show=function(){this.removeClass("vjs-hidden")},n.hide=function(){this.addClass("vjs-hidden")},n.lockShowing=function(){this.addClass("vjs-lock-showing")},n.unlockShowing=function(){this.removeClass("vjs-lock-showing")},n.getAttribute=function(e){return K(this.el_,e)},n.setAttribute=function(e,t){$(this.el_,e,t)},n.removeAttribute=function(e){j(this.el_,e)},n.width=function(e,t){return this.dimension("width",e,t)},n.height=function(e,t){return this.dimension("height",e,t)},n.dimensions=function(e,t){this.width(e,!0),this.height(t)},n.dimension=function(e,t,n){if(void 0!==t)return null!==t&&t==t||(t=0),-1!==(""+t).indexOf("%")||-1!==(""+t).indexOf("px")?this.el_.style[e]=t:this.el_.style[e]="auto"===t?"":t+"px",void(n||this.trigger("componentresize"));if(!this.el_)return 0;var i=this.el_.style[e],r=i.indexOf("px");return-1!==r?parseInt(i.slice(0,r),10):parseInt(this.el_["offset"+$e(e)],10)},n.currentDimension=function(e){var t=0;if("width"!==e&&"height"!==e)throw new Error("currentDimension only accepts width or height value");if(t=_(this.el_,e),0===(t=parseFloat(t))||isNaN(t)){var n="offset"+$e(e);t=this.el_[n]}return t},n.currentDimensions=function(){return{width:this.currentDimension("width"),height:this.currentDimension("height")}},n.currentWidth=function(){return this.currentDimension("width")},n.currentHeight=function(){return this.currentDimension("height")},n.focus=function(){this.el_.focus()},n.blur=function(){this.el_.blur()},n.handleKeyDown=function(e){this.player_&&(e.stopPropagation(),this.player_.handleKeyDown(e))},n.handleKeyPress=function(e){this.handleKeyDown(e)},n.emitTapEvents=function(){var t,n=0,i=null;this.on("touchstart",function(r){1===r.touches.length&&(i={pageX:r.touches[0].pageX,pageY:r.touches[0].pageY},n=e.performance.now(),t=!0)}),this.on("touchmove",function(e){if(e.touches.length>1)t=!1;else if(i){var n=e.touches[0].pageX-i.pageX,r=e.touches[0].pageY-i.pageY;Math.sqrt(n*n+r*r)>10&&(t=!1)}});var r=function(){t=!1};this.on("touchleave",r),this.on("touchcancel",r),this.on("touchend",function(r){(i=null,!0===t)&&(e.performance.now()-n<200&&(r.preventDefault(),this.trigger("tap")))})},n.enableTouchActivity=function(){if(this.player()&&this.player().reportUserActivity){var e,t=Ee(this.player(),this.player().reportUserActivity);this.on("touchstart",function(){t(),this.clearInterval(e),e=this.setInterval(t,250)});var n=function(n){t(),this.clearInterval(e)};this.on("touchmove",t),this.on("touchend",n),this.on("touchcancel",n)}},n.setTimeout=function(t,n){var i,r=this;return t=Ee(this,t),this.clearTimersOnDispose_(),i=e.setTimeout(function(){r.setTimeoutIds_.has(i)&&r.setTimeoutIds_.delete(i),t()},n),this.setTimeoutIds_.add(i),i},n.clearTimeout=function(t){return this.setTimeoutIds_.has(t)&&(this.setTimeoutIds_.delete(t),e.clearTimeout(t)),t},n.setInterval=function(t,n){t=Ee(this,t),this.clearTimersOnDispose_();var i=e.setInterval(t,n);return this.setIntervalIds_.add(i),i},n.clearInterval=function(t){return this.setIntervalIds_.has(t)&&(this.setIntervalIds_.delete(t),e.clearInterval(t)),t},n.requestAnimationFrame=function(t){var n,i=this;return this.supportsRaf_?(this.clearTimersOnDispose_(),t=Ee(this,t),n=e.requestAnimationFrame(function(){i.rafIds_.has(n)&&i.rafIds_.delete(n),t()}),this.rafIds_.add(n),n):this.setTimeout(t,1e3/60)},n.cancelAnimationFrame=function(t){return this.supportsRaf_?(this.rafIds_.has(t)&&(this.rafIds_.delete(t),e.cancelAnimationFrame(t)),t):this.clearTimeout(t)},n.clearTimersOnDispose_=function(){var e=this;this.clearingTimersOnDispose_||(this.clearingTimersOnDispose_=!0,this.one("dispose",function(){[["rafIds_","cancelAnimationFrame"],["setTimeoutIds_","clearTimeout"],["setIntervalIds_","clearInterval"]].forEach(function(t){var n=t[0],i=t[1];e[n].forEach(e[i],e)}),e.clearingTimersOnDispose_=!1}))},t.registerComponent=function(e,n){if("string"!=typeof e||!e)throw new Error('Illegal component name, "'+e+'"; must be a non-empty string.');var i=t.getComponent("Tech"),r=i&&i.isTech(n),a=t===n||t.prototype.isPrototypeOf(n.prototype);if(r||!a)throw new Error('Illegal component, "'+e+'"; '+(r?"techs must be registered using Tech.registerTech()":"must be a Component subclass")+".");e=$e(e),t.components_||(t.components_={});var o=t.getComponent("Player");if("Player"===e&&o&&o.players){var s=o.players,l=Object.keys(s);if(s&&l.length>0&&l.map(function(e){return s[e]}).every(Boolean))throw new Error("Can not register Player component after player has been created.")}return t.components_[e]=n,t.components_[Ke(e)]=n,n},t.getComponent=function(e){if(e&&t.components_)return t.components_[e]},t}();Be.prototype.supportsRaf_="function"==typeof e.requestAnimationFrame&&"function"==typeof e.cancelAnimationFrame,Be.registerComponent("Component",Be);var Fe,Ue=e.navigator&&e.navigator.userAgent||"",Ve=/AppleWebKit\/([\d.]+)/i.exec(Ue),qe=Ve?parseFloat(Ve.pop()):null,He=/iPad/i.test(Ue),ze=/iPhone/i.test(Ue)&&!He,We=/iPod/i.test(Ue),Ge=ze||He||We,Xe=(Fe=Ue.match(/OS (\d+)_/i))&&Fe[1]?Fe[1]:null,Ye=/Android/i.test(Ue),Qe=function(){var e=Ue.match(/Android (\d+)(?:\.(\d+))?(?:\.(\d+))*/i);if(!e)return null;var t=e[1]&&parseFloat(e[1]),n=e[2]&&parseFloat(e[2]);return t&&n?parseFloat(e[1]+"."+e[2]):t||null}(),Je=Ye&&Qe<5&&qe<537,Ze=/Firefox/i.test(Ue),et=/Edge/i.test(Ue),tt=!et&&(/Chrome/i.test(Ue)||/CriOS/i.test(Ue)),nt=function(){var e=Ue.match(/(Chrome|CriOS)\/(\d+)/);return e&&e[2]?parseFloat(e[2]):null}(),it=function(){var e=/MSIE\s(\d+)\.\d/.exec(Ue),t=e&&parseFloat(e[1]);return!t&&/Trident\/7.0/i.test(Ue)&&/rv:11.0/.test(Ue)&&(t=11),t}(),rt=/Safari/i.test(Ue)&&!tt&&!Ye&&!et,at=(rt||Ge)&&!tt,ot=/Windows/i.test(Ue),st=w()&&("ontouchstart"in e||e.navigator.maxTouchPoints||e.DocumentTouch&&e.document instanceof e.DocumentTouch),lt=Object.freeze({IS_IPAD:He,IS_IPHONE:ze,IS_IPOD:We,IS_IOS:Ge,IOS_VERSION:Xe,IS_ANDROID:Ye,ANDROID_VERSION:Qe,IS_NATIVE_ANDROID:Je,IS_FIREFOX:Ze,IS_EDGE:et,IS_CHROME:tt,CHROME_VERSION:nt,IE_VERSION:it,IS_SAFARI:rt,IS_ANY_SAFARI:at,IS_WINDOWS:ot,TOUCH_ENABLED:st});function ut(e,t,n,i){return function(e,t,n){if("number"!=typeof t||t<0||t>n)throw new Error("Failed to execute '"+e+"' on 'TimeRanges': The index provided ("+t+") is non-numeric or out of bounds (0-"+n+").")}(e,i,n.length-1),n[i][t]}function ct(e){return void 0===e||0===e.length?{length:0,start:function(){throw new Error("This TimeRanges object is empty")},end:function(){throw new Error("This TimeRanges object is empty")}}:{length:e.length,start:ut.bind(null,"start",0,e),end:ut.bind(null,"end",1,e)}}function dt(e,t){return Array.isArray(e)?ct(e):void 0===e||void 0===t?ct():ct([[e,t]])}function ht(e,t){var n,i,r=0;if(!t)return 0;e&&e.length||(e=dt(0,0));for(var a=0;a<e.length;a++)n=e.start(a),(i=e.end(a))>t&&(i=t),r+=i-n;return r/t}for(var pt,ft={prefixed:!0},gt=[["requestFullscreen","exitFullscreen","fullscreenElement","fullscreenEnabled","fullscreenchange","fullscreenerror","fullscreen"],["webkitRequestFullscreen","webkitExitFullscreen","webkitFullscreenElement","webkitFullscreenEnabled","webkitfullscreenchange","webkitfullscreenerror","-webkit-full-screen"],["mozRequestFullScreen","mozCancelFullScreen","mozFullScreenElement","mozFullScreenEnabled","mozfullscreenchange","mozfullscreenerror","-moz-full-screen"],["msRequestFullscreen","msExitFullscreen","msFullscreenElement","msFullscreenEnabled","MSFullscreenChange","MSFullscreenError","-ms-fullscreen"]],mt=gt[0],vt=0;vt<gt.length;vt++)if(gt[vt][1]in t){pt=gt[vt];break}if(pt){for(var yt=0;yt<pt.length;yt++)ft[mt[yt]]=pt[yt];ft.prefixed=pt[0]!==mt[0]}function bt(e){if(e instanceof bt)return e;"number"==typeof e?this.code=e:"string"==typeof e?this.message=e:y(e)&&("number"==typeof e.code&&(this.code=e.code),v(this,e)),this.message||(this.message=bt.defaultMessages[this.code]||"")}bt.prototype.code=0,bt.prototype.message="",bt.prototype.status=null,bt.errorTypes=["MEDIA_ERR_CUSTOM","MEDIA_ERR_ABORTED","MEDIA_ERR_NETWORK","MEDIA_ERR_DECODE","MEDIA_ERR_SRC_NOT_SUPPORTED","MEDIA_ERR_ENCRYPTED"],bt.defaultMessages={1:"You aborted the media playback",2:"A network error caused the media download to fail part-way.",3:"The media playback was aborted due to a corruption problem or because the media used features your browser did not support.",4:"The media could not be loaded, either because the server or network failed or because the format is not supported.",5:"The media is encrypted and we do not have the keys to decrypt it."};for(var _t=0;_t<bt.errorTypes.length;_t++)bt[bt.errorTypes[_t]]=_t,bt.prototype[bt.errorTypes[_t]]=_t;function Tt(e){return void 0!==e&&null!==e&&"function"==typeof e.then}function Et(e){Tt(e)&&e.then(null,function(e){})}var Ct=function(e){return["kind","label","language","id","inBandMetadataTrackDispatchType","mode","src"].reduce(function(t,n,i){return e[n]&&(t[n]=e[n]),t},{cues:e.cues&&Array.prototype.map.call(e.cues,function(e){return{startTime:e.startTime,endTime:e.endTime,text:e.text,id:e.id}})})},wt=function(e){var t=e.$$("track"),n=Array.prototype.map.call(t,function(e){return e.track});return Array.prototype.map.call(t,function(e){var t=Ct(e.track);return e.src&&(t.src=e.src),t}).concat(Array.prototype.filter.call(e.textTracks(),function(e){return-1===n.indexOf(e)}).map(Ct))},kt=function(e,t){return e.forEach(function(e){var n=t.addRemoteTextTrack(e).track;!e.src&&e.cues&&e.cues.forEach(function(e){return n.addCue(e)})}),t.textTracks()};function St(e,t){return e(t={exports:{}},t.exports),t.exports}var It=St(function(e,t){function n(e){if(e&&"object"==typeof e){var t=e.which||e.keyCode||e.charCode;t&&(e=t)}if("number"==typeof e)return o[e];var n,a=String(e);return(n=i[a.toLowerCase()])?n:(n=r[a.toLowerCase()])||(1===a.length?a.charCodeAt(0):void 0)}n.isEventKey=function(e,t){if(e&&"object"==typeof e){var n=e.which||e.keyCode||e.charCode;if(null===n||void 0===n)return!1;if("string"==typeof t){var a;if(a=i[t.toLowerCase()])return a===n;if(a=r[t.toLowerCase()])return a===n}else if("number"==typeof t)return t===n;return!1}};var i=(t=e.exports=n).code=t.codes={backspace:8,tab:9,enter:13,shift:16,ctrl:17,alt:18,"pause/break":19,"caps lock":20,esc:27,space:32,"page up":33,"page down":34,end:35,home:36,left:37,up:38,right:39,down:40,insert:45,delete:46,command:91,"left command":91,"right command":93,"numpad *":106,"numpad +":107,"numpad -":109,"numpad .":110,"numpad /":111,"num lock":144,"scroll lock":145,"my computer":182,"my calculator":183,";":186,"=":187,",":188,"-":189,".":190,"/":191,"`":192,"[":219,"\\":220,"]":221,"'":222},r=t.aliases={windows:91,"⇧":16,"⌥":18,"⌃":17,"⌘":91,ctl:17,control:17,option:18,pause:19,break:19,caps:20,return:13,escape:27,spc:32,spacebar:32,pgup:33,pgdn:34,ins:45,del:46,cmd:91};for(a=97;a<123;a++)i[String.fromCharCode(a)]=a-32;for(var a=48;a<58;a++)i[a-48]=a;for(a=1;a<13;a++)i["f"+a]=a+111;for(a=0;a<10;a++)i["numpad "+a]=a+96;var o=t.names=t.title={};for(a in i)o[i[a]]=a;for(var s in r)i[s]=r[s]}),Ot=(It.code,It.codes,It.aliases,It.names,It.title,"vjs-modal-dialog"),Dt=function(n){function r(e,t){var i;return(i=n.call(this,e,t)||this).opened_=i.hasBeenOpened_=i.hasBeenFilled_=!1,i.closeable(!i.options_.uncloseable),i.content(i.options_.content),i.contentEl_=O("div",{className:Ot+"-content"},{role:"document"}),i.descEl_=O("p",{className:Ot+"-description vjs-control-text",id:i.el().getAttribute("aria-describedby")}),D(i.descEl_,i.description()),i.el_.appendChild(i.descEl_),i.el_.appendChild(i.contentEl_),i}i(r,n);var a=r.prototype;return a.createEl=function(){return n.prototype.createEl.call(this,"div",{className:this.buildCSSClass(),tabIndex:-1},{"aria-describedby":this.id()+"_description","aria-hidden":"true","aria-label":this.label(),role:"dialog"})},a.dispose=function(){this.contentEl_=null,this.descEl_=null,this.previouslyActiveEl_=null,n.prototype.dispose.call(this)},a.buildCSSClass=function(){return Ot+" vjs-hidden "+n.prototype.buildCSSClass.call(this)},a.label=function(){return this.localize(this.options_.label||"Modal Window")},a.description=function(){var e=this.options_.description||this.localize("This is a modal window.");return this.closeable()&&(e+=" "+this.localize("This modal can be closed by pressing the Escape key or activating the close button.")),e},a.open=function(){if(!this.opened_){var e=this.player();this.trigger("beforemodalopen"),this.opened_=!0,(this.options_.fillAlways||!this.hasBeenOpened_&&!this.hasBeenFilled_)&&this.fill(),this.wasPlaying_=!e.paused(),this.options_.pauseOnOpen&&this.wasPlaying_&&e.pause(),this.on("keydown",this.handleKeyDown),this.hadControls_=e.controls(),e.controls(!1),this.show(),this.conditionalFocus_(),this.el().setAttribute("aria-hidden","false"),this.trigger("modalopen"),this.hasBeenOpened_=!0}},a.opened=function(e){return"boolean"==typeof e&&this[e?"open":"close"](),this.opened_},a.close=function(){if(this.opened_){var e=this.player();this.trigger("beforemodalclose"),this.opened_=!1,this.wasPlaying_&&this.options_.pauseOnOpen&&e.play(),this.off("keydown",this.handleKeyDown),this.hadControls_&&e.controls(!0),this.hide(),this.el().setAttribute("aria-hidden","true"),this.trigger("modalclose"),this.conditionalBlur_(),this.options_.temporary&&this.dispose()}},a.closeable=function(e){if("boolean"==typeof e){var t=this.closeable_=!!e,n=this.getChild("closeButton");if(t&&!n){var i=this.contentEl_;this.contentEl_=this.el_,n=this.addChild("closeButton",{controlText:"Close Modal Dialog"}),this.contentEl_=i,this.on(n,"close",this.close)}!t&&n&&(this.off(n,"close",this.close),this.removeChild(n),n.dispose())}return this.closeable_},a.fill=function(){this.fillWith(this.content())},a.fillWith=function(e){var t=this.contentEl(),n=t.parentNode,i=t.nextSibling;this.trigger("beforemodalfill"),this.hasBeenFilled_=!0,n.removeChild(t),this.empty(),X(t,e),this.trigger("modalfill"),i?n.insertBefore(t,i):n.appendChild(t);var r=this.getChild("closeButton");r&&n.appendChild(r.el_)},a.empty=function(){this.trigger("beforemodalempty"),z(this.contentEl()),this.trigger("modalempty")},a.content=function(e){return void 0!==e&&(this.content_=e),this.content_},a.conditionalFocus_=function(){var e=t.activeElement,n=this.player_.el_;this.previouslyActiveEl_=null,(n.contains(e)||n===e)&&(this.previouslyActiveEl_=e,this.focus())},a.conditionalBlur_=function(){this.previouslyActiveEl_&&(this.previouslyActiveEl_.focus(),this.previouslyActiveEl_=null)},a.handleKeyDown=function(e){if(e.stopPropagation(),It.isEventKey(e,"Escape")&&this.closeable())return e.preventDefault(),void this.close();if(It.isEventKey(e,"Tab")){for(var n,i=this.focusableEls_(),r=this.el_.querySelector(":focus"),a=0;a<i.length;a++)if(r===i[a]){n=a;break}t.activeElement===this.el_&&(n=0),e.shiftKey&&0===n?(i[i.length-1].focus(),e.preventDefault()):e.shiftKey||n!==i.length-1||(i[0].focus(),e.preventDefault())}},a.focusableEls_=function(){var t=this.el_.querySelectorAll("*");return Array.prototype.filter.call(t,function(t){return(t instanceof e.HTMLAnchorElement||t instanceof e.HTMLAreaElement)&&t.hasAttribute("href")||(t instanceof e.HTMLInputElement||t instanceof e.HTMLSelectElement||t instanceof e.HTMLTextAreaElement||t instanceof e.HTMLButtonElement)&&!t.hasAttribute("disabled")||t instanceof e.HTMLIFrameElement||t instanceof e.HTMLObjectElement||t instanceof e.HTMLEmbedElement||t.hasAttribute("tabindex")&&-1!==t.getAttribute("tabindex")||t.hasAttribute("contenteditable")})},r}(Be);Dt.prototype.options_={pauseOnOpen:!0,temporary:!0},Be.registerComponent("ModalDialog",Dt);var Rt=function(e){function t(t){var n;void 0===t&&(t=[]),(n=e.call(this)||this).tracks_=[],Object.defineProperty(o(n),"length",{get:function(){return this.tracks_.length}});for(var i=0;i<t.length;i++)n.addTrack(t[i]);return n}i(t,e);var n=t.prototype;return n.addTrack=function(e){var t=this.tracks_.length;""+t in this||Object.defineProperty(this,t,{get:function(){return this.tracks_[t]}}),-1===this.tracks_.indexOf(e)&&(this.tracks_.push(e),this.trigger({track:e,type:"addtrack",target:this}))},n.removeTrack=function(e){for(var t,n=0,i=this.length;n<i;n++)if(this[n]===e){(t=this[n]).off&&t.off(),this.tracks_.splice(n,1);break}t&&this.trigger({track:t,type:"removetrack",target:this})},n.getTrackById=function(e){for(var t=null,n=0,i=this.length;n<i;n++){var r=this[n];if(r.id===e){t=r;break}}return t},t}(ke);for(var xt in Rt.prototype.allowedEvents_={change:"change",addtrack:"addtrack",removetrack:"removetrack"},Rt.prototype.allowedEvents_)Rt.prototype["on"+xt]=null;var At,Pt=function(e,t){for(var n=0;n<e.length;n++)Object.keys(e[n]).length&&t.id!==e[n].id&&(e[n].enabled=!1)},Lt=function(e){function t(t){var n;void 0===t&&(t=[]);for(var i=t.length-1;i>=0;i--)if(t[i].enabled){Pt(t,t[i]);break}return(n=e.call(this,t)||this).changing_=!1,n}i(t,e);var n=t.prototype;return n.addTrack=function(t){var n=this;t.enabled&&Pt(this,t),e.prototype.addTrack.call(this,t),t.addEventListener&&(t.enabledChange_=function(){n.changing_||(n.changing_=!0,Pt(n,t),n.changing_=!1,n.trigger("change"))},t.addEventListener("enabledchange",t.enabledChange_))},n.removeTrack=function(t){e.prototype.removeTrack.call(this,t),t.removeEventListener&&t.enabledChange_&&(t.removeEventListener("enabledchange",t.enabledChange_),t.enabledChange_=null)},t}(Rt),Nt=function(e,t){for(var n=0;n<e.length;n++)Object.keys(e[n]).length&&t.id!==e[n].id&&(e[n].selected=!1)},Mt=function(e){function t(t){var n;void 0===t&&(t=[]);for(var i=t.length-1;i>=0;i--)if(t[i].selected){Nt(t,t[i]);break}return(n=e.call(this,t)||this).changing_=!1,Object.defineProperty(o(n),"selectedIndex",{get:function(){for(var e=0;e<this.length;e++)if(this[e].selected)return e;return-1},set:function(){}}),n}i(t,e);var n=t.prototype;return n.addTrack=function(t){var n=this;t.selected&&Nt(this,t),e.prototype.addTrack.call(this,t),t.addEventListener&&(t.selectedChange_=function(){n.changing_||(n.changing_=!0,Nt(n,t),n.changing_=!1,n.trigger("change"))},t.addEventListener("selectedchange",t.selectedChange_))},n.removeTrack=function(t){e.prototype.removeTrack.call(this,t),t.removeEventListener&&t.selectedChange_&&(t.removeEventListener("selectedchange",t.selectedChange_),t.selectedChange_=null)},t}(Rt),Kt=function(e){function t(){return e.apply(this,arguments)||this}i(t,e);var n=t.prototype;return n.addTrack=function(t){var n=this;e.prototype.addTrack.call(this,t),this.queueChange_||(this.queueChange_=function(){return n.queueTrigger("change")}),this.triggerSelectedlanguagechange||(this.triggerSelectedlanguagechange_=function(){return n.trigger("selectedlanguagechange")}),t.addEventListener("modechange",this.queueChange_),-1===["metadata","chapters"].indexOf(t.kind)&&t.addEventListener("modechange",this.triggerSelectedlanguagechange_)},n.removeTrack=function(t){e.prototype.removeTrack.call(this,t),t.removeEventListener&&(this.queueChange_&&t.removeEventListener("modechange",this.queueChange_),this.selectedlanguagechange_&&t.removeEventListener("modechange",this.triggerSelectedlanguagechange_))},t}(Rt),$t=function(){function e(e){void 0===e&&(e=[]),this.trackElements_=[],Object.defineProperty(this,"length",{get:function(){return this.trackElements_.length}});for(var t=0,n=e.length;t<n;t++)this.addTrackElement_(e[t])}var t=e.prototype;return t.addTrackElement_=function(e){var t=this.trackElements_.length;""+t in this||Object.defineProperty(this,t,{get:function(){return this.trackElements_[t]}}),-1===this.trackElements_.indexOf(e)&&this.trackElements_.push(e)},t.getTrackElementByTrack_=function(e){for(var t,n=0,i=this.trackElements_.length;n<i;n++)if(e===this.trackElements_[n].track){t=this.trackElements_[n];break}return t},t.removeTrackElement_=function(e){for(var t=0,n=this.trackElements_.length;t<n;t++)if(e===this.trackElements_[t]){this.trackElements_[t].track&&"function"==typeof this.trackElements_[t].track.off&&this.trackElements_[t].track.off(),"function"==typeof this.trackElements_[t].off&&this.trackElements_[t].off(),this.trackElements_.splice(t,1);break}},e}(),jt=function(){function e(t){e.prototype.setCues_.call(this,t),Object.defineProperty(this,"length",{get:function(){return this.length_}})}var t=e.prototype;return t.setCues_=function(e){var t=this.length||0,n=0,i=e.length;this.cues_=e,this.length_=e.length;var r=function(e){""+e in this||Object.defineProperty(this,""+e,{get:function(){return this.cues_[e]}})};if(t<i)for(n=t;n<i;n++)r.call(this,n)},t.getCueById=function(e){for(var t=null,n=0,i=this.length;n<i;n++){var r=this[n];if(r.id===e){t=r;break}}return t},e}(),Bt={alternative:"alternative",captions:"captions",main:"main",sign:"sign",subtitles:"subtitles",commentary:"commentary"},Ft={alternative:"alternative",descriptions:"descriptions",main:"main","main-desc":"main-desc",translation:"translation",commentary:"commentary"},Ut={subtitles:"subtitles",captions:"captions",descriptions:"descriptions",chapters:"chapters",metadata:"metadata"},Vt={disabled:"disabled",hidden:"hidden",showing:"showing"},qt=function(e){function t(t){var n;void 0===t&&(t={}),n=e.call(this)||this;var i={id:t.id||"vjs_track_"+ne(),kind:t.kind||"",label:t.label||"",language:t.language||""},r=function(e){Object.defineProperty(o(n),e,{get:function(){return i[e]},set:function(){}})};for(var a in i)r(a);return n}return i(t,e),t}(ke),Ht=function(n){var i=["protocol","hostname","port","pathname","search","hash","host"],r=t.createElement("a");r.href=n;var a,o=""===r.host&&"file:"!==r.protocol;o&&((a=t.createElement("div")).innerHTML='<a href="'+n+'"></a>',r=a.firstChild,a.setAttribute("style","display:none; position:absolute;"),t.body.appendChild(a));for(var s={},l=0;l<i.length;l++)s[i[l]]=r[i[l]];return"http:"===s.protocol&&(s.host=s.host.replace(/:80$/,"")),"https:"===s.protocol&&(s.host=s.host.replace(/:443$/,"")),s.protocol||(s.protocol=e.location.protocol),o&&t.body.removeChild(a),s},zt=function(e){if(!e.match(/^https?:\/\//)){var n=t.createElement("div");n.innerHTML='<a href="'+e+'">x</a>',e=n.firstChild.href}return e},Wt=function(e){if("string"==typeof e){var t=/^(\/?)([\s\S]*?)((?:\.{1,2}|[^\/]+?)(\.([^\.\/\?]+)))(?:[\/]*|[\?].*)$/.exec(e);if(t)return t.pop().toLowerCase()}return""},Gt=function(t){var n=e.location,i=Ht(t);return(":"===i.protocol?n.protocol:i.protocol)+i.host!==n.protocol+n.host},Xt=Object.freeze({parseUrl:Ht,getAbsoluteURL:zt,getFileExtension:Wt,isCrossOrigin:Gt}),Yt=function(e){var t=Qt.call(e);return"[object Function]"===t||"function"==typeof e&&"[object RegExp]"!==t||"undefined"!=typeof window&&(e===window.setTimeout||e===window.alert||e===window.confirm||e===window.prompt)},Qt=Object.prototype.toString,Jt=Array.prototype.slice,Zt=Object.prototype.toString,en=Function.prototype.bind||function(e){var t=this;if("function"!=typeof t||"[object Function]"!==Zt.call(t))throw new TypeError("Function.prototype.bind called on incompatible "+t);for(var n,i=Jt.call(arguments,1),r=Math.max(0,t.length-i.length),a=[],o=0;o<r;o++)a.push("$"+o);if(n=Function("binder","return function ("+a.join(",")+"){ return binder.apply(this,arguments); }")(function(){if(this instanceof n){var r=t.apply(this,i.concat(Jt.call(arguments)));return Object(r)===r?r:this}return t.apply(e,i.concat(Jt.call(arguments)))}),t.prototype){var s=function(){};s.prototype=t.prototype,n.prototype=new s,s.prototype=null}return n},tn=Object.prototype.toString,nn=function(e){var t=tn.call(e),n="[object Arguments]"===t;return n||(n="[object Array]"!==t&&null!==e&&"object"==typeof e&&"number"==typeof e.length&&e.length>=0&&"[object Function]"===tn.call(e.callee)),n};if(!Object.keys){var rn=Object.prototype.hasOwnProperty,an=Object.prototype.toString,on=nn,sn=Object.prototype.propertyIsEnumerable,ln=!sn.call({toString:null},"toString"),un=sn.call(function(){},"prototype"),cn=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],dn=function(e){var t=e.constructor;return t&&t.prototype===e},hn={$applicationCache:!0,$console:!0,$external:!0,$frame:!0,$frameElement:!0,$frames:!0,$innerHeight:!0,$innerWidth:!0,$onmozfullscreenchange:!0,$onmozfullscreenerror:!0,$outerHeight:!0,$outerWidth:!0,$pageXOffset:!0,$pageYOffset:!0,$parent:!0,$scrollLeft:!0,$scrollTop:!0,$scrollX:!0,$scrollY:!0,$self:!0,$webkitIndexedDB:!0,$webkitStorageInfo:!0,$window:!0},pn=function(){if("undefined"==typeof window)return!1;for(var e in window)try{if(!hn["$"+e]&&rn.call(window,e)&&null!==window[e]&&"object"==typeof window[e])try{dn(window[e])}catch(e){return!0}}catch(e){return!0}return!1}();At=function(e){var t=null!==e&&"object"==typeof e,n="[object Function]"===an.call(e),i=on(e),r=t&&"[object String]"===an.call(e),a=[];if(!t&&!n&&!i)throw new TypeError("Object.keys called on a non-object");var o=un&&n;if(r&&e.length>0&&!rn.call(e,0))for(var s=0;s<e.length;++s)a.push(String(s));if(i&&e.length>0)for(var l=0;l<e.length;++l)a.push(String(l));else for(var u in e)o&&"prototype"===u||!rn.call(e,u)||a.push(String(u));if(ln)for(var c=function(e){if("undefined"==typeof window||!pn)return dn(e);try{return dn(e)}catch(e){return!1}}(e),d=0;d<cn.length;++d)c&&"constructor"===cn[d]||!rn.call(e,cn[d])||a.push(cn[d]);return a}}var fn=At,gn=Array.prototype.slice,mn=Object.keys,vn=mn?function(e){return mn(e)}:fn,yn=Object.keys;vn.shim=function(){Object.keys?function(){var e=Object.keys(arguments);return e&&e.length===arguments.length}(1,2)||(Object.keys=function(e){return nn(e)?yn(gn.call(e)):yn(e)}):Object.keys=vn;return Object.keys||vn};var bn=vn,_n="function"==typeof Symbol&&"symbol"==typeof Symbol("foo"),Tn=Object.prototype.toString,En=Array.prototype.concat,Cn=Object.defineProperty,wn=Cn&&function(){var e={};try{for(var t in Cn(e,"x",{enumerable:!1,value:e}),e)return!1;return e.x===e}catch(e){return!1}}(),kn=function(e,t,n,i){var r;t in e&&("function"!=typeof(r=i)||"[object Function]"!==Tn.call(r)||!i())||(wn?Cn(e,t,{configurable:!0,enumerable:!1,value:n,writable:!0}):e[t]=n)},Sn=function(e,t){var n=arguments.length>2?arguments[2]:{},i=bn(t);_n&&(i=En.call(i,Object.getOwnPropertySymbols(t)));for(var r=0;r<i.length;r+=1)kn(e,i[r],t[i[r]],n[i[r]])};Sn.supportsDescriptors=!!wn;var In=Sn,On=Object.getOwnPropertyDescriptor?function(){return Object.getOwnPropertyDescriptor(arguments,"callee").get}():function(){throw new TypeError},Dn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator,Rn=Object.getPrototypeOf||function(e){return e.__proto__},xn="undefined"==typeof Uint8Array?void 0:Rn(Uint8Array),An={"$ %Array%":Array,"$ %ArrayBuffer%":"undefined"==typeof ArrayBuffer?void 0:ArrayBuffer,"$ %ArrayBufferPrototype%":"undefined"==typeof ArrayBuffer?void 0:ArrayBuffer.prototype,"$ %ArrayIteratorPrototype%":Dn?Rn([][Symbol.iterator]()):void 0,"$ %ArrayPrototype%":Array.prototype,"$ %ArrayProto_entries%":Array.prototype.entries,"$ %ArrayProto_forEach%":Array.prototype.forEach,"$ %ArrayProto_keys%":Array.prototype.keys,"$ %ArrayProto_values%":Array.prototype.values,"$ %AsyncFromSyncIteratorPrototype%":void 0,"$ %AsyncFunction%":void 0,"$ %AsyncFunctionPrototype%":void 0,"$ %AsyncGenerator%":void 0,"$ %AsyncGeneratorFunction%":void 0,"$ %AsyncGeneratorPrototype%":void 0,"$ %AsyncIteratorPrototype%":void 0,"$ %Atomics%":"undefined"==typeof Atomics?void 0:Atomics,"$ %Boolean%":Boolean,"$ %BooleanPrototype%":Boolean.prototype,"$ %DataView%":"undefined"==typeof DataView?void 0:DataView,"$ %DataViewPrototype%":"undefined"==typeof DataView?void 0:DataView.prototype,"$ %Date%":Date,"$ %DatePrototype%":Date.prototype,"$ %decodeURI%":decodeURI,"$ %decodeURIComponent%":decodeURIComponent,"$ %encodeURI%":encodeURI,"$ %encodeURIComponent%":encodeURIComponent,"$ %Error%":Error,"$ %ErrorPrototype%":Error.prototype,"$ %eval%":eval,"$ %EvalError%":EvalError,"$ %EvalErrorPrototype%":EvalError.prototype,"$ %Float32Array%":"undefined"==typeof Float32Array?void 0:Float32Array,"$ %Float32ArrayPrototype%":"undefined"==typeof Float32Array?void 0:Float32Array.prototype,"$ %Float64Array%":"undefined"==typeof Float64Array?void 0:Float64Array,"$ %Float64ArrayPrototype%":"undefined"==typeof Float64Array?void 0:Float64Array.prototype,"$ %Function%":Function,"$ %FunctionPrototype%":Function.prototype,"$ %Generator%":void 0,"$ %GeneratorFunction%":void 0,"$ %GeneratorPrototype%":void 0,"$ %Int8Array%":"undefined"==typeof Int8Array?void 0:Int8Array,"$ %Int8ArrayPrototype%":"undefined"==typeof Int8Array?void 0:Int8Array.prototype,"$ %Int16Array%":"undefined"==typeof Int16Array?void 0:Int16Array,"$ %Int16ArrayPrototype%":"undefined"==typeof Int16Array?void 0:Int8Array.prototype,"$ %Int32Array%":"undefined"==typeof Int32Array?void 0:Int32Array,"$ %Int32ArrayPrototype%":"undefined"==typeof Int32Array?void 0:Int32Array.prototype,"$ %isFinite%":isFinite,"$ %isNaN%":isNaN,"$ %IteratorPrototype%":Dn?Rn(Rn([][Symbol.iterator]())):void 0,"$ %JSON%":JSON,"$ %JSONParse%":JSON.parse,"$ %Map%":"undefined"==typeof Map?void 0:Map,"$ %MapIteratorPrototype%":"undefined"!=typeof Map&&Dn?Rn((new Map)[Symbol.iterator]()):void 0,"$ %MapPrototype%":"undefined"==typeof Map?void 0:Map.prototype,"$ %Math%":Math,"$ %Number%":Number,"$ %NumberPrototype%":Number.prototype,"$ %Object%":Object,"$ %ObjectPrototype%":Object.prototype,"$ %ObjProto_toString%":Object.prototype.toString,"$ %ObjProto_valueOf%":Object.prototype.valueOf,"$ %parseFloat%":parseFloat,"$ %parseInt%":parseInt,"$ %Promise%":"undefined"==typeof Promise?void 0:Promise,"$ %PromisePrototype%":"undefined"==typeof Promise?void 0:Promise.prototype,"$ %PromiseProto_then%":"undefined"==typeof Promise?void 0:Promise.prototype.then,"$ %Promise_all%":"undefined"==typeof Promise?void 0:Promise.all,"$ %Promise_reject%":"undefined"==typeof Promise?void 0:Promise.reject,"$ %Promise_resolve%":"undefined"==typeof Promise?void 0:Promise.resolve,"$ %Proxy%":"undefined"==typeof Proxy?void 0:Proxy,"$ %RangeError%":RangeError,"$ %RangeErrorPrototype%":RangeError.prototype,"$ %ReferenceError%":ReferenceError,"$ %ReferenceErrorPrototype%":ReferenceError.prototype,"$ %Reflect%":"undefined"==typeof Reflect?void 0:Reflect,"$ %RegExp%":RegExp,"$ %RegExpPrototype%":RegExp.prototype,"$ %Set%":"undefined"==typeof Set?void 0:Set,"$ %SetIteratorPrototype%":"undefined"!=typeof Set&&Dn?Rn((new Set)[Symbol.iterator]()):void 0,"$ %SetPrototype%":"undefined"==typeof Set?void 0:Set.prototype,"$ %SharedArrayBuffer%":"undefined"==typeof SharedArrayBuffer?void 0:SharedArrayBuffer,"$ %SharedArrayBufferPrototype%":"undefined"==typeof SharedArrayBuffer?void 0:SharedArrayBuffer.prototype,"$ %String%":String,"$ %StringIteratorPrototype%":Dn?Rn(""[Symbol.iterator]()):void 0,"$ %StringPrototype%":String.prototype,"$ %Symbol%":Dn?Symbol:void 0,"$ %SymbolPrototype%":Dn?Symbol.prototype:void 0,"$ %SyntaxError%":SyntaxError,"$ %SyntaxErrorPrototype%":SyntaxError.prototype,"$ %ThrowTypeError%":On,"$ %TypedArray%":xn,"$ %TypedArrayPrototype%":xn?xn.prototype:void 0,"$ %TypeError%":TypeError,"$ %TypeErrorPrototype%":TypeError.prototype,"$ %Uint8Array%":"undefined"==typeof Uint8Array?void 0:Uint8Array,"$ %Uint8ArrayPrototype%":"undefined"==typeof Uint8Array?void 0:Uint8Array.prototype,"$ %Uint8ClampedArray%":"undefined"==typeof Uint8ClampedArray?void 0:Uint8ClampedArray,"$ %Uint8ClampedArrayPrototype%":"undefined"==typeof Uint8ClampedArray?void 0:Uint8ClampedArray.prototype,"$ %Uint16Array%":"undefined"==typeof Uint16Array?void 0:Uint16Array,"$ %Uint16ArrayPrototype%":"undefined"==typeof Uint16Array?void 0:Uint16Array.prototype,"$ %Uint32Array%":"undefined"==typeof Uint32Array?void 0:Uint32Array,"$ %Uint32ArrayPrototype%":"undefined"==typeof Uint32Array?void 0:Uint32Array.prototype,"$ %URIError%":URIError,"$ %URIErrorPrototype%":URIError.prototype,"$ %WeakMap%":"undefined"==typeof WeakMap?void 0:WeakMap,"$ %WeakMapPrototype%":"undefined"==typeof WeakMap?void 0:WeakMap.prototype,"$ %WeakSet%":"undefined"==typeof WeakSet?void 0:WeakSet,"$ %WeakSetPrototype%":"undefined"==typeof WeakSet?void 0:WeakSet.prototype},Pn=function(e,t){if(arguments.length>1&&"boolean"!=typeof t)throw new TypeError('"allowMissing" argument must be a boolean');var n="$ "+e;if(!(n in An))throw new SyntaxError("intrinsic "+e+" does not exist!");if(void 0===An[n]&&!t)throw new TypeError("intrinsic "+e+" exists, but is not available. Please file an issue!");return An[n]},Ln=(en.call(Function.call,Object.prototype.hasOwnProperty),Pn("%TypeError%"),Pn("%SyntaxError%"),Number.isNaN,Number.isNaN||function(e){return e!=e}),Nn=(Number.isFinite,Function.prototype.toString),Mn=/^\s*class\b/,Kn=function(e){try{var t=Nn.call(e);return Mn.test(t)}catch(e){return!1}},$n=Object.prototype.toString,jn="function"==typeof Symbol&&"symbol"==typeof Symbol.toStringTag,Bn=function(e){if(!e)return!1;if("function"!=typeof e&&"object"!=typeof e)return!1;if("function"==typeof e&&!e.prototype)return!0;if(jn)return function(e){try{return!Kn(e)&&(Nn.call(e),!0)}catch(e){return!1}}(e);if(Kn(e))return!1;var t=$n.call(e);return"[object Function]"===t||"[object GeneratorFunction]"===t},Fn=(Object.prototype.toString,Pn("%Object%"),Pn("%TypeError%")),Un=Pn("%String%"),Vn=function(e){return Un(e)},qn=function(e,t){if(null==e)throw new Fn(t||"Cannot call method on "+e);return e},Hn=en.call(Function.call,String.prototype.replace),zn=/^[\x09\x0A\x0B\x0C\x0D\x20\xA0\u1680\u180E\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200A\u202F\u205F\u3000\u2028\u2029\uFEFF]+/,Wn=/[\x09\x0A\x0B\x0C\x0D\x20\xA0\u1680\u180E\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200A\u202F\u205F\u3000\u2028\u2029\uFEFF]+$/,Gn=function(){var e=Vn(qn(this));return Hn(Hn(e,zn,""),Wn,"")},Xn=function(){return String.prototype.trim&&"​"==="​".trim()?String.prototype.trim:Gn},Yn=en.call(Function.call,Xn());In(Yn,{getPolyfill:Xn,implementation:Gn,shim:function(){var e=Xn();return In(String.prototype,{trim:e},{trim:function(){return String.prototype.trim!==e}}),e}});var Qn=Yn,Jn=Object.prototype.toString,Zn=Object.prototype.hasOwnProperty,ei=function(e){if(!e)return{};var t={};return function(e,t,n){if(!Bn(t))throw new TypeError("iterator must be a function");var i;arguments.length>=3&&(i=n),"[object Array]"===Jn.call(e)?function(e,t,n){for(var i=0,r=e.length;i<r;i++)Zn.call(e,i)&&(null==n?t(e[i],i,e):t.call(n,e[i],i,e))}(e,t,i):"string"==typeof e?function(e,t,n){for(var i=0,r=e.length;i<r;i++)null==n?t(e.charAt(i),i,e):t.call(n,e.charAt(i),i,e)}(e,t,i):function(e,t,n){for(var i in e)Zn.call(e,i)&&(null==n?t(e[i],i,e):t.call(n,e[i],i,e))}(e,t,i)}(Qn(e).split("\n"),function(e){var n,i=e.indexOf(":"),r=Qn(e.slice(0,i)).toLowerCase(),a=Qn(e.slice(i+1));void 0===t[r]?t[r]=a:(n=t[r],"[object Array]"===Object.prototype.toString.call(n)?t[r].push(a):t[r]=[t[r],a])}),t},ti=function(){for(var e={},t=0;t<arguments.length;t++){var n=arguments[t];for(var i in n)ni.call(n,i)&&(e[i]=n[i])}return e},ni=Object.prototype.hasOwnProperty,ii=ai;function ri(e,t,n){var i=e;return Yt(t)?(n=t,"string"==typeof e&&(i={uri:e})):i=ti(t,{uri:e}),i.callback=n,i}function ai(e,t,n){return oi(t=ri(e,t,n))}function oi(e){if(void 0===e.callback)throw new Error("callback argument missing");var t=!1,n=function(n,i,r){t||(t=!0,e.callback(n,i,r))};function i(e){return clearTimeout(l),e instanceof Error||(e=new Error(""+(e||"Unknown XMLHttpRequest Error"))),e.statusCode=0,n(e,g)}function r(){if(!o){var t;clearTimeout(l),t=e.useXDR&&void 0===s.status?200:1223===s.status?204:s.status;var i=g,r=null;return 0!==t?(i={body:function(){var e=void 0;if(e=s.response?s.response:s.responseText||function(e){if("document"===e.responseType)return e.responseXML;var t=e.responseXML&&"parsererror"===e.responseXML.documentElement.nodeName;return""!==e.responseType||t?null:e.responseXML}(s),f)try{e=JSON.parse(e)}catch(e){}return e}(),statusCode:t,method:c,headers:{},url:u,rawRequest:s},s.getAllResponseHeaders&&(i.headers=ei(s.getAllResponseHeaders()))):r=new Error("Internal XMLHttpRequest Error"),n(r,i,i.body)}}var a,o,s=e.xhr||null;s||(s=e.cors||e.useXDR?new ai.XDomainRequest:new ai.XMLHttpRequest);var l,u=s.url=e.uri||e.url,c=s.method=e.method||"GET",d=e.body||e.data,h=s.headers=e.headers||{},p=!!e.sync,f=!1,g={body:void 0,headers:{},statusCode:0,method:c,url:u,rawRequest:s};if("json"in e&&!1!==e.json&&(f=!0,h.accept||h.Accept||(h.Accept="application/json"),"GET"!==c&&"HEAD"!==c&&(h["content-type"]||h["Content-Type"]||(h["Content-Type"]="application/json"),d=JSON.stringify(!0===e.json?d:e.json))),s.onreadystatechange=function(){4===s.readyState&&setTimeout(r,0)},s.onload=r,s.onerror=i,s.onprogress=function(){},s.onabort=function(){o=!0},s.ontimeout=i,s.open(c,u,!p,e.username,e.password),p||(s.withCredentials=!!e.withCredentials),!p&&e.timeout>0&&(l=setTimeout(function(){if(!o){o=!0,s.abort("timeout");var e=new Error("XMLHttpRequest timeout");e.code="ETIMEDOUT",i(e)}},e.timeout)),s.setRequestHeader)for(a in h)h.hasOwnProperty(a)&&s.setRequestHeader(a,h[a]);else if(e.headers&&!function(e){for(var t in e)if(e.hasOwnProperty(t))return!1;return!0}(e.headers))throw new Error("Headers cannot be set on an XDomainRequest object");return"responseType"in e&&(s.responseType=e.responseType),"beforeSend"in e&&"function"==typeof e.beforeSend&&e.beforeSend(s),s.send(d||null),s}ai.XMLHttpRequest=e.XMLHttpRequest||function(){},ai.XDomainRequest="withCredentials"in new ai.XMLHttpRequest?ai.XMLHttpRequest:e.XDomainRequest,function(e,t){for(var n=0;n<e.length;n++)t(e[n])}(["get","put","post","patch","head","delete"],function(e){ai["delete"===e?"del":e]=function(t,n,i){return(n=ri(t,n,i)).method=e.toUpperCase(),oi(n)}});var si=function(t,n){var i=new e.WebVTT.Parser(e,e.vttjs,e.WebVTT.StringDecoder()),r=[];i.oncue=function(e){n.addCue(e)},i.onparsingerror=function(e){r.push(e)},i.onflush=function(){n.trigger({type:"loadeddata",target:n})},i.parse(t),r.length>0&&(e.console&&e.console.groupCollapsed&&e.console.groupCollapsed("Text Track parsing errors for "+n.src),r.forEach(function(e){return c.error(e)}),e.console&&e.console.groupEnd&&e.console.groupEnd()),i.flush()},li=function(t,n){var i={uri:t},r=Gt(t);r&&(i.cors=r),ii(i,Ee(this,function(t,i,r){if(t)return c.error(t,i);n.loaded_=!0,"function"!=typeof e.WebVTT?n.tech_&&n.tech_.any(["vttjsloaded","vttjserror"],function(e){if("vttjserror"!==e.type)return si(r,n);c.error("vttjs failed to load, stopping trying to process "+n.src)}):si(r,n)}))},ui=function(t){function n(e){var n;if(void 0===e&&(e={}),!e.tech)throw new Error("A tech was not provided.");var i=je(e,{kind:Ut[e.kind]||"subtitles",language:e.language||e.srclang||""}),r=Vt[i.mode]||"disabled",a=i.default;"metadata"!==i.kind&&"chapters"!==i.kind||(r="hidden"),(n=t.call(this,i)||this).tech_=i.tech,n.cues_=[],n.activeCues_=[];var s=new jt(n.cues_),l=new jt(n.activeCues_),u=!1,c=Ee(o(n),function(){this.activeCues=this.activeCues,u&&(this.trigger("cuechange"),u=!1)});return"disabled"!==r&&n.tech_.ready(function(){n.tech_.on("timeupdate",c)},!0),Object.defineProperties(o(n),{default:{get:function(){return a},set:function(){}},mode:{get:function(){return r},set:function(e){var t=this;Vt[e]&&("disabled"!==(r=e)?this.tech_.ready(function(){t.tech_.on("timeupdate",c)},!0):this.tech_.off("timeupdate",c),this.trigger("modechange"))}},cues:{get:function(){return this.loaded_?s:null},set:function(){}},activeCues:{get:function(){if(!this.loaded_)return null;if(0===this.cues.length)return l;for(var e=this.tech_.currentTime(),t=[],n=0,i=this.cues.length;n<i;n++){var r=this.cues[n];r.startTime<=e&&r.endTime>=e?t.push(r):r.startTime===r.endTime&&r.startTime<=e&&r.startTime+.5>=e&&t.push(r)}if(u=!1,t.length!==this.activeCues_.length)u=!0;else for(var a=0;a<t.length;a++)-1===this.activeCues_.indexOf(t[a])&&(u=!0);return this.activeCues_=t,l.setCues_(this.activeCues_),l},set:function(){}}}),i.src?(n.src=i.src,li(i.src,o(n))):n.loaded_=!0,n}i(n,t);var r=n.prototype;return r.addCue=function(t){var n=t;if(e.vttjs&&!(t instanceof e.vttjs.VTTCue)){for(var i in n=new e.vttjs.VTTCue(t.startTime,t.endTime,t.text),t)i in n||(n[i]=t[i]);n.id=t.id,n.originalCue_=t}for(var r=this.tech_.textTracks(),a=0;a<r.length;a++)r[a]!==this&&r[a].removeCue(n);this.cues_.push(n),this.cues.setCues_(this.cues_)},r.removeCue=function(e){for(var t=this.cues_.length;t--;){var n=this.cues_[t];if(n===e||n.originalCue_&&n.originalCue_===e){this.cues_.splice(t,1),this.cues.setCues_(this.cues_);break}}},n}(qt);ui.prototype.allowedEvents_={cuechange:"cuechange"};var ci=function(e){function t(t){var n;void 0===t&&(t={});var i=je(t,{kind:Ft[t.kind]||""});n=e.call(this,i)||this;var r=!1;return Object.defineProperty(o(n),"enabled",{get:function(){return r},set:function(e){"boolean"==typeof e&&e!==r&&(r=e,this.trigger("enabledchange"))}}),i.enabled&&(n.enabled=i.enabled),n.loaded_=!0,n}return i(t,e),t}(qt),di=function(e){function t(t){var n;void 0===t&&(t={});var i=je(t,{kind:Bt[t.kind]||""});n=e.call(this,i)||this;var r=!1;return Object.defineProperty(o(n),"selected",{get:function(){return r},set:function(e){"boolean"==typeof e&&e!==r&&(r=e,this.trigger("selectedchange"))}}),i.selected&&(n.selected=i.selected),n}return i(t,e),t}(qt),hi=0,pi=2,fi=function(e){function t(t){var n,i;void 0===t&&(t={}),n=e.call(this)||this;var r=new ui(t);return n.kind=r.kind,n.src=r.src,n.srclang=r.language,n.label=r.label,n.default=r.default,Object.defineProperties(o(n),{readyState:{get:function(){return i}},track:{get:function(){return r}}}),i=hi,r.addEventListener("loadeddata",function(){i=pi,n.trigger({type:"load",target:o(n)})}),n}return i(t,e),t}(ke);fi.prototype.allowedEvents_={load:"load"},fi.NONE=hi,fi.LOADING=1,fi.LOADED=pi,fi.ERROR=3;var gi={audio:{ListClass:Lt,TrackClass:ci,capitalName:"Audio"},video:{ListClass:Mt,TrackClass:di,capitalName:"Video"},text:{ListClass:Kt,TrackClass:ui,capitalName:"Text"}};Object.keys(gi).forEach(function(e){gi[e].getterName=e+"Tracks",gi[e].privateName=e+"Tracks_"});var mi={remoteText:{ListClass:Kt,TrackClass:ui,capitalName:"RemoteText",getterName:"remoteTextTracks",privateName:"remoteTextTracks_"},remoteTextEl:{ListClass:$t,TrackClass:fi,capitalName:"RemoteTextTrackEls",getterName:"remoteTextTrackEls",privateName:"remoteTextTrackEls_"}},vi=je(gi,mi);mi.names=Object.keys(mi),gi.names=Object.keys(gi),vi.names=[].concat(mi.names).concat(gi.names);var yi=Object.create||function(){function e(){}return function(t){if(1!==arguments.length)throw new Error("Object.create shim only accepts one parameter.");return e.prototype=t,new e}}();function bi(e,t){this.name="ParsingError",this.code=e.code,this.message=t||e.message}function _i(e){function t(e,t,n,i){return 3600*(0|e)+60*(0|t)+(0|n)+(0|i)/1e3}var n=e.match(/^(\d+):(\d{2})(:\d{2})?\.(\d{3})/);return n?n[3]?t(n[1],n[2],n[3].replace(":",""),n[4]):n[1]>59?t(n[1],n[2],0,n[4]):t(0,n[1],n[2],n[4]):null}function Ti(){this.values=yi(null)}function Ei(e,t,n,i){var r=i?e.split(i):[e];for(var a in r)if("string"==typeof r[a]){var o=r[a].split(n);if(2===o.length)t(o[0],o[1])}}function Ci(e,t,n){var i=e;function r(){var t=_i(e);if(null===t)throw new bi(bi.Errors.BadTimeStamp,"Malformed timestamp: "+i);return e=e.replace(/^[^\sa-zA-Z-]+/,""),t}function a(){e=e.replace(/^\s+/,"")}if(a(),t.startTime=r(),a(),"--\x3e"!==e.substr(0,3))throw new bi(bi.Errors.BadTimeStamp,"Malformed time stamp (time stamps must be separated by '--\x3e'): "+i);e=e.substr(3),a(),t.endTime=r(),a(),function(e,t){var i=new Ti;Ei(e,function(e,t){switch(e){case"region":for(var r=n.length-1;r>=0;r--)if(n[r].id===t){i.set(e,n[r].region);break}break;case"vertical":i.alt(e,t,["rl","lr"]);break;case"line":var a=t.split(","),o=a[0];i.integer(e,o),i.percent(e,o)&&i.set("snapToLines",!1),i.alt(e,o,["auto"]),2===a.length&&i.alt("lineAlign",a[1],["start","middle","end"]);break;case"position":a=t.split(","),i.percent(e,a[0]),2===a.length&&i.alt("positionAlign",a[1],["start","middle","end"]);break;case"size":i.percent(e,t);break;case"align":i.alt(e,t,["start","middle","end","left","right"])}},/:/,/\s/),t.region=i.get("region",null),t.vertical=i.get("vertical",""),t.line=i.get("line","auto"),t.lineAlign=i.get("lineAlign","start"),t.snapToLines=i.get("snapToLines",!0),t.size=i.get("size",100),t.align=i.get("align","middle"),t.position=i.get("position",{start:0,left:0,middle:50,end:100,right:100},t.align),t.positionAlign=i.get("positionAlign",{start:"start",left:"start",middle:"middle",end:"end",right:"end"},t.align)}(e,t)}bi.prototype=yi(Error.prototype),bi.prototype.constructor=bi,bi.Errors={BadSignature:{code:0,message:"Malformed WebVTT signature."},BadTimeStamp:{code:1,message:"Malformed time stamp."}},Ti.prototype={set:function(e,t){this.get(e)||""===t||(this.values[e]=t)},get:function(e,t,n){return n?this.has(e)?this.values[e]:t[n]:this.has(e)?this.values[e]:t},has:function(e){return e in this.values},alt:function(e,t,n){for(var i=0;i<n.length;++i)if(t===n[i]){this.set(e,t);break}},integer:function(e,t){/^-?\d+$/.test(t)&&this.set(e,parseInt(t,10))},percent:function(e,t){return!!(t.match(/^([\d]{1,3})(\.[\d]*)?%$/)&&(t=parseFloat(t))>=0&&t<=100)&&(this.set(e,t),!0)}};var wi={"&amp;":"&","&lt;":"<","&gt;":">","&lrm;":"‎","&rlm;":"‏","&nbsp;":" "},ki={c:"span",i:"i",b:"b",u:"u",ruby:"ruby",rt:"rt",v:"span",lang:"span"},Si={v:"title",lang:"lang"},Ii={rt:"ruby"};function Oi(e,t){function n(){if(!t)return null;var e,n=t.match(/^([^<]*)(<[^>]*>?)?/);return e=n[1]?n[1]:n[2],t=t.substr(e.length),e}function i(e){return wi[e]}function r(e){for(;p=e.match(/&(amp|lt|gt|lrm|rlm|nbsp);/);)e=e.replace(p[0],i);return e}function a(e,t){return!Ii[t.localName]||Ii[t.localName]===e.localName}function o(t,n){var i=ki[t];if(!i)return null;var r=e.document.createElement(i);r.localName=i;var a=Si[t];return a&&n&&(r[a]=n.trim()),r}for(var s,l=e.document.createElement("div"),u=l,c=[];null!==(s=n());)if("<"!==s[0])u.appendChild(e.document.createTextNode(r(s)));else{if("/"===s[1]){c.length&&c[c.length-1]===s.substr(2).replace(">","")&&(c.pop(),u=u.parentNode);continue}var d,h=_i(s.substr(1,s.length-2));if(h){d=e.document.createProcessingInstruction("timestamp",h),u.appendChild(d);continue}var p=s.match(/^<([^.\s/0-9>]+)(\.[^\s\\>]+)?([^>\\]+)?(\\?)>?$/);if(!p)continue;if(!(d=o(p[1],p[3])))continue;if(!a(u,d))continue;p[2]&&(d.className=p[2].substr(1).replace("."," ")),c.push(p[1]),u.appendChild(d),u=d}return l}var Di=[[1470,1470],[1472,1472],[1475,1475],[1478,1478],[1488,1514],[1520,1524],[1544,1544],[1547,1547],[1549,1549],[1563,1563],[1566,1610],[1645,1647],[1649,1749],[1765,1766],[1774,1775],[1786,1805],[1807,1808],[1810,1839],[1869,1957],[1969,1969],[1984,2026],[2036,2037],[2042,2042],[2048,2069],[2074,2074],[2084,2084],[2088,2088],[2096,2110],[2112,2136],[2142,2142],[2208,2208],[2210,2220],[8207,8207],[64285,64285],[64287,64296],[64298,64310],[64312,64316],[64318,64318],[64320,64321],[64323,64324],[64326,64449],[64467,64829],[64848,64911],[64914,64967],[65008,65020],[65136,65140],[65142,65276],[67584,67589],[67592,67592],[67594,67637],[67639,67640],[67644,67644],[67647,67669],[67671,67679],[67840,67867],[67872,67897],[67903,67903],[67968,68023],[68030,68031],[68096,68096],[68112,68115],[68117,68119],[68121,68147],[68160,68167],[68176,68184],[68192,68223],[68352,68405],[68416,68437],[68440,68466],[68472,68479],[68608,68680],[126464,126467],[126469,126495],[126497,126498],[126500,126500],[126503,126503],[126505,126514],[126516,126519],[126521,126521],[126523,126523],[126530,126530],[126535,126535],[126537,126537],[126539,126539],[126541,126543],[126545,126546],[126548,126548],[126551,126551],[126553,126553],[126555,126555],[126557,126557],[126559,126559],[126561,126562],[126564,126564],[126567,126570],[126572,126578],[126580,126583],[126585,126588],[126590,126590],[126592,126601],[126603,126619],[126625,126627],[126629,126633],[126635,126651],[1114109,1114109]];function Ri(e){for(var t=0;t<Di.length;t++){var n=Di[t];if(e>=n[0]&&e<=n[1])return!0}return!1}function xi(){}function Ai(e,t,n){xi.call(this),this.cue=t,this.cueDiv=Oi(e,t.text);var i={color:"rgba(255, 255, 255, 1)",backgroundColor:"rgba(0, 0, 0, 0.8)",position:"relative",left:0,right:0,top:0,bottom:0,display:"inline",writingMode:""===t.vertical?"horizontal-tb":"lr"===t.vertical?"vertical-lr":"vertical-rl",unicodeBidi:"plaintext"};this.applyStyles(i,this.cueDiv),this.div=e.document.createElement("div"),i={direction:function(e){var t=[],n="";if(!e||!e.childNodes)return"ltr";function i(e,t){for(var n=t.childNodes.length-1;n>=0;n--)e.push(t.childNodes[n])}function r(e){if(!e||!e.length)return null;var t=e.pop(),n=t.textContent||t.innerText;if(n){var a=n.match(/^.*(\n|\r)/);return a?(e.length=0,a[0]):n}return"ruby"===t.tagName?r(e):t.childNodes?(i(e,t),r(e)):void 0}for(i(t,e);n=r(t);)for(var a=0;a<n.length;a++)if(Ri(n.charCodeAt(a)))return"rtl";return"ltr"}(this.cueDiv),writingMode:""===t.vertical?"horizontal-tb":"lr"===t.vertical?"vertical-lr":"vertical-rl",unicodeBidi:"plaintext",textAlign:"middle"===t.align?"center":t.align,font:n.font,whiteSpace:"pre-line",position:"absolute"},this.applyStyles(i),this.div.appendChild(this.cueDiv);var r=0;switch(t.positionAlign){case"start":r=t.position;break;case"middle":r=t.position-t.size/2;break;case"end":r=t.position-t.size}""===t.vertical?this.applyStyles({left:this.formatStyle(r,"%"),width:this.formatStyle(t.size,"%")}):this.applyStyles({top:this.formatStyle(r,"%"),height:this.formatStyle(t.size,"%")}),this.move=function(e){this.applyStyles({top:this.formatStyle(e.top,"px"),bottom:this.formatStyle(e.bottom,"px"),left:this.formatStyle(e.left,"px"),right:this.formatStyle(e.right,"px"),height:this.formatStyle(e.height,"px"),width:this.formatStyle(e.width,"px")})}}function Pi(e){var t,n,i,r;if(e.div){n=e.div.offsetHeight,i=e.div.offsetWidth,r=e.div.offsetTop;var a=(a=e.div.childNodes)&&(a=a[0])&&a.getClientRects&&a.getClientRects();e=e.div.getBoundingClientRect(),t=a?Math.max(a[0]&&a[0].height||0,e.height/a.length):0}this.left=e.left,this.right=e.right,this.top=e.top||r,this.height=e.height||n,this.bottom=e.bottom||r+(e.height||n),this.width=e.width||i,this.lineHeight=void 0!==t?t:e.lineHeight}function Li(e,t,n,i){var r=new Pi(t),a=t.cue,o=function(e){if("number"==typeof e.line&&(e.snapToLines||e.line>=0&&e.line<=100))return e.line;if(!e.track||!e.track.textTrackList||!e.track.textTrackList.mediaElement)return-1;for(var t=e.track,n=t.textTrackList,i=0,r=0;r<n.length&&n[r]!==t;r++)"showing"===n[r].mode&&i++;return-1*++i}(a),s=[];if(a.snapToLines){var l;switch(a.vertical){case"":s=["+y","-y"],l="height";break;case"rl":s=["+x","-x"],l="width";break;case"lr":s=["-x","+x"],l="width"}var u=r.lineHeight,c=u*Math.round(o),d=n[l]+u,h=s[0];Math.abs(c)>d&&(c=c<0?-1:1,c*=Math.ceil(d/u)*u),o<0&&(c+=""===a.vertical?n.height:n.width,s=s.reverse()),r.move(h,c)}else{var p=r.lineHeight/n.height*100;switch(a.lineAlign){case"middle":o-=p/2;break;case"end":o-=p}switch(a.vertical){case"":t.applyStyles({top:t.formatStyle(o,"%")});break;case"rl":t.applyStyles({left:t.formatStyle(o,"%")});break;case"lr":t.applyStyles({right:t.formatStyle(o,"%")})}s=["+y","-x","+x","-y"],r=new Pi(t)}var f=function(e,t){for(var r,a=new Pi(e),o=1,s=0;s<t.length;s++){for(;e.overlapsOppositeAxis(n,t[s])||e.within(n)&&e.overlapsAny(i);)e.move(t[s]);if(e.within(n))return e;var l=e.intersectPercentage(n);o>l&&(r=new Pi(e),o=l),e=new Pi(a)}return r||a}(r,s);t.move(f.toCSSCompatValues(n))}function Ni(){}xi.prototype.applyStyles=function(e,t){for(var n in t=t||this.div,e)e.hasOwnProperty(n)&&(t.style[n]=e[n])},xi.prototype.formatStyle=function(e,t){return 0===e?0:e+t},Ai.prototype=yi(xi.prototype),Ai.prototype.constructor=Ai,Pi.prototype.move=function(e,t){switch(t=void 0!==t?t:this.lineHeight,e){case"+x":this.left+=t,this.right+=t;break;case"-x":this.left-=t,this.right-=t;break;case"+y":this.top+=t,this.bottom+=t;break;case"-y":this.top-=t,this.bottom-=t}},Pi.prototype.overlaps=function(e){return this.left<e.right&&this.right>e.left&&this.top<e.bottom&&this.bottom>e.top},Pi.prototype.overlapsAny=function(e){for(var t=0;t<e.length;t++)if(this.overlaps(e[t]))return!0;return!1},Pi.prototype.within=function(e){return this.top>=e.top&&this.bottom<=e.bottom&&this.left>=e.left&&this.right<=e.right},Pi.prototype.overlapsOppositeAxis=function(e,t){switch(t){case"+x":return this.left<e.left;case"-x":return this.right>e.right;case"+y":return this.top<e.top;case"-y":return this.bottom>e.bottom}},Pi.prototype.intersectPercentage=function(e){return Math.max(0,Math.min(this.right,e.right)-Math.max(this.left,e.left))*Math.max(0,Math.min(this.bottom,e.bottom)-Math.max(this.top,e.top))/(this.height*this.width)},Pi.prototype.toCSSCompatValues=function(e){return{top:this.top-e.top,bottom:e.bottom-this.bottom,left:this.left-e.left,right:e.right-this.right,height:this.height,width:this.width}},Pi.getSimpleBoxPosition=function(e){var t=e.div?e.div.offsetHeight:e.tagName?e.offsetHeight:0,n=e.div?e.div.offsetWidth:e.tagName?e.offsetWidth:0,i=e.div?e.div.offsetTop:e.tagName?e.offsetTop:0;return{left:(e=e.div?e.div.getBoundingClientRect():e.tagName?e.getBoundingClientRect():e).left,right:e.right,top:e.top||i,height:e.height||t,bottom:e.bottom||i+(e.height||t),width:e.width||n}},Ni.StringDecoder=function(){return{decode:function(e){if(!e)return"";if("string"!=typeof e)throw new Error("Error - expected string data.");return decodeURIComponent(encodeURIComponent(e))}}},Ni.convertCueToDOMTree=function(e,t){return e&&t?Oi(e,t):null},Ni.processCues=function(e,t,n){if(!e||!t||!n)return null;for(;n.firstChild;)n.removeChild(n.firstChild);var i=e.document.createElement("div");if(i.style.position="absolute",i.style.left="0",i.style.right="0",i.style.top="0",i.style.bottom="0",i.style.margin="1.5%",n.appendChild(i),function(e){for(var t=0;t<e.length;t++)if(e[t].hasBeenReset||!e[t].displayState)return!0;return!1}(t)){var r=[],a=Pi.getSimpleBoxPosition(i),o={font:Math.round(.05*a.height*100)/100+"px sans-serif"};!function(){for(var n,s,l=0;l<t.length;l++)s=t[l],n=new Ai(e,s,o),i.appendChild(n.div),Li(0,n,a,r),s.displayState=n.div,r.push(Pi.getSimpleBoxPosition(n))}()}else for(var s=0;s<t.length;s++)i.appendChild(t[s].displayState)},Ni.Parser=function(e,t,n){n||(n=t,t={}),t||(t={}),this.window=e,this.vttjs=t,this.state="INITIAL",this.buffer="",this.decoder=n||new TextDecoder("utf8"),this.regionList=[]},Ni.Parser.prototype={reportOrThrowError:function(e){if(!(e instanceof bi))throw e;this.onparsingerror&&this.onparsingerror(e)},parse:function(e){var t=this;function n(){for(var e=t.buffer,n=0;n<e.length&&"\r"!==e[n]&&"\n"!==e[n];)++n;var i=e.substr(0,n);return"\r"===e[n]&&++n,"\n"===e[n]&&++n,t.buffer=e.substr(n),i}function i(e){e.match(/X-TIMESTAMP-MAP/)?Ei(e,function(e,n){switch(e){case"X-TIMESTAMP-MAP":i=n,r=new Ti,Ei(i,function(e,t){switch(e){case"MPEGT":r.integer(e+"S",t);break;case"LOCA":r.set(e+"L",_i(t))}},/[^\d]:/,/,/),t.ontimestampmap&&t.ontimestampmap({MPEGTS:r.get("MPEGTS"),LOCAL:r.get("LOCAL")})}var i,r},/=/):Ei(e,function(e,n){switch(e){case"Region":!function(e){var n=new Ti;if(Ei(e,function(e,t){switch(e){case"id":n.set(e,t);break;case"width":n.percent(e,t);break;case"lines":n.integer(e,t);break;case"regionanchor":case"viewportanchor":var i=t.split(",");if(2!==i.length)break;var r=new Ti;if(r.percent("x",i[0]),r.percent("y",i[1]),!r.has("x")||!r.has("y"))break;n.set(e+"X",r.get("x")),n.set(e+"Y",r.get("y"));break;case"scroll":n.alt(e,t,["up"])}},/=/,/\s/),n.has("id")){var i=new(t.vttjs.VTTRegion||t.window.VTTRegion);i.width=n.get("width",100),i.lines=n.get("lines",3),i.regionAnchorX=n.get("regionanchorX",0),i.regionAnchorY=n.get("regionanchorY",100),i.viewportAnchorX=n.get("viewportanchorX",0),i.viewportAnchorY=n.get("viewportanchorY",100),i.scroll=n.get("scroll",""),t.onregion&&t.onregion(i),t.regionList.push({id:n.get("id"),region:i})}}(n)}},/:/)}e&&(t.buffer+=t.decoder.decode(e,{stream:!0}));try{var r;if("INITIAL"===t.state){if(!/\r\n|\n/.test(t.buffer))return this;var a=(r=n()).match(/^WEBVTT([ \t].*)?$/);if(!a||!a[0])throw new bi(bi.Errors.BadSignature);t.state="HEADER"}for(var o=!1;t.buffer;){if(!/\r\n|\n/.test(t.buffer))return this;switch(o?o=!1:r=n(),t.state){case"HEADER":/:/.test(r)?i(r):r||(t.state="ID");continue;case"NOTE":r||(t.state="ID");continue;case"ID":if(/^NOTE($|[ \t])/.test(r)){t.state="NOTE";break}if(!r)continue;if(t.cue=new(t.vttjs.VTTCue||t.window.VTTCue)(0,0,""),t.state="CUE",-1===r.indexOf("--\x3e")){t.cue.id=r;continue}case"CUE":try{Ci(r,t.cue,t.regionList)}catch(e){t.reportOrThrowError(e),t.cue=null,t.state="BADCUE";continue}t.state="CUETEXT";continue;case"CUETEXT":var s=-1!==r.indexOf("--\x3e");if(!r||s&&(o=!0)){t.oncue&&t.oncue(t.cue),t.cue=null,t.state="ID";continue}t.cue.text&&(t.cue.text+="\n"),t.cue.text+=r;continue;case"BADCUE":r||(t.state="ID");continue}}}catch(e){t.reportOrThrowError(e),"CUETEXT"===t.state&&t.cue&&t.oncue&&t.oncue(t.cue),t.cue=null,t.state="INITIAL"===t.state?"BADWEBVTT":"BADCUE"}return this},flush:function(){try{if(this.buffer+=this.decoder.decode(),(this.cue||"HEADER"===this.state)&&(this.buffer+="\n\n",this.parse()),"INITIAL"===this.state)throw new bi(bi.Errors.BadSignature)}catch(e){this.reportOrThrowError(e)}return this.onflush&&this.onflush(),this}};var Mi=Ni,Ki="auto",$i={"":1,lr:1,rl:1},ji={start:1,middle:1,end:1,left:1,right:1};function Bi(e){return"string"==typeof e&&(!!ji[e.toLowerCase()]&&e.toLowerCase())}function Fi(e,t,n){this.hasBeenReset=!1;var i="",r=!1,a=e,o=t,s=n,l=null,u="",c=!0,d="auto",h="start",p=50,f="middle",g=50,m="middle";Object.defineProperties(this,{id:{enumerable:!0,get:function(){return i},set:function(e){i=""+e}},pauseOnExit:{enumerable:!0,get:function(){return r},set:function(e){r=!!e}},startTime:{enumerable:!0,get:function(){return a},set:function(e){if("number"!=typeof e)throw new TypeError("Start time must be set to a number.");a=e,this.hasBeenReset=!0}},endTime:{enumerable:!0,get:function(){return o},set:function(e){if("number"!=typeof e)throw new TypeError("End time must be set to a number.");o=e,this.hasBeenReset=!0}},text:{enumerable:!0,get:function(){return s},set:function(e){s=""+e,this.hasBeenReset=!0}},region:{enumerable:!0,get:function(){return l},set:function(e){l=e,this.hasBeenReset=!0}},vertical:{enumerable:!0,get:function(){return u},set:function(e){var t=function(e){return"string"==typeof e&&!!$i[e.toLowerCase()]&&e.toLowerCase()}(e);if(!1===t)throw new SyntaxError("An invalid or illegal string was specified.");u=t,this.hasBeenReset=!0}},snapToLines:{enumerable:!0,get:function(){return c},set:function(e){c=!!e,this.hasBeenReset=!0}},line:{enumerable:!0,get:function(){return d},set:function(e){if("number"!=typeof e&&e!==Ki)throw new SyntaxError("An invalid number or illegal string was specified.");d=e,this.hasBeenReset=!0}},lineAlign:{enumerable:!0,get:function(){return h},set:function(e){var t=Bi(e);if(!t)throw new SyntaxError("An invalid or illegal string was specified.");h=t,this.hasBeenReset=!0}},position:{enumerable:!0,get:function(){return p},set:function(e){if(e<0||e>100)throw new Error("Position must be between 0 and 100.");p=e,this.hasBeenReset=!0}},positionAlign:{enumerable:!0,get:function(){return f},set:function(e){var t=Bi(e);if(!t)throw new SyntaxError("An invalid or illegal string was specified.");f=t,this.hasBeenReset=!0}},size:{enumerable:!0,get:function(){return g},set:function(e){if(e<0||e>100)throw new Error("Size must be between 0 and 100.");g=e,this.hasBeenReset=!0}},align:{enumerable:!0,get:function(){return m},set:function(e){var t=Bi(e);if(!t)throw new SyntaxError("An invalid or illegal string was specified.");m=t,this.hasBeenReset=!0}}}),this.displayState=void 0}Fi.prototype.getCueAsHTML=function(){return WebVTT.convertCueToDOMTree(window,this.text)};var Ui=Fi,Vi={"":!0,up:!0};function qi(e){return"number"==typeof e&&e>=0&&e<=100}var Hi=function(){var e=100,t=3,n=0,i=100,r=0,a=100,o="";Object.defineProperties(this,{width:{enumerable:!0,get:function(){return e},set:function(t){if(!qi(t))throw new Error("Width must be between 0 and 100.");e=t}},lines:{enumerable:!0,get:function(){return t},set:function(e){if("number"!=typeof e)throw new TypeError("Lines must be set to a number.");t=e}},regionAnchorY:{enumerable:!0,get:function(){return i},set:function(e){if(!qi(e))throw new Error("RegionAnchorX must be between 0 and 100.");i=e}},regionAnchorX:{enumerable:!0,get:function(){return n},set:function(e){if(!qi(e))throw new Error("RegionAnchorY must be between 0 and 100.");n=e}},viewportAnchorY:{enumerable:!0,get:function(){return a},set:function(e){if(!qi(e))throw new Error("ViewportAnchorY must be between 0 and 100.");a=e}},viewportAnchorX:{enumerable:!0,get:function(){return r},set:function(e){if(!qi(e))throw new Error("ViewportAnchorX must be between 0 and 100.");r=e}},scroll:{enumerable:!0,get:function(){return o},set:function(e){var t=function(e){return"string"==typeof e&&!!Vi[e.toLowerCase()]&&e.toLowerCase()}(e);if(!1===t)throw new SyntaxError("An invalid or illegal string was specified.");o=t}}})},zi=St(function(t){var n=t.exports={WebVTT:Mi,VTTCue:Ui,VTTRegion:Hi};e.vttjs=n,e.WebVTT=n.WebVTT;var i=n.VTTCue,r=n.VTTRegion,a=e.VTTCue,o=e.VTTRegion;n.shim=function(){e.VTTCue=i,e.VTTRegion=r},n.restore=function(){e.VTTCue=a,e.VTTRegion=o},e.VTTCue||n.shim()});zi.WebVTT,zi.VTTCue,zi.VTTRegion;var Wi=function(n){function r(e,t){var i;return void 0===e&&(e={}),void 0===t&&(t=function(){}),e.reportTouchActivity=!1,(i=n.call(this,null,e,t)||this).hasStarted_=!1,i.on("playing",function(){this.hasStarted_=!0}),i.on("loadstart",function(){this.hasStarted_=!1}),vi.names.forEach(function(t){var n=vi[t];e&&e[n.getterName]&&(i[n.privateName]=e[n.getterName])}),i.featuresProgressEvents||i.manualProgressOn(),i.featuresTimeupdateEvents||i.manualTimeUpdatesOn(),["Text","Audio","Video"].forEach(function(t){!1===e["native"+t+"Tracks"]&&(i["featuresNative"+t+"Tracks"]=!1)}),!1===e.nativeCaptions||!1===e.nativeTextTracks?i.featuresNativeTextTracks=!1:!0!==e.nativeCaptions&&!0!==e.nativeTextTracks||(i.featuresNativeTextTracks=!0),i.featuresNativeTextTracks||i.emulateTextTracks(),i.autoRemoteTextTracks_=new vi.text.ListClass,i.initTrackListeners(),e.nativeControlsForTouch||i.emitTapEvents(),i.constructor&&(i.name_=i.constructor.name||"Unknown Tech"),i}i(r,n);var a=r.prototype;return a.triggerSourceset=function(e){var t=this;this.isReady_||this.one("ready",function(){return t.setTimeout(function(){return t.triggerSourceset(e)},1)}),this.trigger({src:e,type:"sourceset"})},a.manualProgressOn=function(){this.on("durationchange",this.onDurationChange),this.manualProgress=!0,this.one("ready",this.trackProgress)},a.manualProgressOff=function(){this.manualProgress=!1,this.stopTrackingProgress(),this.off("durationchange",this.onDurationChange)},a.trackProgress=function(e){this.stopTrackingProgress(),this.progressInterval=this.setInterval(Ee(this,function(){var e=this.bufferedPercent();this.bufferedPercent_!==e&&this.trigger("progress"),this.bufferedPercent_=e,1===e&&this.stopTrackingProgress()}),500)},a.onDurationChange=function(e){this.duration_=this.duration()},a.buffered=function(){return dt(0,0)},a.bufferedPercent=function(){return ht(this.buffered(),this.duration_)},a.stopTrackingProgress=function(){this.clearInterval(this.progressInterval)},a.manualTimeUpdatesOn=function(){this.manualTimeUpdates=!0,this.on("play",this.trackCurrentTime),this.on("pause",this.stopTrackingCurrentTime)},a.manualTimeUpdatesOff=function(){this.manualTimeUpdates=!1,this.stopTrackingCurrentTime(),this.off("play",this.trackCurrentTime),this.off("pause",this.stopTrackingCurrentTime)},a.trackCurrentTime=function(){this.currentTimeInterval&&this.stopTrackingCurrentTime(),this.currentTimeInterval=this.setInterval(function(){this.trigger({type:"timeupdate",target:this,manuallyTriggered:!0})},250)},a.stopTrackingCurrentTime=function(){this.clearInterval(this.currentTimeInterval),this.trigger({type:"timeupdate",target:this,manuallyTriggered:!0})},a.dispose=function(){this.clearTracks(gi.names),this.manualProgress&&this.manualProgressOff(),this.manualTimeUpdates&&this.manualTimeUpdatesOff(),n.prototype.dispose.call(this)},a.clearTracks=function(e){var t=this;(e=[].concat(e)).forEach(function(e){for(var n=t[e+"Tracks"]()||[],i=n.length;i--;){var r=n[i];"text"===e&&t.removeRemoteTextTrack(r),n.removeTrack(r)}})},a.cleanupAutoTextTracks=function(){for(var e=this.autoRemoteTextTracks_||[],t=e.length;t--;){var n=e[t];this.removeRemoteTextTrack(n)}},a.reset=function(){},a.error=function(e){return void 0!==e&&(this.error_=new bt(e),this.trigger("error")),this.error_},a.played=function(){return this.hasStarted_?dt(0,0):dt()},a.setCurrentTime=function(){this.manualTimeUpdates&&this.trigger({type:"timeupdate",target:this,manuallyTriggered:!0})},a.initTrackListeners=function(){var e=this;gi.names.forEach(function(t){var n=gi[t],i=function(){e.trigger(t+"trackchange")},r=e[n.getterName]();r.addEventListener("removetrack",i),r.addEventListener("addtrack",i),e.on("dispose",function(){r.removeEventListener("removetrack",i),r.removeEventListener("addtrack",i)})})},a.addWebVttScript_=function(){var n=this;if(!e.WebVTT)if(t.body.contains(this.el())){if(!this.options_["vtt.js"]&&b(zi)&&Object.keys(zi).length>0)return void this.trigger("vttjsloaded");var i=t.createElement("script");i.src=this.options_["vtt.js"]||"https://vjs.zencdn.net/vttjs/0.14.1/vtt.min.js",i.onload=function(){n.trigger("vttjsloaded")},i.onerror=function(){n.trigger("vttjserror")},this.on("dispose",function(){i.onload=null,i.onerror=null}),e.WebVTT=!0,this.el().parentNode.appendChild(i)}else this.ready(this.addWebVttScript_)},a.emulateTextTracks=function(){var e=this,t=this.textTracks(),n=this.remoteTextTracks(),i=function(e){return t.addTrack(e.track)},r=function(e){return t.removeTrack(e.track)};n.on("addtrack",i),n.on("removetrack",r),this.addWebVttScript_();var a=function(){return e.trigger("texttrackchange")},o=function(){a();for(var e=0;e<t.length;e++){var n=t[e];n.removeEventListener("cuechange",a),"showing"===n.mode&&n.addEventListener("cuechange",a)}};o(),t.addEventListener("change",o),t.addEventListener("addtrack",o),t.addEventListener("removetrack",o),this.on("dispose",function(){n.off("addtrack",i),n.off("removetrack",r),t.removeEventListener("change",o),t.removeEventListener("addtrack",o),t.removeEventListener("removetrack",o);for(var e=0;e<t.length;e++){t[e].removeEventListener("cuechange",a)}})},a.addTextTrack=function(e,t,n){if(!e)throw new Error("TextTrack kind is required but was not provided");return function(e,t,n,i,r){void 0===r&&(r={});var a=e.textTracks();r.kind=t,n&&(r.label=n),i&&(r.language=i),r.tech=e;var o=new vi.text.TrackClass(r);return a.addTrack(o),o}(this,e,t,n)},a.createRemoteTextTrack=function(e){var t=je(e,{tech:this});return new mi.remoteTextEl.TrackClass(t)},a.addRemoteTextTrack=function(e,t){var n=this;void 0===e&&(e={});var i=this.createRemoteTextTrack(e);return!0!==t&&!1!==t&&(c.warn('Calling addRemoteTextTrack without explicitly setting the "manualCleanup" parameter to `true` is deprecated and default to `false` in future version of video.js'),t=!0),this.remoteTextTrackEls().addTrackElement_(i),this.remoteTextTracks().addTrack(i.track),!0!==t&&this.ready(function(){return n.autoRemoteTextTracks_.addTrack(i.track)}),i},a.removeRemoteTextTrack=function(e){var t=this.remoteTextTrackEls().getTrackElementByTrack_(e);this.remoteTextTrackEls().removeTrackElement_(t),this.remoteTextTracks().removeTrack(e),this.autoRemoteTextTracks_.removeTrack(e)},a.getVideoPlaybackQuality=function(){return{}},a.requestPictureInPicture=function(){var t=this.options_.Promise||e.Promise;if(t)return t.reject()},a.setPoster=function(){},a.playsinline=function(){},a.setPlaysinline=function(){},a.overrideNativeAudioTracks=function(){},a.overrideNativeVideoTracks=function(){},a.canPlayType=function(){return""},r.canPlayType=function(){return""},r.canPlaySource=function(e,t){return r.canPlayType(e.type)},r.isTech=function(e){return e.prototype instanceof r||e instanceof r||e===r},r.registerTech=function(e,t){if(r.techs_||(r.techs_={}),!r.isTech(t))throw new Error("Tech "+e+" must be a Tech");if(!r.canPlayType)throw new Error("Techs must have a static canPlayType method on them");if(!r.canPlaySource)throw new Error("Techs must have a static canPlaySource method on them");return e=$e(e),r.techs_[e]=t,r.techs_[Ke(e)]=t,"Tech"!==e&&r.defaultTechOrder_.push(e),t},r.getTech=function(t){if(t)return r.techs_&&r.techs_[t]?r.techs_[t]:(t=$e(t),e&&e.videojs&&e.videojs[t]?(c.warn("The "+t+" tech was added to the videojs object when it should be registered using videojs.registerTech(name, tech)"),e.videojs[t]):void 0)},r}(Be);vi.names.forEach(function(e){var t=vi[e];Wi.prototype[t.getterName]=function(){return this[t.privateName]=this[t.privateName]||new t.ListClass,this[t.privateName]}}),Wi.prototype.featuresVolumeControl=!0,Wi.prototype.featuresMuteControl=!0,Wi.prototype.featuresFullscreenResize=!1,Wi.prototype.featuresPlaybackRate=!1,Wi.prototype.featuresProgressEvents=!1,Wi.prototype.featuresSourceset=!1,Wi.prototype.featuresTimeupdateEvents=!1,Wi.prototype.featuresNativeTextTracks=!1,Wi.withSourceHandlers=function(e){e.registerSourceHandler=function(t,n){var i=e.sourceHandlers;i||(i=e.sourceHandlers=[]),void 0===n&&(n=i.length),i.splice(n,0,t)},e.canPlayType=function(t){for(var n,i=e.sourceHandlers||[],r=0;r<i.length;r++)if(n=i[r].canPlayType(t))return n;return""},e.selectSourceHandler=function(t,n){for(var i=e.sourceHandlers||[],r=0;r<i.length;r++)if(i[r].canHandleSource(t,n))return i[r];return null},e.canPlaySource=function(t,n){var i=e.selectSourceHandler(t,n);return i?i.canHandleSource(t,n):""},["seekable","seeking","duration"].forEach(function(e){var t=this[e];"function"==typeof t&&(this[e]=function(){return this.sourceHandler_&&this.sourceHandler_[e]?this.sourceHandler_[e].apply(this.sourceHandler_,arguments):t.apply(this,arguments)})},e.prototype),e.prototype.setSource=function(t){var n=e.selectSourceHandler(t,this.options_);n||(e.nativeSourceHandler?n=e.nativeSourceHandler:c.error("No source handler found for the current source.")),this.disposeSourceHandler(),this.off("dispose",this.disposeSourceHandler),n!==e.nativeSourceHandler&&(this.currentSource_=t),this.sourceHandler_=n.handleSource(t,this,this.options_),this.one("dispose",this.disposeSourceHandler)},e.prototype.disposeSourceHandler=function(){this.currentSource_&&(this.clearTracks(["audio","video"]),this.currentSource_=null),this.cleanupAutoTextTracks(),this.sourceHandler_&&(this.sourceHandler_.dispose&&this.sourceHandler_.dispose(),this.sourceHandler_=null)}},Be.registerComponent("Tech",Wi),Wi.registerTech("Tech",Wi),Wi.defaultTechOrder_=[];var Gi={},Xi={},Yi={};function Qi(e,t,n,i){void 0===i&&(i=null);var r="call"+$e(n),a=e.reduce(tr(r),i),o=a===Yi,s=o?null:t[n](a);return function(e,t,n,i){for(var r=e.length-1;r>=0;r--){var a=e[r];a[t]&&a[t](i,n)}}(e,n,s,o),s}var Ji={buffered:1,currentTime:1,duration:1,seekable:1,played:1,paused:1,volume:1},Zi={setCurrentTime:1,setVolume:1},er={play:1,pause:1};function tr(e){return function(t,n){return t===Yi?Yi:n[e]?n[e](t):t}}var nr={opus:"video/ogg",ogv:"video/ogg",mp4:"video/mp4",mov:"video/mp4",m4v:"video/mp4",mkv:"video/x-matroska",m4a:"audio/mp4",mp3:"audio/mpeg",aac:"audio/aac",oga:"audio/ogg",m3u8:"application/x-mpegURL",jpg:"image/jpeg",jpeg:"image/jpeg",gif:"image/gif",png:"image/png",svg:"image/svg+xml",webp:"image/webp"},ir=function(e){void 0===e&&(e="");var t=Wt(e);return nr[t.toLowerCase()]||""};function rr(e){if(!e.type){var t=ir(e.src);t&&(e.type=t)}return e}var ar=function(e){function t(t,n,i){var r,a=je({createEl:!1},n);if(r=e.call(this,t,a,i)||this,n.playerOptions.sources&&0!==n.playerOptions.sources.length)t.src(n.playerOptions.sources);else for(var o=0,s=n.playerOptions.techOrder;o<s.length;o++){var l=$e(s[o]),u=Wi.getTech(l);if(l||(u=Be.getComponent(l)),u&&u.isSupported()){t.loadTech_(l);break}}return r}return i(t,e),t}(Be);Be.registerComponent("MediaLoader",ar);var or=function(e){function t(t,n){var i;return(i=e.call(this,t,n)||this).emitTapEvents(),i.enable(),i}i(t,e);var n=t.prototype;return n.createEl=function(t,n,i){void 0===t&&(t="div"),void 0===n&&(n={}),void 0===i&&(i={}),n=v({innerHTML:'<span aria-hidden="true" class="vjs-icon-placeholder"></span>',className:this.buildCSSClass(),tabIndex:0},n),"button"===t&&c.error("Creating a ClickableComponent with an HTML element of "+t+" is not supported; use a Button instead."),i=v({role:"button"},i),this.tabIndex_=n.tabIndex;var r=e.prototype.createEl.call(this,t,n,i);return this.createControlTextEl(r),r},n.dispose=function(){this.controlTextEl_=null,e.prototype.dispose.call(this)},n.createControlTextEl=function(e){return this.controlTextEl_=O("span",{className:"vjs-control-text"},{"aria-live":"polite"}),e&&e.appendChild(this.controlTextEl_),this.controlText(this.controlText_,e),this.controlTextEl_},n.controlText=function(e,t){if(void 0===t&&(t=this.el()),void 0===e)return this.controlText_||"Need Text";var n=this.localize(e);this.controlText_=e,D(this.controlTextEl_,n),this.nonIconControl||t.setAttribute("title",n)},n.buildCSSClass=function(){return"vjs-control vjs-button "+e.prototype.buildCSSClass.call(this)},n.enable=function(){this.enabled_||(this.enabled_=!0,this.removeClass("vjs-disabled"),this.el_.setAttribute("aria-disabled","false"),void 0!==this.tabIndex_&&this.el_.setAttribute("tabIndex",this.tabIndex_),this.on(["tap","click"],this.handleClick),this.on("keydown",this.handleKeyDown))},n.disable=function(){this.enabled_=!1,this.addClass("vjs-disabled"),this.el_.setAttribute("aria-disabled","true"),void 0!==this.tabIndex_&&this.el_.removeAttribute("tabIndex"),this.off(["tap","click"],this.handleClick),this.off("keydown",this.handleKeyDown)},n.handleClick=function(e){},n.handleKeyDown=function(t){It.isEventKey(t,"Space")||It.isEventKey(t,"Enter")?(t.preventDefault(),t.stopPropagation(),this.trigger("click")):e.prototype.handleKeyDown.call(this,t)},t}(Be);Be.registerComponent("ClickableComponent",or);var sr=function(e){function t(t,n){var i;return(i=e.call(this,t,n)||this).update(),t.on("posterchange",Ee(o(i),i.update)),i}i(t,e);var n=t.prototype;return n.dispose=function(){this.player().off("posterchange",this.update),e.prototype.dispose.call(this)},n.createEl=function(){return O("div",{className:"vjs-poster",tabIndex:-1})},n.update=function(e){var t=this.player().poster();this.setSrc(t),t?this.show():this.hide()},n.setSrc=function(e){var t="";e&&(t='url("'+e+'")'),this.el_.style.backgroundImage=t},n.handleClick=function(e){this.player_.controls()&&(this.player_.tech(!0)&&this.player_.tech(!0).focus(),this.player_.paused()?Et(this.player_.play()):this.player_.pause())},t}(or);Be.registerComponent("PosterImage",sr);var lr={monospace:"monospace",sansSerif:"sans-serif",serif:"serif",monospaceSansSerif:'"Andale Mono", "Lucida Console", monospace',monospaceSerif:'"Courier New", monospace',proportionalSansSerif:"sans-serif",proportionalSerif:"serif",casual:'"Comic Sans MS", Impact, fantasy',script:'"Monotype Corsiva", cursive',smallcaps:'"Andale Mono", "Lucida Console", monospace, sans-serif'};function ur(e,t){var n;if(4===e.length)n=e[1]+e[1]+e[2]+e[2]+e[3]+e[3];else{if(7!==e.length)throw new Error("Invalid color code provided, "+e+"; must be formatted as e.g. #f0e or #f604e2.");n=e.slice(1)}return"rgba("+parseInt(n.slice(0,2),16)+","+parseInt(n.slice(2,4),16)+","+parseInt(n.slice(4,6),16)+","+t+")"}function cr(e,t,n){try{e.style[t]=n}catch(e){return}}var dr=function(t){function n(n,i,r){var a;a=t.call(this,n,i,r)||this;var s=Ee(o(a),a.updateDisplay);return n.on("loadstart",Ee(o(a),a.toggleDisplay)),n.on("texttrackchange",s),n.on("loadedmetadata",Ee(o(a),a.preselectTrack)),n.ready(Ee(o(a),function(){if(n.tech_&&n.tech_.featuresNativeTextTracks)this.hide();else{n.on("fullscreenchange",s),n.on("playerresize",s),e.addEventListener("orientationchange",s),n.on("dispose",function(){return e.removeEventListener("orientationchange",s)});for(var t=this.options_.playerOptions.tracks||[],i=0;i<t.length;i++)this.player_.addRemoteTextTrack(t[i],!0);this.preselectTrack()}})),a}i(n,t);var r=n.prototype;return r.preselectTrack=function(){for(var e,t,n,i={captions:1,subtitles:1},r=this.player_.textTracks(),a=this.player_.cache_.selectedLanguage,o=0;o<r.length;o++){var s=r[o];a&&a.enabled&&a.language&&a.language===s.language&&s.kind in i?s.kind===a.kind?n=s:n||(n=s):a&&!a.enabled?(n=null,e=null,t=null):s.default&&("descriptions"!==s.kind||e?s.kind in i&&!t&&(t=s):e=s)}n?n.mode="showing":t?t.mode="showing":e&&(e.mode="showing")},r.toggleDisplay=function(){this.player_.tech_&&this.player_.tech_.featuresNativeTextTracks?this.hide():this.show()},r.createEl=function(){return t.prototype.createEl.call(this,"div",{className:"vjs-text-track-display"},{"aria-live":"off","aria-atomic":"true"})},r.clearDisplay=function(){"function"==typeof e.WebVTT&&e.WebVTT.processCues(e,[],this.el_)},r.updateDisplay=function(){var e=this.player_.textTracks(),t=this.options_.allowMultipleShowingTracks;if(this.clearDisplay(),t){for(var n=[],i=0;i<e.length;++i){var r=e[i];"showing"===r.mode&&n.push(r)}this.updateForTrack(n)}else{for(var a=null,o=null,s=e.length;s--;){var l=e[s];"showing"===l.mode&&("descriptions"===l.kind?a=l:o=l)}o?("off"!==this.getAttribute("aria-live")&&this.setAttribute("aria-live","off"),this.updateForTrack(o)):a&&("assertive"!==this.getAttribute("aria-live")&&this.setAttribute("aria-live","assertive"),this.updateForTrack(a))}},r.updateDisplayState=function(t){for(var n=this.player_.textTrackSettings.getValues(),i=t.activeCues,r=i.length;r--;){var a=i[r];if(a){var o=a.displayState;if(n.color&&(o.firstChild.style.color=n.color),n.textOpacity&&cr(o.firstChild,"color",ur(n.color||"#fff",n.textOpacity)),n.backgroundColor&&(o.firstChild.style.backgroundColor=n.backgroundColor),n.backgroundOpacity&&cr(o.firstChild,"backgroundColor",ur(n.backgroundColor||"#000",n.backgroundOpacity)),n.windowColor&&(n.windowOpacity?cr(o,"backgroundColor",ur(n.windowColor,n.windowOpacity)):o.style.backgroundColor=n.windowColor),n.edgeStyle&&("dropshadow"===n.edgeStyle?o.firstChild.style.textShadow="2px 2px 3px #222, 2px 2px 4px #222, 2px 2px 5px #222":"raised"===n.edgeStyle?o.firstChild.style.textShadow="1px 1px #222, 2px 2px #222, 3px 3px #222":"depressed"===n.edgeStyle?o.firstChild.style.textShadow="1px 1px #ccc, 0 1px #ccc, -1px -1px #222, 0 -1px #222":"uniform"===n.edgeStyle&&(o.firstChild.style.textShadow="0 0 4px #222, 0 0 4px #222, 0 0 4px #222, 0 0 4px #222")),n.fontPercent&&1!==n.fontPercent){var s=e.parseFloat(o.style.fontSize);o.style.fontSize=s*n.fontPercent+"px",o.style.height="auto",o.style.top="auto",o.style.bottom="2px"}n.fontFamily&&"default"!==n.fontFamily&&("small-caps"===n.fontFamily?o.firstChild.style.fontVariant="small-caps":o.firstChild.style.fontFamily=lr[n.fontFamily])}}},r.updateForTrack=function(t){if(Array.isArray(t)||(t=[t]),"function"==typeof e.WebVTT&&!t.every(function(e){return!e.activeCues})){for(var n=[],i=0;i<t.length;++i)for(var r=t[i],a=0;a<r.activeCues.length;++a)n.push(r.activeCues[a]);e.WebVTT.processCues(e,n,this.el_);for(var o=0;o<t.length;++o){for(var s=t[o],l=0;l<s.activeCues.length;++l){var u=s.activeCues[l].displayState;A(u,"vjs-text-track-cue"),A(u,"vjs-text-track-cue-"+(s.language?s.language:o))}this.player_.textTrackSettings&&this.updateDisplayState(s)}}},n}(Be);Be.registerComponent("TextTrackDisplay",dr);var hr=function(e){function t(){return e.apply(this,arguments)||this}return i(t,e),t.prototype.createEl=function(){var t=this.player_.isAudio(),n=this.localize(t?"Audio Player":"Video Player"),i=O("span",{className:"vjs-control-text",innerHTML:this.localize("{1} is loading.",[n])}),r=e.prototype.createEl.call(this,"div",{className:"vjs-loading-spinner",dir:"ltr"});return r.appendChild(i),r},t}(Be);Be.registerComponent("LoadingSpinner",hr);var pr=function(e){function t(){return e.apply(this,arguments)||this}i(t,e);var n=t.prototype;return n.createEl=function(e,t,n){void 0===t&&(t={}),void 0===n&&(n={}),t=v({innerHTML:'<span aria-hidden="true" class="vjs-icon-placeholder"></span>',className:this.buildCSSClass()},t),n=v({type:"button"},n);var i=Be.prototype.createEl.call(this,"button",t,n);return this.createControlTextEl(i),i},n.addChild=function(e,t){void 0===t&&(t={});var n=this.constructor.name;return c.warn("Adding an actionable (user controllable) child to a Button ("+n+") is not supported; use a ClickableComponent instead."),Be.prototype.addChild.call(this,e,t)},n.enable=function(){e.prototype.enable.call(this),this.el_.removeAttribute("disabled")},n.disable=function(){e.prototype.disable.call(this),this.el_.setAttribute("disabled","disabled")},n.handleKeyDown=function(t){It.isEventKey(t,"Space")||It.isEventKey(t,"Enter")?t.stopPropagation():e.prototype.handleKeyDown.call(this,t)},t}(or);Be.registerComponent("Button",pr);var fr=function(e){function t(t,n){var i;return(i=e.call(this,t,n)||this).mouseused_=!1,i.on("mousedown",i.handleMouseDown),i}i(t,e);var n=t.prototype;return n.buildCSSClass=function(){return"vjs-big-play-button"},n.handleClick=function(e){var t=this.player_.play();if(this.mouseused_&&e.clientX&&e.clientY)return Et(t),void(this.player_.tech(!0)&&this.player_.tech(!0).focus());var n=this.player_.getChild("controlBar"),i=n&&n.getChild("playToggle");if(i){var r=function(){return i.focus()};Tt(t)?t.then(r,function(){}):this.setTimeout(r,1)}else this.player_.tech(!0).focus()},n.handleKeyDown=function(t){this.mouseused_=!1,e.prototype.handleKeyDown.call(this,t)},n.handleMouseDown=function(e){this.mouseused_=!0},t}(pr);fr.prototype.controlText_="Play Video",Be.registerComponent("BigPlayButton",fr);var gr=function(e){function t(t,n){var i;return(i=e.call(this,t,n)||this).controlText(n&&n.controlText||i.localize("Close")),i}i(t,e);var n=t.prototype;return n.buildCSSClass=function(){return"vjs-close-button "+e.prototype.buildCSSClass.call(this)},n.handleClick=function(e){this.trigger({type:"close",bubbles:!1})},n.handleKeyDown=function(t){It.isEventKey(t,"Esc")?(t.preventDefault(),t.stopPropagation(),this.trigger("click")):e.prototype.handleKeyDown.call(this,t)},t}(pr);Be.registerComponent("CloseButton",gr);var mr=function(e){function t(t,n){var i;return void 0===n&&(n={}),i=e.call(this,t,n)||this,n.replay=void 0===n.replay||n.replay,i.on(t,"play",i.handlePlay),i.on(t,"pause",i.handlePause),n.replay&&i.on(t,"ended",i.handleEnded),i}i(t,e);var n=t.prototype;return n.buildCSSClass=function(){return"vjs-play-control "+e.prototype.buildCSSClass.call(this)},n.handleClick=function(e){this.player_.paused()?this.player_.play():this.player_.pause()},n.handleSeeked=function(e){this.removeClass("vjs-ended"),this.player_.paused()?this.handlePause(e):this.handlePlay(e)},n.handlePlay=function(e){this.removeClass("vjs-ended"),this.removeClass("vjs-paused"),this.addClass("vjs-playing"),this.controlText("Pause")},n.handlePause=function(e){this.removeClass("vjs-playing"),this.addClass("vjs-paused"),this.controlText("Play")},n.handleEnded=function(e){this.removeClass("vjs-playing"),this.addClass("vjs-ended"),this.controlText("Replay"),this.one(this.player_,"seeked",this.handleSeeked)},t}(pr);mr.prototype.controlText_="Play",Be.registerComponent("PlayToggle",mr);var vr=function(e,t){e=e<0?0:e;var n=Math.floor(e%60),i=Math.floor(e/60%60),r=Math.floor(e/3600),a=Math.floor(t/60%60),o=Math.floor(t/3600);return(isNaN(e)||e===1/0)&&(r=i=n="-"),(r=r>0||o>0?r+":":"")+(i=((r||a>=10)&&i<10?"0"+i:i)+":")+(n<10?"0"+n:n)},yr=vr;function br(e,t){return void 0===t&&(t=e),yr(e,t)}var _r=function(e){function n(t,n){var i;return(i=e.call(this,t,n)||this).throttledUpdateContent=Ce(Ee(o(i),i.updateContent),Te),i.on(t,"timeupdate",i.throttledUpdateContent),i}i(n,e);var r=n.prototype;return r.createEl=function(){var t=this.buildCSSClass(),n=e.prototype.createEl.call(this,"div",{className:t+" vjs-time-control vjs-control",innerHTML:'<span class="vjs-control-text" role="presentation">'+this.localize(this.labelText_)+" </span>"});return this.contentEl_=O("span",{className:t+"-display"},{"aria-live":"off",role:"presentation"}),this.updateTextNode_(),n.appendChild(this.contentEl_),n},r.dispose=function(){this.contentEl_=null,this.textNode_=null,e.prototype.dispose.call(this)},r.updateTextNode_=function(){if(this.contentEl_){for(;this.contentEl_.firstChild;)this.contentEl_.removeChild(this.contentEl_.firstChild);this.textNode_=t.createTextNode(this.formattedTime_||this.formatTime_(0)),this.contentEl_.appendChild(this.textNode_)}},r.formatTime_=function(e){return br(e)},r.updateFormattedTime_=function(e){var t=this.formatTime_(e);t!==this.formattedTime_&&(this.formattedTime_=t,this.requestAnimationFrame(this.updateTextNode_))},r.updateContent=function(e){},n}(Be);_r.prototype.labelText_="Time",_r.prototype.controlText_="Time",Be.registerComponent("TimeDisplay",_r);var Tr=function(e){function t(t,n){var i;return(i=e.call(this,t,n)||this).on(t,"ended",i.handleEnded),i}i(t,e);var n=t.prototype;return n.buildCSSClass=function(){return"vjs-current-time"},n.updateContent=function(e){var t=this.player_.scrubbing()?this.player_.getCache().currentTime:this.player_.currentTime();this.updateFormattedTime_(t)},n.handleEnded=function(e){this.player_.duration()&&this.updateFormattedTime_(this.player_.duration())},t}(_r);Tr.prototype.labelText_="Current Time",Tr.prototype.controlText_="Current Time",Be.registerComponent("CurrentTimeDisplay",Tr);var Er=function(e){function t(t,n){var i;return(i=e.call(this,t,n)||this).on(t,"durationchange",i.updateContent),i.on(t,"loadstart",i.updateContent),i.on(t,"loadedmetadata",i.throttledUpdateContent),i}i(t,e);var n=t.prototype;return n.buildCSSClass=function(){return"vjs-duration"},n.updateContent=function(e){var t=this.player_.duration();this.duration_!==t&&(this.duration_=t,this.updateFormattedTime_(t))},t}(_r);Er.prototype.labelText_="Duration",Er.prototype.controlText_="Duration",Be.registerComponent("DurationDisplay",Er);var Cr=function(e){function t(){return e.apply(this,arguments)||this}return i(t,e),t.prototype.createEl=function(){return e.prototype.createEl.call(this,"div",{className:"vjs-time-control vjs-time-divider",innerHTML:"<div><span>/</span></div>"},{"aria-hidden":!0})},t}(Be);Be.registerComponent("TimeDivider",Cr);var wr=function(e){function t(t,n){var i;return(i=e.call(this,t,n)||this).on(t,"durationchange",i.throttledUpdateContent),i.on(t,"ended",i.handleEnded),i}i(t,e);var n=t.prototype;return n.buildCSSClass=function(){return"vjs-remaining-time"},n.createEl=function(){var t=e.prototype.createEl.call(this);return t.insertBefore(O("span",{},{"aria-hidden":!0},"-"),this.contentEl_),t},n.updateContent=function(e){"number"==typeof this.player_.duration()&&(this.player_.remainingTimeDisplay?this.updateFormattedTime_(this.player_.remainingTimeDisplay()):this.updateFormattedTime_(this.player_.remainingTime()))},n.handleEnded=function(e){this.player_.duration()&&this.updateFormattedTime_(0)},t}(_r);wr.prototype.labelText_="Remaining Time",wr.prototype.controlText_="Remaining Time",Be.registerComponent("RemainingTimeDisplay",wr);var kr=function(e){function t(t,n){var i;return(i=e.call(this,t,n)||this).updateShowing(),i.on(i.player(),"durationchange",i.updateShowing),i}i(t,e);var n=t.prototype;return n.createEl=function(){var t=e.prototype.createEl.call(this,"div",{className:"vjs-live-control vjs-control"});return this.contentEl_=O("div",{className:"vjs-live-display",innerHTML:'<span class="vjs-control-text">'+this.localize("Stream Type")+" </span>"+this.localize("LIVE")},{"aria-live":"off"}),t.appendChild(this.contentEl_),t},n.dispose=function(){this.contentEl_=null,e.prototype.dispose.call(this)},n.updateShowing=function(e){this.player().duration()===1/0?this.show():this.hide()},t}(Be);Be.registerComponent("LiveDisplay",kr);var Sr=function(e){function t(t,n){var i;return(i=e.call(this,t,n)||this).updateLiveEdgeStatus(),i.player_.liveTracker&&i.on(i.player_.liveTracker,"liveedgechange",i.updateLiveEdgeStatus),i}i(t,e);var n=t.prototype;return n.createEl=function(){var t=e.prototype.createEl.call(this,"button",{className:"vjs-seek-to-live-control vjs-control"});return this.textEl_=O("span",{className:"vjs-seek-to-live-text",innerHTML:this.localize("LIVE")},{"aria-hidden":"true"}),t.appendChild(this.textEl_),t},n.updateLiveEdgeStatus=function(e){!this.player_.liveTracker||this.player_.liveTracker.atLiveEdge()?(this.setAttribute("aria-disabled",!0),this.addClass("vjs-at-live-edge"),this.controlText("Seek to live, currently playing live")):(this.setAttribute("aria-disabled",!1),this.removeClass("vjs-at-live-edge"),this.controlText("Seek to live, currently behind live"))},n.handleClick=function(){this.player_.liveTracker.seekToLiveEdge()},n.dispose=function(){this.player_.liveTracker&&this.off(this.player_.liveTracker,"liveedgechange",this.updateLiveEdgeStatus),this.textEl_=null,e.prototype.dispose.call(this)},t}(pr);Sr.prototype.controlText_="Seek to live, currently playing live",Be.registerComponent("SeekToLive",Sr);var Ir=function(e){function t(t,n){var i;return(i=e.call(this,t,n)||this).bar=i.getChild(i.options_.barName),i.vertical(!!i.options_.vertical),i.enable(),i}i(t,e);var n=t.prototype;return n.enabled=function(){return this.enabled_},n.enable=function(){this.enabled()||(this.on("mousedown",this.handleMouseDown),this.on("touchstart",this.handleMouseDown),this.on("keydown",this.handleKeyDown),this.on("click",this.handleClick),this.on(this.player_,"controlsvisible",this.update),this.playerEvent&&this.on(this.player_,this.playerEvent,this.update),this.removeClass("disabled"),this.setAttribute("tabindex",0),this.enabled_=!0)},n.disable=function(){if(this.enabled()){var e=this.bar.el_.ownerDocument;this.off("mousedown",this.handleMouseDown),this.off("touchstart",this.handleMouseDown),this.off("keydown",this.handleKeyDown),this.off("click",this.handleClick),this.off(this.player_,"controlsvisible",this.update),this.off(e,"mousemove",this.handleMouseMove),this.off(e,"mouseup",this.handleMouseUp),this.off(e,"touchmove",this.handleMouseMove),this.off(e,"touchend",this.handleMouseUp),this.removeAttribute("tabindex"),this.addClass("disabled"),this.playerEvent&&this.off(this.player_,this.playerEvent,this.update),this.enabled_=!1}},n.createEl=function(t,n,i){return void 0===n&&(n={}),void 0===i&&(i={}),n.className=n.className+" vjs-slider",n=v({tabIndex:0},n),i=v({role:"slider","aria-valuenow":0,"aria-valuemin":0,"aria-valuemax":100,tabIndex:0},i),e.prototype.createEl.call(this,t,n,i)},n.handleMouseDown=function(e){var t=this.bar.el_.ownerDocument;"mousedown"===e.type&&e.preventDefault(),"touchstart"!==e.type||tt||e.preventDefault(),B(),this.addClass("vjs-sliding"),this.trigger("slideractive"),this.on(t,"mousemove",this.handleMouseMove),this.on(t,"mouseup",this.handleMouseUp),this.on(t,"touchmove",this.handleMouseMove),this.on(t,"touchend",this.handleMouseUp),this.handleMouseMove(e)},n.handleMouseMove=function(e){},n.handleMouseUp=function(){var e=this.bar.el_.ownerDocument;F(),this.removeClass("vjs-sliding"),this.trigger("sliderinactive"),this.off(e,"mousemove",this.handleMouseMove),this.off(e,"mouseup",this.handleMouseUp),this.off(e,"touchmove",this.handleMouseMove),this.off(e,"touchend",this.handleMouseUp),this.update()},n.update=function(){if(this.el_){var e=this.getPercent(),t=this.bar;if(t){("number"!=typeof e||e!=e||e<0||e===1/0)&&(e=0);var n=(100*e).toFixed(2)+"%",i=t.el().style,r=this.vertical()?"height":"width";return i[r]!==n&&(i[r]=n),e}}},n.calculateDistance=function(e){var t=q(this.el_,e);return this.vertical()?t.y:t.x},n.handleKeyDown=function(t){It.isEventKey(t,"Left")||It.isEventKey(t,"Down")?(t.preventDefault(),t.stopPropagation(),this.stepBack()):It.isEventKey(t,"Right")||It.isEventKey(t,"Up")?(t.preventDefault(),t.stopPropagation(),this.stepForward()):e.prototype.handleKeyDown.call(this,t)},n.handleClick=function(e){e.stopPropagation(),e.preventDefault()},n.vertical=function(e){if(void 0===e)return this.vertical_||!1;this.vertical_=!!e,this.vertical_?this.addClass("vjs-slider-vertical"):this.addClass("vjs-slider-horizontal")},t}(Be);Be.registerComponent("Slider",Ir);var Or=function(e){function t(t,n){var i;return(i=e.call(this,t,n)||this).partEls_=[],i.on(t,"progress",i.update),i}i(t,e);var n=t.prototype;return n.createEl=function(){return e.prototype.createEl.call(this,"div",{className:"vjs-load-progress",innerHTML:'<span class="vjs-control-text"><span>'+this.localize("Loaded")+'</span>: <span class="vjs-control-text-loaded-percentage">0%</span></span>'})},n.dispose=function(){this.partEls_=null,e.prototype.dispose.call(this)},n.update=function(e){var t=this.player_.liveTracker,n=this.player_.buffered(),i=t&&t.isLive()?t.seekableEnd():this.player_.duration(),r=this.player_.bufferedEnd(),a=this.partEls_,o=this.$(".vjs-control-text-loaded-percentage"),s=function(e,t,n){var i=e/t||0;return i=100*(i>=1?1:i),n&&(i=i.toFixed(2)),i+"%"};this.el_.style.width=s(r,i),D(o,s(r,i,!0));for(var l=0;l<n.length;l++){var u=n.start(l),c=n.end(l),d=a[l];d||(d=this.el_.appendChild(O()),a[l]=d),d.style.left=s(u,r),d.style.width=s(c-u,r)}for(var h=a.length;h>n.length;h--)this.el_.removeChild(a[h-1]);a.length=n.length},t}(Be);Be.registerComponent("LoadProgressBar",Or);var Dr=function(e){function t(t,n){var i;return(i=e.call(this,t,n)||this).update=Ce(Ee(o(i),i.update),Te),i}i(t,e);var n=t.prototype;return n.createEl=function(){return e.prototype.createEl.call(this,"div",{className:"vjs-time-tooltip"},{"aria-hidden":"true"})},n.update=function(e,t,n){var i=U(this.el_),r=U(this.player_.el()),a=e.width*t;if(r&&i){var o=e.left-r.left+a,s=e.width-a+(r.right-e.right),l=i.width/2;o<l?l+=l-o:s<l&&(l=s),l<0?l=0:l>i.width&&(l=i.width),this.el_.style.right="-"+l+"px",this.write(n)}},n.write=function(e){D(this.el_,e)},n.updateTime=function(e,t,n,i){var r=this;this.rafId_&&this.cancelAnimationFrame(this.rafId_),this.rafId_=this.requestAnimationFrame(function(){var a,o=r.player_.duration();if(r.player_.liveTracker&&r.player_.liveTracker.isLive()){var s=r.player_.liveTracker.liveWindow(),l=s-t*s;a=(l<1?"":"-")+br(l,s)}else a=br(n,o);r.update(e,t,a),i&&i()})},t}(Be);Be.registerComponent("TimeTooltip",Dr);var Rr=function(e){function t(t,n){var i;return(i=e.call(this,t,n)||this).update=Ce(Ee(o(i),i.update),Te),i}i(t,e);var n=t.prototype;return n.createEl=function(){return e.prototype.createEl.call(this,"div",{className:"vjs-play-progress vjs-slider-bar"},{"aria-hidden":"true"})},n.update=function(e,t){var n=this.getChild("timeTooltip");if(n){var i=this.player_.scrubbing()?this.player_.getCache().currentTime:this.player_.currentTime();n.updateTime(e,t,i)}},t}(Be);Rr.prototype.options_={children:[]},Ge||Ye||Rr.prototype.options_.children.push("timeTooltip"),Be.registerComponent("PlayProgressBar",Rr);var xr=function(e){function t(t,n){var i;return(i=e.call(this,t,n)||this).update=Ce(Ee(o(i),i.update),Te),i}i(t,e);var n=t.prototype;return n.createEl=function(){return e.prototype.createEl.call(this,"div",{className:"vjs-mouse-display"})},n.update=function(e,t){var n=this,i=t*this.player_.duration();this.getChild("timeTooltip").updateTime(e,t,i,function(){n.el_.style.left=e.width*t+"px"})},t}(Be);xr.prototype.options_={children:["timeTooltip"]},Be.registerComponent("MouseTimeDisplay",xr);var Ar=function(e){function n(t,n){var i;return(i=e.call(this,t,n)||this).setEventHandlers_(),i}i(n,e);var r=n.prototype;return r.setEventHandlers_=function(){this.update=Ce(Ee(this,this.update),30),this.on(this.player_,"timeupdate",this.update),this.on(this.player_,"ended",this.handleEnded),this.on(this.player_,"durationchange",this.update),this.player_.liveTracker&&this.on(this.player_.liveTracker,"liveedgechange",this.update),this.updateInterval=null,this.on(this.player_,["playing"],this.enableInterval_),this.on(this.player_,["ended","pause","waiting"],this.disableInterval_),"hidden"in t&&"visibilityState"in t&&this.on(t,"visibilitychange",this.toggleVisibility_)},r.toggleVisibility_=function(e){t.hidden?this.disableInterval_(e):(this.enableInterval_(),this.requestAnimationFrame(this.update))},r.enableInterval_=function(){var e=this;this.clearInterval(this.updateInterval),this.updateInterval=this.setInterval(function(){e.requestAnimationFrame(e.update)},30)},r.disableInterval_=function(e){this.player_.liveTracker&&this.player_.liveTracker.isLive()&&"ended"!==e.type||this.clearInterval(this.updateInterval)},r.createEl=function(){return e.prototype.createEl.call(this,"div",{className:"vjs-progress-holder"},{"aria-label":this.localize("Progress Bar")})},r.update_=function(e,t){var n=this.player_.liveTracker,i=this.player_.duration();n&&n.isLive()&&(i=this.player_.liveTracker.liveCurrentTime()),this.el_.setAttribute("aria-valuenow",(100*t).toFixed(2)),this.el_.setAttribute("aria-valuetext",this.localize("progress bar timing: currentTime={1} duration={2}",[br(e,i),br(i,i)],"{1} of {2}")),this.bar&&this.bar.update(U(this.el_),t)},r.update=function(t){if(null!==this.el().offsetParent){var n=e.prototype.update.call(this);return this.update_(this.getCurrentTime_(),n),n}},r.getCurrentTime_=function(){return this.player_.scrubbing()?this.player_.getCache().currentTime:this.player_.currentTime()},r.handleEnded=function(e){this.update_(this.player_.duration(),1)},r.getPercent=function(){var e,t=this.getCurrentTime_(),n=this.player_.liveTracker;return n&&n.isLive()?(e=(t-n.seekableStart())/n.liveWindow(),n.atLiveEdge()&&(e=1)):e=t/this.player_.duration(),e>=1?1:e||0},r.handleMouseDown=function(t){Y(t)&&(t.stopPropagation(),this.player_.scrubbing(!0),this.videoWasPlaying=!this.player_.paused(),this.player_.pause(),e.prototype.handleMouseDown.call(this,t))},r.handleMouseMove=function(e){if(Y(e)){var t,n=this.calculateDistance(e),i=this.player_.liveTracker;if(i&&i.isLive()){var r=i.seekableStart(),a=i.liveCurrentTime();if((t=r+n*i.liveWindow())>=a&&(t=a),t<=r&&(t=r+.1),t===1/0)return}else(t=n*this.player_.duration())===this.player_.duration()&&(t-=.1);this.player_.currentTime(t)}},r.enable=function(){e.prototype.enable.call(this);var t=this.getChild("mouseTimeDisplay");t&&t.show()},r.disable=function(){e.prototype.disable.call(this);var t=this.getChild("mouseTimeDisplay");t&&t.hide()},r.handleMouseUp=function(t){e.prototype.handleMouseUp.call(this,t),t&&t.stopPropagation(),this.player_.scrubbing(!1),this.player_.trigger({type:"timeupdate",target:this,manuallyTriggered:!0}),this.videoWasPlaying&&Et(this.player_.play())},r.stepForward=function(){this.player_.currentTime(this.player_.currentTime()+5)},r.stepBack=function(){this.player_.currentTime(this.player_.currentTime()-5)},r.handleAction=function(e){this.player_.paused()?this.player_.play():this.player_.pause()},r.handleKeyDown=function(t){if(It.isEventKey(t,"Space")||It.isEventKey(t,"Enter"))t.preventDefault(),t.stopPropagation(),this.handleAction(t);else if(It.isEventKey(t,"Home"))t.preventDefault(),t.stopPropagation(),this.player_.currentTime(0);else if(It.isEventKey(t,"End"))t.preventDefault(),t.stopPropagation(),this.player_.currentTime(this.player_.duration());else if(/^[0-9]$/.test(It(t))){t.preventDefault(),t.stopPropagation();var n=10*(It.codes[It(t)]-It.codes[0])/100;this.player_.currentTime(this.player_.duration()*n)}else It.isEventKey(t,"PgDn")?(t.preventDefault(),t.stopPropagation(),this.player_.currentTime(this.player_.currentTime()-60)):It.isEventKey(t,"PgUp")?(t.preventDefault(),t.stopPropagation(),this.player_.currentTime(this.player_.currentTime()+60)):e.prototype.handleKeyDown.call(this,t)},n}(Ir);Ar.prototype.options_={children:["loadProgressBar","playProgressBar"],barName:"playProgressBar"},Ge||Ye||Ar.prototype.options_.children.splice(1,0,"mouseTimeDisplay"),Be.registerComponent("SeekBar",Ar);var Pr=function(e){function t(t,n){var i;return(i=e.call(this,t,n)||this).handleMouseMove=Ce(Ee(o(i),i.handleMouseMove),Te),i.throttledHandleMouseSeek=Ce(Ee(o(i),i.handleMouseSeek),Te),i.enable(),i}i(t,e);var n=t.prototype;return n.createEl=function(){return e.prototype.createEl.call(this,"div",{className:"vjs-progress-control vjs-control"})},n.handleMouseMove=function(e){var t=this.getChild("seekBar");if(t){var n=t.getChild("mouseTimeDisplay"),i=t.el(),r=U(i),a=q(i,e).x;a>1?a=1:a<0&&(a=0),n&&n.update(r,a)}},n.handleMouseSeek=function(e){var t=this.getChild("seekBar");t&&t.handleMouseMove(e)},n.enabled=function(){return this.enabled_},n.disable=function(){this.children().forEach(function(e){return e.disable&&e.disable()}),this.enabled()&&(this.off(["mousedown","touchstart"],this.handleMouseDown),this.off(this.el_,"mousemove",this.handleMouseMove),this.handleMouseUp(),this.addClass("disabled"),this.enabled_=!1)},n.enable=function(){this.children().forEach(function(e){return e.enable&&e.enable()}),this.enabled()||(this.on(["mousedown","touchstart"],this.handleMouseDown),this.on(this.el_,"mousemove",this.handleMouseMove),this.removeClass("disabled"),this.enabled_=!0)},n.handleMouseDown=function(e){var t=this.el_.ownerDocument,n=this.getChild("seekBar");n&&n.handleMouseDown(e),this.on(t,"mousemove",this.throttledHandleMouseSeek),this.on(t,"touchmove",this.throttledHandleMouseSeek),this.on(t,"mouseup",this.handleMouseUp),this.on(t,"touchend",this.handleMouseUp)},n.handleMouseUp=function(e){var t=this.el_.ownerDocument,n=this.getChild("seekBar");n&&n.handleMouseUp(e),this.off(t,"mousemove",this.throttledHandleMouseSeek),this.off(t,"touchmove",this.throttledHandleMouseSeek),this.off(t,"mouseup",this.handleMouseUp),this.off(t,"touchend",this.handleMouseUp)},t}(Be);Pr.prototype.options_={children:["seekBar"]},Be.registerComponent("ProgressControl",Pr);var Lr=function(e){function n(n,i){var r;return(r=e.call(this,n,i)||this).on(n,["enterpictureinpicture","leavepictureinpicture"],r.handlePictureInPictureChange),t.pictureInPictureEnabled||r.disable(),r}i(n,e);var r=n.prototype;return r.buildCSSClass=function(){return"vjs-picture-in-picture-control "+e.prototype.buildCSSClass.call(this)},r.handlePictureInPictureChange=function(e){this.player_.isInPictureInPicture()?this.controlText("Exit Picture-in-Picture"):this.controlText("Picture-in-Picture")},r.handleClick=function(e){this.player_.isInPictureInPicture()?this.player_.exitPictureInPicture():this.player_.requestPictureInPicture()},n}(pr);Lr.prototype.controlText_="Picture-in-Picture",Be.registerComponent("PictureInPictureToggle",Lr);var Nr=function(e){function n(n,i){var r;return(r=e.call(this,n,i)||this).on(n,"fullscreenchange",r.handleFullscreenChange),!1===t[n.fsApi_.fullscreenEnabled]&&r.disable(),r}i(n,e);var r=n.prototype;return r.buildCSSClass=function(){return"vjs-fullscreen-control "+e.prototype.buildCSSClass.call(this)},r.handleFullscreenChange=function(e){this.player_.isFullscreen()?this.controlText("Non-Fullscreen"):this.controlText("Fullscreen")},r.handleClick=function(e){this.player_.isFullscreen()?this.player_.exitFullscreen():this.player_.requestFullscreen()},n}(pr);Nr.prototype.controlText_="Fullscreen",Be.registerComponent("FullscreenToggle",Nr);var Mr=function(e,t){t.tech_&&!t.tech_.featuresVolumeControl&&e.addClass("vjs-hidden"),e.on(t,"loadstart",function(){t.tech_.featuresVolumeControl?e.removeClass("vjs-hidden"):e.addClass("vjs-hidden")})},Kr=function(e){function t(){return e.apply(this,arguments)||this}return i(t,e),t.prototype.createEl=function(){return e.prototype.createEl.call(this,"div",{className:"vjs-volume-level",innerHTML:'<span class="vjs-control-text"></span>'})},t}(Be);Be.registerComponent("VolumeLevel",Kr);var $r=function(e){function t(t,n){var i;return(i=e.call(this,t,n)||this).on("slideractive",i.updateLastVolume_),i.on(t,"volumechange",i.updateARIAAttributes),t.ready(function(){return i.updateARIAAttributes()}),i}i(t,e);var n=t.prototype;return n.createEl=function(){return e.prototype.createEl.call(this,"div",{className:"vjs-volume-bar vjs-slider-bar"},{"aria-label":this.localize("Volume Level"),"aria-live":"polite"})},n.handleMouseDown=function(t){Y(t)&&e.prototype.handleMouseDown.call(this,t)},n.handleMouseMove=function(e){Y(e)&&(this.checkMuted(),this.player_.volume(this.calculateDistance(e)))},n.checkMuted=function(){this.player_.muted()&&this.player_.muted(!1)},n.getPercent=function(){return this.player_.muted()?0:this.player_.volume()},n.stepForward=function(){this.checkMuted(),this.player_.volume(this.player_.volume()+.1)},n.stepBack=function(){this.checkMuted(),this.player_.volume(this.player_.volume()-.1)},n.updateARIAAttributes=function(e){var t=this.player_.muted()?0:this.volumeAsPercentage_();this.el_.setAttribute("aria-valuenow",t),this.el_.setAttribute("aria-valuetext",t+"%")},n.volumeAsPercentage_=function(){return Math.round(100*this.player_.volume())},n.updateLastVolume_=function(){var e=this,t=this.player_.volume();this.one("sliderinactive",function(){0===e.player_.volume()&&e.player_.lastVolume_(t)})},t}(Ir);$r.prototype.options_={children:["volumeLevel"],barName:"volumeLevel"},$r.prototype.playerEvent="volumechange",Be.registerComponent("VolumeBar",$r);var jr=function(e){function t(t,n){var i;return void 0===n&&(n={}),n.vertical=n.vertical||!1,(void 0===n.volumeBar||b(n.volumeBar))&&(n.volumeBar=n.volumeBar||{},n.volumeBar.vertical=n.vertical),i=e.call(this,t,n)||this,Mr(o(i),t),i.throttledHandleMouseMove=Ce(Ee(o(i),i.handleMouseMove),Te),i.on("mousedown",i.handleMouseDown),i.on("touchstart",i.handleMouseDown),i.on(i.volumeBar,["focus","slideractive"],function(){i.volumeBar.addClass("vjs-slider-active"),i.addClass("vjs-slider-active"),i.trigger("slideractive")}),i.on(i.volumeBar,["blur","sliderinactive"],function(){i.volumeBar.removeClass("vjs-slider-active"),i.removeClass("vjs-slider-active"),i.trigger("sliderinactive")}),i}i(t,e);var n=t.prototype;return n.createEl=function(){var t="vjs-volume-horizontal";return this.options_.vertical&&(t="vjs-volume-vertical"),e.prototype.createEl.call(this,"div",{className:"vjs-volume-control vjs-control "+t})},n.handleMouseDown=function(e){var t=this.el_.ownerDocument;this.on(t,"mousemove",this.throttledHandleMouseMove),this.on(t,"touchmove",this.throttledHandleMouseMove),this.on(t,"mouseup",this.handleMouseUp),this.on(t,"touchend",this.handleMouseUp)},n.handleMouseUp=function(e){var t=this.el_.ownerDocument;this.off(t,"mousemove",this.throttledHandleMouseMove),this.off(t,"touchmove",this.throttledHandleMouseMove),this.off(t,"mouseup",this.handleMouseUp),this.off(t,"touchend",this.handleMouseUp)},n.handleMouseMove=function(e){this.volumeBar.handleMouseMove(e)},t}(Be);jr.prototype.options_={children:["volumeBar"]},Be.registerComponent("VolumeControl",jr);var Br=function(e,t){t.tech_&&!t.tech_.featuresMuteControl&&e.addClass("vjs-hidden"),e.on(t,"loadstart",function(){t.tech_.featuresMuteControl?e.removeClass("vjs-hidden"):e.addClass("vjs-hidden")})},Fr=function(e){function t(t,n){var i;return i=e.call(this,t,n)||this,Br(o(i),t),i.on(t,["loadstart","volumechange"],i.update),i}i(t,e);var n=t.prototype;return n.buildCSSClass=function(){return"vjs-mute-control "+e.prototype.buildCSSClass.call(this)},n.handleClick=function(e){var t=this.player_.volume(),n=this.player_.lastVolume_();if(0===t){var i=n<.1?.1:n;this.player_.volume(i),this.player_.muted(!1)}else this.player_.muted(!this.player_.muted())},n.update=function(e){this.updateIcon_(),this.updateControlText_()},n.updateIcon_=function(){var e=this.player_.volume(),t=3;Ge&&this.player_.tech_&&this.player_.tech_.el_&&this.player_.muted(this.player_.tech_.el_.muted),0===e||this.player_.muted()?t=0:e<.33?t=1:e<.67&&(t=2);for(var n=0;n<4;n++)P(this.el_,"vjs-vol-"+n);A(this.el_,"vjs-vol-"+t)},n.updateControlText_=function(){var e=this.player_.muted()||0===this.player_.volume()?"Unmute":"Mute";this.controlText()!==e&&this.controlText(e)},t}(pr);Fr.prototype.controlText_="Mute",Be.registerComponent("MuteToggle",Fr);var Ur=function(e){function t(t,n){var i;return void 0===n&&(n={}),void 0!==n.inline?n.inline=n.inline:n.inline=!0,(void 0===n.volumeControl||b(n.volumeControl))&&(n.volumeControl=n.volumeControl||{},n.volumeControl.vertical=!n.inline),(i=e.call(this,t,n)||this).on(t,["loadstart"],i.volumePanelState_),i.on(i.volumeControl,["slideractive"],i.sliderActive_),i.on(i.volumeControl,["sliderinactive"],i.sliderInactive_),i}i(t,e);var n=t.prototype;return n.sliderActive_=function(){this.addClass("vjs-slider-active")},n.sliderInactive_=function(){this.removeClass("vjs-slider-active")},n.volumePanelState_=function(){this.volumeControl.hasClass("vjs-hidden")&&this.muteToggle.hasClass("vjs-hidden")&&this.addClass("vjs-hidden"),this.volumeControl.hasClass("vjs-hidden")&&!this.muteToggle.hasClass("vjs-hidden")&&this.addClass("vjs-mute-toggle-only")},n.createEl=function(){var t="vjs-volume-panel-horizontal";return this.options_.inline||(t="vjs-volume-panel-vertical"),e.prototype.createEl.call(this,"div",{className:"vjs-volume-panel vjs-control "+t})},t}(Be);Ur.prototype.options_={children:["muteToggle","volumeControl"]},Be.registerComponent("VolumePanel",Ur);var Vr=function(e){function n(t,n){var i;return i=e.call(this,t,n)||this,n&&(i.menuButton_=n.menuButton),i.focusedChild_=-1,i.on("keydown",i.handleKeyDown),i.boundHandleBlur_=Ee(o(i),i.handleBlur),i.boundHandleTapClick_=Ee(o(i),i.handleTapClick),i}i(n,e);var r=n.prototype;return r.addEventListenerForItem=function(e){e instanceof Be&&(this.on(e,"blur",this.boundHandleBlur_),this.on(e,["tap","click"],this.boundHandleTapClick_))},r.removeEventListenerForItem=function(e){e instanceof Be&&(this.off(e,"blur",this.boundHandleBlur_),this.off(e,["tap","click"],this.boundHandleTapClick_))},r.removeChild=function(t){"string"==typeof t&&(t=this.getChild(t)),this.removeEventListenerForItem(t),e.prototype.removeChild.call(this,t)},r.addItem=function(e){var t=this.addChild(e);t&&this.addEventListenerForItem(t)},r.createEl=function(){var t=this.options_.contentElType||"ul";this.contentEl_=O(t,{className:"vjs-menu-content"}),this.contentEl_.setAttribute("role","menu");var n=e.prototype.createEl.call(this,"div",{append:this.contentEl_,className:"vjs-menu"});return n.appendChild(this.contentEl_),le(n,"click",function(e){e.preventDefault(),e.stopImmediatePropagation()}),n},r.dispose=function(){this.contentEl_=null,this.boundHandleBlur_=null,this.boundHandleTapClick_=null,e.prototype.dispose.call(this)},r.handleBlur=function(e){var n=e.relatedTarget||t.activeElement;if(!this.children().some(function(e){return e.el()===n})){var i=this.menuButton_;i&&i.buttonPressed_&&n!==i.el().firstChild&&i.unpressButton()}},r.handleTapClick=function(e){if(this.menuButton_){this.menuButton_.unpressButton();var t=this.children();if(!Array.isArray(t))return;var n=t.filter(function(t){return t.el()===e.target})[0];if(!n)return;"CaptionSettingsMenuItem"!==n.name()&&this.menuButton_.focus()}},r.handleKeyDown=function(e){It.isEventKey(e,"Left")||It.isEventKey(e,"Down")?(e.preventDefault(),e.stopPropagation(),this.stepForward()):(It.isEventKey(e,"Right")||It.isEventKey(e,"Up"))&&(e.preventDefault(),e.stopPropagation(),this.stepBack())},r.stepForward=function(){var e=0;void 0!==this.focusedChild_&&(e=this.focusedChild_+1),this.focus(e)},r.stepBack=function(){var e=0;void 0!==this.focusedChild_&&(e=this.focusedChild_-1),this.focus(e)},r.focus=function(e){void 0===e&&(e=0);var t=this.children().slice();t.length&&t[0].className&&/vjs-menu-title/.test(t[0].className)&&t.shift(),t.length>0&&(e<0?e=0:e>=t.length&&(e=t.length-1),this.focusedChild_=e,t[e].el_.focus())},n}(Be);Be.registerComponent("Menu",Vr);var qr=function(e){function t(t,n){var i;void 0===n&&(n={}),(i=e.call(this,t,n)||this).menuButton_=new pr(t,n),i.menuButton_.controlText(i.controlText_),i.menuButton_.el_.setAttribute("aria-haspopup","true");var r=pr.prototype.buildCSSClass();return i.menuButton_.el_.className=i.buildCSSClass()+" "+r,i.menuButton_.removeClass("vjs-control"),i.addChild(i.menuButton_),i.update(),i.enabled_=!0,i.on(i.menuButton_,"tap",i.handleClick),i.on(i.menuButton_,"click",i.handleClick),i.on(i.menuButton_,"keydown",i.handleKeyDown),i.on(i.menuButton_,"mouseenter",function(){i.menu.show()}),i.on("keydown",i.handleSubmenuKeyDown),i}i(t,e);var n=t.prototype;return n.update=function(){var e=this.createMenu();this.menu&&(this.menu.dispose(),this.removeChild(this.menu)),this.menu=e,this.addChild(e),this.buttonPressed_=!1,this.menuButton_.el_.setAttribute("aria-expanded","false"),this.items&&this.items.length<=this.hideThreshold_?this.hide():this.show()},n.createMenu=function(){var e=new Vr(this.player_,{menuButton:this});if(this.hideThreshold_=0,this.options_.title){var t=O("li",{className:"vjs-menu-title",innerHTML:$e(this.options_.title),tabIndex:-1});this.hideThreshold_+=1;var n=new Be(this.player_,{el:t});e.addItem(n)}if(this.items=this.createItems(),this.items)for(var i=0;i<this.items.length;i++)e.addItem(this.items[i]);return e},n.createItems=function(){},n.createEl=function(){return e.prototype.createEl.call(this,"div",{className:this.buildWrapperCSSClass()},{})},n.buildWrapperCSSClass=function(){var t="vjs-menu-button";return!0===this.options_.inline?t+="-inline":t+="-popup","vjs-menu-button "+t+" "+pr.prototype.buildCSSClass()+" "+e.prototype.buildCSSClass.call(this)},n.buildCSSClass=function(){var t="vjs-menu-button";return!0===this.options_.inline?t+="-inline":t+="-popup","vjs-menu-button "+t+" "+e.prototype.buildCSSClass.call(this)},n.controlText=function(e,t){return void 0===t&&(t=this.menuButton_.el()),this.menuButton_.controlText(e,t)},n.handleClick=function(e){this.buttonPressed_?this.unpressButton():this.pressButton()},n.focus=function(){this.menuButton_.focus()},n.blur=function(){this.menuButton_.blur()},n.handleKeyDown=function(e){It.isEventKey(e,"Esc")||It.isEventKey(e,"Tab")?(this.buttonPressed_&&this.unpressButton(),It.isEventKey(e,"Tab")||(e.preventDefault(),this.menuButton_.focus())):(It.isEventKey(e,"Up")||It.isEventKey(e,"Down"))&&(this.buttonPressed_||(e.preventDefault(),this.pressButton()))},n.handleSubmenuKeyPress=function(e){this.handleSubmenuKeyDown(e)},n.handleSubmenuKeyDown=function(e){(It.isEventKey(e,"Esc")||It.isEventKey(e,"Tab"))&&(this.buttonPressed_&&this.unpressButton(),It.isEventKey(e,"Tab")||(e.preventDefault(),this.menuButton_.focus()))},n.pressButton=function(){if(this.enabled_){if(this.buttonPressed_=!0,this.menu.show(),this.menu.lockShowing(),this.menuButton_.el_.setAttribute("aria-expanded","true"),Ge&&S())return;this.menu.focus()}},n.unpressButton=function(){this.enabled_&&(this.buttonPressed_=!1,this.menu.unlockShowing(),this.menu.hide(),this.menuButton_.el_.setAttribute("aria-expanded","false"))},n.disable=function(){this.unpressButton(),this.enabled_=!1,this.addClass("vjs-disabled"),this.menuButton_.disable()},n.enable=function(){this.enabled_=!0,this.removeClass("vjs-disabled"),this.menuButton_.enable()},t}(Be);Be.registerComponent("MenuButton",qr);var Hr=function(e){function t(t,n){var i,r=n.tracks;if((i=e.call(this,t,n)||this).items.length<=1&&i.hide(),!r)return o(i);var a=Ee(o(i),i.update);return r.addEventListener("removetrack",a),r.addEventListener("addtrack",a),i.player_.on("ready",a),i.player_.on("dispose",function(){r.removeEventListener("removetrack",a),r.removeEventListener("addtrack",a)}),i}return i(t,e),t}(qr);Be.registerComponent("TrackButton",Hr);var zr=["Tab","Esc","Up","Down","Right","Left"],Wr=function(e){function t(t,n){var i;return(i=e.call(this,t,n)||this).selectable=n.selectable,i.isSelected_=n.selected||!1,i.multiSelectable=n.multiSelectable,i.selected(i.isSelected_),i.selectable?i.multiSelectable?i.el_.setAttribute("role","menuitemcheckbox"):i.el_.setAttribute("role","menuitemradio"):i.el_.setAttribute("role","menuitem"),i}i(t,e);var n=t.prototype;return n.createEl=function(t,n,i){return this.nonIconControl=!0,e.prototype.createEl.call(this,"li",v({className:"vjs-menu-item",innerHTML:'<span class="vjs-menu-item-text">'+this.localize(this.options_.label)+"</span>",tabIndex:-1},n),i)},n.handleKeyDown=function(t){zr.some(function(e){return It.isEventKey(t,e)})||e.prototype.handleKeyDown.call(this,t)},n.handleClick=function(e){this.selected(!0)},n.selected=function(e){this.selectable&&(e?(this.addClass("vjs-selected"),this.el_.setAttribute("aria-checked","true"),this.controlText(", selected"),this.isSelected_=!0):(this.removeClass("vjs-selected"),this.el_.setAttribute("aria-checked","false"),this.controlText(""),this.isSelected_=!1))},t}(or);Be.registerComponent("MenuItem",Wr);var Gr=function(n){function r(i,r){var a,s=r.track,l=i.textTracks();r.label=s.label||s.language||"Unknown",r.selected="showing"===s.mode,(a=n.call(this,i,r)||this).track=s,a.kinds=(r.kinds||[r.kind||a.track.kind]).filter(Boolean);var u,c=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];a.handleTracksChange.apply(o(a),t)},d=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];a.handleSelectedLanguageChange.apply(o(a),t)};return i.on(["loadstart","texttrackchange"],c),l.addEventListener("change",c),l.addEventListener("selectedlanguagechange",d),a.on("dispose",function(){i.off(["loadstart","texttrackchange"],c),l.removeEventListener("change",c),l.removeEventListener("selectedlanguagechange",d)}),void 0===l.onchange&&a.on(["tap","click"],function(){if("object"!=typeof e.Event)try{u=new e.Event("change")}catch(e){}u||(u=t.createEvent("Event")).initEvent("change",!0,!0),l.dispatchEvent(u)}),a.handleTracksChange(),a}i(r,n);var a=r.prototype;return a.handleClick=function(e){var t=this.track,i=this.player_.textTracks();if(n.prototype.handleClick.call(this,e),i)for(var r=0;r<i.length;r++){var a=i[r];-1!==this.kinds.indexOf(a.kind)&&(a===t?"showing"!==a.mode&&(a.mode="showing"):"disabled"!==a.mode&&(a.mode="disabled"))}},a.handleTracksChange=function(e){var t="showing"===this.track.mode;t!==this.isSelected_&&this.selected(t)},a.handleSelectedLanguageChange=function(e){if("showing"===this.track.mode){var t=this.player_.cache_.selectedLanguage;if(t&&t.enabled&&t.language===this.track.language&&t.kind!==this.track.kind)return;this.player_.cache_.selectedLanguage={enabled:!0,language:this.track.language,kind:this.track.kind}}},a.dispose=function(){this.track=null,n.prototype.dispose.call(this)},r}(Wr);Be.registerComponent("TextTrackMenuItem",Gr);var Xr=function(e){function t(t,n){return n.track={player:t,kind:n.kind,kinds:n.kinds,default:!1,mode:"disabled"},n.kinds||(n.kinds=[n.kind]),n.label?n.track.label=n.label:n.track.label=n.kinds.join(" and ")+" off",n.selectable=!0,n.multiSelectable=!1,e.call(this,t,n)||this}i(t,e);var n=t.prototype;return n.handleTracksChange=function(e){for(var t=this.player().textTracks(),n=!0,i=0,r=t.length;i<r;i++){var a=t[i];if(this.options_.kinds.indexOf(a.kind)>-1&&"showing"===a.mode){n=!1;break}}n!==this.isSelected_&&this.selected(n)},n.handleSelectedLanguageChange=function(e){for(var t=this.player().textTracks(),n=!0,i=0,r=t.length;i<r;i++){var a=t[i];if(["captions","descriptions","subtitles"].indexOf(a.kind)>-1&&"showing"===a.mode){n=!1;break}}n&&(this.player_.cache_.selectedLanguage={enabled:!1})},t}(Gr);Be.registerComponent("OffTextTrackMenuItem",Xr);var Yr=function(e){function t(t,n){return void 0===n&&(n={}),n.tracks=t.textTracks(),e.call(this,t,n)||this}return i(t,e),t.prototype.createItems=function(e,t){var n;void 0===e&&(e=[]),void 0===t&&(t=Gr),this.label_&&(n=this.label_+" off"),e.push(new Xr(this.player_,{kinds:this.kinds_,kind:this.kind_,label:n})),this.hideThreshold_+=1;var i=this.player_.textTracks();Array.isArray(this.kinds_)||(this.kinds_=[this.kind_]);for(var r=0;r<i.length;r++){var a=i[r];if(this.kinds_.indexOf(a.kind)>-1){var o=new t(this.player_,{track:a,kinds:this.kinds_,kind:this.kind_,selectable:!0,multiSelectable:!1});o.addClass("vjs-"+a.kind+"-menu-item"),e.push(o)}}return e},t}(Hr);Be.registerComponent("TextTrackButton",Yr);var Qr=function(e){function t(t,n){var i,r=n.track,a=n.cue,s=t.currentTime();return n.selectable=!0,n.multiSelectable=!1,n.label=a.text,n.selected=a.startTime<=s&&s<a.endTime,(i=e.call(this,t,n)||this).track=r,i.cue=a,r.addEventListener("cuechange",Ee(o(i),i.update)),i}i(t,e);var n=t.prototype;return n.handleClick=function(t){e.prototype.handleClick.call(this),this.player_.currentTime(this.cue.startTime),this.update(this.cue.startTime)},n.update=function(e){var t=this.cue,n=this.player_.currentTime();this.selected(t.startTime<=n&&n<t.endTime)},t}(Wr);Be.registerComponent("ChaptersTrackMenuItem",Qr);var Jr=function(e){function t(t,n,i){return e.call(this,t,n,i)||this}i(t,e);var n=t.prototype;return n.buildCSSClass=function(){return"vjs-chapters-button "+e.prototype.buildCSSClass.call(this)},n.buildWrapperCSSClass=function(){return"vjs-chapters-button "+e.prototype.buildWrapperCSSClass.call(this)},n.update=function(t){this.track_&&(!t||"addtrack"!==t.type&&"removetrack"!==t.type)||this.setTrack(this.findChaptersTrack()),e.prototype.update.call(this)},n.setTrack=function(e){if(this.track_!==e){if(this.updateHandler_||(this.updateHandler_=this.update.bind(this)),this.track_){var t=this.player_.remoteTextTrackEls().getTrackElementByTrack_(this.track_);t&&t.removeEventListener("load",this.updateHandler_),this.track_=null}if(this.track_=e,this.track_){this.track_.mode="hidden";var n=this.player_.remoteTextTrackEls().getTrackElementByTrack_(this.track_);n&&n.addEventListener("load",this.updateHandler_)}}},n.findChaptersTrack=function(){for(var e=this.player_.textTracks()||[],t=e.length-1;t>=0;t--){var n=e[t];if(n.kind===this.kind_)return n}},n.getMenuCaption=function(){return this.track_&&this.track_.label?this.track_.label:this.localize($e(this.kind_))},n.createMenu=function(){return this.options_.title=this.getMenuCaption(),e.prototype.createMenu.call(this)},n.createItems=function(){var e=[];if(!this.track_)return e;var t=this.track_.cues;if(!t)return e;for(var n=0,i=t.length;n<i;n++){var r=t[n],a=new Qr(this.player_,{track:this.track_,cue:r});e.push(a)}return e},t}(Yr);Jr.prototype.kind_="chapters",Jr.prototype.controlText_="Chapters",Be.registerComponent("ChaptersButton",Jr);var Zr=function(e){function t(t,n,i){var r;r=e.call(this,t,n,i)||this;var a=t.textTracks(),s=Ee(o(r),r.handleTracksChange);return a.addEventListener("change",s),r.on("dispose",function(){a.removeEventListener("change",s)}),r}i(t,e);var n=t.prototype;return n.handleTracksChange=function(e){for(var t=this.player().textTracks(),n=!1,i=0,r=t.length;i<r;i++){var a=t[i];if(a.kind!==this.kind_&&"showing"===a.mode){n=!0;break}}n?this.disable():this.enable()},n.buildCSSClass=function(){return"vjs-descriptions-button "+e.prototype.buildCSSClass.call(this)},n.buildWrapperCSSClass=function(){return"vjs-descriptions-button "+e.prototype.buildWrapperCSSClass.call(this)},t}(Yr);Zr.prototype.kind_="descriptions",Zr.prototype.controlText_="Descriptions",Be.registerComponent("DescriptionsButton",Zr);var ea=function(e){function t(t,n,i){return e.call(this,t,n,i)||this}i(t,e);var n=t.prototype;return n.buildCSSClass=function(){return"vjs-subtitles-button "+e.prototype.buildCSSClass.call(this)},n.buildWrapperCSSClass=function(){return"vjs-subtitles-button "+e.prototype.buildWrapperCSSClass.call(this)},t}(Yr);ea.prototype.kind_="subtitles",ea.prototype.controlText_="Subtitles",Be.registerComponent("SubtitlesButton",ea);var ta=function(e){function t(t,n){var i;return n.track={player:t,kind:n.kind,label:n.kind+" settings",selectable:!1,default:!1,mode:"disabled"},n.selectable=!1,n.name="CaptionSettingsMenuItem",(i=e.call(this,t,n)||this).addClass("vjs-texttrack-settings"),i.controlText(", opens "+n.kind+" settings dialog"),i}return i(t,e),t.prototype.handleClick=function(e){this.player().getChild("textTrackSettings").open()},t}(Gr);Be.registerComponent("CaptionSettingsMenuItem",ta);var na=function(e){function t(t,n,i){return e.call(this,t,n,i)||this}i(t,e);var n=t.prototype;return n.buildCSSClass=function(){return"vjs-captions-button "+e.prototype.buildCSSClass.call(this)},n.buildWrapperCSSClass=function(){return"vjs-captions-button "+e.prototype.buildWrapperCSSClass.call(this)},n.createItems=function(){var t=[];return this.player().tech_&&this.player().tech_.featuresNativeTextTracks||!this.player().getChild("textTrackSettings")||(t.push(new ta(this.player_,{kind:this.kind_})),this.hideThreshold_+=1),e.prototype.createItems.call(this,t)},t}(Yr);na.prototype.kind_="captions",na.prototype.controlText_="Captions",Be.registerComponent("CaptionsButton",na);var ia=function(e){function t(){return e.apply(this,arguments)||this}return i(t,e),t.prototype.createEl=function(t,n,i){var r='<span class="vjs-menu-item-text">'+this.localize(this.options_.label);return"captions"===this.options_.track.kind&&(r+='\n        <span aria-hidden="true" class="vjs-icon-placeholder"></span>\n        <span class="vjs-control-text"> '+this.localize("Captions")+"</span>\n      "),r+="</span>",e.prototype.createEl.call(this,t,v({innerHTML:r},n),i)},t}(Gr);Be.registerComponent("SubsCapsMenuItem",ia);var ra=function(e){function t(t,n){var i;return void 0===n&&(n={}),(i=e.call(this,t,n)||this).label_="subtitles",["en","en-us","en-ca","fr-ca"].indexOf(i.player_.language_)>-1&&(i.label_="captions"),i.menuButton_.controlText($e(i.label_)),i}i(t,e);var n=t.prototype;return n.buildCSSClass=function(){return"vjs-subs-caps-button "+e.prototype.buildCSSClass.call(this)},n.buildWrapperCSSClass=function(){return"vjs-subs-caps-button "+e.prototype.buildWrapperCSSClass.call(this)},n.createItems=function(){var t=[];return this.player().tech_&&this.player().tech_.featuresNativeTextTracks||!this.player().getChild("textTrackSettings")||(t.push(new ta(this.player_,{kind:this.label_})),this.hideThreshold_+=1),e.prototype.createItems.call(this,t,ia)},t}(Yr);ra.prototype.kinds_=["captions","subtitles"],ra.prototype.controlText_="Subtitles",Be.registerComponent("SubsCapsButton",ra);var aa=function(e){function t(t,n){var i,r=n.track,a=t.audioTracks();n.label=r.label||r.language||"Unknown",n.selected=r.enabled,(i=e.call(this,t,n)||this).track=r,i.addClass("vjs-"+r.kind+"-menu-item");var s=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];i.handleTracksChange.apply(o(i),t)};return a.addEventListener("change",s),i.on("dispose",function(){a.removeEventListener("change",s)}),i}i(t,e);var n=t.prototype;return n.createEl=function(t,n,i){var r='<span class="vjs-menu-item-text">'+this.localize(this.options_.label);return"main-desc"===this.options_.track.kind&&(r+='\n        <span aria-hidden="true" class="vjs-icon-placeholder"></span>\n        <span class="vjs-control-text"> '+this.localize("Descriptions")+"</span>\n      "),r+="</span>",e.prototype.createEl.call(this,t,v({innerHTML:r},n),i)},n.handleClick=function(t){var n=this.player_.audioTracks();e.prototype.handleClick.call(this,t);for(var i=0;i<n.length;i++){var r=n[i];r.enabled=r===this.track}},n.handleTracksChange=function(e){this.selected(this.track.enabled)},t}(Wr);Be.registerComponent("AudioTrackMenuItem",aa);var oa=function(e){function t(t,n){return void 0===n&&(n={}),n.tracks=t.audioTracks(),e.call(this,t,n)||this}i(t,e);var n=t.prototype;return n.buildCSSClass=function(){return"vjs-audio-button "+e.prototype.buildCSSClass.call(this)},n.buildWrapperCSSClass=function(){return"vjs-audio-button "+e.prototype.buildWrapperCSSClass.call(this)},n.createItems=function(e){void 0===e&&(e=[]),this.hideThreshold_=1;for(var t=this.player_.audioTracks(),n=0;n<t.length;n++){var i=t[n];e.push(new aa(this.player_,{track:i,selectable:!0,multiSelectable:!1}))}return e},t}(Hr);oa.prototype.controlText_="Audio Track",Be.registerComponent("AudioTrackButton",oa);var sa=function(e){function t(t,n){var i,r=n.rate,a=parseFloat(r,10);return n.label=r,n.selected=1===a,n.selectable=!0,n.multiSelectable=!1,(i=e.call(this,t,n)||this).label=r,i.rate=a,i.on(t,"ratechange",i.update),i}i(t,e);var n=t.prototype;return n.handleClick=function(t){e.prototype.handleClick.call(this),this.player().playbackRate(this.rate)},n.update=function(e){this.selected(this.player().playbackRate()===this.rate)},t}(Wr);sa.prototype.contentElType="button",Be.registerComponent("PlaybackRateMenuItem",sa);var la=function(e){function t(t,n){var i;return(i=e.call(this,t,n)||this).updateVisibility(),i.updateLabel(),i.on(t,"loadstart",i.updateVisibility),i.on(t,"ratechange",i.updateLabel),i}i(t,e);var n=t.prototype;return n.createEl=function(){var t=e.prototype.createEl.call(this);return this.labelEl_=O("div",{className:"vjs-playback-rate-value",innerHTML:"1x"}),t.appendChild(this.labelEl_),t},n.dispose=function(){this.labelEl_=null,e.prototype.dispose.call(this)},n.buildCSSClass=function(){return"vjs-playback-rate "+e.prototype.buildCSSClass.call(this)},n.buildWrapperCSSClass=function(){return"vjs-playback-rate "+e.prototype.buildWrapperCSSClass.call(this)},n.createMenu=function(){var e=new Vr(this.player()),t=this.playbackRates();if(t)for(var n=t.length-1;n>=0;n--)e.addChild(new sa(this.player(),{rate:t[n]+"x"}));return e},n.updateARIAAttributes=function(){this.el().setAttribute("aria-valuenow",this.player().playbackRate())},n.handleClick=function(e){for(var t=this.player().playbackRate(),n=this.playbackRates(),i=n[0],r=0;r<n.length;r++)if(n[r]>t){i=n[r];break}this.player().playbackRate(i)},n.playbackRates=function(){return this.options_.playbackRates||this.options_.playerOptions&&this.options_.playerOptions.playbackRates},n.playbackRateSupported=function(){return this.player().tech_&&this.player().tech_.featuresPlaybackRate&&this.playbackRates()&&this.playbackRates().length>0},n.updateVisibility=function(e){this.playbackRateSupported()?this.removeClass("vjs-hidden"):this.addClass("vjs-hidden")},n.updateLabel=function(e){this.playbackRateSupported()&&(this.labelEl_.innerHTML=this.player().playbackRate()+"x")},t}(qr);la.prototype.controlText_="Playback Rate",Be.registerComponent("PlaybackRateMenuButton",la);var ua=function(e){function t(){return e.apply(this,arguments)||this}i(t,e);var n=t.prototype;return n.buildCSSClass=function(){return"vjs-spacer "+e.prototype.buildCSSClass.call(this)},n.createEl=function(){return e.prototype.createEl.call(this,"div",{className:this.buildCSSClass()})},t}(Be);Be.registerComponent("Spacer",ua);var ca=function(e){function t(){return e.apply(this,arguments)||this}i(t,e);var n=t.prototype;return n.buildCSSClass=function(){return"vjs-custom-control-spacer "+e.prototype.buildCSSClass.call(this)},n.createEl=function(){var t=e.prototype.createEl.call(this,{className:this.buildCSSClass()});return t.innerHTML=" ",t},t}(ua);Be.registerComponent("CustomControlSpacer",ca);var da=function(e){function t(){return e.apply(this,arguments)||this}return i(t,e),t.prototype.createEl=function(){return e.prototype.createEl.call(this,"div",{className:"vjs-control-bar",dir:"ltr"})},t}(Be);da.prototype.options_={children:["playToggle","volumePanel","currentTimeDisplay","timeDivider","durationDisplay","progressControl","liveDisplay","seekToLive","remainingTimeDisplay","customControlSpacer","playbackRateMenuButton","chaptersButton","descriptionsButton","subsCapsButton","audioTrackButton","fullscreenToggle"]},"exitPictureInPicture"in t&&da.prototype.options_.children.splice(da.prototype.options_.children.length-1,0,"pictureInPictureToggle"),Be.registerComponent("ControlBar",da);var ha=function(e){function t(t,n){var i;return(i=e.call(this,t,n)||this).on(t,"error",i.open),i}i(t,e);var n=t.prototype;return n.buildCSSClass=function(){return"vjs-error-display "+e.prototype.buildCSSClass.call(this)},n.content=function(){var e=this.player().error();return e?this.localize(e.message):""},t}(Dt);ha.prototype.options_=je(Dt.prototype.options_,{pauseOnOpen:!1,fillAlways:!0,temporary:!1,uncloseable:!0}),Be.registerComponent("ErrorDisplay",ha);var pa=["#000","Black"],fa=["#00F","Blue"],ga=["#0FF","Cyan"],ma=["#0F0","Green"],va=["#F0F","Magenta"],ya=["#F00","Red"],ba=["#FFF","White"],_a=["#FF0","Yellow"],Ta=["1","Opaque"],Ea=["0.5","Semi-Transparent"],Ca=["0","Transparent"],wa={backgroundColor:{selector:".vjs-bg-color > select",id:"captions-background-color-%s",label:"Color",options:[pa,ba,ya,ma,fa,_a,va,ga]},backgroundOpacity:{selector:".vjs-bg-opacity > select",id:"captions-background-opacity-%s",label:"Transparency",options:[Ta,Ea,Ca]},color:{selector:".vjs-fg-color > select",id:"captions-foreground-color-%s",label:"Color",options:[ba,pa,ya,ma,fa,_a,va,ga]},edgeStyle:{selector:".vjs-edge-style > select",id:"%s",label:"Text Edge Style",options:[["none","None"],["raised","Raised"],["depressed","Depressed"],["uniform","Uniform"],["dropshadow","Dropshadow"]]},fontFamily:{selector:".vjs-font-family > select",id:"captions-font-family-%s",label:"Font Family",options:[["proportionalSansSerif","Proportional Sans-Serif"],["monospaceSansSerif","Monospace Sans-Serif"],["proportionalSerif","Proportional Serif"],["monospaceSerif","Monospace Serif"],["casual","Casual"],["script","Script"],["small-caps","Small Caps"]]},fontPercent:{selector:".vjs-font-percent > select",id:"captions-font-size-%s",label:"Font Size",options:[["0.50","50%"],["0.75","75%"],["1.00","100%"],["1.25","125%"],["1.50","150%"],["1.75","175%"],["2.00","200%"],["3.00","300%"],["4.00","400%"]],default:2,parser:function(e){return"1.00"===e?null:Number(e)}},textOpacity:{selector:".vjs-text-opacity > select",id:"captions-foreground-opacity-%s",label:"Transparency",options:[Ta,Ea]},windowColor:{selector:".vjs-window-color > select",id:"captions-window-color-%s",label:"Color"},windowOpacity:{selector:".vjs-window-opacity > select",id:"captions-window-opacity-%s",label:"Transparency",options:[Ca,Ea,Ta]}};function ka(e,t){if(t&&(e=t(e)),e&&"none"!==e)return e}wa.windowColor.options=wa.backgroundColor.options;var Sa=function(t){function n(e,n){var i;return n.temporary=!1,(i=t.call(this,e,n)||this).updateDisplay=Ee(o(i),i.updateDisplay),i.fill(),i.hasBeenOpened_=i.hasBeenFilled_=!0,i.endDialog=O("p",{className:"vjs-control-text",textContent:i.localize("End of dialog window.")}),i.el().appendChild(i.endDialog),i.setDefaults(),void 0===n.persistTextTrackSettings&&(i.options_.persistTextTrackSettings=i.options_.playerOptions.persistTextTrackSettings),i.on(i.$(".vjs-done-button"),"click",function(){i.saveSettings(),i.close()}),i.on(i.$(".vjs-default-button"),"click",function(){i.setDefaults(),i.updateDisplay()}),m(wa,function(e){i.on(i.$(e.selector),"change",i.updateDisplay)}),i.options_.persistTextTrackSettings&&i.restoreSettings(),i}i(n,t);var r=n.prototype;return r.dispose=function(){this.endDialog=null,t.prototype.dispose.call(this)},r.createElSelect_=function(e,t,n){var i=this;void 0===t&&(t=""),void 0===n&&(n="label");var r=wa[e],a=r.id.replace("%s",this.id_),o=[t,a].join(" ").trim();return["<"+n+' id="'+a+'" class="'+("label"===n?"vjs-label":"")+'">',this.localize(r.label),"</"+n+">",'<select aria-labelledby="'+o+'">'].concat(r.options.map(function(e){var t=a+"-"+e[1].replace(/\W+/g,"");return['<option id="'+t+'" value="'+e[0]+'" ','aria-labelledby="'+o+" "+t+'">',i.localize(e[1]),"</option>"].join("")})).concat("</select>").join("")},r.createElFgColor_=function(){var e="captions-text-legend-"+this.id_;return['<fieldset class="vjs-fg-color vjs-track-setting">','<legend id="'+e+'">',this.localize("Text"),"</legend>",this.createElSelect_("color",e),'<span class="vjs-text-opacity vjs-opacity">',this.createElSelect_("textOpacity",e),"</span>","</fieldset>"].join("")},r.createElBgColor_=function(){var e="captions-background-"+this.id_;return['<fieldset class="vjs-bg-color vjs-track-setting">','<legend id="'+e+'">',this.localize("Background"),"</legend>",this.createElSelect_("backgroundColor",e),'<span class="vjs-bg-opacity vjs-opacity">',this.createElSelect_("backgroundOpacity",e),"</span>","</fieldset>"].join("")},r.createElWinColor_=function(){var e="captions-window-"+this.id_;return['<fieldset class="vjs-window-color vjs-track-setting">','<legend id="'+e+'">',this.localize("Window"),"</legend>",this.createElSelect_("windowColor",e),'<span class="vjs-window-opacity vjs-opacity">',this.createElSelect_("windowOpacity",e),"</span>","</fieldset>"].join("")},r.createElColors_=function(){return O("div",{className:"vjs-track-settings-colors",innerHTML:[this.createElFgColor_(),this.createElBgColor_(),this.createElWinColor_()].join("")})},r.createElFont_=function(){return O("div",{className:"vjs-track-settings-font",innerHTML:['<fieldset class="vjs-font-percent vjs-track-setting">',this.createElSelect_("fontPercent","","legend"),"</fieldset>",'<fieldset class="vjs-edge-style vjs-track-setting">',this.createElSelect_("edgeStyle","","legend"),"</fieldset>",'<fieldset class="vjs-font-family vjs-track-setting">',this.createElSelect_("fontFamily","","legend"),"</fieldset>"].join("")})},r.createElControls_=function(){var e=this.localize("restore all settings to the default values");return O("div",{className:"vjs-track-settings-controls",innerHTML:['<button type="button" class="vjs-default-button" title="'+e+'">',this.localize("Reset"),'<span class="vjs-control-text"> '+e+"</span>","</button>",'<button type="button" class="vjs-done-button">'+this.localize("Done")+"</button>"].join("")})},r.content=function(){return[this.createElColors_(),this.createElFont_(),this.createElControls_()]},r.label=function(){return this.localize("Caption Settings Dialog")},r.description=function(){return this.localize("Beginning of dialog window. Escape will cancel and close the window.")},r.buildCSSClass=function(){return t.prototype.buildCSSClass.call(this)+" vjs-text-track-settings"},r.getValues=function(){var e,t,n,i=this;return e=wa,t=function(e,t,n){var r,a,o=(r=i.$(t.selector),a=t.parser,ka(r.options[r.options.selectedIndex].value,a));return void 0!==o&&(e[n]=o),e},void 0===(n={})&&(n=0),g(e).reduce(function(n,i){return t(n,e[i],i)},n)},r.setValues=function(e){var t=this;m(wa,function(n,i){!function(e,t,n){if(t)for(var i=0;i<e.options.length;i++)if(ka(e.options[i].value,n)===t){e.selectedIndex=i;break}}(t.$(n.selector),e[i],n.parser)})},r.setDefaults=function(){var e=this;m(wa,function(t){var n=t.hasOwnProperty("default")?t.default:0;e.$(t.selector).selectedIndex=n})},r.restoreSettings=function(){var t;try{t=JSON.parse(e.localStorage.getItem("vjs-text-track-settings"))}catch(e){c.warn(e)}t&&this.setValues(t)},r.saveSettings=function(){if(this.options_.persistTextTrackSettings){var t=this.getValues();try{Object.keys(t).length?e.localStorage.setItem("vjs-text-track-settings",JSON.stringify(t)):e.localStorage.removeItem("vjs-text-track-settings")}catch(e){c.warn(e)}}},r.updateDisplay=function(){var e=this.player_.getChild("textTrackDisplay");e&&e.updateDisplay()},r.conditionalBlur_=function(){this.previouslyActiveEl_=null;var e=this.player_.controlBar,t=e&&e.subsCapsButton,n=e&&e.captionsButton;t?t.focus():n&&n.focus()},n}(Dt);Be.registerComponent("TextTrackSettings",Sa);var Ia=function(t){function n(n,i){var r,a=i.ResizeObserver||e.ResizeObserver;null===i.ResizeObserver&&(a=!1);var s=je({createEl:!a,reportTouchActivity:!1},i);return(r=t.call(this,n,s)||this).ResizeObserver=i.ResizeObserver||e.ResizeObserver,r.loadListener_=null,r.resizeObserver_=null,r.debouncedHandler_=we(function(){r.resizeHandler()},100,!1,o(r)),a?(r.resizeObserver_=new r.ResizeObserver(r.debouncedHandler_),r.resizeObserver_.observe(n.el())):(r.loadListener_=function(){if(r.el_&&r.el_.contentWindow){var e=r.debouncedHandler_,t=r.unloadListener_=function(){ue(this,"resize",e),ue(this,"unload",t),t=null};le(r.el_.contentWindow,"unload",t),le(r.el_.contentWindow,"resize",e)}},r.one("load",r.loadListener_)),r}i(n,t);var r=n.prototype;return r.createEl=function(){return t.prototype.createEl.call(this,"iframe",{className:"vjs-resize-manager",tabIndex:-1},{"aria-hidden":"true"})},r.resizeHandler=function(){this.player_&&this.player_.trigger&&this.player_.trigger("playerresize")},r.dispose=function(){this.debouncedHandler_&&this.debouncedHandler_.cancel(),this.resizeObserver_&&(this.player_.el()&&this.resizeObserver_.unobserve(this.player_.el()),this.resizeObserver_.disconnect()),this.loadListener_&&this.off("load",this.loadListener_),this.el_&&this.el_.contentWindow&&this.unloadListener_&&this.unloadListener_.call(this.el_.contentWindow),this.ResizeObserver=null,this.resizeObserver=null,this.debouncedHandler_=null,this.loadListener_=null,t.prototype.dispose.call(this)},n}(Be);Be.registerComponent("ResizeManager",Ia);var Oa=function(e){function n(n,i){var r,a=je({createEl:!1},i);return(r=e.call(this,n,a)||this).reset_(),r.on(r.player_,"durationchange",r.handleDurationchange),it&&"hidden"in t&&"visibilityState"in t&&r.on(t,"visibilitychange",r.handleVisibilityChange),r}i(n,e);var r=n.prototype;return r.handleVisibilityChange=function(){this.player_.duration()===1/0&&(t.hidden?this.stopTracking():this.startTracking())},r.isBehind_=function(){if(!this.timeupdateSeen_)return!1;var e=this.liveCurrentTime(),t=this.player_.currentTime(),n=this.seekableIncrement_;return e!==1/0&&e-(2*n+.07)>=t},r.trackLive_=function(){this.pastSeekEnd_=this.pastSeekEnd_;var e=this.player_.seekable();if(e&&e.length){var t=this.seekableEnd();t!==this.lastSeekEnd_&&(this.lastSeekEnd_&&(this.seekableIncrement_=Math.abs(t-this.lastSeekEnd_)),this.pastSeekEnd_=0,this.lastSeekEnd_=t,this.trigger("seekableendchange")),this.pastSeekEnd_=this.pastSeekEnd()+.03,this.isBehind_()!==this.behindLiveEdge()&&(this.behindLiveEdge_=this.isBehind_(),this.trigger("liveedgechange"))}},r.handleDurationchange=function(){this.player_.duration()===1/0?this.startTracking():this.stopTracking()},r.startTracking=function(){var e=this;this.isTracking()||(this.timeupdateSeen_||(this.timeupdateSeen_=this.player_.hasStarted()),this.trackingInterval_=this.setInterval(this.trackLive_,30),this.trackLive_(),this.on(this.player_,"play",this.trackLive_),this.on(this.player_,"pause",this.trackLive_),this.timeupdateSeen_||(this.one(this.player_,"play",this.handlePlay),this.handleTimeupdate=function(){e.timeupdateSeen_=!0,e.handleTimeupdate=null},this.one(this.player_,"timeupdate",this.handleTimeupdate)))},r.handlePlay=function(){this.one(this.player_,"timeupdate",this.seekToLiveEdge)},r.reset_=function(){this.pastSeekEnd_=0,this.lastSeekEnd_=null,this.behindLiveEdge_=null,this.timeupdateSeen_=!1,this.clearInterval(this.trackingInterval_),this.trackingInterval_=null,this.seekableIncrement_=12,this.off(this.player_,"play",this.trackLive_),this.off(this.player_,"pause",this.trackLive_),this.off(this.player_,"play",this.handlePlay),this.off(this.player_,"timeupdate",this.seekToLiveEdge),this.handleTimeupdate&&(this.off(this.player_,"timeupdate",this.handleTimeupdate),this.handleTimeupdate=null)},r.stopTracking=function(){this.isTracking()&&this.reset_()},r.seekableEnd=function(){for(var e=this.player_.seekable(),t=[],n=e?e.length:0;n--;)t.push(e.end(n));return t.length?t.sort()[t.length-1]:1/0},r.seekableStart=function(){for(var e=this.player_.seekable(),t=[],n=e?e.length:0;n--;)t.push(e.start(n));return t.length?t.sort()[0]:0},r.liveWindow=function(){var e=this.liveCurrentTime();return e===1/0?1/0:e-this.seekableStart()},r.isLive=function(){return this.isTracking()},r.atLiveEdge=function(){return!this.behindLiveEdge()},r.liveCurrentTime=function(){return this.pastSeekEnd()+this.seekableEnd()},r.pastSeekEnd=function(){return this.pastSeekEnd_},r.behindLiveEdge=function(){return this.behindLiveEdge_},r.isTracking=function(){return"number"==typeof this.trackingInterval_},r.seekToLiveEdge=function(){this.atLiveEdge()||(this.player_.currentTime(this.liveCurrentTime()),this.player_.paused()&&this.player_.play())},r.dispose=function(){this.stopTracking(),e.prototype.dispose.call(this)},n}(Be);Be.registerComponent("LiveTracker",Oa);var Da=function(e){var t=e.el();if(t.hasAttribute("src"))return e.triggerSourceset(t.src),!0;var n=e.$$("source"),i=[],r="";if(!n.length)return!1;for(var a=0;a<n.length;a++){var o=n[a].src;o&&-1===i.indexOf(o)&&i.push(o)}return!!i.length&&(1===i.length&&(r=i[0]),e.triggerSourceset(r),!0)},Ra=Object.defineProperty({},"innerHTML",{get:function(){return this.cloneNode(!0).innerHTML},set:function(n){var i=t.createElement(this.nodeName.toLowerCase());i.innerHTML=n;for(var r=t.createDocumentFragment();i.childNodes.length;)r.appendChild(i.childNodes[0]);return this.innerText="",e.Element.prototype.appendChild.call(this,r),this.innerHTML}}),xa=function(e,t){for(var n={},i=0;i<e.length&&!((n=Object.getOwnPropertyDescriptor(e[i],t))&&n.set&&n.get);i++);return n.enumerable=!0,n.configurable=!0,n},Aa=function(t){var n=t.el();if(!n.resetSourceWatch_){var i={},r=function(t){return xa([t.el(),e.HTMLMediaElement.prototype,e.Element.prototype,Ra],"innerHTML")}(t),a=function(e){return function(){for(var i=arguments.length,r=new Array(i),a=0;a<i;a++)r[a]=arguments[a];var o=e.apply(n,r);return Da(t),o}};["append","appendChild","insertAdjacentHTML"].forEach(function(e){n[e]&&(i[e]=n[e],n[e]=a(i[e]))}),Object.defineProperty(n,"innerHTML",je(r,{set:a(r.set)})),n.resetSourceWatch_=function(){n.resetSourceWatch_=null,Object.keys(i).forEach(function(e){n[e]=i[e]}),Object.defineProperty(n,"innerHTML",r)},t.one("sourceset",n.resetSourceWatch_)}},Pa=Object.defineProperty({},"src",{get:function(){return this.hasAttribute("src")?zt(e.Element.prototype.getAttribute.call(this,"src")):""},set:function(t){return e.Element.prototype.setAttribute.call(this,"src",t),t}});function La(){var e=s(["Text Tracks are being loaded from another origin but the crossorigin attribute isn't used.\n            This may prevent text tracks from loading."]);return La=function(){return e},e}var Na=function(n){function r(e,t){var i;i=n.call(this,e,t)||this;var r=e.source,a=!1;if(r&&(i.el_.currentSrc!==r.src||e.tag&&3===e.tag.initNetworkState_)?i.setSource(r):i.handleLateInit_(i.el_),e.enableSourceset&&i.setupSourcesetHandling_(),i.el_.hasChildNodes()){for(var o=i.el_.childNodes,s=o.length,l=[];s--;){var u=o[s];"track"===u.nodeName.toLowerCase()&&(i.featuresNativeTextTracks?(i.remoteTextTrackEls().addTrackElement_(u),i.remoteTextTracks().addTrack(u.track),i.textTracks().addTrack(u.track),a||i.el_.hasAttribute("crossorigin")||!Gt(u.src)||(a=!0)):l.push(u))}for(var d=0;d<l.length;d++)i.el_.removeChild(l[d])}return i.proxyNativeTracks_(),i.featuresNativeTextTracks&&a&&c.warn(p(La())),i.restoreMetadataTracksInIOSNativePlayer_(),(st||ze||Je)&&!0===e.nativeControlsForTouch&&i.setControls(!0),i.proxyWebkitFullscreen_(),i.triggerReady(),i}i(r,n);var a=r.prototype;return a.dispose=function(){this.el_&&this.el_.resetSourceset_&&this.el_.resetSourceset_(),r.disposeMediaElement(this.el_),this.options_=null,n.prototype.dispose.call(this)},a.setupSourcesetHandling_=function(){!function(t){if(t.featuresSourceset){var n=t.el();if(!n.resetSourceset_){var i=function(t){return xa([t.el(),e.HTMLMediaElement.prototype,Pa],"src")}(t),r=n.setAttribute,a=n.load;Object.defineProperty(n,"src",je(i,{set:function(e){var r=i.set.call(n,e);return t.triggerSourceset(n.src),r}})),n.setAttribute=function(e,i){var a=r.call(n,e,i);return/src/i.test(e)&&t.triggerSourceset(n.src),a},n.load=function(){var e=a.call(n);return Da(t)||(t.triggerSourceset(""),Aa(t)),e},n.currentSrc?t.triggerSourceset(n.currentSrc):Da(t)||Aa(t),n.resetSourceset_=function(){n.resetSourceset_=null,n.load=a,n.setAttribute=r,Object.defineProperty(n,"src",i),n.resetSourceWatch_&&n.resetSourceWatch_()}}}}(this)},a.restoreMetadataTracksInIOSNativePlayer_=function(){var e,t=this.textTracks(),n=function(){e=[];for(var n=0;n<t.length;n++){var i=t[n];"metadata"===i.kind&&e.push({track:i,storedMode:i.mode})}};n(),t.addEventListener("change",n),this.on("dispose",function(){return t.removeEventListener("change",n)});var i=function n(){for(var i=0;i<e.length;i++){var r=e[i];"disabled"===r.track.mode&&r.track.mode!==r.storedMode&&(r.track.mode=r.storedMode)}t.removeEventListener("change",n)};this.on("webkitbeginfullscreen",function(){t.removeEventListener("change",n),t.removeEventListener("change",i),t.addEventListener("change",i)}),this.on("webkitendfullscreen",function(){t.removeEventListener("change",n),t.addEventListener("change",n),t.removeEventListener("change",i)})},a.overrideNative_=function(e,t){var n=this;if(t===this["featuresNative"+e+"Tracks"]){var i=e.toLowerCase();this[i+"TracksListeners_"]&&Object.keys(this[i+"TracksListeners_"]).forEach(function(e){n.el()[i+"Tracks"].removeEventListener(e,n[i+"TracksListeners_"][e])}),this["featuresNative"+e+"Tracks"]=!t,this[i+"TracksListeners_"]=null,this.proxyNativeTracksForType_(i)}},a.overrideNativeAudioTracks=function(e){this.overrideNative_("Audio",e)},a.overrideNativeVideoTracks=function(e){this.overrideNative_("Video",e)},a.proxyNativeTracksForType_=function(e){var t=this,n=gi[e],i=this.el()[n.getterName],r=this[n.getterName]();if(this["featuresNative"+n.capitalName+"Tracks"]&&i&&i.addEventListener){var a={change:function(e){r.trigger({type:"change",target:r,currentTarget:r,srcElement:r})},addtrack:function(e){r.addTrack(e.track)},removetrack:function(e){r.removeTrack(e.track)}},o=function(){for(var e=[],t=0;t<r.length;t++){for(var n=!1,a=0;a<i.length;a++)if(i[a]===r[t]){n=!0;break}n||e.push(r[t])}for(;e.length;)r.removeTrack(e.shift())};this[n.getterName+"Listeners_"]=a,Object.keys(a).forEach(function(e){var n=a[e];i.addEventListener(e,n),t.on("dispose",function(t){return i.removeEventListener(e,n)})}),this.on("loadstart",o),this.on("dispose",function(e){return t.off("loadstart",o)})}},a.proxyNativeTracks_=function(){var e=this;gi.names.forEach(function(t){e.proxyNativeTracksForType_(t)})},a.createEl=function(){var e=this.options_.tag;if(!e||!this.options_.playerElIngest&&!this.movingMediaElementInDOM){if(e){var n=e.cloneNode(!0);e.parentNode&&e.parentNode.insertBefore(n,e),r.disposeMediaElement(e),e=n}else{e=t.createElement("video");var i=je({},this.options_.tag&&M(this.options_.tag));st&&!0===this.options_.nativeControlsForTouch||delete i.controls,N(e,v(i,{id:this.options_.techId,class:"vjs-tech"}))}e.playerId=this.options_.playerId}void 0!==this.options_.preload&&$(e,"preload",this.options_.preload);for(var a=["loop","muted","playsinline","autoplay"],o=0;o<a.length;o++){var s=a[o],l=this.options_[s];void 0!==l&&(l?$(e,s,s):j(e,s),e[s]=l)}return e},a.handleLateInit_=function(e){if(0!==e.networkState&&3!==e.networkState){if(0===e.readyState){var t=!1,n=function(){t=!0};this.on("loadstart",n);var i=function(){t||this.trigger("loadstart")};return this.on("loadedmetadata",i),void this.ready(function(){this.off("loadstart",n),this.off("loadedmetadata",i),t||this.trigger("loadstart")})}var r=["loadstart"];r.push("loadedmetadata"),e.readyState>=2&&r.push("loadeddata"),e.readyState>=3&&r.push("canplay"),e.readyState>=4&&r.push("canplaythrough"),this.ready(function(){r.forEach(function(e){this.trigger(e)},this)})}},a.setCurrentTime=function(e){try{this.el_.currentTime=e}catch(e){c(e,"Video is not ready. (Video.js)")}},a.duration=function(){var e=this;return this.el_.duration===1/0&&Ye&&tt&&0===this.el_.currentTime?(this.on("timeupdate",function t(){e.el_.currentTime>0&&(e.el_.duration===1/0&&e.trigger("durationchange"),e.off("timeupdate",t))}),NaN):this.el_.duration||NaN},a.width=function(){return this.el_.offsetWidth},a.height=function(){return this.el_.offsetHeight},a.proxyWebkitFullscreen_=function(){var e=this;if("webkitDisplayingFullscreen"in this.el_){var t=function(){this.trigger("fullscreenchange",{isFullscreen:!1})},n=function(){"webkitPresentationMode"in this.el_&&"picture-in-picture"!==this.el_.webkitPresentationMode&&(this.one("webkitendfullscreen",t),this.trigger("fullscreenchange",{isFullscreen:!0}))};this.on("webkitbeginfullscreen",n),this.on("dispose",function(){e.off("webkitbeginfullscreen",n),e.off("webkitendfullscreen",t)})}},a.supportsFullScreen=function(){if("function"==typeof this.el_.webkitEnterFullScreen){var t=e.navigator&&e.navigator.userAgent||"";if(/Android/.test(t)||!/Chrome|Mac OS X 10.5/.test(t))return!0}return!1},a.enterFullScreen=function(){var e=this.el_;e.paused&&e.networkState<=e.HAVE_METADATA?(this.el_.play(),this.setTimeout(function(){e.pause(),e.webkitEnterFullScreen()},0)):e.webkitEnterFullScreen()},a.exitFullScreen=function(){this.el_.webkitExitFullScreen()},a.requestPictureInPicture=function(){return this.el_.requestPictureInPicture()},a.src=function(e){if(void 0===e)return this.el_.src;this.setSrc(e)},a.reset=function(){r.resetMediaElement(this.el_)},a.currentSrc=function(){return this.currentSource_?this.currentSource_.src:this.el_.currentSrc},a.setControls=function(e){this.el_.controls=!!e},a.addTextTrack=function(e,t,i){return this.featuresNativeTextTracks?this.el_.addTextTrack(e,t,i):n.prototype.addTextTrack.call(this,e,t,i)},a.createRemoteTextTrack=function(e){if(!this.featuresNativeTextTracks)return n.prototype.createRemoteTextTrack.call(this,e);var i=t.createElement("track");return e.kind&&(i.kind=e.kind),e.label&&(i.label=e.label),(e.language||e.srclang)&&(i.srclang=e.language||e.srclang),e.default&&(i.default=e.default),e.id&&(i.id=e.id),e.src&&(i.src=e.src),i},a.addRemoteTextTrack=function(e,t){var i=n.prototype.addRemoteTextTrack.call(this,e,t);return this.featuresNativeTextTracks&&this.el().appendChild(i),i},a.removeRemoteTextTrack=function(e){if(n.prototype.removeRemoteTextTrack.call(this,e),this.featuresNativeTextTracks)for(var t=this.$$("track"),i=t.length;i--;)e!==t[i]&&e!==t[i].track||this.el().removeChild(t[i])},a.getVideoPlaybackQuality=function(){if("function"==typeof this.el().getVideoPlaybackQuality)return this.el().getVideoPlaybackQuality();var t={};return void 0!==this.el().webkitDroppedFrameCount&&void 0!==this.el().webkitDecodedFrameCount&&(t.droppedVideoFrames=this.el().webkitDroppedFrameCount,t.totalVideoFrames=this.el().webkitDecodedFrameCount),e.performance&&"function"==typeof e.performance.now?t.creationTime=e.performance.now():e.performance&&e.performance.timing&&"number"==typeof e.performance.timing.navigationStart&&(t.creationTime=e.Date.now()-e.performance.timing.navigationStart),t},r}(Wi);if(w()){Na.TEST_VID=t.createElement("video");var Ma=t.createElement("track");Ma.kind="captions",Ma.srclang="en",Ma.label="English",Na.TEST_VID.appendChild(Ma)}Na.isSupported=function(){try{Na.TEST_VID.volume=.5}catch(e){return!1}return!(!Na.TEST_VID||!Na.TEST_VID.canPlayType)},Na.canPlayType=function(e){return Na.TEST_VID.canPlayType(e)},Na.canPlaySource=function(e,t){return Na.canPlayType(e.type)},Na.canControlVolume=function(){try{var e=Na.TEST_VID.volume;return Na.TEST_VID.volume=e/2+.1,e!==Na.TEST_VID.volume}catch(e){return!1}},Na.canMuteVolume=function(){try{var e=Na.TEST_VID.muted;return Na.TEST_VID.muted=!e,Na.TEST_VID.muted?$(Na.TEST_VID,"muted","muted"):j(Na.TEST_VID,"muted"),e!==Na.TEST_VID.muted}catch(e){return!1}},Na.canControlPlaybackRate=function(){if(Ye&&tt&&nt<58)return!1;try{var e=Na.TEST_VID.playbackRate;return Na.TEST_VID.playbackRate=e/2+.1,e!==Na.TEST_VID.playbackRate}catch(e){return!1}},Na.canOverrideAttributes=function(){try{var e=function(){};Object.defineProperty(t.createElement("video"),"src",{get:e,set:e}),Object.defineProperty(t.createElement("audio"),"src",{get:e,set:e}),Object.defineProperty(t.createElement("video"),"innerHTML",{get:e,set:e}),Object.defineProperty(t.createElement("audio"),"innerHTML",{get:e,set:e})}catch(e){return!1}return!0},Na.supportsNativeTextTracks=function(){return at||Ge&&tt},Na.supportsNativeVideoTracks=function(){return!(!Na.TEST_VID||!Na.TEST_VID.videoTracks)},Na.supportsNativeAudioTracks=function(){return!(!Na.TEST_VID||!Na.TEST_VID.audioTracks)},Na.Events=["loadstart","suspend","abort","error","emptied","stalled","loadedmetadata","loadeddata","canplay","canplaythrough","playing","waiting","seeking","seeked","ended","durationchange","timeupdate","progress","play","pause","ratechange","resize","volumechange"],Na.prototype.featuresVolumeControl=Na.canControlVolume(),Na.prototype.featuresMuteControl=Na.canMuteVolume(),Na.prototype.featuresPlaybackRate=Na.canControlPlaybackRate(),Na.prototype.featuresSourceset=Na.canOverrideAttributes(),Na.prototype.movingMediaElementInDOM=!Ge,Na.prototype.featuresFullscreenResize=!0,Na.prototype.featuresProgressEvents=!0,Na.prototype.featuresTimeupdateEvents=!0,Na.prototype.featuresNativeTextTracks=Na.supportsNativeTextTracks(),Na.prototype.featuresNativeVideoTracks=Na.supportsNativeVideoTracks(),Na.prototype.featuresNativeAudioTracks=Na.supportsNativeAudioTracks();var Ka=Na.TEST_VID&&Na.TEST_VID.constructor.prototype.canPlayType,$a=/^application\/(?:x-|vnd\.apple\.)mpegurl/i;function ja(){var e=s(["\n        Using the tech directly can be dangerous. I hope you know what you're doing.\n        See https://github.com/videojs/video.js/issues/2617 for more info.\n      "]);return ja=function(){return e},e}Na.patchCanPlayType=function(){Qe>=4&&!Ze&&!tt&&(Na.TEST_VID.constructor.prototype.canPlayType=function(e){return e&&$a.test(e)?"maybe":Ka.call(this,e)})},Na.unpatchCanPlayType=function(){var e=Na.TEST_VID.constructor.prototype.canPlayType;return Na.TEST_VID.constructor.prototype.canPlayType=Ka,e},Na.patchCanPlayType(),Na.disposeMediaElement=function(e){if(e){for(e.parentNode&&e.parentNode.removeChild(e);e.hasChildNodes();)e.removeChild(e.firstChild);e.removeAttribute("src"),"function"==typeof e.load&&function(){try{e.load()}catch(e){}}()}},Na.resetMediaElement=function(e){if(e){for(var t=e.querySelectorAll("source"),n=t.length;n--;)e.removeChild(t[n]);e.removeAttribute("src"),"function"==typeof e.load&&function(){try{e.load()}catch(e){}}()}},["muted","defaultMuted","autoplay","controls","loop","playsinline"].forEach(function(e){Na.prototype[e]=function(){return this.el_[e]||this.el_.hasAttribute(e)}}),["muted","defaultMuted","autoplay","loop","playsinline"].forEach(function(e){Na.prototype["set"+$e(e)]=function(t){this.el_[e]=t,t?this.el_.setAttribute(e,e):this.el_.removeAttribute(e)}}),["paused","currentTime","buffered","volume","poster","preload","error","seeking","seekable","ended","playbackRate","defaultPlaybackRate","played","networkState","readyState","videoWidth","videoHeight"].forEach(function(e){Na.prototype[e]=function(){return this.el_[e]}}),["volume","src","poster","preload","playbackRate","defaultPlaybackRate"].forEach(function(e){Na.prototype["set"+$e(e)]=function(t){this.el_[e]=t}}),["pause","load","play"].forEach(function(e){Na.prototype[e]=function(){return this.el_[e]()}}),Wi.withSourceHandlers(Na),Na.nativeSourceHandler={},Na.nativeSourceHandler.canPlayType=function(e){try{return Na.TEST_VID.canPlayType(e)}catch(e){return""}},Na.nativeSourceHandler.canHandleSource=function(e,t){if(e.type)return Na.nativeSourceHandler.canPlayType(e.type);if(e.src){var n=Wt(e.src);return Na.nativeSourceHandler.canPlayType("video/"+n)}return""},Na.nativeSourceHandler.handleSource=function(e,t,n){t.setSrc(e.src)},Na.nativeSourceHandler.dispose=function(){},Na.registerSourceHandler(Na.nativeSourceHandler),Wi.registerTech("Html5",Na);var Ba=["progress","abort","suspend","emptied","stalled","loadedmetadata","loadeddata","timeupdate","resize","volumechange","texttrackchange"],Fa={canplay:"CanPlay",canplaythrough:"CanPlayThrough",playing:"Playing",seeked:"Seeked"},Ua=["tiny","xsmall","small","medium","large","xlarge","huge"],Va={};Ua.forEach(function(e){var t="x"===e.charAt(0)?"x-"+e.substring(1):e;Va[e]="vjs-layout-"+t});var qa={tiny:210,xsmall:320,small:425,medium:768,large:1440,xlarge:2560,huge:1/0},Ha=function(r){function a(e,t,i){var s;if(e.id=e.id||t.id||"vjs_video_"+ne(),(t=v(a.getTagSettings(e),t)).initChildren=!1,t.createEl=!1,t.evented=!1,t.reportTouchActivity=!1,!t.language)if("function"==typeof e.closest){var l=e.closest("[lang]");l&&l.getAttribute&&(t.language=l.getAttribute("lang"))}else for(var u=e;u&&1===u.nodeType;){if(M(u).hasOwnProperty("lang")){t.language=u.getAttribute("lang");break}u=u.parentNode}if((s=r.call(this,null,t,i)||this).boundDocumentFullscreenChange_=Ee(o(s),s.documentFullscreenChange_),s.boundFullWindowOnEscKey_=Ee(o(s),s.fullWindowOnEscKey),s.log=d(s.id_),s.fsApi_=ft,s.isPosterFromTech_=!1,s.queuedCallbacks_=[],s.isReady_=!1,s.hasStarted_=!1,s.userActive_=!1,!s.options_||!s.options_.techOrder||!s.options_.techOrder.length)throw new Error("No techOrder specified. Did you overwrite videojs.options instead of just changing the properties you want to override?");if(s.tag=e,s.tagAttributes=e&&M(e),s.language(s.options_.language),t.languages){var c={};Object.getOwnPropertyNames(t.languages).forEach(function(e){c[e.toLowerCase()]=t.languages[e]}),s.languages_=c}else s.languages_=a.prototype.options_.languages;s.resetCache_(),s.poster_=t.poster||"",s.controls_=!!t.controls,e.controls=!1,e.removeAttribute("controls"),s.changingSrc_=!1,s.playCallbacks_=[],s.playTerminatedQueue_=[],e.hasAttribute("autoplay")?s.autoplay(!0):s.autoplay(s.options_.autoplay),t.plugins&&Object.keys(t.plugins).forEach(function(e){if("function"!=typeof s[e])throw new Error('plugin "'+e+'" does not exist')}),s.scrubbing_=!1,s.el_=s.createEl(),Le(o(s),{eventBusKey:"el_"}),s.fluid_&&s.on("playerreset",s.updateStyleEl_);var h=je(s.options_);t.plugins&&Object.keys(t.plugins).forEach(function(e){s[e](t.plugins[e])}),s.options_.playerOptions=h,s.middleware_=[],s.initChildren(),s.isAudio("audio"===e.nodeName.toLowerCase()),s.controls()?s.addClass("vjs-controls-enabled"):s.addClass("vjs-controls-disabled"),s.el_.setAttribute("role","region"),s.isAudio()?s.el_.setAttribute("aria-label",s.localize("Audio Player")):s.el_.setAttribute("aria-label",s.localize("Video Player")),s.isAudio()&&s.addClass("vjs-audio"),s.flexNotSupported_()&&s.addClass("vjs-no-flex"),st&&s.addClass("vjs-touch-enabled"),Ge||s.addClass("vjs-workinghover"),a.players[s.id_]=o(s);var p=n.split(".")[0];return s.addClass("vjs-v"+p),s.userActive(!0),s.reportUserActivity(),s.one("play",s.listenForUserActivity_),s.on("stageclick",s.handleStageClick_),s.on("keydown",s.handleKeyDown),s.breakpoints(s.options_.breakpoints),s.responsive(s.options_.responsive),s}i(a,r);var s=a.prototype;return s.dispose=function(){var e=this;this.trigger("dispose"),this.off("dispose"),ue(t,this.fsApi_.fullscreenchange,this.boundDocumentFullscreenChange_),ue(t,"keydown",this.boundFullWindowOnEscKey_),this.styleEl_&&this.styleEl_.parentNode&&(this.styleEl_.parentNode.removeChild(this.styleEl_),this.styleEl_=null),a.players[this.id_]=null,this.tag&&this.tag.player&&(this.tag.player=null),this.el_&&this.el_.player&&(this.el_.player=null),this.tech_&&(this.tech_.dispose(),this.isPosterFromTech_=!1,this.poster_=""),this.playerElIngest_&&(this.playerElIngest_=null),this.tag&&(this.tag=null),Xi[this.id()]=null,vi.names.forEach(function(t){var n=vi[t],i=e[n.getterName]();i&&i.off&&i.off()}),r.prototype.dispose.call(this)},s.createEl=function(){var n,i=this.tag,a=this.playerElIngest_=i.parentNode&&i.parentNode.hasAttribute&&i.parentNode.hasAttribute("data-vjs-player"),o="video-js"===this.tag.tagName.toLowerCase();a?n=this.el_=i.parentNode:o||(n=this.el_=r.prototype.createEl.call(this,"div"));var s=M(i);if(o){for(n=this.el_=i,i=this.tag=t.createElement("video");n.children.length;)i.appendChild(n.firstChild);x(n,"video-js")||A(n,"video-js"),n.appendChild(i),a=this.playerElIngest_=n,Object.keys(n).forEach(function(e){i[e]=n[e]})}if(i.setAttribute("tabindex","-1"),s.tabindex="-1",(it||tt&&ot)&&(i.setAttribute("role","application"),s.role="application"),i.removeAttribute("width"),i.removeAttribute("height"),"width"in s&&delete s.width,"height"in s&&delete s.height,Object.getOwnPropertyNames(s).forEach(function(e){o&&"class"===e||n.setAttribute(e,s[e]),o&&i.setAttribute(e,s[e])}),i.playerId=i.id,i.id+="_html5_api",i.className="vjs-tech",i.player=n.player=this,this.addClass("vjs-paused"),!0!==e.VIDEOJS_NO_DYNAMIC_STYLE){this.styleEl_=be("vjs-styles-dimensions");var l=Q(".vjs-styles-defaults"),u=Q("head");u.insertBefore(this.styleEl_,l?l.nextSibling:u.firstChild)}this.fill_=!1,this.fluid_=!1,this.width(this.options_.width),this.height(this.options_.height),this.fill(this.options_.fill),this.fluid(this.options_.fluid),this.aspectRatio(this.options_.aspectRatio);for(var c=i.getElementsByTagName("a"),d=0;d<c.length;d++){var h=c.item(d);A(h,"vjs-hidden"),h.setAttribute("hidden","hidden")}return i.initNetworkState_=i.networkState,i.parentNode&&!a&&i.parentNode.insertBefore(n,i),R(i,n),this.children_.unshift(i),this.el_.setAttribute("lang",this.language_),this.el_=n,n},s.width=function(e){return this.dimension("width",e)},s.height=function(e){return this.dimension("height",e)},s.dimension=function(e,t){var n=e+"_";if(void 0===t)return this[n]||0;if(""===t)return this[n]=void 0,void this.updateStyleEl_();var i=parseFloat(t);isNaN(i)?c.error('Improper value "'+t+'" supplied for for '+e):(this[n]=i,this.updateStyleEl_())},s.fluid=function(e){if(void 0===e)return!!this.fluid_;var t,n;this.fluid_=!!e,Se(this)&&this.off("playerreset",this.updateStyleEl_),e?(this.addClass("vjs-fluid"),this.fill(!1),Se(t=function(){this.on("playerreset",this.updateStyleEl_)})?n():(t.eventedCallbacks||(t.eventedCallbacks=[]),t.eventedCallbacks.push(n))):this.removeClass("vjs-fluid"),this.updateStyleEl_()},s.fill=function(e){if(void 0===e)return!!this.fill_;this.fill_=!!e,e?(this.addClass("vjs-fill"),this.fluid(!1)):this.removeClass("vjs-fill")},s.aspectRatio=function(e){if(void 0===e)return this.aspectRatio_;if(!/^\d+\:\d+$/.test(e))throw new Error("Improper value supplied for aspect ratio. The format should be width:height, for example 16:9.");this.aspectRatio_=e,this.fluid(!0),this.updateStyleEl_()},s.updateStyleEl_=function(){if(!0!==e.VIDEOJS_NO_DYNAMIC_STYLE){var t,n,i,r=(void 0!==this.aspectRatio_&&"auto"!==this.aspectRatio_?this.aspectRatio_:this.videoWidth()>0?this.videoWidth()+":"+this.videoHeight():"16:9").split(":"),a=r[1]/r[0];t=void 0!==this.width_?this.width_:void 0!==this.height_?this.height_/a:this.videoWidth()||300,n=void 0!==this.height_?this.height_:t*a,i=/^[^a-zA-Z]/.test(this.id())?"dimensions-"+this.id():this.id()+"-dimensions",this.addClass(i),_e(this.styleEl_,"\n      ."+i+" {\n        width: "+t+"px;\n        height: "+n+"px;\n      }\n\n      ."+i+".vjs-fluid {\n        padding-top: "+100*a+"%;\n      }\n    ")}else{var o="number"==typeof this.width_?this.width_:this.options_.width,s="number"==typeof this.height_?this.height_:this.options_.height,l=this.tech_&&this.tech_.el();l&&(o>=0&&(l.width=o),s>=0&&(l.height=s))}},s.loadTech_=function(e,t){var n=this;this.tech_&&this.unloadTech_();var i=$e(e),r=e.charAt(0).toLowerCase()+e.slice(1);"Html5"!==i&&this.tag&&(Wi.getTech("Html5").disposeMediaElement(this.tag),this.tag.player=null,this.tag=null),this.techName_=i,this.isReady_=!1;var a={source:t,autoplay:"string"!=typeof this.autoplay()&&this.autoplay(),nativeControlsForTouch:this.options_.nativeControlsForTouch,playerId:this.id(),techId:this.id()+"_"+r+"_api",playsinline:this.options_.playsinline,preload:this.options_.preload,loop:this.options_.loop,muted:this.options_.muted,poster:this.poster(),language:this.language(),playerElIngest:this.playerElIngest_||!1,"vtt.js":this.options_["vtt.js"],canOverridePoster:!!this.options_.techCanOverridePoster,enableSourceset:this.options_.enableSourceset,Promise:this.options_.Promise};vi.names.forEach(function(e){var t=vi[e];a[t.getterName]=n[t.privateName]}),v(a,this.options_[i]),v(a,this.options_[r]),v(a,this.options_[e.toLowerCase()]),this.tag&&(a.tag=this.tag),t&&t.src===this.cache_.src&&this.cache_.currentTime>0&&(a.startTime=this.cache_.currentTime);var o=Wi.getTech(e);if(!o)throw new Error("No Tech named '"+i+"' exists! '"+i+"' should be registered using videojs.registerTech()'");this.tech_=new o(a),this.tech_.ready(Ee(this,this.handleTechReady_),!0),kt(this.textTracksJson_||[],this.tech_),Ba.forEach(function(e){n.on(n.tech_,e,n["handleTech"+$e(e)+"_"])}),Object.keys(Fa).forEach(function(e){n.on(n.tech_,e,function(t){0===n.tech_.playbackRate()&&n.tech_.seeking()?n.queuedCallbacks_.push({callback:n["handleTech"+Fa[e]+"_"].bind(n),event:t}):n["handleTech"+Fa[e]+"_"](t)})}),this.on(this.tech_,"loadstart",this.handleTechLoadStart_),this.on(this.tech_,"sourceset",this.handleTechSourceset_),this.on(this.tech_,"waiting",this.handleTechWaiting_),this.on(this.tech_,"ended",this.handleTechEnded_),this.on(this.tech_,"seeking",this.handleTechSeeking_),this.on(this.tech_,"play",this.handleTechPlay_),this.on(this.tech_,"firstplay",this.handleTechFirstPlay_),this.on(this.tech_,"pause",this.handleTechPause_),this.on(this.tech_,"durationchange",this.handleTechDurationChange_),this.on(this.tech_,"fullscreenchange",this.handleTechFullscreenChange_),this.on(this.tech_,"enterpictureinpicture",this.handleTechEnterPictureInPicture_),this.on(this.tech_,"leavepictureinpicture",this.handleTechLeavePictureInPicture_),this.on(this.tech_,"error",this.handleTechError_),this.on(this.tech_,"loadedmetadata",this.updateStyleEl_),this.on(this.tech_,"posterchange",this.handleTechPosterChange_),this.on(this.tech_,"textdata",this.handleTechTextData_),this.on(this.tech_,"ratechange",this.handleTechRateChange_),this.usingNativeControls(this.techGet_("controls")),this.controls()&&!this.usingNativeControls()&&this.addTechControlsListeners_(),this.tech_.el().parentNode===this.el()||"Html5"===i&&this.tag||R(this.tech_.el(),this.el()),this.tag&&(this.tag.player=null,this.tag=null)},s.unloadTech_=function(){var e=this;vi.names.forEach(function(t){var n=vi[t];e[n.privateName]=e[n.getterName]()}),this.textTracksJson_=wt(this.tech_),this.isReady_=!1,this.tech_.dispose(),this.tech_=!1,this.isPosterFromTech_&&(this.poster_="",this.trigger("posterchange")),this.isPosterFromTech_=!1},s.tech=function(e){return void 0===e&&c.warn(p(ja())),this.tech_},s.addTechControlsListeners_=function(){this.removeTechControlsListeners_(),this.on(this.tech_,"mouseup",this.handleTechClick_),this.on(this.tech_,"dblclick",this.handleTechDoubleClick_),this.on(this.tech_,"touchstart",this.handleTechTouchStart_),this.on(this.tech_,"touchmove",this.handleTechTouchMove_),this.on(this.tech_,"touchend",this.handleTechTouchEnd_),this.on(this.tech_,"tap",this.handleTechTap_)},s.removeTechControlsListeners_=function(){this.off(this.tech_,"tap",this.handleTechTap_),this.off(this.tech_,"touchstart",this.handleTechTouchStart_),this.off(this.tech_,"touchmove",this.handleTechTouchMove_),this.off(this.tech_,"touchend",this.handleTechTouchEnd_),this.off(this.tech_,"mouseup",this.handleTechClick_),this.off(this.tech_,"dblclick",this.handleTechDoubleClick_)},s.handleTechReady_=function(){this.triggerReady(),this.cache_.volume&&this.techCall_("setVolume",this.cache_.volume),this.handleTechPosterChange_(),this.handleTechDurationChange_()},s.handleTechLoadStart_=function(){this.removeClass("vjs-ended"),this.removeClass("vjs-seeking"),this.error(null),this.handleTechDurationChange_(),this.paused()?(this.hasStarted(!1),this.trigger("loadstart")):(this.trigger("loadstart"),this.trigger("firstplay")),this.manualAutoplay_(this.autoplay())},s.manualAutoplay_=function(e){var t=this;if(this.tech_&&"string"==typeof e){var n,i=function(){var e=t.muted();t.muted(!0);var n=function(){t.muted(e)};t.playTerminatedQueue_.push(n);var i=t.play();if(Tt(i))return i.catch(n)};if("any"===e&&!0!==this.muted()?Tt(n=this.play())&&(n=n.catch(i)):n="muted"===e&&!0!==this.muted()?i():this.play(),Tt(n))return n.then(function(){t.trigger({type:"autoplay-success",autoplay:e})}).catch(function(n){t.trigger({type:"autoplay-failure",autoplay:e})})}},s.updateSourceCaches_=function(e){void 0===e&&(e="");var t=e,n="";"string"!=typeof t&&(t=e.src,n=e.type),this.cache_.source=this.cache_.source||{},this.cache_.sources=this.cache_.sources||[],t&&!n&&(n=function(e,t){if(!t)return"";if(e.cache_.source.src===t&&e.cache_.source.type)return e.cache_.source.type;var n=e.cache_.sources.filter(function(e){return e.src===t});if(n.length)return n[0].type;for(var i=e.$$("source"),r=0;r<i.length;r++){var a=i[r];if(a.type&&a.src&&a.src===t)return a.type}return ir(t)}(this,t)),this.cache_.source=je({},e,{src:t,type:n});for(var i=this.cache_.sources.filter(function(e){return e.src&&e.src===t}),r=[],a=this.$$("source"),o=[],s=0;s<a.length;s++){var l=M(a[s]);r.push(l),l.src&&l.src===t&&o.push(l.src)}o.length&&!i.length?this.cache_.sources=r:i.length||(this.cache_.sources=[this.cache_.source]),this.cache_.src=t},s.handleTechSourceset_=function(e){var t=this;if(!this.changingSrc_){var n=function(e){return t.updateSourceCaches_(e)},i=this.currentSource().src,r=e.src;i&&!/^blob:/.test(i)&&/^blob:/.test(r)&&(!this.lastSource_||this.lastSource_.tech!==r&&this.lastSource_.player!==i)&&(n=function(){}),n(r),e.src||this.tech_.any(["sourceset","loadstart"],function(e){if("sourceset"!==e.type){var n=t.techGet("currentSrc");t.lastSource_.tech=n,t.updateSourceCaches_(n)}})}this.lastSource_={player:this.currentSource().src,tech:e.src},this.trigger({src:e.src,type:"sourceset"})},s.hasStarted=function(e){if(void 0===e)return this.hasStarted_;e!==this.hasStarted_&&(this.hasStarted_=e,this.hasStarted_?(this.addClass("vjs-has-started"),this.trigger("firstplay")):this.removeClass("vjs-has-started"))},s.handleTechPlay_=function(){this.removeClass("vjs-ended"),this.removeClass("vjs-paused"),this.addClass("vjs-playing"),this.hasStarted(!0),this.trigger("play")},s.handleTechRateChange_=function(){this.tech_.playbackRate()>0&&0===this.cache_.lastPlaybackRate&&(this.queuedCallbacks_.forEach(function(e){return e.callback(e.event)}),this.queuedCallbacks_=[]),this.cache_.lastPlaybackRate=this.tech_.playbackRate(),this.trigger("ratechange")},s.handleTechWaiting_=function(){var e=this;this.addClass("vjs-waiting"),this.trigger("waiting");var t=this.currentTime();this.on("timeupdate",function n(){t!==e.currentTime()&&(e.removeClass("vjs-waiting"),e.off("timeupdate",n))})},s.handleTechCanPlay_=function(){this.removeClass("vjs-waiting"),this.trigger("canplay")},s.handleTechCanPlayThrough_=function(){this.removeClass("vjs-waiting"),this.trigger("canplaythrough")},s.handleTechPlaying_=function(){this.removeClass("vjs-waiting"),this.trigger("playing")},s.handleTechSeeking_=function(){this.addClass("vjs-seeking"),this.trigger("seeking")},s.handleTechSeeked_=function(){this.removeClass("vjs-seeking"),this.removeClass("vjs-ended"),this.trigger("seeked")},s.handleTechFirstPlay_=function(){this.options_.starttime&&(c.warn("Passing the `starttime` option to the player will be deprecated in 6.0"),this.currentTime(this.options_.starttime)),this.addClass("vjs-has-started"),this.trigger("firstplay")},s.handleTechPause_=function(){this.removeClass("vjs-playing"),this.addClass("vjs-paused"),this.trigger("pause")},s.handleTechEnded_=function(){this.addClass("vjs-ended"),this.options_.loop?(this.currentTime(0),this.play()):this.paused()||this.pause(),this.trigger("ended")},s.handleTechDurationChange_=function(){this.duration(this.techGet_("duration"))},s.handleTechClick_=function(e){Y(e)&&this.controls_&&(this.paused()?Et(this.play()):this.pause())},s.handleTechDoubleClick_=function(e){this.controls_&&(Array.prototype.some.call(this.$$(".vjs-control-bar, .vjs-modal-dialog"),function(t){return t.contains(e.target)})||void 0!==this.options_&&void 0!==this.options_.userActions&&void 0!==this.options_.userActions.doubleClick&&!1===this.options_.userActions.doubleClick||(void 0!==this.options_&&void 0!==this.options_.userActions&&"function"==typeof this.options_.userActions.doubleClick?this.options_.userActions.doubleClick.call(this,e):this.isFullscreen()?this.exitFullscreen():this.requestFullscreen()))},s.handleTechTap_=function(){this.userActive(!this.userActive())},s.handleTechTouchStart_=function(){this.userWasActive=this.userActive()},s.handleTechTouchMove_=function(){this.userWasActive&&this.reportUserActivity()},s.handleTechTouchEnd_=function(e){e.preventDefault()},s.handleStageClick_=function(){this.reportUserActivity()},s.toggleFullscreenClass_=function(){this.isFullscreen()?this.addClass("vjs-fullscreen"):this.removeClass("vjs-fullscreen")},s.documentFullscreenChange_=function(e){var n=this.el(),i=t[this.fsApi_.fullscreenElement]===n;!i&&n.matches?i=n.matches(":"+this.fsApi_.fullscreen):!i&&n.msMatchesSelector&&(i=n.msMatchesSelector(":"+this.fsApi_.fullscreen)),this.isFullscreen(i),!1===this.isFullscreen()&&ue(t,this.fsApi_.fullscreenchange,this.boundDocumentFullscreenChange_),this.fsApi_.prefixed&&this.trigger("fullscreenchange")},s.handleTechFullscreenChange_=function(e,t){t&&this.isFullscreen(t.isFullscreen),this.trigger("fullscreenchange")},s.togglePictureInPictureClass_=function(){this.isInPictureInPicture()?this.addClass("vjs-picture-in-picture"):this.removeClass("vjs-picture-in-picture")},s.handleTechEnterPictureInPicture_=function(e){this.isInPictureInPicture(!0)},s.handleTechLeavePictureInPicture_=function(e){this.isInPictureInPicture(!1)},s.handleTechError_=function(){var e=this.tech_.error();this.error(e)},s.handleTechTextData_=function(){var e=null;arguments.length>1&&(e=arguments[1]),this.trigger("textdata",e)},s.getCache=function(){return this.cache_},s.resetCache_=function(){this.cache_={currentTime:0,inactivityTimeout:this.options_.inactivityTimeout,duration:NaN,lastVolume:1,lastPlaybackRate:this.defaultPlaybackRate(),media:null,src:"",source:{},sources:[],volume:1}},s.techCall_=function(e,t){this.ready(function(){if(e in Zi)return function(e,t,n,i){return t[n](e.reduce(tr(n),i))}(this.middleware_,this.tech_,e,t);if(e in er)return Qi(this.middleware_,this.tech_,e,t);try{this.tech_&&this.tech_[e](t)}catch(e){throw c(e),e}},!0)},s.techGet_=function(e){if(this.tech_&&this.tech_.isReady_){if(e in Ji)return function(e,t,n){return e.reduceRight(tr(n),t[n]())}(this.middleware_,this.tech_,e);if(e in er)return Qi(this.middleware_,this.tech_,e);try{return this.tech_[e]()}catch(t){if(void 0===this.tech_[e])throw c("Video.js: "+e+" method not defined for "+this.techName_+" playback technology.",t),t;if("TypeError"===t.name)throw c("Video.js: "+e+" unavailable on "+this.techName_+" playback technology element.",t),this.tech_.isReady_=!1,t;throw c(t),t}}},s.play=function(){var t=this,n=this.options_.Promise||e.Promise;return n?new n(function(e){t.play_(e)}):this.play_()},s.play_=function(e){var t=this;void 0===e&&(e=Et),this.playCallbacks_.push(e);var n=Boolean(!this.changingSrc_&&(this.src()||this.currentSrc()));if(this.waitToPlay_&&(this.off(["ready","loadstart"],this.waitToPlay_),this.waitToPlay_=null),!this.isReady_||!n)return this.waitToPlay_=function(e){t.play_()},this.one(["ready","loadstart"],this.waitToPlay_),void(n||!at&&!Ge||this.load());var i=this.techGet_("play");null===i?this.runPlayTerminatedQueue_():this.runPlayCallbacks_(i)},s.runPlayTerminatedQueue_=function(){var e=this.playTerminatedQueue_.slice(0);this.playTerminatedQueue_=[],e.forEach(function(e){e()})},s.runPlayCallbacks_=function(e){var t=this.playCallbacks_.slice(0);this.playCallbacks_=[],this.playTerminatedQueue_=[],t.forEach(function(t){t(e)})},s.pause=function(){this.techCall_("pause")},s.paused=function(){return!1!==this.techGet_("paused")},s.played=function(){return this.techGet_("played")||dt(0,0)},s.scrubbing=function(e){if(void 0===e)return this.scrubbing_;this.scrubbing_=!!e,e?this.addClass("vjs-scrubbing"):this.removeClass("vjs-scrubbing")},s.currentTime=function(e){return void 0!==e?(e<0&&(e=0),void this.techCall_("setCurrentTime",e)):(this.cache_.currentTime=this.techGet_("currentTime")||0,this.cache_.currentTime)},s.duration=function(e){if(void 0===e)return void 0!==this.cache_.duration?this.cache_.duration:NaN;(e=parseFloat(e))<0&&(e=1/0),e!==this.cache_.duration&&(this.cache_.duration=e,e===1/0?(this.addClass("vjs-live"),this.options_.liveui&&this.player_.liveTracker&&this.addClass("vjs-liveui")):(this.removeClass("vjs-live"),this.removeClass("vjs-liveui")),isNaN(e)||this.trigger("durationchange"))},s.remainingTime=function(){return this.duration()-this.currentTime()},s.remainingTimeDisplay=function(){return Math.floor(this.duration())-Math.floor(this.currentTime())},s.buffered=function(){var e=this.techGet_("buffered");return e&&e.length||(e=dt(0,0)),e},s.bufferedPercent=function(){return ht(this.buffered(),this.duration())},s.bufferedEnd=function(){var e=this.buffered(),t=this.duration(),n=e.end(e.length-1);return n>t&&(n=t),n},s.volume=function(e){var t;return void 0!==e?(t=Math.max(0,Math.min(1,parseFloat(e))),this.cache_.volume=t,this.techCall_("setVolume",t),void(t>0&&this.lastVolume_(t))):(t=parseFloat(this.techGet_("volume")),isNaN(t)?1:t)},s.muted=function(e){if(void 0===e)return this.techGet_("muted")||!1;this.techCall_("setMuted",e)},s.defaultMuted=function(e){return void 0!==e?this.techCall_("setDefaultMuted",e):this.techGet_("defaultMuted")||!1},s.lastVolume_=function(e){if(void 0===e||0===e)return this.cache_.lastVolume;this.cache_.lastVolume=e},s.supportsFullScreen=function(){return this.techGet_("supportsFullScreen")||!1},s.isFullscreen=function(e){return void 0!==e?(this.isFullscreen_=!!e,void this.toggleFullscreenClass_()):!!this.isFullscreen_},s.requestFullscreen=function(e){var n;this.isFullscreen(!0),this.fsApi_.requestFullscreen?(le(t,this.fsApi_.fullscreenchange,this.boundDocumentFullscreenChange_),this.fsApi_.prefixed||(n=this.options_.fullscreen&&this.options_.fullscreen.options||{},void 0!==e&&(n=e)),Et(this.el_[this.fsApi_.requestFullscreen](n))):this.tech_.supportsFullScreen()?this.techCall_("enterFullScreen"):(this.enterFullWindow(),this.trigger("fullscreenchange"))},s.exitFullscreen=function(){this.isFullscreen(!1),this.fsApi_.requestFullscreen?Et(t[this.fsApi_.exitFullscreen]()):this.tech_.supportsFullScreen()?this.techCall_("exitFullScreen"):(this.exitFullWindow(),this.trigger("fullscreenchange"))},s.enterFullWindow=function(){this.isFullWindow=!0,this.docOrigOverflow=t.documentElement.style.overflow,le(t,"keydown",this.boundFullWindowOnEscKey_),t.documentElement.style.overflow="hidden",A(t.body,"vjs-full-window"),this.trigger("enterFullWindow")},s.fullWindowOnEscKey=function(e){It.isEventKey(e,"Esc")&&(!0===this.isFullscreen()?this.exitFullscreen():this.exitFullWindow())},s.exitFullWindow=function(){this.isFullWindow=!1,ue(t,"keydown",this.boundFullWindowOnEscKey_),t.documentElement.style.overflow=this.docOrigOverflow,P(t.body,"vjs-full-window"),this.trigger("exitFullWindow")},s.isInPictureInPicture=function(e){return void 0!==e?(this.isInPictureInPicture_=!!e,void this.togglePictureInPictureClass_()):!!this.isInPictureInPicture_},s.requestPictureInPicture=function(){if("pictureInPictureEnabled"in t)return this.techGet_("requestPictureInPicture")},s.exitPictureInPicture=function(){if("pictureInPictureEnabled"in t)return t.exitPictureInPicture()},s.handleKeyDown=function(e){var t,n,i=this.options_.userActions;i&&i.hotkeys&&(("input"===(n=(t=this.el_.ownerDocument.activeElement).tagName.toLowerCase())?-1===["button","checkbox","hidden","radio","reset","submit"].indexOf(t.type):-1!==["textarea"].indexOf(n))||("function"==typeof i.hotkeys?i.hotkeys.call(this,e):this.handleHotkeys(e)))},s.handleHotkeys=function(e){var n=this.options_.userActions?this.options_.userActions.hotkeys:{},i=n.fullscreenKey,r=void 0===i?function(e){return It.isEventKey(e,"f")}:i,a=n.muteKey,o=void 0===a?function(e){return It.isEventKey(e,"m")}:a,s=n.playPauseKey,l=void 0===s?function(e){return It.isEventKey(e,"k")||It.isEventKey(e,"Space")}:s;if(r.call(this,e)){e.preventDefault(),e.stopPropagation();var u=Be.getComponent("FullscreenToggle");!1!==t[this.fsApi_.fullscreenEnabled]&&u.prototype.handleClick.call(this,e)}else if(o.call(this,e)){e.preventDefault(),e.stopPropagation(),Be.getComponent("MuteToggle").prototype.handleClick.call(this,e)}else if(l.call(this,e)){e.preventDefault(),e.stopPropagation(),Be.getComponent("PlayToggle").prototype.handleClick.call(this,e)}},s.canPlayType=function(e){for(var t,n=0,i=this.options_.techOrder;n<i.length;n++){var r=i[n],a=Wi.getTech(r);if(a||(a=Be.getComponent(r)),a){if(a.isSupported()&&(t=a.canPlayType(e)))return t}else c.error('The "'+r+'" tech is undefined. Skipped browser support check for that tech.')}return""},s.selectSource=function(e){var t,n=this,i=this.options_.techOrder.map(function(e){return[e,Wi.getTech(e)]}).filter(function(e){var t=e[0],n=e[1];return n?n.isSupported():(c.error('The "'+t+'" tech is undefined. Skipped browser support check for that tech.'),!1)}),r=function(e,t,n){var i;return e.some(function(e){return t.some(function(t){if(i=n(e,t))return!0})}),i},a=function(e,t){var i=e[0];if(e[1].canPlaySource(t,n.options_[i.toLowerCase()]))return{source:t,tech:i}};return(this.options_.sourceOrder?r(e,i,(t=a,function(e,n){return t(n,e)})):r(i,e,a))||!1},s.src=function(e){var t=this;if(void 0===e)return this.cache_.src||"";var n=function e(t){if(Array.isArray(t)){var n=[];t.forEach(function(t){t=e(t),Array.isArray(t)?n=n.concat(t):y(t)&&n.push(t)}),t=n}else t="string"==typeof t&&t.trim()?[rr({src:t})]:y(t)&&"string"==typeof t.src&&t.src&&t.src.trim()?[rr(t)]:[];return t}(e);n.length?(this.changingSrc_=!0,this.cache_.sources=n,this.updateSourceCaches_(n[0]),function(e,t,n){e.setTimeout(function(){return function e(t,n,i,r,a,o){void 0===t&&(t={}),void 0===n&&(n=[]),void 0===a&&(a=[]),void 0===o&&(o=!1);var s=n,l=s[0],u=s.slice(1);if("string"==typeof l)e(t,Gi[l],i,r,a,o);else if(l){var c=function(e,t){var n=Xi[e.id()],i=null;if(void 0===n||null===n)return i=t(e),Xi[e.id()]=[[t,i]],i;for(var r=0;r<n.length;r++){var a=n[r],o=a[0],s=a[1];o===t&&(i=s)}return null===i&&(i=t(e),n.push([t,i])),i}(r,l);if(!c.setSource)return a.push(c),e(t,u,i,r,a,o);c.setSource(v({},t),function(n,s){if(n)return e(t,u,i,r,a,o);a.push(c),e(s,t.type===s.type?u:Gi[s.type],i,r,a,o)})}else u.length?e(t,u,i,r,a,o):o?i(t,a):e(t,Gi["*"],i,r,a,!0)}(t,Gi[t.type],n,e)},1)}(this,n[0],function(e,i){var r,a;if(t.middleware_=i,t.cache_.sources=n,t.updateSourceCaches_(e),t.src_(e))return n.length>1?t.src(n.slice(1)):(t.changingSrc_=!1,t.setTimeout(function(){this.error({code:4,message:this.localize(this.options_.notSupportedMessage)})},0),void t.triggerReady());r=i,a=t.tech_,r.forEach(function(e){return e.setTech&&e.setTech(a)})})):this.setTimeout(function(){this.error({code:4,message:this.localize(this.options_.notSupportedMessage)})},0)},s.src_=function(e){var t,n,i=this,r=this.selectSource([e]);return!r||(t=r.tech,n=this.techName_,$e(t)!==$e(n)?(this.changingSrc_=!0,this.loadTech_(r.tech,r.source),this.tech_.ready(function(){i.changingSrc_=!1}),!1):(this.ready(function(){this.tech_.constructor.prototype.hasOwnProperty("setSource")?this.techCall_("setSource",e):this.techCall_("src",e.src),this.changingSrc_=!1},!0),!1))},s.load=function(){this.techCall_("load")},s.reset=function(){var t=this,n=this.options_.Promise||e.Promise;this.paused()||!n?this.doReset_():Et(this.play().then(function(){return t.doReset_()}))},s.doReset_=function(){this.tech_&&this.tech_.clearTracks("text"),this.resetCache_(),this.poster(""),this.loadTech_(this.options_.techOrder[0],null),this.techCall_("reset"),this.resetControlBarUI_(),Se(this)&&this.trigger("playerreset")},s.resetControlBarUI_=function(){this.resetProgressBar_(),this.resetPlaybackRate_(),this.resetVolumeBar_()},s.resetProgressBar_=function(){this.currentTime(0);var e=this.controlBar,t=e.durationDisplay,n=e.remainingTimeDisplay;t&&t.updateContent(),n&&n.updateContent()},s.resetPlaybackRate_=function(){this.playbackRate(this.defaultPlaybackRate()),this.handleTechRateChange_()},s.resetVolumeBar_=function(){this.volume(1),this.trigger("volumechange")},s.currentSources=function(){var e=this.currentSource(),t=[];return 0!==Object.keys(e).length&&t.push(e),this.cache_.sources||t},s.currentSource=function(){return this.cache_.source||{}},s.currentSrc=function(){return this.currentSource()&&this.currentSource().src||""},s.currentType=function(){return this.currentSource()&&this.currentSource().type||""},s.preload=function(e){return void 0!==e?(this.techCall_("setPreload",e),void(this.options_.preload=e)):this.techGet_("preload")},s.autoplay=function(e){if(void 0===e)return this.options_.autoplay||!1;var t;"string"==typeof e&&/(any|play|muted)/.test(e)?(this.options_.autoplay=e,this.manualAutoplay_(e),t=!1):this.options_.autoplay=!!e,t=void 0===t?this.options_.autoplay:t,this.tech_&&this.techCall_("setAutoplay",t)},s.playsinline=function(e){return void 0!==e?(this.techCall_("setPlaysinline",e),this.options_.playsinline=e,this):this.techGet_("playsinline")},s.loop=function(e){return void 0!==e?(this.techCall_("setLoop",e),void(this.options_.loop=e)):this.techGet_("loop")},s.poster=function(e){if(void 0===e)return this.poster_;e||(e=""),e!==this.poster_&&(this.poster_=e,this.techCall_("setPoster",e),this.isPosterFromTech_=!1,this.trigger("posterchange"))},s.handleTechPosterChange_=function(){if((!this.poster_||this.options_.techCanOverridePoster)&&this.tech_&&this.tech_.poster){var e=this.tech_.poster()||"";e!==this.poster_&&(this.poster_=e,this.isPosterFromTech_=!0,this.trigger("posterchange"))}},s.controls=function(e){if(void 0===e)return!!this.controls_;e=!!e,this.controls_!==e&&(this.controls_=e,this.usingNativeControls()&&this.techCall_("setControls",e),this.controls_?(this.removeClass("vjs-controls-disabled"),this.addClass("vjs-controls-enabled"),this.trigger("controlsenabled"),this.usingNativeControls()||this.addTechControlsListeners_()):(this.removeClass("vjs-controls-enabled"),this.addClass("vjs-controls-disabled"),this.trigger("controlsdisabled"),this.usingNativeControls()||this.removeTechControlsListeners_()))},s.usingNativeControls=function(e){if(void 0===e)return!!this.usingNativeControls_;e=!!e,this.usingNativeControls_!==e&&(this.usingNativeControls_=e,this.usingNativeControls_?(this.addClass("vjs-using-native-controls"),this.trigger("usingnativecontrols")):(this.removeClass("vjs-using-native-controls"),this.trigger("usingcustomcontrols")))},s.error=function(e){if(void 0===e)return this.error_||null;if(this.options_.suppressNotSupportedError&&e&&e.message&&e.message===this.localize(this.options_.notSupportedMessage)){var t=function(){this.error(e)};return this.options_.suppressNotSupportedError=!1,this.any(["click","touchstart"],t),void this.one("loadstart",function(){this.off(["click","touchstart"],t)})}if(null===e)return this.error_=e,this.removeClass("vjs-error"),void(this.errorDisplay&&this.errorDisplay.close());this.error_=new bt(e),this.addClass("vjs-error"),c.error("(CODE:"+this.error_.code+" "+bt.errorTypes[this.error_.code]+")",this.error_.message,this.error_),this.trigger("error")},s.reportUserActivity=function(e){this.userActivity_=!0},s.userActive=function(e){if(void 0===e)return this.userActive_;if((e=!!e)!==this.userActive_){if(this.userActive_=e,this.userActive_)return this.userActivity_=!0,this.removeClass("vjs-user-inactive"),this.addClass("vjs-user-active"),void this.trigger("useractive");this.tech_&&this.tech_.one("mousemove",function(e){e.stopPropagation(),e.preventDefault()}),this.userActivity_=!1,this.removeClass("vjs-user-active"),this.addClass("vjs-user-inactive"),this.trigger("userinactive")}},s.listenForUserActivity_=function(){var e,t,n,i=Ee(this,this.reportUserActivity);this.on("mousedown",function(){i(),this.clearInterval(e),e=this.setInterval(i,250)}),this.on("mousemove",function(e){e.screenX===t&&e.screenY===n||(t=e.screenX,n=e.screenY,i())}),this.on("mouseup",function(t){i(),this.clearInterval(e)});var r,a=this.getChild("controlBar");!a||Ge||Ye||(a.on("mouseenter",function(e){this.player().cache_.inactivityTimeout=this.player().options_.inactivityTimeout,this.player().options_.inactivityTimeout=0}),a.on("mouseleave",function(e){this.player().options_.inactivityTimeout=this.player().cache_.inactivityTimeout})),this.on("keydown",i),this.on("keyup",i),this.setInterval(function(){if(this.userActivity_){this.userActivity_=!1,this.userActive(!0),this.clearTimeout(r);var e=this.options_.inactivityTimeout;e<=0||(r=this.setTimeout(function(){this.userActivity_||this.userActive(!1)},e))}},250)},s.playbackRate=function(e){if(void 0===e)return this.tech_&&this.tech_.featuresPlaybackRate?this.cache_.lastPlaybackRate||this.techGet_("playbackRate"):1;this.techCall_("setPlaybackRate",e)},s.defaultPlaybackRate=function(e){return void 0!==e?this.techCall_("setDefaultPlaybackRate",e):this.tech_&&this.tech_.featuresPlaybackRate?this.techGet_("defaultPlaybackRate"):1},s.isAudio=function(e){if(void 0===e)return!!this.isAudio_;this.isAudio_=!!e},s.addTextTrack=function(e,t,n){if(this.tech_)return this.tech_.addTextTrack(e,t,n)},s.addRemoteTextTrack=function(e,t){if(this.tech_)return this.tech_.addRemoteTextTrack(e,t)},s.removeRemoteTextTrack=function(e){void 0===e&&(e={});var t=e.track;if(t||(t=e),this.tech_)return this.tech_.removeRemoteTextTrack(t)},s.getVideoPlaybackQuality=function(){return this.techGet_("getVideoPlaybackQuality")},s.videoWidth=function(){return this.tech_&&this.tech_.videoWidth&&this.tech_.videoWidth()||0},s.videoHeight=function(){return this.tech_&&this.tech_.videoHeight&&this.tech_.videoHeight()||0},s.language=function(e){if(void 0===e)return this.language_;this.language_=String(e).toLowerCase()},s.languages=function(){return je(a.prototype.options_.languages,this.languages_)},s.toJSON=function(){var e=je(this.options_),t=e.tracks;e.tracks=[];for(var n=0;n<t.length;n++){var i=t[n];(i=je(i)).player=void 0,e.tracks[n]=i}return e},s.createModal=function(e,t){var n=this;(t=t||{}).content=e||"";var i=new Dt(this,t);return this.addChild(i),i.on("dispose",function(){n.removeChild(i)}),i.open(),i},s.updateCurrentBreakpoint_=function(){if(this.responsive())for(var e=this.currentBreakpoint(),t=this.currentWidth(),n=0;n<Ua.length;n++){var i=Ua[n];if(t<=this.breakpoints_[i]){if(e===i)return;e&&this.removeClass(Va[e]),this.addClass(Va[i]),this.breakpoint_=i;break}}},s.removeCurrentBreakpoint_=function(){var e=this.currentBreakpointClass();this.breakpoint_="",e&&this.removeClass(e)},s.breakpoints=function(e){return void 0===e?v(this.breakpoints_):(this.breakpoint_="",this.breakpoints_=v({},qa,e),this.updateCurrentBreakpoint_(),v(this.breakpoints_))},s.responsive=function(e){return void 0===e?this.responsive_:(e=Boolean(e))!==this.responsive_?(this.responsive_=e,e?(this.on("playerresize",this.updateCurrentBreakpoint_),this.updateCurrentBreakpoint_()):(this.off("playerresize",this.updateCurrentBreakpoint_),this.removeCurrentBreakpoint_()),e):void 0},s.currentBreakpoint=function(){return this.breakpoint_},s.currentBreakpointClass=function(){return Va[this.breakpoint_]||""},s.loadMedia=function(e,t){var n=this;if(e&&"object"==typeof e){this.reset(),this.cache_.media=je(e);var i=this.cache_.media,r=i.artwork,a=i.poster,o=i.src,s=i.textTracks;!r&&a&&(this.cache_.media.artwork=[{src:a,type:ir(a)}]),o&&this.src(o),a&&this.poster(a),Array.isArray(s)&&s.forEach(function(e){return n.addRemoteTextTrack(e,!1)}),this.ready(t)}},s.getMedia=function(){if(!this.cache_.media){var e=this.poster(),t={src:this.currentSources(),textTracks:Array.prototype.map.call(this.remoteTextTracks(),function(e){return{kind:e.kind,label:e.label,language:e.language,src:e.src}})};return e&&(t.poster=e,t.artwork=[{src:t.poster,type:ir(t.poster)}]),t}return je(this.cache_.media)},a.getTagSettings=function(e){var t={sources:[],tracks:[]},n=M(e),i=n["data-setup"];if(x(e,"vjs-fill")&&(n.fill=!0),x(e,"vjs-fluid")&&(n.fluid=!0),null!==i){var r=function(e,t){var n,i=null;try{n=JSON.parse(e,t)}catch(e){i=e}return[i,n]}(i||"{}"),a=r[0],o=r[1];a&&c.error(a),v(n,o)}if(v(t,n),e.hasChildNodes())for(var s=e.childNodes,l=0,u=s.length;l<u;l++){var d=s[l],h=d.nodeName.toLowerCase();"source"===h?t.sources.push(M(d)):"track"===h&&t.tracks.push(M(d))}return t},s.flexNotSupported_=function(){var e=t.createElement("i");return!("flexBasis"in e.style||"webkitFlexBasis"in e.style||"mozFlexBasis"in e.style||"msFlexBasis"in e.style||"msFlexOrder"in e.style)},a}(Be);vi.names.forEach(function(e){var t=vi[e];Ha.prototype[t.getterName]=function(){return this.tech_?this.tech_[t.getterName]():(this[t.privateName]=this[t.privateName]||new t.ListClass,this[t.privateName])}}),Ha.players={};var za=e.navigator;Ha.prototype.options_={techOrder:Wi.defaultTechOrder_,html5:{},flash:{},inactivityTimeout:2e3,playbackRates:[],liveui:!1,children:["mediaLoader","posterImage","textTrackDisplay","loadingSpinner","bigPlayButton","liveTracker","controlBar","errorDisplay","textTrackSettings","resizeManager"],language:za&&(za.languages&&za.languages[0]||za.userLanguage||za.language)||"en",languages:{},notSupportedMessage:"No compatible source was found for this media.",fullscreen:{options:{navigationUI:"hide"}},breakpoints:{},responsive:!1},["ended","seeking","seekable","networkState","readyState"].forEach(function(e){Ha.prototype[e]=function(){return this.techGet_(e)}}),Ba.forEach(function(e){Ha.prototype["handleTech"+$e(e)+"_"]=function(){return this.trigger(e)}}),Be.registerComponent("Player",Ha);var Wa={},Ga=function(e){return Wa.hasOwnProperty(e)},Xa=function(e){return Ga(e)?Wa[e]:void 0},Ya=function(e,t){e.activePlugins_=e.activePlugins_||{},e.activePlugins_[t]=!0},Qa=function(e,t,n){var i=(n?"before":"")+"pluginsetup";e.trigger(i,t),e.trigger(i+":"+t.name,t)},Ja=function(e,t){return t.prototype.name=e,function(){Qa(this,{name:e,plugin:t,instance:null},!0);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];var o=a(t,[this].concat(i));return this[e]=function(){return o},Qa(this,o.getEventHash()),o}},Za=function(){function e(t){if(this.constructor===e)throw new Error("Plugin must be sub-classed; not directly instantiated.");this.player=t,Le(this),delete this.trigger,Me(this,this.constructor.defaultState),Ya(t,this.name),this.dispose=Ee(this,this.dispose),t.on("dispose",this.dispose)}var t=e.prototype;return t.version=function(){return this.constructor.VERSION},t.getEventHash=function(e){return void 0===e&&(e={}),e.name=this.name,e.plugin=this.constructor,e.instance=this,e},t.trigger=function(e,t){return void 0===t&&(t={}),ce(this.eventBusEl_,e,this.getEventHash(t))},t.handleStateChanged=function(e){},t.dispose=function(){var e=this.name,t=this.player;this.trigger("dispose"),this.off(),t.off("dispose",this.dispose),t.activePlugins_[e]=!1,this.player=this.state=null,t[e]=Ja(e,Wa[e])},e.isBasic=function(t){var n="string"==typeof t?Xa(t):t;return"function"==typeof n&&!e.prototype.isPrototypeOf(n.prototype)},e.registerPlugin=function(t,n){if("string"!=typeof t)throw new Error('Illegal plugin name, "'+t+'", must be a string, was '+typeof t+".");if(Ga(t))c.warn('A plugin named "'+t+'" already exists. You may want to avoid re-registering plugins!');else if(Ha.prototype.hasOwnProperty(t))throw new Error('Illegal plugin name, "'+t+'", cannot share a name with an existing player method!');if("function"!=typeof n)throw new Error('Illegal plugin for "'+t+'", must be a function, was '+typeof n+".");return Wa[t]=n,"plugin"!==t&&(e.isBasic(n)?Ha.prototype[t]=function(e,t){var n=function(){Qa(this,{name:e,plugin:t,instance:null},!0);var n=t.apply(this,arguments);return Ya(this,e),Qa(this,{name:e,plugin:t,instance:n}),n};return Object.keys(t).forEach(function(e){n[e]=t[e]}),n}(t,n):Ha.prototype[t]=Ja(t,n)),n},e.deregisterPlugin=function(e){if("plugin"===e)throw new Error("Cannot de-register base plugin.");Ga(e)&&(delete Wa[e],delete Ha.prototype[e])},e.getPlugins=function(e){var t;return void 0===e&&(e=Object.keys(Wa)),e.forEach(function(e){var n=Xa(e);n&&((t=t||{})[e]=n)}),t},e.getPluginVersion=function(e){var t=Xa(e);return t&&t.VERSION||""},e}();Za.getPlugin=Xa,Za.BASE_PLUGIN_NAME="plugin",Za.registerPlugin("plugin",Za),Ha.prototype.usingPlugin=function(e){return!!this.activePlugins_&&!0===this.activePlugins_[e]},Ha.prototype.hasPlugin=function(e){return!!Ga(e)};var eo=function(e){return 0===e.indexOf("#")?e.slice(1):e};function to(e,t,n){var i=to.getPlayer(e);if(i)return t&&c.warn('Player "'+e+'" is already initialised. Options will not be applied.'),n&&i.ready(n),i;var r="string"==typeof e?Q("#"+eo(e)):e;if(!k(r))throw new TypeError("The element or ID supplied is not valid. (videojs)");r.ownerDocument.defaultView&&r.ownerDocument.body.contains(r)||c.warn("The element supplied is not included in the DOM"),t=t||{},to.hooks("beforesetup").forEach(function(e){var n=e(r,je(t));y(n)&&!Array.isArray(n)?t=je(t,n):c.error("please return an object in beforesetup hooks")});var a=Be.getComponent("Player");return i=new a(r,t,n),to.hooks("setup").forEach(function(e){return e(i)}),i}if(to.hooks_={},to.hooks=function(e,t){return to.hooks_[e]=to.hooks_[e]||[],t&&(to.hooks_[e]=to.hooks_[e].concat(t)),to.hooks_[e]},to.hook=function(e,t){to.hooks(e,t)},to.hookOnce=function(e,t){to.hooks(e,[].concat(t).map(function(t){return function n(){return to.removeHook(e,n),t.apply(void 0,arguments)}}))},to.removeHook=function(e,t){var n=to.hooks(e).indexOf(t);return!(n<=-1||(to.hooks_[e]=to.hooks_[e].slice(),to.hooks_[e].splice(n,1),0))},!0!==e.VIDEOJS_NO_DYNAMIC_STYLE&&w()){var no=Q(".vjs-styles-defaults");if(!no){no=be("vjs-styles-defaults");var io=Q("head");io&&io.insertBefore(no,io.firstChild),_e(no,"\n      .video-js {\n        width: 300px;\n        height: 150px;\n      }\n\n      .vjs-fluid {\n        padding-top: 56.25%\n      }\n    ")}}ve(1,to),to.VERSION=n,to.options=Ha.prototype.options_,to.getPlayers=function(){return Ha.players},to.getPlayer=function(e){var t,n=Ha.players;if("string"==typeof e){var i=eo(e),r=n[i];if(r)return r;t=Q("#"+i)}else t=e;if(k(t)){var a=t,o=a.player,s=a.playerId;if(o||n[s])return o||n[s]}},to.getAllPlayers=function(){return Object.keys(Ha.players).map(function(e){return Ha.players[e]}).filter(Boolean)},to.players=Ha.players,to.getComponent=Be.getComponent,to.registerComponent=function(e,t){Wi.isTech(t)&&c.warn("The "+e+" tech was registered as a component. It should instead be registered using videojs.registerTech(name, tech)"),Be.registerComponent.call(Be,e,t)},to.getTech=Wi.getTech,to.registerTech=Wi.registerTech,to.use=function(e,t){Gi[e]=Gi[e]||[],Gi[e].push(t)},Object.defineProperty(to,"middleware",{value:{},writeable:!1,enumerable:!0}),Object.defineProperty(to.middleware,"TERMINATOR",{value:Yi,writeable:!1,enumerable:!0}),to.browser=lt,to.TOUCH_ENABLED=st,to.extend=function(e,t){void 0===t&&(t={});var n=function(){e.apply(this,arguments)},i={};for(var r in"object"==typeof t?(t.constructor!==Object.prototype.constructor&&(n=t.constructor),i=t):"function"==typeof t&&(n=t),function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(e.super_=t)}(n,e),i)i.hasOwnProperty(r)&&(n.prototype[r]=i[r]);return n},to.mergeOptions=je,to.bind=Ee,to.registerPlugin=Za.registerPlugin,to.deregisterPlugin=Za.deregisterPlugin,to.plugin=function(e,t){return c.warn("videojs.plugin() is deprecated; use videojs.registerPlugin() instead"),Za.registerPlugin(e,t)},to.getPlugins=Za.getPlugins,to.getPlugin=Za.getPlugin,to.getPluginVersion=Za.getPluginVersion,to.addLanguage=function(e,t){var n;return e=(""+e).toLowerCase(),to.options.languages=je(to.options.languages,((n={})[e]=t,n)),to.options.languages[e]},to.log=c,to.createLogger=d,to.createTimeRange=to.createTimeRanges=dt,to.formatTime=br,to.setFormatTime=function(e){yr=e},to.resetFormatTime=function(){yr=vr},to.parseUrl=Ht,to.isCrossOrigin=Gt,to.EventTarget=ke,to.on=le,to.one=de,to.off=ue,to.trigger=ce,to.xhr=ii,to.TextTrack=ui,to.AudioTrack=ci,to.VideoTrack=di,["isEl","isTextNode","createEl","hasClass","addClass","removeClass","toggleClass","setAttributes","getAttributes","emptyEl","appendContent","insertContent"].forEach(function(e){to[e]=function(){return c.warn("videojs."+e+"() is deprecated; use videojs.dom."+e+"() instead"),Z[e].apply(null,arguments)}}),to.computedStyle=_,to.dom=Z,to.url=Xt;var ro=St(function(e,t){var n,i,r,a,o;n=/^((?:[a-zA-Z0-9+\-.]+:)?)(\/\/[^\/?#]*)?((?:[^\/\?#]*\/)*.*?)??(;.*?)?(\?.*?)?(#.*?)?$/,i=/^([^\/?#]*)(.*)$/,r=/(?:\/|^)\.(?=\/)/g,a=/(?:\/|^)\.\.\/(?!\.\.\/).*?(?=\/)/g,o={buildAbsoluteURL:function(e,t,n){if(n=n||{},e=e.trim(),!(t=t.trim())){if(!n.alwaysNormalize)return e;var r=o.parseURL(e);if(!r)throw new Error("Error trying to parse base URL.");return r.path=o.normalizePath(r.path),o.buildURLFromParts(r)}var a=o.parseURL(t);if(!a)throw new Error("Error trying to parse relative URL.");if(a.scheme)return n.alwaysNormalize?(a.path=o.normalizePath(a.path),o.buildURLFromParts(a)):t;var s=o.parseURL(e);if(!s)throw new Error("Error trying to parse base URL.");if(!s.netLoc&&s.path&&"/"!==s.path[0]){var l=i.exec(s.path);s.netLoc=l[1],s.path=l[2]}s.netLoc&&!s.path&&(s.path="/");var u={scheme:s.scheme,netLoc:a.netLoc,path:null,params:a.params,query:a.query,fragment:a.fragment};if(!a.netLoc&&(u.netLoc=s.netLoc,"/"!==a.path[0]))if(a.path){var c=s.path,d=c.substring(0,c.lastIndexOf("/")+1)+a.path;u.path=o.normalizePath(d)}else u.path=s.path,a.params||(u.params=s.params,a.query||(u.query=s.query));return null===u.path&&(u.path=n.alwaysNormalize?o.normalizePath(a.path):a.path),o.buildURLFromParts(u)},parseURL:function(e){var t=n.exec(e);return t?{scheme:t[1]||"",netLoc:t[2]||"",path:t[3]||"",params:t[4]||"",query:t[5]||"",fragment:t[6]||""}:null},normalizePath:function(e){for(e=e.split("").reverse().join("").replace(r,"");e.length!==(e=e.replace(a,"")).length;);return e.split("").reverse().join("")},buildURLFromParts:function(e){return e.scheme+e.netLoc+e.path+e.params+e.query+e.fragment}},e.exports=o});
/*! @name m3u8-parser @version 4.3.0 @license Apache-2.0 */function ao(){return(ao=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e}).apply(this,arguments)}function oo(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e.__proto__=t}function so(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var lo,uo,co,ho,po,fo,go,mo,vo,yo,bo,_o,To,Eo,Co,wo,ko,So,Io,Oo,Do,Ro,xo,Ao,Po,Lo,No,Mo,Ko,$o,jo,Bo,Fo,Uo,Vo,qo,Ho,zo,Wo,Go,Xo,Yo,Qo,Jo,Zo,es=function(){function e(){this.listeners={}}var t=e.prototype;return t.on=function(e,t){this.listeners[e]||(this.listeners[e]=[]),this.listeners[e].push(t)},t.off=function(e,t){if(!this.listeners[e])return!1;var n=this.listeners[e].indexOf(t);return this.listeners[e].splice(n,1),n>-1},t.trigger=function(e){var t,n,i,r=this.listeners[e];if(r)if(2===arguments.length)for(n=r.length,t=0;t<n;++t)r[t].call(this,arguments[1]);else for(i=Array.prototype.slice.call(arguments,1),n=r.length,t=0;t<n;++t)r[t].apply(this,i)},t.dispose=function(){this.listeners={}},t.pipe=function(e){this.on("data",function(t){e.push(t)})},e}(),ts=function(e){function t(){var t;return(t=e.call(this)||this).buffer="",t}return oo(t,e),t.prototype.push=function(e){var t;for(this.buffer+=e,t=this.buffer.indexOf("\n");t>-1;t=this.buffer.indexOf("\n"))this.trigger("data",this.buffer.substring(0,t)),this.buffer=this.buffer.substring(t+1)},t}(es),ns=function(e){for(var t,n=e.split(new RegExp('(?:^|,)((?:[^=]*)=(?:"[^"]*"|[^,]*))')),i={},r=n.length;r--;)""!==n[r]&&((t=/([^=]*)=(.*)/.exec(n[r]).slice(1))[0]=t[0].replace(/^\s+|\s+$/g,""),t[1]=t[1].replace(/^\s+|\s+$/g,""),t[1]=t[1].replace(/^['"](.*)['"]$/g,"$1"),i[t[0]]=t[1]);return i},is=function(e){function t(){var t;return(t=e.call(this)||this).customParsers=[],t.tagMappers=[],t}oo(t,e);var n=t.prototype;return n.push=function(e){var t,n,i=this;if(0!==(e=e.trim()).length)if("#"===e[0]){this.tagMappers.reduce(function(t,n){var i=n(e);return i===e?t:t.concat([i])},[e]).forEach(function(e){for(var r=0;r<i.customParsers.length;r++)if(i.customParsers[r].call(i,e))return;if(0===e.indexOf("#EXT"))if(e=e.replace("\r",""),t=/^#EXTM3U/.exec(e))i.trigger("data",{type:"tag",tagType:"m3u"});else{if(t=/^#EXTINF:?([0-9\.]*)?,?(.*)?$/.exec(e))return n={type:"tag",tagType:"inf"},t[1]&&(n.duration=parseFloat(t[1])),t[2]&&(n.title=t[2]),void i.trigger("data",n);if(t=/^#EXT-X-TARGETDURATION:?([0-9.]*)?/.exec(e))return n={type:"tag",tagType:"targetduration"},t[1]&&(n.duration=parseInt(t[1],10)),void i.trigger("data",n);if(t=/^#ZEN-TOTAL-DURATION:?([0-9.]*)?/.exec(e))return n={type:"tag",tagType:"totalduration"},t[1]&&(n.duration=parseInt(t[1],10)),void i.trigger("data",n);if(t=/^#EXT-X-VERSION:?([0-9.]*)?/.exec(e))return n={type:"tag",tagType:"version"},t[1]&&(n.version=parseInt(t[1],10)),void i.trigger("data",n);if(t=/^#EXT-X-MEDIA-SEQUENCE:?(\-?[0-9.]*)?/.exec(e))return n={type:"tag",tagType:"media-sequence"},t[1]&&(n.number=parseInt(t[1],10)),void i.trigger("data",n);if(t=/^#EXT-X-DISCONTINUITY-SEQUENCE:?(\-?[0-9.]*)?/.exec(e))return n={type:"tag",tagType:"discontinuity-sequence"},t[1]&&(n.number=parseInt(t[1],10)),void i.trigger("data",n);if(t=/^#EXT-X-PLAYLIST-TYPE:?(.*)?$/.exec(e))return n={type:"tag",tagType:"playlist-type"},t[1]&&(n.playlistType=t[1]),void i.trigger("data",n);if(t=/^#EXT-X-BYTERANGE:?([0-9.]*)?@?([0-9.]*)?/.exec(e))return n={type:"tag",tagType:"byterange"},t[1]&&(n.length=parseInt(t[1],10)),t[2]&&(n.offset=parseInt(t[2],10)),void i.trigger("data",n);if(t=/^#EXT-X-ALLOW-CACHE:?(YES|NO)?/.exec(e))return n={type:"tag",tagType:"allow-cache"},t[1]&&(n.allowed=!/NO/.test(t[1])),void i.trigger("data",n);if(t=/^#EXT-X-MAP:?(.*)$/.exec(e)){if(n={type:"tag",tagType:"map"},t[1]){var a=ns(t[1]);if(a.URI&&(n.uri=a.URI),a.BYTERANGE){var o=a.BYTERANGE.split("@"),s=o[0],l=o[1];n.byterange={},s&&(n.byterange.length=parseInt(s,10)),l&&(n.byterange.offset=parseInt(l,10))}}i.trigger("data",n)}else if(t=/^#EXT-X-STREAM-INF:?(.*)$/.exec(e)){if(n={type:"tag",tagType:"stream-inf"},t[1]){if(n.attributes=ns(t[1]),n.attributes.RESOLUTION){var u=n.attributes.RESOLUTION.split("x"),c={};u[0]&&(c.width=parseInt(u[0],10)),u[1]&&(c.height=parseInt(u[1],10)),n.attributes.RESOLUTION=c}n.attributes.BANDWIDTH&&(n.attributes.BANDWIDTH=parseInt(n.attributes.BANDWIDTH,10)),n.attributes["PROGRAM-ID"]&&(n.attributes["PROGRAM-ID"]=parseInt(n.attributes["PROGRAM-ID"],10))}i.trigger("data",n)}else{if(t=/^#EXT-X-MEDIA:?(.*)$/.exec(e))return n={type:"tag",tagType:"media"},t[1]&&(n.attributes=ns(t[1])),void i.trigger("data",n);if(t=/^#EXT-X-ENDLIST/.exec(e))i.trigger("data",{type:"tag",tagType:"endlist"});else if(t=/^#EXT-X-DISCONTINUITY/.exec(e))i.trigger("data",{type:"tag",tagType:"discontinuity"});else{if(t=/^#EXT-X-PROGRAM-DATE-TIME:?(.*)$/.exec(e))return n={type:"tag",tagType:"program-date-time"},t[1]&&(n.dateTimeString=t[1],n.dateTimeObject=new Date(t[1])),void i.trigger("data",n);if(t=/^#EXT-X-KEY:?(.*)$/.exec(e))return n={type:"tag",tagType:"key"},t[1]&&(n.attributes=ns(t[1]),n.attributes.IV&&("0x"===n.attributes.IV.substring(0,2).toLowerCase()&&(n.attributes.IV=n.attributes.IV.substring(2)),n.attributes.IV=n.attributes.IV.match(/.{8}/g),n.attributes.IV[0]=parseInt(n.attributes.IV[0],16),n.attributes.IV[1]=parseInt(n.attributes.IV[1],16),n.attributes.IV[2]=parseInt(n.attributes.IV[2],16),n.attributes.IV[3]=parseInt(n.attributes.IV[3],16),n.attributes.IV=new Uint32Array(n.attributes.IV))),void i.trigger("data",n);if(t=/^#EXT-X-START:?(.*)$/.exec(e))return n={type:"tag",tagType:"start"},t[1]&&(n.attributes=ns(t[1]),n.attributes["TIME-OFFSET"]=parseFloat(n.attributes["TIME-OFFSET"]),n.attributes.PRECISE=/YES/.test(n.attributes.PRECISE)),void i.trigger("data",n);if(t=/^#EXT-X-CUE-OUT-CONT:?(.*)?$/.exec(e))return n={type:"tag",tagType:"cue-out-cont"},t[1]?n.data=t[1]:n.data="",void i.trigger("data",n);if(t=/^#EXT-X-CUE-OUT:?(.*)?$/.exec(e))return n={type:"tag",tagType:"cue-out"},t[1]?n.data=t[1]:n.data="",void i.trigger("data",n);if(t=/^#EXT-X-CUE-IN:?(.*)?$/.exec(e))return n={type:"tag",tagType:"cue-in"},t[1]?n.data=t[1]:n.data="",void i.trigger("data",n);i.trigger("data",{type:"tag",data:e.slice(4)})}}}else i.trigger("data",{type:"comment",text:e.slice(1)})})}else this.trigger("data",{type:"uri",uri:e})},n.addParser=function(e){var t=this,n=e.expression,i=e.customType,r=e.dataParser,a=e.segment;"function"!=typeof r&&(r=function(e){return e}),this.customParsers.push(function(e){if(n.exec(e))return t.trigger("data",{type:"custom",data:r(e),customType:i,segment:a}),!0})},n.addTagMapper=function(e){var t=e.expression,n=e.map;this.tagMappers.push(function(e){return t.test(e)?n(e):e})},t}(es),rs=function(e){function t(){var t;(t=e.call(this)||this).lineStream=new ts,t.parseStream=new is,t.lineStream.pipe(t.parseStream);var n,i,r=so(so(t)),a=[],o={},s={AUDIO:{},VIDEO:{},"CLOSED-CAPTIONS":{},SUBTITLES:{}},l=0;return t.manifest={allowCache:!0,discontinuityStarts:[],segments:[]},t.parseStream.on("data",function(e){var t,u;({tag:function(){(({"allow-cache":function(){this.manifest.allowCache=e.allowed,"allowed"in e||(this.trigger("info",{message:"defaulting allowCache to YES"}),this.manifest.allowCache=!0)},byterange:function(){var t={};"length"in e&&(o.byterange=t,t.length=e.length,"offset"in e||(this.trigger("info",{message:"defaulting offset to zero"}),e.offset=0)),"offset"in e&&(o.byterange=t,t.offset=e.offset)},endlist:function(){this.manifest.endList=!0},inf:function(){"mediaSequence"in this.manifest||(this.manifest.mediaSequence=0,this.trigger("info",{message:"defaulting media sequence to zero"})),"discontinuitySequence"in this.manifest||(this.manifest.discontinuitySequence=0,this.trigger("info",{message:"defaulting discontinuity sequence to zero"})),e.duration>0&&(o.duration=e.duration),0===e.duration&&(o.duration=.01,this.trigger("info",{message:"updating zero segment duration to a small value"})),this.manifest.segments=a},key:function(){e.attributes?"NONE"!==e.attributes.METHOD?e.attributes.URI?(e.attributes.METHOD||this.trigger("warn",{message:"defaulting key method to AES-128"}),i={method:e.attributes.METHOD||"AES-128",uri:e.attributes.URI},void 0!==e.attributes.IV&&(i.iv=e.attributes.IV)):this.trigger("warn",{message:"ignoring key declaration without URI"}):i=null:this.trigger("warn",{message:"ignoring key declaration without attribute list"})},"media-sequence":function(){isFinite(e.number)?this.manifest.mediaSequence=e.number:this.trigger("warn",{message:"ignoring invalid media sequence: "+e.number})},"discontinuity-sequence":function(){isFinite(e.number)?(this.manifest.discontinuitySequence=e.number,l=e.number):this.trigger("warn",{message:"ignoring invalid discontinuity sequence: "+e.number})},"playlist-type":function(){/VOD|EVENT/.test(e.playlistType)?this.manifest.playlistType=e.playlistType:this.trigger("warn",{message:"ignoring unknown playlist type: "+e.playlist})},map:function(){n={},e.uri&&(n.uri=e.uri),e.byterange&&(n.byterange=e.byterange)},"stream-inf":function(){this.manifest.playlists=a,this.manifest.mediaGroups=this.manifest.mediaGroups||s,e.attributes?(o.attributes||(o.attributes={}),ao(o.attributes,e.attributes)):this.trigger("warn",{message:"ignoring empty stream-inf attributes"})},media:function(){if(this.manifest.mediaGroups=this.manifest.mediaGroups||s,e.attributes&&e.attributes.TYPE&&e.attributes["GROUP-ID"]&&e.attributes.NAME){var n=this.manifest.mediaGroups[e.attributes.TYPE];n[e.attributes["GROUP-ID"]]=n[e.attributes["GROUP-ID"]]||{},t=n[e.attributes["GROUP-ID"]],(u={default:/yes/i.test(e.attributes.DEFAULT)}).default?u.autoselect=!0:u.autoselect=/yes/i.test(e.attributes.AUTOSELECT),e.attributes.LANGUAGE&&(u.language=e.attributes.LANGUAGE),e.attributes.URI&&(u.uri=e.attributes.URI),e.attributes["INSTREAM-ID"]&&(u.instreamId=e.attributes["INSTREAM-ID"]),e.attributes.CHARACTERISTICS&&(u.characteristics=e.attributes.CHARACTERISTICS),e.attributes.FORCED&&(u.forced=/yes/i.test(e.attributes.FORCED)),t[e.attributes.NAME]=u}else this.trigger("warn",{message:"ignoring incomplete or missing media group"})},discontinuity:function(){l+=1,o.discontinuity=!0,this.manifest.discontinuityStarts.push(a.length)},"program-date-time":function(){void 0===this.manifest.dateTimeString&&(this.manifest.dateTimeString=e.dateTimeString,this.manifest.dateTimeObject=e.dateTimeObject),o.dateTimeString=e.dateTimeString,o.dateTimeObject=e.dateTimeObject},targetduration:function(){!isFinite(e.duration)||e.duration<0?this.trigger("warn",{message:"ignoring invalid target duration: "+e.duration}):this.manifest.targetDuration=e.duration},totalduration:function(){!isFinite(e.duration)||e.duration<0?this.trigger("warn",{message:"ignoring invalid total duration: "+e.duration}):this.manifest.totalDuration=e.duration},start:function(){e.attributes&&!isNaN(e.attributes["TIME-OFFSET"])?this.manifest.start={timeOffset:e.attributes["TIME-OFFSET"],precise:e.attributes.PRECISE}:this.trigger("warn",{message:"ignoring start declaration without appropriate attribute list"})},"cue-out":function(){o.cueOut=e.data},"cue-out-cont":function(){o.cueOutCont=e.data},"cue-in":function(){o.cueIn=e.data}})[e.tagType]||function(){}).call(r)},uri:function(){o.uri=e.uri,a.push(o),!this.manifest.targetDuration||"duration"in o||(this.trigger("warn",{message:"defaulting segment duration to the target duration"}),o.duration=this.manifest.targetDuration),i&&(o.key=i),o.timeline=l,n&&(o.map=n),o={}},comment:function(){},custom:function(){e.segment?(o.custom=o.custom||{},o.custom[e.customType]=e.data):(this.manifest.custom=this.manifest.custom||{},this.manifest.custom[e.customType]=e.data)}})[e.type].call(r)}),t}oo(t,e);var n=t.prototype;return n.push=function(e){this.lineStream.push(e)},n.end=function(){this.lineStream.push("\n")},n.addParser=function(e){this.parseStream.addParser(e)},n.addTagMapper=function(e){this.parseStream.addTagMapper(e)},t}(es),as=function(e){return!!e&&"object"==typeof e},os=function e(){for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];return n.reduce(function(t,n){return Object.keys(n).forEach(function(i){Array.isArray(t[i])&&Array.isArray(n[i])?t[i]=t[i].concat(n[i]):as(t[i])&&as(n[i])?t[i]=e(t[i],n[i]):t[i]=n[i]}),t},{})},ss=function(e){return e.reduce(function(e,t){return e.concat(t)},[])},ls=function(e){if(!e.length)return[];for(var t=[],n=0;n<e.length;n++)t.push(e[n]);return t},us="INVALID_NUMBER_OF_PERIOD",cs="DASH_EMPTY_MANIFEST",ds="DASH_INVALID_XML",hs="NO_BASE_URL",ps="SEGMENT_TIME_UNSPECIFIED",fs="UNSUPPORTED_UTC_TIMING_SCHEME",gs=(function(e,t){var n,i,r,a,o;n=/^((?:[a-zA-Z0-9+\-.]+:)?)(\/\/[^\/?#]*)?((?:[^\/\?#]*\/)*.*?)??(;.*?)?(\?.*?)?(#.*?)?$/,i=/^([^\/?#]*)(.*)$/,r=/(?:\/|^)\.(?=\/)/g,a=/(?:\/|^)\.\.\/(?!\.\.\/).*?(?=\/)/g,o={buildAbsoluteURL:function(e,t,n){if(n=n||{},e=e.trim(),!(t=t.trim())){if(!n.alwaysNormalize)return e;var r=o.parseURL(e);if(!r)throw new Error("Error trying to parse base URL.");return r.path=o.normalizePath(r.path),o.buildURLFromParts(r)}var a=o.parseURL(t);if(!a)throw new Error("Error trying to parse relative URL.");if(a.scheme)return n.alwaysNormalize?(a.path=o.normalizePath(a.path),o.buildURLFromParts(a)):t;var s=o.parseURL(e);if(!s)throw new Error("Error trying to parse base URL.");if(!s.netLoc&&s.path&&"/"!==s.path[0]){var l=i.exec(s.path);s.netLoc=l[1],s.path=l[2]}s.netLoc&&!s.path&&(s.path="/");var u={scheme:s.scheme,netLoc:a.netLoc,path:null,params:a.params,query:a.query,fragment:a.fragment};if(!a.netLoc&&(u.netLoc=s.netLoc,"/"!==a.path[0]))if(a.path){var c=s.path,d=c.substring(0,c.lastIndexOf("/")+1)+a.path;u.path=o.normalizePath(d)}else u.path=s.path,a.params||(u.params=s.params,a.query||(u.query=s.query));return null===u.path&&(u.path=n.alwaysNormalize?o.normalizePath(a.path):a.path),o.buildURLFromParts(u)},parseURL:function(e){var t=n.exec(e);return t?{scheme:t[1]||"",netLoc:t[2]||"",path:t[3]||"",params:t[4]||"",query:t[5]||"",fragment:t[6]||""}:null},normalizePath:function(e){for(e=e.split("").reverse().join("").replace(r,"");e.length!==(e=e.replace(a,"")).length;);return e.split("").reverse().join("")},buildURLFromParts:function(e){return e.scheme+e.netLoc+e.path+e.params+e.query+e.fragment}},e.exports=o}(lo={exports:{}}),lo.exports),ms=function(t,n){return/^[a-z]+:/i.test(n)?n:(/\/\//i.test(t)||(t=gs.buildAbsoluteURL(e.location.href,t)),gs.buildAbsoluteURL(t,n))},vs=function(e){var t=e.baseUrl,n=void 0===t?"":t,i=e.source,r=void 0===i?"":i,a=e.range,o=void 0===a?"":a,s=e.indexRange,l=void 0===s?"":s,u={uri:r,resolvedUri:ms(n||"",r)};if(o||l){var c=(o||l).split("-"),d=parseInt(c[0],10),h=parseInt(c[1],10);u.byterange={length:h-d+1,offset:d}}return u},ys={static:function(e){var t=e.duration,n=e.timescale,i=void 0===n?1:n,r=e.sourceDuration;return{start:0,end:Math.ceil(r/(t/i))}},dynamic:function(e){var t=e.NOW,n=e.clientOffset,i=e.availabilityStartTime,r=e.timescale,a=void 0===r?1:r,o=e.duration,s=e.start,l=void 0===s?0:s,u=e.minimumUpdatePeriod,c=void 0===u?0:u,d=e.timeShiftBufferDepth,h=void 0===d?1/0:d,p=(t+n)/1e3,f=i+l,g=p+c-f,m=Math.ceil(g*a/o),v=Math.floor((p-f-h)*a/o),y=Math.floor((p-f)*a/o);return{start:Math.max(0,v),end:Math.min(m,y)}}},bs=function(e){var t=e.type,n=void 0===t?"static":t,i=e.duration,r=e.timescale,a=void 0===r?1:r,o=e.sourceDuration,s=ys[n](e),l=s.start,u=function(e,t){for(var n=[],i=l;i<t;i++)n.push(i);return n}(0,s.end).map(function(e){return function(t,n){var i=e.duration,r=e.timescale,a=void 0===r?1:r,o=e.periodIndex,s=e.startNumber;return{number:(void 0===s?1:s)+t,duration:i/a,timeline:o,time:n*i}}}(e));if("static"===n){var c=u.length-1;u[c].duration=o-i/a*c}return u},_s=function(e){var t=e.baseUrl,n=e.initialization,i=void 0===n?{}:n,r=e.sourceDuration,a=e.timescale,o=void 0===a?1:a,s=e.indexRange,l=void 0===s?"":s,u=e.duration;if(!t)throw new Error(hs);var c=vs({baseUrl:t,source:i.sourceURL,range:i.range}),d=vs({baseUrl:t,source:t,indexRange:l});if(d.map=c,u){var h=bs(e);h.length&&(d.duration=h[0].duration,d.timeline=h[0].timeline)}else r&&(d.duration=r/o,d.timeline=0);return d.number=0,[d]},Ts=function(e,t,n){for(var i=e.sidx.map?e.sidx.map:null,r=e.sidx.duration,a=e.timeline||0,o=e.sidx.byterange,s=o.offset+o.length,l=t.timescale,u=t.references.filter(function(e){return 1!==e.referenceType}),c=[],d=s+t.firstOffset,h=0;h<u.length;h++){var p=t.references[h],f=p.referencedSize,g=p.subsegmentDuration,m=_s({baseUrl:n,timescale:l,timeline:a,periodIndex:a,duration:g,sourceDuration:r,indexRange:d+"-"+(d+f-1)})[0];i&&(m.map=i),c.push(m),d+=f}return e.segments=c,e},Es=function(e){var t;return(t=e.reduce(function(e,t){var n,i=t.attributes.id+(t.attributes.lang||"");return e[i]?(t.segments[0]&&(t.segments[0].discontinuity=!0),(n=e[i].segments).push.apply(n,t.segments),t.attributes.contentProtection&&(e[i].attributes.contentProtection=t.attributes.contentProtection)):e[i]=t,e},{}),Object.keys(t).map(function(e){return t[e]})).map(function(e){var t,n;return e.discontinuityStarts=(t=e.segments,n="discontinuity",t.reduce(function(e,t,i){return t[n]&&e.push(i),e},[])),e})},Cs=function(e,t){if(void 0===t&&(t={}),!Object.keys(t).length)return e;for(var n in e){var i=e[n];if(i.sidx){var r=i.sidx.uri+"-"+(s=(o=i.sidx.byterange).offset+o.length-1,o.offset+"-"+s),a=t[r]&&t[r].sidx;i.sidx&&a&&Ts(i,a,i.sidx.resolvedUri)}}var o,s;return e},ws=function(e){var t,n=e.attributes,i=e.segments,r=e.sidx,a={attributes:(t={NAME:n.id,AUDIO:"audio",SUBTITLES:"subs",RESOLUTION:{width:n.width,height:n.height},CODECS:n.codecs,BANDWIDTH:n.bandwidth},t["PROGRAM-ID"]=1,t),uri:"",endList:"static"===(n.type||"static"),timeline:n.periodIndex,resolvedUri:"",targetDuration:n.duration,segments:i,mediaSequence:i.length?i[0].number:1};return n.contentProtection&&(a.contentProtection=n.contentProtection),r&&(a.sidx=r),a},ks=function(e,t,n){var i=e.NOW,r=e.clientOffset,a=e.availabilityStartTime,o=e.timescale,s=void 0===o?1:o,l=e.start,u=void 0===l?0:l,c=e.minimumUpdatePeriod,d=(i+r)/1e3+(void 0===c?0:c)-(a+u);return Math.ceil((d*s-t)/n)},Ss=function(e,t){for(var n=e.type,i=void 0===n?"static":n,r=e.minimumUpdatePeriod,a=void 0===r?0:r,o=e.media,s=void 0===o?"":o,l=e.sourceDuration,u=e.timescale,c=void 0===u?1:u,d=e.startNumber,h=void 0===d?1:d,p=e.periodIndex,f=[],g=-1,m=0;m<t.length;m++){var v=t[m],y=v.d,b=v.r||0,_=v.t||0;g<0&&(g=_),_&&_>g&&(g=_);var T=void 0;if(b<0){var E=m+1;T=E===t.length?"dynamic"===i&&a>0&&s.indexOf("$Number$")>0?ks(e,g,y):(l*c-g)/y:(t[E].t-g)/y}else T=b+1;for(var C=h+f.length+T,w=h+f.length;w<C;)f.push({number:w,duration:y/c,time:g,timeline:p}),g+=y,w++}return f},Is=/\$([A-z]*)(?:(%0)([0-9]+)d)?\$/g,Os=function(e,t){return e.replace(Is,function(e){return function(t,n,i,r){if("$$"===t)return"$";if(void 0===e[n])return t;var a=""+e[n];return"RepresentationID"===n?a:(r=i?parseInt(r,10):1,a.length>=r?a:""+new Array(r-a.length+1).join("0")+a)}}(t))},Ds=function(e,t){var n={RepresentationID:e.id,Bandwidth:e.bandwidth||0},i=e.initialization,r=void 0===i?{sourceURL:"",range:""}:i,a=vs({baseUrl:e.baseUrl,source:Os(r.sourceURL,n),range:r.range});return function(e,t){return e.duration||t?e.duration?bs(e):Ss(e,t):[{number:e.startNumber||1,duration:e.sourceDuration,time:0,timeline:e.periodIndex}]}(e,t).map(function(t){n.Number=t.number,n.Time=t.time;var i=Os(e.media||"",n);return{uri:i,timeline:t.timeline,duration:t.duration,resolvedUri:ms(e.baseUrl||"",i),map:a,number:t.number}})},Rs=function(e,t){var n=e.duration,i=e.segmentUrls,r=void 0===i?[]:i;if(!n&&!t||n&&t)throw new Error(ps);var a,o=r.map(function(t){return function(e,t){var n=e.baseUrl,i=e.initialization,r=void 0===i?{}:i,a=vs({baseUrl:n,source:r.sourceURL,range:r.range}),o=vs({baseUrl:n,source:t.media,range:t.mediaRange});return o.map=a,o}(e,t)});return n&&(a=bs(e)),t&&(a=Ss(e,t)),a.map(function(e,t){if(o[t]){var n=o[t];return n.timeline=e.timeline,n.duration=e.duration,n.number=e.number,n}}).filter(function(e){return e})},xs=function(e){var t,n,i=e.attributes,r=e.segmentInfo;r.template?(n=Ds,t=os(i,r.template)):r.base?(n=_s,t=os(i,r.base)):r.list&&(n=Rs,t=os(i,r.list));var a={attributes:i};if(!n)return a;var o=n(t,r.timeline);if(t.duration){var s=t,l=s.duration,u=s.timescale,c=void 0===u?1:u;t.duration=l/c}else o.length?t.duration=o.reduce(function(e,t){return Math.max(e,Math.ceil(t.duration))},0):t.duration=0;return a.attributes=t,a.segments=o,r.base&&t.indexRange&&(a.sidx=o[0],a.segments=[]),a},As=function(e,t){return ls(e.childNodes).filter(function(e){return e.tagName===t})},Ps=function(e){return e.textContent.trim()},Ls=function(e){var t=/P(?:(\d*)Y)?(?:(\d*)M)?(?:(\d*)D)?(?:T(?:(\d*)H)?(?:(\d*)M)?(?:([\d.]*)S)?)?/.exec(e);if(!t)return 0;var n=t.slice(1),i=n[0],r=n[1],a=n[2],o=n[3],s=n[4],l=n[5];return 31536e3*parseFloat(i||0)+2592e3*parseFloat(r||0)+86400*parseFloat(a||0)+3600*parseFloat(o||0)+60*parseFloat(s||0)+parseFloat(l||0)},Ns={mediaPresentationDuration:function(e){return Ls(e)},availabilityStartTime:function(e){return/^\d+-\d+-\d+T\d+:\d+:\d+(\.\d+)?$/.test(t=e)&&(t+="Z"),Date.parse(t)/1e3;var t},minimumUpdatePeriod:function(e){return Ls(e)},timeShiftBufferDepth:function(e){return Ls(e)},start:function(e){return Ls(e)},width:function(e){return parseInt(e,10)},height:function(e){return parseInt(e,10)},bandwidth:function(e){return parseInt(e,10)},startNumber:function(e){return parseInt(e,10)},timescale:function(e){return parseInt(e,10)},duration:function(e){var t=parseInt(e,10);return isNaN(t)?Ls(e):t},d:function(e){return parseInt(e,10)},t:function(e){return parseInt(e,10)},r:function(e){return parseInt(e,10)},DEFAULT:function(e){return e}},Ms=function(e){return e&&e.attributes?ls(e.attributes).reduce(function(e,t){var n=Ns[t.name]||Ns.DEFAULT;return e[t.name]=n(t.value),e},{}):{}},Ks={"urn:uuid:1077efec-c0b2-4d02-ace3-3c1e52e2fb4b":"org.w3.clearkey","urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed":"com.widevine.alpha","urn:uuid:9a04f079-9840-4286-ab92-e65be0885f95":"com.microsoft.playready","urn:uuid:f239e769-efa3-4850-9c16-a903c6932efb":"com.adobe.primetime"},$s=function(e,t){return t.length?ss(e.map(function(e){return t.map(function(t){return ms(e,Ps(t))})})):e},js=function(e){var t=As(e,"SegmentTemplate")[0],n=As(e,"SegmentList")[0],i=n&&As(n,"SegmentURL").map(function(e){return os({tag:"SegmentURL"},Ms(e))}),r=As(e,"SegmentBase")[0],a=n||t,o=a&&As(a,"SegmentTimeline")[0],s=n||r||t,l=s&&As(s,"Initialization")[0],u=t&&Ms(t);u&&l?u.initialization=l&&Ms(l):u&&u.initialization&&(u.initialization={sourceURL:u.initialization});var c={template:u,timeline:o&&As(o,"S").map(function(e){return Ms(e)}),list:n&&os(Ms(n),{segmentUrls:i,initialization:Ms(l)}),base:r&&os(Ms(r),{initialization:Ms(l)})};return Object.keys(c).forEach(function(e){c[e]||delete c[e]}),c},Bs=function(t){return t.reduce(function(t,n){var i=Ms(n),r=Ks[i.schemeIdUri];if(r){t[r]={attributes:i};var a=As(n,"cenc:pssh")[0];if(a){var o=Ps(a),s=o&&function(t){for(var n=e.atob(t),i=new Uint8Array(n.length),r=0;r<n.length;r++)i[r]=n.charCodeAt(r);return i}(o);t[r].pssh=s}}return t},{})},Fs=function(t,n){void 0===n&&(n={});var i=n,r=i.manifestUri,a=void 0===r?"":r,o=i.NOW,s=void 0===o?Date.now():o,l=i.clientOffset,u=void 0===l?0:l,c=As(t,"Period");if(!c.length)throw new Error(us);var d=Ms(t),h=$s([a],As(t,"BaseURL"));return d.sourceDuration=d.mediaPresentationDuration||0,d.NOW=s,d.clientOffset=u,ss(c.map(function(t,n){return function(i,r){var a=$s(n,As(i,"BaseURL")),o=Ms(i),s=parseInt(o.id,10),l=e.isNaN(s)?r:s,u=os(t,{periodIndex:l}),c=As(i,"AdaptationSet"),d=js(i);return ss(c.map(function(e,t,n){return function(i){var r=Ms(i),a=$s(t,As(i,"BaseURL")),o=As(i,"Role")[0],s={role:Ms(o)},l=os(e,r,s),u=Bs(As(i,"ContentProtection"));Object.keys(u).length&&(l=os(l,{contentProtection:u}));var c=js(i),d=As(i,"Representation"),h=os(n,c);return ss(d.map(function(e,t,n){return function(i){var r=As(i,"BaseURL"),a=$s(t,r),o=os(e,Ms(i)),s=js(i);return a.map(function(e){return{segmentInfo:os(n,s),attributes:os(o,{baseUrl:e})}})}}(l,a,h)))}}(u,a,d)))}}(d,h)))},Us=function(t){if(""===t)throw new Error(cs);var n=(new e.DOMParser).parseFromString(t,"application/xml"),i=n&&"MPD"===n.documentElement.tagName?n.documentElement:null;if(!i||i&&i.getElementsByTagName("parsererror").length>0)throw new Error(ds);return i},Vs=function(e,t){return void 0===t&&(t={}),function(e,t){var n;if(void 0===t&&(t={}),!e.length)return{};var i=e[0].attributes,r=i.sourceDuration,a=i.minimumUpdatePeriod,o=void 0===a?0:a,s=Es(e.filter(function(e){var t=e.attributes;return"video/mp4"===t.mimeType||"video"===t.contentType})).map(ws),l=Es(e.filter(function(e){var t=e.attributes;return"audio/mp4"===t.mimeType||"audio"===t.contentType})),u=e.filter(function(e){var t=e.attributes;return"text/vtt"===t.mimeType||"text"===t.contentType}),c={allowCache:!0,discontinuityStarts:[],segments:[],endList:!0,mediaGroups:(n={AUDIO:{},VIDEO:{}},n["CLOSED-CAPTIONS"]={},n.SUBTITLES={},n),uri:"",duration:r,playlists:Cs(s,t),minimumUpdatePeriod:1e3*o};return l.length&&(c.mediaGroups.AUDIO.audio=function(e,t){void 0===t&&(t={});var n,i=l.reduce(function(e,i){var r=i.attributes.role&&i.attributes.role.value||"",a=i.attributes.lang||"",o="main";if(a){var s=r?" ("+r+")":"";o=""+i.attributes.lang+s}return e[o]&&e[o].playlists[0].attributes.BANDWIDTH>i.attributes.bandwidth?e:(e[o]={language:a,autoselect:!0,default:"main"===r,playlists:Cs([function(e){var t,n=e.attributes,i=e.segments,r=e.sidx,a={attributes:(t={NAME:n.id,BANDWIDTH:n.bandwidth,CODECS:n.codecs},t["PROGRAM-ID"]=1,t),uri:"",endList:"static"===(n.type||"static"),timeline:n.periodIndex,resolvedUri:"",targetDuration:n.duration,segments:i,mediaSequence:i.length?i[0].number:1};return n.contentProtection&&(a.contentProtection=n.contentProtection),r&&(a.sidx=r),a}(i)],t),uri:""},void 0===n&&"main"===r&&((n=i).default=!0),e)},{});return n||(i[Object.keys(i)[0]].default=!0),i}(0,t)),u.length&&(c.mediaGroups.SUBTITLES.subs=function(e,t){return void 0===t&&(t={}),u.reduce(function(e,n){var i,r,a,o,s=n.attributes.lang||"text";return e[s]?e:(e[s]={language:s,default:!1,autoselect:!1,playlists:Cs([(i=n,a=i.attributes,o=i.segments,void 0===o&&(o=[{uri:a.baseUrl,timeline:a.periodIndex,resolvedUri:a.baseUrl||"",duration:a.sourceDuration,number:0}],a.duration=a.sourceDuration),{attributes:(r={NAME:a.id,BANDWIDTH:a.bandwidth},r["PROGRAM-ID"]=1,r),uri:"",endList:"static"===(a.type||"static"),timeline:a.periodIndex,resolvedUri:a.baseUrl||"",targetDuration:a.duration,segments:o,mediaSequence:o.length?o[0].number:1})],t),uri:""},e)},{})}(0,t)),c}(Fs(Us(e),t).map(xs),t.sidxMapping)},qs=function(e){return e>>>0},Hs={findBox:uo=function(e,t){var n,i,r,a,o,s=[];if(!t.length)return null;for(n=0;n<e.byteLength;)i=qs(e[n]<<24|e[n+1]<<16|e[n+2]<<8|e[n+3]),r=co(e.subarray(n+4,n+8)),a=i>1?n+i:e.byteLength,r===t[0]&&(1===t.length?s.push(e.subarray(n+8,a)):(o=uo(e.subarray(n+8,a),t.slice(1))).length&&(s=s.concat(o))),n=a;return s},parseType:co=function(e){var t="";return t+=String.fromCharCode(e[0]),t+=String.fromCharCode(e[1]),(t+=String.fromCharCode(e[2]))+String.fromCharCode(e[3])},timescale:function(e){return uo(e,["moov","trak"]).reduce(function(e,t){var n,i,r,a,o;return(n=uo(t,["tkhd"])[0])?(i=n[0],a=qs(n[r=0===i?12:20]<<24|n[r+1]<<16|n[r+2]<<8|n[r+3]),(o=uo(t,["mdia","mdhd"])[0])?(r=0===(i=o[0])?12:20,e[a]=qs(o[r]<<24|o[r+1]<<16|o[r+2]<<8|o[r+3]),e):null):null},{})},startTime:function(e,t){var n,i,r;return n=uo(t,["moof","traf"]),i=[].concat.apply([],n.map(function(t){return uo(t,["tfhd"]).map(function(n){var i,r;return i=qs(n[4]<<24|n[5]<<16|n[6]<<8|n[7]),r=e[i]||9e4,(uo(t,["tfdt"]).map(function(e){var t,n;return t=e[0],n=qs(e[4]<<24|e[5]<<16|e[6]<<8|e[7]),1===t&&(n*=Math.pow(2,32),n+=qs(e[8]<<24|e[9]<<16|e[10]<<8|e[11])),n})[0]||1/0)/r})})),r=Math.min.apply(null,i),isFinite(r)?r:0},videoTrackIds:function(e){var t=[];return uo(e,["moov","trak"]).forEach(function(e){var n=uo(e,["mdia","hdlr"]),i=uo(e,["tkhd"]);n.forEach(function(e,n){var r,a,o=co(e.subarray(8,12)),s=i[n];"vide"===o&&(a=0===(r=new DataView(s.buffer,s.byteOffset,s.byteLength)).getUint8(0)?r.getUint32(12):r.getUint32(20),t.push(a))})}),t}},zs=Hs.parseType,Ws=function(e){return new Date(1e3*e-20828448e5)},Gs=function(e){return{isLeading:(12&e[0])>>>2,dependsOn:3&e[0],isDependedOn:(192&e[1])>>>6,hasRedundancy:(48&e[1])>>>4,paddingValue:(14&e[1])>>>1,isNonSyncSample:1&e[1],degradationPriority:e[2]<<8|e[3]}},Xs={avc1:function(e){var t=new DataView(e.buffer,e.byteOffset,e.byteLength);return{dataReferenceIndex:t.getUint16(6),width:t.getUint16(24),height:t.getUint16(26),horizresolution:t.getUint16(28)+t.getUint16(30)/16,vertresolution:t.getUint16(32)+t.getUint16(34)/16,frameCount:t.getUint16(40),depth:t.getUint16(74),config:ho(e.subarray(78,e.byteLength))}},avcC:function(e){var t,n,i,r,a=new DataView(e.buffer,e.byteOffset,e.byteLength),o={configurationVersion:e[0],avcProfileIndication:e[1],profileCompatibility:e[2],avcLevelIndication:e[3],lengthSizeMinusOne:3&e[4],sps:[],pps:[]},s=31&e[5];for(i=6,r=0;r<s;r++)n=a.getUint16(i),i+=2,o.sps.push(new Uint8Array(e.subarray(i,i+n))),i+=n;for(t=e[i],i++,r=0;r<t;r++)n=a.getUint16(i),i+=2,o.pps.push(new Uint8Array(e.subarray(i,i+n))),i+=n;return o},btrt:function(e){var t=new DataView(e.buffer,e.byteOffset,e.byteLength);return{bufferSizeDB:t.getUint32(0),maxBitrate:t.getUint32(4),avgBitrate:t.getUint32(8)}},esds:function(e){return{version:e[0],flags:new Uint8Array(e.subarray(1,4)),esId:e[6]<<8|e[7],streamPriority:31&e[8],decoderConfig:{objectProfileIndication:e[11],streamType:e[12]>>>2&63,bufferSize:e[13]<<16|e[14]<<8|e[15],maxBitrate:e[16]<<24|e[17]<<16|e[18]<<8|e[19],avgBitrate:e[20]<<24|e[21]<<16|e[22]<<8|e[23],decoderConfigDescriptor:{tag:e[24],length:e[25],audioObjectType:e[26]>>>3&31,samplingFrequencyIndex:(7&e[26])<<1|e[27]>>>7&1,channelConfiguration:e[27]>>>3&15}}}},ftyp:function(e){for(var t=new DataView(e.buffer,e.byteOffset,e.byteLength),n={majorBrand:zs(e.subarray(0,4)),minorVersion:t.getUint32(4),compatibleBrands:[]},i=8;i<e.byteLength;)n.compatibleBrands.push(zs(e.subarray(i,i+4))),i+=4;return n},dinf:function(e){return{boxes:ho(e)}},dref:function(e){return{version:e[0],flags:new Uint8Array(e.subarray(1,4)),dataReferences:ho(e.subarray(8))}},hdlr:function(e){var t={version:new DataView(e.buffer,e.byteOffset,e.byteLength).getUint8(0),flags:new Uint8Array(e.subarray(1,4)),handlerType:zs(e.subarray(8,12)),name:""},n=8;for(n=24;n<e.byteLength;n++){if(0===e[n]){n++;break}t.name+=String.fromCharCode(e[n])}return t.name=decodeURIComponent(escape(t.name)),t},mdat:function(e){return{byteLength:e.byteLength,nals:function(e){var t,n,i=new DataView(e.buffer,e.byteOffset,e.byteLength),r=[];for(t=0;t+4<e.length;t+=n)if(n=i.getUint32(t),t+=4,n<=0)r.push("<span style='color:red;'>MALFORMED DATA</span>");else switch(31&e[t]){case 1:r.push("slice_layer_without_partitioning_rbsp");break;case 5:r.push("slice_layer_without_partitioning_rbsp_idr");break;case 6:r.push("sei_rbsp");break;case 7:r.push("seq_parameter_set_rbsp");break;case 8:r.push("pic_parameter_set_rbsp");break;case 9:r.push("access_unit_delimiter_rbsp");break;default:r.push("UNKNOWN NAL - "+e[t]&31)}return r}(e)}},mdhd:function(e){var t,n=new DataView(e.buffer,e.byteOffset,e.byteLength),i=4,r={version:n.getUint8(0),flags:new Uint8Array(e.subarray(1,4)),language:""};return 1===r.version?(i+=4,r.creationTime=Ws(n.getUint32(i)),i+=8,r.modificationTime=Ws(n.getUint32(i)),i+=4,r.timescale=n.getUint32(i),i+=8,r.duration=n.getUint32(i)):(r.creationTime=Ws(n.getUint32(i)),i+=4,r.modificationTime=Ws(n.getUint32(i)),i+=4,r.timescale=n.getUint32(i),i+=4,r.duration=n.getUint32(i)),i+=4,t=n.getUint16(i),r.language+=String.fromCharCode(96+(t>>10)),r.language+=String.fromCharCode(96+((992&t)>>5)),r.language+=String.fromCharCode(96+(31&t)),r},mdia:function(e){return{boxes:ho(e)}},mfhd:function(e){return{version:e[0],flags:new Uint8Array(e.subarray(1,4)),sequenceNumber:e[4]<<24|e[5]<<16|e[6]<<8|e[7]}},minf:function(e){return{boxes:ho(e)}},mp4a:function(e){var t=new DataView(e.buffer,e.byteOffset,e.byteLength),n={dataReferenceIndex:t.getUint16(6),channelcount:t.getUint16(16),samplesize:t.getUint16(18),samplerate:t.getUint16(24)+t.getUint16(26)/65536};return e.byteLength>28&&(n.streamDescriptor=ho(e.subarray(28))[0]),n},moof:function(e){return{boxes:ho(e)}},moov:function(e){return{boxes:ho(e)}},mvex:function(e){return{boxes:ho(e)}},mvhd:function(e){var t=new DataView(e.buffer,e.byteOffset,e.byteLength),n=4,i={version:t.getUint8(0),flags:new Uint8Array(e.subarray(1,4))};return 1===i.version?(n+=4,i.creationTime=Ws(t.getUint32(n)),n+=8,i.modificationTime=Ws(t.getUint32(n)),n+=4,i.timescale=t.getUint32(n),n+=8,i.duration=t.getUint32(n)):(i.creationTime=Ws(t.getUint32(n)),n+=4,i.modificationTime=Ws(t.getUint32(n)),n+=4,i.timescale=t.getUint32(n),n+=4,i.duration=t.getUint32(n)),n+=4,i.rate=t.getUint16(n)+t.getUint16(n+2)/16,n+=4,i.volume=t.getUint8(n)+t.getUint8(n+1)/8,n+=2,n+=2,n+=8,i.matrix=new Uint32Array(e.subarray(n,n+36)),n+=36,n+=24,i.nextTrackId=t.getUint32(n),i},pdin:function(e){var t=new DataView(e.buffer,e.byteOffset,e.byteLength);return{version:t.getUint8(0),flags:new Uint8Array(e.subarray(1,4)),rate:t.getUint32(4),initialDelay:t.getUint32(8)}},sdtp:function(e){var t,n={version:e[0],flags:new Uint8Array(e.subarray(1,4)),samples:[]};for(t=4;t<e.byteLength;t++)n.samples.push({dependsOn:(48&e[t])>>4,isDependedOn:(12&e[t])>>2,hasRedundancy:3&e[t]});return n},sidx:function(e){var t,n=new DataView(e.buffer,e.byteOffset,e.byteLength),i={version:e[0],flags:new Uint8Array(e.subarray(1,4)),references:[],referenceId:n.getUint32(4),timescale:n.getUint32(8),earliestPresentationTime:n.getUint32(12),firstOffset:n.getUint32(16)},r=n.getUint16(22);for(t=24;r;t+=12,r--)i.references.push({referenceType:(128&e[t])>>>7,referencedSize:2147483647&n.getUint32(t),subsegmentDuration:n.getUint32(t+4),startsWithSap:!!(128&e[t+8]),sapType:(112&e[t+8])>>>4,sapDeltaTime:268435455&n.getUint32(t+8)});return i},smhd:function(e){return{version:e[0],flags:new Uint8Array(e.subarray(1,4)),balance:e[4]+e[5]/256}},stbl:function(e){return{boxes:ho(e)}},stco:function(e){var t,n=new DataView(e.buffer,e.byteOffset,e.byteLength),i={version:e[0],flags:new Uint8Array(e.subarray(1,4)),chunkOffsets:[]},r=n.getUint32(4);for(t=8;r;t+=4,r--)i.chunkOffsets.push(n.getUint32(t));return i},stsc:function(e){var t,n=new DataView(e.buffer,e.byteOffset,e.byteLength),i=n.getUint32(4),r={version:e[0],flags:new Uint8Array(e.subarray(1,4)),sampleToChunks:[]};for(t=8;i;t+=12,i--)r.sampleToChunks.push({firstChunk:n.getUint32(t),samplesPerChunk:n.getUint32(t+4),sampleDescriptionIndex:n.getUint32(t+8)});return r},stsd:function(e){return{version:e[0],flags:new Uint8Array(e.subarray(1,4)),sampleDescriptions:ho(e.subarray(8))}},stsz:function(e){var t,n=new DataView(e.buffer,e.byteOffset,e.byteLength),i={version:e[0],flags:new Uint8Array(e.subarray(1,4)),sampleSize:n.getUint32(4),entries:[]};for(t=12;t<e.byteLength;t+=4)i.entries.push(n.getUint32(t));return i},stts:function(e){var t,n=new DataView(e.buffer,e.byteOffset,e.byteLength),i={version:e[0],flags:new Uint8Array(e.subarray(1,4)),timeToSamples:[]},r=n.getUint32(4);for(t=8;r;t+=8,r--)i.timeToSamples.push({sampleCount:n.getUint32(t),sampleDelta:n.getUint32(t+4)});return i},styp:function(e){return Xs.ftyp(e)},tfdt:function(e){var t={version:e[0],flags:new Uint8Array(e.subarray(1,4)),baseMediaDecodeTime:e[4]<<24|e[5]<<16|e[6]<<8|e[7]};return 1===t.version&&(t.baseMediaDecodeTime*=Math.pow(2,32),t.baseMediaDecodeTime+=e[8]<<24|e[9]<<16|e[10]<<8|e[11]),t},tfhd:function(e){var t,n=new DataView(e.buffer,e.byteOffset,e.byteLength),i={version:e[0],flags:new Uint8Array(e.subarray(1,4)),trackId:n.getUint32(4)},r=1&i.flags[2],a=2&i.flags[2],o=8&i.flags[2],s=16&i.flags[2],l=32&i.flags[2],u=65536&i.flags[0],c=131072&i.flags[0];return t=8,r&&(t+=4,i.baseDataOffset=n.getUint32(12),t+=4),a&&(i.sampleDescriptionIndex=n.getUint32(t),t+=4),o&&(i.defaultSampleDuration=n.getUint32(t),t+=4),s&&(i.defaultSampleSize=n.getUint32(t),t+=4),l&&(i.defaultSampleFlags=n.getUint32(t)),u&&(i.durationIsEmpty=!0),!r&&c&&(i.baseDataOffsetIsMoof=!0),i},tkhd:function(e){var t=new DataView(e.buffer,e.byteOffset,e.byteLength),n=4,i={version:t.getUint8(0),flags:new Uint8Array(e.subarray(1,4))};return 1===i.version?(n+=4,i.creationTime=Ws(t.getUint32(n)),n+=8,i.modificationTime=Ws(t.getUint32(n)),n+=4,i.trackId=t.getUint32(n),n+=4,n+=8,i.duration=t.getUint32(n)):(i.creationTime=Ws(t.getUint32(n)),n+=4,i.modificationTime=Ws(t.getUint32(n)),n+=4,i.trackId=t.getUint32(n),n+=4,n+=4,i.duration=t.getUint32(n)),n+=4,n+=8,i.layer=t.getUint16(n),n+=2,i.alternateGroup=t.getUint16(n),n+=2,i.volume=t.getUint8(n)+t.getUint8(n+1)/8,n+=2,n+=2,i.matrix=new Uint32Array(e.subarray(n,n+36)),n+=36,i.width=t.getUint16(n)+t.getUint16(n+2)/16,n+=4,i.height=t.getUint16(n)+t.getUint16(n+2)/16,i},traf:function(e){return{boxes:ho(e)}},trak:function(e){return{boxes:ho(e)}},trex:function(e){var t=new DataView(e.buffer,e.byteOffset,e.byteLength);return{version:e[0],flags:new Uint8Array(e.subarray(1,4)),trackId:t.getUint32(4),defaultSampleDescriptionIndex:t.getUint32(8),defaultSampleDuration:t.getUint32(12),defaultSampleSize:t.getUint32(16),sampleDependsOn:3&e[20],sampleIsDependedOn:(192&e[21])>>6,sampleHasRedundancy:(48&e[21])>>4,samplePaddingValue:(14&e[21])>>1,sampleIsDifferenceSample:!!(1&e[21]),sampleDegradationPriority:t.getUint16(22)}},trun:function(e){var t,n={version:e[0],flags:new Uint8Array(e.subarray(1,4)),samples:[]},i=new DataView(e.buffer,e.byteOffset,e.byteLength),r=1&n.flags[2],a=4&n.flags[2],o=1&n.flags[1],s=2&n.flags[1],l=4&n.flags[1],u=8&n.flags[1],c=i.getUint32(4),d=8;for(r&&(n.dataOffset=i.getInt32(d),d+=4),a&&c&&(t={flags:Gs(e.subarray(d,d+4))},d+=4,o&&(t.duration=i.getUint32(d),d+=4),s&&(t.size=i.getUint32(d),d+=4),u&&(t.compositionTimeOffset=i.getUint32(d),d+=4),n.samples.push(t),c--);c--;)t={},o&&(t.duration=i.getUint32(d),d+=4),s&&(t.size=i.getUint32(d),d+=4),l&&(t.flags=Gs(e.subarray(d,d+4)),d+=4),u&&(t.compositionTimeOffset=i.getUint32(d),d+=4),n.samples.push(t);return n},"url ":function(e){return{version:e[0],flags:new Uint8Array(e.subarray(1,4))}},vmhd:function(e){var t=new DataView(e.buffer,e.byteOffset,e.byteLength);return{version:e[0],flags:new Uint8Array(e.subarray(1,4)),graphicsmode:t.getUint16(4),opcolor:new Uint16Array([t.getUint16(6),t.getUint16(8),t.getUint16(10)])}}},Ys={inspect:ho=function(e){for(var t,n,i,r,a,o=0,s=[],l=new ArrayBuffer(e.length),u=new Uint8Array(l),c=0;c<e.length;++c)u[c]=e[c];for(t=new DataView(l);o<e.byteLength;)n=t.getUint32(o),i=zs(e.subarray(o+4,o+8)),r=n>1?o+n:e.byteLength,(a=(Xs[i]||function(e){return{data:e}})(e.subarray(o+8,r))).size=n,a.type=i,s.push(a),o=r;return s},textify:po=function(e,t){var n;return t=t||0,n=new Array(2*t+1).join(" "),e.map(function(e,i){return n+e.type+"\n"+Object.keys(e).filter(function(e){return"type"!==e&&"boxes"!==e}).map(function(t){var i=n+"  "+t+": ",r=e[t];if(r instanceof Uint8Array||r instanceof Uint32Array){var a=Array.prototype.slice.call(new Uint8Array(r.buffer,r.byteOffset,r.byteLength)).map(function(e){return" "+("00"+e.toString(16)).slice(-2)}).join("").match(/.{1,24}/g);return a?1===a.length?i+"<"+a.join("").slice(1)+">":i+"<\n"+a.map(function(e){return n+"  "+e}).join("\n")+"\n"+n+"  >":i+"<>"}return i+JSON.stringify(r,null,2).split("\n").map(function(e,t){return 0===t?e:n+"  "+e}).join("\n")}).join("\n")+(e.boxes?"\n"+po(e.boxes,t+1):"")}).join("\n")},parseTfdt:Xs.tfdt,parseHdlr:Xs.hdlr,parseTfhd:Xs.tfhd,parseTrun:Xs.trun,parseSidx:Xs.sidx},Qs=Math.pow(2,32)-1;(function(){var e;if(No={avc1:[],avcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],mvex:[],mvhd:[],sdtp:[],smhd:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],styp:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[]},"undefined"!=typeof Uint8Array){for(e in No)No.hasOwnProperty(e)&&(No[e]=[e.charCodeAt(0),e.charCodeAt(1),e.charCodeAt(2),e.charCodeAt(3)]);Mo=new Uint8Array(["i".charCodeAt(0),"s".charCodeAt(0),"o".charCodeAt(0),"m".charCodeAt(0)]),$o=new Uint8Array(["a".charCodeAt(0),"v".charCodeAt(0),"c".charCodeAt(0),"1".charCodeAt(0)]),Ko=new Uint8Array([0,0,0,1]),jo=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),Bo=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]),Fo={video:jo,audio:Bo},qo=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),Vo=new Uint8Array([0,0,0,0,0,0,0,0]),Ho=new Uint8Array([0,0,0,0,0,0,0,0]),zo=Ho,Wo=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),Go=Ho,Uo=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0])}})(),fo=function(e){var t,n,i=[],r=0;for(t=1;t<arguments.length;t++)i.push(arguments[t]);for(t=i.length;t--;)r+=i[t].byteLength;for(n=new Uint8Array(r+8),new DataView(n.buffer,n.byteOffset,n.byteLength).setUint32(0,n.byteLength),n.set(e,4),t=0,r=8;t<i.length;t++)n.set(i[t],r),r+=i[t].byteLength;return n},go=function(){return fo(No.dinf,fo(No.dref,qo))},mo=function(e){return fo(No.esds,new Uint8Array([0,0,0,0,3,25,0,0,0,4,17,64,21,0,6,0,0,0,218,192,0,0,218,192,5,2,e.audioobjecttype<<3|e.samplingfrequencyindex>>>1,e.samplingfrequencyindex<<7|e.channelcount<<3,6,1,2]))},Oo=function(e){return fo(No.hdlr,Fo[e])},Io=function(e){var t=new Uint8Array([0,0,0,0,0,0,0,2,0,0,0,3,0,1,95,144,e.duration>>>24&255,e.duration>>>16&255,e.duration>>>8&255,255&e.duration,85,196,0,0]);return e.samplerate&&(t[12]=e.samplerate>>>24&255,t[13]=e.samplerate>>>16&255,t[14]=e.samplerate>>>8&255,t[15]=255&e.samplerate),fo(No.mdhd,t)},So=function(e){return fo(No.mdia,Io(e),Oo(e.type),bo(e))},yo=function(e){return fo(No.mfhd,new Uint8Array([0,0,0,0,(4278190080&e)>>24,(16711680&e)>>16,(65280&e)>>8,255&e]))},bo=function(e){return fo(No.minf,"video"===e.type?fo(No.vmhd,Uo):fo(No.smhd,Vo),go(),Ro(e))},_o=function(e,t){for(var n=[],i=t.length;i--;)n[i]=Ao(t[i]);return fo.apply(null,[No.moof,yo(e)].concat(n))},To=function(e){for(var t=e.length,n=[];t--;)n[t]=wo(e[t]);return fo.apply(null,[No.moov,Co(4294967295)].concat(n).concat(Eo(e)))},Eo=function(e){for(var t=e.length,n=[];t--;)n[t]=Po(e[t]);return fo.apply(null,[No.mvex].concat(n))},Co=function(e){var t=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,2,0,1,95,144,(4278190080&e)>>24,(16711680&e)>>16,(65280&e)>>8,255&e,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return fo(No.mvhd,t)},Do=function(e){var t,n,i=e.samples||[],r=new Uint8Array(4+i.length);for(n=0;n<i.length;n++)t=i[n].flags,r[n+4]=t.dependsOn<<4|t.isDependedOn<<2|t.hasRedundancy;return fo(No.sdtp,r)},Ro=function(e){return fo(No.stbl,xo(e),fo(No.stts,Go),fo(No.stsc,zo),fo(No.stsz,Wo),fo(No.stco,Ho))},xo=function(e){return fo(No.stsd,new Uint8Array([0,0,0,0,0,0,0,1]),"video"===e.type?Jo(e):Zo(e))},Jo=function(e){var t,n=e.sps||[],i=e.pps||[],r=[],a=[];for(t=0;t<n.length;t++)r.push((65280&n[t].byteLength)>>>8),r.push(255&n[t].byteLength),r=r.concat(Array.prototype.slice.call(n[t]));for(t=0;t<i.length;t++)a.push((65280&i[t].byteLength)>>>8),a.push(255&i[t].byteLength),a=a.concat(Array.prototype.slice.call(i[t]));return fo(No.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,(65280&e.width)>>8,255&e.width,(65280&e.height)>>8,255&e.height,0,72,0,0,0,72,0,0,0,0,0,0,0,1,19,118,105,100,101,111,106,115,45,99,111,110,116,114,105,98,45,104,108,115,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),fo(No.avcC,new Uint8Array([1,e.profileIdc,e.profileCompatibility,e.levelIdc,255].concat([n.length]).concat(r).concat([i.length]).concat(a))),fo(No.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])))},Zo=function(e){return fo(No.mp4a,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,(65280&e.channelcount)>>8,255&e.channelcount,(65280&e.samplesize)>>8,255&e.samplesize,0,0,0,0,(65280&e.samplerate)>>8,255&e.samplerate,0,0]),mo(e))},ko=function(e){var t=new Uint8Array([0,0,0,7,0,0,0,0,0,0,0,0,(4278190080&e.id)>>24,(16711680&e.id)>>16,(65280&e.id)>>8,255&e.id,0,0,0,0,(4278190080&e.duration)>>24,(16711680&e.duration)>>16,(65280&e.duration)>>8,255&e.duration,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,(65280&e.width)>>8,255&e.width,0,0,(65280&e.height)>>8,255&e.height,0,0]);return fo(No.tkhd,t)},Ao=function(e){var t,n,i,r,a,o;return t=fo(No.tfhd,new Uint8Array([0,0,0,58,(4278190080&e.id)>>24,(16711680&e.id)>>16,(65280&e.id)>>8,255&e.id,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0])),a=Math.floor(e.baseMediaDecodeTime/(Qs+1)),o=Math.floor(e.baseMediaDecodeTime%(Qs+1)),n=fo(No.tfdt,new Uint8Array([1,0,0,0,a>>>24&255,a>>>16&255,a>>>8&255,255&a,o>>>24&255,o>>>16&255,o>>>8&255,255&o])),"audio"===e.type?(i=Lo(e,92),fo(No.traf,t,n,i)):(r=Do(e),i=Lo(e,r.length+92),fo(No.traf,t,n,i,r))},wo=function(e){return e.duration=e.duration||4294967295,fo(No.trak,ko(e),So(e))},Po=function(e){var t=new Uint8Array([0,0,0,0,(4278190080&e.id)>>24,(16711680&e.id)>>16,(65280&e.id)>>8,255&e.id,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]);return"video"!==e.type&&(t[t.length-1]=0),fo(No.trex,t)},Qo=function(e,t){var n=0,i=0,r=0,a=0;return e.length&&(void 0!==e[0].duration&&(n=1),void 0!==e[0].size&&(i=2),void 0!==e[0].flags&&(r=4),void 0!==e[0].compositionTimeOffset&&(a=8)),[0,0,n|i|r|a,1,(4278190080&e.length)>>>24,(16711680&e.length)>>>16,(65280&e.length)>>>8,255&e.length,(4278190080&t)>>>24,(16711680&t)>>>16,(65280&t)>>>8,255&t]},Yo=function(e,t){var n,i,r,a;for(t+=20+16*(i=e.samples||[]).length,n=Qo(i,t),a=0;a<i.length;a++)r=i[a],n=n.concat([(4278190080&r.duration)>>>24,(16711680&r.duration)>>>16,(65280&r.duration)>>>8,255&r.duration,(4278190080&r.size)>>>24,(16711680&r.size)>>>16,(65280&r.size)>>>8,255&r.size,r.flags.isLeading<<2|r.flags.dependsOn,r.flags.isDependedOn<<6|r.flags.hasRedundancy<<4|r.flags.paddingValue<<1|r.flags.isNonSyncSample,61440&r.flags.degradationPriority,15&r.flags.degradationPriority,(4278190080&r.compositionTimeOffset)>>>24,(16711680&r.compositionTimeOffset)>>>16,(65280&r.compositionTimeOffset)>>>8,255&r.compositionTimeOffset]);return fo(No.trun,new Uint8Array(n))},Xo=function(e,t){var n,i,r,a;for(t+=20+8*(i=e.samples||[]).length,n=Qo(i,t),a=0;a<i.length;a++)r=i[a],n=n.concat([(4278190080&r.duration)>>>24,(16711680&r.duration)>>>16,(65280&r.duration)>>>8,255&r.duration,(4278190080&r.size)>>>24,(16711680&r.size)>>>16,(65280&r.size)>>>8,255&r.size]);return fo(No.trun,new Uint8Array(n))},Lo=function(e,t){return"audio"===e.type?Xo(e,t):Yo(e,t)};var Js={ftyp:vo=function(){return fo(No.ftyp,Mo,Ko,Mo,$o)},mdat:function(e){return fo(No.mdat,e)},moof:_o,moov:To,initSegment:function(e){var t,n=vo(),i=To(e);return(t=new Uint8Array(n.byteLength+i.byteLength)).set(n),t.set(i,n.byteLength),t}},Zs=function(){this.init=function(){var e={};this.on=function(t,n){e[t]||(e[t]=[]),e[t]=e[t].concat(n)},this.off=function(t,n){var i;return!!e[t]&&(i=e[t].indexOf(n),e[t]=e[t].slice(),e[t].splice(i,1),i>-1)},this.trigger=function(t){var n,i,r,a;if(n=e[t])if(2===arguments.length)for(r=n.length,i=0;i<r;++i)n[i].call(this,arguments[1]);else{for(a=[],i=arguments.length,i=1;i<arguments.length;++i)a.push(arguments[i]);for(r=n.length,i=0;i<r;++i)n[i].apply(this,a)}},this.dispose=function(){e={}}}};Zs.prototype.pipe=function(e){return this.on("data",function(t){e.push(t)}),this.on("done",function(t){e.flush(t)}),e},Zs.prototype.push=function(e){this.trigger("data",e)},Zs.prototype.flush=function(e){this.trigger("done",e)};var el,tl,nl,il,rl,al=Zs,ol=function(e,t){var n={size:0,flags:{isLeading:0,dependsOn:1,isDependedOn:0,hasRedundancy:0,degradationPriority:0,isNonSyncSample:1}};return n.dataOffset=t,n.compositionTimeOffset=e.pts-e.dts,n.duration=e.duration,n.size=4*e.length,n.size+=e.byteLength,e.keyFrame&&(n.flags.dependsOn=2,n.flags.isNonSyncSample=0),n},sl=function(e){var t,n,i=[],r=[];for(i.byteLength=0,t=0;t<e.length;t++)"access_unit_delimiter_rbsp"===(n=e[t]).nalUnitType?(i.length&&(i.duration=n.dts-i.dts,r.push(i)),(i=[n]).byteLength=n.data.byteLength,i.pts=n.pts,i.dts=n.dts):("slice_layer_without_partitioning_rbsp_idr"===n.nalUnitType&&(i.keyFrame=!0),i.duration=n.dts-i.dts,i.byteLength+=n.data.byteLength,i.push(n));return r.length&&(!i.duration||i.duration<=0)&&(i.duration=r[r.length-1].duration),r.push(i),r},ll=function(e){var t,n,i=[],r=[];for(i.byteLength=0,i.nalCount=0,i.duration=0,i.pts=e[0].pts,i.dts=e[0].dts,r.byteLength=0,r.nalCount=0,r.duration=0,r.pts=e[0].pts,r.dts=e[0].dts,t=0;t<e.length;t++)(n=e[t]).keyFrame?(i.length&&(r.push(i),r.byteLength+=i.byteLength,r.nalCount+=i.nalCount,r.duration+=i.duration),(i=[n]).nalCount=n.length,i.byteLength=n.byteLength,i.pts=n.pts,i.dts=n.dts,i.duration=n.duration):(i.duration+=n.duration,i.nalCount+=n.length,i.byteLength+=n.byteLength,i.push(n));return r.length&&i.duration<=0&&(i.duration=r[r.length-1].duration),r.byteLength+=i.byteLength,r.nalCount+=i.nalCount,r.duration+=i.duration,r.push(i),r},ul=function(e){var t;return!e[0][0].keyFrame&&e.length>1&&(t=e.shift(),e.byteLength-=t.byteLength,e.nalCount-=t.nalCount,e[0][0].dts=t.dts,e[0][0].pts=t.pts,e[0][0].duration+=t.duration),e},cl=function(e,t){var n,i,r,a,o,s=t||0,l=[];for(n=0;n<e.length;n++)for(a=e[n],i=0;i<a.length;i++)o=a[i],s+=(r=ol(o,s)).size,l.push(r);return l},dl=function(e){var t,n,i,r,a,o,s=0,l=e.byteLength,u=e.nalCount,c=new Uint8Array(l+4*u),d=new DataView(c.buffer);for(t=0;t<e.length;t++)for(r=e[t],n=0;n<r.length;n++)for(a=r[n],i=0;i<a.length;i++)o=a[i],d.setUint32(s,o.data.byteLength),s+=4,c.set(o.data,s),s+=o.data.byteLength;return c},hl=[33,16,5,32,164,27],pl=[33,65,108,84,1,2,4,8,168,2,4,8,17,191,252],fl=function(e){for(var t=[];e--;)t.push(0);return t},gl={96000:[hl,[227,64],fl(154),[56]],88200:[hl,[231],fl(170),[56]],64000:[hl,[248,192],fl(240),[56]],48000:[hl,[255,192],fl(268),[55,148,128],fl(54),[112]],44100:[hl,[255,192],fl(268),[55,163,128],fl(84),[112]],32000:[hl,[255,192],fl(268),[55,234],fl(226),[112]],24000:[hl,[255,192],fl(268),[55,255,128],fl(268),[111,112],fl(126),[224]],16000:[hl,[255,192],fl(268),[55,255,128],fl(268),[111,255],fl(269),[223,108],fl(195),[1,192]],12000:[pl,fl(268),[3,127,248],fl(268),[6,255,240],fl(268),[13,255,224],fl(268),[27,253,128],fl(259),[56]],11025:[pl,fl(268),[3,127,248],fl(268),[6,255,240],fl(268),[13,255,224],fl(268),[27,255,192],fl(268),[55,175,128],fl(108),[112]],8000:[pl,fl(268),[3,121,16],fl(47),[7]]},ml=(rl=gl,Object.keys(rl).reduce(function(e,t){return e[t]=new Uint8Array(rl[t].reduce(function(e,t){return e.concat(t)},[])),e},{})),vl=(el=function(e){return 9e4*e},tl=function(e,t){return e*t},nl=function(e){return e/9e4},il=function(e,t){return e/t},function(e,t){return el(il(e,t))}),yl=function(e,t){return tl(nl(e),t)},bl=function(e,t,n,i){var r,a,o,s=0,l=0,u=0,c=0;if(t.length&&(r=vl(e.baseMediaDecodeTime,e.samplerate),s=Math.ceil(9e4/(e.samplerate/1024)),n&&i&&(l=r-Math.max(n,i),c=(u=Math.floor(l/s))*s),!(u<1||c>45e3))){for((a=ml[e.samplerate])||(a=t[0].data),o=0;o<u;o++)t.splice(o,0,{data:a});e.baseMediaDecodeTime-=Math.floor(yl(c,e.samplerate))}},_l=function(e,t,n){return t.minSegmentDts>=n?e:(t.minSegmentDts=1/0,e.filter(function(e){return e.dts>=n&&(t.minSegmentDts=Math.min(t.minSegmentDts,e.dts),t.minSegmentPts=t.minSegmentDts,!0)}))},Tl=function(e){var t,n,i=[];for(t=0;t<e.length;t++)n=e[t],i.push({size:n.data.byteLength,duration:1024});return i},El=function(e){var t,n,i=0,r=new Uint8Array(function(e){var t,n=0;for(t=0;t<e.length;t++)n+=e[t].data.byteLength;return n}(e));for(t=0;t<e.length;t++)n=e[t],r.set(n.data,i),i+=n.data.byteLength;return r},Cl=function(e){delete e.minSegmentDts,delete e.maxSegmentDts,delete e.minSegmentPts,delete e.maxSegmentPts},wl=function(e,t){var n,i=e.minSegmentDts;return t||(i-=e.timelineStartInfo.dts),n=e.timelineStartInfo.baseMediaDecodeTime,n+=i,n=Math.max(0,n),"audio"===e.type&&(n*=e.samplerate/9e4,n=Math.floor(n)),n},kl=function(e,t){"number"==typeof t.pts&&(void 0===e.timelineStartInfo.pts&&(e.timelineStartInfo.pts=t.pts),void 0===e.minSegmentPts?e.minSegmentPts=t.pts:e.minSegmentPts=Math.min(e.minSegmentPts,t.pts),void 0===e.maxSegmentPts?e.maxSegmentPts=t.pts:e.maxSegmentPts=Math.max(e.maxSegmentPts,t.pts)),"number"==typeof t.dts&&(void 0===e.timelineStartInfo.dts&&(e.timelineStartInfo.dts=t.dts),void 0===e.minSegmentDts?e.minSegmentDts=t.dts:e.minSegmentDts=Math.min(e.minSegmentDts,t.dts),void 0===e.maxSegmentDts?e.maxSegmentDts=t.dts:e.maxSegmentDts=Math.max(e.maxSegmentDts,t.dts))},Sl=function(e){for(var t=0,n={payloadType:-1,payloadSize:0},i=0,r=0;t<e.byteLength&&128!==e[t];){for(;255===e[t];)i+=255,t++;for(i+=e[t++];255===e[t];)r+=255,t++;if(r+=e[t++],!n.payload&&4===i){n.payloadType=i,n.payloadSize=r,n.payload=e.subarray(t,t+r);break}t+=r,i=0,r=0}return n},Il=function(e){return 181!==e.payload[0]?null:49!=(e.payload[1]<<8|e.payload[2])?null:"GA94"!==String.fromCharCode(e.payload[3],e.payload[4],e.payload[5],e.payload[6])?null:3!==e.payload[7]?null:e.payload.subarray(8,e.payload.length-1)},Ol=function(e,t){var n,i,r,a,o=[];if(!(64&t[0]))return o;for(i=31&t[0],n=0;n<i;n++)a={type:3&t[2+(r=3*n)],pts:e},4&t[r+2]&&(a.ccData=t[r+3]<<8|t[r+4],o.push(a));return o},Dl=function(e){for(var t,n,i=e.byteLength,r=[],a=1;a<i-2;)0===e[a]&&0===e[a+1]&&3===e[a+2]?(r.push(a+2),a+=2):a++;if(0===r.length)return e;t=i-r.length,n=new Uint8Array(t);var o=0;for(a=0;a<t;o++,a++)o===r[0]&&(o++,r.shift()),n[a]=e[o];return n},Rl=4,xl=function e(){e.prototype.init.call(this),this.captionPackets_=[],this.ccStreams_=[new Ml(0,0),new Ml(0,1),new Ml(1,0),new Ml(1,1)],this.reset(),this.ccStreams_.forEach(function(e){e.on("data",this.trigger.bind(this,"data")),e.on("done",this.trigger.bind(this,"done"))},this)};(xl.prototype=new al).push=function(e){var t,n,i;if("sei_rbsp"===e.nalUnitType&&(t=Sl(e.escapedRBSP)).payloadType===Rl&&(n=Il(t)))if(e.dts<this.latestDts_)this.ignoreNextEqualDts_=!0;else{if(e.dts===this.latestDts_&&this.ignoreNextEqualDts_)return this.numSameDts_--,void(this.numSameDts_||(this.ignoreNextEqualDts_=!1));i=Ol(e.pts,n),this.captionPackets_=this.captionPackets_.concat(i),this.latestDts_!==e.dts&&(this.numSameDts_=0),this.numSameDts_++,this.latestDts_=e.dts}},xl.prototype.flush=function(){this.captionPackets_.length?(this.captionPackets_.forEach(function(e,t){e.presortIndex=t}),this.captionPackets_.sort(function(e,t){return e.pts===t.pts?e.presortIndex-t.presortIndex:e.pts-t.pts}),this.captionPackets_.forEach(function(e){e.type<2&&this.dispatchCea608Packet(e)},this),this.captionPackets_.length=0,this.ccStreams_.forEach(function(e){e.flush()},this)):this.ccStreams_.forEach(function(e){e.flush()},this)},xl.prototype.reset=function(){this.latestDts_=null,this.ignoreNextEqualDts_=!1,this.numSameDts_=0,this.activeCea608Channel_=[null,null],this.ccStreams_.forEach(function(e){e.reset()})},xl.prototype.dispatchCea608Packet=function(e){this.setsTextOrXDSActive(e)?this.activeCea608Channel_[e.type]=null:this.setsChannel1Active(e)?this.activeCea608Channel_[e.type]=0:this.setsChannel2Active(e)&&(this.activeCea608Channel_[e.type]=1),null!==this.activeCea608Channel_[e.type]&&this.ccStreams_[(e.type<<1)+this.activeCea608Channel_[e.type]].push(e)},xl.prototype.setsChannel1Active=function(e){return 4096==(30720&e.ccData)},xl.prototype.setsChannel2Active=function(e){return 6144==(30720&e.ccData)},xl.prototype.setsTextOrXDSActive=function(e){return 256==(28928&e.ccData)||4138==(30974&e.ccData)||6186==(30974&e.ccData)};var Al={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,304:174,305:176,306:189,307:191,308:8482,309:162,310:163,311:9834,312:224,313:160,314:232,315:226,316:234,317:238,318:244,319:251,544:193,545:201,546:211,547:218,548:220,549:252,550:8216,551:161,552:42,553:39,554:8212,555:169,556:8480,557:8226,558:8220,559:8221,560:192,561:194,562:199,563:200,564:202,565:203,566:235,567:206,568:207,569:239,570:212,571:217,572:249,573:219,574:171,575:187,800:195,801:227,802:205,803:204,804:236,805:210,806:242,807:213,808:245,809:123,810:125,811:92,812:94,813:95,814:124,815:126,816:196,817:228,818:214,819:246,820:223,821:165,822:164,823:9474,824:197,825:229,826:216,827:248,828:9484,829:9488,830:9492,831:9496},Pl=function(e){return null===e?"":(e=Al[e]||e,String.fromCharCode(e))},Ll=[4352,4384,4608,4640,5376,5408,5632,5664,5888,5920,4096,4864,4896,5120,5152],Nl=function(){for(var e=[],t=15;t--;)e.push("");return e},Ml=function e(t,n){e.prototype.init.call(this),this.field_=t||0,this.dataChannel_=n||0,this.name_="CC"+(1+(this.field_<<1|this.dataChannel_)),this.setConstants(),this.reset(),this.push=function(e){var t,n,i,r,a;if((t=32639&e.ccData)!==this.lastControlCode_){if(4096==(61440&t)?this.lastControlCode_=t:t!==this.PADDING_&&(this.lastControlCode_=null),i=t>>>8,r=255&t,t!==this.PADDING_)if(t===this.RESUME_CAPTION_LOADING_)this.mode_="popOn";else if(t===this.END_OF_CAPTION_)this.mode_="popOn",this.clearFormatting(e.pts),this.flushDisplayed(e.pts),n=this.displayed_,this.displayed_=this.nonDisplayed_,this.nonDisplayed_=n,this.startPts_=e.pts;else if(t===this.ROLL_UP_2_ROWS_)this.rollUpRows_=2,this.setRollUp(e.pts);else if(t===this.ROLL_UP_3_ROWS_)this.rollUpRows_=3,this.setRollUp(e.pts);else if(t===this.ROLL_UP_4_ROWS_)this.rollUpRows_=4,this.setRollUp(e.pts);else if(t===this.CARRIAGE_RETURN_)this.clearFormatting(e.pts),this.flushDisplayed(e.pts),this.shiftRowsUp_(),this.startPts_=e.pts;else if(t===this.BACKSPACE_)"popOn"===this.mode_?this.nonDisplayed_[this.row_]=this.nonDisplayed_[this.row_].slice(0,-1):this.displayed_[this.row_]=this.displayed_[this.row_].slice(0,-1);else if(t===this.ERASE_DISPLAYED_MEMORY_)this.flushDisplayed(e.pts),this.displayed_=Nl();else if(t===this.ERASE_NON_DISPLAYED_MEMORY_)this.nonDisplayed_=Nl();else if(t===this.RESUME_DIRECT_CAPTIONING_)"paintOn"!==this.mode_&&(this.flushDisplayed(e.pts),this.displayed_=Nl()),this.mode_="paintOn",this.startPts_=e.pts;else if(this.isSpecialCharacter(i,r))a=Pl((i=(3&i)<<8)|r),this[this.mode_](e.pts,a),this.column_++;else if(this.isExtCharacter(i,r))"popOn"===this.mode_?this.nonDisplayed_[this.row_]=this.nonDisplayed_[this.row_].slice(0,-1):this.displayed_[this.row_]=this.displayed_[this.row_].slice(0,-1),a=Pl((i=(3&i)<<8)|r),this[this.mode_](e.pts,a),this.column_++;else if(this.isMidRowCode(i,r))this.clearFormatting(e.pts),this[this.mode_](e.pts," "),this.column_++,14==(14&r)&&this.addFormatting(e.pts,["i"]),1==(1&r)&&this.addFormatting(e.pts,["u"]);else if(this.isOffsetControlCode(i,r))this.column_+=3&r;else if(this.isPAC(i,r)){var o=Ll.indexOf(7968&t);"rollUp"===this.mode_&&(o-this.rollUpRows_+1<0&&(o=this.rollUpRows_-1),this.setRollUp(e.pts,o)),o!==this.row_&&(this.clearFormatting(e.pts),this.row_=o),1&r&&-1===this.formatting_.indexOf("u")&&this.addFormatting(e.pts,["u"]),16==(16&t)&&(this.column_=4*((14&t)>>1)),this.isColorPAC(r)&&14==(14&r)&&this.addFormatting(e.pts,["i"])}else this.isNormalChar(i)&&(0===r&&(r=null),a=Pl(i),a+=Pl(r),this[this.mode_](e.pts,a),this.column_+=a.length)}else this.lastControlCode_=null}};Ml.prototype=new al,Ml.prototype.flushDisplayed=function(e){var t=this.displayed_.map(function(e){try{return e.trim()}catch(e){return console.error("Skipping malformed caption."),""}}).join("\n").replace(/^\n+|\n+$/g,"");t.length&&this.trigger("data",{startPts:this.startPts_,endPts:e,text:t,stream:this.name_})},Ml.prototype.reset=function(){this.mode_="popOn",this.topRow_=0,this.startPts_=0,this.displayed_=Nl(),this.nonDisplayed_=Nl(),this.lastControlCode_=null,this.column_=0,this.row_=14,this.rollUpRows_=2,this.formatting_=[]},Ml.prototype.setConstants=function(){0===this.dataChannel_?(this.BASE_=16,this.EXT_=17,this.CONTROL_=(20|this.field_)<<8,this.OFFSET_=23):1===this.dataChannel_&&(this.BASE_=24,this.EXT_=25,this.CONTROL_=(28|this.field_)<<8,this.OFFSET_=31),this.PADDING_=0,this.RESUME_CAPTION_LOADING_=32|this.CONTROL_,this.END_OF_CAPTION_=47|this.CONTROL_,this.ROLL_UP_2_ROWS_=37|this.CONTROL_,this.ROLL_UP_3_ROWS_=38|this.CONTROL_,this.ROLL_UP_4_ROWS_=39|this.CONTROL_,this.CARRIAGE_RETURN_=45|this.CONTROL_,this.RESUME_DIRECT_CAPTIONING_=41|this.CONTROL_,this.BACKSPACE_=33|this.CONTROL_,this.ERASE_DISPLAYED_MEMORY_=44|this.CONTROL_,this.ERASE_NON_DISPLAYED_MEMORY_=46|this.CONTROL_},Ml.prototype.isSpecialCharacter=function(e,t){return e===this.EXT_&&t>=48&&t<=63},Ml.prototype.isExtCharacter=function(e,t){return(e===this.EXT_+1||e===this.EXT_+2)&&t>=32&&t<=63},Ml.prototype.isMidRowCode=function(e,t){return e===this.EXT_&&t>=32&&t<=47},Ml.prototype.isOffsetControlCode=function(e,t){return e===this.OFFSET_&&t>=33&&t<=35},Ml.prototype.isPAC=function(e,t){return e>=this.BASE_&&e<this.BASE_+8&&t>=64&&t<=127},Ml.prototype.isColorPAC=function(e){return e>=64&&e<=79||e>=96&&e<=127},Ml.prototype.isNormalChar=function(e){return e>=32&&e<=127},Ml.prototype.setRollUp=function(e,t){if("rollUp"!==this.mode_&&(this.row_=14,this.mode_="rollUp",this.flushDisplayed(e),this.nonDisplayed_=Nl(),this.displayed_=Nl()),void 0!==t&&t!==this.row_)for(var n=0;n<this.rollUpRows_;n++)this.displayed_[t-n]=this.displayed_[this.row_-n],this.displayed_[this.row_-n]="";void 0===t&&(t=this.row_),this.topRow_=t-this.rollUpRows_+1},Ml.prototype.addFormatting=function(e,t){this.formatting_=this.formatting_.concat(t);var n=t.reduce(function(e,t){return e+"<"+t+">"},"");this[this.mode_](e,n)},Ml.prototype.clearFormatting=function(e){if(this.formatting_.length){var t=this.formatting_.reverse().reduce(function(e,t){return e+"</"+t+">"},"");this.formatting_=[],this[this.mode_](e,t)}},Ml.prototype.popOn=function(e,t){var n=this.nonDisplayed_[this.row_];n+=t,this.nonDisplayed_[this.row_]=n},Ml.prototype.rollUp=function(e,t){var n=this.displayed_[this.row_];n+=t,this.displayed_[this.row_]=n},Ml.prototype.shiftRowsUp_=function(){var e;for(e=0;e<this.topRow_;e++)this.displayed_[e]="";for(e=this.row_+1;e<15;e++)this.displayed_[e]="";for(e=this.topRow_;e<this.row_;e++)this.displayed_[e]=this.displayed_[e+1];this.displayed_[this.row_]=""},Ml.prototype.paintOn=function(e,t){var n=this.displayed_[this.row_];n+=t,this.displayed_[this.row_]=n};var Kl={CaptionStream:xl,Cea608Stream:Ml},$l={H264_STREAM_TYPE:27,ADTS_STREAM_TYPE:15,METADATA_STREAM_TYPE:21},jl=function(e,t){var n=1;for(e>t&&(n=-1);Math.abs(t-e)>4294967296;)e+=8589934592*n;return e},Bl=function e(t){var n,i;e.prototype.init.call(this),this.type_=t,this.push=function(e){e.type===this.type_&&(void 0===i&&(i=e.dts),e.dts=jl(e.dts,i),e.pts=jl(e.pts,i),n=e.dts,this.trigger("data",e))},this.flush=function(){i=n,this.trigger("done")},this.discontinuity=function(){i=void 0,n=void 0}};Bl.prototype=new al;var Fl,Ul=Bl,Vl=jl,ql=function(e,t,n){var i,r="";for(i=t;i<n;i++)r+="%"+("00"+e[i].toString(16)).slice(-2);return r},Hl=function(e,t,n){return decodeURIComponent(ql(e,t,n))},zl=function(e){return e[0]<<21|e[1]<<14|e[2]<<7|e[3]},Wl={TXXX:function(e){var t;if(3===e.data[0]){for(t=1;t<e.data.length;t++)if(0===e.data[t]){e.description=Hl(e.data,1,t),e.value=Hl(e.data,t+1,e.data.length).replace(/\0*$/,"");break}e.data=e.value}},WXXX:function(e){var t;if(3===e.data[0])for(t=1;t<e.data.length;t++)if(0===e.data[t]){e.description=Hl(e.data,1,t),e.url=Hl(e.data,t+1,e.data.length);break}},PRIV:function(e){var t,n;for(t=0;t<e.data.length;t++)if(0===e.data[t]){e.owner=(n=e.data,unescape(ql(n,start,end)));break}e.privateData=e.data.subarray(t+1),e.data=e.privateData}};(Fl=function(e){var t,n={debug:!(!e||!e.debug),descriptor:e&&e.descriptor},i=0,r=[],a=0;if(Fl.prototype.init.call(this),this.dispatchType=$l.METADATA_STREAM_TYPE.toString(16),n.descriptor)for(t=0;t<n.descriptor.length;t++)this.dispatchType+=("00"+n.descriptor[t].toString(16)).slice(-2);this.push=function(e){var t,o,s,l,u;if("timed-metadata"===e.type)if(e.dataAlignmentIndicator&&(a=0,r.length=0),0===r.length&&(e.data.length<10||e.data[0]!=="I".charCodeAt(0)||e.data[1]!=="D".charCodeAt(0)||e.data[2]!=="3".charCodeAt(0)))n.debug&&console.log("Skipping unrecognized metadata packet");else if(r.push(e),a+=e.data.byteLength,1===r.length&&(i=zl(e.data.subarray(6,10)),i+=10),!(a<i)){for(t={data:new Uint8Array(i),frames:[],pts:r[0].pts,dts:r[0].dts},u=0;u<i;)t.data.set(r[0].data.subarray(0,i-u),u),u+=r[0].data.byteLength,a-=r[0].data.byteLength,r.shift();o=10,64&t.data[5]&&(o+=4,o+=zl(t.data.subarray(10,14)),i-=zl(t.data.subarray(16,20)));do{if((s=zl(t.data.subarray(o+4,o+8)))<1)return console.log("Malformed ID3 frame encountered. Skipping metadata parsing.");if((l={id:String.fromCharCode(t.data[o],t.data[o+1],t.data[o+2],t.data[o+3]),data:t.data.subarray(o+10,o+s+10)}).key=l.id,Wl[l.id]&&(Wl[l.id](l),"com.apple.streaming.transportStreamTimestamp"===l.owner)){var c=l.data,d=(1&c[3])<<30|c[4]<<22|c[5]<<14|c[6]<<6|c[7]>>>2;d*=4,d+=3&c[7],l.timeStamp=d,void 0===t.pts&&void 0===t.dts&&(t.pts=l.timeStamp,t.dts=l.timeStamp),this.trigger("timestamp",l)}t.frames.push(l),o+=10,o+=s}while(o<i);this.trigger("data",t)}}}).prototype=new al;var Gl,Xl,Yl,Ql=Fl,Jl=Ul;(Gl=function(){var e=new Uint8Array(188),t=0;Gl.prototype.init.call(this),this.push=function(n){var i,r=0,a=188;for(t?((i=new Uint8Array(n.byteLength+t)).set(e.subarray(0,t)),i.set(n,t),t=0):i=n;a<i.byteLength;)71!==i[r]||71!==i[a]?(r++,a++):(this.trigger("data",i.subarray(r,a)),r+=188,a+=188);r<i.byteLength&&(e.set(i.subarray(r),0),t=i.byteLength-r)},this.flush=function(){188===t&&71===e[0]&&(this.trigger("data",e),t=0),this.trigger("done")}}).prototype=new al,(Xl=function(){var e,t,n,i;Xl.prototype.init.call(this),i=this,this.packetsWaitingForPmt=[],this.programMapTable=void 0,e=function(e,i){var r=0;i.payloadUnitStartIndicator&&(r+=e[r]+1),"pat"===i.type?t(e.subarray(r),i):n(e.subarray(r),i)},t=function(e,t){t.section_number=e[7],t.last_section_number=e[8],i.pmtPid=(31&e[10])<<8|e[11],t.pmtPid=i.pmtPid},n=function(e,t){var n,r;if(1&e[5]){for(i.programMapTable={video:null,audio:null,"timed-metadata":{}},n=3+((15&e[1])<<8|e[2])-4,r=12+((15&e[10])<<8|e[11]);r<n;){var a=e[r],o=(31&e[r+1])<<8|e[r+2];a===$l.H264_STREAM_TYPE&&null===i.programMapTable.video?i.programMapTable.video=o:a===$l.ADTS_STREAM_TYPE&&null===i.programMapTable.audio?i.programMapTable.audio=o:a===$l.METADATA_STREAM_TYPE&&(i.programMapTable["timed-metadata"][o]=a),r+=5+((15&e[r+3])<<8|e[r+4])}t.programMapTable=i.programMapTable}},this.push=function(t){var n={},i=4;if(n.payloadUnitStartIndicator=!!(64&t[1]),n.pid=31&t[1],n.pid<<=8,n.pid|=t[2],(48&t[3])>>>4>1&&(i+=t[i]+1),0===n.pid)n.type="pat",e(t.subarray(i),n),this.trigger("data",n);else if(n.pid===this.pmtPid)for(n.type="pmt",e(t.subarray(i),n),this.trigger("data",n);this.packetsWaitingForPmt.length;)this.processPes_.apply(this,this.packetsWaitingForPmt.shift());else void 0===this.programMapTable?this.packetsWaitingForPmt.push([t,i,n]):this.processPes_(t,i,n)},this.processPes_=function(e,t,n){n.pid===this.programMapTable.video?n.streamType=$l.H264_STREAM_TYPE:n.pid===this.programMapTable.audio?n.streamType=$l.ADTS_STREAM_TYPE:n.streamType=this.programMapTable["timed-metadata"][n.pid],n.type="pes",n.data=e.subarray(t),this.trigger("data",n)}}).prototype=new al,Xl.STREAM_TYPES={h264:27,adts:15},(Yl=function(){var e=this,t={data:[],size:0},n={data:[],size:0},i={data:[],size:0},r=function(t,n,i){var r,a,o,s,l=new Uint8Array(t.size),u={type:n},c=0,d=0,h=!1;if(t.data.length&&!(t.size<9)){for(u.trackId=t.data[0].pid,c=0;c<t.data.length;c++)r=t.data[c],l.set(r.data,d),d+=r.data.byteLength;a=l,(o=u).packetLength=6+(a[4]<<8|a[5]),o.dataAlignmentIndicator=0!=(4&a[6]),192&(s=a[7])&&(o.pts=(14&a[9])<<27|(255&a[10])<<20|(254&a[11])<<12|(255&a[12])<<5|(254&a[13])>>>3,o.pts*=4,o.pts+=(6&a[13])>>>1,o.dts=o.pts,64&s&&(o.dts=(14&a[14])<<27|(255&a[15])<<20|(254&a[16])<<12|(255&a[17])<<5|(254&a[18])>>>3,o.dts*=4,o.dts+=(6&a[18])>>>1)),o.data=a.subarray(9+a[8]),h="video"===n||u.packetLength<=t.size,(i||h)&&(t.size=0,t.data.length=0),h&&e.trigger("data",u)}};Yl.prototype.init.call(this),this.push=function(a){({pat:function(){},pes:function(){var e,o;switch(a.streamType){case $l.H264_STREAM_TYPE:case $l.H264_STREAM_TYPE:e=t,o="video";break;case $l.ADTS_STREAM_TYPE:e=n,o="audio";break;case $l.METADATA_STREAM_TYPE:e=i,o="timed-metadata";break;default:return}a.payloadUnitStartIndicator&&r(e,o,!0),e.data.push(a),e.size+=a.data.byteLength},pmt:function(){var t={type:"metadata",tracks:[]},n=a.programMapTable;null!==n.video&&t.tracks.push({timelineStartInfo:{baseMediaDecodeTime:0},id:+n.video,codec:"avc",type:"video"}),null!==n.audio&&t.tracks.push({timelineStartInfo:{baseMediaDecodeTime:0},id:+n.audio,codec:"adts",type:"audio"}),e.trigger("data",t)}})[a.type]()},this.flush=function(){r(t,"video"),r(n,"audio"),r(i,"timed-metadata"),this.trigger("done")}}).prototype=new al;var Zl={PAT_PID:0,MP2T_PACKET_LENGTH:188,TransportPacketStream:Gl,TransportParseStream:Xl,ElementaryStream:Yl,TimestampRolloverStream:Jl,CaptionStream:Kl.CaptionStream,Cea608Stream:Kl.Cea608Stream,MetadataStream:Ql};for(var eu in $l)$l.hasOwnProperty(eu)&&(Zl[eu]=$l[eu]);var tu,nu=Zl,iu=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350];(tu=function(){var e;tu.prototype.init.call(this),this.push=function(t){var n,i,r,a,o,s,l=0,u=0;if("audio"===t.type)for(e?(a=e,(e=new Uint8Array(a.byteLength+t.data.byteLength)).set(a),e.set(t.data,a.byteLength)):e=t.data;l+5<e.length;)if(255===e[l]&&240==(246&e[l+1])){if(i=2*(1&~e[l+1]),n=(3&e[l+3])<<11|e[l+4]<<3|(224&e[l+5])>>5,s=9e4*(o=1024*(1+(3&e[l+6])))/iu[(60&e[l+2])>>>2],r=l+n,e.byteLength<r)return;if(this.trigger("data",{pts:t.pts+u*s,dts:t.dts+u*s,sampleCount:o,audioobjecttype:1+(e[l+2]>>>6&3),channelcount:(1&e[l+2])<<2|(192&e[l+3])>>>6,samplerate:iu[(60&e[l+2])>>>2],samplingfrequencyindex:(60&e[l+2])>>>2,samplesize:16,data:e.subarray(l+7+i,r)}),e.byteLength===r)return void(e=void 0);u++,e=e.subarray(r)}else l++},this.flush=function(){this.trigger("done")}}).prototype=new al;var ru,au,ou,su=tu;(au=function(){var e,t,n=0;au.prototype.init.call(this),this.push=function(i){var r;for(t?((r=new Uint8Array(t.byteLength+i.data.byteLength)).set(t),r.set(i.data,t.byteLength),t=r):t=i.data;n<t.byteLength-3;n++)if(1===t[n+2]){e=n+5;break}for(;e<t.byteLength;)switch(t[e]){case 0:if(0!==t[e-1]){e+=2;break}if(0!==t[e-2]){e++;break}n+3!==e-2&&this.trigger("data",t.subarray(n+3,e-2));do{e++}while(1!==t[e]&&e<t.length);n=e-2,e+=3;break;case 1:if(0!==t[e-1]||0!==t[e-2]){e+=3;break}this.trigger("data",t.subarray(n+3,e-2)),n=e-2,e+=3;break;default:e+=3}t=t.subarray(n),e-=n,n=0},this.flush=function(){t&&t.byteLength>3&&this.trigger("data",t.subarray(n+3)),t=null,n=0,this.trigger("done")}}).prototype=new al,ou={100:!0,110:!0,122:!0,244:!0,44:!0,83:!0,86:!0,118:!0,128:!0,138:!0,139:!0,134:!0},(ru=function(){var e,t,n,i,r,a,o,s=new au;ru.prototype.init.call(this),e=this,this.push=function(e){"video"===e.type&&(t=e.trackId,n=e.pts,i=e.dts,s.push(e))},s.on("data",function(o){var s={trackId:t,pts:n,dts:i,data:o};switch(31&o[0]){case 5:s.nalUnitType="slice_layer_without_partitioning_rbsp_idr";break;case 6:s.nalUnitType="sei_rbsp",s.escapedRBSP=r(o.subarray(1));break;case 7:s.nalUnitType="seq_parameter_set_rbsp",s.escapedRBSP=r(o.subarray(1)),s.config=a(s.escapedRBSP);break;case 8:s.nalUnitType="pic_parameter_set_rbsp";break;case 9:s.nalUnitType="access_unit_delimiter_rbsp"}e.trigger("data",s)}),s.on("done",function(){e.trigger("done")}),this.flush=function(){s.flush()},o=function(e,t){var n,i=8,r=8;for(n=0;n<e;n++)0!==r&&(r=(i+t.readExpGolomb()+256)%256),i=0===r?i:r},r=function(e){for(var t,n,i=e.byteLength,r=[],a=1;a<i-2;)0===e[a]&&0===e[a+1]&&3===e[a+2]?(r.push(a+2),a+=2):a++;if(0===r.length)return e;t=i-r.length,n=new Uint8Array(t);var o=0;for(a=0;a<t;o++,a++)o===r[0]&&(o++,r.shift()),n[a]=e[o];return n},a=function(e){var t,n,i,r,a,s,l,u,c,d,h,p,f,g=0,m=0,v=0,y=0,b=1;if(t=new function(e){var t=e.byteLength,n=0,i=0;this.length=function(){return 8*t},this.bitsAvailable=function(){return 8*t+i},this.loadWord=function(){var r=e.byteLength-t,a=new Uint8Array(4),o=Math.min(4,t);if(0===o)throw new Error("no bytes available");a.set(e.subarray(r,r+o)),n=new DataView(a.buffer).getUint32(0),i=8*o,t-=o},this.skipBits=function(e){var r;i>e?(n<<=e,i-=e):(e-=i,e-=8*(r=Math.floor(e/8)),t-=r,this.loadWord(),n<<=e,i-=e)},this.readBits=function(e){var r=Math.min(i,e),a=n>>>32-r;return(i-=r)>0?n<<=r:t>0&&this.loadWord(),(r=e-r)>0?a<<r|this.readBits(r):a},this.skipLeadingZeros=function(){var e;for(e=0;e<i;++e)if(0!=(n&2147483648>>>e))return n<<=e,i-=e,e;return this.loadWord(),e+this.skipLeadingZeros()},this.skipUnsignedExpGolomb=function(){this.skipBits(1+this.skipLeadingZeros())},this.skipExpGolomb=function(){this.skipBits(1+this.skipLeadingZeros())},this.readUnsignedExpGolomb=function(){var e=this.skipLeadingZeros();return this.readBits(e+1)-1},this.readExpGolomb=function(){var e=this.readUnsignedExpGolomb();return 1&e?1+e>>>1:-1*(e>>>1)},this.readBoolean=function(){return 1===this.readBits(1)},this.readUnsignedByte=function(){return this.readBits(8)},this.loadWord()}(e),n=t.readUnsignedByte(),r=t.readUnsignedByte(),i=t.readUnsignedByte(),t.skipUnsignedExpGolomb(),ou[n]&&(3===(a=t.readUnsignedExpGolomb())&&t.skipBits(1),t.skipUnsignedExpGolomb(),t.skipUnsignedExpGolomb(),t.skipBits(1),t.readBoolean()))for(h=3!==a?8:12,f=0;f<h;f++)t.readBoolean()&&o(f<6?16:64,t);if(t.skipUnsignedExpGolomb(),0===(s=t.readUnsignedExpGolomb()))t.readUnsignedExpGolomb();else if(1===s)for(t.skipBits(1),t.skipExpGolomb(),t.skipExpGolomb(),l=t.readUnsignedExpGolomb(),f=0;f<l;f++)t.skipExpGolomb();if(t.skipUnsignedExpGolomb(),t.skipBits(1),u=t.readUnsignedExpGolomb(),c=t.readUnsignedExpGolomb(),0===(d=t.readBits(1))&&t.skipBits(1),t.skipBits(1),t.readBoolean()&&(g=t.readUnsignedExpGolomb(),m=t.readUnsignedExpGolomb(),v=t.readUnsignedExpGolomb(),y=t.readUnsignedExpGolomb()),t.readBoolean()&&t.readBoolean()){switch(t.readUnsignedByte()){case 1:p=[1,1];break;case 2:p=[12,11];break;case 3:p=[10,11];break;case 4:p=[16,11];break;case 5:p=[40,33];break;case 6:p=[24,11];break;case 7:p=[20,11];break;case 8:p=[32,11];break;case 9:p=[80,33];break;case 10:p=[18,11];break;case 11:p=[15,11];break;case 12:p=[64,33];break;case 13:p=[160,99];break;case 14:p=[4,3];break;case 15:p=[3,2];break;case 16:p=[2,1];break;case 255:p=[t.readUnsignedByte()<<8|t.readUnsignedByte(),t.readUnsignedByte()<<8|t.readUnsignedByte()]}p&&(b=p[0]/p[1])}return{profileIdc:n,levelIdc:i,profileCompatibility:r,width:Math.ceil((16*(u+1)-2*g-2*m)*b),height:(2-d)*(c+1)*16-2*v-2*y}}}).prototype=new al;var lu,uu={H264Stream:ru,NalByteStream:au},cu=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350],du=function(e){return e[0]<<21|e[1]<<14|e[2]<<7|e[3]},hu={isLikelyAacData:function(e){return e[0]==="I".charCodeAt(0)&&e[1]==="D".charCodeAt(0)&&e[2]==="3".charCodeAt(0)},parseId3TagSize:function(e,t){var n=e[t+6]<<21|e[t+7]<<14|e[t+8]<<7|e[t+9];return(16&e[t+5])>>4?n+20:n+10},parseAdtsSize:function(e,t){var n=(224&e[t+5])>>5,i=e[t+4]<<3;return 6144&e[t+3]|i|n},parseType:function(e,t){return e[t]==="I".charCodeAt(0)&&e[t+1]==="D".charCodeAt(0)&&e[t+2]==="3".charCodeAt(0)?"timed-metadata":!0&e[t]&&240==(240&e[t+1])?"audio":null},parseSampleRate:function(e){for(var t=0;t+5<e.length;){if(255===e[t]&&240==(246&e[t+1]))return cu[(60&e[t+2])>>>2];t++}return null},parseAacTimestamp:function(e){var t,n,i;t=10,64&e[5]&&(t+=4,t+=du(e.subarray(10,14)));do{if((n=du(e.subarray(t+4,t+8)))<1)return null;if("PRIV"===String.fromCharCode(e[t],e[t+1],e[t+2],e[t+3])){i=e.subarray(t+10,t+n+10);for(var r=0;r<i.byteLength;r++)if(0===i[r]){if("com.apple.streaming.transportStreamTimestamp"===unescape(function(e,t,n){var i,r="";for(i=t;i<n;i++)r+="%"+("00"+e[i].toString(16)).slice(-2);return r}(bytes,start,end))){var a=i.subarray(r+1),o=(1&a[3])<<30|a[4]<<22|a[5]<<14|a[6]<<6|a[7]>>>2;return(o*=4)+(3&a[7])}break}}t+=10,t+=n}while(t<e.byteLength);return null}};(lu=function(){var e=new Uint8Array,t=0;lu.prototype.init.call(this),this.setTimestamp=function(e){t=e},this.push=function(n){var i,r,a,o,s=0,l=0;for(e.length?(o=e.length,(e=new Uint8Array(n.byteLength+o)).set(e.subarray(0,o)),e.set(n,o)):e=n;e.length-l>=3;)if(e[l]!=="I".charCodeAt(0)||e[l+1]!=="D".charCodeAt(0)||e[l+2]!=="3".charCodeAt(0))if(255!=(255&e[l])||240!=(240&e[l+1]))l++;else{if(e.length-l<7)break;if(l+(s=hu.parseAdtsSize(e,l))>e.length)break;a={type:"audio",data:e.subarray(l,l+s),pts:t,dts:t},this.trigger("data",a),l+=s}else{if(e.length-l<10)break;if(l+(s=hu.parseId3TagSize(e,l))>e.length)break;r={type:"timed-metadata",data:e.subarray(l,l+s)},this.trigger("data",r),l+=s}i=e.length-l,e=i>0?e.subarray(l):new Uint8Array}}).prototype=new al;var pu,fu,gu,mu,vu=lu,yu=uu.H264Stream,bu=hu.isLikelyAacData,_u=["audioobjecttype","channelcount","samplerate","samplingfrequencyindex","samplesize"],Tu=["width","height","profileIdc","levelIdc","profileCompatibility"],Eu=function(e,t){var n;if(e.length!==t.length)return!1;for(n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0},Cu=function(e,t,n,i,r,a){return{start:{dts:e,pts:e+(n-t)},end:{dts:e+(i-t),pts:e+(r-n)},prependedContentDuration:a,baseMediaDecodeTime:e}};(fu=function(e,t){var n=[],i=0,r=0,a=0,o=1/0;t=t||{},fu.prototype.init.call(this),this.push=function(t){kl(e,t),e&&_u.forEach(function(n){e[n]=t[n]}),n.push(t)},this.setEarliestDts=function(t){r=t-e.timelineStartInfo.baseMediaDecodeTime},this.setVideoBaseMediaDecodeTime=function(e){o=e},this.setAudioAppendStart=function(e){a=e},this.flush=function(){var s,l,u,c;0!==n.length?(s=_l(n,e,r),e.baseMediaDecodeTime=wl(e,t.keepOriginalTimestamps),bl(e,s,a,o),e.samples=Tl(s),u=Js.mdat(El(s)),n=[],l=Js.moof(i,[e]),c=new Uint8Array(l.byteLength+u.byteLength),i++,c.set(l),c.set(u,l.byteLength),Cl(e),this.trigger("data",{track:e,boxes:c}),this.trigger("done","AudioSegmentStream")):this.trigger("done","AudioSegmentStream")}}).prototype=new al,(pu=function(e,t){var n,i,r=0,a=[],o=[];t=t||{},pu.prototype.init.call(this),delete e.minPTS,this.gopCache_=[],this.push=function(t){kl(e,t),"seq_parameter_set_rbsp"!==t.nalUnitType||n||(n=t.config,e.sps=[t.data],Tu.forEach(function(t){e[t]=n[t]},this)),"pic_parameter_set_rbsp"!==t.nalUnitType||i||(i=t.data,e.pps=[t.data]),a.push(t)},this.flush=function(){for(var n,i,s,l,u,c,d,h,p=0;a.length&&"access_unit_delimiter_rbsp"!==a[0].nalUnitType;)a.shift();if(0===a.length)return this.resetStream_(),void this.trigger("done","VideoSegmentStream");if(n=sl(a),(s=ll(n))[0][0].keyFrame||((i=this.getGopForFusion_(a[0],e))?(p=i.duration,s.unshift(i),s.byteLength+=i.byteLength,s.nalCount+=i.nalCount,s.pts=i.pts,s.dts=i.dts,s.duration+=i.duration):s=ul(s)),o.length){var f;if(!(f=t.alignGopsAtEnd?this.alignGopsAtEnd_(s):this.alignGopsAtStart_(s)))return this.gopCache_.unshift({gop:s.pop(),pps:e.pps,sps:e.sps}),this.gopCache_.length=Math.min(6,this.gopCache_.length),a=[],this.resetStream_(),void this.trigger("done","VideoSegmentStream");Cl(e),s=f}kl(e,s),e.samples=cl(s),u=Js.mdat(dl(s)),e.baseMediaDecodeTime=wl(e,t.keepOriginalTimestamps),this.trigger("processedGopsInfo",s.map(function(e){return{pts:e.pts,dts:e.dts,byteLength:e.byteLength}})),d=s[0],h=s[s.length-1],this.trigger("segmentTimingInfo",Cu(e.baseMediaDecodeTime,d.dts,d.pts,h.dts+h.duration,h.pts+h.duration,p)),this.gopCache_.unshift({gop:s.pop(),pps:e.pps,sps:e.sps}),this.gopCache_.length=Math.min(6,this.gopCache_.length),a=[],this.trigger("baseMediaDecodeTime",e.baseMediaDecodeTime),this.trigger("timelineStartInfo",e.timelineStartInfo),l=Js.moof(r,[e]),c=new Uint8Array(l.byteLength+u.byteLength),r++,c.set(l),c.set(u,l.byteLength),this.trigger("data",{track:e,boxes:c}),this.resetStream_(),this.trigger("done","VideoSegmentStream")},this.resetStream_=function(){Cl(e),n=void 0,i=void 0},this.getGopForFusion_=function(t){var n,i,r,a,o,s=1/0;for(o=0;o<this.gopCache_.length;o++)r=(a=this.gopCache_[o]).gop,e.pps&&Eu(e.pps[0],a.pps[0])&&e.sps&&Eu(e.sps[0],a.sps[0])&&(r.dts<e.timelineStartInfo.dts||(n=t.dts-r.dts-r.duration)>=-1e4&&n<=45e3&&(!i||s>n)&&(i=a,s=n));return i?i.gop:null},this.alignGopsAtStart_=function(e){var t,n,i,r,a,s,l,u;for(a=e.byteLength,s=e.nalCount,l=e.duration,t=n=0;t<o.length&&n<e.length&&(i=o[t],r=e[n],i.pts!==r.pts);)r.pts>i.pts?t++:(n++,a-=r.byteLength,s-=r.nalCount,l-=r.duration);return 0===n?e:n===e.length?null:((u=e.slice(n)).byteLength=a,u.duration=l,u.nalCount=s,u.pts=u[0].pts,u.dts=u[0].dts,u)},this.alignGopsAtEnd_=function(e){var t,n,i,r,a,s,l;for(t=o.length-1,n=e.length-1,a=null,s=!1;t>=0&&n>=0;){if(i=o[t],r=e[n],i.pts===r.pts){s=!0;break}i.pts>r.pts?t--:(t===o.length-1&&(a=n),n--)}if(!s&&null===a)return null;if(0===(l=s?n:a))return e;var u=e.slice(l),c=u.reduce(function(e,t){return e.byteLength+=t.byteLength,e.duration+=t.duration,e.nalCount+=t.nalCount,e},{byteLength:0,duration:0,nalCount:0});return u.byteLength=c.byteLength,u.duration=c.duration,u.nalCount=c.nalCount,u.pts=u[0].pts,u.dts=u[0].dts,u},this.alignGopsWith=function(e){o=e}}).prototype=new al,(mu=function(e,t){this.numberOfTracks=0,this.metadataStream=t,void 0!==(e=e||{}).remux?this.remuxTracks=!!e.remux:this.remuxTracks=!0,"boolean"==typeof e.keepOriginalTimestamps&&(this.keepOriginalTimestamps=e.keepOriginalTimestamps),this.pendingTracks=[],this.videoTrack=null,this.pendingBoxes=[],this.pendingCaptions=[],this.pendingMetadata=[],this.pendingBytes=0,this.emittedTracks=0,mu.prototype.init.call(this),this.push=function(e){return e.text?this.pendingCaptions.push(e):e.frames?this.pendingMetadata.push(e):(this.pendingTracks.push(e.track),this.pendingBoxes.push(e.boxes),this.pendingBytes+=e.boxes.byteLength,"video"===e.track.type&&(this.videoTrack=e.track),void("audio"===e.track.type&&(this.audioTrack=e.track)))}}).prototype=new al,mu.prototype.flush=function(e){var t,n,i,r,a=0,o={captions:[],captionStreams:{},metadata:[],info:{}},s=0;if(this.pendingTracks.length<this.numberOfTracks){if("VideoSegmentStream"!==e&&"AudioSegmentStream"!==e)return;if(this.remuxTracks)return;if(0===this.pendingTracks.length)return this.emittedTracks++,void(this.emittedTracks>=this.numberOfTracks&&(this.trigger("done"),this.emittedTracks=0))}for(this.videoTrack?(s=this.videoTrack.timelineStartInfo.pts,Tu.forEach(function(e){o.info[e]=this.videoTrack[e]},this)):this.audioTrack&&(s=this.audioTrack.timelineStartInfo.pts,_u.forEach(function(e){o.info[e]=this.audioTrack[e]},this)),1===this.pendingTracks.length?o.type=this.pendingTracks[0].type:o.type="combined",this.emittedTracks+=this.pendingTracks.length,i=Js.initSegment(this.pendingTracks),o.initSegment=new Uint8Array(i.byteLength),o.initSegment.set(i),o.data=new Uint8Array(this.pendingBytes),r=0;r<this.pendingBoxes.length;r++)o.data.set(this.pendingBoxes[r],a),a+=this.pendingBoxes[r].byteLength;for(r=0;r<this.pendingCaptions.length;r++)(t=this.pendingCaptions[r]).startTime=t.startPts,this.keepOriginalTimestamps||(t.startTime-=s),t.startTime/=9e4,t.endTime=t.endPts,this.keepOriginalTimestamps||(t.endTime-=s),t.endTime/=9e4,o.captionStreams[t.stream]=!0,o.captions.push(t);for(r=0;r<this.pendingMetadata.length;r++)(n=this.pendingMetadata[r]).cueTime=n.pts,this.keepOriginalTimestamps||(n.cueTime-=s),n.cueTime/=9e4,o.metadata.push(n);o.metadata.dispatchType=this.metadataStream.dispatchType,this.pendingTracks.length=0,this.videoTrack=null,this.pendingBoxes.length=0,this.pendingCaptions.length=0,this.pendingBytes=0,this.pendingMetadata.length=0,this.trigger("data",o),this.emittedTracks>=this.numberOfTracks&&(this.trigger("done"),this.emittedTracks=0)},(gu=function(e){var t,n,i=this,r=!0;gu.prototype.init.call(this),e=e||{},this.baseMediaDecodeTime=e.baseMediaDecodeTime||0,this.transmuxPipeline_={},this.setupAacPipeline=function(){var t={};this.transmuxPipeline_=t,t.type="aac",t.metadataStream=new nu.MetadataStream,t.aacStream=new vu,t.audioTimestampRolloverStream=new nu.TimestampRolloverStream("audio"),t.timedMetadataTimestampRolloverStream=new nu.TimestampRolloverStream("timed-metadata"),t.adtsStream=new su,t.coalesceStream=new mu(e,t.metadataStream),t.headOfPipeline=t.aacStream,t.aacStream.pipe(t.audioTimestampRolloverStream).pipe(t.adtsStream),t.aacStream.pipe(t.timedMetadataTimestampRolloverStream).pipe(t.metadataStream).pipe(t.coalesceStream),t.metadataStream.on("timestamp",function(e){t.aacStream.setTimestamp(e.timeStamp)}),t.aacStream.on("data",function(r){"timed-metadata"!==r.type||t.audioSegmentStream||(n=n||{timelineStartInfo:{baseMediaDecodeTime:i.baseMediaDecodeTime},codec:"adts",type:"audio"},t.coalesceStream.numberOfTracks++,t.audioSegmentStream=new fu(n,e),t.adtsStream.pipe(t.audioSegmentStream).pipe(t.coalesceStream))}),t.coalesceStream.on("data",this.trigger.bind(this,"data")),t.coalesceStream.on("done",this.trigger.bind(this,"done"))},this.setupTsPipeline=function(){var r={};this.transmuxPipeline_=r,r.type="ts",r.metadataStream=new nu.MetadataStream,r.packetStream=new nu.TransportPacketStream,r.parseStream=new nu.TransportParseStream,r.elementaryStream=new nu.ElementaryStream,r.videoTimestampRolloverStream=new nu.TimestampRolloverStream("video"),r.audioTimestampRolloverStream=new nu.TimestampRolloverStream("audio"),r.timedMetadataTimestampRolloverStream=new nu.TimestampRolloverStream("timed-metadata"),r.adtsStream=new su,r.h264Stream=new yu,r.captionStream=new nu.CaptionStream,r.coalesceStream=new mu(e,r.metadataStream),r.headOfPipeline=r.packetStream,r.packetStream.pipe(r.parseStream).pipe(r.elementaryStream),r.elementaryStream.pipe(r.videoTimestampRolloverStream).pipe(r.h264Stream),r.elementaryStream.pipe(r.audioTimestampRolloverStream).pipe(r.adtsStream),r.elementaryStream.pipe(r.timedMetadataTimestampRolloverStream).pipe(r.metadataStream).pipe(r.coalesceStream),r.h264Stream.pipe(r.captionStream).pipe(r.coalesceStream),r.elementaryStream.on("data",function(a){var o;if("metadata"===a.type){for(o=a.tracks.length;o--;)t||"video"!==a.tracks[o].type?n||"audio"!==a.tracks[o].type||((n=a.tracks[o]).timelineStartInfo.baseMediaDecodeTime=i.baseMediaDecodeTime):(t=a.tracks[o]).timelineStartInfo.baseMediaDecodeTime=i.baseMediaDecodeTime;t&&!r.videoSegmentStream&&(r.coalesceStream.numberOfTracks++,r.videoSegmentStream=new pu(t,e),r.videoSegmentStream.on("timelineStartInfo",function(e){n&&(n.timelineStartInfo=e,r.audioSegmentStream.setEarliestDts(e.dts))}),r.videoSegmentStream.on("processedGopsInfo",i.trigger.bind(i,"gopInfo")),r.videoSegmentStream.on("segmentTimingInfo",i.trigger.bind(i,"videoSegmentTimingInfo")),r.videoSegmentStream.on("baseMediaDecodeTime",function(e){n&&r.audioSegmentStream.setVideoBaseMediaDecodeTime(e)}),r.h264Stream.pipe(r.videoSegmentStream).pipe(r.coalesceStream)),n&&!r.audioSegmentStream&&(r.coalesceStream.numberOfTracks++,r.audioSegmentStream=new fu(n,e),r.adtsStream.pipe(r.audioSegmentStream).pipe(r.coalesceStream))}}),r.coalesceStream.on("data",this.trigger.bind(this,"data")),r.coalesceStream.on("done",this.trigger.bind(this,"done"))},this.setBaseMediaDecodeTime=function(i){var r=this.transmuxPipeline_;e.keepOriginalTimestamps||(this.baseMediaDecodeTime=i),n&&(n.timelineStartInfo.dts=void 0,n.timelineStartInfo.pts=void 0,Cl(n),e.keepOriginalTimestamps||(n.timelineStartInfo.baseMediaDecodeTime=i),r.audioTimestampRolloverStream&&r.audioTimestampRolloverStream.discontinuity()),t&&(r.videoSegmentStream&&(r.videoSegmentStream.gopCache_=[],r.videoTimestampRolloverStream.discontinuity()),t.timelineStartInfo.dts=void 0,t.timelineStartInfo.pts=void 0,Cl(t),r.captionStream.reset(),e.keepOriginalTimestamps||(t.timelineStartInfo.baseMediaDecodeTime=i)),r.timedMetadataTimestampRolloverStream&&r.timedMetadataTimestampRolloverStream.discontinuity()},this.setAudioAppendStart=function(e){n&&this.transmuxPipeline_.audioSegmentStream.setAudioAppendStart(e)},this.alignGopsWith=function(e){t&&this.transmuxPipeline_.videoSegmentStream&&this.transmuxPipeline_.videoSegmentStream.alignGopsWith(e)},this.push=function(e){if(r){var t=bu(e);t&&"aac"!==this.transmuxPipeline_.type?this.setupAacPipeline():t||"ts"===this.transmuxPipeline_.type||this.setupTsPipeline(),r=!1}this.transmuxPipeline_.headOfPipeline.push(e)},this.flush=function(){r=!0,this.transmuxPipeline_.headOfPipeline.flush()},this.resetCaptions=function(){this.transmuxPipeline_.captionStream&&this.transmuxPipeline_.captionStream.reset()}}).prototype=new al;var wu=Dl,ku=Kl.CaptionStream,Su=function(e,t){for(var n=e,i=0;i<t.length;i++){var r=t[i];if(n<r.size)return r;n-=r.size}return null},Iu={generator:Js,probe:Hs,Transmuxer:gu,AudioSegmentStream:fu,VideoSegmentStream:pu,CaptionParser:function(){var e,t,n,i,r,a=!1;this.isInitialized=function(){return a},this.init=function(){e=new ku,a=!0,e.on("data",function(e){e.startTime=e.startPts/i,e.endTime=e.endPts/i,r.captions.push(e),r.captionStreams[e.stream]=!0})},this.isNewInit=function(e,t){return!(e&&0===e.length||t&&"object"==typeof t&&0===Object.keys(t).length||n===e[0]&&i===t[n])},this.parse=function(e,a,o){var s;if(!this.isInitialized())return null;if(!a||!o)return null;if(this.isNewInit(a,o))n=a[0],i=o[n];else if(!n||!i)return t.push(e),null;for(;t.length>0;){var l=t.shift();this.parse(l,a,o)}return null!==(s=function(e,t,n){return t?{seiNals:function(e,t){var n=Hs.findBox(e,["moof","traf"]),i={},r=[];return Hs.findBox(e,["mdat"]).forEach(function(e,t){var i=n[t];r.push({mdat:e,traf:i})}),r.forEach(function(e){var n,r,a=e.mdat,o=e.traf,s=Hs.findBox(o,["tfhd"]),l=Ys.parseTfhd(s[0]),u=l.trackId,c=Hs.findBox(o,["tfdt"]),d=c.length>0?Ys.parseTfdt(c[0]).baseMediaDecodeTime:0,h=Hs.findBox(o,["trun"]);t===u&&h.length>0&&(n=function(e,t,n){var i=d,r=n.defaultSampleDuration||0,a=n.defaultSampleSize||0,o=n.trackId,s=[];return e.forEach(function(e){var t=Ys.parseTrun(e).samples;t.forEach(function(e){void 0===e.duration&&(e.duration=r),void 0===e.size&&(e.size=a),e.trackId=o,e.dts=i,void 0===e.compositionTimeOffset&&(e.compositionTimeOffset=0),e.pts=i+e.compositionTimeOffset,i+=e.duration}),s=s.concat(t)}),s}(h,0,l),r=function(e,t,n){var i,r,a,o,s=new DataView(e.buffer,e.byteOffset,e.byteLength),l=[];for(r=0;r+4<e.length;r+=a)if(a=s.getUint32(r),r+=4,!(a<=0))switch(31&e[r]){case 6:var u=e.subarray(r+1,r+1+a),c=Su(r,t);i={nalUnitType:"sei_rbsp",size:a,data:u,escapedRBSP:wu(u),trackId:n},c?(i.pts=c.pts,i.dts=c.dts,o=c):(i.pts=o.pts,i.dts=o.dts),l.push(i)}return l}(a,n,u),i[u]||(i[u]=[]),i[u]=i[u].concat(r))}),i}(e,t)[t],timescale:n}:null}(e,n,i))&&s.seiNals?(this.pushNals(s.seiNals),this.flushStream(),r):null},this.pushNals=function(t){if(!this.isInitialized()||!t||0===t.length)return null;t.forEach(function(t){e.push(t)})},this.flushStream=function(){if(!this.isInitialized())return null;e.flush()},this.clearParsedCaptions=function(){r.captions=[],r.captionStreams={}},this.resetCaptionStream=function(){if(!this.isInitialized())return null;e.reset()},this.clearAllCaptions=function(){this.clearParsedCaptions(),this.resetCaptionStream()},this.reset=function(){t=[],n=null,i=null,r?this.clearParsedCaptions():r={captions:[],captionStreams:{}},this.resetCaptionStream()},this.reset()}}.CaptionParser,Ou=function(e){var t=31&e[1];return(t<<=8)|e[2]},Du=function(e){return!!(64&e[1])},Ru=function(e){var t=0;return(48&e[3])>>>4>1&&(t+=e[4]+1),t},xu=function(e){switch(e){case 5:return"slice_layer_without_partitioning_rbsp_idr";case 6:return"sei_rbsp";case 7:return"seq_parameter_set_rbsp";case 8:return"pic_parameter_set_rbsp";case 9:return"access_unit_delimiter_rbsp";default:return null}},Au={parseType:function(e,t){var n=Ou(e);return 0===n?"pat":n===t?"pmt":t?"pes":null},parsePat:function(e){var t=Du(e),n=4+Ru(e);return t&&(n+=e[n]+1),(31&e[n+10])<<8|e[n+11]},parsePmt:function(e){var t={},n=Du(e),i=4+Ru(e);if(n&&(i+=e[i]+1),1&e[i+5]){var r;r=3+((15&e[i+1])<<8|e[i+2])-4;for(var a=12+((15&e[i+10])<<8|e[i+11]);a<r;){var o=i+a;t[(31&e[o+1])<<8|e[o+2]]=e[o],a+=5+((15&e[o+3])<<8|e[o+4])}return t}},parsePayloadUnitStartIndicator:Du,parsePesType:function(e,t){switch(t[Ou(e)]){case $l.H264_STREAM_TYPE:return"video";case $l.ADTS_STREAM_TYPE:return"audio";case $l.METADATA_STREAM_TYPE:return"timed-metadata";default:return null}},parsePesTime:function(e){if(!Du(e))return null;var t=4+Ru(e);if(t>=e.byteLength)return null;var n,i=null;return 192&(n=e[t+7])&&((i={}).pts=(14&e[t+9])<<27|(255&e[t+10])<<20|(254&e[t+11])<<12|(255&e[t+12])<<5|(254&e[t+13])>>>3,i.pts*=4,i.pts+=(6&e[t+13])>>>1,i.dts=i.pts,64&n&&(i.dts=(14&e[t+14])<<27|(255&e[t+15])<<20|(254&e[t+16])<<12|(255&e[t+17])<<5|(254&e[t+18])>>>3,i.dts*=4,i.dts+=(6&e[t+18])>>>1)),i},videoPacketContainsKeyFrame:function(e){for(var t=4+Ru(e),n=e.subarray(t),i=0,r=0,a=!1;r<n.byteLength-3;r++)if(1===n[r+2]){i=r+5;break}for(;i<n.byteLength;)switch(n[i]){case 0:if(0!==n[i-1]){i+=2;break}if(0!==n[i-2]){i++;break}r+3!==i-2&&"slice_layer_without_partitioning_rbsp_idr"===xu(31&n[r+3])&&(a=!0);do{i++}while(1!==n[i]&&i<n.length);r=i-2,i+=3;break;case 1:if(0!==n[i-1]||0!==n[i-2]){i+=3;break}"slice_layer_without_partitioning_rbsp_idr"===xu(31&n[r+3])&&(a=!0),r=i-2,i+=3;break;default:i+=3}return n=n.subarray(r),i-=r,r=0,n&&n.byteLength>3&&"slice_layer_without_partitioning_rbsp_idr"===xu(31&n[r+3])&&(a=!0),a}},Pu=Vl,Lu={};Lu.ts=Au,Lu.aac=hu;var Nu=function(e,t,n){for(var i,r,a,o,s=0,l=188,u=!1;l<=e.byteLength;)if(71!==e[s]||71!==e[l]&&l!==e.byteLength)s++,l++;else{switch(i=e.subarray(s,l),Lu.ts.parseType(i,t.pid)){case"pes":r=Lu.ts.parsePesType(i,t.table),a=Lu.ts.parsePayloadUnitStartIndicator(i),"audio"===r&&a&&(o=Lu.ts.parsePesTime(i))&&(o.type="audio",n.audio.push(o),u=!0)}if(u)break;s+=188,l+=188}for(s=(l=e.byteLength)-188,u=!1;s>=0;)if(71!==e[s]||71!==e[l]&&l!==e.byteLength)s--,l--;else{switch(i=e.subarray(s,l),Lu.ts.parseType(i,t.pid)){case"pes":r=Lu.ts.parsePesType(i,t.table),a=Lu.ts.parsePayloadUnitStartIndicator(i),"audio"===r&&a&&(o=Lu.ts.parsePesTime(i))&&(o.type="audio",n.audio.push(o),u=!0)}if(u)break;s-=188,l-=188}},Mu=function(e,t,n){for(var i,r,a,o,s,l,u,c=0,d=188,h=!1,p={data:[],size:0};d<e.byteLength;)if(71!==e[c]||71!==e[d])c++,d++;else{switch(i=e.subarray(c,d),Lu.ts.parseType(i,t.pid)){case"pes":if(r=Lu.ts.parsePesType(i,t.table),a=Lu.ts.parsePayloadUnitStartIndicator(i),"video"===r&&(a&&!h&&(o=Lu.ts.parsePesTime(i))&&(o.type="video",n.video.push(o),h=!0),!n.firstKeyFrame)){if(a&&0!==p.size){for(s=new Uint8Array(p.size),l=0;p.data.length;)u=p.data.shift(),s.set(u,l),l+=u.byteLength;if(Lu.ts.videoPacketContainsKeyFrame(s)){var f=Lu.ts.parsePesTime(s);f?(n.firstKeyFrame=f,n.firstKeyFrame.type="video"):console.warn("Failed to extract PTS/DTS from PES at first keyframe. This could be an unusual TS segment, or else mux.js did not parse your TS segment correctly. If you know your TS segments do contain PTS/DTS on keyframes please file a bug report! You can try ffprobe to double check for yourself.")}p.size=0}p.data.push(i),p.size+=i.byteLength}}if(h&&n.firstKeyFrame)break;c+=188,d+=188}for(c=(d=e.byteLength)-188,h=!1;c>=0;)if(71!==e[c]||71!==e[d])c--,d--;else{switch(i=e.subarray(c,d),Lu.ts.parseType(i,t.pid)){case"pes":r=Lu.ts.parsePesType(i,t.table),a=Lu.ts.parsePayloadUnitStartIndicator(i),"video"===r&&a&&(o=Lu.ts.parsePesTime(i))&&(o.type="video",n.video.push(o),h=!0)}if(h)break;c-=188,d-=188}},Ku=function(e,t){var n;return(n=Lu.aac.isLikelyAacData(e)?function(e){for(var t,n=!1,i=0,r=null,a=null,o=0,s=0;e.length-s>=3;){switch(Lu.aac.parseType(e,s)){case"timed-metadata":if(e.length-s<10){n=!0;break}if((o=Lu.aac.parseId3TagSize(e,s))>e.length){n=!0;break}null===a&&(t=e.subarray(s,s+o),a=Lu.aac.parseAacTimestamp(t)),s+=o;break;case"audio":if(e.length-s<7){n=!0;break}if((o=Lu.aac.parseAdtsSize(e,s))>e.length){n=!0;break}null===r&&(t=e.subarray(s,s+o),r=Lu.aac.parseSampleRate(t)),i++,s+=o;break;default:s++}if(n)return null}if(null===r||null===a)return null;var l=9e4/r;return{audio:[{type:"audio",dts:a,pts:a},{type:"audio",dts:a+1024*i*l,pts:a+1024*i*l}]}}(e):function(e){var t={pid:null,table:null},n={};for(var i in function(e,t){for(var n,i=0,r=188;r<e.byteLength;)if(71!==e[i]||71!==e[r])i++,r++;else{switch(n=e.subarray(i,r),Lu.ts.parseType(n,t.pid)){case"pat":t.pid||(t.pid=Lu.ts.parsePat(n));break;case"pmt":t.table||(t.table=Lu.ts.parsePmt(n))}if(t.pid&&t.table)return;i+=188,r+=188}}(e,t),t.table)if(t.table.hasOwnProperty(i))switch(t.table[i]){case $l.H264_STREAM_TYPE:n.video=[],Mu(e,t,n),0===n.video.length&&delete n.video;break;case $l.ADTS_STREAM_TYPE:n.audio=[],Nu(e,t,n),0===n.audio.length&&delete n.audio}return n}(e))&&(n.audio||n.video)?(function(e,t){if(e.audio&&e.audio.length){var n=t;void 0===n&&(n=e.audio[0].dts),e.audio.forEach(function(e){e.dts=Pu(e.dts,n),e.pts=Pu(e.pts,n),e.dtsTime=e.dts/9e4,e.ptsTime=e.pts/9e4})}if(e.video&&e.video.length){var i=t;if(void 0===i&&(i=e.video[0].dts),e.video.forEach(function(e){e.dts=Pu(e.dts,i),e.pts=Pu(e.pts,i),e.dtsTime=e.dts/9e4,e.ptsTime=e.pts/9e4}),e.firstKeyFrame){var r=e.firstKeyFrame;r.dts=Pu(r.dts,i),r.pts=Pu(r.pts,i),r.dtsTime=r.dts/9e4,r.ptsTime=r.dts/9e4}}}(n,t),n):null},$u=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},ju=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),Bu=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t},Fu=function(){var e=[[[],[],[],[],[]],[[],[],[],[],[]]],t=e[0],n=e[1],i=t[4],r=n[4],a=void 0,o=void 0,s=void 0,l=[],u=[],c=void 0,d=void 0,h=void 0,p=void 0,f=void 0;for(a=0;a<256;a++)u[(l[a]=a<<1^283*(a>>7))^a]=a;for(o=s=0;!i[o];o^=c||1,s=u[s]||1)for(h=(h=s^s<<1^s<<2^s<<3^s<<4)>>8^255&h^99,i[o]=h,r[h]=o,f=16843009*l[d=l[c=l[o]]]^65537*d^257*c^16843008*o,p=257*l[h]^16843008*h,a=0;a<4;a++)t[a][o]=p=p<<24^p>>>8,n[a][h]=f=f<<24^f>>>8;for(a=0;a<5;a++)t[a]=t[a].slice(0),n[a]=n[a].slice(0);return e},Uu=null,Vu=function(){function e(t){$u(this,e),Uu||(Uu=Fu()),this._tables=[[Uu[0][0].slice(),Uu[0][1].slice(),Uu[0][2].slice(),Uu[0][3].slice(),Uu[0][4].slice()],[Uu[1][0].slice(),Uu[1][1].slice(),Uu[1][2].slice(),Uu[1][3].slice(),Uu[1][4].slice()]];var n=void 0,i=void 0,r=void 0,a=void 0,o=void 0,s=this._tables[0][4],l=this._tables[1],u=t.length,c=1;if(4!==u&&6!==u&&8!==u)throw new Error("Invalid aes key size");for(a=t.slice(0),o=[],this._key=[a,o],n=u;n<4*u+28;n++)r=a[n-1],(n%u==0||8===u&&n%u==4)&&(r=s[r>>>24]<<24^s[r>>16&255]<<16^s[r>>8&255]<<8^s[255&r],n%u==0&&(r=r<<8^r>>>24^c<<24,c=c<<1^283*(c>>7))),a[n]=a[n-u]^r;for(i=0;n;i++,n--)r=a[3&i?n:n-4],o[i]=n<=4||i<4?r:l[0][s[r>>>24]]^l[1][s[r>>16&255]]^l[2][s[r>>8&255]]^l[3][s[255&r]]}return e.prototype.decrypt=function(e,t,n,i,r,a){var o=this._key[1],s=e^o[0],l=i^o[1],u=n^o[2],c=t^o[3],d=void 0,h=void 0,p=void 0,f=o.length/4-2,g=void 0,m=4,v=this._tables[1],y=v[0],b=v[1],_=v[2],T=v[3],E=v[4];for(g=0;g<f;g++)d=y[s>>>24]^b[l>>16&255]^_[u>>8&255]^T[255&c]^o[m],h=y[l>>>24]^b[u>>16&255]^_[c>>8&255]^T[255&s]^o[m+1],p=y[u>>>24]^b[c>>16&255]^_[s>>8&255]^T[255&l]^o[m+2],c=y[c>>>24]^b[s>>16&255]^_[l>>8&255]^T[255&u]^o[m+3],m+=4,s=d,l=h,u=p;for(g=0;g<4;g++)r[(3&-g)+a]=E[s>>>24]<<24^E[l>>16&255]<<16^E[u>>8&255]<<8^E[255&c]^o[m++],d=s,s=l,l=u,u=c,c=d},e}(),qu=function(){function e(){$u(this,e),this.listeners={}}return e.prototype.on=function(e,t){this.listeners[e]||(this.listeners[e]=[]),this.listeners[e].push(t)},e.prototype.off=function(e,t){if(!this.listeners[e])return!1;var n=this.listeners[e].indexOf(t);return this.listeners[e].splice(n,1),n>-1},e.prototype.trigger=function(e){var t=this.listeners[e];if(t)if(2===arguments.length)for(var n=t.length,i=0;i<n;++i)t[i].call(this,arguments[1]);else for(var r=Array.prototype.slice.call(arguments,1),a=t.length,o=0;o<a;++o)t[o].apply(this,r)},e.prototype.dispose=function(){this.listeners={}},e.prototype.pipe=function(e){this.on("data",function(t){e.push(t)})},e}(),Hu=function(e){function t(){$u(this,t);var n=Bu(this,e.call(this,qu));return n.jobs=[],n.delay=1,n.timeout_=null,n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t.prototype.processJob_=function(){this.jobs.shift()(),this.jobs.length?this.timeout_=setTimeout(this.processJob_.bind(this),this.delay):this.timeout_=null},t.prototype.push=function(e){this.jobs.push(e),this.timeout_||(this.timeout_=setTimeout(this.processJob_.bind(this),this.delay))},t}(qu),zu=function(e){return e<<24|(65280&e)<<8|(16711680&e)>>8|e>>>24},Wu=function(e,t,n){var i=new Int32Array(e.buffer,e.byteOffset,e.byteLength>>2),r=new Vu(Array.prototype.slice.call(t)),a=new Uint8Array(e.byteLength),o=new Int32Array(a.buffer),s=void 0,l=void 0,u=void 0,c=void 0,d=void 0,h=void 0,p=void 0,f=void 0,g=void 0;for(s=n[0],l=n[1],u=n[2],c=n[3],g=0;g<i.length;g+=4)d=zu(i[g]),h=zu(i[g+1]),p=zu(i[g+2]),f=zu(i[g+3]),r.decrypt(d,h,p,f,o,g),o[g]=zu(o[g]^s),o[g+1]=zu(o[g+1]^l),o[g+2]=zu(o[g+2]^u),o[g+3]=zu(o[g+3]^c),s=d,l=h,u=p,c=f;return a},Gu=function(){function e(t,n,i,r){$u(this,e);var a=e.STEP,o=new Int32Array(t.buffer),s=new Uint8Array(t.byteLength),l=0;for(this.asyncStream_=new Hu,this.asyncStream_.push(this.decryptChunk_(o.subarray(l,l+a),n,i,s)),l=a;l<o.length;l+=a)i=new Uint32Array([zu(o[l-4]),zu(o[l-3]),zu(o[l-2]),zu(o[l-1])]),this.asyncStream_.push(this.decryptChunk_(o.subarray(l,l+a),n,i,s));this.asyncStream_.push(function(){var e;r(null,(e=s).subarray(0,e.byteLength-e[e.byteLength-1]))})}return e.prototype.decryptChunk_=function(e,t,n,i){return function(){var r=Wu(e,t,n);i.set(r,e.byteOffset)}},ju(e,null,[{key:"STEP",get:function(){return 32e3}}]),e}(),Xu=function(t,n){return/^[a-z]+:/i.test(n)?n:(/\/\//i.test(t)||(t=ro.buildAbsoluteURL(e.location.href,t)),ro.buildAbsoluteURL(t,n))},Yu=function(e,t,n){return e&&n.responseURL&&t!==n.responseURL?n.responseURL:t},Qu=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},Ju=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),Zu=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)},ec=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t},tc=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],i=!0,r=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(i=(o=s.next()).done)&&(n.push(o.value),!t||n.length!==t);i=!0);}catch(e){r=!0,a=e}finally{try{!i&&s.return&&s.return()}finally{if(r)throw a}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")},nc=to.mergeOptions,ic=to.EventTarget,rc=to.log,ac=function(e,t){["AUDIO","SUBTITLES"].forEach(function(n){for(var i in e.mediaGroups[n])for(var r in e.mediaGroups[n][i]){var a=e.mediaGroups[n][i][r];t(a,n,i,r)}})},oc=function(e,t){var n=nc(e,{}),i=n.playlists[t.uri];if(!i)return null;if(i.segments&&t.segments&&i.segments.length===t.segments.length&&i.endList===t.endList&&i.mediaSequence===t.mediaSequence)return null;var r=nc(i,t);i.segments&&(r.segments=function(e,t,n){var i=t.slice();n=n||0;for(var r=Math.min(e.length,t.length+n),a=n;a<r;a++)i[a-n]=nc(e[a],i[a-n]);return i}(i.segments,t.segments,t.mediaSequence-i.mediaSequence)),r.segments.forEach(function(e){!function(e,t){e.resolvedUri||(e.resolvedUri=Xu(t,e.uri)),e.key&&!e.key.resolvedUri&&(e.key.resolvedUri=Xu(t,e.key.uri)),e.map&&!e.map.resolvedUri&&(e.map.resolvedUri=Xu(t,e.map.uri))}(e,r.resolvedUri)});for(var a=0;a<n.playlists.length;a++)n.playlists[a].uri===t.uri&&(n.playlists[a]=r);return n.playlists[t.uri]=r,n},sc=function(e){for(var t=e.playlists.length;t--;){var n=e.playlists[t];e.playlists[n.uri]=n,n.resolvedUri=Xu(e.uri,n.uri),n.id=t,n.attributes||(n.attributes={},rc.warn("Invalid playlist STREAM-INF detected. Missing BANDWIDTH attribute."))}},lc=function(e){ac(e,function(t){t.uri&&(t.resolvedUri=Xu(e.uri,t.uri))})},uc=function(e,t){var n=e.segments[e.segments.length-1];return t&&n&&n.duration?1e3*n.duration:500*(e.targetDuration||10)},cc=function(t){function n(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};Qu(this,n);var r=ec(this,(n.__proto__||Object.getPrototypeOf(n)).call(this)),a=i.withCredentials,o=void 0!==a&&a,s=i.handleManifestRedirects,l=void 0!==s&&s;r.srcUrl=e,r.hls_=t,r.withCredentials=o,r.handleManifestRedirects=l;var u=t.options_;if(r.customTagParsers=u&&u.customTagParsers||[],r.customTagMappers=u&&u.customTagMappers||[],!r.srcUrl)throw new Error("A non-empty playlist URL is required");return r.state="HAVE_NOTHING",r.on("mediaupdatetimeout",function(){"HAVE_METADATA"===r.state&&(r.state="HAVE_CURRENT_METADATA",r.request=r.hls_.xhr({uri:Xu(r.master.uri,r.media().uri),withCredentials:r.withCredentials},function(e,t){if(r.request)return e?r.playlistRequestError(r.request,r.media().uri,"HAVE_METADATA"):void r.haveMetadata(r.request,r.media().uri)}))}),r}return Zu(n,ic),Ju(n,[{key:"playlistRequestError",value:function(e,t,n){this.request=null,n&&(this.state=n),this.error={playlist:this.master.playlists[t],status:e.status,message:"HLS playlist request error at URL: "+t+".",responseText:e.responseText,code:e.status>=500?4:2},this.trigger("error")}},{key:"haveMetadata",value:function(t,n){var i=this;this.request=null,this.state="HAVE_METADATA";var r=new rs;this.customTagParsers.forEach(function(e){return r.addParser(e)}),this.customTagMappers.forEach(function(e){return r.addTagMapper(e)}),r.push(t.responseText),r.end(),r.manifest.uri=n,r.manifest.attributes=r.manifest.attributes||{};var a=oc(this.master,r.manifest);this.targetDuration=r.manifest.targetDuration,a?(this.master=a,this.media_=this.master.playlists[r.manifest.uri]):this.trigger("playlistunchanged"),this.media().endList||(e.clearTimeout(this.mediaUpdateTimeout),this.mediaUpdateTimeout=e.setTimeout(function(){i.trigger("mediaupdatetimeout")},uc(this.media(),!!a))),this.trigger("loadedplaylist")}},{key:"dispose",value:function(){this.stopRequest(),e.clearTimeout(this.mediaUpdateTimeout),e.clearTimeout(this.finalRenditionTimeout)}},{key:"stopRequest",value:function(){if(this.request){var e=this.request;this.request=null,e.onreadystatechange=null,e.abort()}}},{key:"media",value:function(t,n){var i=this;if(!t)return this.media_;if("HAVE_NOTHING"===this.state)throw new Error("Cannot switch media playlist from "+this.state);if("string"==typeof t){if(!this.master.playlists[t])throw new Error("Unknown playlist URI: "+t);t=this.master.playlists[t]}if(e.clearTimeout(this.finalRenditionTimeout),n){var r=t.targetDuration/2*1e3||5e3;this.finalRenditionTimeout=e.setTimeout(this.media.bind(this,t,!1),r)}else{var a=this.state,o=!this.media_||t.uri!==this.media_.uri;if(this.master.playlists[t.uri].endList)return this.request&&(this.request.onreadystatechange=null,this.request.abort(),this.request=null),this.state="HAVE_METADATA",this.media_=t,void(o&&(this.trigger("mediachanging"),this.trigger("mediachange")));if(o){if(this.state="SWITCHING_MEDIA",this.request){if(t.resolvedUri===this.request.url)return;this.request.onreadystatechange=null,this.request.abort(),this.request=null}this.media_&&this.trigger("mediachanging"),this.request=this.hls_.xhr({uri:t.resolvedUri,withCredentials:this.withCredentials},function(e,n){if(i.request){if(t.resolvedUri=Yu(i.handleManifestRedirects,t.resolvedUri,n),e)return i.playlistRequestError(i.request,t.uri,a);i.haveMetadata(n,t.uri),"HAVE_MASTER"===a?i.trigger("loadedmetadata"):i.trigger("mediachange")}})}}}},{key:"pause",value:function(){this.stopRequest(),e.clearTimeout(this.mediaUpdateTimeout),"HAVE_NOTHING"===this.state&&(this.started=!1),"SWITCHING_MEDIA"===this.state?this.media_?this.state="HAVE_METADATA":this.state="HAVE_MASTER":"HAVE_CURRENT_METADATA"===this.state&&(this.state="HAVE_METADATA")}},{key:"load",value:function(t){var n=this;e.clearTimeout(this.mediaUpdateTimeout);var i=this.media();if(t){var r=i?i.targetDuration/2*1e3:5e3;this.mediaUpdateTimeout=e.setTimeout(function(){return n.load()},r)}else this.started?i&&!i.endList?this.trigger("mediaupdatetimeout"):this.trigger("loadedplaylist"):this.start()}},{key:"start",value:function(){var t=this;this.started=!0,this.request=this.hls_.xhr({uri:this.srcUrl,withCredentials:this.withCredentials},function(n,i){if(t.request){if(t.request=null,n)return t.error={status:i.status,message:"HLS playlist request error at URL: "+t.srcUrl+".",responseText:i.responseText,code:2},"HAVE_NOTHING"===t.state&&(t.started=!1),t.trigger("error");var r=new rs;return t.customTagParsers.forEach(function(e){return r.addParser(e)}),t.customTagMappers.forEach(function(e){return r.addTagMapper(e)}),r.push(i.responseText),r.end(),t.state="HAVE_MASTER",t.srcUrl=Yu(t.handleManifestRedirects,t.srcUrl,i),r.manifest.uri=t.srcUrl,r.manifest.playlists?(t.master=r.manifest,sc(t.master),lc(t.master),t.trigger("loadedplaylist"),void(t.request||t.media(r.manifest.playlists[0]))):(t.master={mediaGroups:{AUDIO:{},VIDEO:{},"CLOSED-CAPTIONS":{},SUBTITLES:{}},uri:e.location.href,playlists:[{uri:t.srcUrl,id:0,resolvedUri:t.srcUrl,attributes:{}}]},t.master.playlists[t.srcUrl]=t.master.playlists[0],t.haveMetadata(i,t.srcUrl),t.trigger("loadedmetadata"))}})}}]),n}(),dc=to.createTimeRange,hc=function(e,t,n){var i=void 0,r=void 0;return void 0===t&&(t=e.mediaSequence+e.segments.length),t<e.mediaSequence?0:(i=function(e,t){var n=0,i=t-e.mediaSequence,r=e.segments[i];if(r){if(void 0!==r.start)return{result:r.start,precise:!0};if(void 0!==r.end)return{result:r.end-r.duration,precise:!0}}for(;i--;){if(void 0!==(r=e.segments[i]).end)return{result:n+r.end,precise:!0};if(n+=r.duration,void 0!==r.start)return{result:n+r.start,precise:!0}}return{result:n,precise:!1}}(e,t)).precise?i.result:(r=function(e,t){for(var n=0,i=void 0,r=t-e.mediaSequence;r<e.segments.length;r++){if(void 0!==(i=e.segments[r]).start)return{result:i.start-n,precise:!0};if(n+=i.duration,void 0!==i.end)return{result:i.end-n,precise:!0}}return{result:-1,precise:!1}}(e,t)).precise?r.result:i.result+n},pc=function(t,n,i){if(!t)return 0;if("number"!=typeof i&&(i=0),void 0===n){if(t.totalDuration)return t.totalDuration;if(!t.endList)return e.Infinity}return hc(t,n,i)},fc=function(e,t,n){var i=0;if(t>n){var r=[n,t];t=r[0],n=r[1]}if(t<0){for(var a=t;a<Math.min(0,n);a++)i+=e.targetDuration;t=0}for(var o=t;o<n;o++)i+=e.segments[o].duration;return i},gc=function(e){if(!e.segments.length)return 0;for(var t=e.segments.length-1,n=e.segments[t].duration||e.targetDuration,i=n+2*e.targetDuration;t--&&!((n+=e.segments[t].duration)>=i););return Math.max(0,t)},mc=function(e,t,n){if(!e||!e.segments)return null;if(e.endList)return pc(e);if(null===t)return null;t=t||0;var i=n?gc(e):e.segments.length;return hc(e,e.mediaSequence+i,t)},vc=function(e){return e-Math.floor(e)==0},yc=function(e,t){if(vc(t))return t+.1*e;for(var n=t.toString().split(".")[1].length,i=1;i<=n;i++){var r=Math.pow(10,i),a=t*r;if(vc(a)||i===n)return(a+e)/r}},bc=yc.bind(null,1),_c=yc.bind(null,-1),Tc=function(e){return e.excludeUntil&&e.excludeUntil>Date.now()},Ec=function(e){return e.excludeUntil&&e.excludeUntil===1/0},Cc=function(e){var t=Tc(e);return!e.disabled&&!t},wc=function(e,t){return t.attributes&&t.attributes[e]},kc=function(e,t){if(1===e.playlists.length)return!0;var n=t.attributes.BANDWIDTH||Number.MAX_VALUE;return 0===e.playlists.filter(function(e){return!!Cc(e)&&(e.attributes.BANDWIDTH||0)<n}).length},Sc={duration:pc,seekable:function(e,t){var n=t||0,i=mc(e,t,!0);return null===i?dc():dc(n,i)},safeLiveIndex:gc,getMediaInfoForTime:function(e,t,n,i){var r=void 0,a=void 0,o=e.segments.length,s=t-i;if(s<0){if(n>0)for(r=n-1;r>=0;r--)if(a=e.segments[r],(s+=_c(a.duration))>0)return{mediaIndex:r,startTime:i-fc(e,n,r)};return{mediaIndex:0,startTime:t}}if(n<0){for(r=n;r<0;r++)if((s-=e.targetDuration)<0)return{mediaIndex:0,startTime:t};n=0}for(r=n;r<o;r++)if(a=e.segments[r],(s-=bc(a.duration))<0)return{mediaIndex:r,startTime:i+fc(e,n,r)};return{mediaIndex:o-1,startTime:t}},isEnabled:Cc,isDisabled:function(e){return e.disabled},isBlacklisted:Tc,isIncompatible:Ec,playlistEnd:mc,isAes:function(e){for(var t=0;t<e.segments.length;t++)if(e.segments[t].key)return!0;return!1},isFmp4:function(e){for(var t=0;t<e.segments.length;t++)if(e.segments[t].map)return!0;return!1},hasAttribute:wc,estimateSegmentRequestTime:function(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;return wc("BANDWIDTH",n)?(e*n.attributes.BANDWIDTH-8*i)/t:NaN},isLowestEnabledRendition:kc},Ic=to.xhr,Oc=to.mergeOptions,Dc=function(){return function e(t,n){t=Oc({timeout:45e3},t);var i=e.beforeRequest||to.Hls.xhr.beforeRequest;if(i&&"function"==typeof i){var r=i(t);r&&(t=r)}var a=Ic(t,function(e,t){var i=a.response;!e&&i&&(a.responseTime=Date.now(),a.roundTripTime=a.responseTime-a.requestTime,a.bytesReceived=i.byteLength||i.length,a.bandwidth||(a.bandwidth=Math.floor(a.bytesReceived/a.roundTripTime*8*1e3))),t.headers&&(a.responseHeaders=t.headers),e&&"ETIMEDOUT"===e.code&&(a.timedout=!0),e||a.aborted||200===t.statusCode||206===t.statusCode||0===t.statusCode||(e=new Error("XHR Failed with a response of: "+(a&&(i||a.responseText)))),n(e,a)}),o=a.abort;return a.abort=function(){return a.aborted=!0,o.apply(a,arguments)},a.uri=t.uri,a.requestTime=Date.now(),a}},Rc=function(e){var t,n,i={};return e.byterange&&(i.Range=(n=void 0,n=(t=e.byterange).offset+t.length-1,"bytes="+t.offset+"-"+n)),i},xc=function(e,t){return e.start(t)+"-"+e.end(t)},Ac=function(e,t){var n=e.toString(16);return"00".substring(0,2-n.length)+n+(t%2?" ":"")},Pc=function(e){return e>=32&&e<126?String.fromCharCode(e):"."},Lc=function(e){var t={};return Object.keys(e).forEach(function(n){var i=e[n];ArrayBuffer.isView(i)?t[n]={bytes:i.buffer,byteOffset:i.byteOffset,byteLength:i.byteLength}:t[n]=i}),t},Nc=function(e){var t=e.byterange||{length:1/0,offset:0};return[t.length,t.offset,e.resolvedUri].join(",")},Mc=function(e){return e.resolvedUri},Kc=function(e){for(var t=Array.prototype.slice.call(e),n="",i=0;i<t.length/16;i++)n+=t.slice(16*i,16*i+16).map(Ac).join("")+" "+t.slice(16*i,16*i+16).map(Pc).join("")+"\n";return n},$c=Object.freeze({createTransferableMessage:Lc,initSegmentId:Nc,segmentKeyId:Mc,hexDump:Kc,tagDump:function(e){var t=e.bytes;return Kc(t)},textRanges:function(e){var t="",n=void 0;for(n=0;n<e.length;n++)t+=xc(e,n)+" ";return t}}),jc=function(e,t){var n=[],i=void 0;if(e&&e.length)for(i=0;i<e.length;i++)t(e.start(i),e.end(i))&&n.push([e.start(i),e.end(i)]);return to.createTimeRanges(n)},Bc=function(e,t){return jc(e,function(e,n){return e-1/30<=t&&n+1/30>=t})},Fc=function(e,t){return jc(e,function(e){return e-1/30>=t})},Uc=function(e){var t=[];if(!e||!e.length)return"";for(var n=0;n<e.length;n++)t.push(e.start(n)+" => "+e.end(n));return t.join(", ")},Vc=function(e){for(var t=[],n=0;n<e.length;n++)t.push({start:e.start(n),end:e.end(n)});return t},qc=function(e,t,n){var i=void 0,r=void 0;if(n&&n.cues)for(i=n.cues.length;i--;)(r=n.cues[i]).startTime<=t&&r.endTime>=e&&n.removeCue(r)},Hc=function(e){return isNaN(e)||Math.abs(e)===1/0?Number.MAX_VALUE:e},zc=function(t,n,i){var r=e.WebKitDataCue||e.VTTCue;if(n&&n.forEach(function(e){var t=e.stream;this.inbandTextTracks_[t].addCue(new r(e.startTime+this.timestampOffset,e.endTime+this.timestampOffset,e.text))},t),i){var a=Hc(t.mediaSource_.duration);if(i.forEach(function(t){var n=t.cueTime+this.timestampOffset;!("number"!=typeof n||e.isNaN(n)||n<0)&&n<1/0&&t.frames.forEach(function(e){var t=new r(n,n,e.value||e.url||e.data||"");t.frame=e,t.value=e,function(e){Object.defineProperties(e.frame,{id:{get:function(){return to.log.warn("cue.frame.id is deprecated. Use cue.value.key instead."),e.value.key}},value:{get:function(){return to.log.warn("cue.frame.value is deprecated. Use cue.value.data instead."),e.value.data}},privateData:{get:function(){return to.log.warn("cue.frame.privateData is deprecated. Use cue.value.data instead."),e.value.data}}})}(t),this.metadataTrack_.addCue(t)},this)},t),t.metadataTrack_&&t.metadataTrack_.cues&&t.metadataTrack_.cues.length){for(var o=t.metadataTrack_.cues,s=[],l=0;l<o.length;l++)o[l]&&s.push(o[l]);var u=s.reduce(function(e,t){var n=e[t.startTime]||[];return n.push(t),e[t.startTime]=n,e},{}),c=Object.keys(u).sort(function(e,t){return Number(e)-Number(t)});c.forEach(function(e,t){var n=u[e],i=Number(c[t+1])||a;n.forEach(function(e){e.endTime=i})})}}},Wc="undefined"!=typeof window?window:{},Gc="undefined"==typeof Symbol?"__target":Symbol(),Xc="application/javascript",Yc=Wc.BlobBuilder||Wc.WebKitBlobBuilder||Wc.MozBlobBuilder||Wc.MSBlobBuilder,Qc=Wc.URL||Wc.webkitURL||Qc&&Qc.msURL,Jc=Wc.Worker;function Zc(e,t){return function(n){var i=this;if(!t)return new Jc(e);if(Jc&&!n){var r=id(t.toString().replace(/^function.+?{/,"").slice(0,-1));return this[Gc]=new Jc(r),function(e,t){if(e&&t){var n=e.terminate;e.objURL=t,e.terminate=function(){e.objURL&&Qc.revokeObjectURL(e.objURL),n.call(e)}}}(this[Gc],r),this[Gc]}var a={postMessage:function(e){i.onmessage&&setTimeout(function(){i.onmessage({data:e,target:a})})}};t.call(a),this.postMessage=function(e){setTimeout(function(){a.onmessage({data:e,target:i})})},this.isThisThread=!0}}if(Jc){var ed,td=id("self.onmessage = function () {}"),nd=new Uint8Array(1);try{(ed=new Jc(td)).postMessage(nd,[nd.buffer])}catch(e){Jc=null}finally{Qc.revokeObjectURL(td),ed&&ed.terminate()}}function id(e){try{return Qc.createObjectURL(new Blob([e],{type:Xc}))}catch(n){var t=new Yc;return t.append(e),Qc.createObjectURL(t.getBlob(type))}}var rd=new Zc("./transmuxer-worker.worker.js",function(e,t){var n=this;!function(){var e,t,i,r,a,o,s,l,u,c,d,h,p,f,g,m,v,y,b,_,T,E,C,w,k,S,I,O,D,R,x,A,P,L,N,M,K,$,j,B,F=Math.pow(2,32)-1;!function(){var e;if(E={avc1:[],avcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],mvex:[],mvhd:[],sdtp:[],smhd:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],styp:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[]},"undefined"!=typeof Uint8Array){for(e in E)E.hasOwnProperty(e)&&(E[e]=[e.charCodeAt(0),e.charCodeAt(1),e.charCodeAt(2),e.charCodeAt(3)]);C=new Uint8Array(["i".charCodeAt(0),"s".charCodeAt(0),"o".charCodeAt(0),"m".charCodeAt(0)]),k=new Uint8Array(["a".charCodeAt(0),"v".charCodeAt(0),"c".charCodeAt(0),"1".charCodeAt(0)]),w=new Uint8Array([0,0,0,1]),S=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),I=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]),O={video:S,audio:I},x=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),R=new Uint8Array([0,0,0,0,0,0,0,0]),A=new Uint8Array([0,0,0,0,0,0,0,0]),P=A,L=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),N=A,D=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0])}}(),e=function(e){var t,n,i=[],r=0;for(t=1;t<arguments.length;t++)i.push(arguments[t]);for(t=i.length;t--;)r+=i[t].byteLength;for(n=new Uint8Array(r+8),new DataView(n.buffer,n.byteOffset,n.byteLength).setUint32(0,n.byteLength),n.set(e,4),t=0,r=8;t<i.length;t++)n.set(i[t],r),r+=i[t].byteLength;return n},t=function(){return e(E.dinf,e(E.dref,x))},i=function(t){return e(E.esds,new Uint8Array([0,0,0,0,3,25,0,0,0,4,17,64,21,0,6,0,0,0,218,192,0,0,218,192,5,2,t.audioobjecttype<<3|t.samplingfrequencyindex>>>1,t.samplingfrequencyindex<<7|t.channelcount<<3,6,1,2]))},g=function(t){return e(E.hdlr,O[t])},f=function(t){var n=new Uint8Array([0,0,0,0,0,0,0,2,0,0,0,3,0,1,95,144,t.duration>>>24&255,t.duration>>>16&255,t.duration>>>8&255,255&t.duration,85,196,0,0]);return t.samplerate&&(n[12]=t.samplerate>>>24&255,n[13]=t.samplerate>>>16&255,n[14]=t.samplerate>>>8&255,n[15]=255&t.samplerate),e(E.mdhd,n)},p=function(t){return e(E.mdia,f(t),g(t.type),o(t))},a=function(t){return e(E.mfhd,new Uint8Array([0,0,0,0,(4278190080&t)>>24,(16711680&t)>>16,(65280&t)>>8,255&t]))},o=function(n){return e(E.minf,"video"===n.type?e(E.vmhd,D):e(E.smhd,R),t(),v(n))},s=function(t,n){for(var i=[],r=n.length;r--;)i[r]=b(n[r]);return e.apply(null,[E.moof,a(t)].concat(i))},l=function(t){for(var n=t.length,i=[];n--;)i[n]=d(t[n]);return e.apply(null,[E.moov,c(4294967295)].concat(i).concat(u(t)))},u=function(t){for(var n=t.length,i=[];n--;)i[n]=_(t[n]);return e.apply(null,[E.mvex].concat(i))},c=function(t){var n=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,2,0,1,95,144,(4278190080&t)>>24,(16711680&t)>>16,(65280&t)>>8,255&t,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return e(E.mvhd,n)},m=function(t){var n,i,r=t.samples||[],a=new Uint8Array(4+r.length);for(i=0;i<r.length;i++)n=r[i].flags,a[i+4]=n.dependsOn<<4|n.isDependedOn<<2|n.hasRedundancy;return e(E.sdtp,a)},v=function(t){return e(E.stbl,y(t),e(E.stts,N),e(E.stsc,P),e(E.stsz,L),e(E.stco,A))},y=function(t){return e(E.stsd,new Uint8Array([0,0,0,0,0,0,0,1]),"video"===t.type?M(t):K(t))},M=function(t){var n,i=t.sps||[],r=t.pps||[],a=[],o=[];for(n=0;n<i.length;n++)a.push((65280&i[n].byteLength)>>>8),a.push(255&i[n].byteLength),a=a.concat(Array.prototype.slice.call(i[n]));for(n=0;n<r.length;n++)o.push((65280&r[n].byteLength)>>>8),o.push(255&r[n].byteLength),o=o.concat(Array.prototype.slice.call(r[n]));return e(E.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,(65280&t.width)>>8,255&t.width,(65280&t.height)>>8,255&t.height,0,72,0,0,0,72,0,0,0,0,0,0,0,1,19,118,105,100,101,111,106,115,45,99,111,110,116,114,105,98,45,104,108,115,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),e(E.avcC,new Uint8Array([1,t.profileIdc,t.profileCompatibility,t.levelIdc,255].concat([i.length]).concat(a).concat([r.length]).concat(o))),e(E.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])))},K=function(t){return e(E.mp4a,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,(65280&t.channelcount)>>8,255&t.channelcount,(65280&t.samplesize)>>8,255&t.samplesize,0,0,0,0,(65280&t.samplerate)>>8,255&t.samplerate,0,0]),i(t))},h=function(t){var n=new Uint8Array([0,0,0,7,0,0,0,0,0,0,0,0,(4278190080&t.id)>>24,(16711680&t.id)>>16,(65280&t.id)>>8,255&t.id,0,0,0,0,(4278190080&t.duration)>>24,(16711680&t.duration)>>16,(65280&t.duration)>>8,255&t.duration,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,(65280&t.width)>>8,255&t.width,0,0,(65280&t.height)>>8,255&t.height,0,0]);return e(E.tkhd,n)},b=function(t){var n,i,r,a,o,s;return n=e(E.tfhd,new Uint8Array([0,0,0,58,(4278190080&t.id)>>24,(16711680&t.id)>>16,(65280&t.id)>>8,255&t.id,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0])),o=Math.floor(t.baseMediaDecodeTime/(F+1)),s=Math.floor(t.baseMediaDecodeTime%(F+1)),i=e(E.tfdt,new Uint8Array([1,0,0,0,o>>>24&255,o>>>16&255,o>>>8&255,255&o,s>>>24&255,s>>>16&255,s>>>8&255,255&s])),"audio"===t.type?(r=T(t,92),e(E.traf,n,i,r)):(a=m(t),r=T(t,a.length+92),e(E.traf,n,i,r,a))},d=function(t){return t.duration=t.duration||4294967295,e(E.trak,h(t),p(t))},_=function(t){var n=new Uint8Array([0,0,0,0,(4278190080&t.id)>>24,(16711680&t.id)>>16,(65280&t.id)>>8,255&t.id,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]);return"video"!==t.type&&(n[n.length-1]=0),e(E.trex,n)},B=function(e,t){var n=0,i=0,r=0,a=0;return e.length&&(void 0!==e[0].duration&&(n=1),void 0!==e[0].size&&(i=2),void 0!==e[0].flags&&(r=4),void 0!==e[0].compositionTimeOffset&&(a=8)),[0,0,n|i|r|a,1,(4278190080&e.length)>>>24,(16711680&e.length)>>>16,(65280&e.length)>>>8,255&e.length,(4278190080&t)>>>24,(16711680&t)>>>16,(65280&t)>>>8,255&t]},j=function(t,n){var i,r,a,o;for(n+=20+16*(r=t.samples||[]).length,i=B(r,n),o=0;o<r.length;o++)a=r[o],i=i.concat([(4278190080&a.duration)>>>24,(16711680&a.duration)>>>16,(65280&a.duration)>>>8,255&a.duration,(4278190080&a.size)>>>24,(16711680&a.size)>>>16,(65280&a.size)>>>8,255&a.size,a.flags.isLeading<<2|a.flags.dependsOn,a.flags.isDependedOn<<6|a.flags.hasRedundancy<<4|a.flags.paddingValue<<1|a.flags.isNonSyncSample,61440&a.flags.degradationPriority,15&a.flags.degradationPriority,(4278190080&a.compositionTimeOffset)>>>24,(16711680&a.compositionTimeOffset)>>>16,(65280&a.compositionTimeOffset)>>>8,255&a.compositionTimeOffset]);return e(E.trun,new Uint8Array(i))},$=function(t,n){var i,r,a,o;for(n+=20+8*(r=t.samples||[]).length,i=B(r,n),o=0;o<r.length;o++)a=r[o],i=i.concat([(4278190080&a.duration)>>>24,(16711680&a.duration)>>>16,(65280&a.duration)>>>8,255&a.duration,(4278190080&a.size)>>>24,(16711680&a.size)>>>16,(65280&a.size)>>>8,255&a.size]);return e(E.trun,new Uint8Array(i))},T=function(e,t){return"audio"===e.type?$(e,t):j(e,t)};var U,V,q={ftyp:r=function(){return e(E.ftyp,C,w,C,k)},mdat:function(t){return e(E.mdat,t)},moof:s,moov:l,initSegment:function(e){var t,n=r(),i=l(e);return(t=new Uint8Array(n.byteLength+i.byteLength)).set(n),t.set(i,n.byteLength),t}},H=function(e){return e>>>0},z={findBox:U=function(e,t){var n,i,r,a,o,s=[];if(!t.length)return null;for(n=0;n<e.byteLength;)i=H(e[n]<<24|e[n+1]<<16|e[n+2]<<8|e[n+3]),r=V(e.subarray(n+4,n+8)),a=i>1?n+i:e.byteLength,r===t[0]&&(1===t.length?s.push(e.subarray(n+8,a)):(o=U(e.subarray(n+8,a),t.slice(1))).length&&(s=s.concat(o))),n=a;return s},parseType:V=function(e){var t="";return t+=String.fromCharCode(e[0]),t+=String.fromCharCode(e[1]),(t+=String.fromCharCode(e[2]))+String.fromCharCode(e[3])},timescale:function(e){return U(e,["moov","trak"]).reduce(function(e,t){var n,i,r,a,o;return(n=U(t,["tkhd"])[0])?(i=n[0],a=H(n[r=0===i?12:20]<<24|n[r+1]<<16|n[r+2]<<8|n[r+3]),(o=U(t,["mdia","mdhd"])[0])?(r=0===(i=o[0])?12:20,e[a]=H(o[r]<<24|o[r+1]<<16|o[r+2]<<8|o[r+3]),e):null):null},{})},startTime:function(e,t){var n,i,r;return n=U(t,["moof","traf"]),i=[].concat.apply([],n.map(function(t){return U(t,["tfhd"]).map(function(n){var i,r;return i=H(n[4]<<24|n[5]<<16|n[6]<<8|n[7]),r=e[i]||9e4,(U(t,["tfdt"]).map(function(e){var t,n;return t=e[0],n=H(e[4]<<24|e[5]<<16|e[6]<<8|e[7]),1===t&&(n*=Math.pow(2,32),n+=H(e[8]<<24|e[9]<<16|e[10]<<8|e[11])),n})[0]||1/0)/r})})),r=Math.min.apply(null,i),isFinite(r)?r:0},videoTrackIds:function(e){var t=[];return U(e,["moov","trak"]).forEach(function(e){var n=U(e,["mdia","hdlr"]),i=U(e,["tkhd"]);n.forEach(function(e,n){var r,a,o=V(e.subarray(8,12)),s=i[n];"vide"===o&&(a=0===(r=new DataView(s.buffer,s.byteOffset,s.byteLength)).getUint8(0)?r.getUint32(12):r.getUint32(20),t.push(a))})}),t}},W=function(){this.init=function(){var e={};this.on=function(t,n){e[t]||(e[t]=[]),e[t]=e[t].concat(n)},this.off=function(t,n){var i;return!!e[t]&&(i=e[t].indexOf(n),e[t]=e[t].slice(),e[t].splice(i,1),i>-1)},this.trigger=function(t){var n,i,r,a;if(n=e[t])if(2===arguments.length)for(r=n.length,i=0;i<r;++i)n[i].call(this,arguments[1]);else{for(a=[],i=arguments.length,i=1;i<arguments.length;++i)a.push(arguments[i]);for(r=n.length,i=0;i<r;++i)n[i].apply(this,a)}},this.dispose=function(){e={}}}};W.prototype.pipe=function(e){return this.on("data",function(t){e.push(t)}),this.on("done",function(t){e.flush(t)}),e},W.prototype.push=function(e){this.trigger("data",e)},W.prototype.flush=function(e){this.trigger("done",e)};var G,X,Y,Q,J,Z=W,ee=function(e,t){var n={size:0,flags:{isLeading:0,dependsOn:1,isDependedOn:0,hasRedundancy:0,degradationPriority:0,isNonSyncSample:1}};return n.dataOffset=t,n.compositionTimeOffset=e.pts-e.dts,n.duration=e.duration,n.size=4*e.length,n.size+=e.byteLength,e.keyFrame&&(n.flags.dependsOn=2,n.flags.isNonSyncSample=0),n},te=function(e){var t,n,i=[],r=[];for(i.byteLength=0,t=0;t<e.length;t++)"access_unit_delimiter_rbsp"===(n=e[t]).nalUnitType?(i.length&&(i.duration=n.dts-i.dts,r.push(i)),(i=[n]).byteLength=n.data.byteLength,i.pts=n.pts,i.dts=n.dts):("slice_layer_without_partitioning_rbsp_idr"===n.nalUnitType&&(i.keyFrame=!0),i.duration=n.dts-i.dts,i.byteLength+=n.data.byteLength,i.push(n));return r.length&&(!i.duration||i.duration<=0)&&(i.duration=r[r.length-1].duration),r.push(i),r},ne=function(e){var t,n,i=[],r=[];for(i.byteLength=0,i.nalCount=0,i.duration=0,i.pts=e[0].pts,i.dts=e[0].dts,r.byteLength=0,r.nalCount=0,r.duration=0,r.pts=e[0].pts,r.dts=e[0].dts,t=0;t<e.length;t++)(n=e[t]).keyFrame?(i.length&&(r.push(i),r.byteLength+=i.byteLength,r.nalCount+=i.nalCount,r.duration+=i.duration),(i=[n]).nalCount=n.length,i.byteLength=n.byteLength,i.pts=n.pts,i.dts=n.dts,i.duration=n.duration):(i.duration+=n.duration,i.nalCount+=n.length,i.byteLength+=n.byteLength,i.push(n));return r.length&&i.duration<=0&&(i.duration=r[r.length-1].duration),r.byteLength+=i.byteLength,r.nalCount+=i.nalCount,r.duration+=i.duration,r.push(i),r},ie=function(e){var t;return!e[0][0].keyFrame&&e.length>1&&(t=e.shift(),e.byteLength-=t.byteLength,e.nalCount-=t.nalCount,e[0][0].dts=t.dts,e[0][0].pts=t.pts,e[0][0].duration+=t.duration),e},re=function(e,t){var n,i,r,a,o,s=t||0,l=[];for(n=0;n<e.length;n++)for(a=e[n],i=0;i<a.length;i++)o=a[i],s+=(r=ee(o,s)).size,l.push(r);return l},ae=function(e){var t,n,i,r,a,o,s=0,l=e.byteLength,u=e.nalCount,c=new Uint8Array(l+4*u),d=new DataView(c.buffer);for(t=0;t<e.length;t++)for(r=e[t],n=0;n<r.length;n++)for(a=r[n],i=0;i<a.length;i++)o=a[i],d.setUint32(s,o.data.byteLength),s+=4,c.set(o.data,s),s+=o.data.byteLength;return c},oe=[33,16,5,32,164,27],se=[33,65,108,84,1,2,4,8,168,2,4,8,17,191,252],le=function(e){for(var t=[];e--;)t.push(0);return t},ue={96000:[oe,[227,64],le(154),[56]],88200:[oe,[231],le(170),[56]],64000:[oe,[248,192],le(240),[56]],48000:[oe,[255,192],le(268),[55,148,128],le(54),[112]],44100:[oe,[255,192],le(268),[55,163,128],le(84),[112]],32000:[oe,[255,192],le(268),[55,234],le(226),[112]],24000:[oe,[255,192],le(268),[55,255,128],le(268),[111,112],le(126),[224]],16000:[oe,[255,192],le(268),[55,255,128],le(268),[111,255],le(269),[223,108],le(195),[1,192]],12000:[se,le(268),[3,127,248],le(268),[6,255,240],le(268),[13,255,224],le(268),[27,253,128],le(259),[56]],11025:[se,le(268),[3,127,248],le(268),[6,255,240],le(268),[13,255,224],le(268),[27,255,192],le(268),[55,175,128],le(108),[112]],8000:[se,le(268),[3,121,16],le(47),[7]]},ce=(G=ue,Object.keys(G).reduce(function(e,t){return e[t]=new Uint8Array(G[t].reduce(function(e,t){return e.concat(t)},[])),e},{})),de=(X=function(e){return 9e4*e},Y=function(e,t){return e*t},Q=function(e){return e/9e4},J=function(e,t){return e/t},function(e,t){return X(J(e,t))}),he=function(e,t){return Y(Q(e),t)},pe=function(e,t,n,i){var r,a,o,s=0,l=0,u=0,c=0;if(t.length&&(r=de(e.baseMediaDecodeTime,e.samplerate),s=Math.ceil(9e4/(e.samplerate/1024)),n&&i&&(l=r-Math.max(n,i),c=(u=Math.floor(l/s))*s),!(u<1||c>45e3))){for((a=ce[e.samplerate])||(a=t[0].data),o=0;o<u;o++)t.splice(o,0,{data:a});e.baseMediaDecodeTime-=Math.floor(he(c,e.samplerate))}},fe=function(e,t,n){return t.minSegmentDts>=n?e:(t.minSegmentDts=1/0,e.filter(function(e){return e.dts>=n&&(t.minSegmentDts=Math.min(t.minSegmentDts,e.dts),t.minSegmentPts=t.minSegmentDts,!0)}))},ge=function(e){var t,n,i=[];for(t=0;t<e.length;t++)n=e[t],i.push({size:n.data.byteLength,duration:1024});return i},me=function(e){var t,n,i=0,r=new Uint8Array(function(e){var t,n=0;for(t=0;t<e.length;t++)n+=e[t].data.byteLength;return n}(e));for(t=0;t<e.length;t++)n=e[t],r.set(n.data,i),i+=n.data.byteLength;return r},ve=function(e){delete e.minSegmentDts,delete e.maxSegmentDts,delete e.minSegmentPts,delete e.maxSegmentPts},ye=function(e,t){var n,i=e.minSegmentDts;return t||(i-=e.timelineStartInfo.dts),n=e.timelineStartInfo.baseMediaDecodeTime,n+=i,n=Math.max(0,n),"audio"===e.type&&(n*=e.samplerate/9e4,n=Math.floor(n)),n},be=function(e,t){"number"==typeof t.pts&&(void 0===e.timelineStartInfo.pts&&(e.timelineStartInfo.pts=t.pts),void 0===e.minSegmentPts?e.minSegmentPts=t.pts:e.minSegmentPts=Math.min(e.minSegmentPts,t.pts),void 0===e.maxSegmentPts?e.maxSegmentPts=t.pts:e.maxSegmentPts=Math.max(e.maxSegmentPts,t.pts)),"number"==typeof t.dts&&(void 0===e.timelineStartInfo.dts&&(e.timelineStartInfo.dts=t.dts),void 0===e.minSegmentDts?e.minSegmentDts=t.dts:e.minSegmentDts=Math.min(e.minSegmentDts,t.dts),void 0===e.maxSegmentDts?e.maxSegmentDts=t.dts:e.maxSegmentDts=Math.max(e.maxSegmentDts,t.dts))},_e=function(e){for(var t=0,n={payloadType:-1,payloadSize:0},i=0,r=0;t<e.byteLength&&128!==e[t];){for(;255===e[t];)i+=255,t++;for(i+=e[t++];255===e[t];)r+=255,t++;if(r+=e[t++],!n.payload&&4===i){n.payloadType=i,n.payloadSize=r,n.payload=e.subarray(t,t+r);break}t+=r,i=0,r=0}return n},Te=function(e){return 181!==e.payload[0]?null:49!=(e.payload[1]<<8|e.payload[2])?null:"GA94"!==String.fromCharCode(e.payload[3],e.payload[4],e.payload[5],e.payload[6])?null:3!==e.payload[7]?null:e.payload.subarray(8,e.payload.length-1)},Ee=function(e,t){var n,i,r,a,o=[];if(!(64&t[0]))return o;for(i=31&t[0],n=0;n<i;n++)a={type:3&t[2+(r=3*n)],pts:e},4&t[r+2]&&(a.ccData=t[r+3]<<8|t[r+4],o.push(a));return o},Ce=function(e){for(var t,n,i=e.byteLength,r=[],a=1;a<i-2;)0===e[a]&&0===e[a+1]&&3===e[a+2]?(r.push(a+2),a+=2):a++;if(0===r.length)return e;t=i-r.length,n=new Uint8Array(t);var o=0;for(a=0;a<t;o++,a++)o===r[0]&&(o++,r.shift()),n[a]=e[o];return n},we=4,ke=function e(){e.prototype.init.call(this),this.captionPackets_=[],this.ccStreams_=[new Re(0,0),new Re(0,1),new Re(1,0),new Re(1,1)],this.reset(),this.ccStreams_.forEach(function(e){e.on("data",this.trigger.bind(this,"data")),e.on("done",this.trigger.bind(this,"done"))},this)};(ke.prototype=new Z).push=function(e){var t,n,i;if("sei_rbsp"===e.nalUnitType&&(t=_e(e.escapedRBSP)).payloadType===we&&(n=Te(t)))if(e.dts<this.latestDts_)this.ignoreNextEqualDts_=!0;else{if(e.dts===this.latestDts_&&this.ignoreNextEqualDts_)return this.numSameDts_--,void(this.numSameDts_||(this.ignoreNextEqualDts_=!1));i=Ee(e.pts,n),this.captionPackets_=this.captionPackets_.concat(i),this.latestDts_!==e.dts&&(this.numSameDts_=0),this.numSameDts_++,this.latestDts_=e.dts}},ke.prototype.flush=function(){this.captionPackets_.length?(this.captionPackets_.forEach(function(e,t){e.presortIndex=t}),this.captionPackets_.sort(function(e,t){return e.pts===t.pts?e.presortIndex-t.presortIndex:e.pts-t.pts}),this.captionPackets_.forEach(function(e){e.type<2&&this.dispatchCea608Packet(e)},this),this.captionPackets_.length=0,this.ccStreams_.forEach(function(e){e.flush()},this)):this.ccStreams_.forEach(function(e){e.flush()},this)},ke.prototype.reset=function(){this.latestDts_=null,this.ignoreNextEqualDts_=!1,this.numSameDts_=0,this.activeCea608Channel_=[null,null],this.ccStreams_.forEach(function(e){e.reset()})},ke.prototype.dispatchCea608Packet=function(e){this.setsTextOrXDSActive(e)?this.activeCea608Channel_[e.type]=null:this.setsChannel1Active(e)?this.activeCea608Channel_[e.type]=0:this.setsChannel2Active(e)&&(this.activeCea608Channel_[e.type]=1),null!==this.activeCea608Channel_[e.type]&&this.ccStreams_[(e.type<<1)+this.activeCea608Channel_[e.type]].push(e)},ke.prototype.setsChannel1Active=function(e){return 4096==(30720&e.ccData)},ke.prototype.setsChannel2Active=function(e){return 6144==(30720&e.ccData)},ke.prototype.setsTextOrXDSActive=function(e){return 256==(28928&e.ccData)||4138==(30974&e.ccData)||6186==(30974&e.ccData)};var Se={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,304:174,305:176,306:189,307:191,308:8482,309:162,310:163,311:9834,312:224,313:160,314:232,315:226,316:234,317:238,318:244,319:251,544:193,545:201,546:211,547:218,548:220,549:252,550:8216,551:161,552:42,553:39,554:8212,555:169,556:8480,557:8226,558:8220,559:8221,560:192,561:194,562:199,563:200,564:202,565:203,566:235,567:206,568:207,569:239,570:212,571:217,572:249,573:219,574:171,575:187,800:195,801:227,802:205,803:204,804:236,805:210,806:242,807:213,808:245,809:123,810:125,811:92,812:94,813:95,814:124,815:126,816:196,817:228,818:214,819:246,820:223,821:165,822:164,823:9474,824:197,825:229,826:216,827:248,828:9484,829:9488,830:9492,831:9496},Ie=function(e){return null===e?"":(e=Se[e]||e,String.fromCharCode(e))},Oe=[4352,4384,4608,4640,5376,5408,5632,5664,5888,5920,4096,4864,4896,5120,5152],De=function(){for(var e=[],t=15;t--;)e.push("");return e},Re=function e(t,n){e.prototype.init.call(this),this.field_=t||0,this.dataChannel_=n||0,this.name_="CC"+(1+(this.field_<<1|this.dataChannel_)),this.setConstants(),this.reset(),this.push=function(e){var t,n,i,r,a;if((t=32639&e.ccData)!==this.lastControlCode_){if(4096==(61440&t)?this.lastControlCode_=t:t!==this.PADDING_&&(this.lastControlCode_=null),i=t>>>8,r=255&t,t!==this.PADDING_)if(t===this.RESUME_CAPTION_LOADING_)this.mode_="popOn";else if(t===this.END_OF_CAPTION_)this.mode_="popOn",this.clearFormatting(e.pts),this.flushDisplayed(e.pts),n=this.displayed_,this.displayed_=this.nonDisplayed_,this.nonDisplayed_=n,this.startPts_=e.pts;else if(t===this.ROLL_UP_2_ROWS_)this.rollUpRows_=2,this.setRollUp(e.pts);else if(t===this.ROLL_UP_3_ROWS_)this.rollUpRows_=3,this.setRollUp(e.pts);else if(t===this.ROLL_UP_4_ROWS_)this.rollUpRows_=4,this.setRollUp(e.pts);else if(t===this.CARRIAGE_RETURN_)this.clearFormatting(e.pts),this.flushDisplayed(e.pts),this.shiftRowsUp_(),this.startPts_=e.pts;else if(t===this.BACKSPACE_)"popOn"===this.mode_?this.nonDisplayed_[this.row_]=this.nonDisplayed_[this.row_].slice(0,-1):this.displayed_[this.row_]=this.displayed_[this.row_].slice(0,-1);else if(t===this.ERASE_DISPLAYED_MEMORY_)this.flushDisplayed(e.pts),this.displayed_=De();else if(t===this.ERASE_NON_DISPLAYED_MEMORY_)this.nonDisplayed_=De();else if(t===this.RESUME_DIRECT_CAPTIONING_)"paintOn"!==this.mode_&&(this.flushDisplayed(e.pts),this.displayed_=De()),this.mode_="paintOn",this.startPts_=e.pts;else if(this.isSpecialCharacter(i,r))a=Ie((i=(3&i)<<8)|r),this[this.mode_](e.pts,a),this.column_++;else if(this.isExtCharacter(i,r))"popOn"===this.mode_?this.nonDisplayed_[this.row_]=this.nonDisplayed_[this.row_].slice(0,-1):this.displayed_[this.row_]=this.displayed_[this.row_].slice(0,-1),a=Ie((i=(3&i)<<8)|r),this[this.mode_](e.pts,a),this.column_++;else if(this.isMidRowCode(i,r))this.clearFormatting(e.pts),this[this.mode_](e.pts," "),this.column_++,14==(14&r)&&this.addFormatting(e.pts,["i"]),1==(1&r)&&this.addFormatting(e.pts,["u"]);else if(this.isOffsetControlCode(i,r))this.column_+=3&r;else if(this.isPAC(i,r)){var o=Oe.indexOf(7968&t);"rollUp"===this.mode_&&(o-this.rollUpRows_+1<0&&(o=this.rollUpRows_-1),this.setRollUp(e.pts,o)),o!==this.row_&&(this.clearFormatting(e.pts),this.row_=o),1&r&&-1===this.formatting_.indexOf("u")&&this.addFormatting(e.pts,["u"]),16==(16&t)&&(this.column_=4*((14&t)>>1)),this.isColorPAC(r)&&14==(14&r)&&this.addFormatting(e.pts,["i"])}else this.isNormalChar(i)&&(0===r&&(r=null),a=Ie(i),a+=Ie(r),this[this.mode_](e.pts,a),this.column_+=a.length)}else this.lastControlCode_=null}};Re.prototype=new Z,Re.prototype.flushDisplayed=function(e){var t=this.displayed_.map(function(e){try{return e.trim()}catch(e){return console.error("Skipping malformed caption."),""}}).join("\n").replace(/^\n+|\n+$/g,"");t.length&&this.trigger("data",{startPts:this.startPts_,endPts:e,text:t,stream:this.name_})},Re.prototype.reset=function(){this.mode_="popOn",this.topRow_=0,this.startPts_=0,this.displayed_=De(),this.nonDisplayed_=De(),this.lastControlCode_=null,this.column_=0,this.row_=14,this.rollUpRows_=2,this.formatting_=[]},Re.prototype.setConstants=function(){0===this.dataChannel_?(this.BASE_=16,this.EXT_=17,this.CONTROL_=(20|this.field_)<<8,this.OFFSET_=23):1===this.dataChannel_&&(this.BASE_=24,this.EXT_=25,this.CONTROL_=(28|this.field_)<<8,this.OFFSET_=31),this.PADDING_=0,this.RESUME_CAPTION_LOADING_=32|this.CONTROL_,this.END_OF_CAPTION_=47|this.CONTROL_,this.ROLL_UP_2_ROWS_=37|this.CONTROL_,this.ROLL_UP_3_ROWS_=38|this.CONTROL_,this.ROLL_UP_4_ROWS_=39|this.CONTROL_,this.CARRIAGE_RETURN_=45|this.CONTROL_,this.RESUME_DIRECT_CAPTIONING_=41|this.CONTROL_,this.BACKSPACE_=33|this.CONTROL_,this.ERASE_DISPLAYED_MEMORY_=44|this.CONTROL_,this.ERASE_NON_DISPLAYED_MEMORY_=46|this.CONTROL_},Re.prototype.isSpecialCharacter=function(e,t){return e===this.EXT_&&t>=48&&t<=63},Re.prototype.isExtCharacter=function(e,t){return(e===this.EXT_+1||e===this.EXT_+2)&&t>=32&&t<=63},Re.prototype.isMidRowCode=function(e,t){return e===this.EXT_&&t>=32&&t<=47},Re.prototype.isOffsetControlCode=function(e,t){return e===this.OFFSET_&&t>=33&&t<=35},Re.prototype.isPAC=function(e,t){return e>=this.BASE_&&e<this.BASE_+8&&t>=64&&t<=127},Re.prototype.isColorPAC=function(e){return e>=64&&e<=79||e>=96&&e<=127},Re.prototype.isNormalChar=function(e){return e>=32&&e<=127},Re.prototype.setRollUp=function(e,t){if("rollUp"!==this.mode_&&(this.row_=14,this.mode_="rollUp",this.flushDisplayed(e),this.nonDisplayed_=De(),this.displayed_=De()),void 0!==t&&t!==this.row_)for(var n=0;n<this.rollUpRows_;n++)this.displayed_[t-n]=this.displayed_[this.row_-n],this.displayed_[this.row_-n]="";void 0===t&&(t=this.row_),this.topRow_=t-this.rollUpRows_+1},Re.prototype.addFormatting=function(e,t){this.formatting_=this.formatting_.concat(t);var n=t.reduce(function(e,t){return e+"<"+t+">"},"");this[this.mode_](e,n)},Re.prototype.clearFormatting=function(e){if(this.formatting_.length){var t=this.formatting_.reverse().reduce(function(e,t){return e+"</"+t+">"},"");this.formatting_=[],this[this.mode_](e,t)}},Re.prototype.popOn=function(e,t){var n=this.nonDisplayed_[this.row_];n+=t,this.nonDisplayed_[this.row_]=n},Re.prototype.rollUp=function(e,t){var n=this.displayed_[this.row_];n+=t,this.displayed_[this.row_]=n},Re.prototype.shiftRowsUp_=function(){var e;for(e=0;e<this.topRow_;e++)this.displayed_[e]="";for(e=this.row_+1;e<15;e++)this.displayed_[e]="";for(e=this.topRow_;e<this.row_;e++)this.displayed_[e]=this.displayed_[e+1];this.displayed_[this.row_]=""},Re.prototype.paintOn=function(e,t){var n=this.displayed_[this.row_];n+=t,this.displayed_[this.row_]=n};var xe={CaptionStream:ke,Cea608Stream:Re},Ae={H264_STREAM_TYPE:27,ADTS_STREAM_TYPE:15,METADATA_STREAM_TYPE:21},Pe=function(e,t){var n=1;for(e>t&&(n=-1);Math.abs(t-e)>4294967296;)e+=8589934592*n;return e},Le=function e(t){var n,i;e.prototype.init.call(this),this.type_=t,this.push=function(e){e.type===this.type_&&(void 0===i&&(i=e.dts),e.dts=Pe(e.dts,i),e.pts=Pe(e.pts,i),n=e.dts,this.trigger("data",e))},this.flush=function(){i=n,this.trigger("done")},this.discontinuity=function(){i=void 0,n=void 0}};Le.prototype=new Z;var Ne,Me=Le,Ke=function(e,t,n){var i,r="";for(i=t;i<n;i++)r+="%"+("00"+e[i].toString(16)).slice(-2);return r},$e=function(e,t,n){return decodeURIComponent(Ke(e,t,n))},je=function(e){return e[0]<<21|e[1]<<14|e[2]<<7|e[3]},Be={TXXX:function(e){var t;if(3===e.data[0]){for(t=1;t<e.data.length;t++)if(0===e.data[t]){e.description=$e(e.data,1,t),e.value=$e(e.data,t+1,e.data.length).replace(/\0*$/,"");break}e.data=e.value}},WXXX:function(e){var t;if(3===e.data[0])for(t=1;t<e.data.length;t++)if(0===e.data[t]){e.description=$e(e.data,1,t),e.url=$e(e.data,t+1,e.data.length);break}},PRIV:function(e){var t,n;for(t=0;t<e.data.length;t++)if(0===e.data[t]){e.owner=(n=e.data,unescape(Ke(n,start,end)));break}e.privateData=e.data.subarray(t+1),e.data=e.privateData}};(Ne=function(e){var t,n={debug:!(!e||!e.debug),descriptor:e&&e.descriptor},i=0,r=[],a=0;if(Ne.prototype.init.call(this),this.dispatchType=Ae.METADATA_STREAM_TYPE.toString(16),n.descriptor)for(t=0;t<n.descriptor.length;t++)this.dispatchType+=("00"+n.descriptor[t].toString(16)).slice(-2);this.push=function(e){var t,o,s,l,u;if("timed-metadata"===e.type)if(e.dataAlignmentIndicator&&(a=0,r.length=0),0===r.length&&(e.data.length<10||e.data[0]!=="I".charCodeAt(0)||e.data[1]!=="D".charCodeAt(0)||e.data[2]!=="3".charCodeAt(0)))n.debug&&console.log("Skipping unrecognized metadata packet");else if(r.push(e),a+=e.data.byteLength,1===r.length&&(i=je(e.data.subarray(6,10)),i+=10),!(a<i)){for(t={data:new Uint8Array(i),frames:[],pts:r[0].pts,dts:r[0].dts},u=0;u<i;)t.data.set(r[0].data.subarray(0,i-u),u),u+=r[0].data.byteLength,a-=r[0].data.byteLength,r.shift();o=10,64&t.data[5]&&(o+=4,o+=je(t.data.subarray(10,14)),i-=je(t.data.subarray(16,20)));do{if((s=je(t.data.subarray(o+4,o+8)))<1)return console.log("Malformed ID3 frame encountered. Skipping metadata parsing.");if((l={id:String.fromCharCode(t.data[o],t.data[o+1],t.data[o+2],t.data[o+3]),data:t.data.subarray(o+10,o+s+10)}).key=l.id,Be[l.id]&&(Be[l.id](l),"com.apple.streaming.transportStreamTimestamp"===l.owner)){var c=l.data,d=(1&c[3])<<30|c[4]<<22|c[5]<<14|c[6]<<6|c[7]>>>2;d*=4,d+=3&c[7],l.timeStamp=d,void 0===t.pts&&void 0===t.dts&&(t.pts=l.timeStamp,t.dts=l.timeStamp),this.trigger("timestamp",l)}t.frames.push(l),o+=10,o+=s}while(o<i);this.trigger("data",t)}}}).prototype=new Z;var Fe,Ue,Ve,qe=Ne,He=Me;(Fe=function(){var e=new Uint8Array(188),t=0;Fe.prototype.init.call(this),this.push=function(n){var i,r=0,a=188;for(t?((i=new Uint8Array(n.byteLength+t)).set(e.subarray(0,t)),i.set(n,t),t=0):i=n;a<i.byteLength;)71!==i[r]||71!==i[a]?(r++,a++):(this.trigger("data",i.subarray(r,a)),r+=188,a+=188);r<i.byteLength&&(e.set(i.subarray(r),0),t=i.byteLength-r)},this.flush=function(){188===t&&71===e[0]&&(this.trigger("data",e),t=0),this.trigger("done")}}).prototype=new Z,(Ue=function(){var e,t,n,i;Ue.prototype.init.call(this),i=this,this.packetsWaitingForPmt=[],this.programMapTable=void 0,e=function(e,i){var r=0;i.payloadUnitStartIndicator&&(r+=e[r]+1),"pat"===i.type?t(e.subarray(r),i):n(e.subarray(r),i)},t=function(e,t){t.section_number=e[7],t.last_section_number=e[8],i.pmtPid=(31&e[10])<<8|e[11],t.pmtPid=i.pmtPid},n=function(e,t){var n,r;if(1&e[5]){for(i.programMapTable={video:null,audio:null,"timed-metadata":{}},n=3+((15&e[1])<<8|e[2])-4,r=12+((15&e[10])<<8|e[11]);r<n;){var a=e[r],o=(31&e[r+1])<<8|e[r+2];a===Ae.H264_STREAM_TYPE&&null===i.programMapTable.video?i.programMapTable.video=o:a===Ae.ADTS_STREAM_TYPE&&null===i.programMapTable.audio?i.programMapTable.audio=o:a===Ae.METADATA_STREAM_TYPE&&(i.programMapTable["timed-metadata"][o]=a),r+=5+((15&e[r+3])<<8|e[r+4])}t.programMapTable=i.programMapTable}},this.push=function(t){var n={},i=4;if(n.payloadUnitStartIndicator=!!(64&t[1]),n.pid=31&t[1],n.pid<<=8,n.pid|=t[2],(48&t[3])>>>4>1&&(i+=t[i]+1),0===n.pid)n.type="pat",e(t.subarray(i),n),this.trigger("data",n);else if(n.pid===this.pmtPid)for(n.type="pmt",e(t.subarray(i),n),this.trigger("data",n);this.packetsWaitingForPmt.length;)this.processPes_.apply(this,this.packetsWaitingForPmt.shift());else void 0===this.programMapTable?this.packetsWaitingForPmt.push([t,i,n]):this.processPes_(t,i,n)},this.processPes_=function(e,t,n){n.pid===this.programMapTable.video?n.streamType=Ae.H264_STREAM_TYPE:n.pid===this.programMapTable.audio?n.streamType=Ae.ADTS_STREAM_TYPE:n.streamType=this.programMapTable["timed-metadata"][n.pid],n.type="pes",n.data=e.subarray(t),this.trigger("data",n)}}).prototype=new Z,Ue.STREAM_TYPES={h264:27,adts:15},(Ve=function(){var e=this,t={data:[],size:0},n={data:[],size:0},i={data:[],size:0},r=function(t,n,i){var r,a,o,s,l=new Uint8Array(t.size),u={type:n},c=0,d=0,h=!1;if(t.data.length&&!(t.size<9)){for(u.trackId=t.data[0].pid,c=0;c<t.data.length;c++)r=t.data[c],l.set(r.data,d),d+=r.data.byteLength;a=l,(o=u).packetLength=6+(a[4]<<8|a[5]),o.dataAlignmentIndicator=0!=(4&a[6]),192&(s=a[7])&&(o.pts=(14&a[9])<<27|(255&a[10])<<20|(254&a[11])<<12|(255&a[12])<<5|(254&a[13])>>>3,o.pts*=4,o.pts+=(6&a[13])>>>1,o.dts=o.pts,64&s&&(o.dts=(14&a[14])<<27|(255&a[15])<<20|(254&a[16])<<12|(255&a[17])<<5|(254&a[18])>>>3,o.dts*=4,o.dts+=(6&a[18])>>>1)),o.data=a.subarray(9+a[8]),h="video"===n||u.packetLength<=t.size,(i||h)&&(t.size=0,t.data.length=0),h&&e.trigger("data",u)}};Ve.prototype.init.call(this),this.push=function(a){({pat:function(){},pes:function(){var e,o;switch(a.streamType){case Ae.H264_STREAM_TYPE:case Ae.H264_STREAM_TYPE:e=t,o="video";break;case Ae.ADTS_STREAM_TYPE:e=n,o="audio";break;case Ae.METADATA_STREAM_TYPE:e=i,o="timed-metadata";break;default:return}a.payloadUnitStartIndicator&&r(e,o,!0),e.data.push(a),e.size+=a.data.byteLength},pmt:function(){var t={type:"metadata",tracks:[]},n=a.programMapTable;null!==n.video&&t.tracks.push({timelineStartInfo:{baseMediaDecodeTime:0},id:+n.video,codec:"avc",type:"video"}),null!==n.audio&&t.tracks.push({timelineStartInfo:{baseMediaDecodeTime:0},id:+n.audio,codec:"adts",type:"audio"}),e.trigger("data",t)}})[a.type]()},this.flush=function(){r(t,"video"),r(n,"audio"),r(i,"timed-metadata"),this.trigger("done")}}).prototype=new Z;var ze={PAT_PID:0,MP2T_PACKET_LENGTH:188,TransportPacketStream:Fe,TransportParseStream:Ue,ElementaryStream:Ve,TimestampRolloverStream:He,CaptionStream:xe.CaptionStream,Cea608Stream:xe.Cea608Stream,MetadataStream:qe};for(var We in Ae)Ae.hasOwnProperty(We)&&(ze[We]=Ae[We]);var Ge,Xe=ze,Ye=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350];(Ge=function(){var e;Ge.prototype.init.call(this),this.push=function(t){var n,i,r,a,o,s,l=0,u=0;if("audio"===t.type)for(e?(a=e,(e=new Uint8Array(a.byteLength+t.data.byteLength)).set(a),e.set(t.data,a.byteLength)):e=t.data;l+5<e.length;)if(255===e[l]&&240==(246&e[l+1])){if(i=2*(1&~e[l+1]),n=(3&e[l+3])<<11|e[l+4]<<3|(224&e[l+5])>>5,s=9e4*(o=1024*(1+(3&e[l+6])))/Ye[(60&e[l+2])>>>2],r=l+n,e.byteLength<r)return;if(this.trigger("data",{pts:t.pts+u*s,dts:t.dts+u*s,sampleCount:o,audioobjecttype:1+(e[l+2]>>>6&3),channelcount:(1&e[l+2])<<2|(192&e[l+3])>>>6,samplerate:Ye[(60&e[l+2])>>>2],samplingfrequencyindex:(60&e[l+2])>>>2,samplesize:16,data:e.subarray(l+7+i,r)}),e.byteLength===r)return void(e=void 0);u++,e=e.subarray(r)}else l++},this.flush=function(){this.trigger("done")}}).prototype=new Z;var Qe,Je,Ze,et=Ge;(Je=function(){var e,t,n=0;Je.prototype.init.call(this),this.push=function(i){var r;for(t?((r=new Uint8Array(t.byteLength+i.data.byteLength)).set(t),r.set(i.data,t.byteLength),t=r):t=i.data;n<t.byteLength-3;n++)if(1===t[n+2]){e=n+5;break}for(;e<t.byteLength;)switch(t[e]){case 0:if(0!==t[e-1]){e+=2;break}if(0!==t[e-2]){e++;break}n+3!==e-2&&this.trigger("data",t.subarray(n+3,e-2));do{e++}while(1!==t[e]&&e<t.length);n=e-2,e+=3;break;case 1:if(0!==t[e-1]||0!==t[e-2]){e+=3;break}this.trigger("data",t.subarray(n+3,e-2)),n=e-2,e+=3;break;default:e+=3}t=t.subarray(n),e-=n,n=0},this.flush=function(){t&&t.byteLength>3&&this.trigger("data",t.subarray(n+3)),t=null,n=0,this.trigger("done")}}).prototype=new Z,Ze={100:!0,110:!0,122:!0,244:!0,44:!0,83:!0,86:!0,118:!0,128:!0,138:!0,139:!0,134:!0},(Qe=function(){var e,t,n,i,r,a,o,s=new Je;Qe.prototype.init.call(this),e=this,this.push=function(e){"video"===e.type&&(t=e.trackId,n=e.pts,i=e.dts,s.push(e))},s.on("data",function(o){var s={trackId:t,pts:n,dts:i,data:o};switch(31&o[0]){case 5:s.nalUnitType="slice_layer_without_partitioning_rbsp_idr";break;case 6:s.nalUnitType="sei_rbsp",s.escapedRBSP=r(o.subarray(1));break;case 7:s.nalUnitType="seq_parameter_set_rbsp",s.escapedRBSP=r(o.subarray(1)),s.config=a(s.escapedRBSP);break;case 8:s.nalUnitType="pic_parameter_set_rbsp";break;case 9:s.nalUnitType="access_unit_delimiter_rbsp"}e.trigger("data",s)}),s.on("done",function(){e.trigger("done")}),this.flush=function(){s.flush()},o=function(e,t){var n,i=8,r=8;for(n=0;n<e;n++)0!==r&&(r=(i+t.readExpGolomb()+256)%256),i=0===r?i:r},r=function(e){for(var t,n,i=e.byteLength,r=[],a=1;a<i-2;)0===e[a]&&0===e[a+1]&&3===e[a+2]?(r.push(a+2),a+=2):a++;if(0===r.length)return e;t=i-r.length,n=new Uint8Array(t);var o=0;for(a=0;a<t;o++,a++)o===r[0]&&(o++,r.shift()),n[a]=e[o];return n},a=function(e){var t,n,i,r,a,s,l,u,c,d,h,p,f,g=0,m=0,v=0,y=0,b=1;if(t=new function(e){var t=e.byteLength,n=0,i=0;this.length=function(){return 8*t},this.bitsAvailable=function(){return 8*t+i},this.loadWord=function(){var r=e.byteLength-t,a=new Uint8Array(4),o=Math.min(4,t);if(0===o)throw new Error("no bytes available");a.set(e.subarray(r,r+o)),n=new DataView(a.buffer).getUint32(0),i=8*o,t-=o},this.skipBits=function(e){var r;i>e?(n<<=e,i-=e):(e-=i,e-=8*(r=Math.floor(e/8)),t-=r,this.loadWord(),n<<=e,i-=e)},this.readBits=function(e){var r=Math.min(i,e),a=n>>>32-r;return(i-=r)>0?n<<=r:t>0&&this.loadWord(),(r=e-r)>0?a<<r|this.readBits(r):a},this.skipLeadingZeros=function(){var e;for(e=0;e<i;++e)if(0!=(n&2147483648>>>e))return n<<=e,i-=e,e;return this.loadWord(),e+this.skipLeadingZeros()},this.skipUnsignedExpGolomb=function(){this.skipBits(1+this.skipLeadingZeros())},this.skipExpGolomb=function(){this.skipBits(1+this.skipLeadingZeros())},this.readUnsignedExpGolomb=function(){var e=this.skipLeadingZeros();return this.readBits(e+1)-1},this.readExpGolomb=function(){var e=this.readUnsignedExpGolomb();return 1&e?1+e>>>1:-1*(e>>>1)},this.readBoolean=function(){return 1===this.readBits(1)},this.readUnsignedByte=function(){return this.readBits(8)},this.loadWord()}(e),n=t.readUnsignedByte(),r=t.readUnsignedByte(),i=t.readUnsignedByte(),t.skipUnsignedExpGolomb(),Ze[n]&&(3===(a=t.readUnsignedExpGolomb())&&t.skipBits(1),t.skipUnsignedExpGolomb(),t.skipUnsignedExpGolomb(),t.skipBits(1),t.readBoolean()))for(h=3!==a?8:12,f=0;f<h;f++)t.readBoolean()&&o(f<6?16:64,t);if(t.skipUnsignedExpGolomb(),0===(s=t.readUnsignedExpGolomb()))t.readUnsignedExpGolomb();else if(1===s)for(t.skipBits(1),t.skipExpGolomb(),t.skipExpGolomb(),l=t.readUnsignedExpGolomb(),f=0;f<l;f++)t.skipExpGolomb();if(t.skipUnsignedExpGolomb(),t.skipBits(1),u=t.readUnsignedExpGolomb(),c=t.readUnsignedExpGolomb(),0===(d=t.readBits(1))&&t.skipBits(1),t.skipBits(1),t.readBoolean()&&(g=t.readUnsignedExpGolomb(),m=t.readUnsignedExpGolomb(),v=t.readUnsignedExpGolomb(),y=t.readUnsignedExpGolomb()),t.readBoolean()&&t.readBoolean()){switch(t.readUnsignedByte()){case 1:p=[1,1];break;case 2:p=[12,11];break;case 3:p=[10,11];break;case 4:p=[16,11];break;case 5:p=[40,33];break;case 6:p=[24,11];break;case 7:p=[20,11];break;case 8:p=[32,11];break;case 9:p=[80,33];break;case 10:p=[18,11];break;case 11:p=[15,11];break;case 12:p=[64,33];break;case 13:p=[160,99];break;case 14:p=[4,3];break;case 15:p=[3,2];break;case 16:p=[2,1];break;case 255:p=[t.readUnsignedByte()<<8|t.readUnsignedByte(),t.readUnsignedByte()<<8|t.readUnsignedByte()]}p&&(b=p[0]/p[1])}return{profileIdc:n,levelIdc:i,profileCompatibility:r,width:Math.ceil((16*(u+1)-2*g-2*m)*b),height:(2-d)*(c+1)*16-2*v-2*y}}}).prototype=new Z;var tt,nt={H264Stream:Qe,NalByteStream:Je},it=function(e){return e[0]==="I".charCodeAt(0)&&e[1]==="D".charCodeAt(0)&&e[2]==="3".charCodeAt(0)},rt=function(e,t){var n=e[t+6]<<21|e[t+7]<<14|e[t+8]<<7|e[t+9];return(16&e[t+5])>>4?n+20:n+10},at=function(e,t){var n=(224&e[t+5])>>5,i=e[t+4]<<3;return 6144&e[t+3]|i|n};(tt=function(){var e=new Uint8Array,t=0;tt.prototype.init.call(this),this.setTimestamp=function(e){t=e},this.push=function(n){var i,r,a,o,s=0,l=0;for(e.length?(o=e.length,(e=new Uint8Array(n.byteLength+o)).set(e.subarray(0,o)),e.set(n,o)):e=n;e.length-l>=3;)if(e[l]!=="I".charCodeAt(0)||e[l+1]!=="D".charCodeAt(0)||e[l+2]!=="3".charCodeAt(0))if(255!=(255&e[l])||240!=(240&e[l+1]))l++;else{if(e.length-l<7)break;if(l+(s=at(e,l))>e.length)break;a={type:"audio",data:e.subarray(l,l+s),pts:t,dts:t},this.trigger("data",a),l+=s}else{if(e.length-l<10)break;if(l+(s=rt(e,l))>e.length)break;r={type:"timed-metadata",data:e.subarray(l,l+s)},this.trigger("data",r),l+=s}i=e.length-l,e=i>0?e.subarray(l):new Uint8Array}}).prototype=new Z;var ot,st,lt,ut,ct=tt,dt=nt.H264Stream,ht=it,pt=["audioobjecttype","channelcount","samplerate","samplingfrequencyindex","samplesize"],ft=["width","height","profileIdc","levelIdc","profileCompatibility"],gt=function(e,t){var n;if(e.length!==t.length)return!1;for(n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0},mt=function(e,t,n,i,r,a){return{start:{dts:e,pts:e+(n-t)},end:{dts:e+(i-t),pts:e+(r-n)},prependedContentDuration:a,baseMediaDecodeTime:e}};(st=function(e,t){var n=[],i=0,r=0,a=0,o=1/0;t=t||{},st.prototype.init.call(this),this.push=function(t){be(e,t),e&&pt.forEach(function(n){e[n]=t[n]}),n.push(t)},this.setEarliestDts=function(t){r=t-e.timelineStartInfo.baseMediaDecodeTime},this.setVideoBaseMediaDecodeTime=function(e){o=e},this.setAudioAppendStart=function(e){a=e},this.flush=function(){var s,l,u,c;0!==n.length?(s=fe(n,e,r),e.baseMediaDecodeTime=ye(e,t.keepOriginalTimestamps),pe(e,s,a,o),e.samples=ge(s),u=q.mdat(me(s)),n=[],l=q.moof(i,[e]),c=new Uint8Array(l.byteLength+u.byteLength),i++,c.set(l),c.set(u,l.byteLength),ve(e),this.trigger("data",{track:e,boxes:c}),this.trigger("done","AudioSegmentStream")):this.trigger("done","AudioSegmentStream")}}).prototype=new Z,(ot=function(e,t){var n,i,r=0,a=[],o=[];t=t||{},ot.prototype.init.call(this),delete e.minPTS,this.gopCache_=[],this.push=function(t){be(e,t),"seq_parameter_set_rbsp"!==t.nalUnitType||n||(n=t.config,e.sps=[t.data],ft.forEach(function(t){e[t]=n[t]},this)),"pic_parameter_set_rbsp"!==t.nalUnitType||i||(i=t.data,e.pps=[t.data]),a.push(t)},this.flush=function(){for(var n,i,s,l,u,c,d,h,p=0;a.length&&"access_unit_delimiter_rbsp"!==a[0].nalUnitType;)a.shift();if(0===a.length)return this.resetStream_(),void this.trigger("done","VideoSegmentStream");if(n=te(a),(s=ne(n))[0][0].keyFrame||((i=this.getGopForFusion_(a[0],e))?(p=i.duration,s.unshift(i),s.byteLength+=i.byteLength,s.nalCount+=i.nalCount,s.pts=i.pts,s.dts=i.dts,s.duration+=i.duration):s=ie(s)),o.length){var f;if(!(f=t.alignGopsAtEnd?this.alignGopsAtEnd_(s):this.alignGopsAtStart_(s)))return this.gopCache_.unshift({gop:s.pop(),pps:e.pps,sps:e.sps}),this.gopCache_.length=Math.min(6,this.gopCache_.length),a=[],this.resetStream_(),void this.trigger("done","VideoSegmentStream");ve(e),s=f}be(e,s),e.samples=re(s),u=q.mdat(ae(s)),e.baseMediaDecodeTime=ye(e,t.keepOriginalTimestamps),this.trigger("processedGopsInfo",s.map(function(e){return{pts:e.pts,dts:e.dts,byteLength:e.byteLength}})),d=s[0],h=s[s.length-1],this.trigger("segmentTimingInfo",mt(e.baseMediaDecodeTime,d.dts,d.pts,h.dts+h.duration,h.pts+h.duration,p)),this.gopCache_.unshift({gop:s.pop(),pps:e.pps,sps:e.sps}),this.gopCache_.length=Math.min(6,this.gopCache_.length),a=[],this.trigger("baseMediaDecodeTime",e.baseMediaDecodeTime),this.trigger("timelineStartInfo",e.timelineStartInfo),l=q.moof(r,[e]),c=new Uint8Array(l.byteLength+u.byteLength),r++,c.set(l),c.set(u,l.byteLength),this.trigger("data",{track:e,boxes:c}),this.resetStream_(),this.trigger("done","VideoSegmentStream")},this.resetStream_=function(){ve(e),n=void 0,i=void 0},this.getGopForFusion_=function(t){var n,i,r,a,o,s=1/0;for(o=0;o<this.gopCache_.length;o++)r=(a=this.gopCache_[o]).gop,e.pps&&gt(e.pps[0],a.pps[0])&&e.sps&&gt(e.sps[0],a.sps[0])&&(r.dts<e.timelineStartInfo.dts||(n=t.dts-r.dts-r.duration)>=-1e4&&n<=45e3&&(!i||s>n)&&(i=a,s=n));return i?i.gop:null},this.alignGopsAtStart_=function(e){var t,n,i,r,a,s,l,u;for(a=e.byteLength,s=e.nalCount,l=e.duration,t=n=0;t<o.length&&n<e.length&&(i=o[t],r=e[n],i.pts!==r.pts);)r.pts>i.pts?t++:(n++,a-=r.byteLength,s-=r.nalCount,l-=r.duration);return 0===n?e:n===e.length?null:((u=e.slice(n)).byteLength=a,u.duration=l,u.nalCount=s,u.pts=u[0].pts,u.dts=u[0].dts,u)},this.alignGopsAtEnd_=function(e){var t,n,i,r,a,s,l;for(t=o.length-1,n=e.length-1,a=null,s=!1;t>=0&&n>=0;){if(i=o[t],r=e[n],i.pts===r.pts){s=!0;break}i.pts>r.pts?t--:(t===o.length-1&&(a=n),n--)}if(!s&&null===a)return null;if(0===(l=s?n:a))return e;var u=e.slice(l),c=u.reduce(function(e,t){return e.byteLength+=t.byteLength,e.duration+=t.duration,e.nalCount+=t.nalCount,e},{byteLength:0,duration:0,nalCount:0});return u.byteLength=c.byteLength,u.duration=c.duration,u.nalCount=c.nalCount,u.pts=u[0].pts,u.dts=u[0].dts,u},this.alignGopsWith=function(e){o=e}}).prototype=new Z,(ut=function(e,t){this.numberOfTracks=0,this.metadataStream=t,void 0!==(e=e||{}).remux?this.remuxTracks=!!e.remux:this.remuxTracks=!0,"boolean"==typeof e.keepOriginalTimestamps&&(this.keepOriginalTimestamps=e.keepOriginalTimestamps),this.pendingTracks=[],this.videoTrack=null,this.pendingBoxes=[],this.pendingCaptions=[],this.pendingMetadata=[],this.pendingBytes=0,this.emittedTracks=0,ut.prototype.init.call(this),this.push=function(e){return e.text?this.pendingCaptions.push(e):e.frames?this.pendingMetadata.push(e):(this.pendingTracks.push(e.track),this.pendingBoxes.push(e.boxes),this.pendingBytes+=e.boxes.byteLength,"video"===e.track.type&&(this.videoTrack=e.track),void("audio"===e.track.type&&(this.audioTrack=e.track)))}}).prototype=new Z,ut.prototype.flush=function(e){var t,n,i,r,a=0,o={captions:[],captionStreams:{},metadata:[],info:{}},s=0;if(this.pendingTracks.length<this.numberOfTracks){if("VideoSegmentStream"!==e&&"AudioSegmentStream"!==e)return;if(this.remuxTracks)return;if(0===this.pendingTracks.length)return this.emittedTracks++,void(this.emittedTracks>=this.numberOfTracks&&(this.trigger("done"),this.emittedTracks=0))}for(this.videoTrack?(s=this.videoTrack.timelineStartInfo.pts,ft.forEach(function(e){o.info[e]=this.videoTrack[e]},this)):this.audioTrack&&(s=this.audioTrack.timelineStartInfo.pts,pt.forEach(function(e){o.info[e]=this.audioTrack[e]},this)),1===this.pendingTracks.length?o.type=this.pendingTracks[0].type:o.type="combined",this.emittedTracks+=this.pendingTracks.length,i=q.initSegment(this.pendingTracks),o.initSegment=new Uint8Array(i.byteLength),o.initSegment.set(i),o.data=new Uint8Array(this.pendingBytes),r=0;r<this.pendingBoxes.length;r++)o.data.set(this.pendingBoxes[r],a),a+=this.pendingBoxes[r].byteLength;for(r=0;r<this.pendingCaptions.length;r++)(t=this.pendingCaptions[r]).startTime=t.startPts,this.keepOriginalTimestamps||(t.startTime-=s),t.startTime/=9e4,t.endTime=t.endPts,this.keepOriginalTimestamps||(t.endTime-=s),t.endTime/=9e4,o.captionStreams[t.stream]=!0,o.captions.push(t);for(r=0;r<this.pendingMetadata.length;r++)(n=this.pendingMetadata[r]).cueTime=n.pts,this.keepOriginalTimestamps||(n.cueTime-=s),n.cueTime/=9e4,o.metadata.push(n);o.metadata.dispatchType=this.metadataStream.dispatchType,this.pendingTracks.length=0,this.videoTrack=null,this.pendingBoxes.length=0,this.pendingCaptions.length=0,this.pendingBytes=0,this.pendingMetadata.length=0,this.trigger("data",o),this.emittedTracks>=this.numberOfTracks&&(this.trigger("done"),this.emittedTracks=0)},(lt=function(e){var t,n,i=this,r=!0;lt.prototype.init.call(this),e=e||{},this.baseMediaDecodeTime=e.baseMediaDecodeTime||0,this.transmuxPipeline_={},this.setupAacPipeline=function(){var t={};this.transmuxPipeline_=t,t.type="aac",t.metadataStream=new Xe.MetadataStream,t.aacStream=new ct,t.audioTimestampRolloverStream=new Xe.TimestampRolloverStream("audio"),t.timedMetadataTimestampRolloverStream=new Xe.TimestampRolloverStream("timed-metadata"),t.adtsStream=new et,t.coalesceStream=new ut(e,t.metadataStream),t.headOfPipeline=t.aacStream,t.aacStream.pipe(t.audioTimestampRolloverStream).pipe(t.adtsStream),t.aacStream.pipe(t.timedMetadataTimestampRolloverStream).pipe(t.metadataStream).pipe(t.coalesceStream),t.metadataStream.on("timestamp",function(e){t.aacStream.setTimestamp(e.timeStamp)}),t.aacStream.on("data",function(r){"timed-metadata"!==r.type||t.audioSegmentStream||(n=n||{timelineStartInfo:{baseMediaDecodeTime:i.baseMediaDecodeTime},codec:"adts",type:"audio"},t.coalesceStream.numberOfTracks++,t.audioSegmentStream=new st(n,e),t.adtsStream.pipe(t.audioSegmentStream).pipe(t.coalesceStream))}),t.coalesceStream.on("data",this.trigger.bind(this,"data")),t.coalesceStream.on("done",this.trigger.bind(this,"done"))},this.setupTsPipeline=function(){var r={};this.transmuxPipeline_=r,r.type="ts",r.metadataStream=new Xe.MetadataStream,r.packetStream=new Xe.TransportPacketStream,r.parseStream=new Xe.TransportParseStream,r.elementaryStream=new Xe.ElementaryStream,r.videoTimestampRolloverStream=new Xe.TimestampRolloverStream("video"),r.audioTimestampRolloverStream=new Xe.TimestampRolloverStream("audio"),r.timedMetadataTimestampRolloverStream=new Xe.TimestampRolloverStream("timed-metadata"),r.adtsStream=new et,r.h264Stream=new dt,r.captionStream=new Xe.CaptionStream,r.coalesceStream=new ut(e,r.metadataStream),r.headOfPipeline=r.packetStream,r.packetStream.pipe(r.parseStream).pipe(r.elementaryStream),r.elementaryStream.pipe(r.videoTimestampRolloverStream).pipe(r.h264Stream),r.elementaryStream.pipe(r.audioTimestampRolloverStream).pipe(r.adtsStream),r.elementaryStream.pipe(r.timedMetadataTimestampRolloverStream).pipe(r.metadataStream).pipe(r.coalesceStream),r.h264Stream.pipe(r.captionStream).pipe(r.coalesceStream),r.elementaryStream.on("data",function(a){var o;if("metadata"===a.type){for(o=a.tracks.length;o--;)t||"video"!==a.tracks[o].type?n||"audio"!==a.tracks[o].type||((n=a.tracks[o]).timelineStartInfo.baseMediaDecodeTime=i.baseMediaDecodeTime):(t=a.tracks[o]).timelineStartInfo.baseMediaDecodeTime=i.baseMediaDecodeTime;t&&!r.videoSegmentStream&&(r.coalesceStream.numberOfTracks++,r.videoSegmentStream=new ot(t,e),r.videoSegmentStream.on("timelineStartInfo",function(e){n&&(n.timelineStartInfo=e,r.audioSegmentStream.setEarliestDts(e.dts))}),r.videoSegmentStream.on("processedGopsInfo",i.trigger.bind(i,"gopInfo")),r.videoSegmentStream.on("segmentTimingInfo",i.trigger.bind(i,"videoSegmentTimingInfo")),r.videoSegmentStream.on("baseMediaDecodeTime",function(e){n&&r.audioSegmentStream.setVideoBaseMediaDecodeTime(e)}),r.h264Stream.pipe(r.videoSegmentStream).pipe(r.coalesceStream)),n&&!r.audioSegmentStream&&(r.coalesceStream.numberOfTracks++,r.audioSegmentStream=new st(n,e),r.adtsStream.pipe(r.audioSegmentStream).pipe(r.coalesceStream))}}),r.coalesceStream.on("data",this.trigger.bind(this,"data")),r.coalesceStream.on("done",this.trigger.bind(this,"done"))},this.setBaseMediaDecodeTime=function(i){var r=this.transmuxPipeline_;e.keepOriginalTimestamps||(this.baseMediaDecodeTime=i),n&&(n.timelineStartInfo.dts=void 0,n.timelineStartInfo.pts=void 0,ve(n),e.keepOriginalTimestamps||(n.timelineStartInfo.baseMediaDecodeTime=i),r.audioTimestampRolloverStream&&r.audioTimestampRolloverStream.discontinuity()),t&&(r.videoSegmentStream&&(r.videoSegmentStream.gopCache_=[],r.videoTimestampRolloverStream.discontinuity()),t.timelineStartInfo.dts=void 0,t.timelineStartInfo.pts=void 0,ve(t),r.captionStream.reset(),e.keepOriginalTimestamps||(t.timelineStartInfo.baseMediaDecodeTime=i)),r.timedMetadataTimestampRolloverStream&&r.timedMetadataTimestampRolloverStream.discontinuity()},this.setAudioAppendStart=function(e){n&&this.transmuxPipeline_.audioSegmentStream.setAudioAppendStart(e)},this.alignGopsWith=function(e){t&&this.transmuxPipeline_.videoSegmentStream&&this.transmuxPipeline_.videoSegmentStream.alignGopsWith(e)},this.push=function(e){if(r){var t=ht(e);t&&"aac"!==this.transmuxPipeline_.type?this.setupAacPipeline():t||"ts"===this.transmuxPipeline_.type||this.setupTsPipeline(),r=!1}this.transmuxPipeline_.headOfPipeline.push(e)},this.flush=function(){r=!0,this.transmuxPipeline_.headOfPipeline.flush()},this.resetCaptions=function(){this.transmuxPipeline_.captionStream&&this.transmuxPipeline_.captionStream.reset()}}).prototype=new Z;var vt,yt,bt={Transmuxer:lt,VideoSegmentStream:ot,AudioSegmentStream:st,AUDIO_PROPERTIES:pt,VIDEO_PROPERTIES:ft,generateVideoSegmentTimingInfo:mt},_t=z.parseType,Tt=function(e){return new Date(1e3*e-20828448e5)},Et=function(e){return{isLeading:(12&e[0])>>>2,dependsOn:3&e[0],isDependedOn:(192&e[1])>>>6,hasRedundancy:(48&e[1])>>>4,paddingValue:(14&e[1])>>>1,isNonSyncSample:1&e[1],degradationPriority:e[2]<<8|e[3]}},Ct={avc1:function(e){var t=new DataView(e.buffer,e.byteOffset,e.byteLength);return{dataReferenceIndex:t.getUint16(6),width:t.getUint16(24),height:t.getUint16(26),horizresolution:t.getUint16(28)+t.getUint16(30)/16,vertresolution:t.getUint16(32)+t.getUint16(34)/16,frameCount:t.getUint16(40),depth:t.getUint16(74),config:vt(e.subarray(78,e.byteLength))}},avcC:function(e){var t,n,i,r,a=new DataView(e.buffer,e.byteOffset,e.byteLength),o={configurationVersion:e[0],avcProfileIndication:e[1],profileCompatibility:e[2],avcLevelIndication:e[3],lengthSizeMinusOne:3&e[4],sps:[],pps:[]},s=31&e[5];for(i=6,r=0;r<s;r++)n=a.getUint16(i),i+=2,o.sps.push(new Uint8Array(e.subarray(i,i+n))),i+=n;for(t=e[i],i++,r=0;r<t;r++)n=a.getUint16(i),i+=2,o.pps.push(new Uint8Array(e.subarray(i,i+n))),i+=n;return o},btrt:function(e){var t=new DataView(e.buffer,e.byteOffset,e.byteLength);return{bufferSizeDB:t.getUint32(0),maxBitrate:t.getUint32(4),avgBitrate:t.getUint32(8)}},esds:function(e){return{version:e[0],flags:new Uint8Array(e.subarray(1,4)),esId:e[6]<<8|e[7],streamPriority:31&e[8],decoderConfig:{objectProfileIndication:e[11],streamType:e[12]>>>2&63,bufferSize:e[13]<<16|e[14]<<8|e[15],maxBitrate:e[16]<<24|e[17]<<16|e[18]<<8|e[19],avgBitrate:e[20]<<24|e[21]<<16|e[22]<<8|e[23],decoderConfigDescriptor:{tag:e[24],length:e[25],audioObjectType:e[26]>>>3&31,samplingFrequencyIndex:(7&e[26])<<1|e[27]>>>7&1,channelConfiguration:e[27]>>>3&15}}}},ftyp:function(e){for(var t=new DataView(e.buffer,e.byteOffset,e.byteLength),n={majorBrand:_t(e.subarray(0,4)),minorVersion:t.getUint32(4),compatibleBrands:[]},i=8;i<e.byteLength;)n.compatibleBrands.push(_t(e.subarray(i,i+4))),i+=4;return n},dinf:function(e){return{boxes:vt(e)}},dref:function(e){return{version:e[0],flags:new Uint8Array(e.subarray(1,4)),dataReferences:vt(e.subarray(8))}},hdlr:function(e){var t={version:new DataView(e.buffer,e.byteOffset,e.byteLength).getUint8(0),flags:new Uint8Array(e.subarray(1,4)),handlerType:_t(e.subarray(8,12)),name:""},n=8;for(n=24;n<e.byteLength;n++){if(0===e[n]){n++;break}t.name+=String.fromCharCode(e[n])}return t.name=decodeURIComponent(escape(t.name)),t},mdat:function(e){return{byteLength:e.byteLength,nals:function(e){var t,n,i=new DataView(e.buffer,e.byteOffset,e.byteLength),r=[];for(t=0;t+4<e.length;t+=n)if(n=i.getUint32(t),t+=4,n<=0)r.push("<span style='color:red;'>MALFORMED DATA</span>");else switch(31&e[t]){case 1:r.push("slice_layer_without_partitioning_rbsp");break;case 5:r.push("slice_layer_without_partitioning_rbsp_idr");break;case 6:r.push("sei_rbsp");break;case 7:r.push("seq_parameter_set_rbsp");break;case 8:r.push("pic_parameter_set_rbsp");break;case 9:r.push("access_unit_delimiter_rbsp");break;default:r.push("UNKNOWN NAL - "+e[t]&31)}return r}(e)}},mdhd:function(e){var t,n=new DataView(e.buffer,e.byteOffset,e.byteLength),i=4,r={version:n.getUint8(0),flags:new Uint8Array(e.subarray(1,4)),language:""};return 1===r.version?(i+=4,r.creationTime=Tt(n.getUint32(i)),i+=8,r.modificationTime=Tt(n.getUint32(i)),i+=4,r.timescale=n.getUint32(i),i+=8,r.duration=n.getUint32(i)):(r.creationTime=Tt(n.getUint32(i)),i+=4,r.modificationTime=Tt(n.getUint32(i)),i+=4,r.timescale=n.getUint32(i),i+=4,r.duration=n.getUint32(i)),i+=4,t=n.getUint16(i),r.language+=String.fromCharCode(96+(t>>10)),r.language+=String.fromCharCode(96+((992&t)>>5)),r.language+=String.fromCharCode(96+(31&t)),r},mdia:function(e){return{boxes:vt(e)}},mfhd:function(e){return{version:e[0],flags:new Uint8Array(e.subarray(1,4)),sequenceNumber:e[4]<<24|e[5]<<16|e[6]<<8|e[7]}},minf:function(e){return{boxes:vt(e)}},mp4a:function(e){var t=new DataView(e.buffer,e.byteOffset,e.byteLength),n={dataReferenceIndex:t.getUint16(6),channelcount:t.getUint16(16),samplesize:t.getUint16(18),samplerate:t.getUint16(24)+t.getUint16(26)/65536};return e.byteLength>28&&(n.streamDescriptor=vt(e.subarray(28))[0]),n},moof:function(e){return{boxes:vt(e)}},moov:function(e){return{boxes:vt(e)}},mvex:function(e){return{boxes:vt(e)}},mvhd:function(e){var t=new DataView(e.buffer,e.byteOffset,e.byteLength),n=4,i={version:t.getUint8(0),flags:new Uint8Array(e.subarray(1,4))};return 1===i.version?(n+=4,i.creationTime=Tt(t.getUint32(n)),n+=8,i.modificationTime=Tt(t.getUint32(n)),n+=4,i.timescale=t.getUint32(n),n+=8,i.duration=t.getUint32(n)):(i.creationTime=Tt(t.getUint32(n)),n+=4,i.modificationTime=Tt(t.getUint32(n)),n+=4,i.timescale=t.getUint32(n),n+=4,i.duration=t.getUint32(n)),n+=4,i.rate=t.getUint16(n)+t.getUint16(n+2)/16,n+=4,i.volume=t.getUint8(n)+t.getUint8(n+1)/8,n+=2,n+=2,n+=8,i.matrix=new Uint32Array(e.subarray(n,n+36)),n+=36,n+=24,i.nextTrackId=t.getUint32(n),i},pdin:function(e){var t=new DataView(e.buffer,e.byteOffset,e.byteLength);return{version:t.getUint8(0),flags:new Uint8Array(e.subarray(1,4)),rate:t.getUint32(4),initialDelay:t.getUint32(8)}},sdtp:function(e){var t,n={version:e[0],flags:new Uint8Array(e.subarray(1,4)),samples:[]};for(t=4;t<e.byteLength;t++)n.samples.push({dependsOn:(48&e[t])>>4,isDependedOn:(12&e[t])>>2,hasRedundancy:3&e[t]});return n},sidx:function(e){var t,n=new DataView(e.buffer,e.byteOffset,e.byteLength),i={version:e[0],flags:new Uint8Array(e.subarray(1,4)),references:[],referenceId:n.getUint32(4),timescale:n.getUint32(8),earliestPresentationTime:n.getUint32(12),firstOffset:n.getUint32(16)},r=n.getUint16(22);for(t=24;r;t+=12,r--)i.references.push({referenceType:(128&e[t])>>>7,referencedSize:2147483647&n.getUint32(t),subsegmentDuration:n.getUint32(t+4),startsWithSap:!!(128&e[t+8]),sapType:(112&e[t+8])>>>4,sapDeltaTime:268435455&n.getUint32(t+8)});return i},smhd:function(e){return{version:e[0],flags:new Uint8Array(e.subarray(1,4)),balance:e[4]+e[5]/256}},stbl:function(e){return{boxes:vt(e)}},stco:function(e){var t,n=new DataView(e.buffer,e.byteOffset,e.byteLength),i={version:e[0],flags:new Uint8Array(e.subarray(1,4)),chunkOffsets:[]},r=n.getUint32(4);for(t=8;r;t+=4,r--)i.chunkOffsets.push(n.getUint32(t));return i},stsc:function(e){var t,n=new DataView(e.buffer,e.byteOffset,e.byteLength),i=n.getUint32(4),r={version:e[0],flags:new Uint8Array(e.subarray(1,4)),sampleToChunks:[]};for(t=8;i;t+=12,i--)r.sampleToChunks.push({firstChunk:n.getUint32(t),samplesPerChunk:n.getUint32(t+4),sampleDescriptionIndex:n.getUint32(t+8)});return r},stsd:function(e){return{version:e[0],flags:new Uint8Array(e.subarray(1,4)),sampleDescriptions:vt(e.subarray(8))}},stsz:function(e){var t,n=new DataView(e.buffer,e.byteOffset,e.byteLength),i={version:e[0],flags:new Uint8Array(e.subarray(1,4)),sampleSize:n.getUint32(4),entries:[]};for(t=12;t<e.byteLength;t+=4)i.entries.push(n.getUint32(t));return i},stts:function(e){var t,n=new DataView(e.buffer,e.byteOffset,e.byteLength),i={version:e[0],flags:new Uint8Array(e.subarray(1,4)),timeToSamples:[]},r=n.getUint32(4);for(t=8;r;t+=8,r--)i.timeToSamples.push({sampleCount:n.getUint32(t),sampleDelta:n.getUint32(t+4)});return i},styp:function(e){return Ct.ftyp(e)},tfdt:function(e){var t={version:e[0],flags:new Uint8Array(e.subarray(1,4)),baseMediaDecodeTime:e[4]<<24|e[5]<<16|e[6]<<8|e[7]};return 1===t.version&&(t.baseMediaDecodeTime*=Math.pow(2,32),t.baseMediaDecodeTime+=e[8]<<24|e[9]<<16|e[10]<<8|e[11]),t},tfhd:function(e){var t,n=new DataView(e.buffer,e.byteOffset,e.byteLength),i={version:e[0],flags:new Uint8Array(e.subarray(1,4)),trackId:n.getUint32(4)},r=1&i.flags[2],a=2&i.flags[2],o=8&i.flags[2],s=16&i.flags[2],l=32&i.flags[2],u=65536&i.flags[0],c=131072&i.flags[0];return t=8,r&&(t+=4,i.baseDataOffset=n.getUint32(12),t+=4),a&&(i.sampleDescriptionIndex=n.getUint32(t),t+=4),o&&(i.defaultSampleDuration=n.getUint32(t),t+=4),s&&(i.defaultSampleSize=n.getUint32(t),t+=4),l&&(i.defaultSampleFlags=n.getUint32(t)),u&&(i.durationIsEmpty=!0),!r&&c&&(i.baseDataOffsetIsMoof=!0),i},tkhd:function(e){var t=new DataView(e.buffer,e.byteOffset,e.byteLength),n=4,i={version:t.getUint8(0),flags:new Uint8Array(e.subarray(1,4))};return 1===i.version?(n+=4,i.creationTime=Tt(t.getUint32(n)),n+=8,i.modificationTime=Tt(t.getUint32(n)),n+=4,i.trackId=t.getUint32(n),n+=4,n+=8,i.duration=t.getUint32(n)):(i.creationTime=Tt(t.getUint32(n)),n+=4,i.modificationTime=Tt(t.getUint32(n)),n+=4,i.trackId=t.getUint32(n),n+=4,n+=4,i.duration=t.getUint32(n)),n+=4,n+=8,i.layer=t.getUint16(n),n+=2,i.alternateGroup=t.getUint16(n),n+=2,i.volume=t.getUint8(n)+t.getUint8(n+1)/8,n+=2,n+=2,i.matrix=new Uint32Array(e.subarray(n,n+36)),n+=36,i.width=t.getUint16(n)+t.getUint16(n+2)/16,n+=4,i.height=t.getUint16(n)+t.getUint16(n+2)/16,i},traf:function(e){return{boxes:vt(e)}},trak:function(e){return{boxes:vt(e)}},trex:function(e){var t=new DataView(e.buffer,e.byteOffset,e.byteLength);return{version:e[0],flags:new Uint8Array(e.subarray(1,4)),trackId:t.getUint32(4),defaultSampleDescriptionIndex:t.getUint32(8),defaultSampleDuration:t.getUint32(12),defaultSampleSize:t.getUint32(16),sampleDependsOn:3&e[20],sampleIsDependedOn:(192&e[21])>>6,sampleHasRedundancy:(48&e[21])>>4,samplePaddingValue:(14&e[21])>>1,sampleIsDifferenceSample:!!(1&e[21]),sampleDegradationPriority:t.getUint16(22)}},trun:function(e){var t,n={version:e[0],flags:new Uint8Array(e.subarray(1,4)),samples:[]},i=new DataView(e.buffer,e.byteOffset,e.byteLength),r=1&n.flags[2],a=4&n.flags[2],o=1&n.flags[1],s=2&n.flags[1],l=4&n.flags[1],u=8&n.flags[1],c=i.getUint32(4),d=8;for(r&&(n.dataOffset=i.getInt32(d),d+=4),a&&c&&(t={flags:Et(e.subarray(d,d+4))},d+=4,o&&(t.duration=i.getUint32(d),d+=4),s&&(t.size=i.getUint32(d),d+=4),u&&(t.compositionTimeOffset=i.getUint32(d),d+=4),n.samples.push(t),c--);c--;)t={},o&&(t.duration=i.getUint32(d),d+=4),s&&(t.size=i.getUint32(d),d+=4),l&&(t.flags=Et(e.subarray(d,d+4)),d+=4),u&&(t.compositionTimeOffset=i.getUint32(d),d+=4),n.samples.push(t);return n},"url ":function(e){return{version:e[0],flags:new Uint8Array(e.subarray(1,4))}},vmhd:function(e){var t=new DataView(e.buffer,e.byteOffset,e.byteLength);return{version:e[0],flags:new Uint8Array(e.subarray(1,4)),graphicsmode:t.getUint16(4),opcolor:new Uint16Array([t.getUint16(6),t.getUint16(8),t.getUint16(10)])}}},wt={inspect:vt=function(e){for(var t,n,i,r,a,o=0,s=[],l=new ArrayBuffer(e.length),u=new Uint8Array(l),c=0;c<e.length;++c)u[c]=e[c];for(t=new DataView(l);o<e.byteLength;)n=t.getUint32(o),i=_t(e.subarray(o+4,o+8)),r=n>1?o+n:e.byteLength,(a=(Ct[i]||function(e){return{data:e}})(e.subarray(o+8,r))).size=n,a.type=i,s.push(a),o=r;return s},textify:yt=function(e,t){var n;return t=t||0,n=new Array(2*t+1).join(" "),e.map(function(e,i){return n+e.type+"\n"+Object.keys(e).filter(function(e){return"type"!==e&&"boxes"!==e}).map(function(t){var i=n+"  "+t+": ",r=e[t];if(r instanceof Uint8Array||r instanceof Uint32Array){var a=Array.prototype.slice.call(new Uint8Array(r.buffer,r.byteOffset,r.byteLength)).map(function(e){return" "+("00"+e.toString(16)).slice(-2)}).join("").match(/.{1,24}/g);return a?1===a.length?i+"<"+a.join("").slice(1)+">":i+"<\n"+a.map(function(e){return n+"  "+e}).join("\n")+"\n"+n+"  >":i+"<>"}return i+JSON.stringify(r,null,2).split("\n").map(function(e,t){return 0===t?e:n+"  "+e}).join("\n")}).join("\n")+(e.boxes?"\n"+yt(e.boxes,t+1):"")}).join("\n")},parseTfdt:Ct.tfdt,parseHdlr:Ct.hdlr,parseTfhd:Ct.tfhd,parseTrun:Ct.trun,parseSidx:Ct.sidx},kt=Ce,St=xe.CaptionStream,It=function(e,t){for(var n=e,i=0;i<t.length;i++){var r=t[i];if(n<r.size)return r;n-=r.size}return null},Ot={generator:q,probe:z,Transmuxer:bt.Transmuxer,AudioSegmentStream:bt.AudioSegmentStream,VideoSegmentStream:bt.VideoSegmentStream,CaptionParser:function(){var e,t,n,i,r,a=!1;this.isInitialized=function(){return a},this.init=function(){e=new St,a=!0,e.on("data",function(e){e.startTime=e.startPts/i,e.endTime=e.endPts/i,r.captions.push(e),r.captionStreams[e.stream]=!0})},this.isNewInit=function(e,t){return!(e&&0===e.length||t&&"object"==typeof t&&0===Object.keys(t).length||n===e[0]&&i===t[n])},this.parse=function(e,a,o){var s;if(!this.isInitialized())return null;if(!a||!o)return null;if(this.isNewInit(a,o))n=a[0],i=o[n];else if(!n||!i)return t.push(e),null;for(;t.length>0;){var l=t.shift();this.parse(l,a,o)}return null!==(s=function(e,t,n){return t?{seiNals:function(e,t){var n=z.findBox(e,["moof","traf"]),i={},r=[];return z.findBox(e,["mdat"]).forEach(function(e,t){var i=n[t];r.push({mdat:e,traf:i})}),r.forEach(function(e){var n,r,a=e.mdat,o=e.traf,s=z.findBox(o,["tfhd"]),l=wt.parseTfhd(s[0]),u=l.trackId,c=z.findBox(o,["tfdt"]),d=c.length>0?wt.parseTfdt(c[0]).baseMediaDecodeTime:0,h=z.findBox(o,["trun"]);t===u&&h.length>0&&(n=function(e,t,n){var i=d,r=n.defaultSampleDuration||0,a=n.defaultSampleSize||0,o=n.trackId,s=[];return e.forEach(function(e){var t=wt.parseTrun(e).samples;t.forEach(function(e){void 0===e.duration&&(e.duration=r),void 0===e.size&&(e.size=a),e.trackId=o,e.dts=i,void 0===e.compositionTimeOffset&&(e.compositionTimeOffset=0),e.pts=i+e.compositionTimeOffset,i+=e.duration}),s=s.concat(t)}),s}(h,0,l),r=function(e,t,n){var i,r,a,o,s=new DataView(e.buffer,e.byteOffset,e.byteLength),l=[];for(r=0;r+4<e.length;r+=a)if(a=s.getUint32(r),r+=4,!(a<=0))switch(31&e[r]){case 6:var u=e.subarray(r+1,r+1+a),c=It(r,t);i={nalUnitType:"sei_rbsp",size:a,data:u,escapedRBSP:kt(u),trackId:n},c?(i.pts=c.pts,i.dts=c.dts,o=c):(i.pts=o.pts,i.dts=o.dts),l.push(i)}return l}(a,n,u),i[u]||(i[u]=[]),i[u]=i[u].concat(r))}),i}(e,t)[t],timescale:n}:null}(e,n,i))&&s.seiNals?(this.pushNals(s.seiNals),this.flushStream(),r):null},this.pushNals=function(t){if(!this.isInitialized()||!t||0===t.length)return null;t.forEach(function(t){e.push(t)})},this.flushStream=function(){if(!this.isInitialized())return null;e.flush()},this.clearParsedCaptions=function(){r.captions=[],r.captionStreams={}},this.resetCaptionStream=function(){if(!this.isInitialized())return null;e.reset()},this.clearAllCaptions=function(){this.clearParsedCaptions(),this.resetCaptionStream()},this.reset=function(){t=[],n=null,i=null,r?this.clearParsedCaptions():r={captions:[],captionStreams:{}},this.resetCaptionStream()},this.reset()}},Dt=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},Rt=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),xt=function(){function e(t,n){Dt(this,e),this.options=n||{},this.self=t,this.init()}return Rt(e,[{key:"init",value:function(){var e,t;this.transmuxer&&this.transmuxer.dispose(),this.transmuxer=new Ot.Transmuxer(this.options),e=this.self,(t=this.transmuxer).on("data",function(t){var n=t.initSegment;t.initSegment={data:n.buffer,byteOffset:n.byteOffset,byteLength:n.byteLength};var i=t.data;t.data=i.buffer,e.postMessage({action:"data",segment:t,byteOffset:i.byteOffset,byteLength:i.byteLength},[t.data])}),t.captionStream&&t.captionStream.on("data",function(t){e.postMessage({action:"caption",data:t})}),t.on("done",function(t){e.postMessage({action:"done"})}),t.on("gopInfo",function(t){e.postMessage({action:"gopInfo",gopInfo:t})}),t.on("videoSegmentTimingInfo",function(t){e.postMessage({action:"videoSegmentTimingInfo",videoSegmentTimingInfo:t})})}},{key:"push",value:function(e){var t=new Uint8Array(e.data,e.byteOffset,e.byteLength);this.transmuxer.push(t)}},{key:"reset",value:function(){this.init()}},{key:"setTimestampOffset",value:function(e){var t=e.timestampOffset||0;this.transmuxer.setBaseMediaDecodeTime(Math.round(9e4*t))}},{key:"setAudioAppendStart",value:function(e){this.transmuxer.setAudioAppendStart(Math.ceil(9e4*e.appendStart))}},{key:"flush",value:function(e){this.transmuxer.flush()}},{key:"resetCaptions",value:function(){this.transmuxer.resetCaptions()}},{key:"alignGopsWith",value:function(e){this.transmuxer.alignGopsWith(e.gopsToAlignWith.slice())}}]),e}();new function(e){e.onmessage=function(t){"init"===t.data.action&&t.data.options?this.messageHandlers=new xt(e,t.data.options):(this.messageHandlers||(this.messageHandlers=new xt(e)),t.data&&t.data.action&&"init"!==t.data.action&&this.messageHandlers[t.data.action]&&this.messageHandlers[t.data.action](t.data))}}(n)}()}),ad={videoCodec:"avc1",videoObjectTypeIndicator:".4d400d",audioProfile:"2"},od=function(e){return e.map(function(e){return e.replace(/avc1\.(\d+)\.(\d+)/i,function(e,t,n){return"avc1."+("00"+Number(t).toString(16)).slice(-2)+"00"+("00"+Number(n).toString(16)).slice(-2)})})},sd=function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",n={codecCount:0};return n.codecCount=t.split(",").length,n.codecCount=n.codecCount||2,(e=/(^|\s|,)+(avc[13])([^ ,]*)/i.exec(t))&&(n.videoCodec=e[2],n.videoObjectTypeIndicator=e[3]),n.audioProfile=/(^|\s|,)+mp4a.[0-9A-Fa-f]+\.([0-9A-Fa-f]+)/i.exec(t),n.audioProfile=n.audioProfile&&n.audioProfile[2],n},ld=function(e,t,n){return e+"/"+t+'; codecs="'+n.filter(function(e){return!!e}).join(", ")+'"'},ud=function(e){return/mp4a\.\d+.\d+/i.test(e)},cd=function(e){return/avc1\.[\da-f]+/i.test(e)},dd=function(e,t,n){var i=null,r=null,a=0,o=[],s=[];if(!e&&!t)return to.createTimeRange();if(!e)return t.buffered;if(!t)return e.buffered;if(n)return e.buffered;if(0===e.buffered.length&&0===t.buffered.length)return to.createTimeRange();for(var l=e.buffered,u=t.buffered,c=l.length;c--;)o.push({time:l.start(c),type:"start"}),o.push({time:l.end(c),type:"end"});for(c=u.length;c--;)o.push({time:u.start(c),type:"start"}),o.push({time:u.end(c),type:"end"});for(o.sort(function(e,t){return e.time-t.time}),c=0;c<o.length;c++)"start"===o[c].type?2==++a&&(i=o[c].time):"end"===o[c].type&&1==--a&&(r=o[c].time),null!==i&&null!==r&&(s.push([i,r]),i=null,r=null);return to.createTimeRanges(s)},hd=function(e){function t(e,n){Qu(this,t);var i=ec(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,to.EventTarget));i.timestampOffset_=0,i.pendingBuffers_=[],i.bufferUpdating_=!1,i.mediaSource_=e,i.codecs_=n,i.audioCodec_=null,i.videoCodec_=null,i.audioDisabled_=!1,i.appendAudioInitSegment_=!0,i.gopBuffer_=[],i.timeMapping_=0,i.safeAppend_=to.browser.IE_VERSION>=11;var r={remux:!1,alignGopsAtEnd:i.safeAppend_};return i.codecs_.forEach(function(e){ud(e)?i.audioCodec_=e:cd(e)&&(i.videoCodec_=e)}),i.transmuxer_=new rd,i.transmuxer_.postMessage({action:"init",options:r}),i.transmuxer_.onmessage=function(e){return"data"===e.data.action?i.data_(e):"done"===e.data.action?i.done_(e):"gopInfo"===e.data.action?i.appendGopInfo_(e):"videoSegmentTimingInfo"===e.data.action?i.videoSegmentTimingInfo_(e.data.videoSegmentTimingInfo):void 0},Object.defineProperty(i,"timestampOffset",{get:function(){return this.timestampOffset_},set:function(e){"number"==typeof e&&e>=0&&(this.timestampOffset_=e,this.appendAudioInitSegment_=!0,this.gopBuffer_.length=0,this.timeMapping_=0,this.transmuxer_.postMessage({action:"setTimestampOffset",timestampOffset:e}))}}),Object.defineProperty(i,"appendWindowStart",{get:function(){return(this.videoBuffer_||this.audioBuffer_).appendWindowStart},set:function(e){this.videoBuffer_&&(this.videoBuffer_.appendWindowStart=e),this.audioBuffer_&&(this.audioBuffer_.appendWindowStart=e)}}),Object.defineProperty(i,"updating",{get:function(){return!!(this.bufferUpdating_||!this.audioDisabled_&&this.audioBuffer_&&this.audioBuffer_.updating||this.videoBuffer_&&this.videoBuffer_.updating)}}),Object.defineProperty(i,"buffered",{get:function(){return dd(this.videoBuffer_,this.audioBuffer_,this.audioDisabled_)}}),i}return Zu(t,e),Ju(t,[{key:"data_",value:function(e){var t=e.data.segment;t.data=new Uint8Array(t.data,e.data.byteOffset,e.data.byteLength),t.initSegment=new Uint8Array(t.initSegment.data,t.initSegment.byteOffset,t.initSegment.byteLength),function(e,t,n){var i=t.player_;if(n.captions&&n.captions.length)for(var r in e.inbandTextTracks_||(e.inbandTextTracks_={}),n.captionStreams)if(!e.inbandTextTracks_[r]){i.tech_.trigger({type:"usage",name:"hls-608"});var a=i.textTracks().getTrackById(r);e.inbandTextTracks_[r]=a||i.addRemoteTextTrack({kind:"captions",id:r,label:r},!1).track}n.metadata&&n.metadata.length&&!e.metadataTrack_&&(e.metadataTrack_=i.addRemoteTextTrack({kind:"metadata",label:"Timed Metadata"},!1).track,e.metadataTrack_.inBandMetadataTrackDispatchType=n.metadata.dispatchType)}(this,this.mediaSource_,t),this.pendingBuffers_.push(t)}},{key:"done_",value:function(e){"closed"!==this.mediaSource_.readyState?this.processPendingSegments_():this.pendingBuffers_.length=0}},{key:"videoSegmentTimingInfo_",value:function(e){var t={start:{decode:e.start.dts/9e4,presentation:e.start.pts/9e4},end:{decode:e.end.dts/9e4,presentation:e.end.pts/9e4},baseMediaDecodeTime:e.baseMediaDecodeTime/9e4};e.prependedContentDuration&&(t.prependedContentDuration=e.prependedContentDuration/9e4),this.trigger({type:"videoSegmentTimingInfo",videoSegmentTimingInfo:t})}},{key:"createRealSourceBuffers_",value:function(){var e=this,t=["audio","video"];t.forEach(function(n){if(e[n+"Codec_"]&&!e[n+"Buffer_"]){var i=null;if(e.mediaSource_[n+"Buffer_"])(i=e.mediaSource_[n+"Buffer_"]).updating=!1;else{var r=n+'/mp4;codecs="'+e[n+"Codec_"]+'"';i=function(e,t){var n=e.addSourceBuffer(t),i=Object.create(null);i.updating=!1,i.realBuffer_=n;var r=function(e){"function"==typeof n[e]?i[e]=function(){return n[e].apply(n,arguments)}:void 0===i[e]&&Object.defineProperty(i,e,{get:function(){return n[e]},set:function(t){return n[e]=t}})};for(var a in n)r(a);return i}(e.mediaSource_.nativeMediaSource_,r),e.mediaSource_[n+"Buffer_"]=i}e[n+"Buffer_"]=i,["update","updatestart","updateend"].forEach(function(r){i.addEventListener(r,function(){if("audio"!==n||!e.audioDisabled_)return"updateend"===r&&(e[n+"Buffer_"].updating=!1),t.every(function(t){return!("audio"!==t||!e.audioDisabled_)||n===t||!e[t+"Buffer_"]||!e[t+"Buffer_"].updating})?e.trigger(r):void 0})})}})}},{key:"appendBuffer",value:function(e){if(this.bufferUpdating_=!0,this.audioBuffer_&&this.audioBuffer_.buffered.length){var t=this.audioBuffer_.buffered;this.transmuxer_.postMessage({action:"setAudioAppendStart",appendStart:t.end(t.length-1)})}this.videoBuffer_&&this.transmuxer_.postMessage({action:"alignGopsWith",gopsToAlignWith:function(e,t,n){if(void 0===t||null===t||!e.length)return[];var i=Math.ceil(9e4*(t-n+3)),r=void 0;for(r=0;r<e.length&&!(e[r].pts>i);r++);return e.slice(r)}(this.gopBuffer_,this.mediaSource_.player_?this.mediaSource_.player_.currentTime():null,this.timeMapping_)}),this.transmuxer_.postMessage({action:"push",data:e.buffer,byteOffset:e.byteOffset,byteLength:e.byteLength},[e.buffer]),this.transmuxer_.postMessage({action:"flush"})}},{key:"appendGopInfo_",value:function(e){this.gopBuffer_=function(e,t,n){if(!t.length)return e;if(n)return t.slice();for(var i=t[0].pts,r=0;r<e.length&&!(e[r].pts>=i);r++);return e.slice(0,r).concat(t)}(this.gopBuffer_,e.data.gopInfo,this.safeAppend_)}},{key:"remove",value:function(e,t){if(this.videoBuffer_&&(this.videoBuffer_.updating=!0,this.videoBuffer_.remove(e,t),this.gopBuffer_=function(e,t,n,i){for(var r=Math.ceil(9e4*(t-i)),a=Math.ceil(9e4*(n-i)),o=e.slice(),s=e.length;s--&&!(e[s].pts<=a););if(-1===s)return o;for(var l=s+1;l--&&!(e[l].pts<=r););return l=Math.max(l,0),o.splice(l,s-l+1),o}(this.gopBuffer_,e,t,this.timeMapping_)),!this.audioDisabled_&&this.audioBuffer_&&(this.audioBuffer_.updating=!0,this.audioBuffer_.remove(e,t)),qc(e,t,this.metadataTrack_),this.inbandTextTracks_)for(var n in this.inbandTextTracks_)qc(e,t,this.inbandTextTracks_[n])}},{key:"processPendingSegments_",value:function(){var e={video:{segments:[],bytes:0},audio:{segments:[],bytes:0},captions:[],metadata:[]};e=this.pendingBuffers_.reduce(function(e,t){var n=t.type,i=t.data,r=t.initSegment;return e[n].segments.push(i),e[n].bytes+=i.byteLength,e[n].initSegment=r,t.captions&&(e.captions=e.captions.concat(t.captions)),t.info&&(e[n].info=t.info),t.metadata&&(e.metadata=e.metadata.concat(t.metadata)),e},e),this.videoBuffer_||this.audioBuffer_||(0===e.video.bytes&&(this.videoCodec_=null),0===e.audio.bytes&&(this.audioCodec_=null),this.createRealSourceBuffers_()),e.audio.info&&this.mediaSource_.trigger({type:"audioinfo",info:e.audio.info}),e.video.info&&this.mediaSource_.trigger({type:"videoinfo",info:e.video.info}),this.appendAudioInitSegment_&&(!this.audioDisabled_&&this.audioBuffer_&&(e.audio.segments.unshift(e.audio.initSegment),e.audio.bytes+=e.audio.initSegment.byteLength),this.appendAudioInitSegment_=!1);var t=!1;this.videoBuffer_&&e.video.bytes?(e.video.segments.unshift(e.video.initSegment),e.video.bytes+=e.video.initSegment.byteLength,this.concatAndAppendSegments_(e.video,this.videoBuffer_)):!this.videoBuffer_||!this.audioDisabled_&&this.audioBuffer_||(t=!0),zc(this,e.captions,e.metadata),!this.audioDisabled_&&this.audioBuffer_&&this.concatAndAppendSegments_(e.audio,this.audioBuffer_),this.pendingBuffers_.length=0,t&&this.trigger("updateend"),this.bufferUpdating_=!1}},{key:"concatAndAppendSegments_",value:function(e,t){var n=0,i=void 0;if(e.bytes){i=new Uint8Array(e.bytes),e.segments.forEach(function(e){i.set(e,n),n+=e.byteLength});try{t.updating=!0,t.appendBuffer(i)}catch(e){this.mediaSource_.player_&&this.mediaSource_.player_.error({code:-3,type:"APPEND_BUFFER_ERR",message:e.message,originalError:e})}}}},{key:"abort",value:function(){this.videoBuffer_&&this.videoBuffer_.abort(),!this.audioDisabled_&&this.audioBuffer_&&this.audioBuffer_.abort(),this.transmuxer_&&this.transmuxer_.postMessage({action:"reset"}),this.pendingBuffers_.length=0,this.bufferUpdating_=!1}}]),t}(to.EventTarget),pd=function(n){function i(){Qu(this,i);var n=ec(this,(i.__proto__||Object.getPrototypeOf(i)).call(this)),r=void 0;for(r in n.nativeMediaSource_=new e.MediaSource,n.nativeMediaSource_)r in i.prototype||"function"!=typeof n.nativeMediaSource_[r]||(n[r]=n.nativeMediaSource_[r].bind(n.nativeMediaSource_));return n.duration_=NaN,Object.defineProperty(n,"duration",{get:function(){return this.duration_===1/0?this.duration_:this.nativeMediaSource_.duration},set:function(e){this.duration_=e,e===1/0||(this.nativeMediaSource_.duration=e)}}),Object.defineProperty(n,"seekable",{get:function(){return this.duration_===1/0?to.createTimeRanges([[0,this.nativeMediaSource_.duration]]):this.nativeMediaSource_.seekable}}),Object.defineProperty(n,"readyState",{get:function(){return this.nativeMediaSource_.readyState}}),Object.defineProperty(n,"activeSourceBuffers",{get:function(){return this.activeSourceBuffers_}}),n.sourceBuffers=[],n.activeSourceBuffers_=[],n.updateActiveSourceBuffers_=function(){if(n.activeSourceBuffers_.length=0,1===n.sourceBuffers.length){var e=n.sourceBuffers[0];return e.appendAudioInitSegment_=!0,e.audioDisabled_=!e.audioCodec_,void n.activeSourceBuffers_.push(e)}for(var t=!1,i=!0,r=0;r<n.player_.audioTracks().length;r++){var a=n.player_.audioTracks()[r];if(a.enabled&&"main"!==a.kind){t=!0,i=!1;break}}n.sourceBuffers.forEach(function(e,r){if(e.appendAudioInitSegment_=!0,e.videoCodec_&&e.audioCodec_)e.audioDisabled_=t;else if(e.videoCodec_&&!e.audioCodec_)e.audioDisabled_=!0,i=!1;else if(!e.videoCodec_&&e.audioCodec_&&(e.audioDisabled_=r?i:!i,e.audioDisabled_))return;n.activeSourceBuffers_.push(e)})},n.onPlayerMediachange_=function(){n.sourceBuffers.forEach(function(e){e.appendAudioInitSegment_=!0})},n.onHlsReset_=function(){n.sourceBuffers.forEach(function(e){e.transmuxer_&&e.transmuxer_.postMessage({action:"resetCaptions"})})},n.onHlsSegmentTimeMapping_=function(e){n.sourceBuffers.forEach(function(t){return t.timeMapping_=e.mapping})},["sourceopen","sourceclose","sourceended"].forEach(function(e){this.nativeMediaSource_.addEventListener(e,this.trigger.bind(this))},n),n.on("sourceopen",function(e){var i=t.querySelector('[src="'+n.url_+'"]');i&&(n.player_=to(i.parentNode),n.player_&&(n.player_.tech_.on("hls-reset",n.onHlsReset_),n.player_.tech_.on("hls-segment-time-mapping",n.onHlsSegmentTimeMapping_),n.player_.audioTracks&&n.player_.audioTracks()&&(n.player_.audioTracks().on("change",n.updateActiveSourceBuffers_),n.player_.audioTracks().on("addtrack",n.updateActiveSourceBuffers_),n.player_.audioTracks().on("removetrack",n.updateActiveSourceBuffers_)),n.player_.on("mediachange",n.onPlayerMediachange_)))}),n.on("sourceended",function(e){for(var t=Hc(n.duration),i=0;i<n.sourceBuffers.length;i++){var r=n.sourceBuffers[i],a=r.metadataTrack_&&r.metadataTrack_.cues;a&&a.length&&(a[a.length-1].endTime=t)}}),n.on("sourceclose",function(e){this.sourceBuffers.forEach(function(e){e.transmuxer_&&e.transmuxer_.terminate()}),this.sourceBuffers.length=0,this.player_&&(this.player_.audioTracks&&this.player_.audioTracks()&&(this.player_.audioTracks().off("change",this.updateActiveSourceBuffers_),this.player_.audioTracks().off("addtrack",this.updateActiveSourceBuffers_),this.player_.audioTracks().off("removetrack",this.updateActiveSourceBuffers_)),this.player_.el_&&this.player_.off("mediachange",this.onPlayerMediachange_),this.player_.tech_&&this.player_.tech_.el_&&(this.player_.tech_.off("hls-reset",this.onHlsReset_),this.player_.tech_.off("hls-segment-time-mapping",this.onHlsSegmentTimeMapping_)))}),n}return Zu(i,n),Ju(i,[{key:"addSeekableRange_",value:function(e,t){var n=void 0;if(this.duration!==1/0)throw(n=new Error("MediaSource.addSeekableRange() can only be invoked when the duration is Infinity")).name="InvalidStateError",n.code=11,n;(t>this.nativeMediaSource_.duration||isNaN(this.nativeMediaSource_.duration))&&(this.nativeMediaSource_.duration=t)}},{key:"addSourceBuffer",value:function(e){var t=void 0,n=function(e){var t={type:"",parameters:{}},n=e.trim().split(";");return t.type=n.shift().trim(),n.forEach(function(e){var n=e.trim().split("=");if(n.length>1){var i=n[0].replace(/"/g,"").trim(),r=n[1].replace(/"/g,"").trim();t.parameters[i]=r}}),t}(e);if(/^(video|audio)\/mp2t$/i.test(n.type)){var i=[];n.parameters&&n.parameters.codecs&&(i=n.parameters.codecs.split(","),i=(i=od(i)).filter(function(e){return ud(e)||cd(e)})),0===i.length&&(i=["avc1.4d400d","mp4a.40.2"]),t=new hd(this,i),0!==this.sourceBuffers.length&&(this.sourceBuffers[0].createRealSourceBuffers_(),t.createRealSourceBuffers_(),this.sourceBuffers[0].audioDisabled_=!0)}else t=this.nativeMediaSource_.addSourceBuffer(e);return this.sourceBuffers.push(t),t}}]),i}(to.EventTarget),fd=0;to.mediaSources={};var gd=function(e,t){var n=to.mediaSources[e];if(!n)throw new Error("Media Source not found (Video.js)");n.trigger({type:"sourceopen",swfId:t})},md=function(){return!!e.MediaSource&&!!e.MediaSource.isTypeSupported&&e.MediaSource.isTypeSupported('video/mp4;codecs="avc1.4d400d,mp4a.40.2"')},vd=function(){if(this.MediaSource={open:gd,supportsNativeMediaSources:md},md())return new pd;throw new Error("Cannot use create a virtual MediaSource for this video")};vd.open=gd,vd.supportsNativeMediaSources=md;var yd={createObjectURL:function(t){var n=void 0;return t instanceof pd?(n=e.URL.createObjectURL(t.nativeMediaSource_),t.url_=n,n):t instanceof pd?(n="blob:vjs-media-source/"+fd,fd++,to.mediaSources[n]=t,n):(n=e.URL.createObjectURL(t),t.url_=n,n)}};to.MediaSource=vd,to.URL=yd;var bd=to.EventTarget,_d=to.mergeOptions,Td=function(e,t){for(var n=void 0,i=_d(e,{duration:t.duration,minimumUpdatePeriod:t.minimumUpdatePeriod}),r=0;r<t.playlists.length;r++){var a=oc(i,t.playlists[r]);a?i=a:n=!0}return ac(t,function(e,t,r,a){if(e.playlists&&e.playlists.length){var o=e.playlists[0].uri,s=oc(i,e.playlists[0]);s&&((i=s).mediaGroups[t][r][a].playlists[0]=i.playlists[o],n=!1)}}),n?null:i},Ed=function(e){var t=e.byterange.offset+e.byterange.length-1;return e.uri+"-"+e.byterange.offset+"-"+t},Cd=function(e,t){var n,i,r={};for(var a in e){var o=e[a].sidx;if(o){var s=Ed(o);if(!t[s])break;n=t[s].sidxInfo,i=o,(Boolean(!n.map&&!i.map)||Boolean(n.map&&i.map&&n.map.byterange.offset===i.map.byterange.offset&&n.map.byterange.length===i.map.byterange.length))&&n.uri===i.uri&&n.byterange.offset===i.byterange.offset&&n.byterange.length===i.byterange.length&&(r[s]=t[s])}}return r},wd=function(e,t,n,i,r){var a={uri:Yu(i.handleManifestRedirects,e.resolvedUri),byterange:e.byterange,playlist:t};return n(to.mergeOptions(a,{responseType:"arraybuffer",headers:Rc(a)}),r)},kd=function(t){function n(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=arguments[3];Qu(this,n);var a=ec(this,(n.__proto__||Object.getPrototypeOf(n)).call(this)),o=i.withCredentials,s=void 0!==o&&o,l=i.handleManifestRedirects,u=void 0!==l&&l;if(a.hls_=t,a.withCredentials=s,a.handleManifestRedirects=u,!e)throw new Error("A non-empty playlist URL or playlist is required");return a.on("minimumUpdatePeriod",function(){a.refreshXml_()}),a.on("mediaupdatetimeout",function(){a.refreshMedia_(a.media().uri)}),a.state="HAVE_NOTHING",a.loadedPlaylists_={},"string"==typeof e?(a.srcUrl=e,a.sidxMapping_={},ec(a)):(a.setupChildLoader(r,e),a)}return Zu(n,bd),Ju(n,[{key:"setupChildLoader",value:function(e,t){this.masterPlaylistLoader_=e,this.childPlaylist_=t}},{key:"dispose",value:function(){this.stopRequest(),this.loadedPlaylists_={},e.clearTimeout(this.minimumUpdatePeriodTimeout_),e.clearTimeout(this.mediaRequest_),e.clearTimeout(this.mediaUpdateTimeout)}},{key:"hasPendingRequest",value:function(){return this.request||this.mediaRequest_}},{key:"stopRequest",value:function(){if(this.request){var e=this.request;this.request=null,e.onreadystatechange=null,e.abort()}}},{key:"sidxRequestFinished_",value:function(e,t,n,i){var r=this;return function(a,o){if(r.request){if(r.request=null,a)return r.error={status:o.status,message:"DASH playlist request error at URL: "+e.uri,response:o.response,code:2},n&&(r.state=n),r.trigger("error"),i(t,null);var s=new Uint8Array(o.response),l=Ys.parseSidx(s.subarray(8));return i(t,l)}}}},{key:"media",value:function(t){var n=this;if(!t)return this.media_;if("HAVE_NOTHING"===this.state)throw new Error("Cannot switch media playlist from "+this.state);var i=this.state;if("string"==typeof t){if(!this.master.playlists[t])throw new Error("Unknown playlist URI: "+t);t=this.master.playlists[t]}var r=!this.media_||t.uri!==this.media_.uri;if(r&&this.loadedPlaylists_[t.uri]&&this.loadedPlaylists_[t.uri].endList)return this.state="HAVE_METADATA",this.media_=t,void(r&&(this.trigger("mediachanging"),this.trigger("mediachange")));if(r)if(this.media_&&this.trigger("mediachanging"),t.sidx){var a=void 0,o=void 0;this.masterPlaylistLoader_?(a=this.masterPlaylistLoader_.master,o=this.masterPlaylistLoader_.sidxMapping_):(a=this.master,o=this.sidxMapping_);var s=Ed(t.sidx);o[s]={sidxInfo:t.sidx},this.request=wd(t.sidx,t,this.hls_.xhr,{handleManifestRedirects:this.handleManifestRedirects},this.sidxRequestFinished_(t,a,i,function(e,r){if(!e||!r)throw new Error("failed to request sidx");o[s].sidx=r,n.haveMetadata({startingState:i,playlist:e.playlists[t.uri]})}))}else this.mediaRequest_=e.setTimeout(this.haveMetadata.bind(this,{startingState:i,playlist:t}),0)}},{key:"haveMetadata",value:function(e){var t=e.startingState,n=e.playlist;this.state="HAVE_METADATA",this.loadedPlaylists_[n.uri]=n,this.mediaRequest_=null,this.refreshMedia_(n.uri),"HAVE_MASTER"===t?this.trigger("loadedmetadata"):this.trigger("mediachange")}},{key:"pause",value:function(){this.stopRequest(),e.clearTimeout(this.mediaUpdateTimeout),e.clearTimeout(this.minimumUpdatePeriodTimeout_),"HAVE_NOTHING"===this.state&&(this.started=!1)}},{key:"load",value:function(t){var n=this;e.clearTimeout(this.mediaUpdateTimeout),e.clearTimeout(this.minimumUpdatePeriodTimeout_);var i=this.media();if(t){var r=i?i.targetDuration/2*1e3:5e3;this.mediaUpdateTimeout=e.setTimeout(function(){return n.load()},r)}else this.started?this.trigger("loadedplaylist"):this.start()}},{key:"parseMasterXml",value:function(){var e=Vs(this.masterXml_,{manifestUri:this.srcUrl,clientOffset:this.clientOffset_,sidxMapping:this.sidxMapping_});e.uri=this.srcUrl;for(var t=0;t<e.playlists.length;t++){var n="placeholder-uri-"+t;e.playlists[t].uri=n,e.playlists[n]=e.playlists[t]}return ac(e,function(t,n,i,r){if(t.playlists&&t.playlists.length){var a="placeholder-uri-"+n+"-"+i+"-"+r;t.playlists[0].uri=a,e.playlists[a]=t.playlists[0]}}),sc(e),lc(e),e}},{key:"start",value:function(){var t=this;this.started=!0,this.masterPlaylistLoader_?this.mediaRequest_=e.setTimeout(this.haveMaster_.bind(this),0):this.request=this.hls_.xhr({uri:this.srcUrl,withCredentials:this.withCredentials},function(e,n){if(t.request){if(t.request=null,e)return t.error={status:n.status,message:"DASH playlist request error at URL: "+t.srcUrl,responseText:n.responseText,code:2},"HAVE_NOTHING"===t.state&&(t.started=!1),t.trigger("error");t.masterXml_=n.responseText,n.responseHeaders&&n.responseHeaders.date?t.masterLoaded_=Date.parse(n.responseHeaders.date):t.masterLoaded_=Date.now(),t.srcUrl=Yu(t.handleManifestRedirects,t.srcUrl,n),t.syncClientServerClock_(t.onClientServerClockSync_.bind(t))}})}},{key:"syncClientServerClock_",value:function(e){var t=this,n=function(e){return function(e){var t=As(e,"UTCTiming")[0];if(!t)return null;var n=Ms(t);switch(n.schemeIdUri){case"urn:mpeg:dash:utc:http-head:2014":case"urn:mpeg:dash:utc:http-head:2012":n.method="HEAD";break;case"urn:mpeg:dash:utc:http-xsdate:2014":case"urn:mpeg:dash:utc:http-iso:2014":case"urn:mpeg:dash:utc:http-xsdate:2012":case"urn:mpeg:dash:utc:http-iso:2012":n.method="GET";break;case"urn:mpeg:dash:utc:direct:2014":case"urn:mpeg:dash:utc:direct:2012":n.method="DIRECT",n.value=Date.parse(n.value);break;case"urn:mpeg:dash:utc:http-ntp:2014":case"urn:mpeg:dash:utc:ntp:2014":case"urn:mpeg:dash:utc:sntp:2014":default:throw new Error(fs)}return n}(Us(e))}(this.masterXml_);return null===n?(this.clientOffset_=this.masterLoaded_-Date.now(),e()):"DIRECT"===n.method?(this.clientOffset_=n.value-Date.now(),e()):void(this.request=this.hls_.xhr({uri:Xu(this.srcUrl,n.value),method:n.method,withCredentials:this.withCredentials},function(i,r){if(t.request){if(i)return t.clientOffset_=t.masterLoaded_-Date.now(),e();var a;a="HEAD"===n.method?r.responseHeaders&&r.responseHeaders.date?Date.parse(r.responseHeaders.date):t.masterLoaded_:Date.parse(r.responseText),t.clientOffset_=a-Date.now(),e()}}))}},{key:"haveMaster_",value:function(){this.state="HAVE_MASTER",this.mediaRequest_=null,this.masterPlaylistLoader_?this.media_||this.media(this.childPlaylist_):(this.master=this.parseMasterXml(),this.trigger("loadedplaylist"))}},{key:"onClientServerClockSync_",value:function(){var t=this;this.haveMaster_(),this.hasPendingRequest()||this.media_||this.media(this.master.playlists[0]),this.master&&this.master.minimumUpdatePeriod&&(this.minimumUpdatePeriodTimeout_=e.setTimeout(function(){t.trigger("minimumUpdatePeriod")},this.master.minimumUpdatePeriod))}},{key:"refreshXml_",value:function(){var t=this;this.request=this.hls_.xhr({uri:this.srcUrl,withCredentials:this.withCredentials},function(n,i){if(t.request){if(t.request=null,n)return t.error={status:i.status,message:"DASH playlist request error at URL: "+t.srcUrl,responseText:i.responseText,code:2},"HAVE_NOTHING"===t.state&&(t.started=!1),t.trigger("error");t.masterXml_=i.responseText,t.sidxMapping_=function(e,t,n,i){var r=Vs(e,{manifestUri:t,clientOffset:n}),a=Cd(r.playlists,i);return ac(r,function(e,t,n,r){if(e.playlists&&e.playlists.length){var o=e.playlists;a=_d(a,Cd(o,i))}}),a}(t.masterXml_,t.srcUrl,t.clientOffset_,t.sidxMapping_);var r=t.parseMasterXml(),a=Td(t.master,r);if(a){var o=Ed(t.media().sidx);if(t.sidxMapping_[o])t.master=a;else{var s=t.media();t.request=wd(s.sidx,s,t.hls_.xhr,{handleManifestRedirects:t.handleManifestRedirects},t.sidxRequestFinished_(s,r,t.state,function(n,i){if(!n||!i)throw new Error("failed to request sidx on minimumUpdatePeriod");t.sidxMapping_[o].sidx=i,t.minimumUpdatePeriodTimeout_=e.setTimeout(function(){t.trigger("minimumUpdatePeriod")},t.master.minimumUpdatePeriod),t.refreshMedia_(t.media().uri)}))}}t.minimumUpdatePeriodTimeout_=e.setTimeout(function(){t.trigger("minimumUpdatePeriod")},t.master.minimumUpdatePeriod)}})}},{key:"refreshMedia_",value:function(t){var n=this;if(!t)throw new Error("refreshMedia_ must take a media uri");var i=void 0,r=void 0;this.masterPlaylistLoader_?(i=this.masterPlaylistLoader_.master,r=this.masterPlaylistLoader_.parseMasterXml()):(i=this.master,r=this.parseMasterXml());var a=Td(i,r);a?(this.masterPlaylistLoader_?this.masterPlaylistLoader_.master=a:this.master=a,this.media_=a.playlists[t]):(this.media_=r.playlists[t],this.trigger("playlistunchanged")),this.media().endList||(this.mediaUpdateTimeout=e.setTimeout(function(){n.trigger("mediaupdatetimeout")},uc(this.media(),!!a))),this.trigger("loadedplaylist")}}]),n}(),Sd=function(e){return to.log.debug?to.log.debug.bind(to,"VHS:",e+" >"):function(){}};function Id(){}var Od=function(){function e(t,n,i,r){Qu(this,e),this.callbacks_=[],this.pendingCallback_=null,this.timestampOffset_=0,this.mediaSource=t,this.processedAppend_=!1,this.type_=i,this.mimeType_=n,this.logger_=Sd("SourceUpdater["+i+"]["+n+"]"),"closed"===t.readyState?t.addEventListener("sourceopen",this.createSourceBuffer_.bind(this,n,r)):this.createSourceBuffer_(n,r)}return Ju(e,[{key:"createSourceBuffer_",value:function(e,t){var n=this;this.sourceBuffer_=this.mediaSource.addSourceBuffer(e),this.logger_("created SourceBuffer"),t&&(t.trigger("sourcebufferadded"),this.mediaSource.sourceBuffers.length<2)?t.on("sourcebufferadded",function(){n.start_()}):this.start_()}},{key:"start_",value:function(){var e=this;this.started_=!0,this.onUpdateendCallback_=function(){var t=e.pendingCallback_;e.pendingCallback_=null,e.sourceBuffer_.removing=!1,e.logger_("buffered ["+Uc(e.buffered())+"]"),t&&t(),e.runCallback_()},this.sourceBuffer_.addEventListener("updateend",this.onUpdateendCallback_),this.runCallback_()}},{key:"abort",value:function(e){var t=this;this.processedAppend_&&this.queueCallback_(function(){t.sourceBuffer_.abort()},e)}},{key:"appendBuffer",value:function(e,t){var n=this;this.processedAppend_=!0,this.queueCallback_(function(){e.videoSegmentTimingInfoCallback&&n.sourceBuffer_.addEventListener("videoSegmentTimingInfo",e.videoSegmentTimingInfoCallback),n.sourceBuffer_.appendBuffer(e.bytes)},function(){e.videoSegmentTimingInfoCallback&&n.sourceBuffer_.removeEventListener("videoSegmentTimingInfo",e.videoSegmentTimingInfoCallback),t()})}},{key:"buffered",value:function(){return this.sourceBuffer_?this.sourceBuffer_.buffered:to.createTimeRanges()}},{key:"remove",value:function(e,t){var n=this,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Id;this.processedAppend_&&this.queueCallback_(function(){n.logger_("remove ["+e+" => "+t+"]"),n.sourceBuffer_.removing=!0,n.sourceBuffer_.remove(e,t)},i)}},{key:"updating",value:function(){return!this.sourceBuffer_||this.sourceBuffer_.updating||!!this.pendingCallback_&&this.pendingCallback_!==Id}},{key:"timestampOffset",value:function(e){var t=this;return void 0!==e&&(this.queueCallback_(function(){t.sourceBuffer_.timestampOffset=e,t.runCallback_()}),this.timestampOffset_=e),this.timestampOffset_}},{key:"queueCallback_",value:function(e,t){this.callbacks_.push([e.bind(this),t]),this.runCallback_()}},{key:"runCallback_",value:function(){var e=void 0;!this.updating()&&this.callbacks_.length&&this.started_&&(e=this.callbacks_.shift(),this.pendingCallback_=e[1],e[0]())}},{key:"dispose",value:function(){var e=this,t=function t(){e.sourceBuffer_&&"open"===e.mediaSource.readyState&&e.sourceBuffer_.abort(),e.sourceBuffer_.removeEventListener("updateend",t)};this.sourceBuffer_.removeEventListener("updateend",this.onUpdateendCallback_),this.sourceBuffer_.removing?this.sourceBuffer_.addEventListener("updateend",t):t()}}]),e}(),Dd={GOAL_BUFFER_LENGTH:30,MAX_GOAL_BUFFER_LENGTH:60,GOAL_BUFFER_LENGTH_RATE:1,INITIAL_BANDWIDTH:4194304,BANDWIDTH_VARIANCE:1.2,BUFFER_LOW_WATER_LINE:0,MAX_BUFFER_LOW_WATER_LINE:30,BUFFER_LOW_WATER_LINE_RATE:1},Rd=2,xd=-101,Ad=-102,Pd=function(e){e.forEach(function(e){e.abort()})},Ld=function(e,t){return t.timedout?{status:t.status,message:"HLS request timed-out at URL: "+t.uri,code:xd,xhr:t}:t.aborted?{status:t.status,message:"HLS request aborted at URL: "+t.uri,code:Ad,xhr:t}:e?{status:t.status,message:"HLS request errored at URL: "+t.uri,code:Rd,xhr:t}:null},Nd=function(e,t,n,i,r,a,o){var s=[],l=function(e,t,n){var i=0,r=!1;return function(a,o){if(!r)return a?(r=!0,Pd(e),n(a,o)):(i+=1)===e.length?(o.endOfAllRequests=Date.now(),o.encryptedBytes?function(e,t,n){var i;e.addEventListener("message",function i(r){if(r.data.source===t.requestId){e.removeEventListener("message",i);var a=r.data.decrypted;return t.bytes=new Uint8Array(a.bytes,a.byteOffset,a.byteLength),n(null,t)}}),i=t.key.bytes.slice?t.key.bytes.slice():new Uint32Array(Array.prototype.slice.call(t.key.bytes)),e.postMessage(Lc({source:t.requestId,encrypted:t.encryptedBytes,key:i,iv:t.key.iv}),[t.encryptedBytes.buffer,i.buffer])}(t,o,n):n(null,o)):void 0}}(s,n,o);if(r.key&&!r.key.bytes){var u=to.mergeOptions(t,{uri:r.key.resolvedUri,responseType:"arraybuffer"}),c=function(e,t){return function(n,i){var r=i.response,a=Ld(n,i);if(a)return t(a,e);if(16!==r.byteLength)return t({status:i.status,message:"Invalid HLS key at URL: "+i.uri,code:Rd,xhr:i},e);var o=new DataView(r);return e.key.bytes=new Uint32Array([o.getUint32(0),o.getUint32(4),o.getUint32(8),o.getUint32(12)]),t(null,e)}}(r,l),d=e(u,c);s.push(d)}if(r.map&&!r.map.bytes){var h=to.mergeOptions(t,{uri:r.map.resolvedUri,responseType:"arraybuffer",headers:Rc(r.map)}),p=function(e,t,n){return function(i,r){var a=r.response,o=Ld(i,r);return o?n(o,e):0===a.byteLength?n({status:r.status,message:"Empty HLS segment content at URL: "+r.uri,code:Rd,xhr:r},e):(e.map.bytes=new Uint8Array(r.response),t&&!t.isInitialized()&&t.init(),e.map.timescales=Hs.timescale(e.map.bytes),e.map.videoTrackIds=Hs.videoTrackIds(e.map.bytes),n(null,e))}}(r,i,l),f=e(h,p);s.push(f)}var g=to.mergeOptions(t,{uri:r.resolvedUri,responseType:"arraybuffer",headers:Rc(r)}),m=function(e,t,n){return function(i,r){var a=r.response,o=Ld(i,r),s=void 0;return o?n(o,e):0===a.byteLength?n({status:r.status,message:"Empty HLS segment content at URL: "+r.uri,code:Rd,xhr:r},e):(e.stats=function(e){return{bandwidth:e.bandwidth,bytesReceived:e.bytesReceived||0,roundTripTime:e.roundTripTime||0}}(r),e.key?e.encryptedBytes=new Uint8Array(r.response):e.bytes=new Uint8Array(r.response),t&&e.map&&e.map.bytes&&(t.isInitialized()||t.init(),(s=t.parse(e.bytes,e.map.videoTrackIds,e.map.timescales))&&s.captions&&(e.captionStreams=s.captionStreams,e.fmp4Captions=s.captions)),n(null,e))}}(r,i,l),v=e(g,m);return v.addEventListener("progress",function(e,t){return function(n){var i,r,a;return e.stats=to.mergeOptions(e.stats,(r=(i=n).target,(a={bandwidth:1/0,bytesReceived:0,roundTripTime:Date.now()-r.requestTime||0}).bytesReceived=i.loaded,a.bandwidth=Math.floor(a.bytesReceived/a.roundTripTime*8*1e3),a)),!e.stats.firstBytesReceivedAt&&e.stats.bytesReceived&&(e.stats.firstBytesReceivedAt=Date.now()),t(n,e)}}(r,a)),s.push(v),function(){return Pd(s)}},Md=function(t,n){var i=void 0;return t&&(i=e.getComputedStyle(t))?i[n]:""},Kd=function(e,t){var n=e.slice();e.sort(function(e,i){var r=t(e,i);return 0===r?n.indexOf(e)-n.indexOf(i):r})},$d=function(t,n){var i=void 0,r=void 0;return t.attributes.BANDWIDTH&&(i=t.attributes.BANDWIDTH),i=i||e.Number.MAX_VALUE,n.attributes.BANDWIDTH&&(r=n.attributes.BANDWIDTH),i-(r=r||e.Number.MAX_VALUE)},jd=function(e){return"number"==typeof e&&isFinite(e)},Bd=function(t){function n(e){Qu(this,n);var t=ec(this,(n.__proto__||Object.getPrototypeOf(n)).call(this));if(!e)throw new TypeError("Initialization settings are required");if("function"!=typeof e.currentTime)throw new TypeError("No currentTime getter specified");if(!e.mediaSource)throw new TypeError("No MediaSource specified");return t.bandwidth=e.bandwidth,t.throughput={rate:0,count:0},t.roundTrip=NaN,t.resetStats_(),t.mediaIndex=null,t.hasPlayed_=e.hasPlayed,t.currentTime_=e.currentTime,t.seekable_=e.seekable,t.seeking_=e.seeking,t.duration_=e.duration,t.mediaSource_=e.mediaSource,t.hls_=e.hls,t.loaderType_=e.loaderType,t.startingMedia_=void 0,t.segmentMetadataTrack_=e.segmentMetadataTrack,t.goalBufferLength_=e.goalBufferLength,t.sourceType_=e.sourceType,t.inbandTextTracks_=e.inbandTextTracks,t.state_="INIT",t.checkBufferTimeout_=null,t.error_=void 0,t.currentTimeline_=-1,t.pendingSegment_=null,t.mimeType_=null,t.sourceUpdater_=null,t.xhrOptions_=null,t.activeInitSegmentId_=null,t.initSegments_={},t.cacheEncryptionKeys_=e.cacheEncryptionKeys,t.keyCache_={},"main"===t.loaderType_?t.captionParser_=new Iu:t.captionParser_=null,t.decrypter_=e.decrypter,t.syncController_=e.syncController,t.syncPoint_={segmentIndex:0,time:0},t.syncController_.on("syncinfoupdate",function(){return t.trigger("syncinfoupdate")}),t.mediaSource_.addEventListener("sourceopen",function(){return t.ended_=!1}),t.fetchAtBuffer_=!1,t.logger_=Sd("SegmentLoader["+t.loaderType_+"]"),Object.defineProperty(t,"state",{get:function(){return this.state_},set:function(e){e!==this.state_&&(this.logger_(this.state_+" -> "+e),this.state_=e)}}),t}return Zu(n,t),Ju(n,[{key:"resetStats_",value:function(){this.mediaBytesTransferred=0,this.mediaRequests=0,this.mediaRequestsAborted=0,this.mediaRequestsTimedout=0,this.mediaRequestsErrored=0,this.mediaTransferDuration=0,this.mediaSecondsLoaded=0}},{key:"dispose",value:function(){this.state="DISPOSED",this.pause(),this.abort_(),this.sourceUpdater_&&this.sourceUpdater_.dispose(),this.resetStats_(),this.captionParser_&&this.captionParser_.reset()}},{key:"abort",value:function(){"WAITING"===this.state?(this.abort_(),this.state="READY",this.paused()||this.monitorBuffer_()):this.pendingSegment_&&(this.pendingSegment_=null)}},{key:"abort_",value:function(){this.pendingSegment_&&this.pendingSegment_.abortRequests(),this.pendingSegment_=null}},{key:"error",value:function(e){return void 0!==e&&(this.error_=e),this.pendingSegment_=null,this.error_}},{key:"endOfStream",value:function(){this.ended_=!0,this.pause(),this.trigger("ended")}},{key:"buffered_",value:function(){return this.sourceUpdater_?this.sourceUpdater_.buffered():to.createTimeRanges()}},{key:"initSegment",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!e)return null;var n=Nc(e),i=this.initSegments_[n];return t&&!i&&e.bytes&&(this.initSegments_[n]=i={resolvedUri:e.resolvedUri,byterange:e.byterange,bytes:e.bytes,timescales:e.timescales,videoTrackIds:e.videoTrackIds}),i||e}},{key:"segmentKey",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!e)return null;var n=Mc(e),i=this.keyCache_[n];this.cacheEncryptionKeys_&&t&&!i&&e.bytes&&(this.keyCache_[n]=i={resolvedUri:e.resolvedUri,bytes:e.bytes});var r={resolvedUri:(i||e).resolvedUri};return i&&(r.bytes=i.bytes),r}},{key:"couldBeginLoading_",value:function(){return this.playlist_&&(this.sourceUpdater_||this.mimeType_&&"INIT"===this.state)&&!this.paused()}},{key:"load",value:function(){if(this.monitorBuffer_(),this.playlist_){if(this.syncController_.setDateTimeMapping(this.playlist_),"INIT"===this.state&&this.couldBeginLoading_())return this.init_();!this.couldBeginLoading_()||"READY"!==this.state&&"INIT"!==this.state||(this.state="READY")}}},{key:"init_",value:function(){return this.state="READY",this.sourceUpdater_=new Od(this.mediaSource_,this.mimeType_,this.loaderType_,this.sourceBufferEmitter_),this.resetEverything(),this.monitorBuffer_()}},{key:"playlist",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(e){var n=this.playlist_,i=this.pendingSegment_;this.playlist_=e,this.xhrOptions_=t,this.hasPlayed_()||(e.syncInfo={mediaSequence:e.mediaSequence,time:0});var r=null;if(n&&(n.id?r=n.id:n.uri&&(r=n.uri)),this.logger_("playlist update ["+r+" => "+(e.id||e.uri)+"]"),this.trigger("syncinfoupdate"),"INIT"===this.state&&this.couldBeginLoading_())return this.init_();if(n&&n.uri===e.uri){var a=e.mediaSequence-n.mediaSequence;this.logger_("live window shift ["+a+"]"),null!==this.mediaIndex&&(this.mediaIndex-=a),i&&(i.mediaIndex-=a,i.mediaIndex>=0&&(i.segment=e.segments[i.mediaIndex])),this.syncController_.saveExpiredSegmentInfo(n,e)}else null!==this.mediaIndex&&this.resyncLoader()}}},{key:"pause",value:function(){this.checkBufferTimeout_&&(e.clearTimeout(this.checkBufferTimeout_),this.checkBufferTimeout_=null)}},{key:"paused",value:function(){return null===this.checkBufferTimeout_}},{key:"mimeType",value:function(e,t){this.mimeType_||(this.mimeType_=e,this.sourceBufferEmitter_=t,"INIT"===this.state&&this.couldBeginLoading_()&&this.init_())}},{key:"resetEverything",value:function(e){this.ended_=!1,this.resetLoader(),this.remove(0,this.duration_(),e),this.captionParser_&&this.captionParser_.clearAllCaptions(),this.trigger("reseteverything")}},{key:"resetLoader",value:function(){this.fetchAtBuffer_=!1,this.resyncLoader()}},{key:"resyncLoader",value:function(){this.mediaIndex=null,this.syncPoint_=null,this.abort()}},{key:"remove",value:function(e,t,n){if(this.sourceUpdater_&&this.sourceUpdater_.remove(e,t,n),qc(e,t,this.segmentMetadataTrack_),this.inbandTextTracks_)for(var i in this.inbandTextTracks_)qc(e,t,this.inbandTextTracks_[i])}},{key:"monitorBuffer_",value:function(){this.checkBufferTimeout_&&e.clearTimeout(this.checkBufferTimeout_),this.checkBufferTimeout_=e.setTimeout(this.monitorBufferTick_.bind(this),1)}},{key:"monitorBufferTick_",value:function(){"READY"===this.state&&this.fillBuffer_(),this.checkBufferTimeout_&&e.clearTimeout(this.checkBufferTimeout_),this.checkBufferTimeout_=e.setTimeout(this.monitorBufferTick_.bind(this),500)}},{key:"fillBuffer_",value:function(){if(!this.sourceUpdater_.updating()){this.syncPoint_||(this.syncPoint_=this.syncController_.getSyncPoint(this.playlist_,this.duration_(),this.currentTimeline_,this.currentTime_()));var e=this.checkBuffer_(this.buffered_(),this.playlist_,this.mediaIndex,this.hasPlayed_(),this.currentTime_(),this.syncPoint_);e&&(this.isEndOfStream_(e.mediaIndex)?this.endOfStream():(e.mediaIndex!==this.playlist_.segments.length-1||"ended"!==this.mediaSource_.readyState||this.seeking_())&&(e.timeline!==this.currentTimeline_&&(this.syncController_.reset(),e.timestampOffset=e.startOfSegment,this.captionParser_&&this.captionParser_.clearAllCaptions()),this.loadSegment_(e)))}}},{key:"isEndOfStream_",value:function(e){return function(e,t,n){if(!e||!t)return!1;var i=n===e.segments.length;return e.endList&&"open"===t.readyState&&i}(arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.playlist_,this.mediaSource_,e)&&!this.sourceUpdater_.updating()}},{key:"checkBuffer_",value:function(e,t,n,i,r,a){var o=0,s=void 0;e.length&&(o=e.end(e.length-1));var l=Math.max(0,o-r);if(!t.segments.length)return null;if(l>=this.goalBufferLength_())return null;if(!i&&l>=1)return null;if(null===a)return n=this.getSyncSegmentCandidate_(t),this.generateSegmentInfo_(t,n,null,!0);if(null!==n){var u=t.segments[n];return s=u&&u.end?u.end:o,this.generateSegmentInfo_(t,n+1,s,!1)}if(this.fetchAtBuffer_){var c=Sc.getMediaInfoForTime(t,o,a.segmentIndex,a.time);n=c.mediaIndex,s=c.startTime}else{var d=Sc.getMediaInfoForTime(t,r,a.segmentIndex,a.time);n=d.mediaIndex,s=d.startTime}return this.generateSegmentInfo_(t,n,s,!1)}},{key:"getSyncSegmentCandidate_",value:function(e){var t=this;if(-1===this.currentTimeline_)return 0;var n=e.segments.map(function(e,t){return{timeline:e.timeline,segmentIndex:t}}).filter(function(e){return e.timeline===t.currentTimeline_});return n.length?n[Math.min(n.length-1,1)].segmentIndex:Math.max(e.segments.length-1,0)}},{key:"generateSegmentInfo_",value:function(e,t,n,i){if(t<0||t>=e.segments.length)return null;var r=e.segments[t];return{requestId:"segment-loader-"+Math.random(),uri:r.resolvedUri,mediaIndex:t,isSyncRequest:i,startOfSegment:n,playlist:e,bytes:null,encryptedBytes:null,timestampOffset:null,timeline:r.timeline,duration:r.duration,segment:r}}},{key:"abortRequestEarly_",value:function(e){if(this.hls_.tech_.paused()||!this.xhrOptions_.timeout||!this.playlist_.attributes.BANDWIDTH)return!1;if(Date.now()-(e.firstBytesReceivedAt||Date.now())<1e3)return!1;var t=this.currentTime_(),n=e.bandwidth,i=this.pendingSegment_.duration,r=Sc.estimateSegmentRequestTime(i,n,this.playlist_,e.bytesReceived),a=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return((e.length?e.end(e.length-1):0)-t)/n}(this.buffered_(),t,this.hls_.tech_.playbackRate())-1;if(r<=a)return!1;var o=function(e){var t=e.currentTime,n=e.bandwidth,i=e.duration,r=e.segmentDuration,a=e.timeUntilRebuffer,o=e.currentTimeline,s=e.syncController,l=e.master.playlists.filter(function(e){return!Sc.isIncompatible(e)}),u=l.filter(Sc.isEnabled);u.length||(u=l.filter(function(e){return!Sc.isDisabled(e)}));var c=u.filter(Sc.hasAttribute.bind(null,"BANDWIDTH")).map(function(e){var l=s.getSyncPoint(e,i,o,t)?1:2;return{playlist:e,rebufferingImpact:Sc.estimateSegmentRequestTime(r,n,e)*l-a}}),d=c.filter(function(e){return e.rebufferingImpact<=0});return Kd(d,function(e,t){return $d(t.playlist,e.playlist)}),d.length?d[0]:(Kd(c,function(e,t){return e.rebufferingImpact-t.rebufferingImpact}),c[0]||null)}({master:this.hls_.playlists.master,currentTime:t,bandwidth:n,duration:this.duration_(),segmentDuration:i,timeUntilRebuffer:a,currentTimeline:this.currentTimeline_,syncController:this.syncController_});if(o){var s=r-a-o.rebufferingImpact,l=.5;return a<=1/30&&(l=1),!(!o.playlist||o.playlist.uri===this.playlist_.uri||s<l||(this.bandwidth=o.playlist.attributes.BANDWIDTH*Dd.BANDWIDTH_VARIANCE+1,this.abort(),this.trigger("earlyabort"),0))}}},{key:"handleProgress_",value:function(e,t){this.pendingSegment_&&t.requestId===this.pendingSegment_.requestId&&!this.abortRequestEarly_(t.stats)&&this.trigger("progress")}},{key:"loadSegment_",value:function(e){this.state="WAITING",this.pendingSegment_=e,this.trimBackBuffer_(e),e.abortRequests=Nd(this.hls_.xhr,this.xhrOptions_,this.decrypter_,this.captionParser_,this.createSimplifiedSegmentObj_(e),this.handleProgress_.bind(this),this.segmentRequestFinished_.bind(this))}},{key:"trimBackBuffer_",value:function(e){var t=function(e,t,n){var i;return i=e.length&&e.start(0)>0&&e.start(0)<t?e.start(0):t-30,Math.min(i,t-n)}(this.seekable_(),this.currentTime_(),this.playlist_.targetDuration||10);t>0&&this.remove(0,t)}},{key:"createSimplifiedSegmentObj_",value:function(e){var t=e.segment,n={resolvedUri:t.resolvedUri,byterange:t.byterange,requestId:e.requestId};if(t.key){var i=t.key.iv||new Uint32Array([0,0,0,e.mediaIndex+e.playlist.mediaSequence]);n.key=this.segmentKey(t.key),n.key.iv=i}return t.map&&(n.map=this.initSegment(t.map)),n}},{key:"segmentRequestFinished_",value:function(e,t){if(this.mediaRequests+=1,t.stats&&(this.mediaBytesTransferred+=t.stats.bytesReceived,this.mediaTransferDuration+=t.stats.roundTripTime),this.pendingSegment_){if(t.requestId===this.pendingSegment_.requestId){if(e)return this.pendingSegment_=null,this.state="READY",e.code===Ad?void(this.mediaRequestsAborted+=1):(this.pause(),e.code===xd?(this.mediaRequestsTimedout+=1,this.bandwidth=1,this.roundTrip=NaN,void this.trigger("bandwidthupdate")):(this.mediaRequestsErrored+=1,this.error(e),void this.trigger("error")));this.bandwidth=t.stats.bandwidth,this.roundTrip=t.stats.roundTripTime,t.map&&(t.map=this.initSegment(t.map,!0)),t.key&&this.segmentKey(t.key,!0),this.processSegmentResponse_(t)}}else this.mediaRequestsAborted+=1}},{key:"processSegmentResponse_",value:function(e){var t=this.pendingSegment_;t.bytes=e.bytes,e.map&&(t.segment.map.bytes=e.map.bytes),t.endOfAllRequests=e.endOfAllRequests,e.fmp4Captions&&(function(e,t,n){for(var i in n)if(!e[i]){t.trigger({type:"usage",name:"hls-608"});var r=t.textTracks().getTrackById(i);e[i]=r||t.addRemoteTextTrack({kind:"captions",id:i,label:i},!1).track}}(this.inbandTextTracks_,this.hls_.tech_,e.captionStreams),function(e){var t=e.inbandTextTracks,n=e.captionArray,i=e.timestampOffset;if(n){var r=window.WebKitDataCue||window.VTTCue;n.forEach(function(e){var n=e.stream,a=e.startTime,o=e.endTime;t[n]&&(a+=i,o+=i,t[n].addCue(new r(a,o,e.text)))})}}({inbandTextTracks:this.inbandTextTracks_,captionArray:e.fmp4Captions,timestampOffset:0}),this.captionParser_&&this.captionParser_.clearParsedCaptions()),this.handleSegment_()}},{key:"handleSegment_",value:function(){var e,t,n,i=this;if(this.pendingSegment_){var r=this.pendingSegment_,a=r.segment,o=this.syncController_.probeSegmentInfo(r);void 0===this.startingMedia_&&o&&(o.containsAudio||o.containsVideo)&&(this.startingMedia_={containsAudio:o.containsAudio,containsVideo:o.containsVideo});var s=(e=this.loaderType_,t=this.startingMedia_,n=o,"main"===e&&t&&n?n.containsAudio||n.containsVideo?t.containsVideo&&!n.containsVideo?"Only audio found in segment when we expected video. We can't switch to audio only from a stream that had video. To get rid of this message, please add codec information to the manifest.":!t.containsVideo&&n.containsVideo?"Video found in segment when we expected only audio. We can't switch to a stream with video from an audio only stream. To get rid of this message, please add codec information to the manifest.":null:"Neither audio nor video found in segment.":null);if(s)return this.error({message:s,blacklistDuration:1/0}),void this.trigger("error");if(r.isSyncRequest)return this.trigger("syncinfoupdate"),this.pendingSegment_=null,void(this.state="READY");null!==r.timestampOffset&&r.timestampOffset!==this.sourceUpdater_.timestampOffset()&&(this.sourceUpdater_.timestampOffset(r.timestampOffset),this.trigger("timestampoffset"));var l=this.syncController_.mappingForTimeline(r.timeline);if(null!==l&&this.trigger({type:"segmenttimemapping",mapping:l}),this.state="APPENDING",a.map){var u=Nc(a.map);if(!this.activeInitSegmentId_||this.activeInitSegmentId_!==u){var c=this.initSegment(a.map);this.sourceUpdater_.appendBuffer({bytes:c.bytes},function(){i.activeInitSegmentId_=u})}}r.byteLength=r.bytes.byteLength,"number"==typeof a.start&&"number"==typeof a.end?this.mediaSecondsLoaded+=a.end-a.start:this.mediaSecondsLoaded+=a.duration,this.logger_(function(e){var t=e.segment,n=t.start,i=t.end,r=e.playlist,a=r.mediaSequence,o=r.id,s=r.segments,l=void 0===s?[]:s,u=e.mediaIndex,c=e.timeline;return["appending ["+u+"] of ["+a+", "+(a+l.length)+"] from playlist ["+o+"]","["+n+" => "+i+"] in timeline ["+c+"]"].join(" ")}(r)),this.sourceUpdater_.appendBuffer({bytes:r.bytes,videoSegmentTimingInfoCallback:this.handleVideoSegmentTimingInfo_.bind(this,r.requestId)},this.handleUpdateEnd_.bind(this))}else this.state="READY"}},{key:"handleVideoSegmentTimingInfo_",value:function(e,t){if(this.pendingSegment_&&e===this.pendingSegment_.requestId){var n=this.pendingSegment_.segment;n.videoTimingInfo||(n.videoTimingInfo={}),n.videoTimingInfo.transmuxerPrependedSeconds=t.videoSegmentTimingInfo.prependedContentDuration||0,n.videoTimingInfo.transmuxedPresentationStart=t.videoSegmentTimingInfo.start.presentation,n.videoTimingInfo.transmuxedPresentationEnd=t.videoSegmentTimingInfo.end.presentation,n.videoTimingInfo.baseMediaDecodeTime=t.videoSegmentTimingInfo.baseMediaDecodeTime}}},{key:"handleUpdateEnd_",value:function(){if(!this.pendingSegment_)return this.state="READY",void(this.paused()||this.monitorBuffer_());var e=this.pendingSegment_,t=e.segment,n=null!==this.mediaIndex;this.pendingSegment_=null,this.recordThroughput_(e),this.addSegmentMetadataCue_(e),this.state="READY",this.mediaIndex=e.mediaIndex,this.fetchAtBuffer_=!0,this.currentTimeline_=e.timeline,this.trigger("syncinfoupdate"),t.end&&this.currentTime_()-t.end>3*e.playlist.targetDuration?this.resetEverything():(n&&this.trigger("bandwidthupdate"),this.trigger("progress"),this.isEndOfStream_(e.mediaIndex+1,e.playlist)&&this.endOfStream(),this.paused()||this.monitorBuffer_())}},{key:"recordThroughput_",value:function(e){var t=this.throughput.rate,n=Date.now()-e.endOfAllRequests+1,i=Math.floor(e.byteLength/n*8*1e3);this.throughput.rate+=(i-t)/++this.throughput.count}},{key:"addSegmentMetadataCue_",value:function(t){if(this.segmentMetadataTrack_){var n=t.segment,i=n.start,r=n.end;if(jd(i)&&jd(r)){qc(i,r,this.segmentMetadataTrack_);var a=e.WebKitDataCue||e.VTTCue,o={custom:n.custom,dateTimeObject:n.dateTimeObject,dateTimeString:n.dateTimeString,bandwidth:t.playlist.attributes.BANDWIDTH,resolution:t.playlist.attributes.RESOLUTION,codecs:t.playlist.attributes.CODECS,byteLength:t.byteLength,uri:t.uri,timeline:t.timeline,playlist:t.playlist.uri,start:i,end:r},s=new a(i,r,JSON.stringify(o));s.value=o,this.segmentMetadataTrack_.addCue(s)}}}}]),n}(to.EventTarget),Fd=function(e){return decodeURIComponent(escape(String.fromCharCode.apply(null,e)))},Ud=new Uint8Array("\n\n".split("").map(function(e){return e.charCodeAt(0)})),Vd=function(t){function n(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Qu(this,n);var i=ec(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,e,t));return i.mediaSource_=null,i.subtitlesTrack_=null,i}return Zu(n,Bd),Ju(n,[{key:"buffered_",value:function(){if(!this.subtitlesTrack_||!this.subtitlesTrack_.cues.length)return to.createTimeRanges();var e=this.subtitlesTrack_.cues,t=e[0].startTime,n=e[e.length-1].startTime;return to.createTimeRanges([[t,n]])}},{key:"initSegment",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!e)return null;var n=Nc(e),i=this.initSegments_[n];if(t&&!i&&e.bytes){var r=Ud.byteLength+e.bytes.byteLength,a=new Uint8Array(r);a.set(e.bytes),a.set(Ud,e.bytes.byteLength),this.initSegments_[n]=i={resolvedUri:e.resolvedUri,byterange:e.byterange,bytes:a}}return i||e}},{key:"couldBeginLoading_",value:function(){return this.playlist_&&this.subtitlesTrack_&&!this.paused()}},{key:"init_",value:function(){return this.state="READY",this.resetEverything(),this.monitorBuffer_()}},{key:"track",value:function(e){return void 0===e?this.subtitlesTrack_:(this.subtitlesTrack_=e,"INIT"===this.state&&this.couldBeginLoading_()&&this.init_(),this.subtitlesTrack_)}},{key:"remove",value:function(e,t){qc(e,t,this.subtitlesTrack_)}},{key:"fillBuffer_",value:function(){var e=this;this.syncPoint_||(this.syncPoint_=this.syncController_.getSyncPoint(this.playlist_,this.duration_(),this.currentTimeline_,this.currentTime_()));var t=this.checkBuffer_(this.buffered_(),this.playlist_,this.mediaIndex,this.hasPlayed_(),this.currentTime_(),this.syncPoint_);if(t=this.skipEmptySegments_(t)){if(null===this.syncController_.timestampOffsetForTimeline(t.timeline))return this.syncController_.one("timestampoffset",function(){e.state="READY",e.paused()||e.monitorBuffer_()}),void(this.state="WAITING_ON_TIMELINE");this.loadSegment_(t)}}},{key:"skipEmptySegments_",value:function(e){for(;e&&e.segment.empty;)e=this.generateSegmentInfo_(e.playlist,e.mediaIndex+1,e.startOfSegment+e.duration,e.isSyncRequest);return e}},{key:"handleSegment_",value:function(){var t=this;if(this.pendingSegment_&&this.subtitlesTrack_){this.state="APPENDING";var n=this.pendingSegment_,i=n.segment;if("function"!=typeof e.WebVTT&&this.subtitlesTrack_&&this.subtitlesTrack_.tech_){var r=void 0,a=function(){t.subtitlesTrack_.tech_.off("vttjsloaded",r),t.error({message:"Error loading vtt.js"}),t.state="READY",t.pause(),t.trigger("error")};return r=function(){t.subtitlesTrack_.tech_.off("vttjserror",a),t.handleSegment_()},this.state="WAITING_ON_VTTJS",this.subtitlesTrack_.tech_.one("vttjsloaded",r),void this.subtitlesTrack_.tech_.one("vttjserror",a)}i.requested=!0;try{this.parseVTTCues_(n)}catch(e){return this.error({message:e.message}),this.state="READY",this.pause(),this.trigger("error")}if(this.updateTimeMapping_(n,this.syncController_.timelines[n.timeline],this.playlist_),n.isSyncRequest)return this.trigger("syncinfoupdate"),this.pendingSegment_=null,void(this.state="READY");n.byteLength=n.bytes.byteLength,this.mediaSecondsLoaded+=i.duration,n.cues.length&&this.remove(n.cues[0].endTime,n.cues[n.cues.length-1].endTime),n.cues.forEach(function(e){t.subtitlesTrack_.addCue(e)}),this.handleUpdateEnd_()}else this.state="READY"}},{key:"parseVTTCues_",value:function(t){var n=void 0,i=!1;"function"==typeof e.TextDecoder?n=new e.TextDecoder("utf8"):(n=e.WebVTT.StringDecoder(),i=!0);var r=new e.WebVTT.Parser(e,e.vttjs,n);if(t.cues=[],t.timestampmap={MPEGTS:0,LOCAL:0},r.oncue=t.cues.push.bind(t.cues),r.ontimestampmap=function(e){return t.timestampmap=e},r.onparsingerror=function(e){to.log.warn("Error encountered when parsing cues: "+e.message)},t.segment.map){var a=t.segment.map.bytes;i&&(a=Fd(a)),r.parse(a)}var o=t.bytes;i&&(o=Fd(o)),r.parse(o),r.flush()}},{key:"updateTimeMapping_",value:function(e,t,n){var i=e.segment;if(t)if(e.cues.length){var r=e.timestampmap,a=r.MPEGTS/9e4-r.LOCAL+t.mapping;if(e.cues.forEach(function(e){e.startTime+=a,e.endTime+=a}),!n.syncInfo){var o=e.cues[0].startTime,s=e.cues[e.cues.length-1].startTime;n.syncInfo={mediaSequence:n.mediaSequence+e.mediaIndex,time:Math.min(o,s-i.duration)}}}else i.empty=!0}}]),n}(),qd=function(e,t){for(var n=e.cues,i=0;i<n.length;i++){var r=n[i];if(t>=r.adStartTime&&t<=r.adEndTime)return r}return null},Hd=Ku,zd=[{name:"VOD",run:function(e,t,n,i,r){return n!==1/0?{time:0,segmentIndex:0}:null}},{name:"ProgramDateTime",run:function(e,t,n,i,r){if(!e.datetimeToDisplayTime)return null;var a=t.segments||[],o=null,s=null;r=r||0;for(var l=0;l<a.length;l++){var u=a[l];if(u.dateTimeObject){var c=u.dateTimeObject.getTime()/1e3+e.datetimeToDisplayTime,d=Math.abs(r-c);if(null!==s&&(0===d||s<d))break;s=d,o={time:c,segmentIndex:l}}}return o}},{name:"Segment",run:function(e,t,n,i,r){var a=t.segments||[],o=null,s=null;r=r||0;for(var l=0;l<a.length;l++){var u=a[l];if(u.timeline===i&&void 0!==u.start){var c=Math.abs(r-u.start);if(null!==s&&s<c)break;(!o||null===s||s>=c)&&(s=c,o={time:u.start,segmentIndex:l})}}return o}},{name:"Discontinuity",run:function(e,t,n,i,r){var a=null;if(r=r||0,t.discontinuityStarts&&t.discontinuityStarts.length)for(var o=null,s=0;s<t.discontinuityStarts.length;s++){var l=t.discontinuityStarts[s],u=t.discontinuitySequence+s+1,c=e.discontinuities[u];if(c){var d=Math.abs(r-c.time);if(null!==o&&o<d)break;(!a||null===o||o>=d)&&(o=d,a={time:c.time,segmentIndex:l})}}return a}},{name:"Playlist",run:function(e,t,n,i,r){return t.syncInfo?{time:t.syncInfo.time,segmentIndex:t.syncInfo.mediaSequence-t.mediaSequence}:null}}],Wd=function(e){function t(){Qu(this,t);var e=ec(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.inspectCache_=void 0,e.timelines=[],e.discontinuities=[],e.datetimeToDisplayTime=null,e.logger_=Sd("SyncController"),e}return Zu(t,e),Ju(t,[{key:"getSyncPoint",value:function(e,t,n,i){var r=this.runStrategies_(e,t,n,i);return r.length?this.selectSyncPoint_(r,{key:"time",value:i}):null}},{key:"getExpiredTime",value:function(e,t){if(!e||!e.segments)return null;var n=this.runStrategies_(e,t,e.discontinuitySequence,0);if(!n.length)return null;var i=this.selectSyncPoint_(n,{key:"segmentIndex",value:0});return i.segmentIndex>0&&(i.time*=-1),Math.abs(i.time+fc(e,i.segmentIndex,0))}},{key:"runStrategies_",value:function(e,t,n,i){for(var r=[],a=0;a<zd.length;a++){var o=zd[a],s=o.run(this,e,t,n,i);s&&(s.strategy=o.name,r.push({strategy:o.name,syncPoint:s}))}return r}},{key:"selectSyncPoint_",value:function(e,t){for(var n=e[0].syncPoint,i=Math.abs(e[0].syncPoint[t.key]-t.value),r=e[0].strategy,a=1;a<e.length;a++){var o=Math.abs(e[a].syncPoint[t.key]-t.value);o<i&&(i=o,n=e[a].syncPoint,r=e[a].strategy)}return this.logger_("syncPoint for ["+t.key+": "+t.value+"] chosen with strategy ["+r+"]: [time:"+n.time+", segmentIndex:"+n.segmentIndex+"]"),n}},{key:"saveExpiredSegmentInfo",value:function(e,t){for(var n=t.mediaSequence-e.mediaSequence-1;n>=0;n--){var i=e.segments[n];if(i&&void 0!==i.start){t.syncInfo={mediaSequence:e.mediaSequence+n,time:i.start},this.logger_("playlist refresh sync: [time:"+t.syncInfo.time+", mediaSequence: "+t.syncInfo.mediaSequence+"]"),this.trigger("syncinfoupdate");break}}}},{key:"setDateTimeMapping",value:function(e){if(!this.datetimeToDisplayTime&&e.segments&&e.segments.length&&e.segments[0].dateTimeObject){var t=e.segments[0].dateTimeObject.getTime()/1e3;this.datetimeToDisplayTime=-t}}},{key:"reset",value:function(){this.inspectCache_=void 0}},{key:"probeSegmentInfo",value:function(e){var t,n=e.segment,i=e.playlist;return(t=n.map?this.probeMp4Segment_(e):this.probeTsSegment_(e))&&this.calculateSegmentTimeMapping_(e,t)&&(this.saveDiscontinuitySyncInfo_(e),i.syncInfo||(i.syncInfo={mediaSequence:i.mediaSequence+e.mediaIndex,time:n.start})),t}},{key:"probeMp4Segment_",value:function(e){var t=e.segment,n=Hs.timescale(t.map.bytes),i=Hs.startTime(n,e.bytes);return null!==e.timestampOffset&&(e.timestampOffset-=i),{start:i,end:i+t.duration}}},{key:"probeTsSegment_",value:function(e){var t=Hd(e.bytes,this.inspectCache_),n=void 0,i=void 0;return t?(t.video&&2===t.video.length?(this.inspectCache_=t.video[1].dts,n=t.video[0].dtsTime,i=t.video[1].dtsTime):t.audio&&2===t.audio.length&&(this.inspectCache_=t.audio[1].dts,n=t.audio[0].dtsTime,i=t.audio[1].dtsTime),{start:n,end:i,containsVideo:t.video&&2===t.video.length,containsAudio:t.audio&&2===t.audio.length}):null}},{key:"timestampOffsetForTimeline",value:function(e){return void 0===this.timelines[e]?null:this.timelines[e].time}},{key:"mappingForTimeline",value:function(e){return void 0===this.timelines[e]?null:this.timelines[e].mapping}},{key:"calculateSegmentTimeMapping_",value:function(e,t){var n=e.segment,i=this.timelines[e.timeline];if(null!==e.timestampOffset)i={time:e.startOfSegment,mapping:e.startOfSegment-t.start},this.timelines[e.timeline]=i,this.trigger("timestampoffset"),this.logger_("time mapping for timeline "+e.timeline+": [time: "+i.time+"] [mapping: "+i.mapping+"]"),n.start=e.startOfSegment,n.end=t.end+i.mapping;else{if(!i)return!1;n.start=t.start+i.mapping,n.end=t.end+i.mapping}return!0}},{key:"saveDiscontinuitySyncInfo_",value:function(e){var t=e.playlist,n=e.segment;if(n.discontinuity)this.discontinuities[n.timeline]={time:n.start,accuracy:0};else if(t.discontinuityStarts&&t.discontinuityStarts.length)for(var i=0;i<t.discontinuityStarts.length;i++){var r=t.discontinuityStarts[i],a=t.discontinuitySequence+i+1,o=r-e.mediaIndex,s=Math.abs(o);if(!this.discontinuities[a]||this.discontinuities[a].accuracy>s){var l;l=o<0?n.start-fc(t,e.mediaIndex,r):n.end+fc(t,e.mediaIndex+1,r),this.discontinuities[a]={time:l,accuracy:s}}}}}]),t}(to.EventTarget),Gd=new Zc("./decrypter-worker.worker.js",function(e,t){var n,i,r,a,o,s,l,u,c,d;n=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},i=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t},a=function(){var e=[[[],[],[],[],[]],[[],[],[],[],[]]],t=e[0],n=e[1],i=t[4],r=n[4],a=void 0,o=void 0,s=void 0,l=[],u=[],c=void 0,d=void 0,h=void 0,p=void 0,f=void 0;for(a=0;a<256;a++)u[(l[a]=a<<1^283*(a>>7))^a]=a;for(o=s=0;!i[o];o^=c||1,s=u[s]||1)for(h=(h=s^s<<1^s<<2^s<<3^s<<4)>>8^255&h^99,i[o]=h,r[h]=o,f=16843009*l[d=l[c=l[o]]]^65537*d^257*c^16843008*o,p=257*l[h]^16843008*h,a=0;a<4;a++)t[a][o]=p=p<<24^p>>>8,n[a][h]=f=f<<24^f>>>8;for(a=0;a<5;a++)t[a]=t[a].slice(0),n[a]=n[a].slice(0);return e},o=null,s=function(){function e(t){n(this,e),o||(o=a()),this._tables=[[o[0][0].slice(),o[0][1].slice(),o[0][2].slice(),o[0][3].slice(),o[0][4].slice()],[o[1][0].slice(),o[1][1].slice(),o[1][2].slice(),o[1][3].slice(),o[1][4].slice()]];var i=void 0,r=void 0,s=void 0,l=void 0,u=void 0,c=this._tables[0][4],d=this._tables[1],h=t.length,p=1;if(4!==h&&6!==h&&8!==h)throw new Error("Invalid aes key size");for(l=t.slice(0),u=[],this._key=[l,u],i=h;i<4*h+28;i++)s=l[i-1],(i%h==0||8===h&&i%h==4)&&(s=c[s>>>24]<<24^c[s>>16&255]<<16^c[s>>8&255]<<8^c[255&s],i%h==0&&(s=s<<8^s>>>24^p<<24,p=p<<1^283*(p>>7))),l[i]=l[i-h]^s;for(r=0;i;r++,i--)s=l[3&r?i:i-4],u[r]=i<=4||r<4?s:d[0][c[s>>>24]]^d[1][c[s>>16&255]]^d[2][c[s>>8&255]]^d[3][c[255&s]]}return e.prototype.decrypt=function(e,t,n,i,r,a){var o=this._key[1],s=e^o[0],l=i^o[1],u=n^o[2],c=t^o[3],d=void 0,h=void 0,p=void 0,f=o.length/4-2,g=void 0,m=4,v=this._tables[1],y=v[0],b=v[1],_=v[2],T=v[3],E=v[4];for(g=0;g<f;g++)d=y[s>>>24]^b[l>>16&255]^_[u>>8&255]^T[255&c]^o[m],h=y[l>>>24]^b[u>>16&255]^_[c>>8&255]^T[255&s]^o[m+1],p=y[u>>>24]^b[c>>16&255]^_[s>>8&255]^T[255&l]^o[m+2],c=y[c>>>24]^b[s>>16&255]^_[l>>8&255]^T[255&u]^o[m+3],m+=4,s=d,l=h,u=p;for(g=0;g<4;g++)r[(3&-g)+a]=E[s>>>24]<<24^E[l>>16&255]<<16^E[u>>8&255]<<8^E[255&c]^o[m++],d=s,s=l,l=u,u=c,c=d},e}(),l=function(){function e(){n(this,e),this.listeners={}}return e.prototype.on=function(e,t){this.listeners[e]||(this.listeners[e]=[]),this.listeners[e].push(t)},e.prototype.off=function(e,t){if(!this.listeners[e])return!1;var n=this.listeners[e].indexOf(t);return this.listeners[e].splice(n,1),n>-1},e.prototype.trigger=function(e){var t=this.listeners[e];if(t)if(2===arguments.length)for(var n=t.length,i=0;i<n;++i)t[i].call(this,arguments[1]);else for(var r=Array.prototype.slice.call(arguments,1),a=t.length,o=0;o<a;++o)t[o].apply(this,r)},e.prototype.dispose=function(){this.listeners={}},e.prototype.pipe=function(e){this.on("data",function(t){e.push(t)})},e}(),u=function(e){function t(){n(this,t);var i=r(this,e.call(this,l));return i.jobs=[],i.delay=1,i.timeout_=null,i}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t.prototype.processJob_=function(){this.jobs.shift()(),this.jobs.length?this.timeout_=setTimeout(this.processJob_.bind(this),this.delay):this.timeout_=null},t.prototype.push=function(e){this.jobs.push(e),this.timeout_||(this.timeout_=setTimeout(this.processJob_.bind(this),this.delay))},t}(l),c=function(e){return e<<24|(65280&e)<<8|(16711680&e)>>8|e>>>24},d=function(){function e(t,i,r,a){n(this,e);var o=e.STEP,s=new Int32Array(t.buffer),l=new Uint8Array(t.byteLength),d=0;for(this.asyncStream_=new u,this.asyncStream_.push(this.decryptChunk_(s.subarray(d,d+o),i,r,l)),d=o;d<s.length;d+=o)r=new Uint32Array([c(s[d-4]),c(s[d-3]),c(s[d-2]),c(s[d-1])]),this.asyncStream_.push(this.decryptChunk_(s.subarray(d,d+o),i,r,l));this.asyncStream_.push(function(){var e;a(null,(e=l).subarray(0,e.byteLength-e[e.byteLength-1]))})}return e.prototype.decryptChunk_=function(e,t,n,i){return function(){var r=function(e,t,n){var i=new Int32Array(e.buffer,e.byteOffset,e.byteLength>>2),r=new s(Array.prototype.slice.call(t)),a=new Uint8Array(e.byteLength),o=new Int32Array(a.buffer),l=void 0,u=void 0,d=void 0,h=void 0,p=void 0,f=void 0,g=void 0,m=void 0,v=void 0;for(l=n[0],u=n[1],d=n[2],h=n[3],v=0;v<i.length;v+=4)p=c(i[v]),f=c(i[v+1]),g=c(i[v+2]),m=c(i[v+3]),r.decrypt(p,f,g,m,o,v),o[v]=c(o[v]^l),o[v+1]=c(o[v+1]^u),o[v+2]=c(o[v+2]^d),o[v+3]=c(o[v+3]^h),l=p,u=f,d=g,h=m;return a}(e,t,n);i.set(r,e.byteOffset)}},i(e,null,[{key:"STEP",get:function(){return 32e3}}]),e}(),new function(e){e.onmessage=function(t){var n=t.data,i=new Uint8Array(n.encrypted.bytes,n.encrypted.byteOffset,n.encrypted.byteLength),r=new Uint32Array(n.key.bytes,n.key.byteOffset,n.key.byteLength/4),a=new Uint32Array(n.iv.bytes,n.iv.byteOffset,n.iv.byteLength/4);new d(i,r,a,function(t,i){var r,a;e.postMessage((r={source:n.source,decrypted:i},a={},Object.keys(r).forEach(function(e){var t=r[e];ArrayBuffer.isView(t)?a[e]={bytes:t.buffer,byteOffset:t.byteOffset,byteLength:t.byteLength}:a[e]=t}),a),[i.buffer])})}}(this)}),Xd=function(e){var t=e.default?"main":"alternative";return e.characteristics&&e.characteristics.indexOf("public.accessibility.describes-video")>=0&&(t="main-desc"),t},Yd=function(e,t){e.abort(),e.pause(),t&&t.activePlaylistLoader&&(t.activePlaylistLoader.pause(),t.activePlaylistLoader=null)},Qd=function(e,t){t.activePlaylistLoader=e,e.load()},Jd={AUDIO:function(e,t){return function(){var n=t.segmentLoaders[e],i=t.mediaTypes[e],r=t.blacklistCurrentPlaylist;Yd(n,i);var a=i.activeTrack(),o=i.activeGroup(),s=(o.filter(function(e){return e.default})[0]||o[0]).id,l=i.tracks[s];if(a!==l){for(var u in to.log.warn("Problem encountered loading the alternate audio track.Switching back to default."),i.tracks)i.tracks[u].enabled=i.tracks[u]===l;i.onTrackChanged()}else r({message:"Problem encountered loading the default audio track."})}},SUBTITLES:function(e,t){return function(){var n=t.segmentLoaders[e],i=t.mediaTypes[e];to.log.warn("Problem encountered loading the subtitle track.Disabling subtitle track."),Yd(n,i);var r=i.activeTrack();r&&(r.mode="disabled"),i.onTrackChanged()}}},Zd={AUDIO:function(e,t,n){if(t){var i=n.tech,r=n.requestOptions,a=n.segmentLoaders[e];t.on("loadedmetadata",function(){var e=t.media();a.playlist(e,r),(!i.paused()||e.endList&&"none"!==i.preload())&&a.load()}),t.on("loadedplaylist",function(){a.playlist(t.media(),r),i.paused()||a.load()}),t.on("error",Jd[e](e,n))}},SUBTITLES:function(e,t,n){var i=n.tech,r=n.requestOptions,a=n.segmentLoaders[e],o=n.mediaTypes[e];t.on("loadedmetadata",function(){var e=t.media();a.playlist(e,r),a.track(o.activeTrack()),(!i.paused()||e.endList&&"none"!==i.preload())&&a.load()}),t.on("loadedplaylist",function(){a.playlist(t.media(),r),i.paused()||a.load()}),t.on("error",Jd[e](e,n))}},eh={AUDIO:function(e,t){var n=t.hls,i=t.sourceType,r=t.segmentLoaders[e],a=t.requestOptions,o=t.master.mediaGroups,s=t.mediaTypes[e],l=s.groups,u=s.tracks,c=t.masterPlaylistLoader;for(var d in o[e]&&0!==Object.keys(o[e]).length||(o[e]={main:{default:{default:!0}}}),o[e])for(var h in l[d]||(l[d]=[]),o[e][d]){var p,f=o[e][d][h];if(p=f.resolvedUri?new cc(f.resolvedUri,n,a):f.playlists&&"dash"===i?new kd(f.playlists[0],n,a,c):null,f=to.mergeOptions({id:h,playlistLoader:p},f),Zd[e](e,f.playlistLoader,t),l[d].push(f),void 0===u[h]){var g=new to.AudioTrack({id:h,kind:Xd(f),enabled:!1,language:f.language,default:f.default,label:h});u[h]=g}}r.on("error",Jd[e](e,t))},SUBTITLES:function(e,t){var n=t.tech,i=t.hls,r=t.sourceType,a=t.segmentLoaders[e],o=t.requestOptions,s=t.master.mediaGroups,l=t.mediaTypes[e],u=l.groups,c=l.tracks,d=t.masterPlaylistLoader;for(var h in s[e])for(var p in u[h]||(u[h]=[]),s[e][h])if(!s[e][h][p].forced){var f=s[e][h][p],g=void 0;if("hls"===r?g=new cc(f.resolvedUri,i,o):"dash"===r&&(g=new kd(f.playlists[0],i,o,d)),f=to.mergeOptions({id:p,playlistLoader:g},f),Zd[e](e,f.playlistLoader,t),u[h].push(f),void 0===c[p]){var m=n.addRemoteTextTrack({id:p,kind:"subtitles",default:f.default&&f.autoselect,language:f.language,label:p},!1).track;c[p]=m}}a.on("error",Jd[e](e,t))},"CLOSED-CAPTIONS":function(e,t){var n=t.tech,i=t.master.mediaGroups,r=t.mediaTypes[e],a=r.groups,o=r.tracks;for(var s in i[e])for(var l in a[s]||(a[s]=[]),i[e][s]){var u=i[e][s][l];if(u.instreamId.match(/CC\d/)&&(a[s].push(to.mergeOptions({id:l},u)),void 0===o[l])){var c=n.addRemoteTextTrack({id:u.instreamId,kind:"captions",default:u.default&&u.autoselect,language:u.language,label:l},!1).track;o[l]=c}}}},th={AUDIO:function(e,t){return function(){var n=t.mediaTypes[e].tracks;for(var i in n)if(n[i].enabled)return n[i];return null}},SUBTITLES:function(e,t){return function(){var n=t.mediaTypes[e].tracks;for(var i in n)if("showing"===n[i].mode)return n[i];return null}}},nh=function(){var e={};return["AUDIO","SUBTITLES","CLOSED-CAPTIONS"].forEach(function(t){e[t]={groups:{},tracks:{},activePlaylistLoader:null,activeGroup:Id,activeTrack:Id,onGroupChanged:Id,onTrackChanged:Id}}),e},ih=void 0,rh=["mediaRequests","mediaRequestsAborted","mediaRequestsTimedout","mediaRequestsErrored","mediaTransferDuration","mediaBytesTransferred"],ah=function(e){return this.audioSegmentLoader_[e]+this.mainSegmentLoader_[e]},oh=function(t){function n(e){Qu(this,n);var t=ec(this,(n.__proto__||Object.getPrototypeOf(n)).call(this)),i=e.url,r=e.handleManifestRedirects,a=e.withCredentials,o=e.tech,s=e.bandwidth,l=e.externHls,u=e.useCueTags,c=e.blacklistDuration,d=e.enableLowInitialPlaylist,h=e.sourceType,p=e.seekTo,f=e.cacheEncryptionKeys;if(!i)throw new Error("A non-empty playlist URL is required");ih=l,t.withCredentials=a,t.tech_=o,t.hls_=o.hls,t.seekTo_=p,t.sourceType_=h,t.useCueTags_=u,t.blacklistDuration=c,t.enableLowInitialPlaylist=d,t.useCueTags_&&(t.cueTagsTrack_=t.tech_.addTextTrack("metadata","ad-cues"),t.cueTagsTrack_.inBandMetadataTrackDispatchType=""),t.requestOptions_={withCredentials:a,handleManifestRedirects:r,timeout:null},t.mediaTypes_=nh(),t.mediaSource=new to.MediaSource,t.mediaSource.addEventListener("sourceopen",t.handleSourceOpen_.bind(t)),t.seekable_=to.createTimeRanges(),t.hasPlayed_=function(){return!1},t.syncController_=new Wd(e),t.segmentMetadataTrack_=o.addRemoteTextTrack({kind:"metadata",label:"segment-metadata"},!1).track,t.decrypter_=new Gd,t.inbandTextTracks_={};var g={hls:t.hls_,mediaSource:t.mediaSource,currentTime:t.tech_.currentTime.bind(t.tech_),seekable:function(){return t.seekable()},seeking:function(){return t.tech_.seeking()},duration:function(){return t.mediaSource.duration},hasPlayed:function(){return t.hasPlayed_()},goalBufferLength:function(){return t.goalBufferLength()},bandwidth:s,syncController:t.syncController_,decrypter:t.decrypter_,sourceType:t.sourceType_,inbandTextTracks:t.inbandTextTracks_,cacheEncryptionKeys:f};return t.masterPlaylistLoader_="dash"===t.sourceType_?new kd(i,t.hls_,t.requestOptions_):new cc(i,t.hls_,t.requestOptions_),t.setupMasterPlaylistLoaderListeners_(),t.mainSegmentLoader_=new Bd(to.mergeOptions(g,{segmentMetadataTrack:t.segmentMetadataTrack_,loaderType:"main"}),e),t.audioSegmentLoader_=new Bd(to.mergeOptions(g,{loaderType:"audio"}),e),t.subtitleSegmentLoader_=new Vd(to.mergeOptions(g,{loaderType:"vtt"}),e),t.setupSegmentLoaderListeners_(),rh.forEach(function(e){t[e+"_"]=ah.bind(t,e)}),t.logger_=Sd("MPC"),t.masterPlaylistLoader_.load(),t}return Zu(n,t),Ju(n,[{key:"setupMasterPlaylistLoaderListeners_",value:function(){var e=this;this.masterPlaylistLoader_.on("loadedmetadata",function(){var t=e.masterPlaylistLoader_.media(),n=1.5*t.targetDuration*1e3;kc(e.masterPlaylistLoader_.master,e.masterPlaylistLoader_.media())?e.requestOptions_.timeout=0:e.requestOptions_.timeout=n,t.endList&&"none"!==e.tech_.preload()&&(e.mainSegmentLoader_.playlist(t,e.requestOptions_),e.mainSegmentLoader_.load()),function(e){["AUDIO","SUBTITLES","CLOSED-CAPTIONS"].forEach(function(t){eh[t](t,e)});var t=e.mediaTypes,n=e.masterPlaylistLoader,i=e.tech,r=e.hls;["AUDIO","SUBTITLES"].forEach(function(n){t[n].activeGroup=function(e,t){return function(n){var i=t.masterPlaylistLoader,r=t.mediaTypes[e].groups,a=i.media();if(!a)return null;var o=null;return a.attributes[e]&&(o=r[a.attributes[e]]),o=o||r.main,void 0===n?o:null===n?null:o.filter(function(e){return e.id===n.id})[0]||null}}(n,e),t[n].activeTrack=th[n](n,e),t[n].onGroupChanged=function(e,t){return function(){var n=t.segmentLoaders,i=n[e],r=n.main,a=t.mediaTypes[e],o=a.activeTrack(),s=a.activeGroup(o),l=a.activePlaylistLoader;Yd(i,a),s&&(s.playlistLoader?(i.resyncLoader(),Qd(s.playlistLoader,a)):l&&r.resetEverything())}}(n,e),t[n].onTrackChanged=function(e,t){return function(){var n=t.segmentLoaders,i=n[e],r=n.main,a=t.mediaTypes[e],o=a.activeTrack(),s=a.activeGroup(o),l=a.activePlaylistLoader;Yd(i,a),s&&(s.playlistLoader?l!==s.playlistLoader?(i.track&&i.track(o),i.resetEverything(),Qd(s.playlistLoader,a)):Qd(s.playlistLoader,a):r.resetEverything())}}(n,e)});var a=t.AUDIO.activeGroup(),o=(a.filter(function(e){return e.default})[0]||a[0]).id;t.AUDIO.tracks[o].enabled=!0,t.AUDIO.onTrackChanged(),n.on("mediachange",function(){["AUDIO","SUBTITLES"].forEach(function(e){return t[e].onGroupChanged()})});var s=function(){t.AUDIO.onTrackChanged(),i.trigger({type:"usage",name:"hls-audio-change"})};for(var l in i.audioTracks().addEventListener("change",s),i.remoteTextTracks().addEventListener("change",t.SUBTITLES.onTrackChanged),r.on("dispose",function(){i.audioTracks().removeEventListener("change",s),i.remoteTextTracks().removeEventListener("change",t.SUBTITLES.onTrackChanged)}),i.clearTracks("audio"),t.AUDIO.tracks)i.audioTracks().addTrack(t.AUDIO.tracks[l])}({sourceType:e.sourceType_,segmentLoaders:{AUDIO:e.audioSegmentLoader_,SUBTITLES:e.subtitleSegmentLoader_,main:e.mainSegmentLoader_},tech:e.tech_,requestOptions:e.requestOptions_,masterPlaylistLoader:e.masterPlaylistLoader_,hls:e.hls_,master:e.master(),mediaTypes:e.mediaTypes_,blacklistCurrentPlaylist:e.blacklistCurrentPlaylist.bind(e)}),e.triggerPresenceUsage_(e.master(),t);try{e.setupSourceBuffers_()}catch(t){return to.log.warn("Failed to create SourceBuffers",t),e.mediaSource.endOfStream("decode")}e.setupFirstPlay(),!e.mediaTypes_.AUDIO.activePlaylistLoader||e.mediaTypes_.AUDIO.activePlaylistLoader.media()?e.trigger("selectedinitialmedia"):e.mediaTypes_.AUDIO.activePlaylistLoader.one("loadedmetadata",function(){e.trigger("selectedinitialmedia")})}),this.masterPlaylistLoader_.on("loadedplaylist",function(){var t=e.masterPlaylistLoader_.media();if(!t){e.excludeUnsupportedVariants_();var n=void 0;return e.enableLowInitialPlaylist&&(n=e.selectInitialPlaylist()),n||(n=e.selectPlaylist()),e.initialMedia_=n,void e.masterPlaylistLoader_.media(e.initialMedia_)}if(e.useCueTags_&&e.updateAdCues_(t),e.mainSegmentLoader_.playlist(t,e.requestOptions_),e.updateDuration(),e.tech_.paused()||(e.mainSegmentLoader_.load(),e.audioSegmentLoader_&&e.audioSegmentLoader_.load()),!t.endList){var i=function(){var t=e.seekable();0!==t.length&&e.mediaSource.addSeekableRange_(t.start(0),t.end(0))};e.duration()!==1/0?e.tech_.one("durationchange",function t(){e.duration()===1/0?i():e.tech_.one("durationchange",t)}):i()}}),this.masterPlaylistLoader_.on("error",function(){e.blacklistCurrentPlaylist(e.masterPlaylistLoader_.error)}),this.masterPlaylistLoader_.on("mediachanging",function(){e.mainSegmentLoader_.abort(),e.mainSegmentLoader_.pause()}),this.masterPlaylistLoader_.on("mediachange",function(){var t=e.masterPlaylistLoader_.media(),n=1.5*t.targetDuration*1e3;kc(e.masterPlaylistLoader_.master,e.masterPlaylistLoader_.media())?e.requestOptions_.timeout=0:e.requestOptions_.timeout=n,e.mainSegmentLoader_.playlist(t,e.requestOptions_),e.mainSegmentLoader_.load(),e.tech_.trigger({type:"mediachange",bubbles:!0})}),this.masterPlaylistLoader_.on("playlistunchanged",function(){var t=e.masterPlaylistLoader_.media();e.stuckAtPlaylistEnd_(t)&&(e.blacklistCurrentPlaylist({message:"Playlist no longer updating."}),e.tech_.trigger("playliststuck"))}),this.masterPlaylistLoader_.on("renditiondisabled",function(){e.tech_.trigger({type:"usage",name:"hls-rendition-disabled"})}),this.masterPlaylistLoader_.on("renditionenabled",function(){e.tech_.trigger({type:"usage",name:"hls-rendition-enabled"})})}},{key:"triggerPresenceUsage_",value:function(e,t){var n=e.mediaGroups||{},i=!0,r=Object.keys(n.AUDIO);for(var a in n.AUDIO)for(var o in n.AUDIO[a]){n.AUDIO[a][o].uri||(i=!1)}i&&this.tech_.trigger({type:"usage",name:"hls-demuxed"}),Object.keys(n.SUBTITLES).length&&this.tech_.trigger({type:"usage",name:"hls-webvtt"}),ih.Playlist.isAes(t)&&this.tech_.trigger({type:"usage",name:"hls-aes"}),ih.Playlist.isFmp4(t)&&this.tech_.trigger({type:"usage",name:"hls-fmp4"}),r.length&&Object.keys(n.AUDIO[r[0]]).length>1&&this.tech_.trigger({type:"usage",name:"hls-alternate-audio"}),this.useCueTags_&&this.tech_.trigger({type:"usage",name:"hls-playlist-cue-tags"})}},{key:"setupSegmentLoaderListeners_",value:function(){var e=this;this.mainSegmentLoader_.on("bandwidthupdate",function(){var t=e.selectPlaylist(),n=e.masterPlaylistLoader_.media(),i=e.tech_.buffered(),r=i.length?i.end(i.length-1)-e.tech_.currentTime():0,a=e.bufferLowWaterLine();(!n.endList||e.duration()<Dd.MAX_BUFFER_LOW_WATER_LINE||t.attributes.BANDWIDTH<n.attributes.BANDWIDTH||r>=a)&&e.masterPlaylistLoader_.media(t),e.tech_.trigger("bandwidthupdate")}),this.mainSegmentLoader_.on("progress",function(){e.trigger("progress")}),this.mainSegmentLoader_.on("error",function(){e.blacklistCurrentPlaylist(e.mainSegmentLoader_.error())}),this.mainSegmentLoader_.on("syncinfoupdate",function(){e.onSyncInfoUpdate_()}),this.mainSegmentLoader_.on("timestampoffset",function(){e.tech_.trigger({type:"usage",name:"hls-timestamp-offset"})}),this.audioSegmentLoader_.on("syncinfoupdate",function(){e.onSyncInfoUpdate_()}),this.mainSegmentLoader_.on("ended",function(){e.onEndOfStream()}),this.mainSegmentLoader_.on("earlyabort",function(){e.blacklistCurrentPlaylist({message:"Aborted early because there isn't enough bandwidth to complete the request without rebuffering."},120)}),this.mainSegmentLoader_.on("reseteverything",function(){e.tech_.trigger("hls-reset")}),this.mainSegmentLoader_.on("segmenttimemapping",function(t){e.tech_.trigger({type:"hls-segment-time-mapping",mapping:t.mapping})}),this.audioSegmentLoader_.on("ended",function(){e.onEndOfStream()})}},{key:"mediaSecondsLoaded_",value:function(){return Math.max(this.audioSegmentLoader_.mediaSecondsLoaded+this.mainSegmentLoader_.mediaSecondsLoaded)}},{key:"load",value:function(){this.mainSegmentLoader_.load(),this.mediaTypes_.AUDIO.activePlaylistLoader&&this.audioSegmentLoader_.load(),this.mediaTypes_.SUBTITLES.activePlaylistLoader&&this.subtitleSegmentLoader_.load()}},{key:"smoothQualityChange_",value:function(){var e=this.selectPlaylist();e!==this.masterPlaylistLoader_.media()&&(this.masterPlaylistLoader_.media(e),this.mainSegmentLoader_.resetLoader())}},{key:"fastQualityChange_",value:function(){var e=this,t=this.selectPlaylist();t!==this.masterPlaylistLoader_.media()&&(this.masterPlaylistLoader_.media(t),this.mainSegmentLoader_.resetEverything(function(){to.browser.IE_VERSION||to.browser.IS_EDGE?e.tech_.setCurrentTime(e.tech_.currentTime()+.04):e.tech_.setCurrentTime(e.tech_.currentTime())}))}},{key:"play",value:function(){if(!this.setupFirstPlay()){this.tech_.ended()&&this.seekTo_(0),this.hasPlayed_()&&this.load();var e=this.tech_.seekable();return this.tech_.duration()===1/0&&this.tech_.currentTime()<e.start(0)?this.seekTo_(e.end(e.length-1)):void 0}}},{key:"setupFirstPlay",value:function(){var e=this,t=this.masterPlaylistLoader_.media();if(!t||this.tech_.paused()||this.hasPlayed_())return!1;if(!t.endList){var n=this.seekable();if(!n.length)return!1;if(to.browser.IE_VERSION&&0===this.tech_.readyState())return this.tech_.one("loadedmetadata",function(){e.trigger("firstplay"),e.seekTo_(n.end(0)),e.hasPlayed_=function(){return!0}}),!1;this.trigger("firstplay"),this.seekTo_(n.end(0))}return this.hasPlayed_=function(){return!0},this.load(),!0}},{key:"handleSourceOpen_",value:function(){try{this.setupSourceBuffers_()}catch(e){return to.log.warn("Failed to create Source Buffers",e),this.mediaSource.endOfStream("decode")}if(this.tech_.autoplay()){var e=this.tech_.play();void 0!==e&&"function"==typeof e.then&&e.then(null,function(e){})}this.trigger("sourceopen")}},{key:"onEndOfStream",value:function(){var e=this.mainSegmentLoader_.ended_;if(this.mediaTypes_.AUDIO.activePlaylistLoader&&(e=!this.mainSegmentLoader_.startingMedia_||this.mainSegmentLoader_.startingMedia_.containsVideo?e&&this.audioSegmentLoader_.ended_:this.audioSegmentLoader_.ended_),e){this.logger_("calling mediaSource.endOfStream()");try{this.mediaSource.endOfStream()}catch(e){to.log.warn("Failed to call media source endOfStream",e)}}}},{key:"stuckAtPlaylistEnd_",value:function(e){if(!this.seekable().length)return!1;var t=this.syncController_.getExpiredTime(e,this.mediaSource.duration);if(null===t)return!1;var n=ih.Playlist.playlistEnd(e,t),i=this.tech_.currentTime(),r=this.tech_.buffered();if(!r.length)return n-i<=.1;var a=r.end(r.length-1);return a-i<=.1&&n-a<=.1}},{key:"blacklistCurrentPlaylist",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments[1],n=void 0,i=void 0;if(n=e.playlist||this.masterPlaylistLoader_.media(),t=t||e.blacklistDuration||this.blacklistDuration,!n){this.error=e;try{return this.mediaSource.endOfStream("network")}catch(e){return this.trigger("error")}}var r=1===this.masterPlaylistLoader_.master.playlists.filter(Cc).length,a=this.masterPlaylistLoader_.master.playlists;return 1===a.length?(to.log.warn("Problem encountered with the current HLS playlist. Trying again since it is the only playlist."),this.tech_.trigger("retryplaylist"),this.masterPlaylistLoader_.load(r)):(r&&(to.log.warn("Removing all playlists from the blacklist because the last rendition is about to be blacklisted."),a.forEach(function(e){e.excludeUntil!==1/0&&delete e.excludeUntil}),this.tech_.trigger("retryplaylist")),n.excludeUntil=Date.now()+1e3*t,this.tech_.trigger("blacklistplaylist"),this.tech_.trigger({type:"usage",name:"hls-rendition-blacklisted"}),i=this.selectPlaylist(),to.log.warn("Problem encountered with the current HLS playlist."+(e.message?" "+e.message:"")+" Switching to another playlist."),this.masterPlaylistLoader_.media(i,r))}},{key:"pauseLoading",value:function(){this.mainSegmentLoader_.pause(),this.mediaTypes_.AUDIO.activePlaylistLoader&&this.audioSegmentLoader_.pause(),this.mediaTypes_.SUBTITLES.activePlaylistLoader&&this.subtitleSegmentLoader_.pause()}},{key:"setCurrentTime",value:function(e){var t=Bc(this.tech_.buffered(),e);return this.masterPlaylistLoader_&&this.masterPlaylistLoader_.media()&&this.masterPlaylistLoader_.media().segments?t&&t.length?e:(this.mainSegmentLoader_.resetEverything(),this.mainSegmentLoader_.abort(),this.mediaTypes_.AUDIO.activePlaylistLoader&&(this.audioSegmentLoader_.resetEverything(),this.audioSegmentLoader_.abort()),this.mediaTypes_.SUBTITLES.activePlaylistLoader&&(this.subtitleSegmentLoader_.resetEverything(),this.subtitleSegmentLoader_.abort()),void this.load()):0}},{key:"duration",value:function(){return this.masterPlaylistLoader_?this.mediaSource?this.mediaSource.duration:ih.Playlist.duration(this.masterPlaylistLoader_.media()):0}},{key:"seekable",value:function(){return this.seekable_}},{key:"onSyncInfoUpdate_",value:function(){var e=void 0,t=void 0;if(this.masterPlaylistLoader_){var n=this.masterPlaylistLoader_.media();if(n){var i=this.syncController_.getExpiredTime(n,this.mediaSource.duration);if(null!==i&&0!==(e=ih.Playlist.seekable(n,i)).length){if(this.mediaTypes_.AUDIO.activePlaylistLoader){if(n=this.mediaTypes_.AUDIO.activePlaylistLoader.media(),null===(i=this.syncController_.getExpiredTime(n,this.mediaSource.duration)))return;if(0===(t=ih.Playlist.seekable(n,i)).length)return}var r=void 0,a=void 0;this.seekable_&&this.seekable_.length&&(r=this.seekable_.end(0),a=this.seekable_.start(0)),t?t.start(0)>e.end(0)||e.start(0)>t.end(0)?this.seekable_=e:this.seekable_=to.createTimeRanges([[t.start(0)>e.start(0)?t.start(0):e.start(0),t.end(0)<e.end(0)?t.end(0):e.end(0)]]):this.seekable_=e,this.seekable_&&this.seekable_.length&&this.seekable_.end(0)===r&&this.seekable_.start(0)===a||(this.logger_("seekable updated ["+Uc(this.seekable_)+"]"),this.tech_.trigger("seekablechanged"))}}}}},{key:"updateDuration",value:function(){var e=this,t=this.mediaSource.duration,n=ih.Playlist.duration(this.masterPlaylistLoader_.media()),i=this.tech_.buffered(),r=function t(){e.logger_("Setting duration from "+e.mediaSource.duration+" => "+n);try{e.mediaSource.duration=n}catch(e){to.log.warn("Failed to set media source duration",e)}e.tech_.trigger("durationchange"),e.mediaSource.removeEventListener("sourceopen",t)};i.length>0&&(n=Math.max(n,i.end(i.length-1))),t!==n&&("open"!==this.mediaSource.readyState?this.mediaSource.addEventListener("sourceopen",r):r())}},{key:"dispose",value:function(){var e=this;this.decrypter_.terminate(),this.masterPlaylistLoader_.dispose(),this.mainSegmentLoader_.dispose(),["AUDIO","SUBTITLES"].forEach(function(t){var n=e.mediaTypes_[t].groups;for(var i in n)n[i].forEach(function(e){e.playlistLoader&&e.playlistLoader.dispose()})}),this.audioSegmentLoader_.dispose(),this.subtitleSegmentLoader_.dispose()}},{key:"master",value:function(){return this.masterPlaylistLoader_.master}},{key:"media",value:function(){return this.masterPlaylistLoader_.media()||this.initialMedia_}},{key:"setupSourceBuffers_",value:function(){var e=this.masterPlaylistLoader_.media(),t=void 0;if(e&&"open"===this.mediaSource.readyState){if((t=function(e,t){var n=function(e){return e.segments&&e.segments.length&&e.segments[0].map?"mp4":"mp2t"}(t),i=function(e){var t=e.attributes||{};return t.CODECS?sd(t.CODECS):ad}(t),r=t.attributes||{},a=!0,o=!1;if(!t)return[];if(e.mediaGroups.AUDIO&&r.AUDIO){var s=e.mediaGroups.AUDIO[r.AUDIO];if(s)for(var l in o=!0,a=!1,s)if(!s[l].uri&&!s[l].playlists){a=!0;break}}o&&!i.audioProfile&&(a||(i.audioProfile=function(e,t){if(!e.mediaGroups.AUDIO||!t)return null;var n=e.mediaGroups.AUDIO[t];if(!n)return null;for(var i in n){var r=n[i];if(r.default&&r.playlists)return sd(r.playlists[0].attributes.CODECS).audioProfile}return null}(e,r.AUDIO)),i.audioProfile||(to.log.warn("Multiple audio tracks present but no audio codec string is specified. Attempting to use the default audio codec (mp4a.40.2)"),i.audioProfile=ad.audioProfile));var u={};i.videoCodec&&(u.video=""+i.videoCodec+i.videoObjectTypeIndicator),i.audioProfile&&(u.audio="mp4a.40."+i.audioProfile);var c=ld("audio",n,[u.audio]),d=ld("video",n,[u.video]),h=ld("video",n,[u.video,u.audio]);return o?!a&&u.video?[d,c]:a||u.video?[h,c]:[c,c]:u.video?[h]:[c]}(this.masterPlaylistLoader_.master,e)).length<1)return this.error="No compatible SourceBuffer configuration for the variant stream:"+e.resolvedUri,this.mediaSource.endOfStream("decode");this.configureLoaderMimeTypes_(t),this.excludeIncompatibleVariants_(e)}}},{key:"configureLoaderMimeTypes_",value:function(e){var t=e.length>1&&-1===e[0].indexOf(",")&&e[0]!==e[1]?new to.EventTarget:null;this.mainSegmentLoader_.mimeType(e[0],t),e[1]&&this.audioSegmentLoader_.mimeType(e[1],t)}},{key:"excludeUnsupportedVariants_",value:function(){this.master().playlists.forEach(function(t){var n;t.attributes.CODECS&&e.MediaSource&&e.MediaSource.isTypeSupported&&!e.MediaSource.isTypeSupported('video/mp4; codecs="'+(n=t.attributes.CODECS,n.replace(/avc1\.(\d+)\.(\d+)/i,function(e){return od([e])[0]}))+'"')&&(t.excludeUntil=1/0)})}},{key:"excludeIncompatibleVariants_",value:function(e){var t=2,n=null,i=void 0;e.attributes.CODECS&&(i=sd(e.attributes.CODECS),n=i.videoCodec,t=i.codecCount),this.master().playlists.forEach(function(e){var i={codecCount:2,videoCodec:null};e.attributes.CODECS&&(i=sd(e.attributes.CODECS)),i.codecCount!==t&&(e.excludeUntil=1/0),i.videoCodec!==n&&(e.excludeUntil=1/0)})}},{key:"updateAdCues_",value:function(t){var n=0,i=this.seekable();i.length&&(n=i.start(0)),function(t,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if(t.segments)for(var r=i,a=void 0,o=0;o<t.segments.length;o++){var s=t.segments[o];if(a||(a=qd(n,r+s.duration/2)),a){if("cueIn"in s){a.endTime=r,a.adEndTime=r,r+=s.duration,a=null;continue}if(r<a.endTime){r+=s.duration;continue}a.endTime+=s.duration}else if("cueOut"in s&&((a=new e.VTTCue(r,r+s.duration,s.cueOut)).adStartTime=r,a.adEndTime=r+parseFloat(s.cueOut),n.addCue(a)),"cueOutCont"in s){var l,u,c=s.cueOutCont.split("/").map(parseFloat),d=tc(c,2);l=d[0],u=d[1],(a=new e.VTTCue(r,r+s.duration,"")).adStartTime=r-l,a.adEndTime=a.adStartTime+u,n.addCue(a)}r+=s.duration}}(t,this.cueTagsTrack_,n)}},{key:"goalBufferLength",value:function(){var e=this.tech_.currentTime(),t=Dd.GOAL_BUFFER_LENGTH,n=Dd.GOAL_BUFFER_LENGTH_RATE,i=Math.max(t,Dd.MAX_GOAL_BUFFER_LENGTH);return Math.min(t+e*n,i)}},{key:"bufferLowWaterLine",value:function(){var e=this.tech_.currentTime(),t=Dd.BUFFER_LOW_WATER_LINE,n=Dd.BUFFER_LOW_WATER_LINE_RATE,i=Math.max(t,Dd.MAX_BUFFER_LOW_WATER_LINE);return Math.min(t+e*n,i)}}]),n}(to.EventTarget),sh=["seeking","seeked","pause","playing","error"],lh=function(){function t(n){var i=this;Qu(this,t),this.tech_=n.tech,this.seekable=n.seekable,this.seekTo=n.seekTo,this.allowSeeksWithinUnsafeLiveWindow=n.allowSeeksWithinUnsafeLiveWindow,this.media=n.media,this.consecutiveUpdates=0,this.lastRecordedTime=null,this.timer_=null,this.checkCurrentTimeTimeout_=null,this.logger_=Sd("PlaybackWatcher"),this.logger_("initialize");var r=function(){return i.monitorCurrentTime_()},a=function(){return i.techWaiting_()},o=function(){return i.cancelTimer_()},s=function(){return i.fixesBadSeeks_()};this.tech_.on("seekablechanged",s),this.tech_.on("waiting",a),this.tech_.on(sh,o),this.tech_.on("canplay",r),this.dispose=function(){i.logger_("dispose"),i.tech_.off("seekablechanged",s),i.tech_.off("waiting",a),i.tech_.off(sh,o),i.tech_.off("canplay",r),i.checkCurrentTimeTimeout_&&e.clearTimeout(i.checkCurrentTimeTimeout_),i.cancelTimer_()}}return Ju(t,[{key:"monitorCurrentTime_",value:function(){this.checkCurrentTime_(),this.checkCurrentTimeTimeout_&&e.clearTimeout(this.checkCurrentTimeTimeout_),this.checkCurrentTimeTimeout_=e.setTimeout(this.monitorCurrentTime_.bind(this),250)}},{key:"checkCurrentTime_",value:function(){if(this.tech_.seeking()&&this.fixesBadSeeks_())return this.consecutiveUpdates=0,void(this.lastRecordedTime=this.tech_.currentTime());if(!this.tech_.paused()&&!this.tech_.seeking()){var e=this.tech_.currentTime(),t=this.tech_.buffered();if(this.lastRecordedTime===e&&(!t.length||e+.1>=t.end(t.length-1)))return this.techWaiting_();this.consecutiveUpdates>=5&&e===this.lastRecordedTime?(this.consecutiveUpdates++,this.waiting_()):e===this.lastRecordedTime?this.consecutiveUpdates++:(this.consecutiveUpdates=0,this.lastRecordedTime=e)}}},{key:"cancelTimer_",value:function(){this.consecutiveUpdates=0,this.timer_&&(this.logger_("cancelTimer_"),clearTimeout(this.timer_)),this.timer_=null}},{key:"fixesBadSeeks_",value:function(){if(!this.tech_.seeking())return!1;var e=this.seekable(),t=this.tech_.currentTime(),n=void 0;this.afterSeekableWindow_(e,t,this.media(),this.allowSeeksWithinUnsafeLiveWindow)&&(n=e.end(e.length-1));this.beforeSeekableWindow_(e,t)&&(n=e.start(0)+.1);return void 0!==n&&(this.logger_("Trying to seek outside of seekable at time "+t+" with seekable range "+Uc(e)+". Seeking to "+n+"."),this.seekTo(n),!0)}},{key:"waiting_",value:function(){if(!this.techWaiting_()){var e=this.tech_.currentTime(),t=this.tech_.buffered(),n=Bc(t,e);return n.length&&e+3<=n.end(0)?(this.cancelTimer_(),this.seekTo(e),this.logger_("Stopped at "+e+" while inside a buffered region ["+n.start(0)+" -> "+n.end(0)+"]. Attempting to resume playback by seeking to the current time."),void this.tech_.trigger({type:"usage",name:"hls-unknown-waiting"})):void 0}}},{key:"techWaiting_",value:function(){var e=this.seekable(),t=this.tech_.currentTime();if(this.tech_.seeking()&&this.fixesBadSeeks_())return!0;if(this.tech_.seeking()||null!==this.timer_)return!0;if(this.beforeSeekableWindow_(e,t)){var n=e.end(e.length-1);return this.logger_("Fell out of live window at time "+t+". Seeking to live point (seekable end) "+n),this.cancelTimer_(),this.seekTo(n),this.tech_.trigger({type:"usage",name:"hls-live-resync"}),!0}var i=this.tech_.buffered(),r=Fc(i,t);if(this.videoUnderflow_(r,i,t))return this.cancelTimer_(),this.seekTo(t),this.tech_.trigger({type:"usage",name:"hls-video-underflow"}),!0;if(r.length>0){var a=r.start(0)-t;return this.logger_("Stopped at "+t+", setting timer for "+a+", seeking to "+r.start(0)),this.timer_=setTimeout(this.skipTheGap_.bind(this),1e3*a,t),!0}return!1}},{key:"afterSeekableWindow_",value:function(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(!e.length)return!1;var r=e.end(e.length-1)+.1;return!n.endList&&i&&(r=e.end(e.length-1)+3*n.targetDuration),t>r}},{key:"beforeSeekableWindow_",value:function(e,t){return!!(e.length&&e.start(0)>0&&t<e.start(0)-.1)}},{key:"videoUnderflow_",value:function(e,t,n){if(0===e.length){var i=this.gapFromVideoUnderflow_(t,n);if(i)return this.logger_("Encountered a gap in video from "+i.start+" to "+i.end+". Seeking to current time "+n),!0}return!1}},{key:"skipTheGap_",value:function(e){var t=this.tech_.buffered(),n=this.tech_.currentTime(),i=Fc(t,n);this.cancelTimer_(),0!==i.length&&n===e&&(this.logger_("skipTheGap_:","currentTime:",n,"scheduled currentTime:",e,"nextRange start:",i.start(0)),this.seekTo(i.start(0)+1/30),this.tech_.trigger({type:"usage",name:"hls-gap-skip"}))}},{key:"gapFromVideoUnderflow_",value:function(e,t){for(var n=function(e){if(e.length<2)return to.createTimeRanges();for(var t=[],n=1;n<e.length;n++){var i=e.end(n-1),r=e.start(n);t.push([i,r])}return to.createTimeRanges(t)}(e),i=0;i<n.length;i++){var r=n.start(i),a=n.end(i);if(t-r<4&&t-r>2)return{start:r,end:a}}return null}}]),t}(),uh={errorInterval:30,getSource:function(e){return e(this.tech({IWillNotUseThisInPlugins:!0}).currentSource_)}},ch=function(e){!function e(t,n){var i=0,r=0,a=to.mergeOptions(uh,n);t.ready(function(){t.trigger({type:"usage",name:"hls-error-reload-initialized"})});var o=function(){r&&t.currentTime(r)},s=function(e){null!==e&&void 0!==e&&(r=t.duration()!==1/0&&t.currentTime()||0,t.one("loadedmetadata",o),t.src(e),t.trigger({type:"usage",name:"hls-error-reload"}),t.play())},l=function(){if(Date.now()-i<1e3*a.errorInterval)t.trigger({type:"usage",name:"hls-error-reload-canceled"});else{if(a.getSource&&"function"==typeof a.getSource)return i=Date.now(),a.getSource.call(t,s);to.log.error("ERROR: reloadSourceOnError - The option getSource must be a function!")}},u=function e(){t.off("loadedmetadata",o),t.off("error",l),t.off("dispose",e)};t.on("error",l),t.on("dispose",u),t.reloadSourceOnError=function(n){u(),e(t,n)}}(this,e)};to.use("*",function(e){return{setSource:function(e,t){t(null,e)},setCurrentTime:function(t){return e.vhs&&e.currentSource().src===e.vhs.source_.src&&e.vhs.setCurrentTime(t),t},play:function(){e.vhs&&e.currentSource().src===e.vhs.source_.src&&e.vhs.setCurrentTime(e.tech_.currentTime())}}});var dh={PlaylistLoader:cc,Playlist:Sc,Decrypter:Gu,AsyncStream:Hu,decrypt:Wu,utils:$c,STANDARD_PLAYLIST_SELECTOR:function(){return function(t,n,i,r,a){var o=t.playlists.map(function(t){var n,i;return n=t.attributes.RESOLUTION&&t.attributes.RESOLUTION.width,i=t.attributes.RESOLUTION&&t.attributes.RESOLUTION.height,{bandwidth:t.attributes.BANDWIDTH||e.Number.MAX_VALUE,width:n,height:i,playlist:t}});Kd(o,function(e,t){return e.bandwidth-t.bandwidth});var s=(o=o.filter(function(e){return!Sc.isIncompatible(e.playlist)})).filter(function(e){return Sc.isEnabled(e.playlist)});s.length||(s=o.filter(function(e){return!Sc.isDisabled(e.playlist)}));var l=s.filter(function(e){return e.bandwidth*Dd.BANDWIDTH_VARIANCE<n}),u=l[l.length-1],c=l.filter(function(e){return e.bandwidth===u.bandwidth})[0];if(!1===a){var d=c||s[0]||o[0];return d?d.playlist:null}var h=l.filter(function(e){return e.width&&e.height});Kd(h,function(e,t){return e.width-t.width});var p=h.filter(function(e){return e.width===i&&e.height===r});u=p[p.length-1];var f=p.filter(function(e){return e.bandwidth===u.bandwidth})[0],g=void 0,m=void 0,v=void 0;f||(m=(g=h.filter(function(e){return e.width>i||e.height>r})).filter(function(e){return e.width===g[0].width&&e.height===g[0].height}),u=m[m.length-1],v=m.filter(function(e){return e.bandwidth===u.bandwidth})[0]);var y=v||f||c||s[0]||o[0];return y?y.playlist:null}(this.playlists.master,this.systemBandwidth,parseInt(Md(this.tech_.el(),"width"),10),parseInt(Md(this.tech_.el(),"height"),10),this.limitRenditionByPlayerDimensions)},INITIAL_PLAYLIST_SELECTOR:function(){var e=this.playlists.master.playlists.filter(Sc.isEnabled);return Kd(e,function(e,t){return $d(e,t)}),e.filter(function(e){return sd(e.attributes.CODECS).videoCodec})[0]||null},comparePlaylistBandwidth:$d,comparePlaylistResolution:function(t,n){var i=void 0,r=void 0;return t.attributes.RESOLUTION&&t.attributes.RESOLUTION.width&&(i=t.attributes.RESOLUTION.width),i=i||e.Number.MAX_VALUE,n.attributes.RESOLUTION&&n.attributes.RESOLUTION.width&&(r=n.attributes.RESOLUTION.width),i===(r=r||e.Number.MAX_VALUE)&&t.attributes.BANDWIDTH&&n.attributes.BANDWIDTH?t.attributes.BANDWIDTH-n.attributes.BANDWIDTH:i-r},xhr:Dc()};["GOAL_BUFFER_LENGTH","MAX_GOAL_BUFFER_LENGTH","GOAL_BUFFER_LENGTH_RATE","BUFFER_LOW_WATER_LINE","MAX_BUFFER_LOW_WATER_LINE","BUFFER_LOW_WATER_LINE_RATE","BANDWIDTH_VARIANCE"].forEach(function(e){Object.defineProperty(dh,e,{get:function(){return to.log.warn("using Hls."+e+" is UNSAFE be sure you know what you are doing"),Dd[e]},set:function(t){to.log.warn("using Hls."+e+" is UNSAFE be sure you know what you are doing"),"number"!=typeof t||t<0?to.log.warn("value of Hls."+e+" must be greater than or equal to 0"):Dd[e]=t}})});var hh=function(e){return/^(audio|video|application)\/(x-|vnd\.apple\.)?mpegurl/i.test(e)?"hls":/^application\/dash\+xml/i.test(e)?"dash":null},ph=function(e,t){for(var n=t.media(),i=-1,r=0;r<e.length;r++)if(e[r].id===n.uri){i=r;break}e.selectedIndex_=i,e.trigger({selectedIndex:i,type:"change"})};dh.canPlaySource=function(){return to.log.warn("HLS is no longer a tech. Please remove it from your player's techOrder.")};var fh,gh=function(){if(!window.localStorage)return null;var e=window.localStorage.getItem("videojs-vhs");if(!e)return null;try{return JSON.parse(e)}catch(e){return null}};dh.supportsNativeHls=(fh=t.createElement("video"),!!to.getTech("Html5").isSupported()&&["application/vnd.apple.mpegurl","audio/mpegurl","audio/x-mpegurl","application/x-mpegurl","video/x-mpegurl","video/mpegurl","application/mpegurl"].some(function(e){return/maybe|probably/i.test(fh.canPlayType(e))})),dh.supportsNativeDash=!!to.getTech("Html5").isSupported()&&/maybe|probably/i.test(t.createElement("video").canPlayType("application/dash+xml")),dh.supportsTypeNatively=function(e){return"hls"===e?dh.supportsNativeHls:"dash"===e&&dh.supportsNativeDash},dh.isSupported=function(){return to.log.warn("HLS is no longer a tech. Please remove it from your player's techOrder.")};var mh=function(e){function n(e,i,r){Qu(this,n);var a=ec(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,i,r.hls));if(i.options_&&i.options_.playerId){var o=to(i.options_.playerId);o.hasOwnProperty("hls")||Object.defineProperty(o,"hls",{get:function(){return to.log.warn("player.hls is deprecated. Use player.tech().hls instead."),i.trigger({type:"usage",name:"hls-player-access"}),a},configurable:!0}),o.vhs=a,o.dash=a,a.player_=o}if(a.tech_=i,a.source_=e,a.stats={},a.setOptions_(),a.options_.overrideNative&&i.overrideNativeAudioTracks&&i.overrideNativeVideoTracks)i.overrideNativeAudioTracks(!0),i.overrideNativeVideoTracks(!0);else if(a.options_.overrideNative&&(i.featuresNativeVideoTracks||i.featuresNativeAudioTracks))throw new Error("Overriding native HLS requires emulated tracks. See https://git.io/vMpjB");return a.on(t,["fullscreenchange","webkitfullscreenchange","mozfullscreenchange","MSFullscreenChange"],function(e){var n=t.fullscreenElement||t.webkitFullscreenElement||t.mozFullScreenElement||t.msFullscreenElement;n&&n.contains(a.tech_.el())&&a.masterPlaylistController_.smoothQualityChange_()}),a.on(a.tech_,"seeking",function(){0===this.tech_.currentTime()&&this.tech_.player_.loop()&&this.setCurrentTime(0)}),a.on(a.tech_,"error",function(){this.masterPlaylistController_&&this.masterPlaylistController_.pauseLoading()}),a.on(a.tech_,"play",a.play),a}return Zu(n,e),Ju(n,[{key:"setOptions_",value:function(){var e=this;if(this.options_.withCredentials=this.options_.withCredentials||!1,this.options_.handleManifestRedirects=this.options_.handleManifestRedirects||!1,this.options_.limitRenditionByPlayerDimensions=!1!==this.options_.limitRenditionByPlayerDimensions,this.options_.smoothQualityChange=this.options_.smoothQualityChange||!1,this.options_.useBandwidthFromLocalStorage=void 0!==this.source_.useBandwidthFromLocalStorage?this.source_.useBandwidthFromLocalStorage:this.options_.useBandwidthFromLocalStorage||!1,this.options_.customTagParsers=this.options_.customTagParsers||[],this.options_.customTagMappers=this.options_.customTagMappers||[],this.options_.cacheEncryptionKeys=this.options_.cacheEncryptionKeys||!1,"number"!=typeof this.options_.blacklistDuration&&(this.options_.blacklistDuration=300),"number"!=typeof this.options_.bandwidth&&this.options_.useBandwidthFromLocalStorage){var t=gh();t&&t.bandwidth&&(this.options_.bandwidth=t.bandwidth,this.tech_.trigger({type:"usage",name:"hls-bandwidth-from-local-storage"})),t&&t.throughput&&(this.options_.throughput=t.throughput,this.tech_.trigger({type:"usage",name:"hls-throughput-from-local-storage"}))}"number"!=typeof this.options_.bandwidth&&(this.options_.bandwidth=Dd.INITIAL_BANDWIDTH),this.options_.enableLowInitialPlaylist=this.options_.enableLowInitialPlaylist&&this.options_.bandwidth===Dd.INITIAL_BANDWIDTH,["withCredentials","limitRenditionByPlayerDimensions","bandwidth","smoothQualityChange","customTagParsers","customTagMappers","handleManifestRedirects","cacheEncryptionKeys"].forEach(function(t){void 0!==e.source_[t]&&(e.options_[t]=e.source_[t])}),this.limitRenditionByPlayerDimensions=this.options_.limitRenditionByPlayerDimensions}},{key:"src",value:function(e,t){var n=this;e&&(this.setOptions_(),this.options_.url=this.source_.src,this.options_.tech=this.tech_,this.options_.externHls=dh,this.options_.sourceType=hh(t),this.options_.seekTo=function(e){n.tech_.setCurrentTime(e),n.setCurrentTime(e)},this.masterPlaylistController_=new oh(this.options_),this.playbackWatcher_=new lh(to.mergeOptions(this.options_,{seekable:function(){return n.seekable()},media:function(){return n.masterPlaylistController_.media()}})),this.masterPlaylistController_.on("error",function(){to.players[n.tech_.options_.playerId].error(n.masterPlaylistController_.error)}),this.masterPlaylistController_.selectPlaylist=this.selectPlaylist?this.selectPlaylist.bind(this):dh.STANDARD_PLAYLIST_SELECTOR.bind(this),this.masterPlaylistController_.selectInitialPlaylist=dh.INITIAL_PLAYLIST_SELECTOR.bind(this),this.playlists=this.masterPlaylistController_.masterPlaylistLoader_,this.mediaSource=this.masterPlaylistController_.mediaSource,Object.defineProperties(this,{selectPlaylist:{get:function(){return this.masterPlaylistController_.selectPlaylist},set:function(e){this.masterPlaylistController_.selectPlaylist=e.bind(this)}},throughput:{get:function(){return this.masterPlaylistController_.mainSegmentLoader_.throughput.rate},set:function(e){this.masterPlaylistController_.mainSegmentLoader_.throughput.rate=e,this.masterPlaylistController_.mainSegmentLoader_.throughput.count=1}},bandwidth:{get:function(){return this.masterPlaylistController_.mainSegmentLoader_.bandwidth},set:function(e){this.masterPlaylistController_.mainSegmentLoader_.bandwidth=e,this.masterPlaylistController_.mainSegmentLoader_.throughput={rate:0,count:0}}},systemBandwidth:{get:function(){var e,t=1/(this.bandwidth||1);return e=this.throughput>0?1/this.throughput:0,Math.floor(1/(t+e))},set:function(){to.log.error('The "systemBandwidth" property is read-only')}}}),this.options_.bandwidth&&(this.bandwidth=this.options_.bandwidth),this.options_.throughput&&(this.throughput=this.options_.throughput),Object.defineProperties(this.stats,{bandwidth:{get:function(){return n.bandwidth||0},enumerable:!0},mediaRequests:{get:function(){return n.masterPlaylistController_.mediaRequests_()||0},enumerable:!0},mediaRequestsAborted:{get:function(){return n.masterPlaylistController_.mediaRequestsAborted_()||0},enumerable:!0},mediaRequestsTimedout:{get:function(){return n.masterPlaylistController_.mediaRequestsTimedout_()||0},enumerable:!0},mediaRequestsErrored:{get:function(){return n.masterPlaylistController_.mediaRequestsErrored_()||0},enumerable:!0},mediaTransferDuration:{get:function(){return n.masterPlaylistController_.mediaTransferDuration_()||0},enumerable:!0},mediaBytesTransferred:{get:function(){return n.masterPlaylistController_.mediaBytesTransferred_()||0},enumerable:!0},mediaSecondsLoaded:{get:function(){return n.masterPlaylistController_.mediaSecondsLoaded_()||0},enumerable:!0},buffered:{get:function(){return Vc(n.tech_.buffered())},enumerable:!0},currentTime:{get:function(){return n.tech_.currentTime()},enumerable:!0},currentSource:{get:function(){return n.tech_.currentSource_},enumerable:!0},currentTech:{get:function(){return n.tech_.name_},enumerable:!0},duration:{get:function(){return n.tech_.duration()},enumerable:!0},master:{get:function(){return n.playlists.master},enumerable:!0},playerDimensions:{get:function(){return n.tech_.currentDimensions()},enumerable:!0},seekable:{get:function(){return Vc(n.tech_.seekable())},enumerable:!0},timestamp:{get:function(){return Date.now()},enumerable:!0},videoPlaybackQuality:{get:function(){return n.tech_.getVideoPlaybackQuality()},enumerable:!0}}),this.tech_.one("canplay",this.masterPlaylistController_.setupFirstPlay.bind(this.masterPlaylistController_)),this.tech_.on("bandwidthupdate",function(){n.options_.useBandwidthFromLocalStorage&&function(e){if(!window.localStorage)return!1;var t=gh();t=t?to.mergeOptions(t,e):e;try{window.localStorage.setItem("videojs-vhs",JSON.stringify(t))}catch(e){return!1}}({bandwidth:n.bandwidth,throughput:Math.round(n.throughput)})}),this.masterPlaylistController_.on("selectedinitialmedia",function(){var e,t;t=(e=n).playlists,e.representations=function(){return t.master.playlists.filter(function(e){return!Ec(e)}).map(function(t,n){return new function e(t,n,i){Qu(this,e);var r,a,o,s=t.masterPlaylistController_,l=s[(t.options_.smoothQualityChange?"smooth":"fast")+"QualityChange_"].bind(s);if(n.attributes.RESOLUTION){var u=n.attributes.RESOLUTION;this.width=u.width,this.height=u.height}this.bandwidth=n.attributes.BANDWIDTH,this.id=i,this.enabled=(r=t.playlists,a=n.uri,o=l,function(e){var t=r.master.playlists[a],n=Ec(t),i=Cc(t);return void 0===e?i:(e?delete t.disabled:t.disabled=!0,e===i||n||(o(),e?r.trigger("renditionenabled"):r.trigger("renditiondisabled")),e)})}(e,t,t.uri)})},function(e){if("dash"===e.options_.sourceType){var t=to.players[e.tech_.options_.playerId];if(t.eme){var n=function(e,t,n){if(!e)return e;var i={};for(var r in e)i[r]={audioContentType:'audio/mp4; codecs="'+n.attributes.CODECS+'"',videoContentType:'video/mp4; codecs="'+t.attributes.CODECS+'"'},t.contentProtection&&t.contentProtection[r]&&t.contentProtection[r].pssh&&(i[r].pssh=t.contentProtection[r].pssh),"string"==typeof e[r]&&(i[r].url=e[r]);return to.mergeOptions(e,i)}(e.source_.keySystems,e.playlists.media(),e.masterPlaylistController_.mediaTypes_.AUDIO.activePlaylistLoader.media());n&&(t.currentSource().keySystems=n,t.eme.initializeMediaKeys&&t.eme.initializeMediaKeys())}}}(n)}),this.on(this.masterPlaylistController_,"progress",function(){this.tech_.trigger("progress")}),this.tech_.ready(function(){return n.setupQualityLevels_()}),this.tech_.el()&&this.tech_.src(to.URL.createObjectURL(this.masterPlaylistController_.mediaSource)))}},{key:"setupQualityLevels_",value:function(){var e=this,t=to.players[this.tech_.options_.playerId];t&&t.qualityLevels&&(this.qualityLevels_=t.qualityLevels(),this.masterPlaylistController_.on("selectedinitialmedia",function(){var t,n;t=e.qualityLevels_,(n=e).representations().forEach(function(e){t.addQualityLevel(e)}),ph(t,n.playlists)}),this.playlists.on("mediachange",function(){ph(e.qualityLevels_,e.playlists)}))}},{key:"play",value:function(){this.masterPlaylistController_.play()}},{key:"setCurrentTime",value:function(e){this.masterPlaylistController_.setCurrentTime(e)}},{key:"duration",value:function(){return this.masterPlaylistController_.duration()}},{key:"seekable",value:function(){return this.masterPlaylistController_.seekable()}},{key:"dispose",value:function(){this.playbackWatcher_&&this.playbackWatcher_.dispose(),this.masterPlaylistController_&&this.masterPlaylistController_.dispose(),this.qualityLevels_&&this.qualityLevels_.dispose(),this.player_&&(delete this.player_.vhs,delete this.player_.dash,delete this.player_.hls),this.tech_&&this.tech_.hls&&delete this.tech_.hls,function e(t,n,i){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,n);if(void 0===r){var a=Object.getPrototypeOf(t);return null===a?void 0:e(a,n,i)}if("value"in r)return r.value;var o=r.get;return void 0!==o?o.call(i):void 0}(n.prototype.__proto__||Object.getPrototypeOf(n.prototype),"dispose",this).call(this)}},{key:"convertToProgramTime",value:function(e,t){return function(e){var t=e.playlist,n=e.time,i=void 0===n?void 0:n,r=e.callback;if(!r)throw new Error("getProgramTime: callback must be provided");if(!t||void 0===i)return r({message:"getProgramTime: playlist and time must be provided"});var a=function(e,t){if(!t||!t.segments||0===t.segments.length)return null;for(var n=0,i=void 0,r=0;r<t.segments.length&&!(e<=(n=(i=t.segments[r]).videoTimingInfo?i.videoTimingInfo.transmuxedPresentationEnd:n+i.duration));r++);var a=t.segments[t.segments.length-1];if(a.videoTimingInfo&&a.videoTimingInfo.transmuxedPresentationEnd<e)return null;if(e>n){if(e>n+.25*a.duration)return null;i=a}return{segment:i,estimatedStart:i.videoTimingInfo?i.videoTimingInfo.transmuxedPresentationStart:n-i.duration,type:i.videoTimingInfo?"accurate":"estimate"}}(i,t);if(!a)return r({message:"valid programTime was not found"});if("estimate"===a.type)return r({message:"Accurate programTime could not be determined. Please seek to e.seekTime and try again",seekTime:a.estimatedStart});var o={mediaSeconds:i},s=function(e,t){if(!t.dateTimeObject)return null;var n=t.videoTimingInfo.transmuxerPrependedSeconds,i=e-(t.videoTimingInfo.transmuxedPresentationStart+n);return new Date(t.dateTimeObject.getTime()+1e3*i)}(i,a.segment);return s&&(o.programDateTime=s.toISOString()),r(null,o)}({playlist:this.masterPlaylistController_.media(),time:e,callback:t})}},{key:"seekToProgramTime",value:function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2;return function e(t){var n=t.programTime,i=t.playlist,r=t.retryCount,a=void 0===r?2:r,o=t.seekTo,s=t.pauseAfterSeek,l=void 0===s||s,u=t.tech,c=t.callback;if(!c)throw new Error("seekToProgramTime: callback must be provided");if(void 0===n||!i||!o)return c({message:"seekToProgramTime: programTime, seekTo and playlist must be provided"});if(!i.endList&&!u.hasStarted_)return c({message:"player must be playing a live stream to start buffering"});if(!function(e){if(!e.segments||0===e.segments.length)return!1;for(var t=0;t<e.segments.length;t++)if(!e.segments[t].dateTimeObject)return!1;return!0}(i))return c({message:"programDateTime tags must be provided in the manifest "+i.resolvedUri});var d=function(e,t){var n=void 0;try{n=new Date(e)}catch(e){return null}if(!t||!t.segments||0===t.segments.length)return null;var i=t.segments[0];if(n<i.dateTimeObject)return null;for(var r=0;r<t.segments.length-1&&(i=t.segments[r],!(n<t.segments[r+1].dateTimeObject));r++);var a,o=t.segments[t.segments.length-1],s=o.dateTimeObject,l=o.videoTimingInfo?(a=o.videoTimingInfo).transmuxedPresentationEnd-a.transmuxedPresentationStart-a.transmuxerPrependedSeconds:o.duration+.25*o.duration;return n>new Date(s.getTime()+1e3*l)?null:(n>s&&(i=o),{segment:i,estimatedStart:i.videoTimingInfo?i.videoTimingInfo.transmuxedPresentationStart:Sc.duration(t,t.mediaSequence+t.segments.indexOf(i)),type:i.videoTimingInfo?"accurate":"estimate"})}(n,i);if(!d)return c({message:n+" was not found in the stream"});var h=d.segment,p=function(e,t){var n=void 0,i=void 0;try{n=new Date(e),i=new Date(t)}catch(e){}var r=n.getTime();return(i.getTime()-r)/1e3}(h.dateTimeObject,n);if("estimate"===d.type)return 0===a?c({message:n+" is not buffered yet. Try again"}):(o(d.estimatedStart+p),void u.one("seeked",function(){e({programTime:n,playlist:i,retryCount:a-1,seekTo:o,pauseAfterSeek:l,tech:u,callback:c})}));var f=h.start+p;u.one("seeked",function(){return c(null,u.currentTime())}),l&&u.pause(),o(f)}({programTime:e,playlist:this.masterPlaylistController_.media(),retryCount:i,pauseAfterSeek:n,seekTo:this.options_.seekTo,tech:this.options_.tech,callback:t})}}]),n}(to.getComponent("Component")),vh={name:"videojs-http-streaming",VERSION:"1.10.3",canHandleSource:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=to.mergeOptions(to.options,t);return vh.canPlayType(e.type,n)},handleSource:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=to.mergeOptions(to.options,n);return t.hls=new mh(e,t,i),t.hls.xhr=Dc(),t.hls.src(e.src,e.type),t.hls},canPlayType:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=to.mergeOptions(to.options,t).hls.overrideNative,i=hh(e);return i&&(!dh.supportsTypeNatively(i)||n)?"maybe":""}};return void 0!==to.MediaSource&&void 0!==to.URL||(to.MediaSource=vd,to.URL=yd),vd.supportsNativeMediaSources()&&to.getTech("Html5").registerSourceHandler(vh,0),to.HlsHandler=mh,to.HlsSourceHandler=vh,to.Hls=dh,to.use||to.registerComponent("Hls",dh),to.options.hls=to.options.hls||{},to.registerPlugin?to.registerPlugin("reloadSourceOnError",ch):to.plugin("reloadSourceOnError",ch),to}(n(21),n(22))},function(e,t){e.exports='<script type="text/ng-template" ng-app="videoApp" ng-controller="videoCtrl as $ctrl" id="videoPreviewDialog">\n\n    <style type="text/css">\n        .video-modal {\n            top: 4% !important;\n        }\n        .ui.grid .column.video-leftContent {\n            height: 200px;\n            padding-top: 10px !important;\n        }\n\n        .ui.grid .column.video-rightContent {\n            color: #aaa;\n            font-size: 13px;\n            font-style: italic;\n            padding-top: 35px !important;\n        }\n\n        #previewMessage,\n        #errorMessage {\n            height: 200px !important;\n            text-align: center;\n            padding-top: 70px;\n        }\n        .video-library-tab{\n            overflow-y: auto;\n            overflow-x: hidden;\n            min-height: 300px !important;\n            max-height: 300px !important;\n            padding:5px;\n        }\n        .load-more-assets-spinner {\n    margin: 100px auto 0;\n    width: 70px;\n    text-align: center;\n  }\n\n  .load-more-assets-spinner > div {\n    width: 18px;\n    height: 18px;\n    background-color: #333;\n\n    border-radius: 100%;\n    display: inline-block;\n    -webkit-animation: sk-bouncedelay 1.4s infinite ease-in-out both;\n    animation: sk-bouncedelay 1.4s infinite ease-in-out both;\n  }\n\n  .load-more-assets-spinner .bounce1 {\n    -webkit-animation-delay: -0.32s;\n    animation-delay: -0.32s;\n  }\n\n  .load-more-assets-spinner .bounce2 {\n    -webkit-animation-delay: -0.16s;\n    animation-delay: -0.16s;\n  }\n\n  @-webkit-keyframes sk-bouncedelay {\n    0%, 80%, 100% { -webkit-transform: scale(0) }\n    40% { -webkit-transform: scale(1.0) }\n  }\n\n  @keyframes sk-bouncedelay {\n    0%, 80%, 100% {\n      -webkit-transform: scale(0);\n      transform: scale(0);\n    } 40% {\n      -webkit-transform: scale(1.0);\n      transform: scale(1.0);\n    }\n  }\n  .load-more-assets-warning-msg img{\n    padding:0px!important;\n  }\n  .load-more-assets-warning-msg p{\n    text-align:center;\n  }\n\n    </style>\n\n    <div class="ui modal active video-modal">\n        <div class="header" ng-switch="$ctrl.plugin">\n            <div class="ui two column grid">\n                <div class="row">\n                    <div class="column">\n                        <span>\n                            <i class="video play outline large icon"></i> Add Video</span>\n                    </div>\n                    <div class="right aligned column">\n                        <i class="close link icon" ng-click="closeThisDialog(); $ctrl.generateTelemetry({id: \'button\', type: \'click\', subtype: \'close\', target: \'closeButton\'})"></i>\n                    </div>\n                </div>\n            </div>\n        </div>\n\n        <div class="content">\n            <div class="ui pointing secondary menu">\n                <a id="googleDriveTab" class="active item" data-tab="first" ng-click="$ctrl.driveTab();">URL</a>\n                <a id="youtubeTab" class="item" data-tab="second" ng-click="$ctrl.videoLibraryTab();">Library</a>\n            </div>\n        <div class="video__itemContainer">\n            <div class="ui fluid grid container tab active" data-tab="first">\n                <div class="row">\n                    <div class="column" style="padding:0;">\n                        <div class="ui fluid action input">\n                            <input type="text" ng-keyup="$event.keyCode == 13 && $ctrl.videoUrl !== \'\' && $ctrl.previewVideo(); $ctrl.generateTelemetry({id: \'button\',type: \'click\', subtype: \'search\', target: \'videoUrl\'})"\n                                placeholder="Paste video URL here" ng-model="$ctrl.videoUrl" ng-change="$ctrl.hasInputChanged();">\n                            <div class="ui blue button" ng-click="$ctrl.previewVideo(); $ctrl.generateTelemetry({id: \'button\',type: \'click\', subtype: \'search\', target: \'videoUrl\'})">Go</div>\n                        </div>\n                    </div>\n                </div>\n                <div class="row">\n                    <div class="six wide left aligned column" style="padding-left:0;">\n                        <div ng-show="$ctrl.messageDiv">\n                            <div class="ui segment" class="ui" id="previewMessage" ng-if="$ctrl.show == \'message\'" style="height: 200px !important">\n                                <div class="ui text">{{$ctrl.previewMessages.emptyState}}</div>\n                            </div>\n                            <div class="ui segment" id="errorMessage" ng-if="$ctrl.show == \'error\'" style="height: 200px !important">\n                                <i class="warning sign large red icon"></i>\n                                <div class="ui text">{{ $ctrl.errorMessage  || \'Sorry could not load preview of the video link. Please check the link and try again.\'}}</div>\n                            </div>\n                            <div class="ui segment" ng-if="$ctrl.show == \'loader\'" style="height: 200px !important">\n                                <div class="ui active inverted dimmer">\n                                    <div class="ui text loader">{{$ctrl.previewMessages.loadingState}}</div>\n                                </div>\n                            </div>\n                        </div>\n                        <div ng-show="!$ctrl.messageDiv" id="previewVideo"></div>\n                    </div>\n                    <div class="six wide column" style="padding-right:0;">\n                        <p>\n                            <b>YouTube</b>: </br>\n                            <ul>\n                                <li>Only creative commons YouTube links are supported. </li>\n                            </ul>\n                            <b>Google Drive</b>:\n                            <ul>\n                                <li>Supported File Type: WebM, MP4.</li>\n                                <li>Recommended File Size: Less than {{$ctrl.maxVideoSize}}MB</li>\n                                <li>Please keep the video file on Google Drive. Deleting the video from Google Drive will stop it from showing here also</li>\n                            </ul>\n                        </p>\n                    </div>\n                </div>\n            </div>\n\n            <div class="ui fluid  container tab" data-tab="second">\n                <div class="row">\n                    <div class="column">\n                            <div class="ui  fluid icon input assetbrowser_searchBox">\n                                <input id="searchMyImageAssets" ng-model="$ctrl.query" placeholder="Search the library for YouTube videos published under \'CC-BY 4.0\'..." ng-keypress="$event.keyCode === 13 ? $ctrl.search() : null" type="text" />\n                                <i class="circular search link icon inverted" ng-click="$ctrl.search(); $ctrl.generateTelemetry({id: \'videoUrl\', type: \'click\', subtype: \'search\', target: \'searchAsset\'})"></i>\n                            </div>\n                    </div>\n                </div>\n                <div class="clearfix">&nbsp;</div>\n                <div class="ui special three cards video-library-tab" id="video-library-tab">\n                    <div ng-show="$ctrl.youtubeList.length > 0" ng-click="$ctrl.VideoSource(videoItem)" class="card" style="cursor:pointer" ng-repeat="videoItem in $ctrl.youtubeList  track by $index">\n                        <div class="video image infopopover">\n                            <img ng-src="{{videoItem.appIcon || $ctrl.defaultImage}}" class="resourceMetaImage ">\n                            <div class="ui checkbox blue-checkbox checkBoxOverImage-top-right-corner" id=\'checkBox_{{videoItem.identifier}}\' style="z-index:12">\n                                <input class="radioBox" type="radio" name="youtubeVideo">\n                                <label></label>\n                            </div>\n                            <div class="ui inverted dimmer">\n                                <div class="content">\n                                    <div class="ui list cardDetails-list">\n                                        <div class="item">\n                                            <div class="right floated content contentMetaDetail">{{videoItem.board}}</div>\n                                            <div class="content contentTitle">Board</div>\n                                        </div>\n                                        <div class="item">\n                                            <div class="right floated content contentMetaDetail">{{(videoItem.gradeLevel.toString())}}\n                                            </div>\n                                            <div class="content contentTitle">Class</div>\n                                        </div>\n                                        <div class="item">\n                                            <div class="right floated content contentMetaDetail">{{(videoItem.subject)}}\n                                            </div>\n                                            <div class="content contentTitle">Subject</div>\n                                        </div>\n                                    </div>\n                                </div>\n                            </div>\n                        </div>\n                        <div class="content">\n                            <div class="header contentMetaTitle">\n                                 {{videoItem.name}}\n                            </div>\n                            <div class="meta" ng-if="videoItem.creator">\n                                <span class="date">Created by {{videoItem.creator}}</span>\n                            </div>\n                        </div>\n                    </div>\n\n                    <div class="twelve wide column" ng-show="$ctrl.youtubeList.length ==0">\n                        <span>No result found. </span>\n                    </div>\n                    <div class="twelve wide column">\n                        <div class="load-more-assets-spinner" ng-show="$ctrl.loadMoreAssetSpinner">\n                            <div class="bounce1"></div>\n                            <div class="bounce2"></div>\n                            <div class="bounce3"></div>\n                        </div>\n                        <div class="load-more-assets-warning-msg" ng-show="$ctrl.showLoadMoreWarningMsg">\n                            <img class="ui centered tiny image" ng-src="{{$ctrl.contentNotFoundImage}}">\n                            <p>Didn’t find what you were looking for? Try\n                                <a href="#" ng-click="$ctrl.searchTextClicked();">search</a> for something more specific\n                            </p>\n                        </div>\n                    </div>\n                </div>\n            </div>\n        </div>\n        </div>\n        <div class="actions">\n            <div class="ui buttons">\n                \x3c!-- <button class="ui orange button" ng-click="closeThisDialog();$ctrl.generateTelemetry({type: \'click\', subtype: \'close\', target: \'cancelButton\'})"\n                    type="button">Cancel</button> --\x3e\n                \x3c!-- <div class="or"></div> --\x3e\n                <button id="addToLesson" class="ui blue button" type="button" ng-disabled="!$ctrl.showAddLessonBtn" ng-click="$ctrl.addVideo();$ctrl.generateTelemetry({type: \'click\', subtype: \'addToLesson\', target: \'addVideo\'})">Add</button>\n            </div>\n        </div>\n    </div>\n<\/script>\n'},function(e,t,n){"use strict";angular.module("videoApp",[]).controller("videoCtrl",["$scope","$injector","instance",function(e,t,n){var i=this;function r(t,n){n&&n.data.result.content?(i.youtubeList=[],ecEditor._.forEach(n.data.result.content,function(e,t){ecEditor._.isUndefined(e.artifactUrl)||i.youtubeList.push(e)}),i.initPopup(n.data.result.content)):i.youtubeList=[],i.loading="",e.$safeApply(),ecEditor.jQuery(".special.cards .video").dimmer({on:"hover"})}i.videoUrl="",i.show="message",i.messageDiv=!0,i.maxLimit=1e3,i.videoLibraryTabElement="",i.defaultImage=ecEditor.resolvePluginResource(n.manifest.id,n.manifest.ver,"assets/default_image.png"),i.selectedYoutube={},i.limit=200,i.offset=0,i.offsetInc=200,i.loadMoreAssetSpinner=!1,i.showLoadMoreWarningMsg=!1,i.showAddLessonBtn=!1,i.maxVideoSize=ecEditor.getContext("videoMaxSize")||50,i.videoSizeInBytes=parseInt(1024*i.maxVideoSize*1024),i.previewMessages={emptyState:"Click Go to preview",previewError:"Could not load the preview. Check the link and try again",invalidYoutubeURL:"Please provide valid YouTube URL!",invalidDriveURL:"Please provide valid Google drive URL!",invalidLicense:"The video you are trying to upload is not license by CC-BY. Please try another video.",loadingState:"Loading Video...",fileExceed:"Video file size is exceeded"},i.isPreviewPlaying=!1,i.hasInputChanged=function(){i.previewHandler(),i.toastManager("message",!0,!1,i.previewMessages.emptyState)},i.videoLibraryTab=function(){i.previewHandler(),ecEditor.jQuery("#"+i.videoLibraryTabElement).unbind("scroll").scroll(i.bindScroll),i.showLoadMoreWarningMsg=!1,i.loading="active",n.getYoutube(void 0,i.limit,i.offset=0,r)},i.previewHandler=function(){i.isPreviewPlaying&&"youtube"===i.provider?videojs.getPlayers()["ID"+i.vidID]&&videojs.getPlayers()["ID"+i.vidID].pause():i.isPreviewPlaying&&"googledrive"===i.provider&&document.getElementsByTagName("video")[0].pause()},i.loadMoreYoutubeVideos=function(t){if(i.offset+i.offsetInc>=i.maxLimit)return ecEditor.jQuery("#"+t.target.id).unbind("scroll"),ecEditor.ngSafeApply(ecEditor.getAngularScope()),!1;i.offset=i.offset+i.offsetInc,i.showLoadMoreWarningMsg=!1;var r=i.query;""===r&&(r=void 0),n.getYoutube(r,i.limit,i.offset,function(e,n){n&&n.data.result.content?(ecEditor._.forEach(n.data.result.content,function(e,t){i.youtubeList.push(e)}),i.initPopup(n.data.result.content),ecEditor.jQuery("#"+t.target.id).bind("scroll",i.bindScroll)):ecEditor.jQuery("#"+t.target.id).unbind("scroll"),i.loadMoreAssetSpinner=!1,ecEditor.ngSafeApply(ecEditor.getAngularScope())}),e.$safeApply()},i.initPopup=function(t){ecEditor.jQuery(".video-modal .ui.popup").each(function(){ecEditor.jQuery(this).remove()}),e.$on("ngDialog:opened",function(){ecEditor.jQuery(".video-modal .infopopover").popup({inline:!0,position:"bottom center"})})},i.search=function(){var e;""===(e=i.query)&&(e=void 0),i.showLoadMoreWarningMsg=!1,n.getYoutube(e,i.limit,i.offset,r),ecEditor.jQuery("#"+i.videoLibraryTabElement).unbind("scroll").scroll(i.bindScroll)},i.checkValidYoutube=function(e){var t=/^(?:https?:\/\/)?(?:m\.|www\.)?(?:youtu\.be\/|youtube\.com\/(?:embed\/|v\/|watch\?v=|watch\?.+&v=))((\w|-){11})(?:\S+)?$/;return!(!e||!e.match(t))&&e.match(t)[1]},i.checkProvider=function(e,t){if(i.vidID=i.checkValidYoutube(e),i.vidID)i.videoUrl="https://www.youtube.com/watch?v="+i.vidID,i.provider="youtube",t(null,i.videoUrl,i.provider);else if(-1!=e.indexOf("drive")){var n=e.replace("/view?usp=sharing","").replace("open?id=","uc?export=download&id=").replace("file/d/","uc?export=download&id=").replace("/edit?usp=sharing","");i.videoUrl=n,i.provider="googledrive",t(null,i.videoUrl,i.provider)}else t(new Error("invalid url"),null,null)},i.toastManager=function(e,t,n,r){angular.element(ecEditor.jQuery("#addToLesson")).scope().$safeApply(function(){i.show=e,i.messageDiv=t,i.showAddLessonBtn=n,i.errorMessage=r})},i.youtubeLoader=function(e,t){var n={request:{asset:{provider:i.provider,url:i.videoUrl}}};org.ekstep.contenteditor.api.getService(ServiceConstants.META_SERVICE).getVideoLicense(n,"license",function(t,n){if(t)i.toastManager("error",!0,!1,i.previewMessages.invalidYoutubeURL),i.isPreviewPlaying=!1;else if(n.data.result.license.valid){e.id="ID"+i.vidID,e.className="video-js vjs-default-skin",i.isPreviewPlaying=!0;var r="ID"+i.vidID;videojs.getPlayers()[r]&&delete videojs.getPlayers()[r],videojs(r,{techOrder:["youtube"],src:i.videoUrl,youtube:{iv_load_policy:3}},function(){}),videojs(r).ready(function(){this.src({type:"video/youtube",src:i.videoUrl}),i.toastManager("",!1,!0,"")})}else i.isPreviewPlaying=!1,i.toastManager("error",!0,!1,i.previewMessages.invalidLicense)})},i.driveLoader=function(e,t){var r={request:{asset:{provider:i.provider,url:i.videoUrl}}};org.ekstep.contenteditor.api.getService(ServiceConstants.META_SERVICE).getVideoLicense(r,"size",function(e,r){e?(i.toastManager("error",!0,!1,i.previewMessages.invalidDriveURL),i.isPreviewPlaying=!1):r.data.result.size.valid&&r.data.result.size.value<=i.videoSizeInBytes?t.play().then(function(){i.isPreviewPlaying=!0,i.toastManager("",!1,!0,"")}).catch(function(e){i.toastManager("error",!0,!1,i.previewMessages.previewError),i.isPreviewPlaying=!1;var t=ecEditor.getService("content").getContentMeta(org.ekstep.contenteditor.api.getContext("contentId")).pkgVersion,r={id:org.ekstep.contenteditor.api.getContext("contentId"),ver:!_.isUndefined(t)&&t.toString()||"0",type:"Content"};org.ekstep.contenteditor.api.getService(ServiceConstants.TELEMETRY_SERVICE).error({err:e.code||"",errtype:"CONTENT",stacktrace:e.toString(),pageid:ecEditor.getCurrentStage().id,object:r,plugin:{id:n.manifest.id,ver:n.manifest.ver,category:"core"}}),console.log("Invalid URL:",e)}):i.toastManager("error",!0,!1,"File size is exceeded")})},i.generateImpression=function(e){e&&ecEditor.getService("telemetry").impression({type:e.type,subtype:e.subtype||"",pageid:e.pageid||"",uri:window.location.href,visits:i.inViewLogs,duration:e.duration})},i.previewVideo=function(){i.messageDiv=!0,i.show="loader";var e=i.videoUrl;$('input[name="youtubeVideo"]').prop("checked",!1),i.checkProvider(e,function(e,t,n){var r=i.createVideoElement(i.videoUrl);ecEditor.jQuery(".content .container #previewVideo").html(r);var a=document.getElementsByTagName("video")[0];"youtube"===n?i.youtubeLoader(r,a):"googledrive"===n?i.driveLoader(r,a):i.toastManager("error",!0,!1,i.previewMessages.previewError)})},setTimeout(function(){i.generateImpression({type:"view",subtype:"popup-open",pageid:"VideoBrowser",duration:new Date-n.pluginLoadStartTime}),i.videoLibraryTabElement="video-library-tab",ecEditor.jQuery(".video-modal .menu .item").tab(),i.bindScroll=function(e){console.log("tabswithced");var t=ecEditor.jQuery("#"+e.target.id),n=ecEditor.jQuery("#"+e.target.id)[0];t.scrollTop()+t.height()+40>=n.scrollHeight&&(ecEditor.jQuery("#"+e.target.id).unbind("scroll"),i.loadMoreYoutubeVideos(e))},ecEditor.jQuery("#"+i.videoLibraryTabElement).unbind("scroll").scroll(i.bindScroll)},100),i.VideoSource=function(e){ecEditor.jQuery("#checkBox_"+e.identifier+" >.radioBox").not(":checked").prop("checked",!0),i.toastManager("message",!0,!0,i.previewMessages.emptyState),i.videoUrl=e.artifactUrl},i.createVideoElement=function(e){var t=document.createElement("video");return t.src=e,t.width="400",t.height="200",t.controls=!0,t.autoplay="autoplay",t},i.addVideo=function(){i.isPreviewPlaying=!1,e.closeThisDialog(),ecEditor.dispatchEvent("org.ekstep.video:create",{y:7.9,x:10.97,w:78.4,h:79.51,config:{autoplay:!0,controls:!0,muted:!1,visible:!0,url:i.videoUrl}})},i.generateTelemetry=function(e){e&&org.ekstep.contenteditor.api.getService(ServiceConstants.TELEMETRY_SERVICE).interact({type:e.type,subtype:e.subtype,target:e.target,pluginid:n.manifest.id,pluginver:n.manifest.ver,objectid:"",stage:ecEditor.getCurrentStage().id})}}])},function(e,t){org.ekstep.pluginframework.pluginManager.registerPlugin({id:"org.ekstep.image",ver:"1.1",shortId:"image",displayName:"Image",author:"Santhosh Vasabhaktula",title:"Image Plugin",description:"",publishedDate:"",editor:{main:"editor/plugin.js",help:{src:"editor/help.md",dataType:"text"},dependencies:[{type:"plugin",plugin:"org.ekstep.assetbrowser",ver:"1.4"}],menu:[{id:"image",category:"main",type:"icon",toolTip:"Add Image",title:"Image",iconClass:"fa fa-picture-o",onclick:{id:"org.ekstep.image:assetbrowser:open"}}],behaviour:{rotatable:!0},configManifest:[{propertyName:"imagebrowser",title:"Image Browser",description:"Choose a  from the browser",dataType:"browser",required:!0,onclick:{id:"org.ekstep.assetbrowser:show",type:"image"}}]}},org.ekstep.contenteditor.basePlugin.extend({name:"Image",initialize:function(){ecEditor.addEventListener(this.manifest.id+":assetbrowser:open",this.openBrowser,this)},newInstance:function(){var e=this,t=this.parent,n=(this.parent=void 0,this.convertToFabric(this.attributes)),i=("plugin"==this.attributes.from&&(delete n.width,delete n.height),this.media?this.media[this.attributes.asset]:void 0);if(!i||!i.src)throw new Error("media source is missing!");i&&i.src&&(this.name=this.attributes.asset,i.src=ecEditor.getMediaReverseProxyURL(i.src),i=ecEditor.getConfig("useProxyForURL")?"image/get/"+encodeURIComponent(i.src):i.src,fabric.Image.fromURL(i,function(i){i.strokeWidth=1,e.editorObj=i,e.parent=t,"plugin"==e.attributes.from&&(e.editorObj.scaleToWidth(n.w),delete e.attributes.from),e.postInit()},n))},openBrowser:function(){var e=this;ecEditor.dispatchEvent("org.ekstep.assetbrowser:show",{type:"image",search_filter:{},callback:function(t){t.x=20,t.y=20,t.w=50,t.h=50,t.from="plugin",ecEditor.dispatchEvent(e.manifest.id+":create",t)}})},getCopy:function(){var e=this._super();return e.assetMedia=this.media[this.attributes.asset],e},onConfigChange:function(e,t){"browser"===e&&(ecEditor.dispatchEvent("delete:invoke"),ecEditor.dispatchEvent(this.manifest.id+":create",t))},getDisplayName:function(){return this.name}}))},function(e,t,n){var i,r,a;/*! jPlayer 2.9.2 for jQuery ~ (c) 2009-2014 Happyworm Ltd ~ MIT License */r=[n(20)],void 0===(a="function"==typeof(i=function(e,t){e.fn.jPlayer=function(n){var i="jPlayer",r="string"==typeof n,a=Array.prototype.slice.call(arguments,1),o=this;return n=!r&&a.length?e.extend.apply(null,[!0,n].concat(a)):n,r&&"_"===n.charAt(0)?o:(this.each(r?function(){var r=e(this).data(i),s=r&&e.isFunction(r[n])?r[n].apply(r,a):r;return s!==r&&s!==t?(o=s,!1):void 0}:function(){var t=e(this).data(i);t?t.option(n||{}):e(this).data(i,new e.jPlayer(n,this))}),o)},e.jPlayer=function(t,n){if(arguments.length){this.element=e(n),this.options=e.extend(!0,{},this.options,t);var i=this;this.element.bind("remove.jPlayer",function(){i.destroy()}),this._init()}},"function"!=typeof e.fn.stop&&(e.fn.stop=function(){}),e.jPlayer.emulateMethods="load play pause",e.jPlayer.emulateStatus="src readyState networkState currentTime duration paused ended playbackRate",e.jPlayer.emulateOptions="muted volume",e.jPlayer.reservedEvent="ready flashreset resize repeat error warning",e.jPlayer.event={},e.each(["ready","setmedia","flashreset","resize","repeat","click","error","warning","loadstart","progress","suspend","abort","emptied","stalled","play","pause","loadedmetadata","loadeddata","waiting","playing","canplay","canplaythrough","seeking","seeked","timeupdate","ended","ratechange","durationchange","volumechange"],function(){e.jPlayer.event[this]="jPlayer_"+this}),e.jPlayer.htmlEvent=["loadstart","abort","emptied","stalled","loadedmetadata","canplay","canplaythrough"],e.jPlayer.pause=function(){e.jPlayer.prototype.destroyRemoved(),e.each(e.jPlayer.prototype.instances,function(e,t){t.data("jPlayer").status.srcSet&&t.jPlayer("pause")})},e.jPlayer.timeFormat={showHour:!1,showMin:!0,showSec:!0,padHour:!1,padMin:!0,padSec:!0,sepHour:":",sepMin:":",sepSec:""};var n=function(){this.init()};n.prototype={init:function(){this.options={timeFormat:e.jPlayer.timeFormat}},time:function(e){e=e&&"number"==typeof e?e:0;var t=new Date(1e3*e),n=t.getUTCHours(),i=this.options.timeFormat.showHour?t.getUTCMinutes():t.getUTCMinutes()+60*n,r=this.options.timeFormat.showMin?t.getUTCSeconds():t.getUTCSeconds()+60*i,a=this.options.timeFormat.padHour&&10>n?"0"+n:n,o=this.options.timeFormat.padMin&&10>i?"0"+i:i,s=this.options.timeFormat.padSec&&10>r?"0"+r:r,l="";return l+=this.options.timeFormat.showHour?a+this.options.timeFormat.sepHour:"",(l+=this.options.timeFormat.showMin?o+this.options.timeFormat.sepMin:"")+(this.options.timeFormat.showSec?s+this.options.timeFormat.sepSec:"")}};var i=new n;e.jPlayer.convertTime=function(e){return i.time(e)},e.jPlayer.uaBrowser=function(e){var t=e.toLowerCase(),n=/(webkit)[ \/]([\w.]+)/.exec(t)||/(opera)(?:.*version)?[ \/]([\w.]+)/.exec(t)||/(msie) ([\w.]+)/.exec(t)||t.indexOf("compatible")<0&&/(mozilla)(?:.*? rv:([\w.]+))?/.exec(t)||[];return{browser:n[1]||"",version:n[2]||"0"}},e.jPlayer.uaPlatform=function(e){var t=e.toLowerCase(),n=/(ipad|iphone|ipod|android|blackberry|playbook|windows ce|webos)/.exec(t)||[],i=/(ipad|playbook)/.exec(t)||!/(mobile)/.exec(t)&&/(android)/.exec(t)||[];return n[1]&&(n[1]=n[1].replace(/\s/g,"_")),{platform:n[1]||"",tablet:i[1]||""}},e.jPlayer.browser={},e.jPlayer.platform={};var r=e.jPlayer.uaBrowser(navigator.userAgent);r.browser&&(e.jPlayer.browser[r.browser]=!0,e.jPlayer.browser.version=r.version);var a=e.jPlayer.uaPlatform(navigator.userAgent);a.platform&&(e.jPlayer.platform[a.platform]=!0,e.jPlayer.platform.mobile=!a.tablet,e.jPlayer.platform.tablet=!!a.tablet),e.jPlayer.getDocMode=function(){var t;return e.jPlayer.browser.msie&&(document.documentMode?t=document.documentMode:(t=5,document.compatMode&&"CSS1Compat"===document.compatMode&&(t=7))),t},e.jPlayer.browser.documentMode=e.jPlayer.getDocMode(),e.jPlayer.nativeFeatures={init:function(){var e,t,n,i=document,r=i.createElement("video"),a={w3c:["fullscreenEnabled","fullscreenElement","requestFullscreen","exitFullscreen","fullscreenchange","fullscreenerror"],moz:["mozFullScreenEnabled","mozFullScreenElement","mozRequestFullScreen","mozCancelFullScreen","mozfullscreenchange","mozfullscreenerror"],webkit:["","webkitCurrentFullScreenElement","webkitRequestFullScreen","webkitCancelFullScreen","webkitfullscreenchange",""],webkitVideo:["webkitSupportsFullscreen","webkitDisplayingFullscreen","webkitEnterFullscreen","webkitExitFullscreen","",""],ms:["","msFullscreenElement","msRequestFullscreen","msExitFullscreen","MSFullscreenChange","MSFullscreenError"]},o=["w3c","moz","webkit","webkitVideo","ms"];for(this.fullscreen=e={support:{w3c:!!i[a.w3c[0]],moz:!!i[a.moz[0]],webkit:"function"==typeof i[a.webkit[3]],webkitVideo:"function"==typeof r[a.webkitVideo[2]],ms:"function"==typeof r[a.ms[2]]},used:{}},t=0,n=o.length;n>t;t++){var s=o[t];if(e.support[s]){e.spec=s,e.used[s]=!0;break}}if(e.spec){var l=a[e.spec];e.api={fullscreenEnabled:!0,fullscreenElement:function(e){return(e=e||i)[l[1]]},requestFullscreen:function(e){return e[l[2]]()},exitFullscreen:function(e){return(e=e||i)[l[3]]()}},e.event={fullscreenchange:l[4],fullscreenerror:l[5]}}else e.api={fullscreenEnabled:!1,fullscreenElement:function(){return null},requestFullscreen:function(){},exitFullscreen:function(){}},e.event={}}},e.jPlayer.nativeFeatures.init(),e.jPlayer.focus=null,e.jPlayer.keyIgnoreElementNames="A INPUT TEXTAREA SELECT BUTTON";var o=function(t){var n,i=e.jPlayer.focus;i&&(e.each(e.jPlayer.keyIgnoreElementNames.split(/\s+/g),function(e,i){return t.target.nodeName.toUpperCase()===i.toUpperCase()?(n=!0,!1):void 0}),n||e.each(i.options.keyBindings,function(n,r){return r&&e.isFunction(r.fn)&&("number"==typeof r.key&&t.which===r.key||"string"==typeof r.key&&t.key===r.key)?(t.preventDefault(),r.fn(i),!1):void 0}))};e.jPlayer.keys=function(t){var n="keydown.jPlayer";e(document.documentElement).unbind(n),t&&e(document.documentElement).bind(n,o)},e.jPlayer.keys(!0),e.jPlayer.prototype={count:0,version:{script:"2.9.2",needFlash:"2.9.0",flash:"unknown"},options:{swfPath:"js",solution:"html, flash",supplied:"mp3",auroraFormats:"wav",preload:"metadata",volume:.8,muted:!1,remainingDuration:!1,toggleDuration:!1,captureDuration:!0,playbackRate:1,defaultPlaybackRate:1,minPlaybackRate:.5,maxPlaybackRate:4,wmode:"opaque",backgroundColor:"#000000",cssSelectorAncestor:"#jp_container_1",cssSelector:{videoPlay:".jp-video-play",play:".jp-play",pause:".jp-pause",stop:".jp-stop",seekBar:".jp-seek-bar",playBar:".jp-play-bar",mute:".jp-mute",unmute:".jp-unmute",volumeBar:".jp-volume-bar",volumeBarValue:".jp-volume-bar-value",volumeMax:".jp-volume-max",playbackRateBar:".jp-playback-rate-bar",playbackRateBarValue:".jp-playback-rate-bar-value",currentTime:".jp-current-time",duration:".jp-duration",title:".jp-title",fullScreen:".jp-full-screen",restoreScreen:".jp-restore-screen",repeat:".jp-repeat",repeatOff:".jp-repeat-off",gui:".jp-gui",noSolution:".jp-no-solution"},stateClass:{playing:"jp-state-playing",seeking:"jp-state-seeking",muted:"jp-state-muted",looped:"jp-state-looped",fullScreen:"jp-state-full-screen",noVolume:"jp-state-no-volume"},useStateClassSkin:!1,autoBlur:!0,smoothPlayBar:!1,fullScreen:!1,fullWindow:!1,autohide:{restored:!1,full:!0,fadeIn:200,fadeOut:600,hold:1e3},loop:!1,repeat:function(t){t.jPlayer.options.loop?e(this).unbind(".jPlayerRepeat").bind(e.jPlayer.event.ended+".jPlayer.jPlayerRepeat",function(){e(this).jPlayer("play")}):e(this).unbind(".jPlayerRepeat")},nativeVideoControls:{},noFullWindow:{msie:/msie [0-6]\./,ipad:/ipad.*?os [0-4]\./,iphone:/iphone/,ipod:/ipod/,android_pad:/android [0-3]\.(?!.*?mobile)/,android_phone:/(?=.*android)(?!.*chrome)(?=.*mobile)/,blackberry:/blackberry/,windows_ce:/windows ce/,iemobile:/iemobile/,webos:/webos/},noVolume:{ipad:/ipad/,iphone:/iphone/,ipod:/ipod/,android_pad:/android(?!.*?mobile)/,android_phone:/android.*?mobile/,blackberry:/blackberry/,windows_ce:/windows ce/,iemobile:/iemobile/,webos:/webos/,playbook:/playbook/},timeFormat:{},keyEnabled:!1,audioFullScreen:!1,keyBindings:{play:{key:80,fn:function(e){e.status.paused?e.play():e.pause()}},fullScreen:{key:70,fn:function(e){(e.status.video||e.options.audioFullScreen)&&e._setOption("fullScreen",!e.options.fullScreen)}},muted:{key:77,fn:function(e){e._muted(!e.options.muted)}},volumeUp:{key:190,fn:function(e){e.volume(e.options.volume+.1)}},volumeDown:{key:188,fn:function(e){e.volume(e.options.volume-.1)}},loop:{key:76,fn:function(e){e._loop(!e.options.loop)}}},verticalVolume:!1,verticalPlaybackRate:!1,globalVolume:!1,idPrefix:"jp",noConflict:"jQuery",emulateHtml:!1,consoleAlerts:!0,errorAlerts:!1,warningAlerts:!1},optionsAudio:{size:{width:"0px",height:"0px",cssClass:""},sizeFull:{width:"0px",height:"0px",cssClass:""}},optionsVideo:{size:{width:"480px",height:"270px",cssClass:"jp-video-270p"},sizeFull:{width:"100%",height:"100%",cssClass:"jp-video-full"}},instances:{},status:{src:"",media:{},paused:!0,format:{},formatType:"",waitForPlay:!0,waitForLoad:!0,srcSet:!1,video:!1,seekPercent:0,currentPercentRelative:0,currentPercentAbsolute:0,currentTime:0,duration:0,remaining:0,videoWidth:0,videoHeight:0,readyState:0,networkState:0,playbackRate:1,ended:0},internal:{ready:!1},solution:{html:!0,aurora:!0,flash:!0},format:{mp3:{codec:"audio/mpeg",flashCanPlay:!0,media:"audio"},m4a:{codec:'audio/mp4; codecs="mp4a.40.2"',flashCanPlay:!0,media:"audio"},m3u8a:{codec:'application/vnd.apple.mpegurl; codecs="mp4a.40.2"',flashCanPlay:!1,media:"audio"},m3ua:{codec:"audio/mpegurl",flashCanPlay:!1,media:"audio"},oga:{codec:'audio/ogg; codecs="vorbis, opus"',flashCanPlay:!1,media:"audio"},flac:{codec:"audio/x-flac",flashCanPlay:!1,media:"audio"},wav:{codec:'audio/wav; codecs="1"',flashCanPlay:!1,media:"audio"},webma:{codec:'audio/webm; codecs="vorbis"',flashCanPlay:!1,media:"audio"},fla:{codec:"audio/x-flv",flashCanPlay:!0,media:"audio"},rtmpa:{codec:'audio/rtmp; codecs="rtmp"',flashCanPlay:!0,media:"audio"},m4v:{codec:'video/mp4; codecs="avc1.42E01E, mp4a.40.2"',flashCanPlay:!0,media:"video"},m3u8v:{codec:'application/vnd.apple.mpegurl; codecs="avc1.42E01E, mp4a.40.2"',flashCanPlay:!1,media:"video"},m3uv:{codec:"audio/mpegurl",flashCanPlay:!1,media:"video"},ogv:{codec:'video/ogg; codecs="theora, vorbis"',flashCanPlay:!1,media:"video"},webmv:{codec:'video/webm; codecs="vorbis, vp8"',flashCanPlay:!1,media:"video"},flv:{codec:"video/x-flv",flashCanPlay:!0,media:"video"},rtmpv:{codec:'video/rtmp; codecs="rtmp"',flashCanPlay:!0,media:"video"}},_init:function(){var n=this;if(this.element.empty(),this.status=e.extend({},this.status),this.internal=e.extend({},this.internal),this.options.timeFormat=e.extend({},e.jPlayer.timeFormat,this.options.timeFormat),this.internal.cmdsIgnored=e.jPlayer.platform.ipad||e.jPlayer.platform.iphone||e.jPlayer.platform.ipod,this.internal.domNode=this.element.get(0),this.options.keyEnabled&&!e.jPlayer.focus&&(e.jPlayer.focus=this),this.androidFix={setMedia:!1,play:!1,pause:!1,time:NaN},e.jPlayer.platform.android&&(this.options.preload="auto"!==this.options.preload?"metadata":"auto"),this.formats=[],this.solutions=[],this.require={},this.htmlElement={},this.html={},this.html.audio={},this.html.video={},this.aurora={},this.aurora.formats=[],this.aurora.properties=[],this.flash={},this.css={},this.css.cs={},this.css.jq={},this.ancestorJq=[],this.options.volume=this._limitValue(this.options.volume,0,1),e.each(this.options.supplied.toLowerCase().split(","),function(t,i){var r=i.replace(/^\s+|\s+$/g,"");if(n.format[r]){var a=!1;e.each(n.formats,function(e,t){return r===t?(a=!0,!1):void 0}),a||n.formats.push(r)}}),e.each(this.options.solution.toLowerCase().split(","),function(t,i){var r=i.replace(/^\s+|\s+$/g,"");if(n.solution[r]){var a=!1;e.each(n.solutions,function(e,t){return r===t?(a=!0,!1):void 0}),a||n.solutions.push(r)}}),e.each(this.options.auroraFormats.toLowerCase().split(","),function(t,i){var r=i.replace(/^\s+|\s+$/g,"");if(n.format[r]){var a=!1;e.each(n.aurora.formats,function(e,t){return r===t?(a=!0,!1):void 0}),a||n.aurora.formats.push(r)}}),this.internal.instance="jp_"+this.count,this.instances[this.internal.instance]=this.element,this.element.attr("id")||this.element.attr("id",this.options.idPrefix+"_jplayer_"+this.count),this.internal.self=e.extend({},{id:this.element.attr("id"),jq:this.element}),this.internal.audio=e.extend({},{id:this.options.idPrefix+"_audio_"+this.count,jq:t}),this.internal.video=e.extend({},{id:this.options.idPrefix+"_video_"+this.count,jq:t}),this.internal.flash=e.extend({},{id:this.options.idPrefix+"_flash_"+this.count,jq:t,swf:this.options.swfPath+(".swf"!==this.options.swfPath.toLowerCase().slice(-4)?(this.options.swfPath&&"/"!==this.options.swfPath.slice(-1)?"/":"")+"jquery.jplayer.swf":"")}),this.internal.poster=e.extend({},{id:this.options.idPrefix+"_poster_"+this.count,jq:t}),e.each(e.jPlayer.event,function(e,i){n.options[e]!==t&&(n.element.bind(i+".jPlayer",n.options[e]),n.options[e]=t)}),this.require.audio=!1,this.require.video=!1,e.each(this.formats,function(e,t){n.require[n.format[t].media]=!0}),this.options=this.require.video?e.extend(!0,{},this.optionsVideo,this.options):e.extend(!0,{},this.optionsAudio,this.options),this._setSize(),this.status.nativeVideoControls=this._uaBlocklist(this.options.nativeVideoControls),this.status.noFullWindow=this._uaBlocklist(this.options.noFullWindow),this.status.noVolume=this._uaBlocklist(this.options.noVolume),e.jPlayer.nativeFeatures.fullscreen.api.fullscreenEnabled&&this._fullscreenAddEventListeners(),this._restrictNativeVideoControls(),this.htmlElement.poster=document.createElement("img"),this.htmlElement.poster.id=this.internal.poster.id,this.htmlElement.poster.onload=function(){(!n.status.video||n.status.waitForPlay)&&n.internal.poster.jq.show()},this.element.append(this.htmlElement.poster),this.internal.poster.jq=e("#"+this.internal.poster.id),this.internal.poster.jq.css({width:this.status.width,height:this.status.height}),this.internal.poster.jq.hide(),this.internal.poster.jq.bind("click.jPlayer",function(){n._trigger(e.jPlayer.event.click)}),this.html.audio.available=!1,this.require.audio&&(this.htmlElement.audio=document.createElement("audio"),this.htmlElement.audio.id=this.internal.audio.id,this.html.audio.available=!!this.htmlElement.audio.canPlayType&&this._testCanPlayType(this.htmlElement.audio)),this.html.video.available=!1,this.require.video&&(this.htmlElement.video=document.createElement("video"),this.htmlElement.video.id=this.internal.video.id,this.html.video.available=!!this.htmlElement.video.canPlayType&&this._testCanPlayType(this.htmlElement.video)),this.flash.available=this._checkForFlash(10.1),this.html.canPlay={},this.aurora.canPlay={},this.flash.canPlay={},e.each(this.formats,function(t,i){n.html.canPlay[i]=n.html[n.format[i].media].available&&""!==n.htmlElement[n.format[i].media].canPlayType(n.format[i].codec),n.aurora.canPlay[i]=e.inArray(i,n.aurora.formats)>-1,n.flash.canPlay[i]=n.format[i].flashCanPlay&&n.flash.available}),this.html.desired=!1,this.aurora.desired=!1,this.flash.desired=!1,e.each(this.solutions,function(t,i){if(0===t)n[i].desired=!0;else{var r=!1,a=!1;e.each(n.formats,function(e,t){n[n.solutions[0]].canPlay[t]&&("video"===n.format[t].media?a=!0:r=!0)}),n[i].desired=n.require.audio&&!r||n.require.video&&!a}}),this.html.support={},this.aurora.support={},this.flash.support={},e.each(this.formats,function(e,t){n.html.support[t]=n.html.canPlay[t]&&n.html.desired,n.aurora.support[t]=n.aurora.canPlay[t]&&n.aurora.desired,n.flash.support[t]=n.flash.canPlay[t]&&n.flash.desired}),this.html.used=!1,this.aurora.used=!1,this.flash.used=!1,e.each(this.solutions,function(t,i){e.each(n.formats,function(e,t){return n[i].support[t]?(n[i].used=!0,!1):void 0})}),this._resetActive(),this._resetGate(),this._cssSelectorAncestor(this.options.cssSelectorAncestor),this.html.used||this.aurora.used||this.flash.used?this.css.jq.noSolution.length&&this.css.jq.noSolution.hide():(this._error({type:e.jPlayer.error.NO_SOLUTION,context:"{solution:'"+this.options.solution+"', supplied:'"+this.options.supplied+"'}",message:e.jPlayer.errorMsg.NO_SOLUTION,hint:e.jPlayer.errorHint.NO_SOLUTION}),this.css.jq.noSolution.length&&this.css.jq.noSolution.show()),this.flash.used){var i,r="jQuery="+encodeURI(this.options.noConflict)+"&id="+encodeURI(this.internal.self.id)+"&vol="+this.options.volume+"&muted="+this.options.muted;if(e.jPlayer.browser.msie&&(Number(e.jPlayer.browser.version)<9||e.jPlayer.browser.documentMode<9)){var a='<object id="'+this.internal.flash.id+'" classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000" width="0" height="0" tabindex="-1"></object>',o=['<param name="movie" value="'+this.internal.flash.swf+'" />','<param name="FlashVars" value="'+r+'" />','<param name="allowScriptAccess" value="always" />','<param name="bgcolor" value="'+this.options.backgroundColor+'" />','<param name="wmode" value="'+this.options.wmode+'" />'];i=document.createElement(a);for(var s=0;s<o.length;s++)i.appendChild(document.createElement(o[s]))}else{var l=function(e,t,n){var i=document.createElement("param");i.setAttribute("name",t),i.setAttribute("value",n),e.appendChild(i)};(i=document.createElement("object")).setAttribute("id",this.internal.flash.id),i.setAttribute("name",this.internal.flash.id),i.setAttribute("data",this.internal.flash.swf),i.setAttribute("type","application/x-shockwave-flash"),i.setAttribute("width","1"),i.setAttribute("height","1"),i.setAttribute("tabindex","-1"),l(i,"flashvars",r),l(i,"allowscriptaccess","always"),l(i,"bgcolor",this.options.backgroundColor),l(i,"wmode",this.options.wmode)}this.element.append(i),this.internal.flash.jq=e(i)}this.status.playbackRateEnabled=!(!this.html.used||this.flash.used)&&this._testPlaybackRate("audio"),this._updatePlaybackRate(),this.html.used&&(this.html.audio.available&&(this._addHtmlEventListeners(this.htmlElement.audio,this.html.audio),this.element.append(this.htmlElement.audio),this.internal.audio.jq=e("#"+this.internal.audio.id)),this.html.video.available&&(this._addHtmlEventListeners(this.htmlElement.video,this.html.video),this.element.append(this.htmlElement.video),this.internal.video.jq=e("#"+this.internal.video.id),this.internal.video.jq.css(this.status.nativeVideoControls?{width:this.status.width,height:this.status.height}:{width:"0px",height:"0px"}),this.internal.video.jq.bind("click.jPlayer",function(){n._trigger(e.jPlayer.event.click)}))),this.aurora.used,this.options.emulateHtml&&this._emulateHtmlBridge(),!this.html.used&&!this.aurora.used||this.flash.used||setTimeout(function(){n.internal.ready=!0,n.version.flash="n/a",n._trigger(e.jPlayer.event.repeat),n._trigger(e.jPlayer.event.ready)},100),this._updateNativeVideoControls(),this.css.jq.videoPlay.length&&this.css.jq.videoPlay.hide(),e.jPlayer.prototype.count++},destroy:function(){this.clearMedia(),this._removeUiClass(),this.css.jq.currentTime.length&&this.css.jq.currentTime.text(""),this.css.jq.duration.length&&this.css.jq.duration.text(""),e.each(this.css.jq,function(e,t){t.length&&t.unbind(".jPlayer")}),this.internal.poster.jq.unbind(".jPlayer"),this.internal.video.jq&&this.internal.video.jq.unbind(".jPlayer"),this._fullscreenRemoveEventListeners(),this===e.jPlayer.focus&&(e.jPlayer.focus=null),this.options.emulateHtml&&this._destroyHtmlBridge(),this.element.removeData("jPlayer"),this.element.unbind(".jPlayer"),this.element.empty(),delete this.instances[this.internal.instance]},destroyRemoved:function(){var t=this;e.each(this.instances,function(e,n){t.element!==n&&(n.data("jPlayer")||(n.jPlayer("destroy"),delete t.instances[e]))})},enable:function(){},disable:function(){},_testCanPlayType:function(e){try{return e.canPlayType(this.format.mp3.codec),!0}catch(e){return!1}},_testPlaybackRate:function(e){var t;e="string"==typeof e?e:"audio",t=document.createElement(e);try{return"playbackRate"in t&&(t.playbackRate=.5,.5===t.playbackRate)}catch(e){return!1}},_uaBlocklist:function(t){var n=navigator.userAgent.toLowerCase(),i=!1;return e.each(t,function(e,t){return t&&t.test(n)?(i=!0,!1):void 0}),i},_restrictNativeVideoControls:function(){this.require.audio&&this.status.nativeVideoControls&&(this.status.nativeVideoControls=!1,this.status.noFullWindow=!0)},_updateNativeVideoControls:function(){this.html.video.available&&this.html.used&&(this.htmlElement.video.controls=this.status.nativeVideoControls,this._updateAutohide(),this.status.nativeVideoControls&&this.require.video?(this.internal.poster.jq.hide(),this.internal.video.jq.css({width:this.status.width,height:this.status.height})):this.status.waitForPlay&&this.status.video&&(this.internal.poster.jq.show(),this.internal.video.jq.css({width:"0px",height:"0px"})))},_addHtmlEventListeners:function(t,n){var i=this;t.preload=this.options.preload,t.muted=this.options.muted,t.volume=this.options.volume,this.status.playbackRateEnabled&&(t.defaultPlaybackRate=this.options.defaultPlaybackRate,t.playbackRate=this.options.playbackRate),t.addEventListener("progress",function(){n.gate&&(i.internal.cmdsIgnored&&this.readyState>0&&(i.internal.cmdsIgnored=!1),i._getHtmlStatus(t),i._updateInterface(),i._trigger(e.jPlayer.event.progress))},!1),t.addEventListener("loadeddata",function(){n.gate&&(i.androidFix.setMedia=!1,i.androidFix.play&&(i.androidFix.play=!1,i.play(i.androidFix.time)),i.androidFix.pause&&(i.androidFix.pause=!1,i.pause(i.androidFix.time)),i._trigger(e.jPlayer.event.loadeddata))},!1),t.addEventListener("timeupdate",function(){n.gate&&(i._getHtmlStatus(t),i._updateInterface(),i._trigger(e.jPlayer.event.timeupdate))},!1),t.addEventListener("durationchange",function(){n.gate&&(i._getHtmlStatus(t),i._updateInterface(),i._trigger(e.jPlayer.event.durationchange))},!1),t.addEventListener("play",function(){n.gate&&(i._updateButtons(!0),i._html_checkWaitForPlay(),i._trigger(e.jPlayer.event.play))},!1),t.addEventListener("playing",function(){n.gate&&(i._updateButtons(!0),i._seeked(),i._trigger(e.jPlayer.event.playing))},!1),t.addEventListener("pause",function(){n.gate&&(i._updateButtons(!1),i._trigger(e.jPlayer.event.pause))},!1),t.addEventListener("waiting",function(){n.gate&&(i._seeking(),i._trigger(e.jPlayer.event.waiting))},!1),t.addEventListener("seeking",function(){n.gate&&(i._seeking(),i._trigger(e.jPlayer.event.seeking))},!1),t.addEventListener("seeked",function(){n.gate&&(i._seeked(),i._trigger(e.jPlayer.event.seeked))},!1),t.addEventListener("volumechange",function(){n.gate&&(i.options.volume=t.volume,i.options.muted=t.muted,i._updateMute(),i._updateVolume(),i._trigger(e.jPlayer.event.volumechange))},!1),t.addEventListener("ratechange",function(){n.gate&&(i.options.defaultPlaybackRate=t.defaultPlaybackRate,i.options.playbackRate=t.playbackRate,i._updatePlaybackRate(),i._trigger(e.jPlayer.event.ratechange))},!1),t.addEventListener("suspend",function(){n.gate&&(i._seeked(),i._trigger(e.jPlayer.event.suspend))},!1),t.addEventListener("ended",function(){n.gate&&(e.jPlayer.browser.webkit||(i.htmlElement.media.currentTime=0),i.htmlElement.media.pause(),i._updateButtons(!1),i._getHtmlStatus(t,!0),i._updateInterface(),i._trigger(e.jPlayer.event.ended))},!1),t.addEventListener("error",function(){n.gate&&(i._updateButtons(!1),i._seeked(),i.status.srcSet&&(clearTimeout(i.internal.htmlDlyCmdId),i.status.waitForLoad=!0,i.status.waitForPlay=!0,i.status.video&&!i.status.nativeVideoControls&&i.internal.video.jq.css({width:"0px",height:"0px"}),i._validString(i.status.media.poster)&&!i.status.nativeVideoControls&&i.internal.poster.jq.show(),i.css.jq.videoPlay.length&&i.css.jq.videoPlay.show(),i._error({type:e.jPlayer.error.URL,context:i.status.src,message:e.jPlayer.errorMsg.URL,hint:e.jPlayer.errorHint.URL})))},!1),e.each(e.jPlayer.htmlEvent,function(r,a){t.addEventListener(this,function(){n.gate&&i._trigger(e.jPlayer.event[a])},!1)})},_addAuroraEventListeners:function(t,n){var i=this;t.volume=100*this.options.volume,t.on("progress",function(){n.gate&&(i.internal.cmdsIgnored&&this.readyState>0&&(i.internal.cmdsIgnored=!1),i._getAuroraStatus(t),i._updateInterface(),i._trigger(e.jPlayer.event.progress),t.duration>0&&i._trigger(e.jPlayer.event.timeupdate))},!1),t.on("ready",function(){n.gate&&i._trigger(e.jPlayer.event.loadeddata)},!1),t.on("duration",function(){n.gate&&(i._getAuroraStatus(t),i._updateInterface(),i._trigger(e.jPlayer.event.durationchange))},!1),t.on("end",function(){n.gate&&(i._updateButtons(!1),i._getAuroraStatus(t,!0),i._updateInterface(),i._trigger(e.jPlayer.event.ended))},!1),t.on("error",function(){n.gate&&(i._updateButtons(!1),i._seeked(),i.status.srcSet&&(i.status.waitForLoad=!0,i.status.waitForPlay=!0,i.status.video&&!i.status.nativeVideoControls&&i.internal.video.jq.css({width:"0px",height:"0px"}),i._validString(i.status.media.poster)&&!i.status.nativeVideoControls&&i.internal.poster.jq.show(),i.css.jq.videoPlay.length&&i.css.jq.videoPlay.show(),i._error({type:e.jPlayer.error.URL,context:i.status.src,message:e.jPlayer.errorMsg.URL,hint:e.jPlayer.errorHint.URL})))},!1)},_getHtmlStatus:function(e,t){var n=0,i=0,r=0,a=0;isFinite(e.duration)&&(this.status.duration=e.duration),n=e.currentTime,i=this.status.duration>0?100*n/this.status.duration:0,"object"==typeof e.seekable&&e.seekable.length>0?(r=this.status.duration>0?100*e.seekable.end(e.seekable.length-1)/this.status.duration:100,a=this.status.duration>0?100*e.currentTime/e.seekable.end(e.seekable.length-1):0):(r=100,a=i),t&&(n=0,a=0,i=0),this.status.seekPercent=r,this.status.currentPercentRelative=a,this.status.currentPercentAbsolute=i,this.status.currentTime=n,this.status.remaining=this.status.duration-this.status.currentTime,this.status.videoWidth=e.videoWidth,this.status.videoHeight=e.videoHeight,this.status.readyState=e.readyState,this.status.networkState=e.networkState,this.status.playbackRate=e.playbackRate,this.status.ended=e.ended},_getAuroraStatus:function(e,t){var n=0,i=0,r=0,a=0;this.status.duration=e.duration/1e3,n=e.currentTime/1e3,i=this.status.duration>0?100*n/this.status.duration:0,e.buffered>0?(r=this.status.duration>0?e.buffered*this.status.duration/this.status.duration:100,a=this.status.duration>0?n/(e.buffered*this.status.duration):0):(r=100,a=i),t&&(n=0,a=0,i=0),this.status.seekPercent=r,this.status.currentPercentRelative=a,this.status.currentPercentAbsolute=i,this.status.currentTime=n,this.status.remaining=this.status.duration-this.status.currentTime,this.status.readyState=4,this.status.networkState=0,this.status.playbackRate=1,this.status.ended=!1},_resetStatus:function(){this.status=e.extend({},this.status,e.jPlayer.prototype.status)},_trigger:function(t,n,i){var r=e.Event(t);r.jPlayer={},r.jPlayer.version=e.extend({},this.version),r.jPlayer.options=e.extend(!0,{},this.options),r.jPlayer.status=e.extend(!0,{},this.status),r.jPlayer.html=e.extend(!0,{},this.html),r.jPlayer.aurora=e.extend(!0,{},this.aurora),r.jPlayer.flash=e.extend(!0,{},this.flash),n&&(r.jPlayer.error=e.extend({},n)),i&&(r.jPlayer.warning=e.extend({},i)),this.element.trigger(r)},jPlayerFlashEvent:function(t,n){if(t===e.jPlayer.event.ready)if(this.internal.ready){if(this.flash.gate){if(this.status.srcSet){var i=this.status.currentTime,r=this.status.paused;this.setMedia(this.status.media),this.volumeWorker(this.options.volume),i>0&&(r?this.pause(i):this.play(i))}this._trigger(e.jPlayer.event.flashreset)}}else this.internal.ready=!0,this.internal.flash.jq.css({width:"0px",height:"0px"}),this.version.flash=n.version,this.version.needFlash!==this.version.flash&&this._error({type:e.jPlayer.error.VERSION,context:this.version.flash,message:e.jPlayer.errorMsg.VERSION+this.version.flash,hint:e.jPlayer.errorHint.VERSION}),this._trigger(e.jPlayer.event.repeat),this._trigger(t);if(this.flash.gate)switch(t){case e.jPlayer.event.progress:case e.jPlayer.event.timeupdate:this._getFlashStatus(n),this._updateInterface(),this._trigger(t);break;case e.jPlayer.event.play:this._seeked(),this._updateButtons(!0),this._trigger(t);break;case e.jPlayer.event.pause:case e.jPlayer.event.ended:this._updateButtons(!1),this._trigger(t);break;case e.jPlayer.event.click:this._trigger(t);break;case e.jPlayer.event.error:this.status.waitForLoad=!0,this.status.waitForPlay=!0,this.status.video&&this.internal.flash.jq.css({width:"0px",height:"0px"}),this._validString(this.status.media.poster)&&this.internal.poster.jq.show(),this.css.jq.videoPlay.length&&this.status.video&&this.css.jq.videoPlay.show(),this.status.video?this._flash_setVideo(this.status.media):this._flash_setAudio(this.status.media),this._updateButtons(!1),this._error({type:e.jPlayer.error.URL,context:n.src,message:e.jPlayer.errorMsg.URL,hint:e.jPlayer.errorHint.URL});break;case e.jPlayer.event.seeking:this._seeking(),this._trigger(t);break;case e.jPlayer.event.seeked:this._seeked(),this._trigger(t);break;case e.jPlayer.event.ready:break;default:this._trigger(t)}return!1},_getFlashStatus:function(e){this.status.seekPercent=e.seekPercent,this.status.currentPercentRelative=e.currentPercentRelative,this.status.currentPercentAbsolute=e.currentPercentAbsolute,this.status.currentTime=e.currentTime,this.status.duration=e.duration,this.status.remaining=e.duration-e.currentTime,this.status.videoWidth=e.videoWidth,this.status.videoHeight=e.videoHeight,this.status.readyState=4,this.status.networkState=0,this.status.playbackRate=1,this.status.ended=!1},_updateButtons:function(e){e===t?e=!this.status.paused:this.status.paused=!e,e?this.addStateClass("playing"):this.removeStateClass("playing"),!this.status.noFullWindow&&this.options.fullWindow?this.addStateClass("fullScreen"):this.removeStateClass("fullScreen"),this.options.loop?this.addStateClass("looped"):this.removeStateClass("looped"),this.css.jq.play.length&&this.css.jq.pause.length&&(e?(this.css.jq.play.hide(),this.css.jq.pause.show()):(this.css.jq.play.show(),this.css.jq.pause.hide())),this.css.jq.restoreScreen.length&&this.css.jq.fullScreen.length&&(this.status.noFullWindow?(this.css.jq.fullScreen.hide(),this.css.jq.restoreScreen.hide()):this.options.fullWindow?(this.css.jq.fullScreen.hide(),this.css.jq.restoreScreen.show()):(this.css.jq.fullScreen.show(),this.css.jq.restoreScreen.hide())),this.css.jq.repeat.length&&this.css.jq.repeatOff.length&&(this.options.loop?(this.css.jq.repeat.hide(),this.css.jq.repeatOff.show()):(this.css.jq.repeat.show(),this.css.jq.repeatOff.hide()))},_updateInterface:function(){this.css.jq.seekBar.length&&this.css.jq.seekBar.width(this.status.seekPercent+"%"),this.css.jq.playBar.length&&(this.options.smoothPlayBar?this.css.jq.playBar.stop().animate({width:this.status.currentPercentAbsolute+"%"},250,"linear"):this.css.jq.playBar.width(this.status.currentPercentRelative+"%")),this.css.jq.currentTime.length&&this._convertTime(this.status.currentTime)!==this.css.jq.currentTime.text()&&this.css.jq.currentTime.text(this._convertTime(this.status.currentTime));var e="",t=this.status.duration,n=this.status.remaining;this.css.jq.duration.length&&("string"==typeof this.status.media.duration?e=this.status.media.duration:("number"==typeof this.status.media.duration&&(n=(t=this.status.media.duration)-this.status.currentTime),e=this.options.remainingDuration?(n>0?"-":"")+this._convertTime(n):this._convertTime(t)),e!==this.css.jq.duration.text()&&this.css.jq.duration.text(e))},_convertTime:n.prototype.time,_seeking:function(){this.css.jq.seekBar.length&&this.css.jq.seekBar.addClass("jp-seeking-bg"),this.addStateClass("seeking")},_seeked:function(){this.css.jq.seekBar.length&&this.css.jq.seekBar.removeClass("jp-seeking-bg"),this.removeStateClass("seeking")},_resetGate:function(){this.html.audio.gate=!1,this.html.video.gate=!1,this.aurora.gate=!1,this.flash.gate=!1},_resetActive:function(){this.html.active=!1,this.aurora.active=!1,this.flash.active=!1},_escapeHtml:function(e){return e.split("&").join("&amp;").split("<").join("&lt;").split(">").join("&gt;").split('"').join("&quot;")},_qualifyURL:function(e){var t=document.createElement("div");return t.innerHTML='<a href="'+this._escapeHtml(e)+'">x</a>',t.firstChild.href},_absoluteMediaUrls:function(t){var n=this;return e.each(t,function(e,i){i&&n.format[e]&&"data:"!==i.substr(0,5)&&(t[e]=n._qualifyURL(i))}),t},addStateClass:function(e){this.ancestorJq.length&&this.ancestorJq.addClass(this.options.stateClass[e])},removeStateClass:function(e){this.ancestorJq.length&&this.ancestorJq.removeClass(this.options.stateClass[e])},setMedia:function(t){var n=this,i=!1,r=this.status.media.poster!==t.poster;this._resetMedia(),this._resetGate(),this._resetActive(),this.androidFix.setMedia=!1,this.androidFix.play=!1,this.androidFix.pause=!1,t=this._absoluteMediaUrls(t),e.each(this.formats,function(r,a){var o="video"===n.format[a].media;return e.each(n.solutions,function(r,s){if(n[s].support[a]&&n._validString(t[a])){var l="html"===s,u="aurora"===s;return o?(l?(n.html.video.gate=!0,n._html_setVideo(t),n.html.active=!0):(n.flash.gate=!0,n._flash_setVideo(t),n.flash.active=!0),n.css.jq.videoPlay.length&&n.css.jq.videoPlay.show(),n.status.video=!0):(l?(n.html.audio.gate=!0,n._html_setAudio(t),n.html.active=!0,e.jPlayer.platform.android&&(n.androidFix.setMedia=!0)):u?(n.aurora.gate=!0,n._aurora_setAudio(t),n.aurora.active=!0):(n.flash.gate=!0,n._flash_setAudio(t),n.flash.active=!0),n.css.jq.videoPlay.length&&n.css.jq.videoPlay.hide(),n.status.video=!1),i=!0,!1}}),!i&&void 0}),i?(this.status.nativeVideoControls&&this.html.video.gate||this._validString(t.poster)&&(r?this.htmlElement.poster.src=t.poster:this.internal.poster.jq.show()),"string"==typeof t.title&&(this.css.jq.title.length&&this.css.jq.title.html(t.title),this.htmlElement.audio&&this.htmlElement.audio.setAttribute("title",t.title),this.htmlElement.video&&this.htmlElement.video.setAttribute("title",t.title)),this.status.srcSet=!0,this.status.media=e.extend({},t),this._updateButtons(!1),this._updateInterface(),this._trigger(e.jPlayer.event.setmedia)):this._error({type:e.jPlayer.error.NO_SUPPORT,context:"{supplied:'"+this.options.supplied+"'}",message:e.jPlayer.errorMsg.NO_SUPPORT,hint:e.jPlayer.errorHint.NO_SUPPORT})},_resetMedia:function(){this._resetStatus(),this._updateButtons(!1),this._updateInterface(),this._seeked(),this.internal.poster.jq.hide(),clearTimeout(this.internal.htmlDlyCmdId),this.html.active?this._html_resetMedia():this.aurora.active?this._aurora_resetMedia():this.flash.active&&this._flash_resetMedia()},clearMedia:function(){this._resetMedia(),this.html.active?this._html_clearMedia():this.aurora.active?this._aurora_clearMedia():this.flash.active&&this._flash_clearMedia(),this._resetGate(),this._resetActive()},load:function(){this.status.srcSet?this.html.active?this._html_load():this.aurora.active?this._aurora_load():this.flash.active&&this._flash_load():this._urlNotSetError("load")},focus:function(){this.options.keyEnabled&&(e.jPlayer.focus=this)},play:function(e){"object"==typeof e&&this.options.useStateClassSkin&&!this.status.paused?this.pause(e):(e="number"==typeof e?e:NaN,this.status.srcSet?(this.focus(),this.html.active?this._html_play(e):this.aurora.active?this._aurora_play(e):this.flash.active&&this._flash_play(e)):this._urlNotSetError("play"))},videoPlay:function(){this.play()},pause:function(e){e="number"==typeof e?e:NaN,this.status.srcSet?this.html.active?this._html_pause(e):this.aurora.active?this._aurora_pause(e):this.flash.active&&this._flash_pause(e):this._urlNotSetError("pause")},tellOthers:function(t,n){var i=this,r="function"==typeof n,a=Array.prototype.slice.call(arguments);"string"==typeof t&&(r&&a.splice(1,1),e.jPlayer.prototype.destroyRemoved(),e.each(this.instances,function(){i.element!==this&&(!r||n.call(this.data("jPlayer"),i))&&this.jPlayer.apply(this,a)}))},pauseOthers:function(e){this.tellOthers("pause",function(){return this.status.srcSet},e)},stop:function(){this.status.srcSet?this.html.active?this._html_pause(0):this.aurora.active?this._aurora_pause(0):this.flash.active&&this._flash_pause(0):this._urlNotSetError("stop")},playHead:function(e){e=this._limitValue(e,0,100),this.status.srcSet?this.html.active?this._html_playHead(e):this.aurora.active?this._aurora_playHead(e):this.flash.active&&this._flash_playHead(e):this._urlNotSetError("playHead")},_muted:function(e){this.mutedWorker(e),this.options.globalVolume&&this.tellOthers("mutedWorker",function(){return this.options.globalVolume},e)},mutedWorker:function(t){this.options.muted=t,this.html.used&&this._html_setProperty("muted",t),this.aurora.used&&this._aurora_mute(t),this.flash.used&&this._flash_mute(t),this.html.video.gate||this.html.audio.gate||(this._updateMute(t),this._updateVolume(this.options.volume),this._trigger(e.jPlayer.event.volumechange))},mute:function(e){"object"==typeof e&&this.options.useStateClassSkin&&this.options.muted?this._muted(!1):(e=e===t||!!e,this._muted(e))},unmute:function(e){e=e===t||!!e,this._muted(!e)},_updateMute:function(e){e===t&&(e=this.options.muted),e?this.addStateClass("muted"):this.removeStateClass("muted"),this.css.jq.mute.length&&this.css.jq.unmute.length&&(this.status.noVolume?(this.css.jq.mute.hide(),this.css.jq.unmute.hide()):e?(this.css.jq.mute.hide(),this.css.jq.unmute.show()):(this.css.jq.mute.show(),this.css.jq.unmute.hide()))},volume:function(e){this.volumeWorker(e),this.options.globalVolume&&this.tellOthers("volumeWorker",function(){return this.options.globalVolume},e)},volumeWorker:function(t){t=this._limitValue(t,0,1),this.options.volume=t,this.html.used&&this._html_setProperty("volume",t),this.aurora.used&&this._aurora_volume(t),this.flash.used&&this._flash_volume(t),this.html.video.gate||this.html.audio.gate||(this._updateVolume(t),this._trigger(e.jPlayer.event.volumechange))},volumeBar:function(t){if(this.css.jq.volumeBar.length){var n=e(t.currentTarget),i=n.offset(),r=t.pageX-i.left,a=n.width(),o=n.height()-t.pageY+i.top,s=n.height();this.volume(this.options.verticalVolume?o/s:r/a)}this.options.muted&&this._muted(!1)},_updateVolume:function(e){e===t&&(e=this.options.volume),e=this.options.muted?0:e,this.status.noVolume?(this.addStateClass("noVolume"),this.css.jq.volumeBar.length&&this.css.jq.volumeBar.hide(),this.css.jq.volumeBarValue.length&&this.css.jq.volumeBarValue.hide(),this.css.jq.volumeMax.length&&this.css.jq.volumeMax.hide()):(this.removeStateClass("noVolume"),this.css.jq.volumeBar.length&&this.css.jq.volumeBar.show(),this.css.jq.volumeBarValue.length&&(this.css.jq.volumeBarValue.show(),this.css.jq.volumeBarValue[this.options.verticalVolume?"height":"width"](100*e+"%")),this.css.jq.volumeMax.length&&this.css.jq.volumeMax.show())},volumeMax:function(){this.volume(1),this.options.muted&&this._muted(!1)},_cssSelectorAncestor:function(t){var n=this;this.options.cssSelectorAncestor=t,this._removeUiClass(),this.ancestorJq=t?e(t):[],t&&1!==this.ancestorJq.length&&this._warning({type:e.jPlayer.warning.CSS_SELECTOR_COUNT,context:t,message:e.jPlayer.warningMsg.CSS_SELECTOR_COUNT+this.ancestorJq.length+" found for cssSelectorAncestor.",hint:e.jPlayer.warningHint.CSS_SELECTOR_COUNT}),this._addUiClass(),e.each(this.options.cssSelector,function(e,t){n._cssSelector(e,t)}),this._updateInterface(),this._updateButtons(),this._updateAutohide(),this._updateVolume(),this._updateMute()},_cssSelector:function(t,n){var i=this;"string"==typeof n?e.jPlayer.prototype.options.cssSelector[t]?(this.css.jq[t]&&this.css.jq[t].length&&this.css.jq[t].unbind(".jPlayer"),this.options.cssSelector[t]=n,this.css.cs[t]=this.options.cssSelectorAncestor+" "+n,this.css.jq[t]=n?e(this.css.cs[t]):[],this.css.jq[t].length&&this[t]&&this.css.jq[t].bind("click.jPlayer",function(n){n.preventDefault(),i[t](n),i.options.autoBlur?e(this).blur():e(this).focus()}),n&&1!==this.css.jq[t].length&&this._warning({type:e.jPlayer.warning.CSS_SELECTOR_COUNT,context:this.css.cs[t],message:e.jPlayer.warningMsg.CSS_SELECTOR_COUNT+this.css.jq[t].length+" found for "+t+" method.",hint:e.jPlayer.warningHint.CSS_SELECTOR_COUNT})):this._warning({type:e.jPlayer.warning.CSS_SELECTOR_METHOD,context:t,message:e.jPlayer.warningMsg.CSS_SELECTOR_METHOD,hint:e.jPlayer.warningHint.CSS_SELECTOR_METHOD}):this._warning({type:e.jPlayer.warning.CSS_SELECTOR_STRING,context:n,message:e.jPlayer.warningMsg.CSS_SELECTOR_STRING,hint:e.jPlayer.warningHint.CSS_SELECTOR_STRING})},duration:function(e){this.options.toggleDuration&&(this.options.captureDuration&&e.stopPropagation(),this._setOption("remainingDuration",!this.options.remainingDuration))},seekBar:function(t){if(this.css.jq.seekBar.length){var n=e(t.currentTarget),i=n.offset(),r=100*(t.pageX-i.left)/n.width();this.playHead(r)}},playbackRate:function(e){this._setOption("playbackRate",e)},playbackRateBar:function(t){if(this.css.jq.playbackRateBar.length){var n,i=e(t.currentTarget),r=i.offset(),a=t.pageX-r.left,o=i.width(),s=i.height()-t.pageY+r.top,l=i.height();n=(this.options.verticalPlaybackRate?s/l:a/o)*(this.options.maxPlaybackRate-this.options.minPlaybackRate)+this.options.minPlaybackRate,this.playbackRate(n)}},_updatePlaybackRate:function(){var e=(this.options.playbackRate-this.options.minPlaybackRate)/(this.options.maxPlaybackRate-this.options.minPlaybackRate);this.status.playbackRateEnabled?(this.css.jq.playbackRateBar.length&&this.css.jq.playbackRateBar.show(),this.css.jq.playbackRateBarValue.length&&(this.css.jq.playbackRateBarValue.show(),this.css.jq.playbackRateBarValue[this.options.verticalPlaybackRate?"height":"width"](100*e+"%"))):(this.css.jq.playbackRateBar.length&&this.css.jq.playbackRateBar.hide(),this.css.jq.playbackRateBarValue.length&&this.css.jq.playbackRateBarValue.hide())},repeat:function(e){var t="object"==typeof e;this._loop(!(t&&this.options.useStateClassSkin&&this.options.loop))},repeatOff:function(){this._loop(!1)},_loop:function(t){this.options.loop!==t&&(this.options.loop=t,this._updateButtons(),this._trigger(e.jPlayer.event.repeat))},option:function(n,i){var r=n;if(0===arguments.length)return e.extend(!0,{},this.options);if("string"==typeof n){var a=n.split(".");if(i===t){for(var o=e.extend(!0,{},this.options),s=0;s<a.length;s++){if(o[a[s]]===t)return this._warning({type:e.jPlayer.warning.OPTION_KEY,context:n,message:e.jPlayer.warningMsg.OPTION_KEY,hint:e.jPlayer.warningHint.OPTION_KEY}),t;o=o[a[s]]}return o}for(var l=r={},u=0;u<a.length;u++)u<a.length-1?(l[a[u]]={},l=l[a[u]]):l[a[u]]=i}return this._setOptions(r),this},_setOptions:function(t){var n=this;return e.each(t,function(e,t){n._setOption(e,t)}),this},_setOption:function(t,n){var i=this;switch(t){case"volume":this.volume(n);break;case"muted":this._muted(n);break;case"globalVolume":this.options[t]=n;break;case"cssSelectorAncestor":this._cssSelectorAncestor(n);break;case"cssSelector":e.each(n,function(e,t){i._cssSelector(e,t)});break;case"playbackRate":this.options[t]=n=this._limitValue(n,this.options.minPlaybackRate,this.options.maxPlaybackRate),this.html.used&&this._html_setProperty("playbackRate",n),this._updatePlaybackRate();break;case"defaultPlaybackRate":this.options[t]=n=this._limitValue(n,this.options.minPlaybackRate,this.options.maxPlaybackRate),this.html.used&&this._html_setProperty("defaultPlaybackRate",n),this._updatePlaybackRate();break;case"minPlaybackRate":this.options[t]=n=this._limitValue(n,.1,this.options.maxPlaybackRate-.1),this._updatePlaybackRate();break;case"maxPlaybackRate":this.options[t]=n=this._limitValue(n,this.options.minPlaybackRate+.1,16),this._updatePlaybackRate();break;case"fullScreen":if(this.options[t]!==n){var r=e.jPlayer.nativeFeatures.fullscreen.used.webkitVideo;(!r||r&&!this.status.waitForPlay)&&(r||(this.options[t]=n),n?this._requestFullscreen():this._exitFullscreen(),r||this._setOption("fullWindow",n))}break;case"fullWindow":this.options[t]!==n&&(this._removeUiClass(),this.options[t]=n,this._refreshSize());break;case"size":this.options.fullWindow||this.options[t].cssClass===n.cssClass||this._removeUiClass(),this.options[t]=e.extend({},this.options[t],n),this._refreshSize();break;case"sizeFull":this.options.fullWindow&&this.options[t].cssClass!==n.cssClass&&this._removeUiClass(),this.options[t]=e.extend({},this.options[t],n),this._refreshSize();break;case"autohide":this.options[t]=e.extend({},this.options[t],n),this._updateAutohide();break;case"loop":this._loop(n);break;case"remainingDuration":this.options[t]=n,this._updateInterface();break;case"toggleDuration":this.options[t]=n;break;case"nativeVideoControls":this.options[t]=e.extend({},this.options[t],n),this.status.nativeVideoControls=this._uaBlocklist(this.options.nativeVideoControls),this._restrictNativeVideoControls(),this._updateNativeVideoControls();break;case"noFullWindow":this.options[t]=e.extend({},this.options[t],n),this.status.nativeVideoControls=this._uaBlocklist(this.options.nativeVideoControls),this.status.noFullWindow=this._uaBlocklist(this.options.noFullWindow),this._restrictNativeVideoControls(),this._updateButtons();break;case"noVolume":this.options[t]=e.extend({},this.options[t],n),this.status.noVolume=this._uaBlocklist(this.options.noVolume),this._updateVolume(),this._updateMute();break;case"emulateHtml":this.options[t]!==n&&(this.options[t]=n,n?this._emulateHtmlBridge():this._destroyHtmlBridge());break;case"timeFormat":this.options[t]=e.extend({},this.options[t],n);break;case"keyEnabled":this.options[t]=n,n||this!==e.jPlayer.focus||(e.jPlayer.focus=null);break;case"keyBindings":this.options[t]=e.extend(!0,{},this.options[t],n);break;case"audioFullScreen":this.options[t]=n;break;case"autoBlur":this.options[t]=n}return this},_refreshSize:function(){this._setSize(),this._addUiClass(),this._updateSize(),this._updateButtons(),this._updateAutohide(),this._trigger(e.jPlayer.event.resize)},_setSize:function(){this.options.fullWindow?(this.status.width=this.options.sizeFull.width,this.status.height=this.options.sizeFull.height,this.status.cssClass=this.options.sizeFull.cssClass):(this.status.width=this.options.size.width,this.status.height=this.options.size.height,this.status.cssClass=this.options.size.cssClass),this.element.css({width:this.status.width,height:this.status.height})},_addUiClass:function(){this.ancestorJq.length&&this.ancestorJq.addClass(this.status.cssClass)},_removeUiClass:function(){this.ancestorJq.length&&this.ancestorJq.removeClass(this.status.cssClass)},_updateSize:function(){this.internal.poster.jq.css({width:this.status.width,height:this.status.height}),!this.status.waitForPlay&&this.html.active&&this.status.video||this.html.video.available&&this.html.used&&this.status.nativeVideoControls?this.internal.video.jq.css({width:this.status.width,height:this.status.height}):!this.status.waitForPlay&&this.flash.active&&this.status.video&&this.internal.flash.jq.css({width:this.status.width,height:this.status.height})},_updateAutohide:function(){var e=this,t=".jPlayerAutohide",n="mousemove.jPlayer"+t,i=function(t){var n,i,r=!1;void 0!==e.internal.mouse?(n=e.internal.mouse.x-t.pageX,i=e.internal.mouse.y-t.pageY,r=Math.floor(n)>0||Math.floor(i)>0):r=!0,e.internal.mouse={x:t.pageX,y:t.pageY},r&&e.css.jq.gui.fadeIn(e.options.autohide.fadeIn,function(){clearTimeout(e.internal.autohideId),e.internal.autohideId=setTimeout(function(){e.css.jq.gui.fadeOut(e.options.autohide.fadeOut)},e.options.autohide.hold)})};this.css.jq.gui.length&&(this.css.jq.gui.stop(!0,!0),clearTimeout(this.internal.autohideId),delete this.internal.mouse,this.element.unbind(t),this.css.jq.gui.unbind(t),this.status.nativeVideoControls?this.css.jq.gui.hide():this.options.fullWindow&&this.options.autohide.full||!this.options.fullWindow&&this.options.autohide.restored?(this.element.bind(n,i),this.css.jq.gui.bind(n,i),this.css.jq.gui.hide()):this.css.jq.gui.show())},fullScreen:function(e){"object"==typeof e&&this.options.useStateClassSkin&&this.options.fullScreen?this._setOption("fullScreen",!1):this._setOption("fullScreen",!0)},restoreScreen:function(){this._setOption("fullScreen",!1)},_fullscreenAddEventListeners:function(){var t=this,n=e.jPlayer.nativeFeatures.fullscreen;n.api.fullscreenEnabled&&n.event.fullscreenchange&&("function"!=typeof this.internal.fullscreenchangeHandler&&(this.internal.fullscreenchangeHandler=function(){t._fullscreenchange()}),document.addEventListener(n.event.fullscreenchange,this.internal.fullscreenchangeHandler,!1))},_fullscreenRemoveEventListeners:function(){var t=e.jPlayer.nativeFeatures.fullscreen;this.internal.fullscreenchangeHandler&&document.removeEventListener(t.event.fullscreenchange,this.internal.fullscreenchangeHandler,!1)},_fullscreenchange:function(){this.options.fullScreen&&!e.jPlayer.nativeFeatures.fullscreen.api.fullscreenElement()&&this._setOption("fullScreen",!1)},_requestFullscreen:function(){var t=this.ancestorJq.length?this.ancestorJq[0]:this.element[0],n=e.jPlayer.nativeFeatures.fullscreen;n.used.webkitVideo&&(t=this.htmlElement.video),n.api.fullscreenEnabled&&n.api.requestFullscreen(t)},_exitFullscreen:function(){var t,n=e.jPlayer.nativeFeatures.fullscreen;n.used.webkitVideo&&(t=this.htmlElement.video),n.api.fullscreenEnabled&&n.api.exitFullscreen(t)},_html_initMedia:function(t){var n=e(this.htmlElement.media).empty();e.each(t.track||[],function(e,t){var i=document.createElement("track");i.setAttribute("kind",t.kind?t.kind:""),i.setAttribute("src",t.src?t.src:""),i.setAttribute("srclang",t.srclang?t.srclang:""),i.setAttribute("label",t.label?t.label:""),t.def&&i.setAttribute("default",t.def),n.append(i)}),this.htmlElement.media.src=this.status.src,"none"!==this.options.preload&&this._html_load(),this._trigger(e.jPlayer.event.timeupdate)},_html_setFormat:function(t){var n=this;e.each(this.formats,function(e,i){return n.html.support[i]&&t[i]?(n.status.src=t[i],n.status.format[i]=!0,n.status.formatType=i,!1):void 0})},_html_setAudio:function(e){this._html_setFormat(e),this.htmlElement.media=this.htmlElement.audio,this._html_initMedia(e)},_html_setVideo:function(e){this._html_setFormat(e),this.status.nativeVideoControls&&(this.htmlElement.video.poster=this._validString(e.poster)?e.poster:""),this.htmlElement.media=this.htmlElement.video,this._html_initMedia(e)},_html_resetMedia:function(){this.htmlElement.media&&(this.htmlElement.media.id!==this.internal.video.id||this.status.nativeVideoControls||this.internal.video.jq.css({width:"0px",height:"0px"}),this.htmlElement.media.pause())},_html_clearMedia:function(){this.htmlElement.media&&(this.htmlElement.media.src="about:blank",this.htmlElement.media.load())},_html_load:function(){this.status.waitForLoad&&(this.status.waitForLoad=!1,this.htmlElement.media.load()),clearTimeout(this.internal.htmlDlyCmdId)},_html_play:function(e){var t=this,n=this.htmlElement.media;if(this.androidFix.pause=!1,this._html_load(),this.androidFix.setMedia)this.androidFix.play=!0,this.androidFix.time=e;else if(isNaN(e))n.play();else{this.internal.cmdsIgnored&&n.play();try{if(n.seekable&&!("object"==typeof n.seekable&&n.seekable.length>0))throw 1;n.currentTime=e,n.play()}catch(n){return void(this.internal.htmlDlyCmdId=setTimeout(function(){t.play(e)},250))}}this._html_checkWaitForPlay()},_html_pause:function(e){var t=this,n=this.htmlElement.media;if(this.androidFix.play=!1,e>0?this._html_load():clearTimeout(this.internal.htmlDlyCmdId),n.pause(),this.androidFix.setMedia)this.androidFix.pause=!0,this.androidFix.time=e;else if(!isNaN(e))try{if(n.seekable&&!("object"==typeof n.seekable&&n.seekable.length>0))throw 1;n.currentTime=e}catch(n){return void(this.internal.htmlDlyCmdId=setTimeout(function(){t.pause(e)},250))}e>0&&this._html_checkWaitForPlay()},_html_playHead:function(e){var t=this,n=this.htmlElement.media;this._html_load();try{if("object"==typeof n.seekable&&n.seekable.length>0)n.currentTime=e*n.seekable.end(n.seekable.length-1)/100;else{if(!(n.duration>0)||isNaN(n.duration))throw"e";n.currentTime=e*n.duration/100}}catch(n){return void(this.internal.htmlDlyCmdId=setTimeout(function(){t.playHead(e)},250))}this.status.waitForLoad||this._html_checkWaitForPlay()},_html_checkWaitForPlay:function(){this.status.waitForPlay&&(this.status.waitForPlay=!1,this.css.jq.videoPlay.length&&this.css.jq.videoPlay.hide(),this.status.video&&(this.internal.poster.jq.hide(),this.internal.video.jq.css({width:this.status.width,height:this.status.height})))},_html_setProperty:function(e,t){this.html.audio.available&&(this.htmlElement.audio[e]=t),this.html.video.available&&(this.htmlElement.video[e]=t)},_aurora_setAudio:function(t){var n=this;e.each(this.formats,function(e,i){return n.aurora.support[i]&&t[i]?(n.status.src=t[i],n.status.format[i]=!0,n.status.formatType=i,!1):void 0}),this.aurora.player=new AV.Player.fromURL(this.status.src),this._addAuroraEventListeners(this.aurora.player,this.aurora),"auto"===this.options.preload&&(this._aurora_load(),this.status.waitForLoad=!1)},_aurora_resetMedia:function(){this.aurora.player&&this.aurora.player.stop()},_aurora_clearMedia:function(){},_aurora_load:function(){this.status.waitForLoad&&(this.status.waitForLoad=!1,this.aurora.player.preload())},_aurora_play:function(t){this.status.waitForLoad||isNaN(t)||this.aurora.player.seek(t),this.aurora.player.playing||this.aurora.player.play(),this.status.waitForLoad=!1,this._aurora_checkWaitForPlay(),this._updateButtons(!0),this._trigger(e.jPlayer.event.play)},_aurora_pause:function(t){isNaN(t)||this.aurora.player.seek(1e3*t),this.aurora.player.pause(),t>0&&this._aurora_checkWaitForPlay(),this._updateButtons(!1),this._trigger(e.jPlayer.event.pause)},_aurora_playHead:function(e){this.aurora.player.duration>0&&this.aurora.player.seek(e*this.aurora.player.duration/100),this.status.waitForLoad||this._aurora_checkWaitForPlay()},_aurora_checkWaitForPlay:function(){this.status.waitForPlay&&(this.status.waitForPlay=!1)},_aurora_volume:function(e){this.aurora.player.volume=100*e},_aurora_mute:function(e){e?(this.aurora.properties.lastvolume=this.aurora.player.volume,this.aurora.player.volume=0):this.aurora.player.volume=this.aurora.properties.lastvolume,this.aurora.properties.muted=e},_flash_setAudio:function(t){var n=this;try{e.each(this.formats,function(e,i){if(n.flash.support[i]&&t[i]){switch(i){case"m4a":case"fla":n._getMovie().fl_setAudio_m4a(t[i]);break;case"mp3":n._getMovie().fl_setAudio_mp3(t[i]);break;case"rtmpa":n._getMovie().fl_setAudio_rtmp(t[i])}return n.status.src=t[i],n.status.format[i]=!0,n.status.formatType=i,!1}}),"auto"===this.options.preload&&(this._flash_load(),this.status.waitForLoad=!1)}catch(e){this._flashError(e)}},_flash_setVideo:function(t){var n=this;try{e.each(this.formats,function(e,i){if(n.flash.support[i]&&t[i]){switch(i){case"m4v":case"flv":n._getMovie().fl_setVideo_m4v(t[i]);break;case"rtmpv":n._getMovie().fl_setVideo_rtmp(t[i])}return n.status.src=t[i],n.status.format[i]=!0,n.status.formatType=i,!1}}),"auto"===this.options.preload&&(this._flash_load(),this.status.waitForLoad=!1)}catch(e){this._flashError(e)}},_flash_resetMedia:function(){this.internal.flash.jq.css({width:"0px",height:"0px"}),this._flash_pause(NaN)},_flash_clearMedia:function(){try{this._getMovie().fl_clearMedia()}catch(e){this._flashError(e)}},_flash_load:function(){try{this._getMovie().fl_load()}catch(e){this._flashError(e)}this.status.waitForLoad=!1},_flash_play:function(e){try{this._getMovie().fl_play(e)}catch(e){this._flashError(e)}this.status.waitForLoad=!1,this._flash_checkWaitForPlay()},_flash_pause:function(e){try{this._getMovie().fl_pause(e)}catch(e){this._flashError(e)}e>0&&(this.status.waitForLoad=!1,this._flash_checkWaitForPlay())},_flash_playHead:function(e){try{this._getMovie().fl_play_head(e)}catch(e){this._flashError(e)}this.status.waitForLoad||this._flash_checkWaitForPlay()},_flash_checkWaitForPlay:function(){this.status.waitForPlay&&(this.status.waitForPlay=!1,this.css.jq.videoPlay.length&&this.css.jq.videoPlay.hide(),this.status.video&&(this.internal.poster.jq.hide(),this.internal.flash.jq.css({width:this.status.width,height:this.status.height})))},_flash_volume:function(e){try{this._getMovie().fl_volume(e)}catch(e){this._flashError(e)}},_flash_mute:function(e){try{this._getMovie().fl_mute(e)}catch(e){this._flashError(e)}},_getMovie:function(){return document[this.internal.flash.id]},_getFlashPluginVersion:function(){var e,t=0;if(window.ActiveXObject)try{if(e=new ActiveXObject("ShockwaveFlash.ShockwaveFlash")){var n=e.GetVariable("$version");n&&(n=n.split(" ")[1].split(","),t=parseInt(n[0],10)+"."+parseInt(n[1],10))}}catch(e){}else navigator.plugins&&navigator.mimeTypes.length>0&&(e=navigator.plugins["Shockwave Flash"])&&(t=navigator.plugins["Shockwave Flash"].description.replace(/.*\s(\d+\.\d+).*/,"$1"));return 1*t},_checkForFlash:function(e){var t=!1;return this._getFlashPluginVersion()>=e&&(t=!0),t},_validString:function(e){return e&&"string"==typeof e},_limitValue:function(e,t,n){return t>e?t:e>n?n:e},_urlNotSetError:function(t){this._error({type:e.jPlayer.error.URL_NOT_SET,context:t,message:e.jPlayer.errorMsg.URL_NOT_SET,hint:e.jPlayer.errorHint.URL_NOT_SET})},_flashError:function(t){var n;n=this.internal.ready?"FLASH_DISABLED":"FLASH",this._error({type:e.jPlayer.error[n],context:this.internal.flash.swf,message:e.jPlayer.errorMsg[n]+t.message,hint:e.jPlayer.errorHint[n]}),this.internal.flash.jq.css({width:"1px",height:"1px"})},_error:function(t){this._trigger(e.jPlayer.event.error,t),this.options.errorAlerts&&this._alert("Error!"+(t.message?"\n"+t.message:"")+(t.hint?"\n"+t.hint:"")+"\nContext: "+t.context)},_warning:function(n){this._trigger(e.jPlayer.event.warning,t,n),this.options.warningAlerts&&this._alert("Warning!"+(n.message?"\n"+n.message:"")+(n.hint?"\n"+n.hint:"")+"\nContext: "+n.context)},_alert:function(e){var t="jPlayer "+this.version.script+" : id='"+this.internal.self.id+"' : "+e;this.options.consoleAlerts?window.console&&window.console.log&&window.console.log(t):alert(t)},_emulateHtmlBridge:function(){var t=this;e.each(e.jPlayer.emulateMethods.split(/\s+/g),function(e,n){t.internal.domNode[n]=function(e){t[n](e)}}),e.each(e.jPlayer.event,function(n,i){var r=!0;e.each(e.jPlayer.reservedEvent.split(/\s+/g),function(e,t){return t===n?(r=!1,!1):void 0}),r&&t.element.bind(i+".jPlayer.jPlayerHtml",function(){t._emulateHtmlUpdate();var e=document.createEvent("Event");e.initEvent(n,!1,!0),t.internal.domNode.dispatchEvent(e)})})},_emulateHtmlUpdate:function(){var t=this;e.each(e.jPlayer.emulateStatus.split(/\s+/g),function(e,n){t.internal.domNode[n]=t.status[n]}),e.each(e.jPlayer.emulateOptions.split(/\s+/g),function(e,n){t.internal.domNode[n]=t.options[n]})},_destroyHtmlBridge:function(){var t=this;this.element.unbind(".jPlayerHtml");var n=e.jPlayer.emulateMethods+" "+e.jPlayer.emulateStatus+" "+e.jPlayer.emulateOptions;e.each(n.split(/\s+/g),function(e,n){delete t.internal.domNode[n]})}},e.jPlayer.error={FLASH:"e_flash",FLASH_DISABLED:"e_flash_disabled",NO_SOLUTION:"e_no_solution",NO_SUPPORT:"e_no_support",URL:"e_url",URL_NOT_SET:"e_url_not_set",VERSION:"e_version"},e.jPlayer.errorMsg={FLASH:"jPlayer's Flash fallback is not configured correctly, or a command was issued before the jPlayer Ready event. Details: ",FLASH_DISABLED:"jPlayer's Flash fallback has been disabled by the browser due to the CSS rules you have used. Details: ",NO_SOLUTION:"No solution can be found by jPlayer in this browser. Neither HTML nor Flash can be used.",NO_SUPPORT:"It is not possible to play any media format provided in setMedia() on this browser using your current options.",URL:"Media URL could not be loaded.",URL_NOT_SET:"Attempt to issue media playback commands, while no media url is set.",VERSION:"jPlayer "+e.jPlayer.prototype.version.script+" needs Jplayer.swf version "+e.jPlayer.prototype.version.needFlash+" but found "},e.jPlayer.errorHint={FLASH:"Check your swfPath option and that Jplayer.swf is there.",FLASH_DISABLED:"Check that you have not display:none; the jPlayer entity or any ancestor.",NO_SOLUTION:"Review the jPlayer options: support and supplied.",NO_SUPPORT:"Video or audio formats defined in the supplied option are missing.",URL:"Check media URL is valid.",URL_NOT_SET:"Use setMedia() to set the media URL.",VERSION:"Update jPlayer files."},e.jPlayer.warning={CSS_SELECTOR_COUNT:"e_css_selector_count",CSS_SELECTOR_METHOD:"e_css_selector_method",CSS_SELECTOR_STRING:"e_css_selector_string",OPTION_KEY:"e_option_key"},e.jPlayer.warningMsg={CSS_SELECTOR_COUNT:"The number of css selectors found did not equal one: ",CSS_SELECTOR_METHOD:"The methodName given in jPlayer('cssSelector') is not a valid jPlayer method.",CSS_SELECTOR_STRING:"The methodCssSelector given in jPlayer('cssSelector') is not a String or is empty.",OPTION_KEY:"The option requested in jPlayer('option') is undefined."},e.jPlayer.warningHint={CSS_SELECTOR_COUNT:"Check your css selector and the ancestor.",CSS_SELECTOR_METHOD:"Check your method name.",CSS_SELECTOR_STRING:"Check your css selector is a string.",OPTION_KEY:"Check your option name."}})?i.apply(t,r):i)||(e.exports=a),org.ekstep.pluginframework.pluginManager.registerPlugin({id:"org.ekstep.audio",ver:"1.0",shortId:"audio",displayName:"Audio",author:"Amol Ghatol",title:"Audio Plugin",description:"",publishedDate:"",editor:{main:"editor/plugin.js",dependencies:[{type:"js",src:"editor/libs/jquery.jplayer.min.js"},{type:"plugin",plugin:"org.ekstep.assetbrowser",ver:"1.4"}],menu:[{id:"audio",category:"main",type:"icon",toolTip:"Add Audio",title:"Audio",iconClass:"icon-audio icon",onclick:{id:"org.ekstep.audio:assetbrowser:open"}}],config:[{propertyName:"aduioBrowser",title:"Audio Browser",description:"Choose a  from the browser",dataType:"audiobrowser",required:!0}],playable:!0}},org.ekstep.contenteditor.basePlugin.extend({audioData:void 0,name:void 0,initialize:function(){var e=this;ecEditor.addEventListener(e.manifest.id+":assetbrowser:open",this.openBrowser,this),ecEditor.addEventListener(e.manifest.id+":removeAudio",this.removeAudio,this),ecEditor.addEventListener(e.manifest.id+":toggleAudio",this.toggleAudio,this),ecEditor.addEventListener(e.manifest.id+":jplayerInit",this.jplayerInit,this)},newInstance:function(){var e=this,t=this.media?this.media[this.attributes.asset]:void 0;t&&t.src?(t.src=org.ekstep.contenteditor.mediaManager.getMediaOriginURL(t.src),this.addMedia(t),this.audioData={stageId:ecEditor.getCurrentStage().id,type:"audio",title:ecEditor._.isUndefined(t.name)?t.id:t.name,assetId:t.id,id:e.id,url:t.src},this.name=this.audioData.title,ecEditor.dispatchEvent("org.ekstep.stageconfig:addcomponent",this.audioData)):org.ekstep.contenteditor.api.getService(ServiceConstants.TELEMETRY_SERVICE).error({err:"Asset mismatch: audio source missing in manifest media of content",errtype:"PORTAL",stacktrace:"audio source missing in manifest media of content",severity:"fatal",pageid:ecEditor.getCurrentStage().id,plugin:{id:e.manifest.id,ver:e.manifest.ver,category:"core"},object:{id:e.editorData.asset,type:"Asset",ver:e.manifest.ver}})},openBrowser:function(){var e=this;ecEditor.dispatchEvent("org.ekstep.assetbrowser:show",{type:"audio",search_filter:{},callback:function(t){ecEditor.dispatchEvent(e.manifest.id+":create",t)}})},getCopy:function(){var e=this._super();return e.assetMedia=this.media[this.attributes.asset],e},onConfigChange:function(e,t){ecEditor.dispatchEvent("delete:invoke"),ecEditor.dispatchEvent(this.manifest.id+":create",t)},render:function(e){},removeAudio:function(e,t){ecEditor.getPluginInstance(t.id).remove(),ecEditor.dispatchEvent("org.ekstep.stageconfig:remove",t)},toggleAudio:function(e,t){ecEditor.getPluginInstance(t.id).config.autoplay=t.autoplay,ecEditor.dispatchEvent("org.ekstep.config:toggleStageEvent",{flag:t.autoplay,id:t.assetId})},jplayerInit:function(e,t){var n=t.id;ecEditor.jQuery("#"+n).jPlayer({swfPath:"js/jplayer/",supplied:"mp3",solution:"html, flash",preload:"auto",wmode:"window",ready:function(){ecEditor.jQuery(this).jPlayer("setMedia",{mp3:t.url}).jPlayer("play")},play:function(){ecEditor.jQuery(this).addClass("pause")},pause:function(){ecEditor.jQuery(this).removeClass("pause")},stop:function(){ecEditor.jQuery(this).removeClass("pause")}}),ecEditor.jQuery("#"+n).hasClass("pause")?ecEditor.jQuery("#"+n).jPlayer("pause"):ecEditor.jQuery("#"+n).jPlayer("play")},getDisplayName:function(){return this.name}}))},function(e,t){org.ekstep.pluginframework.pluginManager.registerPlugin({id:"org.ekstep.hotspot",ver:"1.0",shortId:"hotspot",displayName:"Hotspot",author:"Santhosh Vasabhaktula",title:"Hotspot Plugin",description:"",publishedDate:"",editor:{main:"editor/plugin.js",dependencies:[],menu:[{id:"hotspot",category:"main",type:"icon",toolTip:"Add Hotspot",title:"Hotspot",iconClass:"icon-hotspot icon",onclick:{id:"org.ekstep.hotspot:create",data:{type:"roundrect",y:20,x:20,fill:"rgb(255,0,0)",w:15,h:25,opacity:.3,stroke:"rgba(255, 255, 255, 0)",strokeWidth:1}}}],behaviour:{rotatable:!0},configManifest:[{propertyName:"color",title:"Fill color",description:"Choose a color from the color picker",dataType:"colorpicker",required:!0,defaultValue:"rgb(255,0,0)"}],help:{src:"editor/help.md",dataType:"text"}},initdata:{props:{y:20,x:20}}},org.ekstep.contenteditor.basePlugin.extend({type:"hotspot",initialize:function(){},newInstance:function(){this.attributes.opacity=ecEditor._.isUndefined(this.attributes.opacity)?.4:this.attributes.opacity;var e=this.convertToFabric(this.attributes);"roundrect"===this.attributes.type&&(this.editorObj=new fabric.Rect(e))},onRemove:function(e){},updateAttributes:function(){var e=this;this&&(ecEditor._.forEach({"stroke-width":"stroke-width",scaleX:"scaleX",scaleY:"scaleY"},function(t,n){e.attributes[n]=e.editorObj.get(t)}),this.attributes.radius=this.editorObj.rx)},onConfigChange:function(e,t){"color"===e&&(this.editorObj.setFill(t),this.attributes.fill=t),ecEditor.render(),ecEditor.dispatchEvent("object:modified",{target:ecEditor.getEditorObject()})},getConfig:function(){var e=this._super();return e.opacity=100*this.attributes.opacity,e.color=this.attributes.fill,e}}))},function(e,t){org.ekstep.pluginframework.pluginManager.registerPlugin({id:"org.ekstep.scribblepad",ver:"1.0",author:"Santhosh Vasabhaktula",title:"Scribblepad Plugin",description:"",displayName:"Scribble",publishedDate:"",editor:{main:"editor/plugin.js",dependencies:[],menu:[{id:"scribblepad",category:"main",type:"icon",toolTip:"Add Scribblepad",title:"scribblepad",iconClass:"icon-scribble icon",onclick:{id:"org.ekstep.scribblepad:create",data:{type:"roundrect",y:20,x:25,fill:"#3399FF",w:27,h:60,stroke:"rgba(255, 255, 255, 0)",strokeWidth:2,opacity:.3}},media:[{id:"eraserImage",src:"assets/EraserImage.png",type:"image"}]}],configManifest:[{propertyName:"color",title:"Fill color",description:"Choose a color from the color picker",dataType:"colorpicker",required:!0,defaultValue:"#3399FF"},{propertyName:"opacity",title:"Transparency",description:"Set the transparency for element",dataType:"rangeslider",labelSuffix:"%",required:!0,minimumValue:0,maximumValue:100}],help:{src:"editor/help.md",dataType:"text"}},renderer:{main:"renderer/scribblepadplugin.js"}},org.ekstep.contenteditor.basePlugin.extend({type:"org.ekstep.scribblepad",initialize:function(){},newInstance:function(){var e=this.convertToFabric(this.attributes);e.stroke=this.attributes.stroke,e.strokeWidth=this.attributes.strokeWidth,e.fill=this.attributes.fill,"roundrect"===this.attributes.type&&(this.editorObj=new fabric.Rect(e),this.addMedia({id:"org.ekstep.scribblepad.eraser",src:"/assets/public/content/1460624453530trash.png",assetId:"org.ekstep.scribblepad.eraser",type:"image",preload:!0}))},updateAttributes:function(){var e=this;e&&ecEditor._.forEach({radius:"radius",opacity:"opacity",stroke:"stroke","stroke-width":"stroke-width",scaleX:"scaleX",scaleY:"scaleY"},function(t,n){e.attributes[n]=e.editorObj.get(t)})},onConfigChange:function(e,t){"color"===e&&(this.editorObj.setFill(t),this.attributes.fill=t),ecEditor.render(),ecEditor.dispatchEvent("object:modified",{target:ecEditor.getEditorObject()})},getAttributes:function(){var e=this._super();return delete e.strokeDashArray,e["stroke-width"]=1,e.thickness=2,e},getConfig:function(){var e=this._super();return e.color=this.attributes.fill,e.opacity=100*this.attributes.opacity,e}}))},function(e,t){org.ekstep.pluginframework.pluginManager.registerPlugin({id:"org.ekstep.stageconfig",ver:"1.0",author:"Sunil",title:"Stage Config",description:"",publishedDate:"",editor:{main:"editor/plugin.js"}},org.ekstep.contenteditor.basePlugin.extend({type:"org.ekstep.stageconfig",stageAudios:{},scope:ecEditor.getAngularScope(),initialize:function(){ecEditor.addEventListener(this.manifest.id+":addcomponent",this.register,this),ecEditor.addEventListener("stage:render:complete",this.stageRender,this),ecEditor.addEventListener(this.manifest.id+":remove",this.removeAudio,this)},register:function(e,t){this.stageAudios[t.stageId]||(this.stageAudios[t.stageId]=[]),this.stageAudios[t.stageId].push(t),this.showComponents(t.stageId)},getStageIndex:function(e){return ecEditor._.findIndex(this.stageConfig,function(t){return e.stageId===t.stageId})},addComponents:function(e){var t=this,n=ecEditor.getStagePluginInstances(e,["org.ekstep.audio"]);n.length&&(this.stageAudios[e]=this.stageAudios[e]||[]),_.each(n,function(n){t.stageAudios[e].push(n.audioData)})},stageRender:function(e,t){this.showComponents(t.stageId)},showComponents:function(e){this.stageAudios[e]||this.addComponents(e);var t=this;this.hideStageComponents(e),setTimeout(function(){t.showStageComponents(e)},500),t=this,ecEditor.ngSafeApply(t.scope,function(){t.scope.currentStage=ecEditor.getCurrentStage()})},showStageComponents:function(e){var t=this,n=[];ecEditor._.forEach(this.stageAudios[e],function(e){var t;e&&(t=ecEditor.getPluginInstance(e.id),e.autoplay=t.config.autoplay,n.push(e))}),ecEditor.ngSafeApply(t.scope,function(){t.scope.stageAttachments.audio={},t.scope.stageAttachments.audio.items=n,t.scope.stageAttachments.audio.show=!0})},hideStageComponents:function(e){var t=this;ecEditor.ngSafeApply(t.scope,function(){t.scope.stageAttachments.audio={},t.scope.stageAttachments.audio.items=[],t.scope.stageAttachments.audio.show=!1})},removeAudio:function(e,t){this.stageAudios[t.stageId]=ecEditor._.reject(this.stageAudios[t.stageId],{id:t.id}),this.showComponents(t.stageId)}}))},function(e,t){org.ekstep.pluginframework.pluginManager.registerPlugin({id:"org.ekstep.telemetry",ver:"1.0",author:"Sunil A S",title:"Telemetry Plugin",description:"",publishedDate:"",editor:{main:"editor/plugin.js"}},org.ekstep.contenteditor.basePlugin.extend({type:"org.ekstep.telemetry",service:void 0,initialize:function(){this.service=ecEditor.getService("telemetry"),ecEditor.addEventListener("content:load:complete",this.registerEvents,this),ecEditor.addEventListener("content:load:complete",this.logPluginErrors,this)},registerEvents:function(){var e=this;ecEditor.addEventListener("object:selected",function(t,n){n&&n.id&&""!=n.id&&e.interactEvent("select","","plugin",n.type,n.ver,n.id)},this),ecEditor.addEventListener("object:modified",function(t,n){n&&n.id&&""!=n.id&&e.interactEvent("modify","","plugin",n.type,n.ver,n.id)},this),ecEditor.addEventListener("object:unselected",function(t,n){n&&n.id&&""!=n.id&&e.interactEvent("unselect","","plugin",n.type,n.ver,n.id)},this),ecEditor.addEventListener("object:removed",function(t,n){n&&n.id&&""!=n.id&&(n=ecEditor.getPluginInstance(n.id),e.service.pluginLifeCycle({type:"remove",pluginid:n.manifest.id,pluginver:n.manifest.ver,objectid:n.id,assetid:n.getAttribute("asset"),stage:ecEditor.getCurrentStage().id,containerid:"",containerplugin:""}))},this),ecEditor.addEventListener("stage:removed",function(t,n){n&&n.stageId&&""!=n.stageId&&(n=ecEditor.getPluginInstance(n.stageId),e.service.pluginLifeCycle({type:"remove",pluginid:n.manifest.id,pluginver:n.manifest.ver,objectid:n.id,assetid:n.getAttribute("asset"),stage:n.id,containerid:"",containerplugin:""}))},this),ecEditor.addEventListener("stage:delete",function(t,n){n&&n.stageId&&""!=n.stageId&&e.interactEvent("click","delete","plugin","org.ekstep.stage","1.0",n.stageId)},this),ecEditor.addEventListener("stage:duplicate",function(t,n){n&&n.stageId&&""!=n.stageId&&e.interactEvent("duplicate","","plugin","org.ekstep.stage","1.0",n.stageId)},this),ecEditor.addEventListener("stage:select",function(t,n){n&&n.stageId&&""!=n.stageId&&e.interactEvent("select","","plugin","org.ekstep.stage","1.0",n.stageId)},this),ecEditor.addEventListener("stage:reorder",function(t,n){n&&n.stageId&&""!=n.stageId&&e.interactEvent("modify","reorder","stage","org.ekstep.stage","1.0",n.stageId)},this),ecEditor.addEventListener("plugin:load",function(t,n){n&&e.service.pluginLifeCycle({type:"load",pluginid:n.plugin,pluginver:n.version,objectid:"",stage:"",containerid:"",containerplugin:""})},this),ecEditor.addEventListener("plugin:add",function(t,n){var i=ecEditor.getCurrentStage()?ecEditor.getCurrentStage().id:"";n&&e.service.pluginLifeCycle({type:"add",pluginid:n.plugin,pluginver:n.version,objectid:n.instanceId,stage:i,containerid:"",containerplugin:""})},this),ecEditor.addEventListener("plugin:error",function(t,n){var i=ecEditor.getService("content").getContentMeta(org.ekstep.contenteditor.api.getContext("contentId")).pkgVersion;i={id:org.ekstep.contenteditor.api.getContext("contentId"),ver:!_.isUndefined(i)&&i.toString()||"0",type:"Content"},e.service.error({err:n.err,errtype:"CONTENT",stacktrace:n.stackTrace||"",object:i,plugin:{id:n.plugin,ver:n.version,category:""}})},this)},interactEvent:function(e,t,n,i,r,a){this.service.interact({type:e,subtype:t,target:n,pluginid:i,pluginver:r,objectid:a,stage:ecEditor.getCurrentStage().id})},logPluginErrors:function(e,t){var n=this,i=ecEditor.getService("content").getContentMeta(org.ekstep.contenteditor.api.getContext("contentId")).pkgVersion,r={id:org.ekstep.contenteditor.api.getContext("contentId"),ver:!_.isUndefined(i)&&i.toString()||"0",type:"Content"};i=org.ekstep.pluginframework.pluginManager.getErrors(),_.each(i,function(e){n.service.error({err:e.error,errtype:"CONTENT",stacktrace:e.stackTrace||"",object:r,plugin:{id:e.plugin,ver:e.version,category:""}})})}}))},function(e,t){org.ekstep.pluginframework.pluginManager.registerPlugin({id:"org.ekstep.preview",ver:"1.2",author:"Sunil A S",title:"preview",description:"",publishedDate:"",editor:{main:"editor/plugin.js",menu:[],dependencies:[{type:"css",src:"editor/style.css"}]}},org.ekstep.contenteditor.basePlugin.extend({type:"preview",previewURL:(ecEditor.getConfig("previewURL")||"/content/preview/preview.html")+"?webview=true",contentBody:void 0,initialize:function(){ecEditor.addEventListener("atpreview:show",this.initPreview,this);var e=document.createElement("div");e.classList.add("preview-modal"),e.id="contentPreview",e.innerHTML='<div class="preview-modal-content"><div class="preview-modal-wrapper"><div class="child preview-bgimage"></div><div class="child preview-iframe"><iframe id="previewContentIframe" width=100% height=100%></iframe></div></div>',document.body.appendChild(e)},initPreview:function(e,t){this.contentBody=t.contentBody,t.currentStage&&(this.contentBody.theme.startStage=ecEditor.getCurrentStage().id),ecEditor.getAngularScope().developerMode&&(this.contentBody.theme["plugin-manifest"]||(this.contentBody.theme["plugin-manifest"]={plugin:[]}),_.isArray(this.contentBody.theme["plugin-manifest"].plugin)||(this.contentBody.theme["plugin-manifest"].plugin=[this.contentBody.theme["plugin-manifest"].plugin]),this.contentBody.theme["plugin-manifest"].plugin.splice(0,0,{id:"org.ekstep.developer",ver:"1.0",type:"plugin",hostPath:org.ekstep.pluginframework.hostRepo.basePath,preload:!0})),this.showPreview(t)},getConfiguration:function(){var e={},t={},n={repos:ecEditor.getConfig("pluginRepo"),showEndpage:!0},i=ecEditor.getService("content").getContentMeta(ecEditor.getContext("contentId"));return e.etags=ecEditor.getContext("etags")||[],t.context={mode:"edit",contentId:ecEditor.getContext("contentId"),sid:ecEditor.getContext("sid"),uid:ecEditor.getContext("uid"),channel:ecEditor.getContext("channel")||"in.ekstep",pdata:ecEditor.getContext("pdata")||{id:"in.ekstep",pid:"",ver:"1.0"},app:e.etags.app||[],dims:e.etags.dims||[],partner:e.etags.partner||[]},ecEditor.getConfig("previewConfig")?t.config=ecEditor.getConfig("previewConfig"):t.config=n,"SelfAssess"===i.contentType&&(t.config.endPage=[{contentType:["SelfAssess"],template:"assessment"}]),t.metadata=i,t.data="application/vnd.ekstep.ecml-archive"==i.mimeType?this.contentBody:{},t},showPreview:function(e){var t,n=this,i=n.getConfiguration(),r=ecEditor.jQuery("#previewContentIframe")[0],a=(e.parentElement?(i.config.showEndPage=i.config.showEndPage||!1,r=ecEditor.jQuery(e.element)[0]):(t=ecEditor.resolvePluginResource(n.manifest.id,n.manifest.ver,"editor/images/editor-frame.png"),ecEditor.jQuery(".preview-bgimage").css("background","url("+t+")")),ecEditor._.isEmpty(r.src)?(r.src=n.previewURL,r.onload=function(){r.contentWindow.initializePreview(i)}):r.contentWindow.initializePreview(i),document.getElementById("contentPreview")),o=document.getElementsByClassName("preview-modal-content")[0];e.parentElement||(a.style.display="block"),window.onclick=function(e){e.target==o&&(a.style.display="none",r.contentWindow.EkstepRendererAPI.stopAll(),r.contentWindow.EkstepRendererAPI.removeHtmlElements(),ecEditor.dispatchEvent("org.ekstep.contenteditor:preview:close"))}}}))},function(e,t,n){var i,r,a;!function(){"use strict";function o(e){return angular.isArray(e)?2==e.length?e.concat(e):3==e.length?e.concat([e[1]]):e:[e,e,e,e]}function s(e,t){if(!t)return e;var n=l(t[0])?parseFloat(t[0])*e.height/100:t[0],i=l(t[1])?parseFloat(t[1])*e.width/100:t[1],r=l(t[2])?parseFloat(t[2])*e.height/100:t[2],a=l(t[3])?parseFloat(t[3])*e.width/100:t[3];return{top:e.top-n,left:e.left-a,bottom:e.bottom+r,right:e.right+i,height:e.height+n+r,width:e.width+a+i}}function l(e){return angular.isString(e)&&e.indexOf("%")>0}function u(e){this.didSubscribeFunc=e}function c(e,t){return new u(function(n){var i=function(e){n(e)},r=angular.element(e);t.split(" ").map(e=>r[0].addEventListener(e,i,!0)),n.$dispose=function(){t.split(" ").map(e=>r[0].removeEventListener(e,i,!0))}})}angular.module("angular-inview",[]).directive("inView",["$parse",function(e){return{restrict:"A",require:"?^^inViewContainer",link:function(t,n,i,r){var a={};i.inViewOptions&&(a=t.$eval(i.inViewOptions)),a.offset&&(a.offset=o(a.offset)),a.viewportOffset&&(a.viewportOffset=o(a.viewportOffset));var l,d=(l={type:"initial"},new u(function(e){setTimeout(function(){e(l)})})).merge(c(window,"checkInView click ready wheel mousewheel DomMouseScroll MozMousePixelScroll resize scroll touchmove mouseup keydown"));r&&(d=d.merge(r.eventsSignal)),a.throttle&&(d=d.throttle(a.throttle));var h=d.map(function(e){var t;t=s(t=r?r.getViewportRect():function(){var e={top:0,left:0,width:window.innerWidth,right:window.innerWidth,height:window.innerHeight,bottom:window.innerHeight};return e.height?e:("CSS1Compat"===document.compatMode?(e.width=e.right=document.documentElement.clientWidth,e.height=e.bottom=document.documentElement.clientHeight):(e.width=e.right=document.body.clientWidth,e.height=e.bottom=document.body.clientHeight),e)}(),a.viewportOffset);var i,o,l=s(n[0].getBoundingClientRect(),a.offset),u={inView:!!(n[0].offsetWidth||n[0].offsetHeight||n[0].getClientRects().length)&&(i=l,o=t,!(o.left>i.right||o.right<i.left||o.top>i.bottom||o.bottom<i.top)),event:e,element:n,elementRect:l,viewportRect:t};return a.generateParts&&u.inView&&(u.parts={},u.parts.top=l.top>=t.top,u.parts.left=l.left>=t.left,u.parts.bottom=l.bottom<=t.bottom,u.parts.right=l.right<=t.right),u}).scan({},function(e,t){return a.generateDirection&&t.inView&&e.elementRect&&(t.direction={horizontal:t.elementRect.left-e.elementRect.left,vertical:t.elementRect.top-e.elementRect.top}),t.changed=t.inView!==e.inView||!angular.equals(t.parts,e.parts)||!angular.equals(t.direction,e.direction),t}).filter(function(e){return!(!e.changed||"initial"===e.event.type&&!e.inView)}),p=e(i.inView),f=h.subscribe(function(e){t.$applyAsync(function(){p(t,{$inview:e.inView,$inviewInfo:e})})});t.$on("$destroy",f)}}}]).directive("inViewContainer",function(){return{restrict:"A",controller:["$element",function(e){this.element=e,this.eventsSignal=c(e,"scroll"),this.getViewportRect=function(){return e[0].getBoundingClientRect()}}]}}),u.prototype.subscribe=function(e){return this.didSubscribeFunc(e),function(){e.$dispose&&(e.$dispose(),e.$dispose=null)}},u.prototype.map=function(e){var t=this;return new u(function(n){n.$dispose=t.subscribe(function(t){n(e(t))})})},u.prototype.filter=function(e){var t=this;return new u(function(n){n.$dispose=t.subscribe(function(t){e(t)&&n(t)})})},u.prototype.scan=function(e,t){var n=this;return new u(function(i){var r=e;i.$dispose=n.subscribe(function(e){r=t(r,e),i(r)})})},u.prototype.merge=function(e){return function(){var e=arguments;return new u(function(t){for(var n=[],i=e.length-1;i>=0;i--)n.push(e[i].subscribe(function(){t.apply(null,arguments)}));t.$dispose=function(){for(var e=n.length-1;e>=0;e--)n[e]&&n[e]()}})}(this,e)},u.prototype.throttle=function(e){var t,n,i=this;return new u(function(r){var a=i.subscribe(function(){var i=+new Date,a=arguments;t&&i<t+e?(clearTimeout(n),n=setTimeout(function(){t=i,r.apply(null,a)},e)):(t=i,r.apply(null,a))});r.$dispose=function(){clearTimeout(n),a&&a()}})},r=[n(23)],void 0===(a="function"==typeof(i="angular-inview")?i.apply(t,r):i)||(e.exports=a)}(),angular.module("puigcerber.camelize",[]).filter("camelize",function(){return function(e){return e?e.replace(/[^A-Za-z0-9]+(\w|$)/g,function(e,t){return t.toUpperCase()}).replace(/^(.)/,function(e,t){return t.toLowerCase()}):e}}),org.ekstep.pluginframework.pluginManager.registerPlugin({id:"org.ekstep.activitybrowser",ver:"1.3",author:"Archana Baskaran",title:"Activity Browser Plugin",description:"",publishedDate:"",editor:{main:"editor/plugin.js",dependencies:[{type:"css",src:"editor/plugin.css"},{type:"js",src:"editor/libs/angular-inview.js"},{type:"js",src:"editor/camelize.js"}],views:[{template:"./activityBrowser.html",controller:"./activityBrowser.js"}],menu:[{id:"activitybrowser",category:"main",type:"icon",toolTip:"Add Activity",title:"Activity Browser",iconClass:"fa fa-magic",onclick:{id:"org.ekstep.activitybrowser:showpopup"}}],configManifest:[]}},org.ekstep.contenteditor.basePlugin.extend({currentInstance:void 0,initialize:function(){var e=this;ecEditor.addEventListener("org.ekstep.activitybrowser:showpopup",this.loadBrowser,this),ecEditor.resolvePluginResource(e.manifest.id,e.manifest.ver,"editor/activityBrowser.html"),ecEditor.resolvePluginResource(e.manifest.id,e.manifest.ver,"editor/activityBrowser.js"),ecEditor.getService("popup").loadNgModules(n(54),n(55),!0)},newInstance:function(){},loadBrowser:function(){currentInstance=this,ecEditor.getService("popup").open({template:"activityBrowser",controller:"activityBrowserCtrl",controllerAs:"$ctrl",resolve:{instance:function(){return currentInstance}},width:900,showClose:!1,closeByEscape:!1,closeByDocument:!1,className:"ngdialog-theme-plain"},function(){})}}))},function(e,t){e.exports='<script type="text/ng-template" ng-app="activityBrowserApp" ng-controller="activityBrowserCtrl as $ctrl" id="activityBrowser">\n    <link rel="stylesheet" type="text/css" href="//cdn.jsdelivr.net/jquery.slick/1.6.0/slick.css" />\n    \x3c!-- Add the slick-theme.css if you want default styling --\x3e\n    <link rel="stylesheet" type="text/css" href="//cdn.jsdelivr.net/jquery.slick/1.6.0/slick-theme.css" />\n    <div class="ui modal fullscreen active activity-browser-modal">\n        <div class="header" style="padding-right:1em;">\n            <div class="ui two column grid">\n                <div class="row">\n                    <div class="column">\n                        <span>Add activity</span>\n                    </div>\n                    <div class="column right aligned">\n                        <i class="cursor-pointer close link icon" ng-click="closePopup()"></i>\n                    </div>\n                </div>\n            </div>\n        </div>\n        <div ng-class="$ctrl.showPluginDetails ? \'content\' : \'content full-screen\'">\n            <div class="ui divided grid activity-browser-controls">\n                <div class="row" style="background-color: #F9F9F9;" ng-show="!$ctrl.showPluginDetails">\n                    <div class="six wide column" style="display:flex; flex-flow:row; align-items:center;">\n                        <span class="height-100-percent" style="margin-right:10px;"><i class="search icon" style="margin-top:10px;"></i></span>\n                        <div class="ui transparent input custom-input height-100-percent" style=\'flex-grow:1; margin-right:5px;\'>\n                            <input class="height-100-percent" type="text" placeholder="Search activity" ng-model="$ctrl.activityOptions.searchQuery" ng-keypress="$event.keyCode === 13 ? $ctrl.getActivities() : null" />\n                        </div>\n                        <button class="ui primary button height-100-percent" ng-click="$ctrl.getActivities();$ctrl.generateTelemetry({id:\'button\', type: \'click\', subtype: \'search\', target: \'searchActivityCard\'})">Search</button>\n                    </div>\n                    <div class="ui vertical divider"></div>\n                    <div class="three wide right aligned column" style="display:flex; flex-flow:row; align-items:center;">\n                        <label style="margin-right:10px;">\n                            Category\n                        </label>\n                        <div style="flex-grow:1;" class="ui input" ng-init="$ctrl.activityOptions.categories = []">\n                            <select multiple="" class="ui dropdown search lableCls custom-dropdown" ng-model="$ctrl.activityOptions.categories" ng-options="type for type in $ctrl.categories" ng-change="$ctrl.getActivities();$ctrl.generateTelemetry({id:\'button\', type: \'click\', subtype:    \'advanceSearch\', target: \'searchActivityCard\'})">\n                                <option value="">\n                                    Type\n                                </option>\n                            </select>\n                        </div>\n                    </div>\n                    <div class="three wide right aligned column" style="box-shadow:none; display:flex; flex-flow:row; align-items:center;">\n                        <label style="margin-right:10px;">\n                            Concepts\n                        </label>\n                        <div class="ui fluid transparent input custom-input" style="flex-grow:1;">\n                            <input type="text" placeholder="Concepts" ng-model="$ctrl.activityOptions.conceptsPlaceHolder" id="activityConceptSelector" selectable="false" readonly>\n                        </div>\n                    </div>\n                </div>\n            </div>\n            <div class="ui grid activity-browser-body">\n                <div ng-if="$ctrl.showPluginDetails" class="row activity-information-row">\n                    <div class="twelve wide column height-100-percent" style="padding-left:114px; padding-right:115px; padding-top: 1.5em;">\n                        <div class="ui items height-100-percent">\n                            <div class="item" style="width:50%;">\n                                <div class="ui small image">\n                                    <img ng-src="{{$ctrl.pluginDetails.appIcon || $ctrl.defaultActivityImage}}" />\n                                </div>\n                                <div class="content">\n                                    <div class="header">\n                                        <a style="color:#4a4a4a;">{{$ctrl.pluginDetails.name | limitTo: 30}}</a>\n                                        <span style="margin-left:23px; color:#9b9b9b; font-size:12px;" data-tooltip="Version : {{$ctrl.pluginDetails.semanticVersion}}"><i class="info circle link icon"></i></span>\n                                    </div>\n                                    <div class="meta" style="margin-top:5px; color: #9b9b9b;">\n                                        by&nbsp;:&nbsp;<span>{{$ctrl.pluginDetails.creator}}</span>\n                                    </div>\n                                    <div class="description" style="display:flex; justify-content:space-between; margin-top:20px; color:#4a4a4a;">\n                                        <p>\n                                            Grade&nbsp;:&nbsp;<span ng-repeat="grade in $ctrl.pluginDetails.gradeLevel">\n                                                <span ng-if="$last">&nbsp;and&nbsp;</span> {{grade.replace(\'Grade \',\'\')}}\n                                            <span ng-if="!$last && ($index < $ctrl.pluginDetails.gradeLevel.length-2)">,</span>\n                                            </span>\n                                        </p>\n                                        <p>\n                                            Category&nbsp;:&nbsp;<span ng-repeat="category in $ctrl.pluginDetails.category">\n                                                {{category}}</span>\n                                        </p>\n                                    </div>\n                                    <div class="description" style="display:flex; justify-content:space-between; margin-top:0; color:#4a4a4a;">\n                                        <p>\n                                            Subject&nbsp;:&nbsp;<span>{{$ctrl.pluginDetails.subject}}</span>\n                                        </p>\n                                        <p>\n                                            Language&nbsp;:&nbsp;<span ng-repeat="language in $ctrl.pluginDetails.language">\n                                                {{language}}</span>\n                                        </p>\n                                    </div>\n                                </div>\n                            </div>\n                            <div class="item" style="margin-top:2em;">\n                                <div class="content">\n                                    <div class="header" style="color:#4a4a4a;">Description</div>\n                                    <div class="description" style="color:#9b9b9b; max-height:100px; overflow-y:auto; overflow-x:hidden;">\n                                        {{$ctrl.pluginDetails.description | limitTo : 350}}\n                                    </div>\n                                </div>\n                            </div>\n                            <div class="item" style="margin-top:2em;">\n                                <div class="content">\n                                    <div ng-if="$ctrl.imageAvailable">\n                                        <slider images="$ctrl.images"></slider>\n                                    </div>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n                <div ng-if="!$ctrl.showPluginDetails" class="row height-100-percent">\n                    <div class="column height-100-percent">\n                        <div class="ui segment height-100-percent activity-segment" style="overflow-y:auto; border:none; box-shadow:none; padding:0; padding-bottom:1em;">\n                            <div class="ui vertical segment activity-browser-content-loader" ng-if="$ctrl.loading">\n                                <div class="ui active inverted dimmer">\n                                    <div class="ui text loader">Just one second, We\'re fetching activities for you.</div>\n                                </div>\n                            </div>\n                            <div ng-if="$ctrl.activityPageApiResponse" ng-class=" $ctrl.expandedGroupId !=\'\' && $ctrl.expandedGroupId != \'{{activityGroup.name | camelize}}\' ? \'ui vertical segment     hide-segment\' : \'ui vertical segment show-segment\'" ng-show="$ctrl.activityGroupsList.length > 0 && !$ctrl.hideMainPage" id="{{activityGroup.name | camelize}}" ng-repeat="activityGroup in $ctrl.activityGroupsList">\n                                <p>{{activityGroup.name}} ({{activityGroup.contents.length}})<a ng-show="($ctrl.clickedViewMoreLinkId != \'{{activityGroup.name | camelize}}ViewMore\')" id="{{activityGroup.name | camelize}}ViewMore" style="float:right; cursor:pointer;" ng-click="$ctrl.viewMorePlugins($event)">View More&nbsp;<i class="angle right icon"></i></a></p>\n                                <div ng-class="$ctrl.expandedGroupId == \'{{activityGroup.name | camelize}}\' ? \'ui five stackable cards activity-cards expanded-segment\' : \'ui five stackable cards activity-cards collapsed-segment\'">\n                                    <div class="ui link card activity-card" ng-click="$ctrl.viewPluginDetails(activity); $ctrl.generateTelemetry({id:\'button\', type: \'click\', subtype: \'select\', target: \'activityCard\'});" ng-repeat="activity in activityGroup.contents track by $index">\n                                        <div class="blurring dimmable image">\n                                            <div class="ui dimmer">\n                                                <div class="content">\n                                                    <div class="center">\n                                                        <p title="{{activity.description}}">{{activity.description | limitTo:100}}<span ng-if="activity.description.length > 100">...</span></p>\n                                                    </div>\n                                                </div>\n                                            </div>\n                                            <img class="activity-appicon" ng-src="{{activity.appIcon || $ctrl.defaultActivityImage}}">\n                                        </div>\n                                        <div class="content activity-meta">\n                                            <div class="ui tiny header" style="margin-bottom:0.5em">\n                                                {{activity.name | limitTo:23}}<span ng-if="activity.name.length > 23">...</span>\n                                            </div>\n                                            <div class="meta">\n                                                <div ng-if="activity.gradeLevel">\n                                                    Grade :\n                                                    <span ng-repeat="grade in activity.gradeLevel"><span ng-if="$index < 2">{{grade.replace(\'Grade \',\'\')}}</span><span ng-if="$index == 2"> and {{activity.gradeLevel.length - 2}} more..</span><span ng-if="($index < 1) && !$last">,</span>\n                                                    </span>\n                                                </div>\n                                                <div ng-if="activity.subject">\n                                                    Subject :\n                                                    <span>{{activity.subject}}</span>\n                                                </div>\n                                                <div ng-if="activity.language">\n                                                    Language :\n                                                    <span ng-repeat="lang in activity.language"><span ng-if="$index < 2">{{lang}}</span><span ng-if="$index == 2"> and {{activity.language.length - 2}} more..</span><span ng-if="($index < 1) && !$last">,</span>\n                                                    </span>\n                                                </div>\n                                                <div ng-if="activity.category">\n                                                    Category :\n                                                    <span ng-repeat="cat in activity.category"><span ng-if="$index < 2">{{cat}}</span><span ng-if="$index == 2"> and {{activity.category.length - 2}} more..</span><span ng-if="($index < 1) && !$last">,</span>\n                                                    </span>\n                                                </div>\n                                            </div>\n                                        </div>\n                                        <div class="content" style="padding:5px 10px;">\n                                            <div class="right floated">\n                                                <button class="ui mini primary button" ng-click="$ctrl.addPlugin(activity);$ctrl.generateTelemetry({id:\'button\', type: \'click\', subtype: \'add\', target: \'addActivityCard\'})">Add</button>\n                                            </div>\n                                        </div>\n                                    </div>\n                                </div>\n                            </div>\n                            <div ng-if="!$ctrl.activityPageApiResponse" class="ui vertical segment" ng-show="$ctrl.activitiesList.length > 0 && !$ctrl.hideMainPage" style="border-bottom:transparent;">\n                                <div class="ui five stackable cards activity-cards" ng-show="$ctrl.activitiesList.length > 0 && !$ctrl.hideMainPage">\n                                    <div class="ui link card activity-card" ng-repeat="activity in $ctrl.activitiesList track by $index" in-view="lineInView($index, $inview, activity, \'ActivityBrowser\', $index)" in-view-options="{ throttle: 1000 }" ng-click="$ctrl.viewPluginDetails(activity); $ctrl.generateTelemetry({id:\'button\', type: \'click\', subtype: \'select\', target: \'activityCard\'});">\n                                        <div class="blurring dimmable image">\n                                            <div class="ui dimmer">\n                                                <div class="content">\n                                                    <div class="center">\n                                                        <p title="{{activity.description}}">{{activity.description | limitTo:100}}<span ng-if="activity.description.length > 100">...</span></p>\n                                                    </div>\n                                                </div>\n                                            </div>\n                                            <img class="activity-appicon" ng-src="{{activity.appIcon || $ctrl.defaultActivityImage}}">\n                                        </div>\n                                        <div class="content activity-meta">\n                                            <div class="ui tiny header" style="margin-bottom:0.5em">\n                                                {{activity.name | limitTo:23}}<span ng-if="activity.name.length > 23">...</span>\n                                            </div>\n                                            <div class="meta">\n                                                <div ng-if="activity.gradeLevel">\n                                                    Grade :\n                                                    <span ng-repeat="grade in activity.gradeLevel"><span ng-if="$index < 2">{{grade.replace(\'Grade \',\'\')}}</span><span ng-if="$index == 2"> and {{activity.gradeLevel.length - 2}} more..</span><span ng-if="($index < 1) && !$last">,</span>\n                                                    </span>\n                                                </div>\n                                                <div ng-if="activity.subject">\n                                                    Subject :\n                                                    <span>{{activity.subject}}</span>\n                                                </div>\n                                                <div ng-if="activity.language">\n                                                    Language :\n                                                    <span ng-repeat="lang in activity.language"><span ng-if="$index < 2">{{lang}}</span><span ng-if="$index == 2"> and {{activity.language.length - 2}} more..</span><span ng-if="($index < 1) && !$last">,</span>\n                                                    </span>\n                                                </div>\n                                                <div ng-if="activity.category">\n                                                    Category :\n                                                    <span ng-repeat="cat in activity.category"><span ng-if="$index < 2">{{cat}}</span><span ng-if="$index == 2"> and {{activity.category.length - 2}} more..</span><span ng-if="($index < 1) && !$last">,</span>\n                                                    </span>\n                                                </div>\n                                            </div>\n                                        </div>\n                                        <div class="content" style="padding:5px 10px;">\n                                            <div class="right floated">\n                                                <button class="ui mini primary button" ng-click="$ctrl.addPlugin(activity);$ctrl.generateTelemetry({type: \'click\', subtype: \'add\', target: \'addActivityCard\'})">Add</button>\n                                            </div>\n                                        </div>\n                                    </div>\n                                </div>\n                            </div>\n                            <div class="ui vertical segment" ng-show="$ctrl.noActivities">\n                                <div class="ui huge info message activity-browser-center">\n                                    <p>No activities found.</p>\n                                </div>\n                            </div>\n                            <div class="ui vertical segment" ng-if="$ctrl.errorLoadingActivities">\n                                <div class="ui negative message activity-browser-center">\n                                    <div class="header">\n                                        We\'re sorry!\n                                    </div>\n                                    <p>There\'s an error while fetching activities, <a href ng-click="$ctrl.getActivities();$ctrl.generateTelemetry({id: \'button\', type: \'click\', subtype: \'search\', target: \'searchActivityCard\'})">Click here</a> to try again.</p>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            </div>\n        </div>\n        <div class="actions" ng-show="$ctrl.showPluginDetails || $ctrl.viewMorePluginsFlag">\n            <div class="ui grid">\n                <div class="ui two wide column left aligned">\n                    <div class="ui basic primary button" ng-click="$ctrl.closePluginDetails();$ctrl.generateTelemetry({id:\'button\' ,type: \'click\', subtype: \'back\', target: \'backButton\'})">Back</div>\n                </div>\n                <div class="ui ten wide column right aligned">\n                    <button class="ui primary button" ng-click="$ctrl.addPlugin($ctrl.selectedPlugin);$ctrl.generateTelemetry({id:\'button\' ,type: \'click\', subtype: \'add\', target: \'addActivityCard\'})">Add</button>\n                </div>\n            </div>\n        </div>\n    </div>\n<\/script>'},function(e,t,n){"use strict";angular.module("activityBrowserApp",["angular-inview"]).controller("activityBrowserCtrl",["$scope","instance",function(e,t){var n=this;ecEditor.getAngularScope(),n.errorLoadingActivities=!1,n.activitiesList=[],n.noActivities=!1,n.loading=!1,n.inViewLogs=[],n.defaultActivityImage=ecEditor.resolvePluginResource(t.manifest.id,t.manifest.ver,"assets/default-activity.png"),n.activityOptions={searchQuery:"",conceptsPlaceHolder:"(0) Concepts",concepts:{},categories:{}},n.categories={core:"core",learning:"learning",literacy:"literacy",math:"math",science:"science",time:"time",wordnet:"wordnet",game:"game",mcq:"mcq",mtf:"mtf",ftb:"ftb"},n.viewMorePluginsFlag=!1,n.clickedViewMoreLinkId="",n.expandedGroupId="",n.showPluginDetails=!1,n.pluginDetails={},n.images=e.images=[],n.viewMorePlugins=function(t){n.viewMorePluginsFlag=!0,n.clickedViewMoreLinkId=t.target.id,n.expandedGroupId=n.clickedViewMoreLinkId.replace("ViewMore",""),e.$safeApply()},n.viewPluginDetails=function(t){n.hideMainPage=!0,n.getPluginDetails(t.identifier),n.selectedPlugin=t,e.$safeApply()},n.closePluginDetails=function(){n.showPluginDetails=!1,n.viewMorePluginsFlag=!1,n.clickedViewMoreLinkId="",n.expandedGroupId="",n.hideMainPage=!1,n.applyDimmerToCard(),e.$safeApply()},n.getActivities=function(){n.loading=!0,n.hideMainPage=!1,n.errorLoadingActivities=!1,n.noActivities=!1,n.activitiesList=[],e.$safeApply();var t={request:{query:n.activityOptions.searchQuery,filters:{objectType:["Content"],contentType:["plugin"],status:["live"],concepts:n.activityOptions.concepts,category:n.activityOptions.categories},sort_by:{lastUpdatedOn:"desc"},limit:200}},i=ecEditor.getConfig("pluginsRepoUrl")?ecEditor.getConfig("pluginsRepoUrl"):void 0;ecEditor.getService("search").pluginsSearch(i,t,function(t,i){n.loading=!1,e.$safeApply(),n.generateImpression({type:"view",subtype:"popup-open",pageid:"ActivityBrowser",duration:new Date-n.pluginLoadStartTime}),t?n.errorLoadingActivities=!0:i.data.result.count<=0?n.noActivities=!0:(ecEditor._.forEach(i.data.result.content,function(e){_.isUndefined(e.category)?n.activitiesList.push(e):e.category&&-1==e.category.indexOf("library")&&n.activitiesList.push(e)}),n.applyDimmerToCard())})},n.addPlugin=function(t){var i=new Date(t.lastPublishedOn||(new Date).toString()).getTime();ecEditor.loadAndInitPlugin(t.code,t.semanticVersion,i),n.generateImpression({type:"view",subtype:"popup-add",pageid:"ActivityBrowser"}),n.inViewLogs=[],e.closeThisDialog()},n.pluginLoadStartTime=new Date,n.getActivities(),ecEditor.dispatchEvent("org.ekstep.conceptselector:init",{element:"activityConceptSelector",selectedConcepts:[],callback:function(t){n.activityOptions.conceptsPlaceHolder="("+t.length+") concepts selected",n.activityOptions.concepts=_.map(t,function(e){return e.id}),e.$safeApply(),n.getActivities()}}),n.applyDimmerToCard=function(){setTimeout(function(){ecEditor.jQuery(".activity-cards .image").dimmer({on:"hover"})},500)},e.$on("ngDialog.opened",function(){ecEditor.jQuery(".ui.dropdown.lableCls").dropdown({useLabels:!1,forceSelection:!1})}),n.generateTelemetry=function(e){e&&org.ekstep.contenteditor.api.getService(ServiceConstants.TELEMETRY_SERVICE).interact({id:e.id,type:e.type,subtype:e.subtype,target:e.target,pluginid:t.manifest.id,pluginver:t.manifest.ver,objectid:"",stage:ecEditor.getCurrentStage().id})},n.generateImpression=function(e){e&&ecEditor.getService("telemetry").impression({type:e.type,subtype:e.subtype||"",pageid:e.pageid||"",uri:window.location.href,visits:n.inViewLogs,duration:e.duration})},e.closePopup=function(){n.generateImpression({type:"view",subtype:"popup-exit",pageid:"ActivityBrowser"}),n.inViewLogs=[],n.generateTelemetry({id:"button",type:"click",subtype:"close",target:"closeButton"}),e.closeThisDialog()},e.lineInView=function(e,t,i,r,a){var o=_.filter(n.inViewLogs,function(e){return e.identifier===i.identifier});t&&0===o.length&&n.inViewLogs.push({objid:i.identifier,objtype:i.contentType||"Plugin",section:r,index:e})},n.getPluginDetails=function(i){n.loading=!0,n.imageAvailable=!1,n.errorLoadingActivities=!1,n.pluginDetails={},n.images=e.images=[],ecEditor.getService("content").getContent(i,function(i,r){n.loading=!1,r?(n.pluginDetails=r,r.usedByContent&&r.usedByContent.length?n.getPluginScreenshots(r.usedByContent):(n.images.push({image:ecEditor.resolvePluginResource(t.manifest.id,t.manifest.ver,"assets/default-activity.png")}),n.imageAvailable=!0),n.showPluginDetails=!0):n.errorLoadingActivities=!0,e.$safeApply()})},n.getPluginScreenshots=function(i){var r={request:{filters:{contentType:["asset"],identifier:i}}};ecEditor.getService("search").search(r,function(i,r){r.data&&(r=r.data),r&&"OK"===r.responseCode&&r.result.count>0?r.result.content.forEach(function(e){e.downloadUrl&&n.images.push({image:e.downloadUrl})}):n.images.push({image:ecEditor.resolvePluginResource(t.manifest.id,t.manifest.ver,"assets/default-activity.png")}),n.imageAvailable=!0,e.$safeApply()})}}]),angular.module("activityBrowserApp").directive("slider",function(){return{restrict:"EA",scope:{images:"=",group:"=?"},controller:["$scope",function(e){e.group=e.group||1,e.currentIndex=0,e.direction="left",e.$watch("group",function(){var t=[],n=[];for(angular.copy(e.images,n);0<n.length;0+e.group)n[0]&&t.push(n.splice(0,e.group));e.setCurrent(0),e.slides=e.images}),e.setCurrent=function(t){e.direction=t>e.currentIndex?"left":"right",e.currentIndex=t},e.isCurrent=function(t){return e.currentIndex===t},e.next=function(){e.direction="left",e.currentIndex=e.currentIndex<e.slides.length-1?++e.currentIndex:0},e.prev=function(){e.direction="right",e.currentIndex=e.currentIndex>0?--e.currentIndex:e.slides.length-1}}],template:'<div class="slides group-{{group}}"><div ng-repeat="slide in slides"><div ng-show="isCurrent($index)" class="slide slide-animation"><div ng-repeat="item in slide" class="ui small image"><img ng-src="{{item}}"/></div></div></div><div class="controls" ng-if="slides.length > 1"><div class="navigation"><a ng-click="prev()" class="prev"><span><i class="chevron circle left big icon"></i></span></a><a ng-click="next()" class="next"><span><i class="chevron circle right big icon"></i></span></a></div></div></div>',link:function(e,t,n){}}})},function(e,t,n){var i,r,a,o,s,l;o=jQuery,s=function(e,t){var n,i=e.charCodeAt(t);return 55296>i||i>56319||e.length<=t+1||56320>(n=e.charCodeAt(t+1))||n>57343?e[t]:e.substring(t,t+2)},l=function(e,t,n){for(var i,r="",a=0,o=0,l=e.length;l>a;)i=s(e,a),o>=t&&n>o&&(r+=i),a+=i.length,o+=1;return r},o.fn.initial=function(e){var t,n=["#1abc9c","#16a085","#f1c40f","#f39c12","#2ecc71","#27ae60","#e67e22","#d35400","#3498db","#2980b9","#e74c3c","#c0392b","#9b59b6","#8e44ad","#bdc3c7","#34495e","#2c3e50","#95a5a6","#7f8c8d","#ec87bf","#d870ad","#f69785","#9ba37e","#b49255","#b49255","#a94136"];return this.each(function(){var i=o(this),r=o.extend({name:"Name",color:null,seed:0,charCount:1,textColor:"#ffffff",height:100,width:100,fontSize:60,fontWeight:400,fontFamily:"HelveticaNeue-Light,Helvetica Neue Light,Helvetica Neue,Helvetica, Arial,Lucida Grande, sans-serif",radius:0},e);r=o.extend(r,i.data());var a=l(r.name,0,r.charCount).toUpperCase(),s=o('<text text-anchor="middle"></text>').attr({y:"50%",x:"50%",dy:"0.35em","pointer-events":"auto",fill:r.textColor,"font-family":r.fontFamily}).html(a).css({"font-weight":r.fontWeight,"font-size":r.fontSize+"px"});if(null==r.color){var u=Math.floor((a.charCodeAt(0)+r.seed)%n.length);t=n[u]}else t=r.color;var c=o("<svg></svg>").attr({xmlns:"http://www.w3.org/2000/svg","pointer-events":"none",width:r.width,height:r.height}).css({"background-color":t,width:r.width+"px",height:r.height+"px","border-radius":r.radius+"px","-moz-border-radius":r.radius+"px"});c.append(s);var d=window.btoa(unescape(encodeURIComponent(o("<div>").append(c.clone()).html())));i.attr("src","data:image/svg+xml;base64,"+d)})},function(){"use strict";function o(e){return angular.isArray(e)?2==e.length?e.concat(e):3==e.length?e.concat([e[1]]):e:[e,e,e,e]}function s(e,t){if(!t)return e;var n=l(t[0])?parseFloat(t[0])*e.height/100:t[0],i=l(t[1])?parseFloat(t[1])*e.width/100:t[1],r=l(t[2])?parseFloat(t[2])*e.height/100:t[2],a=l(t[3])?parseFloat(t[3])*e.width/100:t[3];return{top:e.top-n,left:e.left-a,bottom:e.bottom+r,right:e.right+i,height:e.height+n+r,width:e.width+a+i}}function l(e){return angular.isString(e)&&e.indexOf("%")>0}function u(e){this.didSubscribeFunc=e}function c(e,t){return new u(function(n){var i=function(e){n(e)},r=angular.element(e);t.split(" ").map(e=>r[0].addEventListener(e,i,!0)),n.$dispose=function(){t.split(" ").map(e=>r[0].removeEventListener(e,i,!0))}})}angular.module("angular-inview",[]).directive("inView",["$parse",function(e){return{restrict:"A",require:"?^^inViewContainer",link:function(t,n,i,r){var a={};i.inViewOptions&&(a=t.$eval(i.inViewOptions)),a.offset&&(a.offset=o(a.offset)),a.viewportOffset&&(a.viewportOffset=o(a.viewportOffset));var l,d=(l={type:"initial"},new u(function(e){setTimeout(function(){e(l)})})).merge(c(window,"checkInView click ready wheel mousewheel DomMouseScroll MozMousePixelScroll resize scroll touchmove mouseup keydown"));r&&(d=d.merge(r.eventsSignal)),a.throttle&&(d=d.throttle(a.throttle));var h=d.map(function(e){var t;t=s(t=r?r.getViewportRect():function(){var e={top:0,left:0,width:window.innerWidth,right:window.innerWidth,height:window.innerHeight,bottom:window.innerHeight};return e.height?e:("CSS1Compat"===document.compatMode?(e.width=e.right=document.documentElement.clientWidth,e.height=e.bottom=document.documentElement.clientHeight):(e.width=e.right=document.body.clientWidth,e.height=e.bottom=document.body.clientHeight),e)}(),a.viewportOffset);var i,o,l=s(n[0].getBoundingClientRect(),a.offset),u={inView:!!(n[0].offsetWidth||n[0].offsetHeight||n[0].getClientRects().length)&&(i=l,o=t,!(o.left>i.right||o.right<i.left||o.top>i.bottom||o.bottom<i.top)),event:e,element:n,elementRect:l,viewportRect:t};return a.generateParts&&u.inView&&(u.parts={},u.parts.top=l.top>=t.top,u.parts.left=l.left>=t.left,u.parts.bottom=l.bottom<=t.bottom,u.parts.right=l.right<=t.right),u}).scan({},function(e,t){return a.generateDirection&&t.inView&&e.elementRect&&(t.direction={horizontal:t.elementRect.left-e.elementRect.left,vertical:t.elementRect.top-e.elementRect.top}),t.changed=t.inView!==e.inView||!angular.equals(t.parts,e.parts)||!angular.equals(t.direction,e.direction),t}).filter(function(e){return!(!e.changed||"initial"===e.event.type&&!e.inView)}),p=e(i.inView),f=h.subscribe(function(e){t.$applyAsync(function(){p(t,{$inview:e.inView,$inviewInfo:e})})});t.$on("$destroy",f)}}}]).directive("inViewContainer",function(){return{restrict:"A",controller:["$element",function(e){this.element=e,this.eventsSignal=c(e,"scroll"),this.getViewportRect=function(){return e[0].getBoundingClientRect()}}]}}),u.prototype.subscribe=function(e){return this.didSubscribeFunc(e),function(){e.$dispose&&(e.$dispose(),e.$dispose=null)}},u.prototype.map=function(e){var t=this;return new u(function(n){n.$dispose=t.subscribe(function(t){n(e(t))})})},u.prototype.filter=function(e){var t=this;return new u(function(n){n.$dispose=t.subscribe(function(t){e(t)&&n(t)})})},u.prototype.scan=function(e,t){var n=this;return new u(function(i){var r=e;i.$dispose=n.subscribe(function(e){r=t(r,e),i(r)})})},u.prototype.merge=function(e){return function(){var e=arguments;return new u(function(t){for(var n=[],i=e.length-1;i>=0;i--)n.push(e[i].subscribe(function(){t.apply(null,arguments)}));t.$dispose=function(){for(var e=n.length-1;e>=0;e--)n[e]&&n[e]()}})}(this,e)},u.prototype.throttle=function(e){var t,n,i=this;return new u(function(r){var a=i.subscribe(function(){var i=+new Date,a=arguments;t&&i<t+e?(clearTimeout(n),n=setTimeout(function(){t=i,r.apply(null,a)},e)):(t=i,r.apply(null,a))});r.$dispose=function(){clearTimeout(n),a&&a()}})},r=[n(23)],void 0===(a="function"==typeof(i="angular-inview")?i.apply(t,r):i)||(e.exports=a)}(),org.ekstep.pluginframework.pluginManager.registerPlugin({id:"org.ekstep.collaborator",ver:"1.2",author:"Vivek Kasture",title:"Collaborator plugin",description:"",publishedDate:"",editor:{main:"editor/plugin.js",dependencies:[{type:"css",src:"editor/collaborator.css"},{type:"js",src:"editor/libs/initial.min.js"},{type:"js",src:"editor/libs/angular-inview.js"}]}},org.ekstep.contenteditor.basePlugin.extend({currentInstance:void 0,initialize:function(){var e=this,t=(ecEditor.addEventListener("org.ekstep.collaborator:add",this.loadBrowser,this),ecEditor.resolvePluginResource(e.manifest.id,e.manifest.ver,"editor/collaborator.html"));e=ecEditor.resolvePluginResource(e.manifest.id,e.manifest.ver,"editor/collaboratorApp.js"),ecEditor.getService("popup").loadNgModules(t,e)},loadBrowser:function(e,t){(currentInstance=this).startLoadTime=new Date,ecEditor.getService("popup").open({template:"partials/collaborator",controller:"collaboratorCtrl",controllerAs:"$ctrl",resolve:{instance:function(){return currentInstance}},width:851,showClose:!1,closeByDocument:!1,closeByEscape:!0,className:"ngdialog-theme-plain"},function(){})}}))},function(e,t,n){org.ekstep.pluginframework.pluginManager.registerPlugin({id:"org.ekstep.download",ver:"1.0",author:"Gourav More",title:"download",description:"",publishedDate:"",editor:{main:"editor/plugin.js",menu:[],views:[{template:"./popup.html",controller:""}]}},org.ekstep.contenteditor.basePlugin.extend({type:"download",initialize:function(){ecEditor.addEventListener("download:content",this.downloadContent,this),ecEditor.resolvePluginResource(this.manifest.id,this.manifest.ver,"editor/popup.html"),ecEditor.getService("popup").loadNgModules(n(58),void 0,!0)},downloadContent:function(){var e=this;e.isSending="active",e.isLoading=!1,e.isSuccess=!1,e.isDownloading=!0,ecEditor.getService("popup").open({template:"partials_org.ekstep.download.html",controller:["$scope",function(t){t.isSending=e.isSending,t.isLoading=e.isLoading,t.isSuccess=e.isSuccess,t.isDownloading=e.isDownloading,t.cntName=ecEditor.getService("content").getContentMeta(ecEditor.getContext("contentId")).name,e.getDownloadUrl(function(n){n?(t.isLoading=!0,t.isDownloading=!1,ecEditor.ngSafeApply(ecEditor.getAngularScope()),e.sendEmail(t,n)):(t.isLoading=!1,t.isDownloading=!1,t.status=!1,t.getMessage="Content is not ready to download, please try again later",ecEditor.jQuery(".ct_download_msg").transition("drop"),ecEditor.ngSafeApply(ecEditor.getAngularScope()))})}],showClose:!1,width:900,background:"transparent!important",className:"ngdialog-theme-plain dwContent"})},getDownloadUrl:function(e){var t=ecEditor.getService("content").getContentMeta(ecEditor.getContext("contentId")).name.toLowerCase();ecEditor.getService("content").downloadContent(ecEditor.getContext("contentId"),t,function(t,n){t||"OK"!=n.data.responseCode?e(!1):e(n.data.result.ECAR_URL)})},sendEmail:function(e,t){ecEditor.jQuery.ajax({url:ecEditor.getConfig("baseURL")+"/index.php?option=com_api&app=ekcontent&resource=download&format=raw",headers:{"x-auth":"session"},type:"POST",data:{downloadUrl:t,name:ecEditor.getService("content").getContentMeta(ecEditor.getContext("contentId")).name},success:function(t){e.isLoading=!1,e.status="OK"==t.responseCode,e.getMessage=t.result,ecEditor.jQuery(".ct_download_msg").transition("drop"),ecEditor.ngSafeApply(ecEditor.getAngularScope())},error:function(){e.isLoading=!1,e.status=!1,e.getMessage="Unable to send email, please try again later",ecEditor.jQuery(".ct_download_msg").transition("drop"),ecEditor.ngSafeApply(ecEditor.getAngularScope())}})}}))},function(e,t){e.exports='<script type="text/ng-template" id="partials_org.ekstep.download.html">\n<style>\n.dwContent .ngdialog-content{\n\tbackground: transparent!important;\n}\n</style>\n\t<div class="ui page {{isSending}} inverted dimmer popupZindex" >\n\t\t<div class="content" ng-show="!isLoading && !isDownloading">\n\t\t  <div class="center">\n\t\t\t  <div class="ui icon header">\n\t\t\t\t\t<span ng-show="status"><i class="ct_download_msg checkmark icon"></i></span>\n\t\t\t\t\t<span ng-show="!status"><i class="ct_download_msg warning sign icon"></i></span>\n\t\t\t\t\t{{getMessage}}\n\t\t\t  </div>\n\t\t\t  <div class="actions">\n\t\t\t\t<div class="ui grid">\n\t\t\t\t\t<div class="six wide right floated column">\n\t\t\t\t\t\t<div class="ui green ok button"  ng-click="this.closeThisDialog()">\n\t\t\t\t\t\t  <i class="checkmark icon"></i>\n\t\t\t\t\t\t  Ok\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t  </div>\n\t\t  </div>\n\t\t</div>\n\t\t<div class="content" ng-show="isLoading == true">\n\t\t\t<div class="center">\n\t\t\t\t<div class="ui big text loader">\n\t\t\t\t\t<h2><i class="mail outline icon"></i>\n\t\t\t\t\t\tSending email, please wait....\n\t\t\t\t\t</h2>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t\t<div class="content" ng-show="isDownloading">\n\t\t\t<div class="center">\n\t\t\t\t<div class="ui indeterminate big text loader">\n\t\t\t\t\t<h2><i class="download outline icon"></i>\n\t\t\t\t\t\tPreparing Downloads...\n\t\t\t\t\t</h2>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n<\/script>\n'},function(e,t){org.ekstep.pluginframework.pluginManager.registerPlugin({id:"org.ekstep.unsupported",ver:"1.0",author:"Harish Kumar Gangula",title:"Unsupported Plugin",description:"This plugin is fallback to the other plugins",publishedDate:"",editor:{main:"editor/plugin.js",menu:[],help:{src:"editor/help.md",dataType:"text"}}},org.ekstep.contenteditor.basePlugin.extend({type:"unsupported",initialize:function(){ecEditor.addEventListener("unsupported:invoke",this.showUnsupported,this)},props:{x:0,y:0,w:40,h:40,r:0},hasDims:!1,newInstance:function(){var e=this,t=this.parent,n=(this.parent=void 0,this.setImageDimensions(this.data.data)),i=ecEditor.getConfig("absURL")+ecEditor.resolvePluginResource(this.manifest.id,this.manifest.ver,"assets/unsupportedplugin.png");fabric.Image.fromURL(i,function(n){e.editorObj=n,e.parent=t,e.postInit()},n)},setImageDimensions:function(e){var t=_.clone(this.props);return _.has(e,["x"])&&_.has(e,["w"])&&(this.attributes.x=t.x=e.x,this.attributes.y=t.y=e.y,this.attributes.w=t.w=e.w,this.attributes.h=t.h=e.h,this.percentToPixel(this.attributes),this.hasDims=!0),this.percentToPixel(t),this.convertToFabric(t)},fromECML:function(e){e.data.id=e.data.id||e.data.pluginId,this.setData(e.data)},toECML:function(){var e;return this.hasDims&&(e=_.clone(this.attributes),this.pixelToPercent(e),this.data.data.x=e.x,this.data.data.y=e.y,this.data.data.w=e.w,this.data.data.h=e.h),this.data.data},getCopy:function(){return{data:{data:_.cloneDeep(this.toECML()),pluginId:this.data.id}}},getConfig:function(){},getAttributes:function(){},getManifestId:function(){return this.data.id}}))},function(e,t,n){org.ekstep.pluginframework.pluginManager.registerPlugin({id:"org.ekstep.wordinfobrowser",ver:"1.0",shortId:"wordinfobrowser",author:"Kartheek Palla",title:"Add Word Info Popup",description:"",publishedDate:"",editor:{main:"editor/plugin.js",help:{src:"editor/help.md",dataType:"text"},dependencies:[{type:"css",src:"editor/plugin.css"}],views:[{template:"./wordinfobrowser.html",controller:"./wordinfobrowserapp.js"}],configManifest:[{propertyName:"color",title:"Font color",description:"Choose a color from the color picker",dataType:"colorpicker",required:!0,defaultValue:"rgb(255,0,0)"},{propertyName:"font",dataType:"group",description:"Choose fontweight and fontstyle",config:[{propertyName:"fontweight",title:"Font Weight",toolTip:"Bold",description:"Select font size for the text",dataType:"icon",iconClass:"bold icon",required:!0,defaultValue:!1},{propertyName:"fontstyle",title:"Font Style",toolTip:"Italic",description:"Select font style for the text",dataType:"icon",iconClass:"italic icon",required:!0,defaultValue:!1}]},{propertyName:"fontfamily",title:"Font Family",description:"Select font family for the text",dataType:"select",range:["Arial","Courier","Georgia","Helvetica","Monospace","Sans-serif","Serif","Tahoma","Times","Trebuchet MS","Verdana","NotoSansKannada","NotoSansGujarati","NotoSansBengali","NotoSansGurmukhi","NotoSansOriya","NotoSansDevanagari","NotoSansTamil","NotoSansTelugu","NotoNastaliqUrdu","NotoSansMalayalam"],required:!0,defaultValue:"Sans-serif"},{propertyName:"fontsize",title:"Font Size",description:"Select font size for the text",dataType:"select",range:[18,20,22,24,26,28,32,36,40,44,48,54,60,66,72,80,88,96],required:!0,defaultValue:18},{propertyName:"wordfontcolor",title:"Word Font Color",description:"Choose a color from the color picker to highlight the font color of selected word",dataType:"colorpicker",required:!0,defaultValue:"#0000FF"},{propertyName:"wordhighlightcolor",title:"Word Highlight Color",description:"Choose a color from the color picker to highlight the selected word",dataType:"colorpicker",required:!0,defaultValue:"#FFFF00"},{propertyName:"wordunderlinecolor",title:"Word underline Color",description:"Choose a color from the color picker to underline the selected word",dataType:"colorpicker",required:!0,defaultValue:"#0000FF"}]}},org.ekstep.contenteditor.basePlugin.extend({type:"wordinfobrowser",currentInstance:void 0,cb:void 0,text:void 0,initialize:function(){var e=this;ecEditor.addEventListener("object:unselected",this.objectUnselected,this),ecEditor.addEventListener("delete:invoked",this.deleteObject,this),ecEditor.addEventListener(e.manifest.id+":showpopup",this.loadHtml,this),setTimeout(function(){ecEditor.resolvePluginResource(e.manifest.id,e.manifest.ver,"editor/wordinfobrowser.html"),ecEditor.resolvePluginResource(e.manifest.id,e.manifest.ver,"editor/wordinfobrowserapp.js"),ecEditor.getService("popup").loadNgModules(n(61),n(62),!0)},1e3)},loadHtml:function(e,t){(currentInstance=this).cb=t.callback,this.attributes=t.textObj.attributes,this.config=t.textObj.config,"wordinfo"==t.textObj.attributes.textType&&(this.editorObj=t.textObj.editorObj),ecEditor.getService("popup").open({template:"wordinfobrowser",controller:"wordinfobrowsercontroller",controllerAs:"$ctrl",resolve:{instance:function(){return currentInstance}},width:900,showClose:!1,className:"ngdialog-theme-plain"},function(){})}}))},function(e,t){e.exports='<script type="text/ng-template" ng-app="wordinfobrowserapp" ng-controller="wordinfobrowsercontroller as $ctrl" id="wordinfobrowser">\n<div class="ui modal large active wordinfo-modal">\n    <div class="header">\n        <div class="ui two column grid">\n            <div class="row">\n                <div class="column">\n                    <span><i class="icon-wordinfo icon"></i>Word Info Popup</span>\n                </div>\n                <div class="column wordinfo-modal-close">\n                    <i class="cursor-pointer close icon" ng-click="closeThisDialog()"></i>\n                </div>\n            </div>\n        </div>\n    </div>\n    <div class="content wordinfo-content">\n        <div class="ui segment wordinfo-loading" ng-show="$ctrl.loading">\n            <div class="ui active inverted dimmer">\n                <div class="ui text loader">Just one second, We\'re fetching that content for you.</div>\n            </div>\n        </div>\n        <div ng-if="$ctrl.errorLoadingKeywords" class="ui negative message wordinfo-browser-content">\n            <div class="header">\n                We\'re sorry!\n            </div>\n            <p>There\'s an error while fetching keywords, <a href ng-click="$ctrl.getKeywords()">Click here</a> to try again.\n            </p>\n        </div>\n        <div class="ui grid container" ng-if="!$ctrl.loading && !$ctrl.errorLoadingKeywords">\n            <div class="two column row">\n                <div class="column wordinfo-leftContent">\n                    <div class="ui container" ng-show="!$ctrl.showTypeownText">\n                        <div class="ui container">\n                            <div class="helptext">Your Paragraph</div>\n                            <div class="column textHeight" ng-click="$ctrl.showTextbox()">\n                                {{$ctrl.selectedSentence}}\n                            </div>\n                        </div>\n                        <div class="ui divider"></div>\n                        <div class="ui container">\n                            <div class="helptext">We found the following words in Word Duniya</div>\n                            <div class="ui labels">\n                                <a class="ui large label" ng-class="$ctrl.slectedWords.indexOf(word) > -1 ? \'teal\' : \'\' " ng-repeat="word in $ctrl.keywords track by $index" ng-click="$ctrl.selectWords($index, word, $event)" ng-show="$ctrl.keywords.length > 0 && !$ctrl.showTypeownText">{{word}}</a>\n                            </div>\n                        </div>\n                    </div>\n                    <div class="ui form" ng-show="$ctrl.showTypeownText">\n                        <div class="field" id="editorDiv">\n                            <textarea ng-model="$ctrl.selectedSentence" rows="9" placeholder="Add text here"></textarea>\n                        </div>\n                        <button class="ui right floated primary button" ng-click="$ctrl.getKeywords()" ng-disabled="$ctrl.selectedSentence == \'\'">Get Words</button>\n                    </div>\n                    <div class="ui huge info message" ng-show="$ctrl.keywords.length == 0 && $ctrl.noKeywords">\n                        <p>No Keywords found.</p>\n                    </div>\n                </div>\n                <div class="column wordinfo-rightContent">\n                    Select words from the list to add their meaning as a popup. When the child will tap the word, it will show word information in a popup.<br/><br/>\n                    After selecting words, please check the preview to make sure information is available.<br/><br/>\n                    If there are any words that do not have information, it will show as blank. You can add this information in the Word Duniya.<br/><br/>\n                    Come back to this wizard any time to add / remove words or edit the sentence.\n                </div>\n            </div>\n            \x3c!-- <div class="one column row">\n                Don\'t See the words in Word Duniya? Help us make it better &nbsp;&nbsp;<a ng-href="" target="_blank"> Click Here</a> \n            </div>  --\x3e\n        </div>\n    </div>\n    <div class="actions">\n        <div class="ui buttons" >\n            <button class="ui orange button" ng-click="closeThisDialog()" type="button">Cancel</button>\n            <div class="or"></div>\n            <button class="ui blue button" type="button" ng-click="$ctrl.addToLesson()" ng-disabled="$ctrl.slectedWords.length <= 0 || $ctrl.errorLoadingKeywords">Add To Lesson</button>\n        </div>\n    </div>\n</div>'},function(e,t,n){"use strict";angular.module("wordinfobrowserapp",[]).controller("wordinfobrowsercontroller",["$scope","$injector","instance",function(e,t,n){var i=this;i.selectedSentence=n.config.text,i.showTypeownText=!1,i.textList={},i.keywords=[],i.slectedWords=[],i.prevSlectedWords=[],i.loading=!1,i.noKeywords=!1,i.errorLoadingKeywords=!1,i.template={id:"infoTemplate",g:{x:"0",y:"0",w:"100",h:"100",image:{asset:"org.ekstep.text.popuptint",x:"0",y:"0",w:"100",h:"100",visible:"true",id:"popup-Tint"},text:[{x:"25",y:"25",w:"50",h:"9",visible:"true",editable:"true",model:"word.lemma",weight:"normal",font:"helvetica",color:"rgb(0,0,0)",fontsize:"75",align:"left","z-index":"1",id:"lemma"},{x:"25",y:"35",w:"50",h:"40",visible:"true",editable:"true",model:"word.gloss",weight:"normal",font:"helvetica",color:"rgb(0,0,0)",fontsize:"43",align:"left","z-index":"2",id:"gloss"}],shape:{x:"20",y:"20",w:"60",h:"60",visible:"true",editable:"true",type:"roundrect",radius:"10",opacity:"1",fill:"#45b3a5","stroke-width":"1","z-index":"0",id:"textBg"}}},i.selectWords=function(t,n,r){-1!=ecEditor._.indexOf(i.slectedWords,n)?(i.slectedWords.splice(ecEditor._.indexOf(i.slectedWords,n),1),$(event.target).removeClass("teal"),e.$safeApply()):(i.slectedWords.push(n),$(event.target).addClass("teal"),e.$safeApply())},i.getKeywords=function(){i.loading=!0,i.errorLoadingKeywords=!1,i.keywords=[];var t={request:{language_id:"en",wordSuggestions:!0,relatedWords:!0,translations:!0,equivalentWords:!0,content:i.selectedSentence}};ecEditor.getService("language").getKeyWords(t,function(t,n){return i.loading=!1,t?(i.errorLoadingKeywords=!0,void e.$safeApply()):Object.keys(n.data.result).length<=0?(i.noKeywords=!0,i.showTypeownText=!1,void e.$safeApply()):(i.showTypeownText=!1,void ecEditor._.forEach(n.data.result,function(t,n){i.keywords.push(n),e.$safeApply()}))})},i.getKeywords(),i.addToLesson=function(){var t={request:{filters:{lemma:i.slectedWords,objectType:["Word"],language_id:["en"]}}};ecEditor.getService("language").getWords(t,function(t,r){if(!t){var a={};ecEditor._.forEach(r.data.result.words,function(e){a[e.lemma]={lemma:e.lemma,gloss:ecEditor._.isUndefined(e.meaning)?"":e.meaning}});var o={controller:{id:"dictionary",data:a},template:i.template},s={text:i.selectedSentence,words:i.slectedWords.join(),wordfontcolor:"#0000FF",wordhighlightcolor:"#FFFF00",wordunderlinecolor:"#0000FF"};n.cb(s,o),e.closeThisDialog()}})},i.showTextbox=function(){i.showTypeownText=!0,i.noKeywords=!1},ecEditor._.isUndefined(n.editorObj)||(i.selectedSentence=n.config.text,i.prevSlectedWords=i.slectedWords=ecEditor._.isUndefined(n.config.words)?[]:n.config.words.split(","),e.$safeApply())}])},function(e,t,n){(function(t,i){var r;e.exports=function e(t,n,i){function a(s,l){if(!n[s]){if(!t[s]){if(!l&&("function"==typeof r&&r))return r(s,!0);if(o)return o(s,!0);var u=new Error("Cannot find module '"+s+"'");throw u.code="MODULE_NOT_FOUND",u}var c=n[s]={exports:{}};t[s][0].call(c.exports,function(e){return a(t[s][1][e]||e)},c,c.exports,e,t,n,i)}return n[s].exports}for(var o="function"==typeof r&&r,s=0;s<i.length;s++)a(i[s]);return a}({1:[function(e,t,n){var i=e("./src/converter");t.exports=i},{"./src/converter":25}],2:[function(e,n,i){(function(e){(function(){var t,r=200,a="Expected a function",o="__lodash_hash_undefined__",s="__lodash_placeholder__",l=1,u=2,c=4,d=1,h=2,p=1,f=2,g=4,m=8,v=16,y=32,b=64,_=128,T=256,E=512,C=800,w=16,k=1/0,S=9007199254740991,I=1.7976931348623157e308,O=NaN,D=4294967295,R=D-1,x=D>>>1,A=[["ary",_],["bind",p],["bindKey",f],["curry",m],["curryRight",v],["flip",E],["partial",y],["partialRight",b],["rearg",T]],P="[object Arguments]",L="[object Array]",N="[object AsyncFunction]",M="[object Boolean]",K="[object Date]",$="[object DOMException]",j="[object Error]",B="[object Function]",F="[object GeneratorFunction]",U="[object Map]",V="[object Number]",q="[object Null]",H="[object Object]",z="[object Proxy]",W="[object RegExp]",G="[object Set]",X="[object String]",Y="[object Symbol]",Q="[object Undefined]",J="[object WeakMap]",Z="[object ArrayBuffer]",ee="[object DataView]",te="[object Float32Array]",ne="[object Float64Array]",ie="[object Int8Array]",re="[object Int16Array]",ae="[object Int32Array]",oe="[object Uint8Array]",se="[object Uint8ClampedArray]",le="[object Uint16Array]",ue="[object Uint32Array]",ce=/\b__p \+= '';/g,de=/\b(__p \+=) '' \+/g,he=/(__e\(.*?\)|\b__t\)) \+\n'';/g,pe=/&(?:amp|lt|gt|quot|#39);/g,fe=/[&<>"']/g,ge=RegExp(pe.source),me=RegExp(fe.source),ve=/<%-([\s\S]+?)%>/g,ye=/<%([\s\S]+?)%>/g,be=/<%=([\s\S]+?)%>/g,_e=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Te=/^\w*$/,Ee=/^\./,Ce=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,we=/[\\^$.*+?()[\]{}|]/g,ke=RegExp(we.source),Se=/^\s+|\s+$/g,Ie=/^\s+/,Oe=/\s+$/,De=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,Re=/\{\n\/\* \[wrapped with (.+)\] \*/,xe=/,? & /,Ae=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,Pe=/\\(\\)?/g,Le=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,Ne=/\w*$/,Me=/^[-+]0x[0-9a-f]+$/i,Ke=/^0b[01]+$/i,$e=/^\[object .+?Constructor\]$/,je=/^0o[0-7]+$/i,Be=/^(?:0|[1-9]\d*)$/,Fe=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,Ue=/($^)/,Ve=/['\n\r\u2028\u2029\\]/g,qe="\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff",He="\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",ze="["+He+"]",We="["+qe+"]",Ge="\\d+",Xe="[a-z\\xdf-\\xf6\\xf8-\\xff]",Ye="[^\\ud800-\\udfff"+He+Ge+"\\u2700-\\u27bfa-z\\xdf-\\xf6\\xf8-\\xffA-Z\\xc0-\\xd6\\xd8-\\xde]",Qe="\\ud83c[\\udffb-\\udfff]",Je="[^\\ud800-\\udfff]",Ze="(?:\\ud83c[\\udde6-\\uddff]){2}",et="[\\ud800-\\udbff][\\udc00-\\udfff]",tt="[A-Z\\xc0-\\xd6\\xd8-\\xde]",nt="(?:"+Xe+"|"+Ye+")",it="(?:"+tt+"|"+Ye+")",rt="(?:"+We+"|"+Qe+")"+"?",at="[\\ufe0e\\ufe0f]?"+rt+("(?:\\u200d(?:"+[Je,Ze,et].join("|")+")[\\ufe0e\\ufe0f]?"+rt+")*"),ot="(?:"+["[\\u2700-\\u27bf]",Ze,et].join("|")+")"+at,st="(?:"+[Je+We+"?",We,Ze,et,"[\\ud800-\\udfff]"].join("|")+")",lt=RegExp("['’]","g"),ut=RegExp(We,"g"),ct=RegExp(Qe+"(?="+Qe+")|"+st+at,"g"),dt=RegExp([tt+"?"+Xe+"+(?:['’](?:d|ll|m|re|s|t|ve))?(?="+[ze,tt,"$"].join("|")+")",it+"+(?:['’](?:D|LL|M|RE|S|T|VE))?(?="+[ze,tt+nt,"$"].join("|")+")",tt+"?"+nt+"+(?:['’](?:d|ll|m|re|s|t|ve))?",tt+"+(?:['’](?:D|LL|M|RE|S|T|VE))?","\\d*(?:(?:1ST|2ND|3RD|(?![123])\\dTH)\\b)","\\d*(?:(?:1st|2nd|3rd|(?![123])\\dth)\\b)",Ge,ot].join("|"),"g"),ht=RegExp("[\\u200d\\ud800-\\udfff"+qe+"\\ufe0e\\ufe0f]"),pt=/[a-z][A-Z]|[A-Z]{2,}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,ft=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],gt=-1,mt={};mt[te]=mt[ne]=mt[ie]=mt[re]=mt[ae]=mt[oe]=mt[se]=mt[le]=mt[ue]=!0,mt[P]=mt[L]=mt[Z]=mt[M]=mt[ee]=mt[K]=mt[j]=mt[B]=mt[U]=mt[V]=mt[H]=mt[W]=mt[G]=mt[X]=mt[J]=!1;var vt={};vt[P]=vt[L]=vt[Z]=vt[ee]=vt[M]=vt[K]=vt[te]=vt[ne]=vt[ie]=vt[re]=vt[ae]=vt[U]=vt[V]=vt[H]=vt[W]=vt[G]=vt[X]=vt[Y]=vt[oe]=vt[se]=vt[le]=vt[ue]=!0,vt[j]=vt[B]=vt[J]=!1;var yt={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},bt=parseFloat,_t=parseInt,Tt="object"==typeof e&&e&&e.Object===Object&&e,Et="object"==typeof self&&self&&self.Object===Object&&self,Ct=Tt||Et||Function("return this")(),wt="object"==typeof i&&i&&!i.nodeType&&i,kt=wt&&"object"==typeof n&&n&&!n.nodeType&&n,St=kt&&kt.exports===wt,It=St&&Tt.process,Ot=function(){try{return It&&It.binding&&It.binding("util")}catch(e){}}(),Dt=Ot&&Ot.isArrayBuffer,Rt=Ot&&Ot.isDate,xt=Ot&&Ot.isMap,At=Ot&&Ot.isRegExp,Pt=Ot&&Ot.isSet,Lt=Ot&&Ot.isTypedArray;function Nt(e,t){return e.set(t[0],t[1]),e}function Mt(e,t){return e.add(t),e}function Kt(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)}function $t(e,t,n,i){for(var r=-1,a=null==e?0:e.length;++r<a;){var o=e[r];t(i,o,n(o),e)}return i}function jt(e,t){for(var n=-1,i=null==e?0:e.length;++n<i&&!1!==t(e[n],n,e););return e}function Bt(e,t){for(var n=null==e?0:e.length;n--&&!1!==t(e[n],n,e););return e}function Ft(e,t){for(var n=-1,i=null==e?0:e.length;++n<i;)if(!t(e[n],n,e))return!1;return!0}function Ut(e,t){for(var n=-1,i=null==e?0:e.length,r=0,a=[];++n<i;){var o=e[n];t(o,n,e)&&(a[r++]=o)}return a}function Vt(e,t){return!!(null==e?0:e.length)&&Zt(e,t,0)>-1}function qt(e,t,n){for(var i=-1,r=null==e?0:e.length;++i<r;)if(n(t,e[i]))return!0;return!1}function Ht(e,t){for(var n=-1,i=null==e?0:e.length,r=Array(i);++n<i;)r[n]=t(e[n],n,e);return r}function zt(e,t){for(var n=-1,i=t.length,r=e.length;++n<i;)e[r+n]=t[n];return e}function Wt(e,t,n,i){var r=-1,a=null==e?0:e.length;for(i&&a&&(n=e[++r]);++r<a;)n=t(n,e[r],r,e);return n}function Gt(e,t,n,i){var r=null==e?0:e.length;for(i&&r&&(n=e[--r]);r--;)n=t(n,e[r],r,e);return n}function Xt(e,t){for(var n=-1,i=null==e?0:e.length;++n<i;)if(t(e[n],n,e))return!0;return!1}var Yt=rn("length");function Qt(e,t,n){var i;return n(e,function(e,n,r){if(t(e,n,r))return i=n,!1}),i}function Jt(e,t,n,i){for(var r=e.length,a=n+(i?1:-1);i?a--:++a<r;)if(t(e[a],a,e))return a;return-1}function Zt(e,t,n){return t==t?function(e,t,n){for(var i=n-1,r=e.length;++i<r;)if(e[i]===t)return i;return-1}(e,t,n):Jt(e,tn,n)}function en(e,t,n,i){for(var r=n-1,a=e.length;++r<a;)if(i(e[r],t))return r;return-1}function tn(e){return e!=e}function nn(e,t){var n=null==e?0:e.length;return n?sn(e,t)/n:O}function rn(e){return function(n){return null==n?t:n[e]}}function an(e){return function(n){return null==e?t:e[n]}}function on(e,t,n,i,r){return r(e,function(e,r,a){n=i?(i=!1,e):t(n,e,r,a)}),n}function sn(e,n){for(var i,r=-1,a=e.length;++r<a;){var o=n(e[r]);o!==t&&(i=i===t?o:i+o)}return i}function ln(e,t){for(var n=-1,i=Array(e);++n<e;)i[n]=t(n);return i}function un(e){return function(t){return e(t)}}function cn(e,t){return Ht(t,function(t){return e[t]})}function dn(e,t){return e.has(t)}function hn(e,t){for(var n=-1,i=e.length;++n<i&&Zt(t,e[n],0)>-1;);return n}function pn(e,t){for(var n=e.length;n--&&Zt(t,e[n],0)>-1;);return n}var fn=an({"À":"A","Á":"A","Â":"A","Ã":"A","Ä":"A","Å":"A","à":"a","á":"a","â":"a","ã":"a","ä":"a","å":"a","Ç":"C","ç":"c","Ð":"D","ð":"d","È":"E","É":"E","Ê":"E","Ë":"E","è":"e","é":"e","ê":"e","ë":"e","Ì":"I","Í":"I","Î":"I","Ï":"I","ì":"i","í":"i","î":"i","ï":"i","Ñ":"N","ñ":"n","Ò":"O","Ó":"O","Ô":"O","Õ":"O","Ö":"O","Ø":"O","ò":"o","ó":"o","ô":"o","õ":"o","ö":"o","ø":"o","Ù":"U","Ú":"U","Û":"U","Ü":"U","ù":"u","ú":"u","û":"u","ü":"u","Ý":"Y","ý":"y","ÿ":"y","Æ":"Ae","æ":"ae","Þ":"Th","þ":"th","ß":"ss","Ā":"A","Ă":"A","Ą":"A","ā":"a","ă":"a","ą":"a","Ć":"C","Ĉ":"C","Ċ":"C","Č":"C","ć":"c","ĉ":"c","ċ":"c","č":"c","Ď":"D","Đ":"D","ď":"d","đ":"d","Ē":"E","Ĕ":"E","Ė":"E","Ę":"E","Ě":"E","ē":"e","ĕ":"e","ė":"e","ę":"e","ě":"e","Ĝ":"G","Ğ":"G","Ġ":"G","Ģ":"G","ĝ":"g","ğ":"g","ġ":"g","ģ":"g","Ĥ":"H","Ħ":"H","ĥ":"h","ħ":"h","Ĩ":"I","Ī":"I","Ĭ":"I","Į":"I","İ":"I","ĩ":"i","ī":"i","ĭ":"i","į":"i","ı":"i","Ĵ":"J","ĵ":"j","Ķ":"K","ķ":"k","ĸ":"k","Ĺ":"L","Ļ":"L","Ľ":"L","Ŀ":"L","Ł":"L","ĺ":"l","ļ":"l","ľ":"l","ŀ":"l","ł":"l","Ń":"N","Ņ":"N","Ň":"N","Ŋ":"N","ń":"n","ņ":"n","ň":"n","ŋ":"n","Ō":"O","Ŏ":"O","Ő":"O","ō":"o","ŏ":"o","ő":"o","Ŕ":"R","Ŗ":"R","Ř":"R","ŕ":"r","ŗ":"r","ř":"r","Ś":"S","Ŝ":"S","Ş":"S","Š":"S","ś":"s","ŝ":"s","ş":"s","š":"s","Ţ":"T","Ť":"T","Ŧ":"T","ţ":"t","ť":"t","ŧ":"t","Ũ":"U","Ū":"U","Ŭ":"U","Ů":"U","Ű":"U","Ų":"U","ũ":"u","ū":"u","ŭ":"u","ů":"u","ű":"u","ų":"u","Ŵ":"W","ŵ":"w","Ŷ":"Y","ŷ":"y","Ÿ":"Y","Ź":"Z","Ż":"Z","Ž":"Z","ź":"z","ż":"z","ž":"z","Ĳ":"IJ","ĳ":"ij","Œ":"Oe","œ":"oe","ŉ":"'n","ſ":"s"}),gn=an({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"});function mn(e){return"\\"+yt[e]}function vn(e){return ht.test(e)}function yn(e){var t=-1,n=Array(e.size);return e.forEach(function(e,i){n[++t]=[i,e]}),n}function bn(e,t){return function(n){return e(t(n))}}function _n(e,t){for(var n=-1,i=e.length,r=0,a=[];++n<i;){var o=e[n];o!==t&&o!==s||(e[n]=s,a[r++]=n)}return a}function Tn(e){var t=-1,n=Array(e.size);return e.forEach(function(e){n[++t]=e}),n}function En(e){return vn(e)?function(e){for(var t=ct.lastIndex=0;ct.test(e);)++t;return t}(e):Yt(e)}function Cn(e){return vn(e)?function(e){return e.match(ct)||[]}(e):function(e){return e.split("")}(e)}var wn=an({"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"}),kn=function e(n){var i,qe=(n=null==n?Ct:kn.defaults(Ct.Object(),n,kn.pick(Ct,ft))).Array,He=n.Date,ze=n.Error,We=n.Function,Ge=n.Math,Xe=n.Object,Ye=n.RegExp,Qe=n.String,Je=n.TypeError,Ze=qe.prototype,et=We.prototype,tt=Xe.prototype,nt=n["__core-js_shared__"],it=et.toString,rt=tt.hasOwnProperty,at=0,ot=(i=/[^.]+$/.exec(nt&&nt.keys&&nt.keys.IE_PROTO||""))?"Symbol(src)_1."+i:"",st=tt.toString,ct=it.call(Xe),ht=Ct._,yt=Ye("^"+it.call(rt).replace(we,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Tt=St?n.Buffer:t,Et=n.Symbol,wt=n.Uint8Array,kt=Tt?Tt.allocUnsafe:t,It=bn(Xe.getPrototypeOf,Xe),Ot=Xe.create,Yt=tt.propertyIsEnumerable,an=Ze.splice,Sn=Et?Et.isConcatSpreadable:t,In=Et?Et.iterator:t,On=Et?Et.toStringTag:t,Dn=function(){try{var e=Oa(Xe,"defineProperty");return e({},"",{}),e}catch(e){}}(),Rn=n.clearTimeout!==Ct.clearTimeout&&n.clearTimeout,xn=He&&He.now!==Ct.Date.now&&He.now,An=n.setTimeout!==Ct.setTimeout&&n.setTimeout,Pn=Ge.ceil,Ln=Ge.floor,Nn=Xe.getOwnPropertySymbols,Mn=Tt?Tt.isBuffer:t,Kn=n.isFinite,$n=Ze.join,jn=bn(Xe.keys,Xe),Bn=Ge.max,Fn=Ge.min,Un=He.now,Vn=n.parseInt,qn=Ge.random,Hn=Ze.reverse,zn=Oa(n,"DataView"),Wn=Oa(n,"Map"),Gn=Oa(n,"Promise"),Xn=Oa(n,"Set"),Yn=Oa(n,"WeakMap"),Qn=Oa(Xe,"create"),Jn=Yn&&new Yn,Zn={},ei=Za(zn),ti=Za(Wn),ni=Za(Gn),ii=Za(Xn),ri=Za(Yn),ai=Et?Et.prototype:t,oi=ai?ai.valueOf:t,si=ai?ai.toString:t;function li(e){if(vs(e)&&!os(e)&&!(e instanceof hi)){if(e instanceof di)return e;if(rt.call(e,"__wrapped__"))return eo(e)}return new di(e)}var ui=function(){function e(){}return function(n){if(!ms(n))return{};if(Ot)return Ot(n);e.prototype=n;var i=new e;return e.prototype=t,i}}();function ci(){}function di(e,n){this.__wrapped__=e,this.__actions__=[],this.__chain__=!!n,this.__index__=0,this.__values__=t}function hi(e){this.__wrapped__=e,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=D,this.__views__=[]}function pi(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var i=e[t];this.set(i[0],i[1])}}function fi(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var i=e[t];this.set(i[0],i[1])}}function gi(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var i=e[t];this.set(i[0],i[1])}}function mi(e){var t=-1,n=null==e?0:e.length;for(this.__data__=new gi;++t<n;)this.add(e[t])}function vi(e){var t=this.__data__=new fi(e);this.size=t.size}function yi(e,t){var n=os(e),i=!n&&as(e),r=!n&&!i&&cs(e),a=!n&&!i&&!r&&ks(e),o=n||i||r||a,s=o?ln(e.length,Qe):[],l=s.length;for(var u in e)!t&&!rt.call(e,u)||o&&("length"==u||r&&("offset"==u||"parent"==u)||a&&("buffer"==u||"byteLength"==u||"byteOffset"==u)||Na(u,l))||s.push(u);return s}function bi(e){var n=e.length;return n?e[fr(0,n-1)]:t}function _i(e,n,i){(i===t||ns(e[n],i))&&(i!==t||n in e)||ki(e,n,i)}function Ti(e,n,i){var r=e[n];rt.call(e,n)&&ns(r,i)&&(i!==t||n in e)||ki(e,n,i)}function Ei(e,t){for(var n=e.length;n--;)if(ns(e[n][0],t))return n;return-1}function Ci(e,t,n,i){return Ai(e,function(e,r,a){t(i,e,n(e),a)}),i}function wi(e,t){return e&&Wr(t,Ws(t),e)}function ki(e,t,n){"__proto__"==t&&Dn?Dn(e,t,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[t]=n}function Si(e,n){for(var i=-1,r=n.length,a=qe(r),o=null==e;++i<r;)a[i]=o?t:Us(e,n[i]);return a}function Ii(e,n,i){return e==e&&(i!==t&&(e=e<=i?e:i),n!==t&&(e=e>=n?e:n)),e}function Oi(e,n,i,r,a,o){var s,d=n&l,h=n&u,p=n&c;if(i&&(s=a?i(e,r,a,o):i(e)),s!==t)return s;if(!ms(e))return e;var f=os(e);if(f){if(s=function(e){var t=e.length,n=e.constructor(t);return t&&"string"==typeof e[0]&&rt.call(e,"index")&&(n.index=e.index,n.input=e.input),n}(e),!d)return zr(e,s)}else{var g=xa(e),m=g==B||g==F;if(cs(e))return Br(e,d);if(g==H||g==P||m&&!a){if(s=h||m?{}:Pa(e),!d)return h?function(e,t){return Wr(e,Ra(e),t)}(e,function(e,t){return e&&Wr(t,Gs(t),e)}(s,e)):function(e,t){return Wr(e,Da(e),t)}(e,wi(s,e))}else{if(!vt[g])return a?e:{};s=function(e,t,n,i){var r,a,o,s=e.constructor;switch(t){case Z:return Fr(e);case M:case K:return new s(+e);case ee:return function(e,t){var n=t?Fr(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.byteLength)}(e,i);case te:case ne:case ie:case re:case ae:case oe:case se:case le:case ue:return Ur(e,i);case U:return function(e,t,n){return Wt(t?n(yn(e),l):yn(e),Nt,new e.constructor)}(e,i,n);case V:case X:return new s(e);case W:return(o=new(a=e).constructor(a.source,Ne.exec(a))).lastIndex=a.lastIndex,o;case G:return function(e,t,n){return Wt(t?n(Tn(e),l):Tn(e),Mt,new e.constructor)}(e,i,n);case Y:return r=e,oi?Xe(oi.call(r)):{}}}(e,g,Oi,d)}}o||(o=new vi);var v=o.get(e);if(v)return v;o.set(e,s);var y=f?t:(p?h?Ta:_a:h?Gs:Ws)(e);return jt(y||e,function(t,r){y&&(t=e[r=t]),Ti(s,r,Oi(t,n,i,r,e,o))}),s}function Di(e,n,i){var r=i.length;if(null==e)return!r;for(e=Xe(e);r--;){var a=i[r],o=n[a],s=e[a];if(s===t&&!(a in e)||!o(s))return!1}return!0}function Ri(e,n,i){if("function"!=typeof e)throw new Je(a);return za(function(){e.apply(t,i)},n)}function xi(e,t,n,i){var a=-1,o=Vt,s=!0,l=e.length,u=[],c=t.length;if(!l)return u;n&&(t=Ht(t,un(n))),i?(o=qt,s=!1):t.length>=r&&(o=dn,s=!1,t=new mi(t));e:for(;++a<l;){var d=e[a],h=null==n?d:n(d);if(d=i||0!==d?d:0,s&&h==h){for(var p=c;p--;)if(t[p]===h)continue e;u.push(d)}else o(t,h,i)||u.push(d)}return u}li.templateSettings={escape:ve,evaluate:ye,interpolate:be,variable:"",imports:{_:li}},li.prototype=ci.prototype,li.prototype.constructor=li,di.prototype=ui(ci.prototype),di.prototype.constructor=di,hi.prototype=ui(ci.prototype),hi.prototype.constructor=hi,pi.prototype.clear=function(){this.__data__=Qn?Qn(null):{},this.size=0},pi.prototype.delete=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},pi.prototype.get=function(e){var n=this.__data__;if(Qn){var i=n[e];return i===o?t:i}return rt.call(n,e)?n[e]:t},pi.prototype.has=function(e){var n=this.__data__;return Qn?n[e]!==t:rt.call(n,e)},pi.prototype.set=function(e,n){var i=this.__data__;return this.size+=this.has(e)?0:1,i[e]=Qn&&n===t?o:n,this},fi.prototype.clear=function(){this.__data__=[],this.size=0},fi.prototype.delete=function(e){var t=this.__data__,n=Ei(t,e);return!(n<0)&&(n==t.length-1?t.pop():an.call(t,n,1),--this.size,!0)},fi.prototype.get=function(e){var n=this.__data__,i=Ei(n,e);return i<0?t:n[i][1]},fi.prototype.has=function(e){return Ei(this.__data__,e)>-1},fi.prototype.set=function(e,t){var n=this.__data__,i=Ei(n,e);return i<0?(++this.size,n.push([e,t])):n[i][1]=t,this},gi.prototype.clear=function(){this.size=0,this.__data__={hash:new pi,map:new(Wn||fi),string:new pi}},gi.prototype.delete=function(e){var t=Sa(this,e).delete(e);return this.size-=t?1:0,t},gi.prototype.get=function(e){return Sa(this,e).get(e)},gi.prototype.has=function(e){return Sa(this,e).has(e)},gi.prototype.set=function(e,t){var n=Sa(this,e),i=n.size;return n.set(e,t),this.size+=n.size==i?0:1,this},mi.prototype.add=mi.prototype.push=function(e){return this.__data__.set(e,o),this},mi.prototype.has=function(e){return this.__data__.has(e)},vi.prototype.clear=function(){this.__data__=new fi,this.size=0},vi.prototype.delete=function(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n},vi.prototype.get=function(e){return this.__data__.get(e)},vi.prototype.has=function(e){return this.__data__.has(e)},vi.prototype.set=function(e,t){var n=this.__data__;if(n instanceof fi){var i=n.__data__;if(!Wn||i.length<r-1)return i.push([e,t]),this.size=++n.size,this;n=this.__data__=new gi(i)}return n.set(e,t),this.size=n.size,this};var Ai=Yr(Bi),Pi=Yr(Fi,!0);function Li(e,t){var n=!0;return Ai(e,function(e,i,r){return n=!!t(e,i,r)}),n}function Ni(e,n,i){for(var r=-1,a=e.length;++r<a;){var o=e[r],s=n(o);if(null!=s&&(l===t?s==s&&!ws(s):i(s,l)))var l=s,u=o}return u}function Mi(e,t){var n=[];return Ai(e,function(e,i,r){t(e,i,r)&&n.push(e)}),n}function Ki(e,t,n,i,r){var a=-1,o=e.length;for(n||(n=La),r||(r=[]);++a<o;){var s=e[a];t>0&&n(s)?t>1?Ki(s,t-1,n,i,r):zt(r,s):i||(r[r.length]=s)}return r}var $i=Qr(),ji=Qr(!0);function Bi(e,t){return e&&$i(e,t,Ws)}function Fi(e,t){return e&&ji(e,t,Ws)}function Ui(e,t){return Ut(t,function(t){return ps(e[t])})}function Vi(e,n){for(var i=0,r=(n=Mr(n,e)).length;null!=e&&i<r;)e=e[Ja(n[i++])];return i&&i==r?e:t}function qi(e,t,n){var i=t(e);return os(e)?i:zt(i,n(e))}function Hi(e){return null==e?e===t?Q:q:On&&On in Xe(e)?function(e){var n=rt.call(e,On),i=e[On];try{e[On]=t;var r=!0}catch(e){}var a=st.call(e);return r&&(n?e[On]=i:delete e[On]),a}(e):function(e){return st.call(e)}(e)}function zi(e,t){return e>t}function Wi(e,t){return null!=e&&rt.call(e,t)}function Gi(e,t){return null!=e&&t in Xe(e)}function Xi(e,n,i){for(var r=i?qt:Vt,a=e[0].length,o=e.length,s=o,l=qe(o),u=1/0,c=[];s--;){var d=e[s];s&&n&&(d=Ht(d,un(n))),u=Fn(d.length,u),l[s]=!i&&(n||a>=120&&d.length>=120)?new mi(s&&d):t}d=e[0];var h=-1,p=l[0];e:for(;++h<a&&c.length<u;){var f=d[h],g=n?n(f):f;if(f=i||0!==f?f:0,!(p?dn(p,g):r(c,g,i))){for(s=o;--s;){var m=l[s];if(!(m?dn(m,g):r(e[s],g,i)))continue e}p&&p.push(g),c.push(f)}}return c}function Yi(e,n,i){var r=null==(e=qa(e,n=Mr(n,e)))?e:e[Ja(ho(n))];return null==r?t:Kt(r,e,i)}function Qi(e){return vs(e)&&Hi(e)==P}function Ji(e,t,n,i,r){return e===t||(null==e||null==t||!vs(e)&&!vs(t)?e!=e&&t!=t:Zi(e,t,n,i,Ji,r))}function Zi(e,n,i,r,a,o){var s=os(e),l=os(n),u=s?L:xa(e),c=l?L:xa(n),p=(u=u==P?H:u)==H,f=(c=c==P?H:c)==H,g=u==c;if(g&&cs(e)){if(!cs(n))return!1;s=!0,p=!1}if(g&&!p)return o||(o=new vi),s||ks(e)?ya(e,n,i,r,a,o):function(e,t,n,i,r,a,o){switch(n){case ee:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case Z:return!(e.byteLength!=t.byteLength||!a(new wt(e),new wt(t)));case M:case K:case V:return ns(+e,+t);case j:return e.name==t.name&&e.message==t.message;case W:case X:return e==t+"";case U:var s=yn;case G:var l=i&d;if(s||(s=Tn),e.size!=t.size&&!l)return!1;var u=o.get(e);if(u)return u==t;i|=h,o.set(e,t);var c=ya(s(e),s(t),i,r,a,o);return o.delete(e),c;case Y:if(oi)return oi.call(e)==oi.call(t)}return!1}(e,n,u,i,r,a,o);if(!(i&d)){var m=p&&rt.call(e,"__wrapped__"),v=f&&rt.call(n,"__wrapped__");if(m||v){var y=m?e.value():e,b=v?n.value():n;return o||(o=new vi),a(y,b,i,r,o)}}return!!g&&(o||(o=new vi),function(e,n,i,r,a,o){var s=i&d,l=_a(e),u=l.length;if(u!=_a(n).length&&!s)return!1;for(var c=u;c--;){var h=l[c];if(!(s?h in n:rt.call(n,h)))return!1}var p=o.get(e);if(p&&o.get(n))return p==n;var f=!0;o.set(e,n),o.set(n,e);for(var g=s;++c<u;){var m=e[h=l[c]],v=n[h];if(r)var y=s?r(v,m,h,n,e,o):r(m,v,h,e,n,o);if(!(y===t?m===v||a(m,v,i,r,o):y)){f=!1;break}g||(g="constructor"==h)}if(f&&!g){var b=e.constructor,_=n.constructor;b!=_&&"constructor"in e&&"constructor"in n&&!("function"==typeof b&&b instanceof b&&"function"==typeof _&&_ instanceof _)&&(f=!1)}return o.delete(e),o.delete(n),f}(e,n,i,r,a,o))}function er(e,n,i,r){var a=i.length,o=a,s=!r;if(null==e)return!o;for(e=Xe(e);a--;){var l=i[a];if(s&&l[2]?l[1]!==e[l[0]]:!(l[0]in e))return!1}for(;++a<o;){var u=(l=i[a])[0],c=e[u],p=l[1];if(s&&l[2]){if(c===t&&!(u in e))return!1}else{var f=new vi;if(r)var g=r(c,p,u,e,n,f);if(!(g===t?Ji(p,c,d|h,r,f):g))return!1}}return!0}function tr(e){return!(!ms(e)||ot&&ot in e)&&(ps(e)?yt:$e).test(Za(e))}function nr(e){return"function"==typeof e?e:null==e?bl:"object"==typeof e?os(e)?sr(e[0],e[1]):or(e):Ol(e)}function ir(e){if(!Ba(e))return jn(e);var t=[];for(var n in Xe(e))rt.call(e,n)&&"constructor"!=n&&t.push(n);return t}function rr(e,t){return e<t}function ar(e,t){var n=-1,i=ls(e)?qe(e.length):[];return Ai(e,function(e,r,a){i[++n]=t(e,r,a)}),i}function or(e){var t=Ia(e);return 1==t.length&&t[0][2]?Ua(t[0][0],t[0][1]):function(n){return n===e||er(n,e,t)}}function sr(e,n){return Ka(e)&&Fa(n)?Ua(Ja(e),n):function(i){var r=Us(i,e);return r===t&&r===n?Vs(i,e):Ji(n,r,d|h)}}function lr(e,n,i,r,a){e!==n&&$i(n,function(o,s){if(ms(o))a||(a=new vi),function(e,n,i,r,a,o,s){var l=e[i],u=n[i],c=s.get(u);if(c)_i(e,i,c);else{var d=o?o(l,u,i+"",e,n,s):t,h=d===t;if(h){var p=os(u),f=!p&&cs(u),g=!p&&!f&&ks(u);d=u,p||f||g?os(l)?d=l:us(l)?d=zr(l):f?(h=!1,d=Br(u,!0)):g?(h=!1,d=Ur(u,!0)):d=[]:_s(u)||as(u)?(d=l,as(l)?d=Ps(l):(!ms(l)||r&&ps(l))&&(d=Pa(u))):h=!1}h&&(s.set(u,d),a(d,u,r,o,s),s.delete(u)),_i(e,i,d)}}(e,n,s,i,lr,r,a);else{var l=r?r(e[s],o,s+"",e,n,a):t;l===t&&(l=o),_i(e,s,l)}},Gs)}function ur(e,n){var i=e.length;if(i)return Na(n+=n<0?i:0,i)?e[n]:t}function cr(e,t,n){var i=-1;return t=Ht(t.length?t:[bl],un(ka())),function(e,t){var n=e.length;for(e.sort(t);n--;)e[n]=e[n].value;return e}(ar(e,function(e,n,r){return{criteria:Ht(t,function(t){return t(e)}),index:++i,value:e}}),function(e,t){return function(e,t,n){for(var i=-1,r=e.criteria,a=t.criteria,o=r.length,s=n.length;++i<o;){var l=Vr(r[i],a[i]);if(l)return i>=s?l:l*("desc"==n[i]?-1:1)}return e.index-t.index}(e,t,n)})}function dr(e,t,n){for(var i=-1,r=t.length,a={};++i<r;){var o=t[i],s=Vi(e,o);n(s,o)&&vr(a,Mr(o,e),s)}return a}function hr(e,t,n,i){var r=i?en:Zt,a=-1,o=t.length,s=e;for(e===t&&(t=zr(t)),n&&(s=Ht(e,un(n)));++a<o;)for(var l=0,u=t[a],c=n?n(u):u;(l=r(s,c,l,i))>-1;)s!==e&&an.call(s,l,1),an.call(e,l,1);return e}function pr(e,t){for(var n=e?t.length:0,i=n-1;n--;){var r=t[n];if(n==i||r!==a){var a=r;Na(r)?an.call(e,r,1):Or(e,r)}}return e}function fr(e,t){return e+Ln(qn()*(t-e+1))}function gr(e,t){var n="";if(!e||t<1||t>S)return n;do{t%2&&(n+=e),(t=Ln(t/2))&&(e+=e)}while(t);return n}function mr(e,t){return Wa(Va(e,t,bl),e+"")}function vr(e,n,i,r){if(!ms(e))return e;for(var a=-1,o=(n=Mr(n,e)).length,s=o-1,l=e;null!=l&&++a<o;){var u=Ja(n[a]),c=i;if(a!=s){var d=l[u];(c=r?r(d,u,l):t)===t&&(c=ms(d)?d:Na(n[a+1])?[]:{})}Ti(l,u,c),l=l[u]}return e}var yr=Jn?function(e,t){return Jn.set(e,t),e}:bl,br=Dn?function(e,t){return Dn(e,"toString",{configurable:!0,enumerable:!1,value:ml(t),writable:!0})}:bl;function _r(e,t,n){var i=-1,r=e.length;t<0&&(t=-t>r?0:r+t),(n=n>r?r:n)<0&&(n+=r),r=t>n?0:n-t>>>0,t>>>=0;for(var a=qe(r);++i<r;)a[i]=e[i+t];return a}function Tr(e,t){var n;return Ai(e,function(e,i,r){return!(n=t(e,i,r))}),!!n}function Er(e,t,n){var i=0,r=null==e?i:e.length;if("number"==typeof t&&t==t&&r<=x){for(;i<r;){var a=i+r>>>1,o=e[a];null!==o&&!ws(o)&&(n?o<=t:o<t)?i=a+1:r=a}return r}return Cr(e,t,bl,n)}function Cr(e,n,i,r){n=i(n);for(var a=0,o=null==e?0:e.length,s=n!=n,l=null===n,u=ws(n),c=n===t;a<o;){var d=Ln((a+o)/2),h=i(e[d]),p=h!==t,f=null===h,g=h==h,m=ws(h);if(s)var v=r||g;else v=c?g&&(r||p):l?g&&p&&(r||!f):u?g&&p&&!f&&(r||!m):!f&&!m&&(r?h<=n:h<n);v?a=d+1:o=d}return Fn(o,R)}function wr(e,t){for(var n=-1,i=e.length,r=0,a=[];++n<i;){var o=e[n],s=t?t(o):o;if(!n||!ns(s,l)){var l=s;a[r++]=0===o?0:o}}return a}function kr(e){return"number"==typeof e?e:ws(e)?O:+e}function Sr(e){if("string"==typeof e)return e;if(os(e))return Ht(e,Sr)+"";if(ws(e))return si?si.call(e):"";var t=e+"";return"0"==t&&1/e==-k?"-0":t}function Ir(e,t,n){var i=-1,a=Vt,o=e.length,s=!0,l=[],u=l;if(n)s=!1,a=qt;else if(o>=r){var c=t?null:ha(e);if(c)return Tn(c);s=!1,a=dn,u=new mi}else u=t?[]:l;e:for(;++i<o;){var d=e[i],h=t?t(d):d;if(d=n||0!==d?d:0,s&&h==h){for(var p=u.length;p--;)if(u[p]===h)continue e;t&&u.push(h),l.push(d)}else a(u,h,n)||(u!==l&&u.push(h),l.push(d))}return l}function Or(e,t){return null==(e=qa(e,t=Mr(t,e)))||delete e[Ja(ho(t))]}function Dr(e,t,n,i){return vr(e,t,n(Vi(e,t)),i)}function Rr(e,t,n,i){for(var r=e.length,a=i?r:-1;(i?a--:++a<r)&&t(e[a],a,e););return n?_r(e,i?0:a,i?a+1:r):_r(e,i?a+1:0,i?r:a)}function xr(e,t){var n=e;return n instanceof hi&&(n=n.value()),Wt(t,function(e,t){return t.func.apply(t.thisArg,zt([e],t.args))},n)}function Ar(e,t,n){var i=e.length;if(i<2)return i?Ir(e[0]):[];for(var r=-1,a=qe(i);++r<i;)for(var o=e[r],s=-1;++s<i;)s!=r&&(a[r]=xi(a[r]||o,e[s],t,n));return Ir(Ki(a,1),t,n)}function Pr(e,n,i){for(var r=-1,a=e.length,o=n.length,s={};++r<a;){var l=r<o?n[r]:t;i(s,e[r],l)}return s}function Lr(e){return us(e)?e:[]}function Nr(e){return"function"==typeof e?e:bl}function Mr(e,t){return os(e)?e:Ka(e,t)?[e]:Qa(Ls(e))}var Kr=mr;function $r(e,n,i){var r=e.length;return i=i===t?r:i,!n&&i>=r?e:_r(e,n,i)}var jr=Rn||function(e){return Ct.clearTimeout(e)};function Br(e,t){if(t)return e.slice();var n=e.length,i=kt?kt(n):new e.constructor(n);return e.copy(i),i}function Fr(e){var t=new e.constructor(e.byteLength);return new wt(t).set(new wt(e)),t}function Ur(e,t){var n=t?Fr(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.length)}function Vr(e,n){if(e!==n){var i=e!==t,r=null===e,a=e==e,o=ws(e),s=n!==t,l=null===n,u=n==n,c=ws(n);if(!l&&!c&&!o&&e>n||o&&s&&u&&!l&&!c||r&&s&&u||!i&&u||!a)return 1;if(!r&&!o&&!c&&e<n||c&&i&&a&&!r&&!o||l&&i&&a||!s&&a||!u)return-1}return 0}function qr(e,t,n,i){for(var r=-1,a=e.length,o=n.length,s=-1,l=t.length,u=Bn(a-o,0),c=qe(l+u),d=!i;++s<l;)c[s]=t[s];for(;++r<o;)(d||r<a)&&(c[n[r]]=e[r]);for(;u--;)c[s++]=e[r++];return c}function Hr(e,t,n,i){for(var r=-1,a=e.length,o=-1,s=n.length,l=-1,u=t.length,c=Bn(a-s,0),d=qe(c+u),h=!i;++r<c;)d[r]=e[r];for(var p=r;++l<u;)d[p+l]=t[l];for(;++o<s;)(h||r<a)&&(d[p+n[o]]=e[r++]);return d}function zr(e,t){var n=-1,i=e.length;for(t||(t=qe(i));++n<i;)t[n]=e[n];return t}function Wr(e,n,i,r){var a=!i;i||(i={});for(var o=-1,s=n.length;++o<s;){var l=n[o],u=r?r(i[l],e[l],l,i,e):t;u===t&&(u=e[l]),a?ki(i,l,u):Ti(i,l,u)}return i}function Gr(e,t){return function(n,i){var r=os(n)?$t:Ci,a=t?t():{};return r(n,e,ka(i,2),a)}}function Xr(e){return mr(function(n,i){var r=-1,a=i.length,o=a>1?i[a-1]:t,s=a>2?i[2]:t;for(o=e.length>3&&"function"==typeof o?(a--,o):t,s&&Ma(i[0],i[1],s)&&(o=a<3?t:o,a=1),n=Xe(n);++r<a;){var l=i[r];l&&e(n,l,r,o)}return n})}function Yr(e,t){return function(n,i){if(null==n)return n;if(!ls(n))return e(n,i);for(var r=n.length,a=t?r:-1,o=Xe(n);(t?a--:++a<r)&&!1!==i(o[a],a,o););return n}}function Qr(e){return function(t,n,i){for(var r=-1,a=Xe(t),o=i(t),s=o.length;s--;){var l=o[e?s:++r];if(!1===n(a[l],l,a))break}return t}}function Jr(e){return function(n){var i=vn(n=Ls(n))?Cn(n):t,r=i?i[0]:n.charAt(0),a=i?$r(i,1).join(""):n.slice(1);return r[e]()+a}}function Zr(e){return function(t){return Wt(pl(al(t).replace(lt,"")),e,"")}}function ea(e){return function(){var t=arguments;switch(t.length){case 0:return new e;case 1:return new e(t[0]);case 2:return new e(t[0],t[1]);case 3:return new e(t[0],t[1],t[2]);case 4:return new e(t[0],t[1],t[2],t[3]);case 5:return new e(t[0],t[1],t[2],t[3],t[4]);case 6:return new e(t[0],t[1],t[2],t[3],t[4],t[5]);case 7:return new e(t[0],t[1],t[2],t[3],t[4],t[5],t[6])}var n=ui(e.prototype),i=e.apply(n,t);return ms(i)?i:n}}function ta(e){return function(n,i,r){var a=Xe(n);if(!ls(n)){var o=ka(i,3);n=Ws(n),i=function(e){return o(a[e],e,a)}}var s=e(n,i,r);return s>-1?a[o?n[s]:s]:t}}function na(e){return ba(function(n){var i=n.length,r=i,o=di.prototype.thru;for(e&&n.reverse();r--;){var s=n[r];if("function"!=typeof s)throw new Je(a);if(o&&!l&&"wrapper"==Ca(s))var l=new di([],!0)}for(r=l?r:i;++r<i;){var u=Ca(s=n[r]),c="wrapper"==u?Ea(s):t;l=c&&$a(c[0])&&c[1]==(_|m|y|T)&&!c[4].length&&1==c[9]?l[Ca(c[0])].apply(l,c[3]):1==s.length&&$a(s)?l[u]():l.thru(s)}return function(){var e=arguments,t=e[0];if(l&&1==e.length&&os(t))return l.plant(t).value();for(var r=0,a=i?n[r].apply(this,e):t;++r<i;)a=n[r].call(this,a);return a}})}function ia(e,n,i,r,a,o,s,l,u,c){var d=n&_,h=n&p,g=n&f,y=n&(m|v),b=n&E,T=g?t:ea(e);return function p(){for(var f=arguments.length,m=qe(f),v=f;v--;)m[v]=arguments[v];if(y)var _=wa(p),E=function(e,t){for(var n=e.length,i=0;n--;)e[n]===t&&++i;return i}(m,_);if(r&&(m=qr(m,r,a,y)),o&&(m=Hr(m,o,s,y)),f-=E,y&&f<c){var C=_n(m,_);return ca(e,n,ia,p.placeholder,i,m,C,l,u,c-f)}var w=h?i:this,k=g?w[e]:e;return f=m.length,l?m=function(e,n){for(var i=e.length,r=Fn(n.length,i),a=zr(e);r--;){var o=n[r];e[r]=Na(o,i)?a[o]:t}return e}(m,l):b&&f>1&&m.reverse(),d&&u<f&&(m.length=u),this&&this!==Ct&&this instanceof p&&(k=T||ea(k)),k.apply(w,m)}}function ra(e,t){return function(n,i){return function(e,t,n,i){return Bi(e,function(e,r,a){t(i,n(e),r,a)}),i}(n,e,t(i),{})}}function aa(e,n){return function(i,r){var a;if(i===t&&r===t)return n;if(i!==t&&(a=i),r!==t){if(a===t)return r;"string"==typeof i||"string"==typeof r?(i=Sr(i),r=Sr(r)):(i=kr(i),r=kr(r)),a=e(i,r)}return a}}function oa(e){return ba(function(t){return t=Ht(t,un(ka())),mr(function(n){var i=this;return e(t,function(e){return Kt(e,i,n)})})})}function sa(e,n){var i=(n=n===t?" ":Sr(n)).length;if(i<2)return i?gr(n,e):n;var r=gr(n,Pn(e/En(n)));return vn(n)?$r(Cn(r),0,e).join(""):r.slice(0,e)}function la(e){return function(n,i,r){return r&&"number"!=typeof r&&Ma(n,i,r)&&(i=r=t),n=Ds(n),i===t?(i=n,n=0):i=Ds(i),function(e,t,n,i){for(var r=-1,a=Bn(Pn((t-e)/(n||1)),0),o=qe(a);a--;)o[i?a:++r]=e,e+=n;return o}(n,i,r=r===t?n<i?1:-1:Ds(r),e)}}function ua(e){return function(t,n){return"string"==typeof t&&"string"==typeof n||(t=As(t),n=As(n)),e(t,n)}}function ca(e,n,i,r,a,o,s,l,u,c){var d=n&m;n|=d?y:b,(n&=~(d?b:y))&g||(n&=~(p|f));var h=[e,n,a,d?o:t,d?s:t,d?t:o,d?t:s,l,u,c],v=i.apply(t,h);return $a(e)&&Ha(v,h),v.placeholder=r,Ga(v,e,n)}function da(e){var t=Ge[e];return function(e,n){if(e=As(e),n=null==n?0:Fn(Rs(n),292)){var i=(Ls(e)+"e").split("e");return+((i=(Ls(t(i[0]+"e"+(+i[1]+n)))+"e").split("e"))[0]+"e"+(+i[1]-n))}return t(e)}}var ha=Xn&&1/Tn(new Xn([,-0]))[1]==k?function(e){return new Xn(e)}:wl;function pa(e){return function(t){var n=xa(t);return n==U?yn(t):n==G?function(e){var t=-1,n=Array(e.size);return e.forEach(function(e){n[++t]=[e,e]}),n}(t):function(e,t){return Ht(t,function(t){return[t,e[t]]})}(t,e(t))}}function fa(e,n,i,r,o,l,u,c){var d=n&f;if(!d&&"function"!=typeof e)throw new Je(a);var h=r?r.length:0;if(h||(n&=~(y|b),r=o=t),u=u===t?u:Bn(Rs(u),0),c=c===t?c:Rs(c),h-=o?o.length:0,n&b){var E=r,C=o;r=o=t}var w=d?t:Ea(e),k=[e,n,i,r,o,E,C,l,u,c];if(w&&function(e,t){var n=e[1],i=t[1],r=n|i,a=r<(p|f|_),o=i==_&&n==m||i==_&&n==T&&e[7].length<=t[8]||i==(_|T)&&t[7].length<=t[8]&&n==m;if(!a&&!o)return e;i&p&&(e[2]=t[2],r|=n&p?0:g);var l=t[3];if(l){var u=e[3];e[3]=u?qr(u,l,t[4]):l,e[4]=u?_n(e[3],s):t[4]}(l=t[5])&&(u=e[5],e[5]=u?Hr(u,l,t[6]):l,e[6]=u?_n(e[5],s):t[6]),(l=t[7])&&(e[7]=l),i&_&&(e[8]=null==e[8]?t[8]:Fn(e[8],t[8])),null==e[9]&&(e[9]=t[9]),e[0]=t[0],e[1]=r}(k,w),e=k[0],n=k[1],i=k[2],r=k[3],o=k[4],!(c=k[9]=k[9]===t?d?0:e.length:Bn(k[9]-h,0))&&n&(m|v)&&(n&=~(m|v)),n&&n!=p)S=n==m||n==v?function(e,n,i){var r=ea(e);return function a(){for(var o=arguments.length,s=qe(o),l=o,u=wa(a);l--;)s[l]=arguments[l];var c=o<3&&s[0]!==u&&s[o-1]!==u?[]:_n(s,u);return(o-=c.length)<i?ca(e,n,ia,a.placeholder,t,s,c,t,t,i-o):Kt(this&&this!==Ct&&this instanceof a?r:e,this,s)}}(e,n,c):n!=y&&n!=(p|y)||o.length?ia.apply(t,k):function(e,t,n,i){var r=t&p,a=ea(e);return function t(){for(var o=-1,s=arguments.length,l=-1,u=i.length,c=qe(u+s),d=this&&this!==Ct&&this instanceof t?a:e;++l<u;)c[l]=i[l];for(;s--;)c[l++]=arguments[++o];return Kt(d,r?n:this,c)}}(e,n,i,r);else var S=function(e,t,n){var i=t&p,r=ea(e);return function t(){return(this&&this!==Ct&&this instanceof t?r:e).apply(i?n:this,arguments)}}(e,n,i);return Ga((w?yr:Ha)(S,k),e,n)}function ga(e,n,i,r){return e===t||ns(e,tt[i])&&!rt.call(r,i)?n:e}function ma(e,n,i,r,a,o){return ms(e)&&ms(n)&&(o.set(n,e),lr(e,n,t,ma,o),o.delete(n)),e}function va(e){return _s(e)?t:e}function ya(e,n,i,r,a,o){var s=i&d,l=e.length,u=n.length;if(l!=u&&!(s&&u>l))return!1;var c=o.get(e);if(c&&o.get(n))return c==n;var p=-1,f=!0,g=i&h?new mi:t;for(o.set(e,n),o.set(n,e);++p<l;){var m=e[p],v=n[p];if(r)var y=s?r(v,m,p,n,e,o):r(m,v,p,e,n,o);if(y!==t){if(y)continue;f=!1;break}if(g){if(!Xt(n,function(e,t){if(!dn(g,t)&&(m===e||a(m,e,i,r,o)))return g.push(t)})){f=!1;break}}else if(m!==v&&!a(m,v,i,r,o)){f=!1;break}}return o.delete(e),o.delete(n),f}function ba(e){return Wa(Va(e,t,oo),e+"")}function _a(e){return qi(e,Ws,Da)}function Ta(e){return qi(e,Gs,Ra)}var Ea=Jn?function(e){return Jn.get(e)}:wl;function Ca(e){for(var t=e.name+"",n=Zn[t],i=rt.call(Zn,t)?n.length:0;i--;){var r=n[i],a=r.func;if(null==a||a==e)return r.name}return t}function wa(e){return(rt.call(li,"placeholder")?li:e).placeholder}function ka(){var e=li.iteratee||_l;return e=e===_l?nr:e,arguments.length?e(arguments[0],arguments[1]):e}function Sa(e,t){var n,i,r=e.__data__;return("string"==(i=typeof(n=t))||"number"==i||"symbol"==i||"boolean"==i?"__proto__"!==n:null===n)?r["string"==typeof t?"string":"hash"]:r.map}function Ia(e){for(var t=Ws(e),n=t.length;n--;){var i=t[n],r=e[i];t[n]=[i,r,Fa(r)]}return t}function Oa(e,n){var i=function(e,n){return null==e?t:e[n]}(e,n);return tr(i)?i:t}var Da=Nn?function(e){return null==e?[]:(e=Xe(e),Ut(Nn(e),function(t){return Yt.call(e,t)}))}:xl,Ra=Nn?function(e){for(var t=[];e;)zt(t,Da(e)),e=It(e);return t}:xl,xa=Hi;function Aa(e,t,n){for(var i=-1,r=(t=Mr(t,e)).length,a=!1;++i<r;){var o=Ja(t[i]);if(!(a=null!=e&&n(e,o)))break;e=e[o]}return a||++i!=r?a:!!(r=null==e?0:e.length)&&gs(r)&&Na(o,r)&&(os(e)||as(e))}function Pa(e){return"function"!=typeof e.constructor||Ba(e)?{}:ui(It(e))}function La(e){return os(e)||as(e)||!!(Sn&&e&&e[Sn])}function Na(e,t){return!!(t=null==t?S:t)&&("number"==typeof e||Be.test(e))&&e>-1&&e%1==0&&e<t}function Ma(e,t,n){if(!ms(n))return!1;var i=typeof t;return!!("number"==i?ls(n)&&Na(t,n.length):"string"==i&&t in n)&&ns(n[t],e)}function Ka(e,t){if(os(e))return!1;var n=typeof e;return!("number"!=n&&"symbol"!=n&&"boolean"!=n&&null!=e&&!ws(e))||Te.test(e)||!_e.test(e)||null!=t&&e in Xe(t)}function $a(e){var t=Ca(e),n=li[t];if("function"!=typeof n||!(t in hi.prototype))return!1;if(e===n)return!0;var i=Ea(n);return!!i&&e===i[0]}(zn&&xa(new zn(new ArrayBuffer(1)))!=ee||Wn&&xa(new Wn)!=U||Gn&&"[object Promise]"!=xa(Gn.resolve())||Xn&&xa(new Xn)!=G||Yn&&xa(new Yn)!=J)&&(xa=function(e){var n=Hi(e),i=n==H?e.constructor:t,r=i?Za(i):"";if(r)switch(r){case ei:return ee;case ti:return U;case ni:return"[object Promise]";case ii:return G;case ri:return J}return n});var ja=nt?ps:Al;function Ba(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||tt)}function Fa(e){return e==e&&!ms(e)}function Ua(e,n){return function(i){return null!=i&&i[e]===n&&(n!==t||e in Xe(i))}}function Va(e,n,i){return n=Bn(n===t?e.length-1:n,0),function(){for(var t=arguments,r=-1,a=Bn(t.length-n,0),o=qe(a);++r<a;)o[r]=t[n+r];r=-1;for(var s=qe(n+1);++r<n;)s[r]=t[r];return s[n]=i(o),Kt(e,this,s)}}function qa(e,t){return t.length<2?e:Vi(e,_r(t,0,-1))}var Ha=Xa(yr),za=An||function(e,t){return Ct.setTimeout(e,t)},Wa=Xa(br);function Ga(e,t,n){var i=t+"";return Wa(e,function(e,t){var n=t.length;if(!n)return e;var i=n-1;return t[i]=(n>1?"& ":"")+t[i],t=t.join(n>2?", ":" "),e.replace(De,"{\n/* [wrapped with "+t+"] */\n")}(i,function(e,t){return jt(A,function(n){var i="_."+n[0];t&n[1]&&!Vt(e,i)&&e.push(i)}),e.sort()}(function(e){var t=i.match(Re);return t?t[1].split(xe):[]}(),n)))}function Xa(e){var n=0,i=0;return function(){var r=Un(),a=w-(r-i);if(i=r,a>0){if(++n>=C)return arguments[0]}else n=0;return e.apply(t,arguments)}}function Ya(e,n){var i=-1,r=e.length,a=r-1;for(n=n===t?r:n;++i<n;){var o=fr(i,a),s=e[o];e[o]=e[i],e[i]=s}return e.length=n,e}var Qa=function(e){var t=Yo(function(e){var t=[];return Ee.test(e)&&t.push(""),e.replace(Ce,function(e,n,i,r){t.push(i?r.replace(Pe,"$1"):n||e)}),t},function(e){return 500===n.size&&n.clear(),e}),n=t.cache;return t}();function Ja(e){if("string"==typeof e||ws(e))return e;var t=e+"";return"0"==t&&1/e==-k?"-0":t}function Za(e){if(null!=e){try{return it.call(e)}catch(e){}try{return e+""}catch(e){}}return""}function eo(e){if(e instanceof hi)return e.clone();var t=new di(e.__wrapped__,e.__chain__);return t.__actions__=zr(e.__actions__),t.__index__=e.__index__,t.__values__=e.__values__,t}var to=mr(function(e,t){return us(e)?xi(e,Ki(t,1,us,!0)):[]}),no=mr(function(e,n){var i=ho(n);return us(i)&&(i=t),us(e)?xi(e,Ki(n,1,us,!0),ka(i,2)):[]}),io=mr(function(e,n){var i=ho(n);return us(i)&&(i=t),us(e)?xi(e,Ki(n,1,us,!0),t,i):[]});function ro(e,t,n){var i=null==e?0:e.length;if(!i)return-1;var r=null==n?0:Rs(n);return r<0&&(r=Bn(i+r,0)),Jt(e,ka(t,3),r)}function ao(e,n,i){var r=null==e?0:e.length;if(!r)return-1;var a=r-1;return i!==t&&(a=Rs(i),a=i<0?Bn(r+a,0):Fn(a,r-1)),Jt(e,ka(n,3),a,!0)}function oo(e){return(null==e?0:e.length)?Ki(e,1):[]}function so(e){return e&&e.length?e[0]:t}var lo=mr(function(e){var t=Ht(e,Lr);return t.length&&t[0]===e[0]?Xi(t):[]}),uo=mr(function(e){var n=ho(e),i=Ht(e,Lr);return n===ho(i)?n=t:i.pop(),i.length&&i[0]===e[0]?Xi(i,ka(n,2)):[]}),co=mr(function(e){var n=ho(e),i=Ht(e,Lr);return(n="function"==typeof n?n:t)&&i.pop(),i.length&&i[0]===e[0]?Xi(i,t,n):[]});function ho(e){var n=null==e?0:e.length;return n?e[n-1]:t}var po=mr(fo);function fo(e,t){return e&&e.length&&t&&t.length?hr(e,t):e}var go=ba(function(e,t){var n=null==e?0:e.length,i=Si(e,t);return pr(e,Ht(t,function(e){return Na(e,n)?+e:e}).sort(Vr)),i});function mo(e){return null==e?e:Hn.call(e)}var vo=mr(function(e){return Ir(Ki(e,1,us,!0))}),yo=mr(function(e){var n=ho(e);return us(n)&&(n=t),Ir(Ki(e,1,us,!0),ka(n,2))}),bo=mr(function(e){var n=ho(e);return n="function"==typeof n?n:t,Ir(Ki(e,1,us,!0),t,n)});function _o(e){if(!e||!e.length)return[];var t=0;return e=Ut(e,function(e){if(us(e))return t=Bn(e.length,t),!0}),ln(t,function(t){return Ht(e,rn(t))})}function To(e,n){if(!e||!e.length)return[];var i=_o(e);return null==n?i:Ht(i,function(e){return Kt(n,t,e)})}var Eo=mr(function(e,t){return us(e)?xi(e,t):[]}),Co=mr(function(e){return Ar(Ut(e,us))}),wo=mr(function(e){var n=ho(e);return us(n)&&(n=t),Ar(Ut(e,us),ka(n,2))}),ko=mr(function(e){var n=ho(e);return n="function"==typeof n?n:t,Ar(Ut(e,us),t,n)}),So=mr(_o),Io=mr(function(e){var n=e.length,i=n>1?e[n-1]:t;return To(e,i="function"==typeof i?(e.pop(),i):t)});function Oo(e){var t=li(e);return t.__chain__=!0,t}function Do(e,t){return t(e)}var Ro=ba(function(e){var n=e.length,i=n?e[0]:0,r=this.__wrapped__,a=function(t){return Si(t,e)};return!(n>1||this.__actions__.length)&&r instanceof hi&&Na(i)?((r=r.slice(i,+i+(n?1:0))).__actions__.push({func:Do,args:[a],thisArg:t}),new di(r,this.__chain__).thru(function(e){return n&&!e.length&&e.push(t),e})):this.thru(a)}),xo=Gr(function(e,t,n){rt.call(e,n)?++e[n]:ki(e,n,1)}),Ao=ta(ro),Po=ta(ao);function Lo(e,t){return(os(e)?jt:Ai)(e,ka(t,3))}function No(e,t){return(os(e)?Bt:Pi)(e,ka(t,3))}var Mo=Gr(function(e,t,n){rt.call(e,n)?e[n].push(t):ki(e,n,[t])}),Ko=mr(function(e,t,n){var i=-1,r="function"==typeof t,a=ls(e)?qe(e.length):[];return Ai(e,function(e){a[++i]=r?Kt(t,e,n):Yi(e,t,n)}),a}),$o=Gr(function(e,t,n){ki(e,n,t)});function jo(e,t){return(os(e)?Ht:ar)(e,ka(t,3))}var Bo=Gr(function(e,t,n){e[n?0:1].push(t)},function(){return[[],[]]}),Fo=mr(function(e,t){if(null==e)return[];var n=t.length;return n>1&&Ma(e,t[0],t[1])?t=[]:n>2&&Ma(t[0],t[1],t[2])&&(t=[t[0]]),cr(e,Ki(t,1),[])}),Uo=xn||function(){return Ct.Date.now()};function Vo(e,n,i){return n=i?t:n,n=e&&null==n?e.length:n,fa(e,_,t,t,t,t,n)}function qo(e,n){var i;if("function"!=typeof n)throw new Je(a);return e=Rs(e),function(){return--e>0&&(i=n.apply(this,arguments)),e<=1&&(n=t),i}}var Ho=mr(function(e,t,n){var i=p;if(n.length){var r=_n(n,wa(Ho));i|=y}return fa(e,i,t,n,r)}),zo=mr(function(e,t,n){var i=p|f;if(n.length){var r=_n(n,wa(zo));i|=y}return fa(t,i,e,n,r)});function Wo(e,n,i){var r,o,s,l,u,c,d=0,h=!1,p=!1,f=!0;if("function"!=typeof e)throw new Je(a);function g(n){var i=r,a=o;return r=o=t,d=n,l=e.apply(a,i)}function m(e){var i=e-c;return c===t||i>=n||i<0||p&&e-d>=s}function v(){var e=Uo();if(m(e))return y(e);u=za(v,function(e){var t=n-(e-c);return p?Fn(t,s-(e-d)):t}(e))}function y(e){return u=t,f&&r?g(e):(r=o=t,l)}function b(){var e=Uo(),i=m(e);if(r=arguments,o=this,c=e,i){if(u===t)return function(e){return d=e,u=za(v,n),h?g(e):l}(c);if(p)return u=za(v,n),g(c)}return u===t&&(u=za(v,n)),l}return n=As(n)||0,ms(i)&&(h=!!i.leading,s=(p="maxWait"in i)?Bn(As(i.maxWait)||0,n):s,f="trailing"in i?!!i.trailing:f),b.cancel=function(){u!==t&&jr(u),d=0,r=c=o=u=t},b.flush=function(){return u===t?l:y(Uo())},b}var Go=mr(function(e,t){return Ri(e,1,t)}),Xo=mr(function(e,t,n){return Ri(e,As(t)||0,n)});function Yo(e,t){if("function"!=typeof e||null!=t&&"function"!=typeof t)throw new Je(a);var n=function(){var i=arguments,r=t?t.apply(this,i):i[0],a=n.cache;if(a.has(r))return a.get(r);var o=e.apply(this,i);return n.cache=a.set(r,o)||a,o};return n.cache=new(Yo.Cache||gi),n}function Qo(e){if("function"!=typeof e)throw new Je(a);return function(){var t=arguments;switch(t.length){case 0:return!e.call(this);case 1:return!e.call(this,t[0]);case 2:return!e.call(this,t[0],t[1]);case 3:return!e.call(this,t[0],t[1],t[2])}return!e.apply(this,t)}}Yo.Cache=gi;var Jo=Kr(function(e,t){var n=(t=1==t.length&&os(t[0])?Ht(t[0],un(ka())):Ht(Ki(t,1),un(ka()))).length;return mr(function(i){for(var r=-1,a=Fn(i.length,n);++r<a;)i[r]=t[r].call(this,i[r]);return Kt(e,this,i)})}),Zo=mr(function(e,n){var i=_n(n,wa(Zo));return fa(e,y,t,n,i)}),es=mr(function(e,n){var i=_n(n,wa(es));return fa(e,b,t,n,i)}),ts=ba(function(e,n){return fa(e,T,t,t,t,n)});function ns(e,t){return e===t||e!=e&&t!=t}var is=ua(zi),rs=ua(function(e,t){return e>=t}),as=Qi(function(){return arguments}())?Qi:function(e){return vs(e)&&rt.call(e,"callee")&&!Yt.call(e,"callee")},os=qe.isArray,ss=Dt?un(Dt):function(e){return vs(e)&&Hi(e)==Z};function ls(e){return null!=e&&gs(e.length)&&!ps(e)}function us(e){return vs(e)&&ls(e)}var cs=Mn||Al,ds=Rt?un(Rt):function(e){return vs(e)&&Hi(e)==K};function hs(e){if(!vs(e))return!1;var t=Hi(e);return t==j||t==$||"string"==typeof e.message&&"string"==typeof e.name&&!_s(e)}function ps(e){if(!ms(e))return!1;var t=Hi(e);return t==B||t==F||t==N||t==z}function fs(e){return"number"==typeof e&&e==Rs(e)}function gs(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=S}function ms(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}function vs(e){return null!=e&&"object"==typeof e}var ys=xt?un(xt):function(e){return vs(e)&&xa(e)==U};function bs(e){return"number"==typeof e||vs(e)&&Hi(e)==V}function _s(e){if(!vs(e)||Hi(e)!=H)return!1;var t=It(e);if(null===t)return!0;var n=rt.call(t,"constructor")&&t.constructor;return"function"==typeof n&&n instanceof n&&it.call(n)==ct}var Ts=At?un(At):function(e){return vs(e)&&Hi(e)==W},Es=Pt?un(Pt):function(e){return vs(e)&&xa(e)==G};function Cs(e){return"string"==typeof e||!os(e)&&vs(e)&&Hi(e)==X}function ws(e){return"symbol"==typeof e||vs(e)&&Hi(e)==Y}var ks=Lt?un(Lt):function(e){return vs(e)&&gs(e.length)&&!!mt[Hi(e)]},Ss=ua(rr),Is=ua(function(e,t){return e<=t});function Os(e){if(!e)return[];if(ls(e))return Cs(e)?Cn(e):zr(e);if(In&&e[In])return function(e){for(var t,n=[];!(t=e.next()).done;)n.push(t.value);return n}(e[In]());var t=xa(e);return(t==U?yn:t==G?Tn:nl)(e)}function Ds(e){return e?(e=As(e))===k||e===-k?(e<0?-1:1)*I:e==e?e:0:0===e?e:0}function Rs(e){var t=Ds(e),n=t%1;return t==t?n?t-n:t:0}function xs(e){return e?Ii(Rs(e),0,D):0}function As(e){if("number"==typeof e)return e;if(ws(e))return O;if(ms(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=ms(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(Se,"");var n=Ke.test(e);return n||je.test(e)?_t(e.slice(2),n?2:8):Me.test(e)?O:+e}function Ps(e){return Wr(e,Gs(e))}function Ls(e){return null==e?"":Sr(e)}var Ns=Xr(function(e,t){if(Ba(t)||ls(t))Wr(t,Ws(t),e);else for(var n in t)rt.call(t,n)&&Ti(e,n,t[n])}),Ms=Xr(function(e,t){Wr(t,Gs(t),e)}),Ks=Xr(function(e,t,n,i){Wr(t,Gs(t),e,i)}),$s=Xr(function(e,t,n,i){Wr(t,Ws(t),e,i)}),js=ba(Si),Bs=mr(function(e){return e.push(t,ga),Kt(Ks,t,e)}),Fs=mr(function(e){return e.push(t,ma),Kt(Ys,t,e)});function Us(e,n,i){var r=null==e?t:Vi(e,n);return r===t?i:r}function Vs(e,t){return null!=e&&Aa(e,t,Gi)}var qs=ra(function(e,t,n){e[t]=n},ml(bl)),Hs=ra(function(e,t,n){rt.call(e,t)?e[t].push(n):e[t]=[n]},ka),zs=mr(Yi);function Ws(e){return ls(e)?yi(e):ir(e)}function Gs(e){return ls(e)?yi(e,!0):function(e){if(!ms(e))return function(e){var t=[];if(null!=e)for(var n in Xe(e))t.push(n);return t}(e);var t=Ba(e),n=[];for(var i in e)("constructor"!=i||!t&&rt.call(e,i))&&n.push(i);return n}(e)}var Xs=Xr(function(e,t,n){lr(e,t,n)}),Ys=Xr(function(e,t,n,i){lr(e,t,n,i)}),Qs=ba(function(e,t){var n={};if(null==e)return n;var i=!1;t=Ht(t,function(t){return t=Mr(t,e),i||(i=t.length>1),t}),Wr(e,Ta(e),n),i&&(n=Oi(n,l|u|c,va));for(var r=t.length;r--;)Or(n,t[r]);return n}),Js=ba(function(e,t){return null==e?{}:function(e,t){return dr(e,t,function(t,n){return Vs(e,n)})}(e,t)});function Zs(e,t){if(null==e)return{};var n=Ht(Ta(e),function(e){return[e]});return t=ka(t),dr(e,n,function(e,n){return t(e,n[0])})}var el=pa(Ws),tl=pa(Gs);function nl(e){return null==e?[]:cn(e,Ws(e))}var il=Zr(function(e,t,n){return t=t.toLowerCase(),e+(n?rl(t):t)});function rl(e){return hl(Ls(e).toLowerCase())}function al(e){return(e=Ls(e))&&e.replace(Fe,fn).replace(ut,"")}var ol=Zr(function(e,t,n){return e+(n?"-":"")+t.toLowerCase()}),sl=Zr(function(e,t,n){return e+(n?" ":"")+t.toLowerCase()}),ll=Jr("toLowerCase"),ul=Zr(function(e,t,n){return e+(n?"_":"")+t.toLowerCase()}),cl=Zr(function(e,t,n){return e+(n?" ":"")+hl(t)}),dl=Zr(function(e,t,n){return e+(n?" ":"")+t.toUpperCase()}),hl=Jr("toUpperCase");function pl(e,n,i){return e=Ls(e),(n=i?t:n)===t?function(e){return pt.test(e)}(e)?function(e){return e.match(dt)||[]}(e):function(e){return e.match(Ae)||[]}(e):e.match(n)||[]}var fl=mr(function(e,n){try{return Kt(e,t,n)}catch(e){return hs(e)?e:new ze(e)}}),gl=ba(function(e,t){return jt(t,function(t){t=Ja(t),ki(e,t,Ho(e[t],e))}),e});function ml(e){return function(){return e}}var vl=na(),yl=na(!0);function bl(e){return e}function _l(e){return nr("function"==typeof e?e:Oi(e,l))}var Tl=mr(function(e,t){return function(n){return Yi(n,e,t)}}),El=mr(function(e,t){return function(n){return Yi(e,n,t)}});function Cl(e,t,n){var i=Ws(t),r=Ui(t,i);null!=n||ms(t)&&(r.length||!i.length)||(n=t,t=e,e=this,r=Ui(t,Ws(t)));var a=!(ms(n)&&"chain"in n&&!n.chain),o=ps(e);return jt(r,function(n){var i=t[n];e[n]=i,o&&(e.prototype[n]=function(){var t=this.__chain__;if(a||t){var n=e(this.__wrapped__);return(n.__actions__=zr(this.__actions__)).push({func:i,args:arguments,thisArg:e}),n.__chain__=t,n}return i.apply(e,zt([this.value()],arguments))})}),e}function wl(){}var kl=oa(Ht),Sl=oa(Ft),Il=oa(Xt);function Ol(e){return Ka(e)?rn(Ja(e)):function(e){return function(t){return Vi(t,e)}}(e)}var Dl=la(),Rl=la(!0);function xl(){return[]}function Al(){return!1}var Pl,Ll=aa(function(e,t){return e+t},0),Nl=da("ceil"),Ml=aa(function(e,t){return e/t},1),Kl=da("floor"),$l=aa(function(e,t){return e*t},1),jl=da("round"),Bl=aa(function(e,t){return e-t},0);return li.after=function(e,t){if("function"!=typeof t)throw new Je(a);return e=Rs(e),function(){if(--e<1)return t.apply(this,arguments)}},li.ary=Vo,li.assign=Ns,li.assignIn=Ms,li.assignInWith=Ks,li.assignWith=$s,li.at=js,li.before=qo,li.bind=Ho,li.bindAll=gl,li.bindKey=zo,li.castArray=function(){if(!arguments.length)return[];var e=arguments[0];return os(e)?e:[e]},li.chain=Oo,li.chunk=function(e,n,i){n=(i?Ma(e,n,i):n===t)?1:Bn(Rs(n),0);var r=null==e?0:e.length;if(!r||n<1)return[];for(var a=0,o=0,s=qe(Pn(r/n));a<r;)s[o++]=_r(e,a,a+=n);return s},li.compact=function(e){for(var t=-1,n=null==e?0:e.length,i=0,r=[];++t<n;){var a=e[t];a&&(r[i++]=a)}return r},li.concat=function(){var e=arguments.length;if(!e)return[];for(var t=qe(e-1),n=arguments[0],i=e;i--;)t[i-1]=arguments[i];return zt(os(n)?zr(n):[n],Ki(t,1))},li.cond=function(e){var t=null==e?0:e.length,n=ka();return e=t?Ht(e,function(e){if("function"!=typeof e[1])throw new Je(a);return[n(e[0]),e[1]]}):[],mr(function(n){for(var i=-1;++i<t;){var r=e[i];if(Kt(r[0],this,n))return Kt(r[1],this,n)}})},li.conforms=function(e){return function(e){var t=Ws(e);return function(n){return Di(n,e,t)}}(Oi(e,l))},li.constant=ml,li.countBy=xo,li.create=function(e,t){var n=ui(e);return null==t?n:wi(n,t)},li.curry=function e(n,i,r){var a=fa(n,m,t,t,t,t,t,i=r?t:i);return a.placeholder=e.placeholder,a},li.curryRight=function e(n,i,r){var a=fa(n,v,t,t,t,t,t,i=r?t:i);return a.placeholder=e.placeholder,a},li.debounce=Wo,li.defaults=Bs,li.defaultsDeep=Fs,li.defer=Go,li.delay=Xo,li.difference=to,li.differenceBy=no,li.differenceWith=io,li.drop=function(e,n,i){var r=null==e?0:e.length;return r?_r(e,(n=i||n===t?1:Rs(n))<0?0:n,r):[]},li.dropRight=function(e,n,i){var r=null==e?0:e.length;return r?_r(e,0,(n=r-(n=i||n===t?1:Rs(n)))<0?0:n):[]},li.dropRightWhile=function(e,t){return e&&e.length?Rr(e,ka(t,3),!0,!0):[]},li.dropWhile=function(e,t){return e&&e.length?Rr(e,ka(t,3),!0):[]},li.fill=function(e,n,i,r){var a=null==e?0:e.length;return a?(i&&"number"!=typeof i&&Ma(e,n,i)&&(i=0,r=a),function(e,n,i,r){var a=e.length;for((i=Rs(i))<0&&(i=-i>a?0:a+i),(r=r===t||r>a?a:Rs(r))<0&&(r+=a),r=i>r?0:xs(r);i<r;)e[i++]=n;return e}(e,n,i,r)):[]},li.filter=function(e,t){return(os(e)?Ut:Mi)(e,ka(t,3))},li.flatMap=function(e,t){return Ki(jo(e,t),1)},li.flatMapDeep=function(e,t){return Ki(jo(e,t),k)},li.flatMapDepth=function(e,n,i){return i=i===t?1:Rs(i),Ki(jo(e,n),i)},li.flatten=oo,li.flattenDeep=function(e){return null!=e&&e.length?Ki(e,k):[]},li.flattenDepth=function(e,n){return null!=e&&e.length?Ki(e,n=n===t?1:Rs(n)):[]},li.flip=function(e){return fa(e,E)},li.flow=vl,li.flowRight=yl,li.fromPairs=function(e){for(var t=-1,n=null==e?0:e.length,i={};++t<n;){var r=e[t];i[r[0]]=r[1]}return i},li.functions=function(e){return null==e?[]:Ui(e,Ws(e))},li.functionsIn=function(e){return null==e?[]:Ui(e,Gs(e))},li.groupBy=Mo,li.initial=function(e){return null!=e&&e.length?_r(e,0,-1):[]},li.intersection=lo,li.intersectionBy=uo,li.intersectionWith=co,li.invert=qs,li.invertBy=Hs,li.invokeMap=Ko,li.iteratee=_l,li.keyBy=$o,li.keys=Ws,li.keysIn=Gs,li.map=jo,li.mapKeys=function(e,t){var n={};return t=ka(t,3),Bi(e,function(e,i,r){ki(n,t(e,i,r),e)}),n},li.mapValues=function(e,t){var n={};return t=ka(t,3),Bi(e,function(e,i,r){ki(n,i,t(e,i,r))}),n},li.matches=function(e){return or(Oi(e,l))},li.matchesProperty=function(e,t){return sr(e,Oi(t,l))},li.memoize=Yo,li.merge=Xs,li.mergeWith=Ys,li.method=Tl,li.methodOf=El,li.mixin=Cl,li.negate=Qo,li.nthArg=function(e){return e=Rs(e),mr(function(t){return ur(t,e)})},li.omit=Qs,li.omitBy=function(e,t){return Zs(e,Qo(ka(t)))},li.once=function(e){return qo(2,e)},li.orderBy=function(e,n,i,r){return null==e?[]:(os(n)||(n=null==n?[]:[n]),os(i=r?t:i)||(i=null==i?[]:[i]),cr(e,n,i))},li.over=kl,li.overArgs=Jo,li.overEvery=Sl,li.overSome=Il,li.partial=Zo,li.partialRight=es,li.partition=Bo,li.pick=Js,li.pickBy=Zs,li.property=Ol,li.propertyOf=function(e){return function(n){return null==e?t:Vi(e,n)}},li.pull=po,li.pullAll=fo,li.pullAllBy=function(e,t,n){return e&&e.length&&t&&t.length?hr(e,t,ka(n,2)):e},li.pullAllWith=function(e,n,i){return e&&e.length&&n&&n.length?hr(e,n,t,i):e},li.pullAt=go,li.range=Dl,li.rangeRight=Rl,li.rearg=ts,li.reject=function(e,t){return(os(e)?Ut:Mi)(e,Qo(ka(t,3)))},li.remove=function(e,t){var n=[];if(!e||!e.length)return n;var i=-1,r=[],a=e.length;for(t=ka(t,3);++i<a;){var o=e[i];t(o,i,e)&&(n.push(o),r.push(i))}return pr(e,r),n},li.rest=function(e,n){if("function"!=typeof e)throw new Je(a);return mr(e,n=n===t?n:Rs(n))},li.reverse=mo,li.sampleSize=function(e,n,i){return n=(i?Ma(e,n,i):n===t)?1:Rs(n),(os(e)?function(e,t){return Ya(zr(e),Ii(t,0,e.length))}:function(e,t){var n=nl(e);return Ya(n,Ii(t,0,n.length))})(e,n)},li.set=function(e,t,n){return null==e?e:vr(e,t,n)},li.setWith=function(e,n,i,r){return r="function"==typeof r?r:t,null==e?e:vr(e,n,i,r)},li.shuffle=function(e){return(os(e)?function(e){return Ya(zr(e))}:function(e){return Ya(nl(e))})(e)},li.slice=function(e,n,i){var r=null==e?0:e.length;return r?(i&&"number"!=typeof i&&Ma(e,n,i)?(n=0,i=r):(n=null==n?0:Rs(n),i=i===t?r:Rs(i)),_r(e,n,i)):[]},li.sortBy=Fo,li.sortedUniq=function(e){return e&&e.length?wr(e):[]},li.sortedUniqBy=function(e,t){return e&&e.length?wr(e,ka(t,2)):[]},li.split=function(e,n,i){return i&&"number"!=typeof i&&Ma(e,n,i)&&(n=i=t),(i=i===t?D:i>>>0)?(e=Ls(e))&&("string"==typeof n||null!=n&&!Ts(n))&&!(n=Sr(n))&&vn(e)?$r(Cn(e),0,i):e.split(n,i):[]},li.spread=function(e,t){if("function"!=typeof e)throw new Je(a);return t=null==t?0:Bn(Rs(t),0),mr(function(n){var i=n[t],r=$r(n,0,t);return i&&zt(r,i),Kt(e,this,r)})},li.tail=function(e){var t=null==e?0:e.length;return t?_r(e,1,t):[]},li.take=function(e,n,i){return e&&e.length?_r(e,0,(n=i||n===t?1:Rs(n))<0?0:n):[]},li.takeRight=function(e,n,i){var r=null==e?0:e.length;return r?_r(e,(n=r-(n=i||n===t?1:Rs(n)))<0?0:n,r):[]},li.takeRightWhile=function(e,t){return e&&e.length?Rr(e,ka(t,3),!1,!0):[]},li.takeWhile=function(e,t){return e&&e.length?Rr(e,ka(t,3)):[]},li.tap=function(e,t){return t(e),e},li.throttle=function(e,t,n){var i=!0,r=!0;if("function"!=typeof e)throw new Je(a);return ms(n)&&(i="leading"in n?!!n.leading:i,r="trailing"in n?!!n.trailing:r),Wo(e,t,{leading:i,maxWait:t,trailing:r})},li.thru=Do,li.toArray=Os,li.toPairs=el,li.toPairsIn=tl,li.toPath=function(e){return os(e)?Ht(e,Ja):ws(e)?[e]:zr(Qa(Ls(e)))},li.toPlainObject=Ps,li.transform=function(e,t,n){var i=os(e),r=i||cs(e)||ks(e);if(t=ka(t,4),null==n){var a=e&&e.constructor;n=r?i?new a:[]:ms(e)&&ps(a)?ui(It(e)):{}}return(r?jt:Bi)(e,function(e,i,r){return t(n,e,i,r)}),n},li.unary=function(e){return Vo(e,1)},li.union=vo,li.unionBy=yo,li.unionWith=bo,li.uniq=function(e){return e&&e.length?Ir(e):[]},li.uniqBy=function(e,t){return e&&e.length?Ir(e,ka(t,2)):[]},li.uniqWith=function(e,n){return n="function"==typeof n?n:t,e&&e.length?Ir(e,t,n):[]},li.unset=function(e,t){return null==e||Or(e,t)},li.unzip=_o,li.unzipWith=To,li.update=function(e,t,n){return null==e?e:Dr(e,t,Nr(n))},li.updateWith=function(e,n,i,r){return r="function"==typeof r?r:t,null==e?e:Dr(e,n,Nr(i),r)},li.values=nl,li.valuesIn=function(e){return null==e?[]:cn(e,Gs(e))},li.without=Eo,li.words=pl,li.wrap=function(e,t){return Zo(Nr(t),e)},li.xor=Co,li.xorBy=wo,li.xorWith=ko,li.zip=So,li.zipObject=function(e,t){return Pr(e||[],t||[],Ti)},li.zipObjectDeep=function(e,t){return Pr(e||[],t||[],vr)},li.zipWith=Io,li.entries=el,li.entriesIn=tl,li.extend=Ms,li.extendWith=Ks,Cl(li,li),li.add=Ll,li.attempt=fl,li.camelCase=il,li.capitalize=rl,li.ceil=Nl,li.clamp=function(e,n,i){return i===t&&(i=n,n=t),i!==t&&(i=(i=As(i))==i?i:0),n!==t&&(n=(n=As(n))==n?n:0),Ii(As(e),n,i)},li.clone=function(e){return Oi(e,c)},li.cloneDeep=function(e){return Oi(e,l|c)},li.cloneDeepWith=function(e,n){return Oi(e,l|c,n="function"==typeof n?n:t)},li.cloneWith=function(e,n){return Oi(e,c,n="function"==typeof n?n:t)},li.conformsTo=function(e,t){return null==t||Di(e,t,Ws(t))},li.deburr=al,li.defaultTo=function(e,t){return null==e||e!=e?t:e},li.divide=Ml,li.endsWith=function(e,n,i){e=Ls(e),n=Sr(n);var r=e.length,a=i=i===t?r:Ii(Rs(i),0,r);return(i-=n.length)>=0&&e.slice(i,a)==n},li.eq=ns,li.escape=function(e){return(e=Ls(e))&&me.test(e)?e.replace(fe,gn):e},li.escapeRegExp=function(e){return(e=Ls(e))&&ke.test(e)?e.replace(we,"\\$&"):e},li.every=function(e,n,i){var r=os(e)?Ft:Li;return i&&Ma(e,n,i)&&(n=t),r(e,ka(n,3))},li.find=Ao,li.findIndex=ro,li.findKey=function(e,t){return Qt(e,ka(t,3),Bi)},li.findLast=Po,li.findLastIndex=ao,li.findLastKey=function(e,t){return Qt(e,ka(t,3),Fi)},li.floor=Kl,li.forEach=Lo,li.forEachRight=No,li.forIn=function(e,t){return null==e?e:$i(e,ka(t,3),Gs)},li.forInRight=function(e,t){return null==e?e:ji(e,ka(t,3),Gs)},li.forOwn=function(e,t){return e&&Bi(e,ka(t,3))},li.forOwnRight=function(e,t){return e&&Fi(e,ka(t,3))},li.get=Us,li.gt=is,li.gte=rs,li.has=function(e,t){return null!=e&&Aa(e,t,Wi)},li.hasIn=Vs,li.head=so,li.identity=bl,li.includes=function(e,t,n,i){e=ls(e)?e:nl(e),n=n&&!i?Rs(n):0;var r=e.length;return n<0&&(n=Bn(r+n,0)),Cs(e)?n<=r&&e.indexOf(t,n)>-1:!!r&&Zt(e,t,n)>-1},li.indexOf=function(e,t,n){var i=null==e?0:e.length;if(!i)return-1;var r=null==n?0:Rs(n);return r<0&&(r=Bn(i+r,0)),Zt(e,t,r)},li.inRange=function(e,n,i){return n=Ds(n),i===t?(i=n,n=0):i=Ds(i),function(e,t,n){return e>=Fn(t,n)&&e<Bn(t,n)}(e=As(e),n,i)},li.invoke=zs,li.isArguments=as,li.isArray=os,li.isArrayBuffer=ss,li.isArrayLike=ls,li.isArrayLikeObject=us,li.isBoolean=function(e){return!0===e||!1===e||vs(e)&&Hi(e)==M},li.isBuffer=cs,li.isDate=ds,li.isElement=function(e){return vs(e)&&1===e.nodeType&&!_s(e)},li.isEmpty=function(e){if(null==e)return!0;if(ls(e)&&(os(e)||"string"==typeof e||"function"==typeof e.splice||cs(e)||ks(e)||as(e)))return!e.length;var t=xa(e);if(t==U||t==G)return!e.size;if(Ba(e))return!ir(e).length;for(var n in e)if(rt.call(e,n))return!1;return!0},li.isEqual=function(e,t){return Ji(e,t)},li.isEqualWith=function(e,n,i){var r=(i="function"==typeof i?i:t)?i(e,n):t;return r===t?Ji(e,n,t,i):!!r},li.isError=hs,li.isFinite=function(e){return"number"==typeof e&&Kn(e)},li.isFunction=ps,li.isInteger=fs,li.isLength=gs,li.isMap=ys,li.isMatch=function(e,t){return e===t||er(e,t,Ia(t))},li.isMatchWith=function(e,n,i){return i="function"==typeof i?i:t,er(e,n,Ia(n),i)},li.isNaN=function(e){return bs(e)&&e!=+e},li.isNative=function(e){if(ja(e))throw new ze("Unsupported core-js use. Try https://npms.io/search?q=ponyfill.");return tr(e)},li.isNil=function(e){return null==e},li.isNull=function(e){return null===e},li.isNumber=bs,li.isObject=ms,li.isObjectLike=vs,li.isPlainObject=_s,li.isRegExp=Ts,li.isSafeInteger=function(e){return fs(e)&&e>=-S&&e<=S},li.isSet=Es,li.isString=Cs,li.isSymbol=ws,li.isTypedArray=ks,li.isUndefined=function(e){return e===t},li.isWeakMap=function(e){return vs(e)&&xa(e)==J},li.isWeakSet=function(e){return vs(e)&&"[object WeakSet]"==Hi(e)},li.join=function(e,t){return null==e?"":$n.call(e,t)},li.kebabCase=ol,li.last=ho,li.lastIndexOf=function(e,n,i){var r=null==e?0:e.length;if(!r)return-1;var a=r;return i!==t&&(a=(a=Rs(i))<0?Bn(r+a,0):Fn(a,r-1)),n==n?function(e,t,n){for(var i=a+1;i--;)if(e[i]===t)return i;return i}(e,n):Jt(e,tn,a,!0)},li.lowerCase=sl,li.lowerFirst=ll,li.lt=Ss,li.lte=Is,li.max=function(e){return e&&e.length?Ni(e,bl,zi):t},li.maxBy=function(e,n){return e&&e.length?Ni(e,ka(n,2),zi):t},li.mean=function(e){return nn(e,bl)},li.meanBy=function(e,t){return nn(e,ka(t,2))},li.min=function(e){return e&&e.length?Ni(e,bl,rr):t},li.minBy=function(e,n){return e&&e.length?Ni(e,ka(n,2),rr):t},li.stubArray=xl,li.stubFalse=Al,li.stubObject=function(){return{}},li.stubString=function(){return""},li.stubTrue=function(){return!0},li.multiply=$l,li.nth=function(e,n){return e&&e.length?ur(e,Rs(n)):t},li.noConflict=function(){return Ct._===this&&(Ct._=ht),this},li.noop=wl,li.now=Uo,li.pad=function(e,t,n){e=Ls(e);var i=(t=Rs(t))?En(e):0;if(!t||i>=t)return e;var r=(t-i)/2;return sa(Ln(r),n)+e+sa(Pn(r),n)},li.padEnd=function(e,t,n){e=Ls(e);var i=(t=Rs(t))?En(e):0;return t&&i<t?e+sa(t-i,n):e},li.padStart=function(e,t,n){e=Ls(e);var i=(t=Rs(t))?En(e):0;return t&&i<t?sa(t-i,n)+e:e},li.parseInt=function(e,t,n){return n||null==t?t=0:t&&(t=+t),Vn(Ls(e).replace(Ie,""),t||0)},li.random=function(e,n,i){if(i&&"boolean"!=typeof i&&Ma(e,n,i)&&(n=i=t),i===t&&("boolean"==typeof n?(i=n,n=t):"boolean"==typeof e&&(i=e,e=t)),e===t&&n===t?(e=0,n=1):(e=Ds(e),n===t?(n=e,e=0):n=Ds(n)),e>n){var r=e;e=n,n=r}if(i||e%1||n%1){var a=qn();return Fn(e+a*(n-e+bt("1e-"+((a+"").length-1))),n)}return fr(e,n)},li.reduce=function(e,t,n){var i=os(e)?Wt:on,r=arguments.length<3;return i(e,ka(t,4),n,r,Ai)},li.reduceRight=function(e,t,n){var i=os(e)?Gt:on,r=arguments.length<3;return i(e,ka(t,4),n,r,Pi)},li.repeat=function(e,n,i){return n=(i?Ma(e,n,i):n===t)?1:Rs(n),gr(Ls(e),n)},li.replace=function(){var e=arguments,t=Ls(e[0]);return e.length<3?t:t.replace(e[1],e[2])},li.result=function(e,n,i){var r=-1,a=(n=Mr(n,e)).length;for(a||(a=1,e=t);++r<a;){var o=null==e?t:e[Ja(n[r])];o===t&&(r=a,o=i),e=ps(o)?o.call(e):o}return e},li.round=jl,li.runInContext=e,li.sample=function(e){return(os(e)?bi:function(e){return bi(nl(e))})(e)},li.size=function(e){if(null==e)return 0;if(ls(e))return Cs(e)?En(e):e.length;var t=xa(e);return t==U||t==G?e.size:ir(e).length},li.snakeCase=ul,li.some=function(e,n,i){var r=os(e)?Xt:Tr;return i&&Ma(e,n,i)&&(n=t),r(e,ka(n,3))},li.sortedIndex=function(e,t){return Er(e,t)},li.sortedIndexBy=function(e,t,n){return Cr(e,t,ka(n,2))},li.sortedIndexOf=function(e,t){var n=null==e?0:e.length;if(n){var i=Er(e,t);if(i<n&&ns(e[i],t))return i}return-1},li.sortedLastIndex=function(e,t){return Er(e,t,!0)},li.sortedLastIndexBy=function(e,t,n){return Cr(e,t,ka(n,2),!0)},li.sortedLastIndexOf=function(e,t){if(null!=e&&e.length){var n=Er(e,t,!0)-1;if(ns(e[n],t))return n}return-1},li.startCase=cl,li.startsWith=function(e,t,n){return e=Ls(e),n=null==n?0:Ii(Rs(n),0,e.length),t=Sr(t),e.slice(n,n+t.length)==t},li.subtract=Bl,li.sum=function(e){return e&&e.length?sn(e,bl):0},li.sumBy=function(e,t){return e&&e.length?sn(e,ka(t,2)):0},li.template=function(e,n,i){var r=li.templateSettings;i&&Ma(e,n,i)&&(n=t),e=Ls(e),n=Ks({},n,r,ga);var a,o,s=Ks({},n.imports,r.imports,ga),l=Ws(s),u=cn(s,l),c=0,d=n.interpolate||Ue,h="__p += '",p=Ye((n.escape||Ue).source+"|"+d.source+"|"+(d===be?Le:Ue).source+"|"+(n.evaluate||Ue).source+"|$","g"),f="//# sourceURL="+("sourceURL"in n?n.sourceURL:"lodash.templateSources["+ ++gt+"]")+"\n";e.replace(p,function(t,n,i,r,s,l){return i||(i=r),h+=e.slice(c,l).replace(Ve,mn),n&&(a=!0,h+="' +\n__e("+n+") +\n'"),s&&(o=!0,h+="';\n"+s+";\n__p += '"),i&&(h+="' +\n((__t = ("+i+")) == null ? '' : __t) +\n'"),c=l+t.length,t}),h+="';\n";var g=n.variable;g||(h="with (obj) {\n"+h+"\n}\n"),h=(o?h.replace(ce,""):h).replace(de,"$1").replace(he,"$1;"),h="function("+(g||"obj")+") {\n"+(g?"":"obj || (obj = {});\n")+"var __t, __p = ''"+(a?", __e = _.escape":"")+(o?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+h+"return __p\n}";var m=fl(function(){return We(l,f+"return "+h).apply(t,u)});if(m.source=h,hs(m))throw m;return m},li.times=function(e,t){if((e=Rs(e))<1||e>S)return[];var n=D,i=Fn(e,D);t=ka(t),e-=D;for(var r=ln(i,t);++n<e;)t(n);return r},li.toFinite=Ds,li.toInteger=Rs,li.toLength=xs,li.toLower=function(e){return Ls(e).toLowerCase()},li.toNumber=As,li.toSafeInteger=function(e){return e?Ii(Rs(e),-S,S):0===e?e:0},li.toString=Ls,li.toUpper=function(e){return Ls(e).toUpperCase()},li.trim=function(e,n,i){if((e=Ls(e))&&(i||n===t))return e.replace(Se,"");if(!e||!(n=Sr(n)))return e;var r=Cn(e),a=Cn(n);return $r(r,hn(r,a),pn(r,a)+1).join("")},li.trimEnd=function(e,n,i){if((e=Ls(e))&&(i||n===t))return e.replace(Oe,"");if(!e||!(n=Sr(n)))return e;var r=Cn(e);return $r(r,0,pn(r,Cn(n))+1).join("")},li.trimStart=function(e,n,i){if((e=Ls(e))&&(i||n===t))return e.replace(Ie,"");if(!e||!(n=Sr(n)))return e;var r=Cn(e);return $r(r,hn(r,Cn(n))).join("")},li.truncate=function(e,n){var i=30,r="...";if(ms(n)){var a="separator"in n?n.separator:a;i="length"in n?Rs(n.length):i,r="omission"in n?Sr(n.omission):r}var o=(e=Ls(e)).length;if(vn(e)){var s=Cn(e);o=s.length}if(i>=o)return e;var l=i-En(r);if(l<1)return r;var u=s?$r(s,0,l).join(""):e.slice(0,l);if(a===t)return u+r;if(s&&(l+=u.length-l),Ts(a)){if(e.slice(l).search(a)){var c,d=u;for(a.global||(a=Ye(a.source,Ls(Ne.exec(a))+"g")),a.lastIndex=0;c=a.exec(d);)var h=c.index;u=u.slice(0,h===t?l:h)}}else if(e.indexOf(Sr(a),l)!=l){var p=u.lastIndexOf(a);p>-1&&(u=u.slice(0,p))}return u+r},li.unescape=function(e){return(e=Ls(e))&&ge.test(e)?e.replace(pe,wn):e},li.uniqueId=function(e){var t=++at;return Ls(e)+t},li.upperCase=dl,li.upperFirst=hl,li.each=Lo,li.eachRight=No,li.first=so,Cl(li,(Pl={},Bi(li,function(e,t){rt.call(li.prototype,t)||(Pl[t]=e)}),Pl),{chain:!1}),li.VERSION="4.17.4",jt(["bind","bindKey","curry","curryRight","partial","partialRight"],function(e){li[e].placeholder=li}),jt(["drop","take"],function(e,n){hi.prototype[e]=function(i){i=i===t?1:Bn(Rs(i),0);var r=this.__filtered__&&!n?new hi(this):this.clone();return r.__filtered__?r.__takeCount__=Fn(i,r.__takeCount__):r.__views__.push({size:Fn(i,D),type:e+(r.__dir__<0?"Right":"")}),r},hi.prototype[e+"Right"]=function(t){return this.reverse()[e](t).reverse()}}),jt(["filter","map","takeWhile"],function(e,t){var n=t+1,i=1==n||3==n;hi.prototype[e]=function(e){var t=this.clone();return t.__iteratees__.push({iteratee:ka(e,3),type:n}),t.__filtered__=t.__filtered__||i,t}}),jt(["head","last"],function(e,t){var n="take"+(t?"Right":"");hi.prototype[e]=function(){return this[n](1).value()[0]}}),jt(["initial","tail"],function(e,t){var n="drop"+(t?"":"Right");hi.prototype[e]=function(){return this.__filtered__?new hi(this):this[n](1)}}),hi.prototype.compact=function(){return this.filter(bl)},hi.prototype.find=function(e){return this.filter(e).head()},hi.prototype.findLast=function(e){return this.reverse().find(e)},hi.prototype.invokeMap=mr(function(e,t){return"function"==typeof e?new hi(this):this.map(function(n){return Yi(n,e,t)})}),hi.prototype.reject=function(e){return this.filter(Qo(ka(e)))},hi.prototype.slice=function(e,n){e=Rs(e);var i=this;return i.__filtered__&&(e>0||n<0)?new hi(i):(e<0?i=i.takeRight(-e):e&&(i=i.drop(e)),n!==t&&(i=(n=Rs(n))<0?i.dropRight(-n):i.take(n-e)),i)},hi.prototype.takeRightWhile=function(e){return this.reverse().takeWhile(e).reverse()},hi.prototype.toArray=function(){return this.take(D)},Bi(hi.prototype,function(e,n){var i=/^(?:filter|find|map|reject)|While$/.test(n),r=/^(?:head|last)$/.test(n),a=li[r?"take"+("last"==n?"Right":""):n],o=r||/^find/.test(n);a&&(li.prototype[n]=function(){var n=this.__wrapped__,s=r?[1]:arguments,l=n instanceof hi,u=s[0],c=l||os(n),d=function(e){var t=a.apply(li,zt([e],s));return r&&h?t[0]:t};c&&i&&"function"==typeof u&&1!=u.length&&(l=c=!1);var h=this.__chain__,p=!!this.__actions__.length,f=o&&!h,g=l&&!p;if(!o&&c){n=g?n:new hi(this);var m=e.apply(n,s);return m.__actions__.push({func:Do,args:[d],thisArg:t}),new di(m,h)}return f&&g?e.apply(this,s):(m=this.thru(d),f?r?m.value()[0]:m.value():m)})}),jt(["pop","push","shift","sort","splice","unshift"],function(e){var t=Ze[e],n=/^(?:push|sort|unshift)$/.test(e)?"tap":"thru",i=/^(?:pop|shift)$/.test(e);li.prototype[e]=function(){var e=arguments;if(i&&!this.__chain__){var r=this.value();return t.apply(os(r)?r:[],e)}return this[n](function(n){return t.apply(os(n)?n:[],e)})}}),Bi(hi.prototype,function(e,t){var n=li[t];if(n){var i=n.name+"";(Zn[i]||(Zn[i]=[])).push({name:t,func:n})}}),Zn[ia(t,f).name]=[{name:"wrapper",func:t}],hi.prototype.clone=function(){var e=new hi(this.__wrapped__);return e.__actions__=zr(this.__actions__),e.__dir__=this.__dir__,e.__filtered__=this.__filtered__,e.__iteratees__=zr(this.__iteratees__),e.__takeCount__=this.__takeCount__,e.__views__=zr(this.__views__),e},hi.prototype.reverse=function(){if(this.__filtered__){var e=new hi(this);e.__dir__=-1,e.__filtered__=!0}else(e=this.clone()).__dir__*=-1;return e},hi.prototype.value=function(){var e=this.__wrapped__.value(),t=this.__dir__,n=os(e),i=t<0,r=n?e.length:0,a=function(e,t,n){for(var i=-1,r=n.length;++i<r;){var a=n[i],o=a.size;switch(a.type){case"drop":e+=o;break;case"dropRight":t-=o;break;case"take":t=Fn(t,e+o);break;case"takeRight":e=Bn(e,t-o)}}return{start:e,end:t}}(0,r,this.__views__),o=a.start,s=a.end,l=s-o,u=i?s:o-1,c=this.__iteratees__,d=c.length,h=0,p=Fn(l,this.__takeCount__);if(!n||!i&&r==l&&p==l)return xr(e,this.__actions__);var f=[];e:for(;l--&&h<p;){for(var g=-1,m=e[u+=t];++g<d;){var v=c[g],y=v.iteratee,b=v.type,_=y(m);if(2==b)m=_;else if(!_){if(1==b)continue e;break e}}f[h++]=m}return f},li.prototype.at=Ro,li.prototype.chain=function(){return Oo(this)},li.prototype.commit=function(){return new di(this.value(),this.__chain__)},li.prototype.next=function(){this.__values__===t&&(this.__values__=Os(this.value()));var e=this.__index__>=this.__values__.length;return{done:e,value:e?t:this.__values__[this.__index__++]}},li.prototype.plant=function(e){for(var n,i=this;i instanceof ci;){var r=eo(i);r.__index__=0,r.__values__=t,n?a.__wrapped__=r:n=r;var a=r;i=i.__wrapped__}return a.__wrapped__=e,n},li.prototype.reverse=function(){var e=this.__wrapped__;if(e instanceof hi){var n=e;return this.__actions__.length&&(n=new hi(this)),(n=n.reverse()).__actions__.push({func:Do,args:[mo],thisArg:t}),new di(n,this.__chain__)}return this.thru(mo)},li.prototype.toJSON=li.prototype.valueOf=li.prototype.value=function(){return xr(this.__wrapped__,this.__actions__)},li.prototype.first=li.prototype.head,In&&(li.prototype[In]=function(){return this}),li}();kt?((kt.exports=kn)._=kn,wt._=kn):Ct._=kn}).call(this)}).call(this,void 0!==t?t:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],3:[function(e,t,n){(function(){var e,n,i,r,a,o,s,l,u,c,d,h,p=[].slice,f={}.hasOwnProperty;e=function(){var e,t,n,i,r,a;if(a=arguments[0],r=2<=arguments.length?p.call(arguments,1):[],o(Object.assign))Object.assign.apply(null,arguments);else for(e=0,n=r.length;e<n;e++)if(null!=(i=r[e]))for(t in i)f.call(i,t)&&(a[t]=i[t]);return a},o=function(e){return!!e&&"[object Function]"===Object.prototype.toString.call(e)},s=function(e){var t;return!!e&&("function"==(t=typeof e)||"object"===t)},r=function(e){return o(Array.isArray)?Array.isArray(e):"[object Array]"===Object.prototype.toString.call(e)},a=function(e){var t;if(r(e))return!e.length;for(t in e)if(f.call(e,t))return!1;return!0},l=function(e){var t,n;return s(e)&&(n=Object.getPrototypeOf(e))&&(t=n.constructor)&&"function"==typeof t&&t instanceof t&&Function.prototype.toString.call(t)===Function.prototype.toString.call(Object)},h=function(e){return(e.split(/[-_\s]+|(?=[A-Z][a-z])/)||[]).filter(function(e){return!!e})},n=function(e){var t,n,r,a,o,s;for(a="",n=t=0,r=(o=h(e)).length;t<r;n=++t)s=o[n],a+=n?i(s.toLowerCase()):s.toLowerCase();return a},d=function(e){var t,n,r,a,o,s;for(a="",n=t=0,r=(o=h(e)).length;t<r;n=++t)s=o[n],a+=i(s.toLowerCase());return a},u=function(e){var t,n,i,r,a,o;for(r="",n=t=0,i=(a=h(e)).length;t<i;n=++t)o=a[n],r+=(n?"-":"")+o.toLowerCase();return r},c=function(e){var t,n,i,r,a,o;for(r="",n=t=0,i=(a=h(e)).length;t<i;n=++t)o=a[n],r+=(n?"_":"")+o.toLowerCase();return r},i=function(e){return e.charAt(0).toUpperCase()+e.slice(1)},t.exports.assign=e,t.exports.isFunction=o,t.exports.isObject=s,t.exports.isArray=r,t.exports.isEmpty=a,t.exports.isPlainObject=l,t.exports.camelCase=n,t.exports.titleCase=d,t.exports.kebabCase=u,t.exports.snakeCase=c,t.exports.capitalize=i,t.exports.words=h}).call(this)},{}],4:[function(e,t,n){(function(){t.exports=function(){function e(e,t,n){if(this.options=e.options,this.stringify=e.stringify,null==t)throw new Error("Missing attribute name of element "+e.name);if(null==n)throw new Error("Missing attribute value for attribute "+t+" of element "+e.name);this.name=this.stringify.attName(t),this.value=this.stringify.attValue(n)}return e.prototype.clone=function(){return Object.create(this)},e.prototype.toString=function(e){return this.options.writer.set(e).attribute(this)},e}()}).call(this)},{}],5:[function(e,t,n){(function(){var n,i={}.hasOwnProperty;n=e("./XMLNode"),t.exports=function(e){function t(e,n){if(t.__super__.constructor.call(this,e),null==n)throw new Error("Missing CDATA text");this.text=this.stringify.cdata(n)}return function(e,t){for(var n in t)i.call(t,n)&&(e[n]=t[n]);function r(){this.constructor=e}r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype}(t,n),t.prototype.clone=function(){return Object.create(this)},t.prototype.toString=function(e){return this.options.writer.set(e).cdata(this)},t}()}).call(this)},{"./XMLNode":16}],6:[function(e,t,n){(function(){var n,i={}.hasOwnProperty;n=e("./XMLNode"),t.exports=function(e){function t(e,n){if(t.__super__.constructor.call(this,e),null==n)throw new Error("Missing comment text");this.text=this.stringify.comment(n)}return function(e,t){for(var n in t)i.call(t,n)&&(e[n]=t[n]);function r(){this.constructor=e}r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype}(t,n),t.prototype.clone=function(){return Object.create(this)},t.prototype.toString=function(e){return this.options.writer.set(e).comment(this)},t}()}).call(this)},{"./XMLNode":16}],7:[function(e,t,n){(function(){var n,i={}.hasOwnProperty;n=e("./XMLNode"),t.exports=function(e){function t(e,n,i,r,a,o){if(t.__super__.constructor.call(this,e),null==n)throw new Error("Missing DTD element name");if(null==i)throw new Error("Missing DTD attribute name");if(!r)throw new Error("Missing DTD attribute type");if(!a)throw new Error("Missing DTD attribute default");if(0!==a.indexOf("#")&&(a="#"+a),!a.match(/^(#REQUIRED|#IMPLIED|#FIXED|#DEFAULT)$/))throw new Error("Invalid default value type; expected: #REQUIRED, #IMPLIED, #FIXED or #DEFAULT");if(o&&!a.match(/^(#FIXED|#DEFAULT)$/))throw new Error("Default value only applies to #FIXED or #DEFAULT");this.elementName=this.stringify.eleName(n),this.attributeName=this.stringify.attName(i),this.attributeType=this.stringify.dtdAttType(r),this.defaultValue=this.stringify.dtdAttDefault(o),this.defaultValueType=a}return function(e,t){for(var n in t)i.call(t,n)&&(e[n]=t[n]);function r(){this.constructor=e}r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype}(t,n),t.prototype.toString=function(e){return this.options.writer.set(e).dtdAttList(this)},t}()}).call(this)},{"./XMLNode":16}],8:[function(e,t,n){(function(){var n,i={}.hasOwnProperty;n=e("./XMLNode"),t.exports=function(e){function t(e,n,i){if(t.__super__.constructor.call(this,e),null==n)throw new Error("Missing DTD element name");i||(i="(#PCDATA)"),Array.isArray(i)&&(i="("+i.join(",")+")"),this.name=this.stringify.eleName(n),this.value=this.stringify.dtdElementValue(i)}return function(e,t){for(var n in t)i.call(t,n)&&(e[n]=t[n]);function r(){this.constructor=e}r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype}(t,n),t.prototype.toString=function(e){return this.options.writer.set(e).dtdElement(this)},t}()}).call(this)},{"./XMLNode":16}],9:[function(e,t,n){(function(){var n,i,r={}.hasOwnProperty;i=e("./Utility").isObject,n=e("./XMLNode"),t.exports=function(e){function t(e,n,r,a){if(t.__super__.constructor.call(this,e),null==r)throw new Error("Missing entity name");if(null==a)throw new Error("Missing entity value");if(this.pe=!!n,this.name=this.stringify.eleName(r),i(a)){if(!a.pubID&&!a.sysID)throw new Error("Public and/or system identifiers are required for an external entity");if(a.pubID&&!a.sysID)throw new Error("System identifier is required for a public external entity");if(null!=a.pubID&&(this.pubID=this.stringify.dtdPubID(a.pubID)),null!=a.sysID&&(this.sysID=this.stringify.dtdSysID(a.sysID)),null!=a.nData&&(this.nData=this.stringify.dtdNData(a.nData)),this.pe&&this.nData)throw new Error("Notation declaration is not allowed in a parameter entity")}else this.value=this.stringify.dtdEntityValue(a)}return function(e,t){for(var n in t)r.call(t,n)&&(e[n]=t[n]);function i(){this.constructor=e}i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype}(t,n),t.prototype.toString=function(e){return this.options.writer.set(e).dtdEntity(this)},t}()}).call(this)},{"./Utility":3,"./XMLNode":16}],10:[function(e,t,n){(function(){var n,i={}.hasOwnProperty;n=e("./XMLNode"),t.exports=function(e){function t(e,n,i){if(t.__super__.constructor.call(this,e),null==n)throw new Error("Missing notation name");if(!i.pubID&&!i.sysID)throw new Error("Public or system identifiers are required for an external entity");this.name=this.stringify.eleName(n),null!=i.pubID&&(this.pubID=this.stringify.dtdPubID(i.pubID)),null!=i.sysID&&(this.sysID=this.stringify.dtdSysID(i.sysID))}return function(e,t){for(var n in t)i.call(t,n)&&(e[n]=t[n]);function r(){this.constructor=e}r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype}(t,n),t.prototype.toString=function(e){return this.options.writer.set(e).dtdNotation(this)},t}()}).call(this)},{"./XMLNode":16}],11:[function(e,t,n){(function(){var n,i,r={}.hasOwnProperty;i=e("./Utility").isObject,n=e("./XMLNode"),t.exports=function(e){function t(e,n,r,a){var o;t.__super__.constructor.call(this,e),i(n)&&(n=(o=n).version,r=o.encoding,a=o.standalone),n||(n="1.0"),this.version=this.stringify.xmlVersion(n),null!=r&&(this.encoding=this.stringify.xmlEncoding(r)),null!=a&&(this.standalone=this.stringify.xmlStandalone(a))}return function(e,t){for(var n in t)r.call(t,n)&&(e[n]=t[n]);function i(){this.constructor=e}i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype}(t,n),t.prototype.toString=function(e){return this.options.writer.set(e).declaration(this)},t}()}).call(this)},{"./Utility":3,"./XMLNode":16}],12:[function(e,t,n){(function(){var n,i,r,a,o,s,l={}.hasOwnProperty;s=e("./Utility").isObject,o=e("./XMLNode"),n=e("./XMLDTDAttList"),r=e("./XMLDTDEntity"),i=e("./XMLDTDElement"),a=e("./XMLDTDNotation"),t.exports=function(e){function t(e,n,i){var r,a;t.__super__.constructor.call(this,e),this.documentObject=e,s(n)&&(n=(r=n).pubID,i=r.sysID),null==i&&(i=(a=[n,i])[0],n=a[1]),null!=n&&(this.pubID=this.stringify.dtdPubID(n)),null!=i&&(this.sysID=this.stringify.dtdSysID(i))}return function(e,t){for(var n in t)l.call(t,n)&&(e[n]=t[n]);function i(){this.constructor=e}i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype}(t,o),t.prototype.element=function(e,t){var n;return n=new i(this,e,t),this.children.push(n),this},t.prototype.attList=function(e,t,i,r,a){var o;return o=new n(this,e,t,i,r,a),this.children.push(o),this},t.prototype.entity=function(e,t){var n;return n=new r(this,!1,e,t),this.children.push(n),this},t.prototype.pEntity=function(e,t){var n;return n=new r(this,!0,e,t),this.children.push(n),this},t.prototype.notation=function(e,t){var n;return n=new a(this,e,t),this.children.push(n),this},t.prototype.toString=function(e){return this.options.writer.set(e).docType(this)},t.prototype.ele=function(e,t){return this.element(e,t)},t.prototype.att=function(e,t,n,i,r){return this.attList(e,t,n,i,r)},t.prototype.ent=function(e,t){return this.entity(e,t)},t.prototype.pent=function(e,t){return this.pEntity(e,t)},t.prototype.not=function(e,t){return this.notation(e,t)},t.prototype.up=function(){return this.root()||this.documentObject},t}()}).call(this)},{"./Utility":3,"./XMLDTDAttList":7,"./XMLDTDElement":8,"./XMLDTDEntity":9,"./XMLDTDNotation":10,"./XMLNode":16}],13:[function(e,t,n){(function(){var n,i,r,a,o={}.hasOwnProperty;a=e("./Utility").isPlainObject,n=e("./XMLNode"),r=e("./XMLStringifier"),i=e("./XMLStringWriter"),t.exports=function(e){function t(e){t.__super__.constructor.call(this,null),e||(e={}),e.writer||(e.writer=new i),this.options=e,this.stringify=new r(e),this.isDocument=!0}return function(e,t){for(var n in t)o.call(t,n)&&(e[n]=t[n]);function i(){this.constructor=e}i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype}(t,n),t.prototype.end=function(e){var t;return e?a(e)&&(t=e,e=this.options.writer.set(t)):e=this.options.writer,e.document(this)},t.prototype.toString=function(e){return this.options.writer.set(e).document(this)},t}()}).call(this)},{"./Utility":3,"./XMLNode":16,"./XMLStringWriter":20,"./XMLStringifier":21}],14:[function(e,t,n){(function(){var n,i,r,a,o,s,l,u,c,d,h,p,f,g,m,v,y,b,_,T={}.hasOwnProperty;_=e("./Utility"),y=_.isObject,v=_.isFunction,b=_.isPlainObject,d=e("./XMLElement"),i=e("./XMLCData"),r=e("./XMLComment"),p=e("./XMLRaw"),m=e("./XMLText"),h=e("./XMLProcessingInstruction"),u=e("./XMLDeclaration"),c=e("./XMLDocType"),a=e("./XMLDTDAttList"),s=e("./XMLDTDEntity"),o=e("./XMLDTDElement"),l=e("./XMLDTDNotation"),n=e("./XMLAttribute"),g=e("./XMLStringifier"),f=e("./XMLStringWriter"),t.exports=function(){function e(e,t,n){var i;e||(e={}),e.writer?b(e.writer)&&(i=e.writer,e.writer=new f(i)):e.writer=new f(e),this.options=e,this.writer=e.writer,this.stringify=new g(e),this.onDataCallback=t||function(){},this.onEndCallback=n||function(){},this.currentNode=null,this.currentLevel=-1,this.openTags={},this.documentStarted=!1,this.documentCompleted=!1,this.root=null}return e.prototype.node=function(e,t,n){var i;if(null==e)throw new Error("Missing node name");if(this.root&&-1===this.currentLevel)throw new Error("Document can only have one root node");return this.openCurrent(),e=e.valueOf(),null==t&&(t={}),t=t.valueOf(),y(t)||(n=(i=[t,n])[0],t=i[1]),this.currentNode=new d(this,e,t),this.currentNode.children=!1,this.currentLevel++,this.openTags[this.currentLevel]=this.currentNode,null!=n&&this.text(n),this},e.prototype.element=function(e,t,n){return this.currentNode&&this.currentNode instanceof c?this.dtdElement.apply(this,arguments):this.node(e,t,n)},e.prototype.attribute=function(e,t){var i,r;if(!this.currentNode||this.currentNode.children)throw new Error("att() can only be used immediately after an ele() call in callback mode");if(null!=e&&(e=e.valueOf()),y(e))for(i in e)T.call(e,i)&&(r=e[i],this.attribute(i,r));else v(t)&&(t=t.apply()),this.options.skipNullAttributes&&null==t||(this.currentNode.attributes[e]=new n(this,e,t));return this},e.prototype.text=function(e){var t;return this.openCurrent(),t=new m(this,e),this.onData(this.writer.text(t,this.currentLevel+1)),this},e.prototype.cdata=function(e){var t;return this.openCurrent(),t=new i(this,e),this.onData(this.writer.cdata(t,this.currentLevel+1)),this},e.prototype.comment=function(e){var t;return this.openCurrent(),t=new r(this,e),this.onData(this.writer.comment(t,this.currentLevel+1)),this},e.prototype.raw=function(e){var t;return this.openCurrent(),t=new p(this,e),this.onData(this.writer.raw(t,this.currentLevel+1)),this},e.prototype.instruction=function(e,t){var n,i,r,a,o;if(this.openCurrent(),null!=e&&(e=e.valueOf()),null!=t&&(t=t.valueOf()),Array.isArray(e))for(n=0,a=e.length;n<a;n++)i=e[n],this.instruction(i);else if(y(e))for(i in e)T.call(e,i)&&(r=e[i],this.instruction(i,r));else v(t)&&(t=t.apply()),o=new h(this,e,t),this.onData(this.writer.processingInstruction(o,this.currentLevel+1));return this},e.prototype.declaration=function(e,t,n){var i;if(this.openCurrent(),this.documentStarted)throw new Error("declaration() must be the first node");return i=new u(this,e,t,n),this.onData(this.writer.declaration(i,this.currentLevel+1)),this},e.prototype.doctype=function(e,t,n){if(this.openCurrent(),null==e)throw new Error("Missing root node name");if(this.root)throw new Error("dtd() must come before the root node");return this.currentNode=new c(this,t,n),this.currentNode.rootNodeName=e,this.currentNode.children=!1,this.currentLevel++,this.openTags[this.currentLevel]=this.currentNode,this},e.prototype.dtdElement=function(e,t){var n;return this.openCurrent(),n=new o(this,e,t),this.onData(this.writer.dtdElement(n,this.currentLevel+1)),this},e.prototype.attList=function(e,t,n,i,r){var o;return this.openCurrent(),o=new a(this,e,t,n,i,r),this.onData(this.writer.dtdAttList(o,this.currentLevel+1)),this},e.prototype.entity=function(e,t){var n;return this.openCurrent(),n=new s(this,!1,e,t),this.onData(this.writer.dtdEntity(n,this.currentLevel+1)),this},e.prototype.pEntity=function(e,t){var n;return this.openCurrent(),n=new s(this,!0,e,t),this.onData(this.writer.dtdEntity(n,this.currentLevel+1)),this},e.prototype.notation=function(e,t){var n;return this.openCurrent(),n=new l(this,e,t),this.onData(this.writer.dtdNotation(n,this.currentLevel+1)),this},e.prototype.up=function(){if(this.currentLevel<0)throw new Error("The document node has no parent");return this.currentNode?(this.currentNode.children?this.closeNode(this.currentNode):this.openNode(this.currentNode),this.currentNode=null):this.closeNode(this.openTags[this.currentLevel]),delete this.openTags[this.currentLevel],this.currentLevel--,this},e.prototype.end=function(){for(;this.currentLevel>=0;)this.up();return this.onEnd()},e.prototype.openCurrent=function(){if(this.currentNode)return this.currentNode.children=!0,this.openNode(this.currentNode)},e.prototype.openNode=function(e){if(!e.isOpen)return!this.root&&0===this.currentLevel&&e instanceof d&&(this.root=e),this.onData(this.writer.openNode(e,this.currentLevel)),e.isOpen=!0},e.prototype.closeNode=function(e){if(!e.isClosed)return this.onData(this.writer.closeNode(e,this.currentLevel)),e.isClosed=!0},e.prototype.onData=function(e){return this.documentStarted=!0,this.onDataCallback(e)},e.prototype.onEnd=function(){return this.documentCompleted=!0,this.onEndCallback()},e.prototype.ele=function(){return this.element.apply(this,arguments)},e.prototype.nod=function(e,t,n){return this.node(e,t,n)},e.prototype.txt=function(e){return this.text(e)},e.prototype.dat=function(e){return this.cdata(e)},e.prototype.com=function(e){return this.comment(e)},e.prototype.ins=function(e,t){return this.instruction(e,t)},e.prototype.dec=function(e,t,n){return this.declaration(e,t,n)},e.prototype.dtd=function(e,t,n){return this.doctype(e,t,n)},e.prototype.e=function(e,t,n){return this.element(e,t,n)},e.prototype.n=function(e,t,n){return this.node(e,t,n)},e.prototype.t=function(e){return this.text(e)},e.prototype.d=function(e){return this.cdata(e)},e.prototype.c=function(e){return this.comment(e)},e.prototype.r=function(e){return this.raw(e)},e.prototype.i=function(e,t){return this.instruction(e,t)},e.prototype.att=function(){return this.currentNode&&this.currentNode instanceof c?this.attList.apply(this,arguments):this.attribute.apply(this,arguments)},e.prototype.a=function(){return this.currentNode&&this.currentNode instanceof c?this.attList.apply(this,arguments):this.attribute.apply(this,arguments)},e.prototype.ent=function(e,t){return this.entity(e,t)},e.prototype.pent=function(e,t){return this.pEntity(e,t)},e.prototype.not=function(e,t){return this.notation(e,t)},e}()}).call(this)},{"./Utility":3,"./XMLAttribute":4,"./XMLCData":5,"./XMLComment":6,"./XMLDTDAttList":7,"./XMLDTDElement":8,"./XMLDTDEntity":9,"./XMLDTDNotation":10,"./XMLDeclaration":11,"./XMLDocType":12,"./XMLElement":15,"./XMLProcessingInstruction":17,"./XMLRaw":18,"./XMLStringWriter":20,"./XMLStringifier":21,"./XMLText":22}],15:[function(e,t,n){(function(){var n,i,r,a,o,s={}.hasOwnProperty;o=e("./Utility"),a=o.isObject,r=o.isFunction,i=e("./XMLNode"),n=e("./XMLAttribute"),t.exports=function(e){function t(e,n,i){if(t.__super__.constructor.call(this,e),null==n)throw new Error("Missing element name");this.name=this.stringify.eleName(n),this.attributes={},null!=i&&this.attribute(i),e.isDocument&&(this.isRoot=!0,this.documentObject=e,e.rootObject=this)}return function(e,t){for(var n in t)s.call(t,n)&&(e[n]=t[n]);function i(){this.constructor=e}i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype}(t,i),t.prototype.clone=function(){var e,t,n,i;for(t in(n=Object.create(this)).isRoot&&(n.documentObject=null),n.attributes={},i=this.attributes)s.call(i,t)&&(e=i[t],n.attributes[t]=e.clone());return n.children=[],this.children.forEach(function(e){var t;return(t=e.clone()).parent=n,n.children.push(t)}),n},t.prototype.attribute=function(e,t){var i,o;if(null!=e&&(e=e.valueOf()),a(e))for(i in e)s.call(e,i)&&(o=e[i],this.attribute(i,o));else r(t)&&(t=t.apply()),this.options.skipNullAttributes&&null==t||(this.attributes[e]=new n(this,e,t));return this},t.prototype.removeAttribute=function(e){var t,n,i;if(null==e)throw new Error("Missing attribute name");if(e=e.valueOf(),Array.isArray(e))for(n=0,i=e.length;n<i;n++)t=e[n],delete this.attributes[t];else delete this.attributes[e];return this},t.prototype.toString=function(e){return this.options.writer.set(e).element(this)},t.prototype.att=function(e,t){return this.attribute(e,t)},t.prototype.a=function(e,t){return this.attribute(e,t)},t}()}).call(this)},{"./Utility":3,"./XMLAttribute":4,"./XMLNode":16}],16:[function(e,t,n){(function(){var n,i,r,a,o,s,l,u,c,d,h,p,f={}.hasOwnProperty;p=e("./Utility"),h=p.isObject,d=p.isFunction,c=p.isEmpty,o=null,n=null,i=null,r=null,a=null,l=null,u=null,s=null,t.exports=function(){function t(t){this.parent=t,this.parent&&(this.options=this.parent.options,this.stringify=this.parent.stringify),this.children=[],o||(o=e("./XMLElement"),n=e("./XMLCData"),i=e("./XMLComment"),r=e("./XMLDeclaration"),a=e("./XMLDocType"),l=e("./XMLRaw"),u=e("./XMLText"),s=e("./XMLProcessingInstruction"))}return t.prototype.element=function(e,t,n){var i,r,a,o,s,l,u,p,g,m;if(l=null,null==t&&(t={}),t=t.valueOf(),h(t)||(n=(g=[t,n])[0],t=g[1]),null!=e&&(e=e.valueOf()),Array.isArray(e))for(a=0,u=e.length;a<u;a++)r=e[a],l=this.element(r);else if(d(e))l=this.element(e.apply());else if(h(e)){for(s in e)if(f.call(e,s))if(m=e[s],d(m)&&(m=m.apply()),h(m)&&c(m)&&(m=null),!this.options.ignoreDecorators&&this.stringify.convertAttKey&&0===s.indexOf(this.stringify.convertAttKey))l=this.attribute(s.substr(this.stringify.convertAttKey.length),m);else if(!this.options.separateArrayItems&&Array.isArray(m))for(o=0,p=m.length;o<p;o++)r=m[o],(i={})[s]=r,l=this.element(i);else h(m)?(l=this.element(s)).element(m):l=this.element(s,m)}else l=!this.options.ignoreDecorators&&this.stringify.convertTextKey&&0===e.indexOf(this.stringify.convertTextKey)?this.text(n):!this.options.ignoreDecorators&&this.stringify.convertCDataKey&&0===e.indexOf(this.stringify.convertCDataKey)?this.cdata(n):!this.options.ignoreDecorators&&this.stringify.convertCommentKey&&0===e.indexOf(this.stringify.convertCommentKey)?this.comment(n):!this.options.ignoreDecorators&&this.stringify.convertRawKey&&0===e.indexOf(this.stringify.convertRawKey)?this.raw(n):!this.options.ignoreDecorators&&this.stringify.convertPIKey&&0===e.indexOf(this.stringify.convertPIKey)?this.instruction(e.substr(this.stringify.convertPIKey.length),n):this.node(e,t,n);if(null==l)throw new Error("Could not create any elements with: "+e);return l},t.prototype.insertBefore=function(e,t,n){var i,r,a;if(this.isRoot)throw new Error("Cannot insert elements at root level");return r=this.parent.children.indexOf(this),a=this.parent.children.splice(r),i=this.parent.element(e,t,n),Array.prototype.push.apply(this.parent.children,a),i},t.prototype.insertAfter=function(e,t,n){var i,r,a;if(this.isRoot)throw new Error("Cannot insert elements at root level");return r=this.parent.children.indexOf(this),a=this.parent.children.splice(r+1),i=this.parent.element(e,t,n),Array.prototype.push.apply(this.parent.children,a),i},t.prototype.remove=function(){var e;if(this.isRoot)throw new Error("Cannot remove the root element");return e=this.parent.children.indexOf(this),[].splice.apply(this.parent.children,[e,e-e+1].concat([])),this.parent},t.prototype.node=function(e,t,n){var i,r;return null!=e&&(e=e.valueOf()),t||(t={}),t=t.valueOf(),h(t)||(n=(r=[t,n])[0],t=r[1]),i=new o(this,e,t),null!=n&&i.text(n),this.children.push(i),i},t.prototype.text=function(e){var t;return t=new u(this,e),this.children.push(t),this},t.prototype.cdata=function(e){var t;return t=new n(this,e),this.children.push(t),this},t.prototype.comment=function(e){var t;return t=new i(this,e),this.children.push(t),this},t.prototype.commentBefore=function(e){var t,n;return t=this.parent.children.indexOf(this),n=this.parent.children.splice(t),this.parent.comment(e),Array.prototype.push.apply(this.parent.children,n),this},t.prototype.commentAfter=function(e){var t,n;return t=this.parent.children.indexOf(this),n=this.parent.children.splice(t+1),this.parent.comment(e),Array.prototype.push.apply(this.parent.children,n),this},t.prototype.raw=function(e){var t;return t=new l(this,e),this.children.push(t),this},t.prototype.instruction=function(e,t){var n,i,r,a,o;if(null!=e&&(e=e.valueOf()),null!=t&&(t=t.valueOf()),Array.isArray(e))for(a=0,o=e.length;a<o;a++)n=e[a],this.instruction(n);else if(h(e))for(n in e)f.call(e,n)&&(i=e[n],this.instruction(n,i));else d(t)&&(t=t.apply()),r=new s(this,e,t),this.children.push(r);return this},t.prototype.instructionBefore=function(e,t){var n,i;return n=this.parent.children.indexOf(this),i=this.parent.children.splice(n),this.parent.instruction(e,t),Array.prototype.push.apply(this.parent.children,i),this},t.prototype.instructionAfter=function(e,t){var n,i;return n=this.parent.children.indexOf(this),i=this.parent.children.splice(n+1),this.parent.instruction(e,t),Array.prototype.push.apply(this.parent.children,i),this},t.prototype.declaration=function(e,t,n){var i,a;return i=this.document(),a=new r(i,e,t,n),i.children[0]instanceof r?i.children[0]=a:i.children.unshift(a),i.root()||i},t.prototype.doctype=function(e,t){var n,i,r,o,s,l,u,c,d;for(n=this.document(),i=new a(n,e,t),r=o=0,l=(c=n.children).length;o<l;r=++o)if(c[r]instanceof a)return n.children[r]=i,i;for(r=s=0,u=(d=n.children).length;s<u;r=++s)if(d[r].isRoot)return n.children.splice(r,0,i),i;return n.children.push(i),i},t.prototype.up=function(){if(this.isRoot)throw new Error("The root node has no parent. Use doc() if you need to get the document object.");return this.parent},t.prototype.root=function(){var e;for(e=this;e;){if(e.isDocument)return e.rootObject;if(e.isRoot)return e;e=e.parent}},t.prototype.document=function(){var e;for(e=this;e;){if(e.isDocument)return e;e=e.parent}},t.prototype.end=function(e){return this.document().end(e)},t.prototype.prev=function(){var e;if((e=this.parent.children.indexOf(this))<1)throw new Error("Already at the first node");return this.parent.children[e-1]},t.prototype.next=function(){var e;if(-1===(e=this.parent.children.indexOf(this))||e===this.parent.children.length-1)throw new Error("Already at the last node");return this.parent.children[e+1]},t.prototype.importDocument=function(e){var t;return(t=e.root().clone()).parent=this,t.isRoot=!1,this.children.push(t),this},t.prototype.ele=function(e,t,n){return this.element(e,t,n)},t.prototype.nod=function(e,t,n){return this.node(e,t,n)},t.prototype.txt=function(e){return this.text(e)},t.prototype.dat=function(e){return this.cdata(e)},t.prototype.com=function(e){return this.comment(e)},t.prototype.ins=function(e,t){return this.instruction(e,t)},t.prototype.doc=function(){return this.document()},t.prototype.dec=function(e,t,n){return this.declaration(e,t,n)},t.prototype.dtd=function(e,t){return this.doctype(e,t)},t.prototype.e=function(e,t,n){return this.element(e,t,n)},t.prototype.n=function(e,t,n){return this.node(e,t,n)},t.prototype.t=function(e){return this.text(e)},t.prototype.d=function(e){return this.cdata(e)},t.prototype.c=function(e){return this.comment(e)},t.prototype.r=function(e){return this.raw(e)},t.prototype.i=function(e,t){return this.instruction(e,t)},t.prototype.u=function(){return this.up()},t.prototype.importXMLBuilder=function(e){return this.importDocument(e)},t}()}).call(this)},{"./Utility":3,"./XMLCData":5,"./XMLComment":6,"./XMLDeclaration":11,"./XMLDocType":12,"./XMLElement":15,"./XMLProcessingInstruction":17,"./XMLRaw":18,"./XMLText":22}],17:[function(e,t,n){(function(){var n,i={}.hasOwnProperty;n=e("./XMLNode"),t.exports=function(e){function t(e,n,i){if(t.__super__.constructor.call(this,e),null==n)throw new Error("Missing instruction target");this.target=this.stringify.insTarget(n),i&&(this.value=this.stringify.insValue(i))}return function(e,t){for(var n in t)i.call(t,n)&&(e[n]=t[n]);function r(){this.constructor=e}r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype}(t,n),t.prototype.clone=function(){return Object.create(this)},t.prototype.toString=function(e){return this.options.writer.set(e).processingInstruction(this)},t}()}).call(this)},{"./XMLNode":16}],18:[function(e,t,n){(function(){var n,i={}.hasOwnProperty;n=e("./XMLNode"),t.exports=function(e){function t(e,n){if(t.__super__.constructor.call(this,e),null==n)throw new Error("Missing raw text");this.value=this.stringify.raw(n)}return function(e,t){for(var n in t)i.call(t,n)&&(e[n]=t[n]);function r(){this.constructor=e}r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype}(t,n),t.prototype.clone=function(){return Object.create(this)},t.prototype.toString=function(e){return this.options.writer.set(e).raw(this)},t}()}).call(this)},{"./XMLNode":16}],19:[function(e,t,n){(function(){var n,i,r,a,o,s,l,u,c,d,h,p,f,g={}.hasOwnProperty;l=e("./XMLDeclaration"),u=e("./XMLDocType"),n=e("./XMLCData"),i=e("./XMLComment"),c=e("./XMLElement"),h=e("./XMLRaw"),p=e("./XMLText"),d=e("./XMLProcessingInstruction"),r=e("./XMLDTDAttList"),a=e("./XMLDTDElement"),o=e("./XMLDTDEntity"),s=e("./XMLDTDNotation"),f=e("./XMLWriterBase"),t.exports=function(e){function t(e,n){this.stream=e,t.__super__.constructor.call(this,n)}return function(e,t){for(var n in t)g.call(t,n)&&(e[n]=t[n]);function i(){this.constructor=e}i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype}(t,f),t.prototype.document=function(e){var t,n,r,a,o,s,c,h;for(n=0,a=(s=e.children).length;n<a;n++)(t=s[n]).isLastRootNode=!1;for(e.children[e.children.length-1].isLastRootNode=!0,h=[],r=0,o=(c=e.children).length;r<o;r++)switch(t=c[r],!1){case!(t instanceof l):h.push(this.declaration(t));break;case!(t instanceof u):h.push(this.docType(t));break;case!(t instanceof i):h.push(this.comment(t));break;case!(t instanceof d):h.push(this.processingInstruction(t));break;default:h.push(this.element(t))}return h},t.prototype.attribute=function(e){return this.stream.write(" "+e.name+'="'+e.value+'"')},t.prototype.cdata=function(e,t){return this.stream.write(this.space(t)+"<![CDATA["+e.text+"]]>"+this.endline(e))},t.prototype.comment=function(e,t){return this.stream.write(this.space(t)+"\x3c!-- "+e.text+" --\x3e"+this.endline(e))},t.prototype.declaration=function(e,t){return this.stream.write(this.space(t)),this.stream.write('<?xml version="'+e.version+'"'),null!=e.encoding&&this.stream.write(' encoding="'+e.encoding+'"'),null!=e.standalone&&this.stream.write(' standalone="'+e.standalone+'"'),this.stream.write("?>"),this.stream.write(this.endline(e))},t.prototype.docType=function(e,t){var l,u,c,h;if(t||(t=0),this.stream.write(this.space(t)),this.stream.write("<!DOCTYPE "+e.root().name),e.pubID&&e.sysID?this.stream.write(' PUBLIC "'+e.pubID+'" "'+e.sysID+'"'):e.sysID&&this.stream.write(' SYSTEM "'+e.sysID+'"'),e.children.length>0){for(this.stream.write(" ["),this.stream.write(this.endline(e)),u=0,c=(h=e.children).length;u<c;u++)switch(l=h[u],!1){case!(l instanceof r):this.dtdAttList(l,t+1);break;case!(l instanceof a):this.dtdElement(l,t+1);break;case!(l instanceof o):this.dtdEntity(l,t+1);break;case!(l instanceof s):this.dtdNotation(l,t+1);break;case!(l instanceof n):this.cdata(l,t+1);break;case!(l instanceof i):this.comment(l,t+1);break;case!(l instanceof d):this.processingInstruction(l,t+1);break;default:throw new Error("Unknown DTD node type: "+l.constructor.name)}this.stream.write("]")}return this.stream.write(">"),this.stream.write(this.endline(e))},t.prototype.element=function(e,t){var r,a,o,s,l,u,f,m;for(l in t||(t=0),m=this.space(t),this.stream.write(m+"<"+e.name),u=e.attributes)g.call(u,l)&&(r=u[l],this.attribute(r));if(0===e.children.length||e.children.every(function(e){return""===e.value}))this.allowEmpty?this.stream.write("></"+e.name+">"):this.stream.write("/>");else if(this.pretty&&1===e.children.length&&null!=e.children[0].value)this.stream.write(">"),this.stream.write(e.children[0].value),this.stream.write("</"+e.name+">");else{for(this.stream.write(">"+this.newline),o=0,s=(f=e.children).length;o<s;o++)switch(a=f[o],!1){case!(a instanceof n):this.cdata(a,t+1);break;case!(a instanceof i):this.comment(a,t+1);break;case!(a instanceof c):this.element(a,t+1);break;case!(a instanceof h):this.raw(a,t+1);break;case!(a instanceof p):this.text(a,t+1);break;case!(a instanceof d):this.processingInstruction(a,t+1);break;default:throw new Error("Unknown XML node type: "+a.constructor.name)}this.stream.write(m+"</"+e.name+">")}return this.stream.write(this.endline(e))},t.prototype.processingInstruction=function(e,t){return this.stream.write(this.space(t)+"<?"+e.target),e.value&&this.stream.write(" "+e.value),this.stream.write("?>"+this.endline(e))},t.prototype.raw=function(e,t){return this.stream.write(this.space(t)+e.value+this.endline(e))},t.prototype.text=function(e,t){return this.stream.write(this.space(t)+e.value+this.endline(e))},t.prototype.dtdAttList=function(e,t){return this.stream.write(this.space(t)+"<!ATTLIST "+e.elementName+" "+e.attributeName+" "+e.attributeType),"#DEFAULT"!==e.defaultValueType&&this.stream.write(" "+e.defaultValueType),e.defaultValue&&this.stream.write(' "'+e.defaultValue+'"'),this.stream.write(">"+this.endline(e))},t.prototype.dtdElement=function(e,t){return this.stream.write(this.space(t)+"<!ELEMENT "+e.name+" "+e.value+">"+this.endline(e))},t.prototype.dtdEntity=function(e,t){return this.stream.write(this.space(t)+"<!ENTITY"),e.pe&&this.stream.write(" %"),this.stream.write(" "+e.name),e.value?this.stream.write(' "'+e.value+'"'):(e.pubID&&e.sysID?this.stream.write(' PUBLIC "'+e.pubID+'" "'+e.sysID+'"'):e.sysID&&this.stream.write(' SYSTEM "'+e.sysID+'"'),e.nData&&this.stream.write(" NDATA "+e.nData)),this.stream.write(">"+this.endline(e))},t.prototype.dtdNotation=function(e,t){return this.stream.write(this.space(t)+"<!NOTATION "+e.name),e.pubID&&e.sysID?this.stream.write(' PUBLIC "'+e.pubID+'" "'+e.sysID+'"'):e.pubID?this.stream.write(' PUBLIC "'+e.pubID+'"'):e.sysID&&this.stream.write(' SYSTEM "'+e.sysID+'"'),this.stream.write(">"+this.endline(e))},t.prototype.endline=function(e){return e.isLastRootNode?"":this.newline},t}()}).call(this)},{"./XMLCData":5,"./XMLComment":6,"./XMLDTDAttList":7,"./XMLDTDElement":8,"./XMLDTDEntity":9,"./XMLDTDNotation":10,"./XMLDeclaration":11,"./XMLDocType":12,"./XMLElement":15,"./XMLProcessingInstruction":17,"./XMLRaw":18,"./XMLText":22,"./XMLWriterBase":23}],20:[function(e,t,n){(function(){var n,i,r,a,o,s,l,u,c,d,h,p,f,g={}.hasOwnProperty;l=e("./XMLDeclaration"),u=e("./XMLDocType"),n=e("./XMLCData"),i=e("./XMLComment"),c=e("./XMLElement"),h=e("./XMLRaw"),p=e("./XMLText"),d=e("./XMLProcessingInstruction"),r=e("./XMLDTDAttList"),a=e("./XMLDTDElement"),o=e("./XMLDTDEntity"),s=e("./XMLDTDNotation"),f=e("./XMLWriterBase"),t.exports=function(e){function t(e){t.__super__.constructor.call(this,e)}return function(e,t){for(var n in t)g.call(t,n)&&(e[n]=t[n]);function i(){this.constructor=e}i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype}(t,f),t.prototype.document=function(e){var t,n,r,a,o;for(a="",n=0,r=(o=e.children).length;n<r;n++)t=o[n],a+=function(){switch(!1){case!(t instanceof l):return this.declaration(t);case!(t instanceof u):return this.docType(t);case!(t instanceof i):return this.comment(t);case!(t instanceof d):return this.processingInstruction(t);default:return this.element(t,0)}}.call(this);return this.pretty&&a.slice(-this.newline.length)===this.newline&&(a=a.slice(0,-this.newline.length)),a},t.prototype.attribute=function(e){return" "+e.name+'="'+e.value+'"'},t.prototype.cdata=function(e,t){return this.space(t)+"<![CDATA["+e.text+"]]>"+this.newline},t.prototype.comment=function(e,t){return this.space(t)+"\x3c!-- "+e.text+" --\x3e"+this.newline},t.prototype.declaration=function(e,t){var n;return n=this.space(t),n+='<?xml version="'+e.version+'"',null!=e.encoding&&(n+=' encoding="'+e.encoding+'"'),null!=e.standalone&&(n+=' standalone="'+e.standalone+'"'),(n+="?>")+this.newline},t.prototype.docType=function(e,t){var l,u,c,h,p;if(t||(t=0),h=this.space(t),h+="<!DOCTYPE "+e.root().name,e.pubID&&e.sysID?h+=' PUBLIC "'+e.pubID+'" "'+e.sysID+'"':e.sysID&&(h+=' SYSTEM "'+e.sysID+'"'),e.children.length>0){for(h+=" [",h+=this.newline,u=0,c=(p=e.children).length;u<c;u++)l=p[u],h+=function(){switch(!1){case!(l instanceof r):return this.dtdAttList(l,t+1);case!(l instanceof a):return this.dtdElement(l,t+1);case!(l instanceof o):return this.dtdEntity(l,t+1);case!(l instanceof s):return this.dtdNotation(l,t+1);case!(l instanceof n):return this.cdata(l,t+1);case!(l instanceof i):return this.comment(l,t+1);case!(l instanceof d):return this.processingInstruction(l,t+1);default:throw new Error("Unknown DTD node type: "+l.constructor.name)}}.call(this);h+="]"}return(h+=">")+this.newline},t.prototype.element=function(e,t){var r,a,o,s,l,u,f,m,v;for(l in t||(t=0),u="",u+=(v=this.space(t))+"<"+e.name,f=e.attributes)g.call(f,l)&&(r=f[l],u+=this.attribute(r));if(0===e.children.length||e.children.every(function(e){return""===e.value}))this.allowEmpty?u+="></"+e.name+">"+this.newline:u+="/>"+this.newline;else if(this.pretty&&1===e.children.length&&null!=e.children[0].value)u+=">",u+=e.children[0].value,u+="</"+e.name+">"+this.newline;else{for(u+=">"+this.newline,o=0,s=(m=e.children).length;o<s;o++)a=m[o],u+=function(){switch(!1){case!(a instanceof n):return this.cdata(a,t+1);case!(a instanceof i):return this.comment(a,t+1);case!(a instanceof c):return this.element(a,t+1);case!(a instanceof h):return this.raw(a,t+1);case!(a instanceof p):return this.text(a,t+1);case!(a instanceof d):return this.processingInstruction(a,t+1);default:throw new Error("Unknown XML node type: "+a.constructor.name)}}.call(this);u+=v+"</"+e.name+">"+this.newline}return u},t.prototype.processingInstruction=function(e,t){var n;return n=this.space(t)+"<?"+e.target,e.value&&(n+=" "+e.value),n+"?>"+this.newline},t.prototype.raw=function(e,t){return this.space(t)+e.value+this.newline},t.prototype.text=function(e,t){return this.space(t)+e.value+this.newline},t.prototype.dtdAttList=function(e,t){var n;return n=this.space(t)+"<!ATTLIST "+e.elementName+" "+e.attributeName+" "+e.attributeType,"#DEFAULT"!==e.defaultValueType&&(n+=" "+e.defaultValueType),e.defaultValue&&(n+=' "'+e.defaultValue+'"'),n+">"+this.newline},t.prototype.dtdElement=function(e,t){return this.space(t)+"<!ELEMENT "+e.name+" "+e.value+">"+this.newline},t.prototype.dtdEntity=function(e,t){var n;return n=this.space(t)+"<!ENTITY",e.pe&&(n+=" %"),n+=" "+e.name,e.value?n+=' "'+e.value+'"':(e.pubID&&e.sysID?n+=' PUBLIC "'+e.pubID+'" "'+e.sysID+'"':e.sysID&&(n+=' SYSTEM "'+e.sysID+'"'),e.nData&&(n+=" NDATA "+e.nData)),n+">"+this.newline},t.prototype.dtdNotation=function(e,t){var n;return n=this.space(t)+"<!NOTATION "+e.name,e.pubID&&e.sysID?n+=' PUBLIC "'+e.pubID+'" "'+e.sysID+'"':e.pubID?n+=' PUBLIC "'+e.pubID+'"':e.sysID&&(n+=' SYSTEM "'+e.sysID+'"'),n+">"+this.newline},t.prototype.openNode=function(e,t){var n,i,r,a;if(t||(t=0),e instanceof c){for(i in r=this.space(t)+"<"+e.name,a=e.attributes)g.call(a,i)&&(n=a[i],r+=this.attribute(n));return r+(e.children?">":"/>")+this.newline}return r=this.space(t)+"<!DOCTYPE "+e.rootNodeName,e.pubID&&e.sysID?r+=' PUBLIC "'+e.pubID+'" "'+e.sysID+'"':e.sysID&&(r+=' SYSTEM "'+e.sysID+'"'),r+(e.children?" [":">")+this.newline},t.prototype.closeNode=function(e,t){switch(t||(t=0),!1){case!(e instanceof c):return this.space(t)+"</"+e.name+">"+this.newline;case!(e instanceof u):return this.space(t)+"]>"+this.newline}},t}()}).call(this)},{"./XMLCData":5,"./XMLComment":6,"./XMLDTDAttList":7,"./XMLDTDElement":8,"./XMLDTDEntity":9,"./XMLDTDNotation":10,"./XMLDeclaration":11,"./XMLDocType":12,"./XMLElement":15,"./XMLProcessingInstruction":17,"./XMLRaw":18,"./XMLText":22,"./XMLWriterBase":23}],21:[function(e,t,n){(function(){var n,i,r,a,o,s=function(e,t){return function(){return e.apply(t,arguments)}},l={}.hasOwnProperty;r=e("./Utility"),n=r.camelCase,o=r.titleCase,i=r.kebabCase,a=r.snakeCase,t.exports=function(){function e(e){var t,n,i;for(t in this.assertLegalChar=s(this.assertLegalChar,this),e||(e={}),this.allowSurrogateChars=e.allowSurrogateChars,this.noDoubleEncoding=e.noDoubleEncoding,this.textCase=e.textCase,n=e.stringify||{})l.call(n,t)&&(i=n[t],this[t]=i)}return e.prototype.eleName=function(e){return e=""+e||"",e=this.applyCase(e),this.assertLegalChar(e)},e.prototype.eleText=function(e){return e=""+e||"",this.assertLegalChar(this.elEscape(e))},e.prototype.cdata=function(e){return e=(e=""+e||"").replace("]]>","]]]]><![CDATA[>"),this.assertLegalChar(e)},e.prototype.comment=function(e){if((e=""+e||"").match(/--/))throw new Error("Comment text cannot contain double-hypen: "+e);return this.assertLegalChar(e)},e.prototype.raw=function(e){return""+e||""},e.prototype.attName=function(e){return e=""+e||"",this.applyCase(e)},e.prototype.attValue=function(e){return e=""+e||"",this.attEscape(e)},e.prototype.insTarget=function(e){return""+e||""},e.prototype.insValue=function(e){if((e=""+e||"").match(/\?>/))throw new Error("Invalid processing instruction value: "+e);return e},e.prototype.xmlVersion=function(e){if(!(e=""+e||"").match(/1\.[0-9]+/))throw new Error("Invalid version number: "+e);return e},e.prototype.xmlEncoding=function(e){if(!(e=""+e||"").match(/^[A-Za-z](?:[A-Za-z0-9._-]|-)*$/))throw new Error("Invalid encoding: "+e);return e},e.prototype.xmlStandalone=function(e){return e?"yes":"no"},e.prototype.dtdPubID=function(e){return""+e||""},e.prototype.dtdSysID=function(e){return""+e||""},e.prototype.dtdElementValue=function(e){return""+e||""},e.prototype.dtdAttType=function(e){return""+e||""},e.prototype.dtdAttDefault=function(e){return null!=e?""+e||"":e},e.prototype.dtdEntityValue=function(e){return""+e||""},e.prototype.dtdNData=function(e){return""+e||""},e.prototype.convertAttKey="@",e.prototype.convertPIKey="?",e.prototype.convertTextKey="#text",e.prototype.convertCDataKey="#cdata",e.prototype.convertCommentKey="#comment",e.prototype.convertRawKey="#raw",e.prototype.assertLegalChar=function(e){var t,n;if(t=this.allowSurrogateChars?/[\u0000-\u0008\u000B-\u000C\u000E-\u001F\uFFFE-\uFFFF]/:/[\u0000-\u0008\u000B-\u000C\u000E-\u001F\uD800-\uDFFF\uFFFE-\uFFFF]/,n=e.match(t))throw new Error("Invalid character ("+n+") in string: "+e+" at index "+n.index);return e},e.prototype.applyCase=function(e){switch(this.textCase){case"camel":return n(e);case"title":return o(e);case"kebab":case"lower":return i(e);case"snake":return a(e);case"upper":return i(e).toUpperCase();default:return e}},e.prototype.elEscape=function(e){var t;return t=this.noDoubleEncoding?/(?!&\S+;)&/g:/&/g,e.replace(t,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\r/g,"&#xD;")},e.prototype.attEscape=function(e){var t;return t=this.noDoubleEncoding?/(?!&\S+;)&/g:/&/g,e.replace(t,"&amp;").replace(/</g,"&lt;").replace(/"/g,"&quot;").replace(/\t/g,"&#x9;").replace(/\n/g,"&#xA;").replace(/\r/g,"&#xD;")},e}()}).call(this)},{"./Utility":3}],22:[function(e,t,n){(function(){var n,i={}.hasOwnProperty;n=e("./XMLNode"),t.exports=function(e){function t(e,n){if(t.__super__.constructor.call(this,e),null==n)throw new Error("Missing element text");this.value=this.stringify.eleText(n)}return function(e,t){for(var n in t)i.call(t,n)&&(e[n]=t[n]);function r(){this.constructor=e}r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype}(t,n),t.prototype.clone=function(){return Object.create(this)},t.prototype.toString=function(e){return this.options.writer.set(e).text(this)},t}()}).call(this)},{"./XMLNode":16}],23:[function(e,t,n){(function(){var e={}.hasOwnProperty;t.exports=function(){function t(t){var n,i,r,a,o,s,l;for(n in t||(t={}),this.pretty=t.pretty||!1,this.allowEmpty=null!=(i=t.allowEmpty)&&i,this.pretty?(this.indent=null!=(r=t.indent)?r:"  ",this.newline=null!=(a=t.newline)?a:"\n",this.offset=null!=(o=t.offset)?o:0):(this.indent="",this.newline="",this.offset=0),s=t.writer||{})e.call(s,n)&&(l=s[n],this[n]=l)}return t.prototype.set=function(t){var n,i,r;for(n in t||(t={}),"pretty"in t&&(this.pretty=t.pretty),"allowEmpty"in t&&(this.allowEmpty=t.allowEmpty),this.pretty?(this.indent="indent"in t?t.indent:"  ",this.newline="newline"in t?t.newline:"\n",this.offset="offset"in t?t.offset:0):(this.indent="",this.newline="",this.offset=0),i=t.writer||{})e.call(i,n)&&(r=i[n],this[n]=r);return this},t.prototype.space=function(e){return this.pretty?new Array((e||0)+this.offset+1).join(this.indent):""},t}()}).call(this)},{}],24:[function(e,t,n){(function(){var n,i,r,a,o,s,l;l=e("./Utility"),o=l.assign,s=l.isFunction,n=e("./XMLDocument"),i=e("./XMLDocumentCB"),a=e("./XMLStringWriter"),r=e("./XMLStreamWriter"),t.exports.create=function(e,t,i,r){var a,s;if(null==e)throw new Error("Root element needs a name");return r=o({},t,i,r),s=(a=new n(r)).element(e),r.headless||(a.declaration(r),null==r.pubID&&null==r.sysID||a.doctype(r)),s},t.exports.begin=function(e,t,r){var a;return s(e)&&(t=(a=[e,t])[0],r=a[1],e={}),t?new i(e,t,r):new n(e)},t.exports.stringWriter=function(e){return new a(e)},t.exports.streamWriter=function(e,t){return new r(e,t)}}).call(this)},{"./Utility":3,"./XMLDocument":13,"./XMLDocumentCB":14,"./XMLStreamWriter":19,"./XMLStringWriter":20}],25:[function(e,t,n){var i=e("./ecmlBuilder"),r=function(){this.ecmlBuilder=new i};r.prototype.buildECML=function(e,t){return this.ecmlBuilder.buildECML(e,t)},t.exports=r},{"./ecmlBuilder":26}],26:[function(e,t,n){var i=e("lodash"),r=e("xmlbuilder"),a=function(){this.start=function(e,t){var n=this,r=i.omitBy(e,i.isObject);i.forIn(r,function(e,i){n.addProperty(i,e,t)});var a=i.pickBy(e,i.isObject);i.forIn(a,function(e,i){n.addObject(i,e,t)})},this.addProperty=function(e,t,n){switch(e){case"__text":n=n.txt(t);break;case"__cdata":n=n.dat(t);break;default:n=0===t?n.att(e,"0"):n.att(e,(t||"").toString())}},this.addObject=function(e,t,n){var r=this;i.isArray(t)?i.each(t,function(t){r.buildXML(e,t,n)}):r.buildXML(e,t,n)},this.buildXML=function(e,t,n){var r=this;n=n.ele(e);var a=i.omitBy(t,i.isObject);i.forIn(a,function(e,t){r.addProperty(t,e,n)});var o=i.pickBy(t,i.isObject);i.forIn(o,function(e,t){"__cdata"===t?r.addProperty(t,JSON.stringify(e),n):r.addObject(t,e,n)}),n=n.up()}};a.prototype.buildECML=function(e,t){var n=r.create("theme");return this.start(e.theme,n),t?n.end({pretty:!0}):n.end()},t.exports=a},{lodash:2,xmlbuilder:24}]},{},[1])(1);var a="undefined"!=typeof window?window:"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope?self:{},o=function(){var e=/\blang(?:uage)?-(\w+)\b/i,t=0,n=a.Prism={util:{encode:function(e){return e instanceof i?new i(e.type,n.util.encode(e.content),e.alias):"Array"===n.util.type(e)?e.map(n.util.encode):e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/\u00a0/g," ")},type:function(e){return Object.prototype.toString.call(e).match(/\[object (\w+)\]/)[1]},objId:function(e){return e.__id||Object.defineProperty(e,"__id",{value:++t}),e.__id},clone:function(e){switch(n.util.type(e)){case"Object":var t={};for(var i in e)e.hasOwnProperty(i)&&(t[i]=n.util.clone(e[i]));return t;case"Array":return e.map&&e.map(function(e){return n.util.clone(e)})}return e}},languages:{extend:function(e,t){var i=n.util.clone(n.languages[e]);for(var r in t)i[r]=t[r];return i},insertBefore:function(e,t,i,r){var a=(r=r||n.languages)[e];if(2==arguments.length){for(var o in i=arguments[1])i.hasOwnProperty(o)&&(a[o]=i[o]);return a}var s={};for(var l in a)if(a.hasOwnProperty(l)){if(l==t)for(var o in i)i.hasOwnProperty(o)&&(s[o]=i[o]);s[l]=a[l]}return n.languages.DFS(n.languages,function(t,n){n===r[e]&&t!=e&&(this[t]=s)}),r[e]=s},DFS:function(e,t,i,r){for(var a in r=r||{},e)e.hasOwnProperty(a)&&(t.call(e,a,e[a],i||a),"Object"!==n.util.type(e[a])||r[n.util.objId(e[a])]?"Array"!==n.util.type(e[a])||r[n.util.objId(e[a])]||(r[n.util.objId(e[a])]=!0,n.languages.DFS(e[a],t,a,r)):(r[n.util.objId(e[a])]=!0,n.languages.DFS(e[a],t,null,r)))}},plugins:{},highlightAll:function(e,t){var i={callback:t,selector:'code[class*="language-"], [class*="language-"] code, code[class*="lang-"], [class*="lang-"] code'};n.hooks.run("before-highlightall",i);for(var r,a=i.elements||document.querySelectorAll(i.selector),o=0;r=a[o++];)n.highlightElement(r,!0===e,i.callback)},highlightElement:function(t,i,r){for(var o,s,l=t;l&&!e.test(l.className);)l=l.parentNode;l&&(o=(l.className.match(e)||[,""])[1].toLowerCase(),s=n.languages[o]),t.className=t.className.replace(e,"").replace(/\s+/g," ")+" language-"+o,l=t.parentNode,/pre/i.test(l.nodeName)&&(l.className=l.className.replace(e,"").replace(/\s+/g," ")+" language-"+o);var u={element:t,language:o,grammar:s,code:t.textContent};if(n.hooks.run("before-sanity-check",u),!u.code||!u.grammar)return u.code&&(u.element.textContent=u.code),void n.hooks.run("complete",u);if(n.hooks.run("before-highlight",u),i&&a.Worker){var c=new Worker(n.filename);c.onmessage=function(e){u.highlightedCode=e.data,n.hooks.run("before-insert",u),u.element.innerHTML=u.highlightedCode,r&&r.call(u.element),n.hooks.run("after-highlight",u),n.hooks.run("complete",u)},c.postMessage(JSON.stringify({language:u.language,code:u.code,immediateClose:!0}))}else u.highlightedCode=n.highlight(u.code,u.grammar,u.language),n.hooks.run("before-insert",u),u.element.innerHTML=u.highlightedCode,r&&r.call(t),n.hooks.run("after-highlight",u),n.hooks.run("complete",u)},highlight:function(e,t,r){var a=n.tokenize(e,t);return i.stringify(n.util.encode(a),r)},tokenize:function(e,t){var i=n.Token,r=[e],a=t.rest;if(a){for(var o in a)t[o]=a[o];delete t.rest}e:for(var o in t)if(t.hasOwnProperty(o)&&t[o]){var s=t[o];s="Array"===n.util.type(s)?s:[s];for(var l=0;l<s.length;++l){var u=s[l],c=u.inside,d=!!u.lookbehind,h=!!u.greedy,p=0,f=u.alias;if(h&&!u.pattern.global){var g=u.pattern.toString().match(/[imuy]*$/)[0];u.pattern=RegExp(u.pattern.source,g+"g")}u=u.pattern||u;for(var m=0,v=0;m<r.length;v+=r[m].length,++m){var y=r[m];if(r.length>e.length)break e;if(!(y instanceof i)){u.lastIndex=0;var b=1;if(!(k=u.exec(y))&&h&&m!=r.length-1){if(u.lastIndex=v,!(k=u.exec(e)))break;for(var _=k.index+(d?k[1].length:0),T=k.index+k[0].length,E=m,C=v,w=r.length;w>E&&T>C;++E)_>=(C+=r[E].length)&&(++m,v=C);if(r[m]instanceof i||r[E-1].greedy)continue;b=E-m,y=e.slice(v,C),k.index-=v}if(k){d&&(p=k[1].length),T=(_=k.index+p)+(k=k[0].slice(p)).length;var k,S=y.slice(0,_),I=y.slice(T),O=[m,b];S&&O.push(S);var D=new i(o,c?n.tokenize(k,c):k,f,k,h);O.push(D),I&&O.push(I),Array.prototype.splice.apply(r,O)}}}}}return r},hooks:{all:{},add:function(e,t){var i=n.hooks.all;i[e]=i[e]||[],i[e].push(t)},run:function(e,t){var i=n.hooks.all[e];if(i&&i.length)for(var r,a=0;r=i[a++];)r(t)}}},i=n.Token=function(e,t,n,i,r){this.type=e,this.content=t,this.alias=n,this.length=0|(i||"").length,this.greedy=!!r};if(i.stringify=function(e,t,r){if("string"==typeof e)return e;if("Array"===n.util.type(e))return e.map(function(n){return i.stringify(n,t,e)}).join("");var a={type:e.type,content:i.stringify(e.content,t,r),tag:"span",classes:["token",e.type],attributes:{},language:t,parent:r};if("comment"==a.type&&(a.attributes.spellcheck="true"),e.alias){var o="Array"===n.util.type(e.alias)?e.alias:[e.alias];Array.prototype.push.apply(a.classes,o)}n.hooks.run("wrap",a);var s=Object.keys(a.attributes).map(function(e){return e+'="'+(a.attributes[e]||"").replace(/"/g,"&quot;")+'"'}).join(" ");return"<"+a.tag+' class="'+a.classes.join(" ")+'"'+(s?" "+s:"")+">"+a.content+"</"+a.tag+">"},!a.document)return a.addEventListener?(a.addEventListener("message",function(e){var t=JSON.parse(e.data),i=t.language,r=t.code,o=t.immediateClose;a.postMessage(n.highlight(r,n.languages[i],i)),o&&a.close()},!1),a.Prism):a.Prism;var r=document.currentScript||[].slice.call(document.getElementsByTagName("script")).pop();return r&&(n.filename=r.src,document.addEventListener&&!r.hasAttribute("data-manual")&&("loading"!==document.readyState?window.requestAnimationFrame?window.requestAnimationFrame(n.highlightAll):window.setTimeout(n.highlightAll,16):document.addEventListener("DOMContentLoaded",n.highlightAll))),a.Prism}();void 0!==e&&e.exports&&(e.exports=o),void 0!==t&&(t.Prism=o),o.languages.markup={comment:/<!--[\w\W]*?-->/,prolog:/<\?[\w\W]+?\?>/,doctype:/<!DOCTYPE[\w\W]+?>/i,cdata:/<!\[CDATA\[[\w\W]*?]]>/i,tag:{pattern:/<\/?(?!\d)[^\s>\/=$<]+(?:\s+[^\s>\/=]+(?:=(?:("|')(?:\\\1|\\?(?!\1)[\w\W])*\1|[^\s'">=]+))?)*\s*\/?>/i,inside:{tag:{pattern:/^<\/?[^\s>\/]+/i,inside:{punctuation:/^<\/?/,namespace:/^[^\s>\/:]+:/}},"attr-value":{pattern:/=(?:('|")[\w\W]*?(\1)|[^\s>]+)/i,inside:{punctuation:/[=>"']/}},punctuation:/\/?>/,"attr-name":{pattern:/[^\s>\/]+/,inside:{namespace:/^[^\s>\/:]+:/}}}},entity:/&#?[\da-z]{1,8};/i},o.hooks.add("wrap",function(e){"entity"===e.type&&(e.attributes.title=e.content.replace(/&amp;/,"&"))}),o.languages.xml=o.languages.markup,o.languages.html=o.languages.markup,o.languages.mathml=o.languages.markup,o.languages.svg=o.languages.markup,o.languages.css={comment:/\/\*[\w\W]*?\*\//,atrule:{pattern:/@[\w-]+?.*?(;|(?=\s*\{))/i,inside:{rule:/@[\w-]+/}},url:/url\((?:(["'])(\\(?:\r\n|[\w\W])|(?!\1)[^\\\r\n])*\1|.*?)\)/i,selector:/[^\{\}\s][^\{\};]*?(?=\s*\{)/,string:{pattern:/("|')(\\(?:\r\n|[\w\W])|(?!\1)[^\\\r\n])*\1/,greedy:!0},property:/(\b|\B)[\w-]+(?=\s*:)/i,important:/\B!important\b/i,function:/[-a-z0-9]+(?=\()/i,punctuation:/[(){};:]/},o.languages.css.atrule.inside.rest=o.util.clone(o.languages.css),o.languages.markup&&(o.languages.insertBefore("markup","tag",{style:{pattern:/(<style[\w\W]*?>)[\w\W]*?(?=<\/style>)/i,lookbehind:!0,inside:o.languages.css,alias:"language-css"}}),o.languages.insertBefore("inside","attr-value",{"style-attr":{pattern:/\s*style=("|').*?\1/i,inside:{"attr-name":{pattern:/^\s*style/i,inside:o.languages.markup.tag.inside},punctuation:/^\s*=\s*['"]|['"]\s*$/,"attr-value":{pattern:/.+/i,inside:o.languages.css}},alias:"language-css"}},o.languages.markup.tag)),o.languages.clike={comment:[{pattern:/(^|[^\\])\/\*[\w\W]*?\*\//,lookbehind:!0},{pattern:/(^|[^\\:])\/\/.*/,lookbehind:!0}],string:{pattern:/(["'])(\\(?:\r\n|[\s\S])|(?!\1)[^\\\r\n])*\1/,greedy:!0},"class-name":{pattern:/((?:\b(?:class|interface|extends|implements|trait|instanceof|new)\s+)|(?:catch\s+\())[a-z0-9_\.\\]+/i,lookbehind:!0,inside:{punctuation:/(\.|\\)/}},keyword:/\b(if|else|while|do|for|return|in|instanceof|function|new|try|throw|catch|finally|null|break|continue)\b/,boolean:/\b(true|false)\b/,function:/[a-z0-9_]+(?=\()/i,number:/\b-?(?:0x[\da-f]+|\d*\.?\d+(?:e[+-]?\d+)?)\b/i,operator:/--?|\+\+?|!=?=?|<=?|>=?|==?=?|&&?|\|\|?|\?|\*|\/|~|\^|%/,punctuation:/[{}[\];(),.:]/},o.languages.javascript=o.languages.extend("clike",{keyword:/\b(as|async|await|break|case|catch|class|const|continue|debugger|default|delete|do|else|enum|export|extends|finally|for|from|function|get|if|implements|import|in|instanceof|interface|let|new|null|of|package|private|protected|public|return|set|static|super|switch|this|throw|try|typeof|var|void|while|with|yield)\b/,number:/\b-?(0x[\dA-Fa-f]+|0b[01]+|0o[0-7]+|\d*\.?\d+([Ee][+-]?\d+)?|NaN|Infinity)\b/,function:/[_$a-zA-Z\xA0-\uFFFF][_$a-zA-Z0-9\xA0-\uFFFF]*(?=\()/i,operator:/--?|\+\+?|!=?=?|<=?|>=?|==?=?|&&?|\|\|?|\?|\*\*?|\/|~|\^|%|\.{3}/}),o.languages.insertBefore("javascript","keyword",{regex:{pattern:/(^|[^\/])\/(?!\/)(\[.+?]|\\.|[^\/\\\r\n])+\/[gimyu]{0,5}(?=\s*($|[\r\n,.;})]))/,lookbehind:!0,greedy:!0}}),o.languages.insertBefore("javascript","string",{"template-string":{pattern:/`(?:\\\\|\\?[^\\])*?`/,greedy:!0,inside:{interpolation:{pattern:/\$\{[^}]+\}/,inside:{"interpolation-punctuation":{pattern:/^\$\{|\}$/,alias:"punctuation"},rest:o.languages.javascript}},string:/[\s\S]+/}}}),o.languages.markup&&o.languages.insertBefore("markup","tag",{script:{pattern:/(<script[\w\W]*?>)[\w\W]*?(?=<\/script>)/i,lookbehind:!0,inside:o.languages.javascript,alias:"language-javascript"}}),o.languages.js=o.languages.javascript,"undefined"!=typeof self&&self.Prism&&self.document&&o.hooks.add("complete",function(e){if(e.code){var t=e.element.parentNode,n=/\s*\bline-numbers\b\s*/;if(t&&/pre/i.test(t.nodeName)&&(n.test(t.className)||n.test(e.element.className))&&!e.element.querySelector(".line-numbers-rows")){n.test(e.element.className)&&(e.element.className=e.element.className.replace(n,"")),n.test(t.className)||(t.className+=" line-numbers");var i,r=e.code.match(/\n(?!$)/g),a=r?r.length+1:1,o=new Array(a+1);o=o.join("<span></span>"),(i=document.createElement("span")).setAttribute("aria-hidden","true"),i.className="line-numbers-rows",i.innerHTML=o,t.hasAttribute("data-start")&&(t.style.counterReset="linenumber "+(parseInt(t.getAttribute("data-start"),10)-1)),e.element.appendChild(i)}}}),function(){if("undefined"!=typeof self&&self.Prism&&self.document){var e=[],t={},n=function(){};o.plugins.toolbar={};var i=o.plugins.toolbar.registerButton=function(n,i){var r;r="function"==typeof i?i:function(e){var t;return"function"==typeof i.onClick?((t=document.createElement("button")).type="button",t.addEventListener("click",function(){i.onClick.call(this,e)})):"string"==typeof i.url?(t=document.createElement("a")).href=i.url:t=document.createElement("span"),t.textContent=i.text,t},e.push(t[n]=r)},r=o.plugins.toolbar.hook=function(i){var r=i.element.parentNode;if(r&&/pre/i.test(r.nodeName)&&!r.classList.contains("code-toolbar")){r.classList.add("code-toolbar");var a=document.createElement("div");a.classList.add("toolbar"),document.body.hasAttribute("data-toolbar-order")&&(e=document.body.getAttribute("data-toolbar-order").split(",").map(function(e){return t[e]||n})),e.forEach(function(e){var t=e(i);if(t){var n=document.createElement("div");n.classList.add("toolbar-item"),n.appendChild(t),a.appendChild(n)}}),r.appendChild(a)}};i("label",function(e){var t=e.element.parentNode;if(t&&/pre/i.test(t.nodeName)&&t.hasAttribute("data-label")){var n,i,r=t.getAttribute("data-label");try{i=document.querySelector("template#"+r)}catch(e){}return i?n=i.content:(t.hasAttribute("data-url")?(n=document.createElement("a")).href=t.getAttribute("data-url"):n=document.createElement("span"),n.textContent=r),n}}),o.hooks.add("complete",r)}}(),function(){function e(e){this.defaults=i({},e)}function t(e){return e.replace(/-(\w)/g,function(e,t){return t.toUpperCase()})}function n(e){for(var t=0,n=0;n<e.length;++n)e.charCodeAt(n)=="\t".charCodeAt(0)&&(t+=3);return e.length+t}if("undefined"!=typeof self&&self.Prism&&self.document){var i=Object.assign||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return e};e.prototype={setDefaults:function(e){this.defaults=i(this.defaults,e)},normalize:function(e,n){for(var r in n=i(this.defaults,n)){var a=t(r);"normalize"!==r&&"setDefaults"!==a&&n[r]&&this[a]&&(e=this[a].call(this,e,n[r]))}return e},leftTrim:function(e){return e.replace(/^\s+/,"")},rightTrim:function(e){return e.replace(/\s+$/,"")},tabsToSpaces:function(e,t){return t=0|t||4,e.replace(/\t/g,new Array(++t).join(" "))},spacesToTabs:function(e,t){return t=0|t||4,e.replace(new RegExp(" {"+t+"}","g"),"\t")},removeTrailing:function(e){return e.replace(/\s*?$/gm,"")},removeInitialLineFeed:function(e){return e.replace(/^(?:\r?\n|\r)/,"")},removeIndent:function(e){var t=e.match(/^[^\S\n\r]*(?=\S)/gm);return t&&t[0].length?(t.sort(function(e,t){return e.length-t.length}),t[0].length?e.replace(new RegExp("^"+t[0],"gm"),""):e):e},indent:function(e,t){return e.replace(/^[^\S\n\r]*(?=\S)/gm,new Array(++t).join("\t")+"$&")},breakLines:function(e,t){t=!0===t?80:0|t||80;for(var i=e.split("\n"),r=0;r<i.length;++r)if(!(n(i[r])<=t)){for(var a=i[r].split(/(\s+)/g),o=0,s=0;s<a.length;++s){var l=n(a[s]);(o+=l)>t&&(a[s]="\n"+a[s],o=l)}i[r]=a.join("")}return i.join("\n")}},o.plugins.NormalizeWhitespace=new e({"remove-trailing":!0,"remove-indent":!0,"left-trim":!0,"right-trim":!0}),o.hooks.add("before-sanity-check",function(e){var t=e.element.parentNode,n=/\bno-whitespace-normalization\b/;if(!(!e.code||!t||"pre"!==t.nodeName.toLowerCase()||e.settings&&!1===e.settings["whitespace-normalization"]||n.test(t.className)||n.test(e.element.className))){for(var i=t.childNodes,r="",a="",s=!1,l=o.plugins.NormalizeWhitespace,u=0;u<i.length;++u){var c=i[u];c==e.element?s=!0:"#text"===c.nodeName&&(s?a+=c.nodeValue:r+=c.nodeValue,t.removeChild(c),--u)}if(e.element.children.length&&o.plugins.KeepMarkup){var d=r+e.element.innerHTML+a;e.element.innerHTML=l.normalize(d,e.settings),e.code=e.element.textContent}else e.code=r+e.code+a,e.code=l.normalize(e.code,e.settings)}})}}(),function(){if("undefined"!=typeof self&&self.Prism&&self.document){if(!o.plugins.toolbar)return void console.warn("Copy to Clipboard plugin loaded before Toolbar plugin.");var e=window.Clipboard||void 0;e||(e=n(75));var t=[];if(!e){var i=document.createElement("script"),r=document.querySelector("head");i.onload=function(){if(e=window.Clipboard)for(;t.length;)t.pop()()},i.src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.5.8/clipboard.min.js",r.appendChild(i)}o.plugins.toolbar.registerButton("copy-to-clipboard",function(n){function i(){var t=new e(a,{text:function(){return n.code}});t.on("success",function(){a.textContent="Copied!",r()}),t.on("error",function(){a.textContent="Press Ctrl+C to copy",r()})}function r(){setTimeout(function(){a.textContent="Copy"},5e3)}var a=document.createElement("a");return a.textContent="Copy",e?i():t.push(i),a})}}(),org.ekstep.pluginframework.pluginManager.registerPlugin({id:"org.ekstep.viewecml",ver:"1.0",author:"Anshu Narayan",title:"viewecml Plugin",description:"",publishedDate:"",editor:{main:"editor/plugin.js",dependencies:[{type:"js",src:"editor/libs/dist/E2EConverter.js"},{type:"css",src:"editor/libs/prism/prism.css"},{type:"js",src:"editor/libs/prism/prism.js"}],views:[{template:"./ECMLbrowser.html",controller:""}],menu:[{}]}},org.ekstep.contenteditor.basePlugin.extend({type:"viewecml",callback:function(){},initialize:function(){o.plugins.NormalizeWhitespace.setDefaults({"break-lines":80}),converter=new i,ecEditor.addEventListener(this.manifest.id+":show",this.initViewECML,this),ecEditor.resolvePluginResource(this.manifest.id,this.manifest.ver,"editor/ECMLbrowser.html"),setTimeout(function(){ecEditor.getService("popup").loadNgModules(n(76),void 0,!0)},1e3)},initViewECML:function(e,t){var n=this;this.callback=t,this.loadResource("editor/ECMLbrowser.html","html",function(e,t){n.showECMLBrowser(e,t)})},showECMLBrowser:function(e,t){ecEditor.getService("popup").open({template:"partials_org.ekstep.ECMLbrowser.html",controller:["$scope",this.controllerCallback],controllerAs:"$ctrl",showClose:!1,width:900,className:"ngdialog-theme-plain"})},controllerCallback:function(e,t){var n=this;n.contentBody="ECML Content",n.previewLoad=function(){var t=org.ekstep.contenteditor.stageManager.toECML();ecEditor.getAngularScope().developerMode&&(t.theme["plugin-manifest"]||(t.theme["plugin-manifest"]={plugin:[]}),_.isArray(t.theme["plugin-manifest"].plugin)||(t.theme["plugin-manifest"].plugin=[t.theme["plugin-manifest"].plugin]),t.theme["plugin-manifest"].plugin.splice(0,0,{id:"org.ekstep.developer",ver:"1.0",type:"plugin",hostPath:org.ekstep.pluginframework.hostRepo.basePath,preload:!0})),n.contentBody=converter.buildECML(t,!0),e.$safeApply(function(){setTimeout(function(){o.highlightElement(ecEditor.jQuery("#xmlBody")[0])},100)})},n.previewLoad(),n.copyToClipboard=function(e){var t,n,i,r,a="_hiddenCopyText_",o="INPUT"===(e=document.getElementById(e)).tagName||"TEXTAREA"===e.tagName;o?(t=(i=e).selectionStart,n=e.selectionEnd):((i=document.getElementById(a))||((i=document.createElement("textarea")).style.position="absolute",i.style.left="-9999px",i.style.top="0",i.id=a,document.body.appendChild(i)),i.textContent=e.textContent),a=document.activeElement,i.focus(),i.setSelectionRange(0,i.value.length),console.log(i);try{r=document.execCommand("copy"),window.alert("Copied!")}catch(e){r=!1}return a&&"function"==typeof a.focus&&a.focus(),o?e.setSelectionRange(t,n):i.textContent="",r},n.closeWindow=function(){e.closeThisDialog()}}}))}).call(this,n(3),n(64))},function(e,t,n){(function(t){e.exports=t.E2EConverter=n(65)}).call(this,n(3))},function(e,t,n){var i=n(66),r=function(){this.ecmlBuilder=new i};r.prototype.buildECML=function(e,t){return this.ecmlBuilder.buildECML(e,t)},e.exports=r},function(e,t,n){var i=n(67),r=function(){this.start=function(e,t){var n=this,i=_.omitBy(e,_.isObject);_.forIn(i,function(e,i){n.addProperty(i,e,t)});var r=_.pickBy(e,_.isObject);_.forIn(r,function(e,i){n.addObject(i,e,t)})},this.addProperty=function(e,t,n){switch(e){case"__text":n=n.txt(t);break;case"__cdata":n=n.dat(t);break;default:n=0===t?n.att(e,"0"):n.att(e,(t||"").toString())}},this.addObject=function(e,t,n){var i=this;_.isArray(t)?_.each(t,function(t){i.buildXML(e,t,n)}):i.buildXML(e,t,n)},this.buildXML=function(e,t,n){var i=this;n=n.ele(e);var r=_.omitBy(t,_.isObject);_.forIn(r,function(e,t){i.addProperty(t,e,n)});var a=_.pickBy(t,_.isObject);_.forIn(a,function(e,t){"__cdata"===t?i.addProperty(t,JSON.stringify(e),n):i.addObject(t,e,n)}),n=n.up()}};r.prototype.buildECML=function(e,t){var n=i.create("theme");return this.start(e.theme,n),t?n.end({pretty:!0}):n.end()},e.exports=r},function(e,t,n){(function(){var t,i,r,a,o,s,l,u,c;({assign:u,isFunction:c}=n(2)),r=n(24),a=n(25),o=n(73),l=n(19),s=n(74),t=n(0),i=n(5),e.exports.create=function(e,t,n,i){var r,o;if(null==e)throw new Error("Root element needs a name.");return i=u({},t,n,i),o=(r=new a(i)).element(e),i.headless||(r.declaration(i),null==i.pubID&&null==i.sysID||r.dtd(i)),o},e.exports.begin=function(e,t,n){return c(e)&&([t,n]=[e,t],e={}),t?new o(e,t,n):new a(e)},e.exports.stringWriter=function(e){return new l(e)},e.exports.streamWriter=function(e,t){return new s(e,t)},e.exports.implementation=new r,e.exports.nodeType=t,e.exports.writerState=i}).call(this)},function(e,t,n){(function(){var t,i;t=n(69),i=n(70),e.exports=function(){class e{constructor(){this.defaultParams={"canonical-form":!1,"cdata-sections":!1,comments:!1,"datatype-normalization":!1,"element-content-whitespace":!0,entities:!0,"error-handler":new t,infoset:!0,"validate-if-schema":!1,namespaces:!0,"namespace-declarations":!0,"normalize-characters":!1,"schema-location":"","schema-type":"","split-cdata-sections":!0,validate:!1,"well-formed":!0},this.params=Object.create(this.defaultParams)}getParameter(e){return this.params.hasOwnProperty(e)?this.params[e]:null}canSetParameter(e,t){return!0}setParameter(e,t){return null!=t?this.params[e]=t:delete this.params[e]}}return Object.defineProperty(e.prototype,"parameterNames",{get:function(){return new i(Object.keys(this.defaultParams))}}),e}.call(this)}).call(this)},function(e,t){(function(){e.exports=class{constructor(){}handleError(e){throw new Error(e)}}}).call(this)},function(e,t){(function(){e.exports=function(){class e{constructor(e){this.arr=e||[]}item(e){return this.arr[e]||null}contains(e){return-1!==this.arr.indexOf(e)}}return Object.defineProperty(e.prototype,"length",{get:function(){return this.arr.length}}),e}.call(this)}).call(this)},function(e,t){(function(){e.exports=function(){class e{constructor(e){this.nodes=e}clone(){return this.nodes=null}item(e){return this.nodes[e]||null}}return Object.defineProperty(e.prototype,"length",{get:function(){return this.nodes.length||0}}),e}.call(this)}).call(this)},function(e,t){(function(){e.exports={Disconnected:1,Preceding:2,Following:4,Contains:8,ContainedBy:16,ImplementationSpecific:32}}).call(this)},function(e,t,n){(function(){var t,i,r,a,o,s,l,u,c,d,h,p,f,g,m,v,y,b,_,T,E,C,w={}.hasOwnProperty;({isObject:E,isFunction:T,isPlainObject:C,getValue:_}=n(2)),t=n(0),p=n(25),f=n(6),a=n(8),o=n(9),m=n(16),b=n(17),g=n(18),d=n(10),h=n(11),s=n(12),u=n(13),l=n(14),c=n(15),r=n(26),y=n(28),v=n(19),i=n(5),e.exports=class{constructor(e,n,i){var r;this.name="?xml",this.type=t.Document,e||(e={}),r={},e.writer?C(e.writer)&&(r=e.writer,e.writer=new v):e.writer=new v,this.options=e,this.writer=e.writer,this.writerOptions=this.writer.filterOptions(r),this.stringify=new y(e),this.onDataCallback=n||function(){},this.onEndCallback=i||function(){},this.currentNode=null,this.currentLevel=-1,this.openTags={},this.documentStarted=!1,this.documentCompleted=!1,this.root=null}createChildNode(e){var n,i,r,a,o,s,l,u;switch(e.type){case t.CData:this.cdata(e.value);break;case t.Comment:this.comment(e.value);break;case t.Element:for(i in r={},l=e.attribs)w.call(l,i)&&(n=l[i],r[i]=n.value);this.node(e.name,r);break;case t.Dummy:this.dummy();break;case t.Raw:this.raw(e.value);break;case t.Text:this.text(e.value);break;case t.ProcessingInstruction:this.instruction(e.target,e.value);break;default:throw new Error("This XML node type is not supported in a JS object: "+e.constructor.name)}for(o=0,s=(u=e.children).length;o<s;o++)a=u[o],this.createChildNode(a),a.type===t.Element&&this.up();return this}dummy(){return this}node(e,t,n){if(null==e)throw new Error("Missing node name.");if(this.root&&-1===this.currentLevel)throw new Error("Document can only have one root node. "+this.debugInfo(e));return this.openCurrent(),e=_(e),null==t&&(t={}),t=_(t),E(t)||([n,t]=[t,n]),this.currentNode=new f(this,e,t),this.currentNode.children=!1,this.currentLevel++,this.openTags[this.currentLevel]=this.currentNode,null!=n&&this.text(n),this}element(e,n,i){var r,a,o,s,l,u;if(this.currentNode&&this.currentNode.type===t.DocType)this.dtdElement(...arguments);else if(Array.isArray(e)||E(e)||T(e))for(s=this.options.noValidation,this.options.noValidation=!0,(u=new p(this.options).element("TEMP_ROOT")).element(e),this.options.noValidation=s,a=0,o=(l=u.children).length;a<o;a++)r=l[a],this.createChildNode(r),r.type===t.Element&&this.up();else this.node(e,n,i);return this}attribute(e,t){var n,i;if(!this.currentNode||this.currentNode.children)throw new Error("att() can only be used immediately after an ele() call in callback mode. "+this.debugInfo(e));if(null!=e&&(e=_(e)),E(e))for(n in e)w.call(e,n)&&(i=e[n],this.attribute(n,i));else T(t)&&(t=t.apply()),this.options.keepNullAttributes&&null==t?this.currentNode.attribs[e]=new r(this,e,""):null!=t&&(this.currentNode.attribs[e]=new r(this,e,t));return this}text(e){var t;return this.openCurrent(),t=new b(this,e),this.onData(this.writer.text(t,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this}cdata(e){var t;return this.openCurrent(),t=new a(this,e),this.onData(this.writer.cdata(t,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this}comment(e){var t;return this.openCurrent(),t=new o(this,e),this.onData(this.writer.comment(t,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this}raw(e){var t;return this.openCurrent(),t=new m(this,e),this.onData(this.writer.raw(t,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this}instruction(e,t){var n,i,r,a,o;if(this.openCurrent(),null!=e&&(e=_(e)),null!=t&&(t=_(t)),Array.isArray(e))for(n=0,a=e.length;n<a;n++)i=e[n],this.instruction(i);else if(E(e))for(i in e)w.call(e,i)&&(r=e[i],this.instruction(i,r));else T(t)&&(t=t.apply()),o=new g(this,e,t),this.onData(this.writer.processingInstruction(o,this.writerOptions,this.currentLevel+1),this.currentLevel+1);return this}declaration(e,t,n){var i;if(this.openCurrent(),this.documentStarted)throw new Error("declaration() must be the first node.");return i=new d(this,e,t,n),this.onData(this.writer.declaration(i,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this}doctype(e,t,n){if(this.openCurrent(),null==e)throw new Error("Missing root node name.");if(this.root)throw new Error("dtd() must come before the root node.");return this.currentNode=new h(this,t,n),this.currentNode.rootNodeName=e,this.currentNode.children=!1,this.currentLevel++,this.openTags[this.currentLevel]=this.currentNode,this}dtdElement(e,t){var n;return this.openCurrent(),n=new l(this,e,t),this.onData(this.writer.dtdElement(n,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this}attList(e,t,n,i,r){var a;return this.openCurrent(),a=new s(this,e,t,n,i,r),this.onData(this.writer.dtdAttList(a,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this}entity(e,t){var n;return this.openCurrent(),n=new u(this,!1,e,t),this.onData(this.writer.dtdEntity(n,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this}pEntity(e,t){var n;return this.openCurrent(),n=new u(this,!0,e,t),this.onData(this.writer.dtdEntity(n,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this}notation(e,t){var n;return this.openCurrent(),n=new c(this,e,t),this.onData(this.writer.dtdNotation(n,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this}up(){if(this.currentLevel<0)throw new Error("The document node has no parent.");return this.currentNode?(this.currentNode.children?this.closeNode(this.currentNode):this.openNode(this.currentNode),this.currentNode=null):this.closeNode(this.openTags[this.currentLevel]),delete this.openTags[this.currentLevel],this.currentLevel--,this}end(){for(;this.currentLevel>=0;)this.up();return this.onEnd()}openCurrent(){if(this.currentNode)return this.currentNode.children=!0,this.openNode(this.currentNode)}openNode(e){var n,r,a,o;if(!e.isOpen){if(this.root||0!==this.currentLevel||e.type!==t.Element||(this.root=e),r="",e.type===t.Element){for(a in this.writerOptions.state=i.OpenTag,r=this.writer.indent(e,this.writerOptions,this.currentLevel)+"<"+e.name,o=e.attribs)w.call(o,a)&&(n=o[a],r+=this.writer.attribute(n,this.writerOptions,this.currentLevel));r+=(e.children?">":"/>")+this.writer.endline(e,this.writerOptions,this.currentLevel),this.writerOptions.state=i.InsideTag}else this.writerOptions.state=i.OpenTag,r=this.writer.indent(e,this.writerOptions,this.currentLevel)+"<!DOCTYPE "+e.rootNodeName,e.pubID&&e.sysID?r+=' PUBLIC "'+e.pubID+'" "'+e.sysID+'"':e.sysID&&(r+=' SYSTEM "'+e.sysID+'"'),e.children?(r+=" [",this.writerOptions.state=i.InsideTag):(this.writerOptions.state=i.CloseTag,r+=">"),r+=this.writer.endline(e,this.writerOptions,this.currentLevel);return this.onData(r,this.currentLevel),e.isOpen=!0}}closeNode(e){var n;if(!e.isClosed)return n="",this.writerOptions.state=i.CloseTag,n=e.type===t.Element?this.writer.indent(e,this.writerOptions,this.currentLevel)+"</"+e.name+">"+this.writer.endline(e,this.writerOptions,this.currentLevel):this.writer.indent(e,this.writerOptions,this.currentLevel)+"]>"+this.writer.endline(e,this.writerOptions,this.currentLevel),this.writerOptions.state=i.None,this.onData(n,this.currentLevel),e.isClosed=!0}onData(e,t){return this.documentStarted=!0,this.onDataCallback(e,t+1)}onEnd(){return this.documentCompleted=!0,this.onEndCallback()}debugInfo(e){return null==e?"":"node: <"+e+">"}ele(){return this.element(...arguments)}nod(e,t,n){return this.node(e,t,n)}txt(e){return this.text(e)}dat(e){return this.cdata(e)}com(e){return this.comment(e)}ins(e,t){return this.instruction(e,t)}dec(e,t,n){return this.declaration(e,t,n)}dtd(e,t,n){return this.doctype(e,t,n)}e(e,t,n){return this.element(e,t,n)}n(e,t,n){return this.node(e,t,n)}t(e){return this.text(e)}d(e){return this.cdata(e)}c(e){return this.comment(e)}r(e){return this.raw(e)}i(e,t){return this.instruction(e,t)}att(){return this.currentNode&&this.currentNode.type===t.DocType?this.attList(...arguments):this.attribute(...arguments)}a(){return this.currentNode&&this.currentNode.type===t.DocType?this.attList(...arguments):this.attribute(...arguments)}ent(e,t){return this.entity(e,t)}pent(e,t){return this.pEntity(e,t)}not(e,t){return this.notation(e,t)}}}).call(this)},function(e,t,n){(function(){var t,i,r,a={}.hasOwnProperty;t=n(0),r=n(29),i=n(5),e.exports=class extends r{constructor(e,t){super(t),this.stream=e}endline(e,t,n){return e.isLastRootNode&&t.state===i.CloseTag?"":super.endline(e,t,n)}document(e,t){var n,i,r,a,o,s,l,u,c;for(i=r=0,o=(l=e.children).length;r<o;i=++r)(n=l[i]).isLastRootNode=i===e.children.length-1;for(t=this.filterOptions(t),c=[],a=0,s=(u=e.children).length;a<s;a++)n=u[a],c.push(this.writeChildNode(n,t,0));return c}cdata(e,t,n){return this.stream.write(super.cdata(e,t,n))}comment(e,t,n){return this.stream.write(super.comment(e,t,n))}declaration(e,t,n){return this.stream.write(super.declaration(e,t,n))}docType(e,t,n){var r,a,o,s;if(n||(n=0),this.openNode(e,t,n),t.state=i.OpenTag,this.stream.write(this.indent(e,t,n)),this.stream.write("<!DOCTYPE "+e.root().name),e.pubID&&e.sysID?this.stream.write(' PUBLIC "'+e.pubID+'" "'+e.sysID+'"'):e.sysID&&this.stream.write(' SYSTEM "'+e.sysID+'"'),e.children.length>0){for(this.stream.write(" ["),this.stream.write(this.endline(e,t,n)),t.state=i.InsideTag,a=0,o=(s=e.children).length;a<o;a++)r=s[a],this.writeChildNode(r,t,n+1);t.state=i.CloseTag,this.stream.write("]")}return t.state=i.CloseTag,this.stream.write(t.spaceBeforeSlash+">"),this.stream.write(this.endline(e,t,n)),t.state=i.None,this.closeNode(e,t,n)}element(e,n,r){var o,s,l,u,c,d,h,p,f,g,m,v,y,b;if(r||(r=0),this.openNode(e,n,r),n.state=i.OpenTag,f=this.indent(e,n,r)+"<"+e.name,n.pretty&&n.width>0)for(p in d=f.length,m=e.attribs)a.call(m,p)&&(o=m[p],d+(g=this.attribute(o,n,r)).length>n.width?(b=this.indent(e,n,r+1)+g,f+=this.endline(e,n,r)+b,d=b.length):(f+=b=" "+g,d+=b.length));else for(p in v=e.attribs)a.call(v,p)&&(o=v[p],f+=this.attribute(o,n,r));if(this.stream.write(f),u=0===(l=e.children.length)?null:e.children[0],0===l||e.children.every(function(e){return(e.type===t.Text||e.type===t.Raw||e.type===t.CData)&&""===e.value}))n.allowEmpty?(this.stream.write(">"),n.state=i.CloseTag,this.stream.write("</"+e.name+">")):(n.state=i.CloseTag,this.stream.write(n.spaceBeforeSlash+"/>"));else if(!n.pretty||1!==l||u.type!==t.Text&&u.type!==t.Raw&&u.type!==t.CData||null==u.value){for(this.stream.write(">"+this.endline(e,n,r)),n.state=i.InsideTag,c=0,h=(y=e.children).length;c<h;c++)s=y[c],this.writeChildNode(s,n,r+1);n.state=i.CloseTag,this.stream.write(this.indent(e,n,r)+"</"+e.name+">")}else this.stream.write(">"),n.state=i.InsideTag,n.suppressPrettyCount++,this.writeChildNode(u,n,r+1),n.suppressPrettyCount--,n.state=i.CloseTag,this.stream.write("</"+e.name+">");return this.stream.write(this.endline(e,n,r)),n.state=i.None,this.closeNode(e,n,r)}processingInstruction(e,t,n){return this.stream.write(super.processingInstruction(e,t,n))}raw(e,t,n){return this.stream.write(super.raw(e,t,n))}text(e,t,n){return this.stream.write(super.text(e,t,n))}dtdAttList(e,t,n){return this.stream.write(super.dtdAttList(e,t,n))}dtdElement(e,t,n){return this.stream.write(super.dtdElement(e,t,n))}dtdEntity(e,t,n){return this.stream.write(super.dtdEntity(e,t,n))}dtdNotation(e,t,n){return this.stream.write(super.dtdNotation(e,t,n))}}}).call(this)},function(e,t,n){
/*!
 * clipboard.js v2.0.11
 * https://clipboardjs.com/
 *
 * Licensed MIT © Zeno Rocha
 */
e.exports=function(){return t={686:function(e,t,n){"use strict";n.d(t,{default:function(){return m}});t=n(279);var i=n.n(t),r=(t=n(370),n.n(t)),a=(t=n(817),n.n(t));function o(e){try{return document.execCommand(e)}catch(e){return}}var s=function(e){return e=a()(e),o("cut"),e};function l(e,t){var n,i;n=e,i="rtl"===document.documentElement.getAttribute("dir"),(e=document.createElement("textarea")).style.fontSize="12pt",e.style.border="0",e.style.padding="0",e.style.margin="0",e.style.position="absolute",e.style[i?"right":"left"]="-9999px",i=window.pageYOffset||document.documentElement.scrollTop,e.style.top="".concat(i,"px"),e.setAttribute("readonly",""),e.value=n,e=e;return t.container.appendChild(e),t=a()(e),o("copy"),e.remove(),t}var u=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{container:document.body},n="";return"string"==typeof e?n=l(e,t):e instanceof HTMLInputElement&&!["text","search","url","tel","password"].includes(null==e?void 0:e.type)?n=l(e.value,t):(n=a()(e),o("copy")),n};function c(e){return(c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function d(e){return(d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function h(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function p(e,t){return(p=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function f(e){return(f=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function g(e,t){if(e="data-clipboard-".concat(e),t.hasAttribute(e))return t.getAttribute(e)}var m=function(){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&p(e,t)}(o,i());var e,t,n,a=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}();return function(){var n,i=f(e);return n=t?(n=f(this).constructor,Reflect.construct(i,arguments,n)):i.apply(this,arguments),i=this,!(n=n)||"object"!==d(n)&&"function"!=typeof n?function(e){if(void 0!==i)return i;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}():n}}(o);function o(e,t){var n;return function(e){if(!(e instanceof o))throw new TypeError("Cannot call a class as a function")}(this),(n=a.call(this)).resolveOptions(t),n.listenClick(e),n}return e=o,n=[{key:"copy",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{container:document.body};return u(e,t)}},{key:"cut",value:function(e){return s(e)}},{key:"isSupported",value:function(){var e="string"==typeof(e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:["copy","cut"])?[e]:e,t=!!document.queryCommandSupported;return e.forEach(function(e){t=t&&!!document.queryCommandSupported(e)}),t}}],(t=[{key:"resolveOptions",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};this.action="function"==typeof e.action?e.action:this.defaultAction,this.target="function"==typeof e.target?e.target:this.defaultTarget,this.text="function"==typeof e.text?e.text:this.defaultText,this.container="object"===d(e.container)?e.container:document.body}},{key:"listenClick",value:function(e){var t=this;this.listener=r()(e,"click",function(e){return t.onClick(e)})}},{key:"onClick",value:function(e){var t=e.delegateTarget||e.currentTarget,n=this.action(t)||"copy";e=function(){var e=void 0===(n=(i=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).action)?"copy":n,t=i.container,n=i.target,i=i.text;if("copy"!==e&&"cut"!==e)throw new Error('Invalid "action" value, use either "copy" or "cut"');if(void 0!==n){if(!n||"object"!==c(n)||1!==n.nodeType)throw new Error('Invalid "target" value, use a valid Element');if("copy"===e&&n.hasAttribute("disabled"))throw new Error('Invalid "target" attribute. Please use "readonly" instead of "disabled" attribute');if("cut"===e&&(n.hasAttribute("readonly")||n.hasAttribute("disabled")))throw new Error('Invalid "target" attribute. You can\'t cut text from elements with "readonly" or "disabled" attributes')}return i?u(i,{container:t}):n?"cut"===e?s(n):u(n,{container:t}):void 0}({action:n,container:this.container,target:this.target(t),text:this.text(t)});this.emit(e?"success":"error",{action:n,text:e,trigger:t,clearSelection:function(){t&&t.focus(),window.getSelection().removeAllRanges()}})}},{key:"defaultAction",value:function(e){return g("action",e)}},{key:"defaultTarget",value:function(e){if(e=g("target",e))return document.querySelector(e)}},{key:"defaultText",value:function(e){return g("text",e)}},{key:"destroy",value:function(){this.listener.destroy()}}])&&h(e.prototype,t),n&&h(e,n),o}()},828:function(e){var t;"undefined"==typeof Element||Element.prototype.matches||((t=Element.prototype).matches=t.matchesSelector||t.mozMatchesSelector||t.msMatchesSelector||t.oMatchesSelector||t.webkitMatchesSelector),e.exports=function(e,t){for(;e&&9!==e.nodeType;){if("function"==typeof e.matches&&e.matches(t))return e;e=e.parentNode}}},438:function(e,t,n){var i=n(828);function r(e,t,n,r,a){var o=function(e,t,n,r){return function(n){n.delegateTarget=i(n.target,t),n.delegateTarget&&r.call(e,n)}}.apply(this,arguments);return e.addEventListener(n,o,a),{destroy:function(){e.removeEventListener(n,o,a)}}}e.exports=function(e,t,n,i,a){return"function"==typeof e.addEventListener?r.apply(null,arguments):"function"==typeof n?r.bind(null,document).apply(null,arguments):("string"==typeof e&&(e=document.querySelectorAll(e)),Array.prototype.map.call(e,function(e){return r(e,t,n,i,a)}))}},879:function(e,t){t.node=function(e){return void 0!==e&&e instanceof HTMLElement&&1===e.nodeType},t.nodeList=function(e){var n=Object.prototype.toString.call(e);return void 0!==e&&("[object NodeList]"===n||"[object HTMLCollection]"===n)&&"length"in e&&(0===e.length||t.node(e[0]))},t.string=function(e){return"string"==typeof e||e instanceof String},t.fn=function(e){return"[object Function]"===Object.prototype.toString.call(e)}},370:function(e,t,n){var i=n(879),r=n(438);e.exports=function(e,t,n){if(!e&&!t&&!n)throw new Error("Missing required arguments");if(!i.string(t))throw new TypeError("Second argument must be a String");if(!i.fn(n))throw new TypeError("Third argument must be a Function");if(i.node(e))return u=t,c=n,(l=e).addEventListener(u,c),{destroy:function(){l.removeEventListener(u,c)}};if(i.nodeList(e))return a=e,o=t,s=n,Array.prototype.forEach.call(a,function(e){e.addEventListener(o,s)}),{destroy:function(){Array.prototype.forEach.call(a,function(e){e.removeEventListener(o,s)})}};if(i.string(e))return e=e,t=t,n=n,r(document.body,e,t,n);throw new TypeError("First argument must be a String, HTMLElement, HTMLCollection, or NodeList");var a,o,s,l,u,c}},817:function(e){e.exports=function(e){var t,n="SELECT"===e.nodeName?(e.focus(),e.value):"INPUT"===e.nodeName||"TEXTAREA"===e.nodeName?((t=e.hasAttribute("readonly"))||e.setAttribute("readonly",""),e.select(),e.setSelectionRange(0,e.value.length),t||e.removeAttribute("readonly"),e.value):(e.hasAttribute("contenteditable")&&e.focus(),n=window.getSelection(),(t=document.createRange()).selectNodeContents(e),n.removeAllRanges(),n.addRange(t),n.toString());return n}},279:function(e){function t(){}t.prototype={on:function(e,t,n){var i=this.e||(this.e={});return(i[e]||(i[e]=[])).push({fn:t,ctx:n}),this},once:function(e,t,n){var i=this;function r(){i.off(e,r),t.apply(n,arguments)}return r._=t,this.on(e,r,n)},emit:function(e){for(var t=[].slice.call(arguments,1),n=((this.e||(this.e={}))[e]||[]).slice(),i=0,r=n.length;i<r;i++)n[i].fn.apply(n[i].ctx,t);return this},off:function(e,t){var n=this.e||(this.e={}),i=n[e],r=[];if(i&&t)for(var a=0,o=i.length;a<o;a++)i[a].fn!==t&&i[a].fn._!==t&&r.push(i[a]);return r.length?n[e]=r:delete n[e],this}},e.exports=t,e.exports.TinyEmitter=t}},n={},e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,{a:n}),n},e.d=function(t,n){for(var i in n)e.o(n,i)&&!e.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:n[i]})},e.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},e(686).default;function e(i){if(n[i])return n[i].exports;var r=n[i]={exports:{}};return t[i](r,r.exports,e),r.exports}var t,n}()},function(e,t){e.exports='<script type="text/ng-template" ng-app="org.ekstep.viewECML-1.0" ng-controller="ECMLbrowser as $ctrl" id="partials_org.ekstep.ECMLbrowser.html">\n<style>\n.ECMLbrowser_content {\n    margin-top: 20px;    \n    height: 420px;\n}\n</style>\n<div class="ui large modal active" style="top: 10% !important">\n    <div class="header">\n        <div class="ui grid">\n            <div class="fourteen column row">\n                <div class="left floated three wide column">\n                    <i class="file code outline icon"></i>\n                    <label>ECML</label>\n                </div>\n                <div>\n                    <span class="right floated column"><i class="copy link icon" ng-click="$ctrl.copyToClipboard(\'hiddenXmlBody\')"></i></span>\n                    <span class="right floated column"><i class="remove link icon" ng-click="$ctrl.closeWindow()"></i></span>\n                </div>\n            </div>\n        </div>\n    </div>\n    <div class="content">\n        <div class="ui grid ECMLbrowser_content">\n            <pre class="line-numbers language-markup" style="width:100%;"><code class="language-markup" id="xmlBody">{{$ctrl.contentBody}}</code></pre>\n        </div>\n        <div id="hiddenXmlBody" style="display: none;">{{$ctrl.contentBody}}</div>\n    </div>\n</div>\n<\/script>\n\n'},function(e,t){org.ekstep.pluginframework.pluginManager.registerPlugin({id:"org.ekstep.utils",ver:"1.0",author:"HarishKumar Gangula",title:"Utils Plugin",description:"This plugin is used to add utilitites",publishedDate:"",editor:{main:"editor/plugin.js",menu:[{id:"copy",category:"context",type:"icon",toolTip:"copy",title:"copy",iconClass:"copy icon",state:"HIDE",onclick:{id:"copy:copyItem",data:{}}},{id:"paste",category:"context",type:"icon",toolTip:"paste",title:"paste",iconClass:"paste icon",state:"HIDE",onclick:{id:"paste:pasteItem",data:{}}},{id:"delete",category:"context",type:"icon",toolTip:"Delete",title:"Delete",iconClass:"trash outline icon",state:"HIDE",onclick:{id:"delete:invoke",data:{}}},{id:"reorder",category:"context",type:"icon",toolTip:"Arrange",title:"Arrange",iconClass:"icon-arrange icon",state:"HIDE",submenu:[{id:"bringforward",category:"context",type:"icon",toolTip:"Bring forward",title:"Bring forward",iconClass:"icon-bringforward icon",onclick:{id:"reorder:bringforward",data:{}}},{id:"bringfront",category:"context",type:"icon",toolTip:"Bring to front",title:"Bring to front",iconClass:"icon-bringfront icon",onclick:{id:"reorder:bringfront",data:{}}},{id:"sendbackward",category:"context",type:"icon",toolTip:"Send backward",title:"Send backward",iconClass:"icon-sendbackward icon",onclick:{id:"reorder:sendbackward",data:{}}},{id:"sendback",category:"context",type:"icon",toolTip:"Send to back",title:"Send to back",iconClass:"icon-sendback icon",onclick:{id:"reorder:sendback",data:{}}}]}]}},org.ekstep.contenteditor.basePlugin.extend({type:"utils",picker:void 0,clipboard:void 0,activeGroup:void 0,initialize:function(){ecEditor.addEventListener("reorder:bringforward",this.bringforward,this),ecEditor.addEventListener("reorder:bringfront",this.bringfront,this),ecEditor.addEventListener("reorder:sendbackward",this.sendbackward,this),ecEditor.addEventListener("reorder:sendback",this.sendback,this),ecEditor.addEventListener("copy:copyItem",this.copyItem,this),ecEditor.addEventListener("paste:pasteItem",this.pasteItem,this),ecEditor.addEventListener("delete:invoke",this.deleteObject,this),ecEditor.addEventListener("object:selected",this.objectSelected,this),ecEditor.addEventListener("object:unselected",this.objectUnSelected,this)},bringfront:function(e,t){ecEditor.getCanvas().bringToFront(ecEditor.getEditorObject()),ecEditor.render(),ecEditor.dispatchEvent("object:modified",{id:ecEditor.getEditorObject().id})},sendback:function(e,t){ecEditor.getCanvas().sendToBack(ecEditor.getEditorObject()),ecEditor.render(),ecEditor.dispatchEvent("object:modified",{id:ecEditor.getEditorObject().id})},bringforward:function(e,t){ecEditor.getCanvas().bringForward(ecEditor.getEditorObject()),ecEditor.render(),ecEditor.dispatchEvent("object:modified",{id:ecEditor.getEditorObject().id})},sendbackward:function(e,t){ecEditor.getCanvas().sendBackwards(ecEditor.getEditorObject()),ecEditor.render(),ecEditor.dispatchEvent("object:modified",{id:ecEditor.getEditorObject().id})},copyItem:function(){this.clipboard=_.cloneDeep(ecEditor.getCurrentObject()?ecEditor.getCurrentObject():ecEditor.getCurrentGroup()),this.activeGroup=ecEditor.getCanvas().getActiveGroup()&&ecEditor.getCanvas().getActiveGroup().getObjects(),this.clipboard&&ecEditor.updateContextMenu({id:"paste",state:"SHOW",data:{}})},pasteItem:function(){var e=this;this.clipboard&&(_.isArray(this.clipboard)?(ecEditor.getCanvas().discardActiveGroup(),this.clipboard.forEach(function(t,n){t.editorObj.top=e.activeGroup[n].top+10,t.editorObj.left=e.activeGroup[n].left+10,ecEditor.cloneInstance(t)})):ecEditor.cloneInstance(this.clipboard),this.clipboard=void 0,ecEditor.updateContextMenu({id:"paste",state:"HIDE",data:{}}))},deleteObject:function(e,t){var n=ecEditor.getEditorGroup(),i=ecEditor.getEditorObject(),r=this;n?(ecEditor.getCanvas().discardActiveGroup(),n.getObjects().forEach(function(e){r.remove(e)})):i&&r.remove(i)},remove:function(e){ecEditor.dispatchEvent("delete:invoked",{editorObj:ecEditor.getPluginInstance(e.id).attributes}),ecEditor.getCanvas().remove(e),ecEditor.dispatchEvent("stage:modified",{id:e.id})},objectSelected:function(e,t){ecEditor.updateContextMenus([{id:"reorder",state:"SHOW",data:{}},{id:"copy",state:"SHOW",data:{}},{id:"delete",state:"SHOW",data:{}}])},objectUnSelected:function(e,t){ecEditor.updateContextMenus([{id:"reorder",state:"HIDE",data:{}},{id:"copy",state:"HIDE",data:{}},{id:"delete",state:"HIDE",data:{}}])}}))},function(e,t,n){var i,r,a,o={useajax:!1,regexobject:{headline:/^(\#{1,6})([^\#\n]+)$/m,code:/\s\`\`\`\n?([^`]+)\`\`\`/g,hr:/^(?:([\*\-_] ?)+)\1\1$/gm,lists:/^((\s*((\*|\-)|\d(\.|\))) [^\n]+)\n)+/gm,bolditalic:/(?:([\*_~]{1,3}))([^\*_~\n]+[^\*_~\s])\1/g,links:/!?\[([^\]<>]+)\]\(([^ \)<>]+)( "[^\(\)\"]+")?\)/g,reflinks:/\[([^\]]+)\]\[([^\]]+)\]/g,smlinks:/\@([a-z0-9]{3,})\@(t|gh|fb|gp|adn)/gi,mail:/<(([a-z0-9_\-\.])+\@([a-z0-9_\-\.])+\.([a-z]{2,7}))>/gim,tables:/\n(([^|\n]+ *\| *)+([^|\n]+\n))((:?\-+:?\|)+(:?\-+:?)*\n)((([^|\n]+ *\| *)+([^|\n]+)\n)+)/g,include:/[\[<]include (\S+) from (https?:\/\/[a-z0-9\.\-]+\.[a-z]{2,9}[a-z0-9\.\-\?\&\/]+)[\]>]/gi,url:/<([a-zA-Z0-9@:%_\+.~#?&\/=]{2,256}\.[a-z]{2,4}\b(\/[\-a-zA-Z0-9@:%_\+.~#?&\/\/=]*)?)>/g,url2:/[ \t\n]([a-zA-Z]{2,16}:\/\/[a-zA-Z0-9@:%_\+.~#?&=]{2,256}.[a-z]{2,4}\b(\/[\-a-zA-Z0-9@:%_\+.~#?&\/\/=]*)?)[ \t\n]/g},codeblocks:{},parse:function(e,t){"use strict";var n,i,r,a,s,l,u,c,d,h,p,f=0,g=[],m=0,v=0,y=0,b="";for(e="\n"+e+"\n",!0!==t&&(o.regexobject.lists=/^((\s*(\*|\d\.) [^\n]+)\n)+/gm),e=e.replace("$&","&#x0024&amp;");null!==(p=o.regexobject.code.exec(e));)b=o.crc32(p[0]),o.codeblocks[b]="<code>\n"+o.htmlEncode(p[1]).replace(/\n/gm,"<br/>").replace(/\ /gm,"&nbsp;")+"</code>\n",e=e.replace(p[0]," §§§"+b+"§§§ ");for(;null!==(p=o.regexobject.headline.exec(e));)d=p[1].length,e=e.replace(p[0],"<h"+d+">"+p[2]+"</h"+d+">\n");for(;null!==(p=o.regexobject.lists.exec(e));){for(m=0,h="*"===p[0].trim().substr(0,1)||"-"===p[0].trim().substr(0,1)?"<ul>":"<ol>",l=p[0].split("\n"),u=[],i=0,s=!1,v=0;v<l.length;v++)if(null!==(n=/^((\s*)((\*|\-)|\d(\.|\))) ([^\n]+))/.exec(l[v]))){for(void 0===n[2]||0===n[2].length?f=0:(!1===s&&(s=n[2].replace(/\t/,"    ").length),f=Math.round(n[2].replace(/\t/,"    ").length/s));i>f;)h+=u.pop(),i--,m--;for(;f>i;)"*"===n[0].trim().substr(0,1)||"-"===n[0].trim().substr(0,1)?(h+="<ul>",u.push("</ul>")):(h+="<ol>",u.push("</ol>")),i++,m++;h+="<li>"+n[6]+"</li>\n"}for(;m>0;)h+="</ul>",m--;h+="*"===p[0].trim().substr(0,1)||"-"===p[0].trim().substr(0,1)?"</ul>":"</ol>",e=e.replace(p[0],h+"\n")}for(;null!==(p=o.regexobject.tables.exec(e));){for(h="<table><tr>",l=p[1].split("|"),a=p[4].split("|"),v=0;v<l.length;v++)a.length<=v?a.push(0):":"===a[v].trimRight().slice(-1)&&!0!==t?":"===a[v][0]?a[v]=3:a[v]=2:!0!==t&&":"===a[v][0]?a[v]=1:a[v]=0;for(r=["<th>",'<th align="left">','<th align="right">','<th align="center">'],v=0;v<l.length;v++)h+=r[a[v]]+l[v].trim()+"</th>";for(h+="</tr>",r=["<td>",'<td align="left">','<td align="right">','<td align="center">'],u=p[7].split("\n"),v=0;v<u.length;v++)if(0!==(c=u[v].split("|"))[0].length){for(;a.length<c.length;)a.push(0);for(h+="<tr>",y=0;y<c.length;y++)h+=r[a[y]]+c[y].trim()+"</td>";h+="</tr>\n"}h+="</table>",e=e.replace(p[0],h)}for(v=0;3>v;v++)for(;null!==(p=o.regexobject.bolditalic.exec(e));)if(h=[],"~~"===p[1])e=e.replace(p[0],"<del>"+p[2]+"</del>");else{switch(p[1].length){case 1:h=["<i>","</i>"];break;case 2:h=["<b>","</b>"];break;case 3:h=["<i><b>","</b></i>"]}e=e.replace(p[0],h[0]+p[2]+h[1])}for(;null!==(p=o.regexobject.links.exec(e));)e="!"===p[0].substr(0,1)?e.replace(p[0],'<img src="'+p[2]+'" alt="'+p[1]+'" title="'+p[1]+'" />\n'):e.replace(p[0],"<a "+o.mmdCSSclass(p[2],t)+'href="'+p[2]+'">'+p[1]+"</a>\n");for(;null!==(p=o.regexobject.mail.exec(e));)e=e.replace(p[0],'<a href="mailto:'+p[1]+'">'+p[1]+"</a>");for(;null!==(p=o.regexobject.url.exec(e));)-1===(h=p[1]).indexOf("://")&&(h="http://"+h),e=e.replace(p[0],"<a "+o.mmdCSSclass(h,t)+'href="'+h+'">'+h.replace(/(https:\/\/|http:\/\/|mailto:|ftp:\/\/)/gim,"")+"</a>");for(;null!==(p=o.regexobject.reflinks.exec(e));)null!==(l=(u=new RegExp("\\["+p[2]+"\\]: ?([^ \n]+)","gi")).exec(e))&&(e=e.replace(p[0],"<a "+o.mmdCSSclass(l[1],t)+'href="'+l[1]+'">'+p[1]+"</a>"),g.push(l[0]));for(v=0;v<g.length;v++)e=e.replace(g[v],"");for(;null!==(p=o.regexobject.smlinks.exec(e));){switch(p[2]){case"t":h="https://twitter.com/"+p[1];break;case"gh":h="https://github.com/"+p[1];break;case"fb":h="https://www.facebook.com/"+p[1];break;case"gp":h="https://plus.google.com/+"+p[1];break;case"adn":h="https://alpha.app.net/"+p[1]}e=e.replace(p[0],"<a "+o.mmdCSSclass(h,t)+'href="'+h+'">'+p[1]+"</a>")}for(;null!==(p=o.regexobject.url2.exec(e));)h=p[1],e=e.replace(p[0],"<a "+o.mmdCSSclass(h,t)+'href="'+h+'">'+h+"</a>");for(;null!==(p=o.regexobject.hr.exec(e));)e=e.replace(p[0],"\n<hr/>\n");if(!1!==o.useajax&&!0!==t)for(;null!==(p=o.regexobject.include.exec(e));)if(l=p[2].replace(/[\.\:\/]+/gm,""),u="",document.getElementById(l)?u=document.getElementById(l).innerHTML.trim():o.ajax(p[2]),"csv"===p[1]&&""!==u){for((c={";":[],"\t":[],",":[],"|":[]})[0]=[";","\t",",","|"],u=u.split("\n"),y=0;y<c[0].length;y++)for(v=0;v<u.length;v++)v>0&&!1!==c[c[0][y]]&&(c[c[0][y]][v]!==c[c[0][y]][v-1]||1===c[c[0][y]][v])&&(c[c[0][y]]=!1);if(!1!==c[";"]||!1!==c["\t"]||!1!==c[","]||!1!==c["|"]){for(!1!==c[";"]?c=";":c["\t"]?c="\t":c[","]?c=",":c["|"]&&(c="|"),h="<table>",v=0;v<u.length;v++){for(l=u[v].split(c),h+="<tr>",y=0;y<l.length;y++)h+="<td>"+o.htmlEncode(l[y])+"</td>";h+="</tr>"}h+="</table>",e=e.replace(p[0],h)}else e=e.replace(p[0],"<code>"+u.join("\n")+"</code>")}else e=e.replace(p[0],"");for(var _ in e=(e=e.replace(/ {2,}[\n]{1,}/gim,"<br/>")).replace(/[\n]{2,}/gim,"<br/><br/>"),o.codeblocks)o.codeblocks.hasOwnProperty(_)&&(e=e.replace("§§§"+_+"§§§",o.codeblocks[_]));return e.replace("&#x0024&amp;","$&")},ajax:function(e){"use strict";var t;if(document.getElementById(e.replace(/[\.\:\/]+/gm,"")))return!1;if(window.ActiveXObject)try{t=new ActiveXObject("Microsoft.XMLHTTP")}catch(e){return t=null,e}else t=new XMLHttpRequest;t.onreadystatechange=function(){if(4===t.readyState){var n=document.createElement("code");n.innerHTML=t.responseText,n.id=e.replace(/[\.\:\/]+/gm,""),n.style.display="none",document.getElementsByTagName("body")[0].appendChild(n),o.useajax()}},t.open("GET",e,!0),t.setRequestHeader("Content-type","application/x-www-form-urlencoded"),t.send()},crc32:function(e){"use strict";var t,n,i=0,r=["00000000","77073096","EE0E612C","990951BA","076DC419","706AF48F","E963A535","9E6495A3","0EDB8832","79DCB8A4","E0D5E91E","97D2D988","09B64C2B","7EB17CBD","E7B82D07","90BF1D91","1DB71064","6AB020F2","F3B97148","84BE41DE","1ADAD47D","6DDDE4EB","F4D4B551","83D385C7","136C9856","646BA8C0","FD62F97A","8A65C9EC","14015C4F","63066CD9","FA0F3D63","8D080DF5","3B6E20C8","4C69105E","D56041E4","A2677172","3C03E4D1","4B04D447","D20D85FD","A50AB56B","35B5A8FA","42B2986C","DBBBC9D6","ACBCF940","32D86CE3","45DF5C75","DCD60DCF","ABD13D59","26D930AC","51DE003A","C8D75180","BFD06116","21B4F4B5","56B3C423","CFBA9599","B8BDA50F","2802B89E","5F058808","C60CD9B2","B10BE924","2F6F7C87","58684C11","C1611DAB","B6662D3D","76DC4190","01DB7106","98D220BC","EFD5102A","71B18589","06B6B51F","9FBFE4A5","E8B8D433","7807C9A2","0F00F934","9609A88E","E10E9818","7F6A0DBB","086D3D2D","91646C97","E6635C01","6B6B51F4","1C6C6162","856530D8","F262004E","6C0695ED","1B01A57B","8208F4C1","F50FC457","65B0D9C6","12B7E950","8BBEB8EA","FCB9887C","62DD1DDF","15DA2D49","8CD37CF3","FBD44C65","4DB26158","3AB551CE","A3BC0074","D4BB30E2","4ADFA541","3DD895D7","A4D1C46D","D3D6F4FB","4369E96A","346ED9FC","AD678846","DA60B8D0","44042D73","33031DE5","AA0A4C5F","DD0D7CC9","5005713C","270241AA","BE0B1010","C90C2086","5768B525","206F85B3","B966D409","CE61E49F","5EDEF90E","29D9C998","B0D09822","C7D7A8B4","59B33D17","2EB40D81","B7BD5C3B","C0BA6CAD","EDB88320","9ABFB3B6","03B6E20C","74B1D29A","EAD54739","9DD277AF","04DB2615","73DC1683","E3630B12","94643B84","0D6D6A3E","7A6A5AA8","E40ECF0B","9309FF9D","0A00AE27","7D079EB1","F00F9344","8708A3D2","1E01F268","6906C2FE","F762575D","806567CB","196C3671","6E6B06E7","FED41B76","89D32BE0","10DA7A5A","67DD4ACC","F9B9DF6F","8EBEEFF9","17B7BE43","60B08ED5","D6D6A3E8","A1D1937E","38D8C2C4","4FDFF252","D1BB67F1","A6BC5767","3FB506DD","48B2364B","D80D2BDA","AF0A1B4C","36034AF6","41047A60","DF60EFC3","A867DF55","316E8EEF","4669BE79","CB61B38C","BC66831A","256FD2A0","5268E236","CC0C7795","BB0B4703","220216B9","5505262F","C5BA3BBE","B2BD0B28","2BB45A92","5CB36A04","C2D7FFA7","B5D0CF31","2CD99E8B","5BDEAE1D","9B64C2B0","EC63F226","756AA39C","026D930A","9C0906A9","EB0E363F","72076785","05005713","95BF4A82","E2B87A14","7BB12BAE","0CB61B38","92D28E9B","E5D5BE0D","7CDCEFB7","0BDBDF21","86D3D2D4","F1D4E242","68DDB3F8","1FDA836E","81BE16CD","F6B9265B","6FB077E1","18B74777","88085AE6","FF0F6A70","66063BCA","11010B5C","8F659EFF","F862AE69","616BFFD3","166CCF45","A00AE278","D70DD2EE","4E048354","3903B3C2","A7672661","D06016F7","4969474D","3E6E77DB","AED16A4A","D9D65ADC","40DF0B66","37D83BF0","A9BCAE53","DEBB9EC5","47B2CF7F","30B5FFE9","BDBDF21C","CABAC28A","53B39330","24B4A3A6","BAD03605","CDD70693","54DE5729","23D967BF","B3667A2E","C4614AB8","5D681B02","2A6F2B94","B40BBE37","C30C8EA1","5A05DF1B","2D02EF8D"];for(n=e.length,i^=-1,t=0;n>t;t++)i=i>>>8^"0x"+r[255&(i^e.charCodeAt(t))];return-1^i},countingChars:function(e,t){"use strict";return"object"==typeof(e=e.split(t))?e.length-1:0},htmlEncode:function(e){"use strict";var t=document.createElement("div");return t.appendChild(document.createTextNode(e)),e=t.innerHTML,t=void 0,e},mmdCSSclass:function(e,t){"use strict";var n;return-1!==e.indexOf("/")&&!0!==t?'class="mmd_'+(n=0===(n=e.split("/"))[1].length?n[2].split("."):n[0].split("."))[n.length-2].replace(/[^\w\d]/g,"")+n[n.length-1]+'" ':""}};!function(n,s){"use strict";r=[],void 0===(a="function"==typeof(i=function(){return o})?i.apply(t,r):i)||(e.exports=a)}(),org.ekstep.pluginframework.pluginManager.registerPlugin({id:"org.ekstep.help",ver:"1.0",displayName:"Help",author:"Sunil A S",title:"Help Plugin",description:"",publishedDate:"",editor:{main:"editor/plugin.js",dependencies:[{type:"js",src:"editor/libs/micromarkdown.min.js"}],sidebarMenu:[{id:"help",type:"icon",toolTip:"Help",title:"Help",iconClass:"help icon",templateURL:"editor/partials/sidebarHelpTemplate.html"}]}},org.ekstep.contenteditor.basePlugin.extend({type:"help",initialize:function(){org.ekstep.contenteditor.api.addEventListener("sidebar:help",this.showHelpTab,this),org.ekstep.contenteditor.api.addEventListener("object:selected",this.showHelpTab,this),org.ekstep.contenteditor.api.addEventListener("object:unselected",this.showHelpTab,this)},showHelpTab:function(){org.ekstep.contenteditor.api.getCurrentObject()?org.ekstep.contenteditor.api.getCurrentObject().getHelp(function(e){org.ekstep.contenteditor.api.jQuery("#pluginHelpContent").html(o.parse(e))}):org.ekstep.contenteditor.api.getCurrentStage().getHelp(function(e){org.ekstep.contenteditor.api.jQuery("#pluginHelpContent").html(o.parse(e))})}}))},function(e,t){org.ekstep.pluginframework.pluginManager.registerPlugin({id:"org.ekstep.editorstate",ver:"1.0",shortId:"editorstate",author:"Sunil A S",title:"Editor State",description:"",publishedDate:"",editor:{main:"editor/plugin.js"}},org.ekstep.contenteditor.basePlugin.extend({extPluginsList:[],state:{plugin:{},stage:{},sidebar:{}},initialize:function(){var e=this;ecEditor.addEventListener("content:before:save",function(){ecEditor.dispatchEvent(e.manifest.id+":state",e.getEditorState(),e)},this),ecEditor.addEventListener("content:load:complete",this.setEditorState,this),ecEditor.addEventListener("plugin:load",function(t,n){e.extPluginsList.push({plugin:n.plugin,version:n.version})})},getEditorState:function(){return this.state.plugin={noOfExtPlugins:this.extPluginsList.length,extPlugins:this.extPluginsList},this.state.stage={noOfStages:ecEditor.getAllStages().length,currentStage:ecEditor.getCurrentStage().id,selectedPluginObject:ecEditor.getCurrentObject().id||void 0},this.state.sidebar={selectedMenu:ecEditor.getCurrentSidebarMenu()},this.state},setEditorState:function(){this.setStageState(),this.setPluginState(),this.setSidebarState()},_getStateFromService:function(){if(ecEditor.getService(ServiceConstants.CONTENT_SERVICE).getContentMeta(ecEditor.getContext("contentId")).editorState)return JSON.parse(ecEditor.getService(ServiceConstants.CONTENT_SERVICE).getContentMeta(ecEditor.getContext("contentId")).editorState)},setStageState:function(){var e=this._getStateFromService();e&&e.stage?(ecEditor.dispatchEvent("stage:select",{stageId:e.stage.currentStage}),e.stage.selectedPluginObject&&_.forEach(ecEditor.getStage(e.stage.currentStage).children,function(t){t.id===e.stage.selectedPluginObject&&ecEditor.getCurrentStage().canvas.setActiveObject(t.editorObj)})):ecEditor.dispatchEvent("stage:select",{stageId:ecEditor.getAllStages()[0].id})},setPluginState:function(){var e=this._getStateFromService();e&&e.plugin&&e.plugin.extPlugins.forEach(function(e){ecEditor.loadPlugin(e.plugin,e.version)})},setSidebarState:function(){var e=this._getStateFromService();e&&e.sidebar?ecEditor.showSidebarMenu(e.sidebar.selectedMenu):ecEditor.showSidebarMenu("settings")}}))},function(e,t){org.ekstep.pluginframework.pluginManager.registerPlugin({id:"org.ekstep.contenteditorfunctions",ver:"1.2",author:"Sunil A S",description:"",publishedDate:"",editor:{main:"editor/plugin.js",dependencies:[{type:"plugin",plugin:"org.ekstep.toaster",ver:"1.0"}]}},org.ekstep.contenteditor.basePlugin.extend({editorState:void 0,telemetryService:org.ekstep.contenteditor.api.getService(ServiceConstants.TELEMETRY_SERVICE),lastSaved:void 0,popUpValues:{},isSaveNotificationPopupOpened:!1,contentService:org.ekstep.contenteditor.api.getService(ServiceConstants.CONTENT_SERVICE),popupService:org.ekstep.contenteditor.api.getService(ServiceConstants.POPUP_SERVICE),conflictdialogOptions:{showPlatformPreview:!1},initialize:function(){var e=this;ecEditor.addEventListener("org.ekstep.editorstate:state",this.setEditorState,this),ecEditor.addEventListener("org.ekstep.contenteditor:save",this.resolveSaveFn,this),ecEditor.addEventListener("org.ekstep.contenteditor:save:meta",this.saveMetadata,this),ecEditor.addEventListener("org.ekstep.contenteditor:preview",function(t,n){e.previewContent(n.fromBeginning)},this),ecEditor.addEventListener("org.ekstep.contenteditor:save:force",this.saveBrowserContent,this),ecEditor.addEventListener("org.ekstep.contenteditor:review",this.reviewContent,this),ecEditor.addEventListener("org.ekstep.contenteditor:publish",this.publishContent,this),ecEditor.addEventListener("org.ekstep.contenteditor:reject",this.rejectContent,this),ecEditor.addEventListener("org.ekstep.contenteditor:acceptFlag",this.acceptContentFlag,this),ecEditor.addEventListener("org.ekstep.contenteditor:discardFlag",this.discardContentFlag,this),ecEditor.addEventListener("org.ekstep.contenteditor:retire",this.retireContent,this),ecEditor.addEventListener("org.ekstep.contenteditor:unlistedPublish",this.unlistedPublishContent,this),ecEditor.addEventListener("org.ekstep.contenteditor:Unauthorized",this.unauthorizedToken,this)},unauthorizedToken:function(){this.popUpValues.headerMsg="Your session has timed out due to inactivity. Please login to resume!",this.popUpValues.popUpIcon="circle remove red",this.popUpValues.showCloseButton=!0,this.popUpValues.unauthorized="unauthorized"},setEditorState:function(e,t){t&&(this.editorState=t)},reviewContent:function(e,t){var n=ecEditor.getContext("contentId");ecEditor.getService(ServiceConstants.CONTENT_SERVICE).sendForReview({contentId:n,channel:ecEditor.getContext("channel")},function(e,n){n&&n.data&&"OK"==n.data.responseCode?ecEditor.dispatchEvent("org.ekstep.toaster:success",{title:"Content sent for review...",position:"topCenter",icon:"fa fa-check-circle"}):ecEditor.dispatchEvent("org.ekstep.toaster:error",{message:"Sending for review failed, please try again later...",position:"topCenter",icon:"fa fa-warning"}),t&&t(e,n)})},resolveSaveFn:function(e,t){switch(ecEditor.getService(ServiceConstants.CONTENT_SERVICE).getContentMeta(ecEditor.getContext("contentId")).mimeType){case"application/vnd.ekstep.ecml-archive":this.saveContent(e,t),this.conflictdialogOptions.showPlatformPreview=!0;break;case"application/vnd.ekstep.content-collection":this.saveCollectionContent(e,t);break;case"application/vnd.ekstep.html-archive":case"application/vnd.ekstep.h5p-archive":case"application/epub":case"video/mp4":case"application/pdf":case"video/x-youtube":case"video/webm":case"text/x-url":this.saveGenericEditorContent(e,t);break;default:t.callback&&t.callback("unable to resolve save call for the mimetype")}},saveGenericEditorContent:function(e,t){var n=ecEditor._.assign({savingPopup:!0,successPopup:!0,failPopup:!0},t);n.savingPopup&&this.saveNotification("saving"),this._patchContent(t,t.body,n)},saveContent:function(e,t){console.log("Save invoked:",e,t),(t=ecEditor._.assign({savingPopup:!0,successPopup:!0,failPopup:!0,callback:function(){}},t)).savingPopup&&this.saveNotification("saving"),e={};var n,i=(t.contentMeta&&(e=t.contentMeta),org.ekstep.pluginframework.eventManager.dispatchEvent("content:before:save"),org.ekstep.contenteditor.stageManager.toECML()),r=("function"==typeof org.ekstep.contenteditor.stageManager.updateStageIcons?e.stageIcons=JSON.stringify(org.ekstep.contenteditor.stageManager.updateStageIcons()):e.stageIcons=JSON.stringify(org.ekstep.contenteditor.stageManager.getStageIcons()),org.ekstep.contenteditor.stageManager.getSummary());r&&(e.totalQuestions=r.totalQuestions,e.totalScore=r.totalScore,n=ecEditor.getService(ServiceConstants.CONTENT_SERVICE).getContentMeta(ecEditor.getContext("contentId")),ecEditor._.isEqual(ecEditor._.map(r.questions,"identifier").sort(),ecEditor._.map(n.questions,"identifier").sort())||(e.questions=r.questions)),e.assets=ecEditor._.compact(org.ekstep.contenteditor.stageManager.assets),e.editorState=JSON.stringify(this.editorState),e.pragma=org.ekstep.contenteditor.stageManager.getPragma(),e.plugins=org.ekstep.contenteditor.stageManager.plugins_used,this._patchContent(e,i,t)},_patchContent:function(e,t,n){var i=this;e=e&&JSON.parse(angular.toJson(e)),this.patchContent(e,t,function(e,t){var r;e?t&&!ecEditor._.isUndefined(t.responseJSON)?"ERR_STALE_VERSION_KEY"==t.responseJSON.params.err?i.showConflictDialog(n):i.changePopupValues("error"):n&&n.failPopup&&(n.savingPopup||i.saveNotification(),i.changePopupValues("error")):t&&"OK"==t.data.responseCode&&("application/vnd.ekstep.content-collection"===ecEditor.getService(ServiceConstants.CONTENT_SERVICE).getContentMeta(ecEditor.getContext("contentId")).mimeType&&org.ekstep.services.stateService.state.dialCodeMap&&(r=_.get(org.ekstep.services.stateService.state.dialCodeMap,ecEditor.getContext("contentId")),_.isUndefined(r)||(i.dialcodeLink([{dialcode:r,identifier:ecEditor.getContext("contentId")}]),i.storeDialCodes(ecEditor.getContext("contentId"),r),_.unset(org.ekstep.services.stateService.state.dialCodeMap,ecEditor.getContext("contentId")))),n&&n.successPopup&&(n.savingPopup||i.saveNotification(),i.changePopupValues("success")),ecEditor.dispatchEvent("org.ekstep.contenteditor:after-save",{})),"function"==typeof n.callback&&n.callback(e,t)},n)},saveBrowserContent:function(e,t){var n=this;this.fetchPlatformContentVersionKey(function(i){n.resolveSaveFn(e,t)})},patchContent:function(e,t,n,i){var r=this;org.ekstep.contenteditor.migration&&org.ekstep.contenteditor.migration.isMigratedContent()?((e=e||{}).oldContentBody=org.ekstep.contenteditor.migration.getBackupContent(),r.showMigratedContentSaveDialog(function(a,o){o&&r.contentService.saveContent(org.ekstep.contenteditor.api.getContext("contentId"),e,t,n),a&&i&&i.callback("save action interrupted by user")})):r.contentService.saveContent(org.ekstep.contenteditor.api.getContext("contentId"),e,t,n)},saveMetadata:function(e,t){this._patchContent(t.contentMeta,void 0,t)},showMigratedContentSaveDialog:function(e){var t=this;this.popupService.open({template:ecEditor.resolvePluginResource(t.manifest.id,t.manifest.ver,"editor/partials/migratedContentSaveMsg.html"),controller:["$scope",function(n){n.saveContent=function(){org.ekstep.contenteditor.migration.clearMigrationFlag(),e(void 0,!0)},n.enableSaveBtn=function(){t.saveBtnEnabled=!0,e(!0,void 0)}}],showClose:!1,closeByDocument:!1,closeByEscape:!1})},saveNotification:function(e){var t=this,n={template:ecEditor.resolvePluginResource(t.manifest.id,t.manifest.ver,"editor/partials/saveMessage.html"),controller:["$scope",function(e){e.popUpValues=t.popUpValues,e.$on("ngDialog.opened",function(e,n){t.isSaveNotificationPopupOpened=!0}),e.unauthorizedUser=function(){"unauthorized"==this.popUpValues.unauthorized&&ecEditor.dispatchEvent("org.ekstep:sunbirdcommonheader:close:editor")}}],showClose:!1,closeByEscape:!1,closeByDocument:!1};console.log("config",n),this.changePopupValues(e),t.isSaveNotificationPopupOpened||this.popupService.open(n,function(){t.isSaveNotificationPopupOpened=!1})},changePopupValues:function(e){"success"===e?(this.popUpValues.headerMsg="Content Saved!",this.popUpValues.popUpIcon="circle check green",this.popUpValues.showCloseButton=!0,this.popUpValues.saveNotificationCloseButton="saveSuccessNotificationCloseButton"):"error"===e&&(this.popUpValues.headerMsg="Failed to save Content",this.popUpValues.popUpIcon="circle remove red",this.popUpValues.showCloseButton=!0,this.popUpValues.saveNotificationCloseButton="saveFailNotificationCloseButton"),"saving"===e&&(this.popUpValues.headerMsg="Saving content please wait...",this.popUpValues.showCloseButton=!1)},showConflictDialog:function(e){var t=this;this.popupService.open({template:ecEditor.resolvePluginResource(t.manifest.id,t.manifest.ver,"editor/partials/conflictDialog.html"),controller:["$scope",function(n){n.showPlatformPreview=!1,t.conflictdialogOptions.showPlatformPreview&&(n.showPlatformPreview=!0),n.previewPlatformContent=function(){t.previewPlatformContent()},n.saveBrowserContent=function(){t.saveBrowserContent(void 0,e),n.closeThisDialog()},n.previewContent=function(){t.previewContent()},n.refreshContent=function(){t.refreshContent()},n.firetelemetry=function(e,n){t.telemetryService.interact({id:"button",type:"click",subtype:"popup",target:n,pluginid:"org.ekstep.contenteditorfunctions",pluginver:"1.2",objectid:e.id,stage:ecEditor.getCurrentStage().id})},n.showAdvancedOption=!1}],className:"ngdialog-theme-plain header-conflict-dialog",showClose:!1,closeByDocument:!0,closeByEscape:!0})},previewContent:function(e){e=!!_.isUndefined(e),org.ekstep.pluginframework.eventManager.dispatchEvent("atpreview:show",{contentBody:org.ekstep.contenteditor.stageManager.toECML(),currentStage:e})},refreshContent:function(){location.reload()},previewPlatformContent:function(){this.fetchPlatformContentBody(function(e){org.ekstep.pluginframework.eventManager.dispatchEvent("atpreview:show",{contentBody:e,currentStage:!0})})},fetchPlatformContentVersionKey:function(e){org.ekstep.contenteditor.api.getService(ServiceConstants.CONTENT_SERVICE).getContentVersionKey(org.ekstep.contenteditor.api.getContext("contentId"),function(t,n){t&&alert("Failed to get updated version key. Please report an issue."),n.versionKey&&e(n)})},fetchPlatformContentBody:function(e){org.ekstep.contenteditor.api.getService(ServiceConstants.CONTENT_SERVICE).getContent(org.ekstep.contenteditor.api.getContext("contentId"),function(t,n){if(t&&alert("Failed to get updated content. Please report an issue."),n&&n.body)try{var i=JSON.parse(n.body);e(i)}catch(t){alert("Failed to parse body from platform. Please report an issue.")}})},publishContent:function(e,t){var n=ecEditor.getContext("contentId");ecEditor.getService(ServiceConstants.CONTENT_SERVICE).publishContent({contentId:n,channel:ecEditor.getContext("channel"),data:t},function(e,n){n&&n.data&&"OK"==n.data.responseCode?ecEditor.dispatchEvent("org.ekstep.toaster:success",{title:"Content published successfully!",position:"topCenter",icon:"fa fa-check-circle"}):ecEditor.dispatchEvent("org.ekstep.toaster:error",{message:"Unable to publish content, try again!",position:"topCenter",icon:"fa fa-warning"}),t.callback&&t.callback(e,n)})},rejectContent:function(e,t){ecEditor.getService(ServiceConstants.CONTENT_SERVICE).rejectContent({contentId:ecEditor.getContext("contentId"),channel:ecEditor.getContext("channel"),data:t},function(e,n){n&&n.data&&"OK"==n.data.responseCode?ecEditor.dispatchEvent("org.ekstep.toaster:success",{title:"Content rejected successfully!",position:"topCenter",icon:"fa fa-check-circle"}):ecEditor.dispatchEvent("org.ekstep.toaster:error",{message:"Unable to reject content, try again!",position:"topCenter",icon:"fa fa-warning"}),t.callback&&t.callback(e,n)})},acceptContentFlag:function(e,t){ecEditor.getService(ServiceConstants.CONTENT_SERVICE).acceptContentFlag({contentId:ecEditor.getContext("contentId")},function(e,n){n&&n.data&&"OK"==n.data.responseCode?ecEditor.dispatchEvent("org.ekstep.toaster:success",{title:"Content flag accepted successfully!",position:"topCenter",icon:"fa fa-check-circle"}):ecEditor.dispatchEvent("org.ekstep.toaster:error",{message:"Unable to accept content flag, try again!",position:"topCenter",icon:"fa fa-warning"}),t.callback&&t.callback(e,n)})},discardContentFlag:function(e,t){ecEditor.getService(ServiceConstants.CONTENT_SERVICE).discardContentFlag({contentId:ecEditor.getContext("contentId")},function(e,n){n&&n.data&&"OK"==n.data.responseCode?ecEditor.dispatchEvent("org.ekstep.toaster:success",{title:"Content flag discarded successfully!",position:"topCenter",icon:"fa fa-check-circle"}):ecEditor.dispatchEvent("org.ekstep.toaster:error",{message:"Unable to discard content flag, try again!",position:"topCenter",icon:"fa fa-warning"}),t.callback&&t.callback(e,n)})},retireContent:function(e,t){ecEditor.getService(ServiceConstants.CONTENT_SERVICE).retireContent({contentId:ecEditor.getContext("contentId")},function(e,n){n&&n.data&&"OK"==n.data.responseCode?ecEditor.dispatchEvent("org.ekstep.toaster:success",{title:"Content retired successfully!",position:"topCenter",icon:"fa fa-check-circle"}):ecEditor.dispatchEvent("org.ekstep.toaster:error",{message:"Unable to retire content, try again!",position:"topCenter",icon:"fa fa-warning"}),t.callback&&t.callback(e,n)})},saveCollectionContent:function(e,t){t=t||{};var n=this,i=[],r=[],a=ecEditor.getService(ServiceConstants.CONTENT_SERVICE).getContentMeta(ecEditor.getContext("contentId"));a&&a.versionKey&&org.ekstep.collectioneditor.cache.nodesModified[a.identifier]&&org.ekstep.collectioneditor.cache.nodesModified[a.identifier].metadata&&(org.ekstep.collectioneditor.cache.nodesModified[a.identifier].metadata.versionKey=a.versionKey);var o,s=(s=org.ekstep.collectioneditor.api.getService("collection").getCollectionHierarchy())&&JSON.parse(angular.toJson(s));if(console.log("contentBody",s),o=["name","contentType","mimeType"],ecEditor._.forIn(org.ekstep.collectioneditor.cache.nodesModified,function(e,t){o.forEach(function(n){(e.metadata.hasOwnProperty(n)&&e.metadata[n]?i:r).push(t)})}),this.lowlightNode(i),0<_.size(r))return t.showNotification&&ecEditor.dispatchEvent("org.ekstep.toaster:error",{message:"Please update the collection details before save",position:"topCenter",icon:"fa fa-warning"}),this.hightlightNode(r),t.callback&&t.callback("mandatory fields are missing in the data!"),!1;ecEditor.getService(ServiceConstants.CONTENT_SERVICE).saveCollectionHierarchy({body:s},function(e,i){i&&i.data&&"OK"==i.data.responseCode?(t.showNotification&&ecEditor.dispatchEvent("org.ekstep.toaster:success",{title:"Content saved successfully!",position:"topCenter",icon:"fa fa-check-circle"}),n.highlightNodeForInvalidDialCode(i,s.nodesModified),org.ekstep.collectioneditor.api.getService("collection").clearCache(),ecEditor._.forIn(i.data.result.identifiers,function(e,t){(t=ecEditor.getService(ServiceConstants.COLLECTION_SERVICE).getNodeById(t))&&(t.data.id=e)}),ecEditor.dispatchEvent("meta:after:save",{})):e&&401===i.status&&"Unauthorized"===i.statusText?t.showNotification&&ecEditor.dispatchEvent("org.ekstep.toaster:error",{message:"Your session has timed out due to inactivity. Please login to resume!",position:"topCenter",icon:"fa fa-warning"}):t.showNotification&&ecEditor.dispatchEvent("org.ekstep.toaster:error",{message:"Unable to save the content, try again!",position:"topCenter",icon:"fa fa-warning"}),t.callback&&t.callback(e,i)})},highlightNodeForInvalidDialCode:function(e,t){var n=this,i=[],r=(ecEditor._.forEach(org.ekstep.services.stateService.state.invaliddialCodeMap,function(t,i){_.has(e.data.result.identifiers,i)?(delete org.ekstep.services.stateService.state.invaliddialCodeMap[i],org.ekstep.services.stateService.setState("invaliddialCodeMap",e.data.result.identifiers[i],t),org.ekstep.services.collectionService.highlightNode(e.data.result.identifiers[i]),n.storeDialCodes(e.data.result.identifiers[i],t)):(n.storeDialCodes(i,t),org.ekstep.services.collectionService.highlightNode(i))}),ecEditor._.forEach(org.ekstep.services.stateService.state.dialCodeMap,function(t,r){_.has(e.data.result.identifiers,r)?(delete org.ekstep.services.stateService.state.dialCodeMap[r],org.ekstep.services.stateService.setState("dialCodeMap",e.data.result.identifiers[r],t),i.push({identifier:e.data.result.identifiers[r],dialcode:t}),org.ekstep.services.collectionService.lowLightNode(e.data.result.identifiers[r]),n.storeDialCodes(e.data.result.identifiers[r],t)):(i.push({identifier:r,dialcode:t}),org.ekstep.services.collectionService.lowLightNode(r),n.storeDialCodes(r,t))}),!1);ecEditor._.forIn(t,function(t){(!t.metadata.dialcodes&&null!==t.metadata.dialcodes||r)&&(t=_.find(i,function(t){return t.identifier===e.data.result.content_id}),_.isUndefined(t))||(r=!0)}),r&&n.dialcodeLink(i)},dialcodeLink:function(e){_.find(e,"dialcode"),_.isEmpty(e)?ecEditor._.isEmpty(org.ekstep.services.stateService.state.invaliddialCodeMap)||ecEditor.dispatchEvent("org.ekstep.toaster:warning",{title:"Unable to update some of the QR codes.",position:"topCenter",icon:"fa fa-warning"}):(e={request:{content:e}},ecEditor.getService("dialcode").dialcodeLink(ecEditor.getContext("contentId"),ecEditor.getContext("channel"),e,function(e,t){e?!ecEditor._.isUndefined(e.responseJSON)&&e.responseJSON.params&&"ERR_DIALCODE_LINK"==e.responseJSON.params.err?ecEditor.dispatchEvent("org.ekstep.toaster:error",{title:e.responseJSON.params.errmsg,position:"topCenter",icon:"fa fa-warning"}):ecEditor.dispatchEvent("org.ekstep.toaster:error",{title:"QR code(s) updating failed!",position:"topCenter",icon:"fa fa-warning"}):ecEditor._.isEmpty(org.ekstep.services.stateService.state.dialCodeMap)||ecEditor._.isEmpty(org.ekstep.services.stateService.state.invaliddialCodeMap)?ecEditor.dispatchEvent("org.ekstep.toaster:success",{title:"QR code(s) updated successfully!",position:"topCenter",icon:"fa fa-check-circle"}):ecEditor.dispatchEvent("org.ekstep.toaster:warning",{title:"Unable to update some of the QR codes.",position:"topCenter",icon:"fa fa-warning"})}))},storeDialCodes:function(e,t){(e=ecEditor.getService(ServiceConstants.COLLECTION_SERVICE).getNodeById(e))&&e.data&&(e.data.metadata.dialcodes=t)},hightlightNode:function(e){_.forEach(_.omitBy(_.uniq(e),_.isEmpty),function(e){org.ekstep.services.collectionService.highlightNode(e)})},lowlightNode:function(e){_.forEach(_.omitBy(_.uniq(e),_.isEmpty),function(e){org.ekstep.services.collectionService.lowLightNode(e)})},unlistedPublishContent:function(e,t){var n=ecEditor.getContext("contentId");ecEditor.getService(ServiceConstants.CONTENT_SERVICE).unlistedPublishContent({contentId:n},function(e,n){n&&n.data&&"OK"==n.data.responseCode?ecEditor.dispatchEvent("org.ekstep.toaster:success",{title:"Content limited shared successfully!",position:"topCenter",icon:"fa fa-check-circle"}):ecEditor.dispatchEvent("org.ekstep.toaster:error",{message:"Unable to share content, try again!",position:"topCenter",icon:"fa fa-warning"}),t.callback&&t.callback(e,n)})}}))},function(e,t,n){org.ekstep.pluginframework.pluginManager.registerPlugin({id:"org.ekstep.keyboardshortcuts",ver:"1.0",author:"Akash Gupta",editor:{main:"editor/plugin.js",views:[{template:"./templates/shortcutspopup.html",controller:""}]}},org.ekstep.contenteditor.basePlugin.extend({type:"shortcuts",isPopupOpen:!1,events:{copyElem:"copy:copyItem",pasteElem:"paste:pasteItem",deleteElem:"delete:invoke",createStage:"stage:create",duplicateStage:"stage:duplicate",saveContent:"org.ekstep.contenteditor:save",selectStage:"stage:select",sendToBack:"reorder:sendback",sendToFront:"reorder:bringfront"},initialize:function(){var e=this,t=ecEditor.resolvePluginResource(e.manifest.id,e.manifest.ver,"editor/templates/shortcutspopup.html");ecEditor.getService("popup").loadNgModules(n(82),void 0,!0),ecEditor.registerKeyboardCommand("mod+c",function(t){t.preventDefault(),ecEditor.dispatchEvent(e.events.copyElem)}),ecEditor.registerKeyboardCommand("mod+v",function(t){t.preventDefault(),ecEditor.dispatchEvent(e.events.pasteElem),ecEditor.dispatchEvent("object:modified",{target:ecEditor.getEditorObject()})}),ecEditor.registerKeyboardCommand(["del","backspace"],function(t){t.preventDefault(),ecEditor.dispatchEvent(e.events.deleteElem),ecEditor.dispatchEvent("object:modified",{target:ecEditor.getEditorObject()})}),ecEditor.registerKeyboardCommand("ctrl+m",function(t){t.preventDefault(),ecEditor.dispatchEvent(e.events.createStage,{position:"afterCurrent"}),ecEditor.dispatchEvent("object:modified",{target:ecEditor.getEditorObject()})}),ecEditor.registerKeyboardCommand("mod+d",function(t){t.preventDefault(),ecEditor.dispatchEvent(e.events.duplicateStage,{stageId:org.ekstep.contenteditor.api.getCurrentStage().id}),ecEditor.dispatchEvent("object:modified",{target:ecEditor.getEditorObject()})}),ecEditor.registerKeyboardCommand("mod+x",function(t){t.preventDefault(),ecEditor.dispatchEvent(e.events.copyElem),ecEditor.dispatchEvent(e.events.deleteElem)}),ecEditor.registerKeyboardCommand("mod+a",function(e){e.preventDefault();var t=((e=org.ekstep.contenteditor.api.getCanvas()).deactivateAll(),e.getObjects().map(function(e){return e.set("active",!0)}));t=new fabric.Group(t,{originX:"left",originY:"top"}),e.setActiveGroup(t.setCoords()).renderAll()}),org.ekstep.contenteditor.api.getCanvas().on("object:moving",e.moveRichText),ecEditor.registerKeyboardCommand("mod+s",function(t){t.preventDefault(),ecEditor.dispatchEvent(e.events.saveContent)}),ecEditor.registerKeyboardCommand("mod+/",function(n){n.preventDefault(),e.isPopupOpen||ecEditor.getService("popup").open({templateUrl:t,controller:["$scope",function(t){t.$on("ngDialog.opened",function(t,n){e.isPopupOpen=!0})}],width:900,showClose:!0,closeByEscape:!1,closeByDocument:!1,className:"ngdialog-theme-default"},function(){e.isPopupOpen=!1})}),ecEditor.registerKeyboardCommand(["home","command+up"],function(t){t.preventDefault(),ecEditor.dispatchEvent(e.events.selectStage,{prevStageId:org.ekstep.contenteditor.api.getCurrentStage().id,stageId:org.ekstep.contenteditor.api.getAllStages()[0].id})}),ecEditor.registerKeyboardCommand(["end","command+down"],function(t){t.preventDefault(),ecEditor.dispatchEvent(e.events.selectStage,{prevStageId:org.ekstep.contenteditor.api.getCurrentStage().id,stageId:org.ekstep.contenteditor.stageManager.stages[org.ekstep.contenteditor.stageManager.stages.length-1].id})}),ecEditor.registerKeyboardCommand("mod+b",function(e){var t=org.ekstep.contenteditor.api.getCurrentObject();t&&(e.preventDefault(),t.onConfigChange("fontweight","bold"),ecEditor.dispatchEvent("object:modified",{target:ecEditor.getEditorObject()}))}),ecEditor.registerKeyboardCommand("mod+i",function(e){var t=org.ekstep.contenteditor.api.getCurrentObject();t&&(e.preventDefault(),t.onConfigChange("fontstyle","italic"),ecEditor.dispatchEvent("object:modified",{target:ecEditor.getEditorObject()}))}),ecEditor.registerKeyboardCommand("mod+shift+.",function(e){var t=org.ekstep.contenteditor.api.getCurrentObject();t&&(e.preventDefault(),e=t.getConfig().fontsize,e=parseInt(e,10),t.onConfigChange("fontsize",e+1),ecEditor.dispatchEvent("object:modified",{target:ecEditor.getEditorObject()}))}),ecEditor.registerKeyboardCommand("mod+shift+,",function(e){var t=org.ekstep.contenteditor.api.getCurrentObject();t&&(e.preventDefault(),e=t.getConfig().fontsize,e=parseInt(e,10),t.onConfigChange("fontsize",e-1),ecEditor.dispatchEvent("object:modified",{target:ecEditor.getEditorObject()}))}),ecEditor.registerKeyboardCommand("mod+alt+shift+l",function(e){var t=org.ekstep.contenteditor.api.getCurrentObject();t&&(e.preventDefault(),t.onConfigChange("align","left"),ecEditor.dispatchEvent("object:modified",{target:ecEditor.getEditorObject()}))}),ecEditor.registerKeyboardCommand("mod+alt+shift+r",function(e){var t=org.ekstep.contenteditor.api.getCurrentObject();t&&(e.preventDefault(),t.onConfigChange("align","right"),ecEditor.dispatchEvent("object:modified",{target:ecEditor.getEditorObject()}))}),ecEditor.registerKeyboardCommand("mod+alt+shift+e",function(e){var t=org.ekstep.contenteditor.api.getCurrentObject();t&&(e.preventDefault(),t.onConfigChange("align","center"),ecEditor.dispatchEvent("object:modified",{target:ecEditor.getEditorObject()}))}),ecEditor.registerKeyboardCommand("mod+down",function(t){t.preventDefault(),ecEditor.dispatchEvent(e.events.sendToBack),ecEditor.dispatchEvent("object:modified",{target:ecEditor.getEditorObject()})}),ecEditor.registerKeyboardCommand("mod+up",function(t){t.preventDefault(),ecEditor.dispatchEvent(e.events.sendToFront),ecEditor.dispatchEvent("object:modified",{target:ecEditor.getEditorObject()})}),ecEditor.registerKeyboardCommand("up",function(e){var t=org.ekstep.contenteditor.api.getCurrentObject(),n=org.ekstep.contenteditor.api.getEditorGroup();n?(e.preventDefault(),_.each(org.ekstep.contenteditor.api.getCurrentGroup(),function(e){var t=ecEditor.jQuery("#"+e.id);0!=t.length&&(t[0].style.top=parseInt(t[0].style.top,10)-3+"px"),e.setAttribute("y",e.attributes.y-3)}),n.top=n.top-3,org.ekstep.contenteditor.api.render(),ecEditor.dispatchEvent("object:modified",{target:ecEditor.getEditorObject()})):t&&(e.preventDefault(),0!=(n=ecEditor.jQuery("#"+t.id)).length&&(n[0].style.top=parseInt(n[0].style.top,10)-3+"px"),t.editorObj.top=t.editorObj.top-3,t.setAttribute("y",t.editorObj.top),org.ekstep.contenteditor.api.render(),ecEditor.dispatchEvent("object:modified",{target:ecEditor.getEditorObject()}))}),ecEditor.registerKeyboardCommand("down",function(e){var t=org.ekstep.contenteditor.api.getCurrentObject(),n=org.ekstep.contenteditor.api.getEditorGroup();n?(e.preventDefault(),_.each(org.ekstep.contenteditor.api.getCurrentGroup(),function(e){var t=ecEditor.jQuery("#"+e.id);0!=t.length&&(t[0].style.top=parseInt(t[0].style.top,10)+3+"px"),e.setAttribute("y",e.attributes.y+3)}),n.top=n.top+3,org.ekstep.contenteditor.api.render(),ecEditor.dispatchEvent("object:modified",{target:ecEditor.getEditorObject()})):t&&(e.preventDefault(),0!=(n=ecEditor.jQuery("#"+t.id)).length&&(n[0].style.top=parseInt(n[0].style.top,10)+3+"px"),t.editorObj.top=t.editorObj.top+3,t.setAttribute("y",t.editorObj.top),org.ekstep.contenteditor.api.render(),ecEditor.dispatchEvent("object:modified",{target:ecEditor.getEditorObject()}))}),ecEditor.registerKeyboardCommand("left",function(e){var t=org.ekstep.contenteditor.api.getCurrentObject(),n=org.ekstep.contenteditor.api.getEditorGroup();n?(e.preventDefault(),_.each(org.ekstep.contenteditor.api.getCurrentGroup(),function(e){var t=ecEditor.jQuery("#"+e.id);0!=t.length&&(t[0].style.left=parseInt(t[0].style.left,10)-3+"px"),e.setAttribute("x",e.attributes.x-3)}),n.left=n.left-3,org.ekstep.contenteditor.api.render(),ecEditor.dispatchEvent("object:modified",{target:ecEditor.getEditorObject()})):t&&(e.preventDefault(),0!=(n=ecEditor.jQuery("#"+t.id)).length&&(n[0].style.left=parseInt(n[0].style.left,10)-3+"px"),t.editorObj.left=t.editorObj.left-3,t.setAttribute("x",t.editorObj.left),org.ekstep.contenteditor.api.render(),ecEditor.dispatchEvent("object:modified",{target:ecEditor.getEditorObject()}))}),ecEditor.registerKeyboardCommand("right",function(e){var t=org.ekstep.contenteditor.api.getCurrentObject(),n=org.ekstep.contenteditor.api.getEditorGroup();n?(e.preventDefault(),_.each(org.ekstep.contenteditor.api.getCurrentGroup(),function(e){var t=ecEditor.jQuery("#"+e.id);0!=t.length&&(t[0].style.left=parseInt(t[0].style.left,10)+3+"px"),e.setAttribute("x",e.attributes.x+3)}),n.left=n.left+3,org.ekstep.contenteditor.api.render(),ecEditor.dispatchEvent("object:modified",{target:ecEditor.getEditorObject()})):t&&(e.preventDefault(),0!=(n=ecEditor.jQuery("#"+t.id)).length&&(n[0].style.left=parseInt(n[0].style.left,10)+3+"px"),t.editorObj.left=t.editorObj.left+3,t.setAttribute("x",t.editorObj.left),org.ekstep.contenteditor.api.render(),ecEditor.dispatchEvent("object:modified",{target:ecEditor.getEditorObject()}))}),ecEditor.registerKeyboardCommand("shift+up",function(e){var t=org.ekstep.contenteditor.api.getCurrentObject(),n=org.ekstep.contenteditor.api.getEditorGroup();n?(e.preventDefault(),_.each(org.ekstep.contenteditor.api.getCurrentGroup(),function(e){var t=ecEditor.jQuery("#"+e.id);0!=t.length&&(t[0].style.top=parseInt(t[0].style.top,10)-1+"px"),e.setAttribute("x",e.attributes.x-1)}),n.top=n.top-1,org.ekstep.contenteditor.api.render(),ecEditor.dispatchEvent("object:modified",{target:ecEditor.getEditorObject()})):t&&(e.preventDefault(),0!=(n=ecEditor.jQuery("#"+t.id)).length&&(n[0].style.top=parseInt(n[0].style.top,10)-1+"px"),t.editorObj.top=t.editorObj.top-1,t.setAttribute("y",t.editorObj.top),org.ekstep.contenteditor.api.render(),ecEditor.dispatchEvent("object:modified",{target:ecEditor.getEditorObject()}))}),ecEditor.registerKeyboardCommand("shift+down",function(e){var t=org.ekstep.contenteditor.api.getCurrentObject(),n=org.ekstep.contenteditor.api.getEditorGroup();n?(e.preventDefault(),_.each(org.ekstep.contenteditor.api.getCurrentGroup(),function(e){var t=ecEditor.jQuery("#"+e.id);0!=t.length&&(t[0].style.top=parseInt(t[0].style.top,10)+1+"px"),e.setAttribute("x",e.attributes.x+1)}),n.top=n.top+1,org.ekstep.contenteditor.api.render(),ecEditor.dispatchEvent("object:modified",{target:ecEditor.getEditorObject()})):t&&(e.preventDefault(),0!=(n=ecEditor.jQuery("#"+t.id)).length&&(n[0].style.top=parseInt(n[0].style.top,10)+1+"px"),t.editorObj.top=t.editorObj.top+1,t.setAttribute("y",t.editorObj.top),org.ekstep.contenteditor.api.render(),ecEditor.dispatchEvent("object:modified",{target:ecEditor.getEditorObject()}))}),ecEditor.registerKeyboardCommand("shift+left",function(e){var t=org.ekstep.contenteditor.api.getCurrentObject(),n=org.ekstep.contenteditor.api.getEditorGroup();n?(e.preventDefault(),_.each(org.ekstep.contenteditor.api.getCurrentGroup(),function(e){var t=ecEditor.jQuery("#"+e.id);0!=t.length&&(t[0].style.left=parseInt(t[0].style.left,10)-1+"px"),e.setAttribute("x",e.attributes.x-1)}),n.left=n.left-1,org.ekstep.contenteditor.api.render(),ecEditor.dispatchEvent("object:modified",{target:ecEditor.getEditorObject()})):t&&(e.preventDefault(),0!=(n=ecEditor.jQuery("#"+t.id)).length&&(n[0].style.left=parseInt(n[0].style.left,10)-1+"px"),t.editorObj.left=t.editorObj.left-1,t.setAttribute("x",t.editorObj.left),org.ekstep.contenteditor.api.render(),ecEditor.dispatchEvent("object:modified",{target:ecEditor.getEditorObject()}))}),ecEditor.registerKeyboardCommand("shift+right",function(e){var t=org.ekstep.contenteditor.api.getCurrentObject(),n=org.ekstep.contenteditor.api.getEditorGroup();n?(e.preventDefault(),_.each(org.ekstep.contenteditor.api.getCurrentGroup(),function(e){var t=ecEditor.jQuery("#"+e.id);0!=t.length&&(t[0].style.left=parseInt(t[0].style.left,10)+1+"px"),e.setAttribute("x",e.attributes.x+1)}),n.left=n.left+1,org.ekstep.contenteditor.api.render(),ecEditor.dispatchEvent("object:modified",{target:ecEditor.getEditorObject()})):t&&(e.preventDefault(),0!=(n=ecEditor.jQuery("#"+t.id)).length&&(n[0].style.left=parseInt(n[0].style.left,10)+1+"px"),t.editorObj.left=t.editorObj.left+1,t.setAttribute("x",t.editorObj.left),org.ekstep.contenteditor.api.render(),ecEditor.dispatchEvent("object:modified",{target:ecEditor.getEditorObject()}))})},moveRichText:function(e){var t=org.ekstep.contenteditor.api.getEditorGroup();t&&_.each(t.getObjects(),function(e){0!=ecEditor.jQuery("#"+e.id).length&&ecEditor.jQuery("#"+e.id).css({top:t.top+t.height/2+e.top,left:t.left+t.width/2+e.left})})}}))},function(e,t){e.exports='<style>\n    #shortCut {\n        width: 100%;\n        overflow-y: auto;\n        overflow-x: hidden;\n        height: 450px;\n    }\n    .shortcut-table {\n        width: 100%;\n        margin-left: 3.6em;\n    }\n    .shortcut-popup {\n        height: 450px !important\n    }\n</style>\n<div class="ui large modal active" style="top: 5% !important">\n    <div class="header">\n        <div class="ui grid">\n            <div class="fourteen column row">\n                <div class="left floated five wide column">\n                    <i class="file code outline icon"></i>\n                    <label><b>Keyboard ShortCuts</b></label>\n                </div>\n                <div>\n                    <span class="right floated column"><i class="remove link icon" ng-click="closeThisDialog()"></i></span>\n                </div>\n            </div>\n        </div>\n    </div>\n    <div class="content">\n        <div class="ui grid shortcut-popup">\n            <pre class="line-numbers language-markup shortcut-popup`" id="shortCut">\n                <table class="shortcut-table">\n                    <tr>\n                        <th colspan="2">ShortCuts(Windows)</th>\n                        <th colspan="2">ShortCuts(Mac)</th>\n                        <th colspan="6">Details</th>\n                    </tr>\n                    <tr>\n                        <td colspan="2">Ctrl + x</td>\n                        <td colspan="2">Command + x</td>\n                        <td colspan="6">Cut selected object</td>\n                    </tr>\n                    <tr>\n                        <td colspan="2">Ctrl + c</td>\n                        <td colspan="2">Command + c</td>\n                        <td colspan="6">Copy selected object</td>\n                    </tr>\n                    <tr>\n                        <td colspan="2">Ctrl + v</td>\n                        <td colspan="2">Command + v</td>\n                        <td colspan="6">Paste selected object</td>\n                    </tr>\n                    <tr>\n                        <td colspan="2">Ctrl + a</td>\n                        <td colspan="2">Command + a</td>\n                        <td colspan="6">Select all object</td>\n                    </tr>\n                    <tr>\n                        <td colspan="2">Delete</td>\n                        <td colspan="2">Delete</td>\n                        <td colspan="6">Delete selected object</td>\n                    </tr>\n                    <tr>\n                        <td colspan="2">Ctrl + m</td>\n                        <td colspan="2">Command + m</td>\n                        <td colspan="6">Add a new stage</td>\n                    </tr>\n                    <tr>\n                        <td colspan="2">Ctrl + d</td>\n                        <td colspan="2">Command + d</td>\n                        <td colspan="6">Duplicate a stage</td>\n                    </tr>\n                    <tr>\n                        <td colspan="2">Ctrl + s</td>\n                        <td colspan="2">Command + s</td>\n                        <td colspan="6">Save content</td>\n                    </tr>\n                    <tr>\n                        <td colspan="2">Home</td>\n                        <td colspan="2">Command + up</td>\n                        <td colspan="6">Go to First Slide</td>\n                    </tr>\n                    <tr>\n                        <td colspan="2">End</td>\n                        <td colspan="2">Command + down</td>\n                        <td colspan="6">Go to last Slide</td>\n                    </tr>\n                    <tr>\n                        <td colspan="2">Ctrl + b</td>\n                        <td colspan="2">Command + b</td>\n                        <td colspan="6">Make text style as bold</td>\n                    </tr>\n                    <tr>\n                        <td colspan="2">Ctrl + i</td>\n                        <td colspan="2">Command + i</td>\n                        <td colspan="6">Make text style as italic</td>\n                    </tr>\n                    <tr>\n                        <td colspan="2">Ctrl + shift + ></td>\n                        <td colspan="2">Command + shift + ></td>\n                        <td colspan="6">Increase text size of selected text object</td>\n                    </tr>\n                    <tr>\n                        <td colspan="2">Ctrl + shift + <</td>\n                        <td colspan="2">Command + shift + <</td>\n                        <td colspan="6">Decrease text size of selected text object</td>\n                    </tr>\n                    <tr>\n                        <td colspan="2">Ctrl + alt + shift + l</td>\n                        <td colspan="2">Command + alt + shift + l</td>\n                        <td colspan="6">Align a text object to left</td>\n                    </tr>\n                    <tr>\n                        <td colspan="2">Ctrl + alt + shift + r</td>\n                        <td colspan="2">Command + alt + shift + r</td>\n                        <td colspan="6">Align a text object to right</td>\n                    </tr>\n                    <tr>\n                        <td colspan="2">Ctrl + alt + shift + e</td>\n                        <td colspan="2">Command + alt + shift + e</td>\n                        <td colspan="6">Align a text object to center</td>\n                    </tr>\n                    <tr>\n                        <td colspan="2">Ctrl + down arrow</td>\n                        <td colspan="2">Command + down arrow</td>\n                        <td colspan="6">Send an object to back</td>\n                    </tr>\n                    <tr>\n                        <td colspan="2">Ctrl + up arrow</td>\n                        <td colspan="2">Command + up arrow</td>\n                        <td colspan="6">Send an object to front</td>\n                    </tr>\n                    <tr>\n                        <td colspan="2">Up arrow</td>\n                        <td colspan="2">Up arrow</td>\n                        <td colspan="6">Move selected object up by 3 pixel</td>\n                    </tr>\n                    <tr>\n                        <td colspan="2">Down arrow</td>\n                        <td colspan="2">Down arrow</td>\n                        <td colspan="6">Move selected object down by 3 pixel</td>\n                    </tr>\n                    <tr>\n                        <td colspan="2">Left arrow</td>\n                        <td colspan="2">Left arrow</td>\n                        <td colspan="2">Move selected object left by 3 pixel</td>\n                    </tr>\n                    <tr>\n                        <td colspan="2">Right arrow</td>\n                        <td colspan="2">Right arrow</td>\n                        <td colspan="6">Move selected object right by 3 pixel</td>\n                    </tr>\n                    <tr>\n                        <td colspan="2">Shift + up arrow</td>\n                        <td colspan="2">Shift + up arrow</td>\n                        <td colspan="6">Move selected object up by 1 pixel</td>\n                    </tr>\n                    <tr>\n                        <td colspan="2">Shift + down arrow</td>\n                        <td colspan="2">Shift + down arrow</td>\n                        <td colspan="6">Move selected object down by 1 pixel</td>\n                    </tr>\n                    <tr>\n                        <td colspan="2">Shift + left arrow</td>\n                        <td colspan="2">Shift + left arrow</td>\n                        <td colspan="2">Move selected object left by 1 pixel</td>\n                    </tr>\n                    <tr>\n                        <td colspan="2">Shift + right arrow</td>\n                        <td colspan="2">Shift + right arrow</td>\n                        <td colspan="6">Move selected object right by 1 pixel</td>\n                    </tr>\n                    <tr>\n                        <td colspan="2">Ctrl + /</td>\n                        <td colspan="2">Command + /</td>\n                        <td colspan="6">Show keyboard shortcut popup</td>\n                    </tr>\n                </table>\n            </pre>\n        </div>\n    </div>\n</div>'},function(e,t,n){var i,r,a,o,s,l,u,c,d;window.CKEDITOR&&window.CKEDITOR.dom||(window.CKEDITOR||(window.CKEDITOR=function(){var e=/(^|.*[\\\/])ckeditor\.js(?:\?.*|;.*)?$/i,t={timestamp:"H0CF",version:"4.6.2 (Standard)",revision:"20af917",rnd:Math.floor(900*Math.random())+100,_:{pending:[],basePathSrcPattern:e},status:"unloaded",basePath:function(){var t=window.CKEDITOR_BASEPATH||"";if(!t)for(var n=document.getElementsByTagName("script"),i=0;i<n.length;i++){var r=n[i].src.match(e);if(r){t=r[1];break}}if(-1==t.indexOf(":/")&&"//"!=t.slice(0,2)&&(t=0===t.indexOf("/")?location.href.match(/^.*?:\/\/[^\/]*/)[0]+t:location.href.match(/^[^\?]*\/(?:)/)[0]+t),!t)throw'The CKEditor installation path could not be automatically detected. Please set the global variable "CKEDITOR_BASEPATH" before creating editor instances.';return t}(),getUrl:function(e){return-1==e.indexOf(":/")&&0!==e.indexOf("/")&&(e=this.basePath+e),this.timestamp&&"/"!=e.charAt(e.length-1)&&!/[&?]t=/.test(e)&&(e+=(0<=e.indexOf("?")?"&":"?")+"t="+this.timestamp),e},domReady:function(){function e(){try{document.addEventListener?(document.removeEventListener("DOMContentLoaded",e,!1),t()):document.attachEvent&&"complete"===document.readyState&&(document.detachEvent("onreadystatechange",e),t())}catch(e){}}function t(){for(var e;e=n.shift();)e()}var n=[];return function(t){if(n.push(t),"complete"===document.readyState&&setTimeout(e,1),1==n.length)if(document.addEventListener)document.addEventListener("DOMContentLoaded",e,!1),window.addEventListener("load",e,!1);else if(document.attachEvent){document.attachEvent("onreadystatechange",e),window.attachEvent("onload",e),t=!1;try{t=!window.frameElement}catch(e){}document.documentElement.doScroll&&t&&function t(){try{document.documentElement.doScroll("left")}catch(e){return void setTimeout(t,1)}e()}()}}}()},n=window.CKEDITOR_GETURL;if(n){var i=t.getUrl;t.getUrl=function(e){return n.call(t,e)||i.call(t,e)}}return t}()),CKEDITOR.event||(CKEDITOR.event=function(){},CKEDITOR.event.implementOn=function(e){var t,n=CKEDITOR.event.prototype;for(t in n)null==e[t]&&(e[t]=n[t])},CKEDITOR.event.prototype=function(){function e(e){var i=t(this);return i[e]||(i[e]=new n(e))}var t=function(e){return(e=e.getPrivate&&e.getPrivate()||e._||(e._={})).events||(e.events={})},n=function(e){this.name=e,this.listeners=[]};return n.prototype={getListenerIndex:function(e){for(var t=0,n=this.listeners;t<n.length;t++)if(n[t].fn==e)return t;return-1}},{define:function(t,n){var i=e.call(this,t);CKEDITOR.tools.extend(i,n,!0)},on:function(t,n,i,r,a){function o(e,a,o,l){return e={name:t,sender:this,editor:e,data:a,listenerData:r,stop:o,cancel:l,removeListener:s},!1!==n.call(i,e)&&e.data}function s(){u.removeListener(t,n)}var l=e.call(this,t);if(0>l.getListenerIndex(n)){l=l.listeners,i||(i=this),isNaN(a)&&(a=10);var u=this;o.fn=n,o.priority=a;for(var c=l.length-1;0<=c;c--)if(l[c].priority<=a)return l.splice(c+1,0,o),{removeListener:s};l.unshift(o)}return{removeListener:s}},once:function(){var e=Array.prototype.slice.call(arguments),t=e[1];return e[1]=function(e){return e.removeListener(),t.apply(this,arguments)},this.on.apply(this,e)},capture:function(){CKEDITOR.event.useCapture=1;var e=this.on.apply(this,arguments);return CKEDITOR.event.useCapture=0,e},fire:function(){var e=0,n=function(){e=1},i=0,r=function(){i=1};return function(a,o,s){var l=t(this)[a];a=e;var u=i;if(e=i=0,l&&(d=l.listeners).length)for(var c,d=d.slice(0),h=0;h<d.length;h++){if(l.errorProof)try{c=d[h].call(this,s,o,n,r)}catch(e){}else c=d[h].call(this,s,o,n,r);if(!1===c?i=1:void 0!==c&&(o=c),e||i)break}return o=!i&&(void 0===o||o),e=a,i=u,o}}(),fireOnce:function(e,n,i){return n=this.fire(e,n,i),delete t(this)[e],n},removeListener:function(e,n){var i=t(this)[e];if(i){var r=i.getListenerIndex(n);0<=r&&i.listeners.splice(r,1)}},removeAllListeners:function(){var e,n=t(this);for(e in n)delete n[e]},hasListeners:function(e){return(e=t(this)[e])&&0<e.listeners.length}}}()),CKEDITOR.editor||(CKEDITOR.editor=function(){CKEDITOR._.pending.push([this,arguments]),CKEDITOR.event.call(this)},CKEDITOR.editor.prototype.fire=function(e,t){return e in{instanceReady:1,loaded:1}&&(this[e]=!0),CKEDITOR.event.prototype.fire.call(this,e,t,this)},CKEDITOR.editor.prototype.fireOnce=function(e,t){return e in{instanceReady:1,loaded:1}&&(this[e]=!0),CKEDITOR.event.prototype.fireOnce.call(this,e,t,this)},CKEDITOR.event.implementOn(CKEDITOR.editor.prototype)),CKEDITOR.env||(CKEDITOR.env=function(){var e=navigator.userAgent.toLowerCase(),t=e.match(/edge[ \/](\d+.?\d*)/),n=-1<e.indexOf("trident/");(n={ie:n=!(!t&&!n),edge:!!t,webkit:!n&&-1<e.indexOf(" applewebkit/"),air:-1<e.indexOf(" adobeair/"),mac:-1<e.indexOf("macintosh"),quirks:"BackCompat"==document.compatMode&&(!document.documentMode||10>document.documentMode),mobile:-1<e.indexOf("mobile"),iOS:/(ipad|iphone|ipod)/.test(e),isCustomDomain:function(){if(!this.ie)return!1;var e=document.domain,t=window.location.hostname;return e!=t&&e!="["+t+"]"},secure:"https:"==location.protocol}).gecko="Gecko"==navigator.product&&!n.webkit&&!n.ie,n.webkit&&(-1<e.indexOf("chrome")?n.chrome=!0:n.safari=!0);var i=0;return n.ie&&(i=t?parseFloat(t[1]):n.quirks||!document.documentMode?parseFloat(e.match(/msie (\d+)/)[1]):document.documentMode,n.ie9Compat=9==i,n.ie8Compat=8==i,n.ie7Compat=7==i,n.ie6Compat=7>i||n.quirks),n.gecko&&(t=e.match(/rv:([\d\.]+)/))&&(i=1e4*(t=t[1].split("."))[0]+100*(t[1]||0)+1*(t[2]||0)),n.air&&(i=parseFloat(e.match(/ adobeair\/(\d+)/)[1])),n.webkit&&(i=parseFloat(e.match(/ applewebkit\/(\d+)/)[1])),n.version=i,n.isCompatible=!(n.ie&&7>i||n.gecko&&4e4>i||n.webkit&&534>i),n.hidpi=2<=window.devicePixelRatio,n.needsBrFiller=n.gecko||n.webkit||n.ie&&10<i,n.needsNbspFiller=n.ie&&11>i,n.cssClass="cke_browser_"+(n.ie?"ie":n.gecko?"gecko":n.webkit?"webkit":"unknown"),n.quirks&&(n.cssClass+=" cke_browser_quirks"),n.ie&&(n.cssClass+=" cke_browser_ie"+(n.quirks?"6 cke_browser_iequirks":n.version)),n.air&&(n.cssClass+=" cke_browser_air"),n.iOS&&(n.cssClass+=" cke_browser_ios"),n.hidpi&&(n.cssClass+=" cke_hidpi"),n}()),"unloaded"==CKEDITOR.status&&(CKEDITOR.event.implementOn(CKEDITOR),CKEDITOR.loadFullCore=function(){if("basic_ready"!=CKEDITOR.status)CKEDITOR.loadFullCore._load=1;else{delete CKEDITOR.loadFullCore;var e=document.createElement("script");e.type="text/javascript",e.src=CKEDITOR.basePath+"ckeditor.js",document.getElementsByTagName("head")[0].appendChild(e)}},CKEDITOR.loadFullCoreTimeout=0,CKEDITOR.add=function(e){(this._.pending||(this._.pending=[])).push(e)},CKEDITOR.domReady(function(){var e=CKEDITOR.loadFullCore,t=CKEDITOR.loadFullCoreTimeout;e&&(CKEDITOR.status="basic_ready",e&&e._load?e():t&&setTimeout(function(){CKEDITOR.loadFullCore&&CKEDITOR.loadFullCore()},1e3*t))}),CKEDITOR.status="basic_loaded"),CKEDITOR.VERBOSITY_WARN=1,CKEDITOR.VERBOSITY_ERROR=2,CKEDITOR.verbosity=CKEDITOR.VERBOSITY_WARN|CKEDITOR.VERBOSITY_ERROR,CKEDITOR.warn=function(e,t){CKEDITOR.verbosity&CKEDITOR.VERBOSITY_WARN&&CKEDITOR.fire("log",{type:"warn",errorCode:e,additionalData:t})},CKEDITOR.error=function(e,t){CKEDITOR.verbosity&CKEDITOR.VERBOSITY_ERROR&&CKEDITOR.fire("log",{type:"error",errorCode:e,additionalData:t})},CKEDITOR.on("log",function(e){if(window.console&&window.console.log){var t=console[e.data.type]?e.data.type:"log",n=e.data.errorCode;(e=e.data.additionalData)?console[t]("[CKEDITOR] Error code: "+n+".",e):console[t]("[CKEDITOR] Error code: "+n+"."),console[t]("[CKEDITOR] For more information about this error go to http://docs.ckeditor.com/#!/guide/dev_errors-section-"+n)}},null,null,999),CKEDITOR.dom={},i=[],r=CKEDITOR.env.gecko?"-moz-":CKEDITOR.env.webkit?"-webkit-":CKEDITOR.env.ie?"-ms-":"",a=/&/g,o=/>/g,s=/</g,l=/"/g,u=/&(lt|gt|amp|quot|nbsp|shy|#\d{1,5});/g,c={lt:"<",gt:">",amp:"&",quot:'"',nbsp:" ",shy:"­"},d=function(e,t){return"#"==t[0]?String.fromCharCode(parseInt(t.slice(1),10)):c[t]},CKEDITOR.on("reset",function(){i=[]}),CKEDITOR.tools={arrayCompare:function(e,t){if(!e&&!t)return!0;if(!e||!t||e.length!=t.length)return!1;for(var n=0;n<e.length;n++)if(e[n]!=t[n])return!1;return!0},getIndex:function(e,t){for(var n=0;n<e.length;++n)if(t(e[n]))return n;return-1},clone:function(e){var t;if(e&&e instanceof Array){t=[];for(var n=0;n<e.length;n++)t[n]=CKEDITOR.tools.clone(e[n]);return t}if(null===e||"object"!=typeof e||e instanceof String||e instanceof Number||e instanceof Boolean||e instanceof Date||e instanceof RegExp||e.nodeType||e.window===e)return e;for(n in t=new e.constructor,e)t[n]=CKEDITOR.tools.clone(e[n]);return t},capitalize:function(e,t){return e.charAt(0).toUpperCase()+(t?e.slice(1):e.slice(1).toLowerCase())},extend:function(e){var t,n,i=arguments.length;"boolean"==typeof(t=arguments[i-1])?i--:"boolean"==typeof(t=arguments[i-2])&&(n=arguments[i-1],i-=2);for(var r=1;r<i;r++){var a,o=arguments[r];for(a in o)!0!==t&&null!=e[a]||(!n||a in n)&&(e[a]=o[a])}return e},prototypedCopy:function(e){var t=function(){};return t.prototype=e,new t},copy:function(e){var t,n={};for(t in e)n[t]=e[t];return n},isArray:function(e){return"[object Array]"==Object.prototype.toString.call(e)},isEmpty:function(e){for(var t in e)if(e.hasOwnProperty(t))return!1;return!0},cssVendorPrefix:function(e,t,n){return n?r+e+":"+t+";"+e+":"+t:((n={})[e]=t,n[r+e]=t,n)},cssStyleToDomStyle:function(){var e=document.createElement("div").style,t=void 0!==e.cssFloat?"cssFloat":void 0!==e.styleFloat?"styleFloat":"float";return function(e){return"float"==e?t:e.replace(/-./g,function(e){return e.substr(1).toUpperCase()})}}(),buildStyleHtml:function(e){e=[].concat(e);for(var t,n=[],i=0;i<e.length;i++)(t=e[i])&&(/@import|[{}]/.test(t)?n.push("<style>"+t+"</style>"):n.push('<link type="text/css" rel=stylesheet href="'+t+'">'));return n.join("")},htmlEncode:function(e){return void 0===e||null===e?"":String(e).replace(a,"&amp;").replace(o,"&gt;").replace(s,"&lt;")},htmlDecode:function(e){return e.replace(u,d)},htmlEncodeAttr:function(e){return CKEDITOR.tools.htmlEncode(e).replace(l,"&quot;")},htmlDecodeAttr:function(e){return CKEDITOR.tools.htmlDecode(e)},transformPlainTextToHtml:function(e,t){var n=t==CKEDITOR.ENTER_BR,i=(i=this.htmlEncode(e.replace(/\r\n/g,"\n"))).replace(/\t/g,"&nbsp;&nbsp; &nbsp;"),r=t==CKEDITOR.ENTER_P?"p":"div";if(!n){var a=/\n{2}/g;if(a.test(i)){var o="<"+r+">",s="</"+r+">";i=o+i.replace(a,function(){return s+o})+s}}return i=i.replace(/\n/g,"<br>"),n||(i=i.replace(new RegExp("<br>(?=</"+r+">)"),function(e){return CKEDITOR.tools.repeat(e,2)})),(i=i.replace(/^ | $/g,"&nbsp;")).replace(/(>|\s) /g,function(e,t){return t+"&nbsp;"}).replace(/ (?=<)/g,"&nbsp;")},getNextNumber:function(){var e=0;return function(){return++e}}(),getNextId:function(){return"cke_"+this.getNextNumber()},getUniqueId:function(){for(var e="e",t=0;8>t;t++)e+=Math.floor(65536*(1+Math.random())).toString(16).substring(1);return e},override:function(e,t){var n=t(e);return n.prototype=e.prototype,n},setTimeout:function(e,t,n,i,r){return r||(r=window),n||(n=r),r.setTimeout(function(){i?e.apply(n,[].concat(i)):e.apply(n)},t||0)},trim:function(){var e=/(?:^[ \t\n\r]+)|(?:[ \t\n\r]+$)/g;return function(t){return t.replace(e,"")}}(),ltrim:function(){var e=/^[ \t\n\r]+/g;return function(t){return t.replace(e,"")}}(),rtrim:function(){var e=/[ \t\n\r]+$/g;return function(t){return t.replace(e,"")}}(),indexOf:function(e,t){if("function"==typeof t){for(var n=0,i=e.length;n<i;n++)if(t(e[n]))return n}else{if(e.indexOf)return e.indexOf(t);for(n=0,i=e.length;n<i;n++)if(e[n]===t)return n}return-1},search:function(e,t){var n=CKEDITOR.tools.indexOf(e,t);return 0<=n?e[n]:null},bind:function(e,t){return function(){return e.apply(t,arguments)}},createClass:function(e){var t=e.$,n=e.base,i=e.privates||e._,r=e.proto;if(e=e.statics,!t&&(t=function(){n&&this.base.apply(this,arguments)}),i){var a=t;t=function(){var e,t=this._||(this._={});for(e in i){var n=i[e];t[e]="function"==typeof n?CKEDITOR.tools.bind(n,this):n}a.apply(this,arguments)}}return n&&(t.prototype=this.prototypedCopy(n.prototype),t.prototype.constructor=t,t.base=n,t.baseProto=n.prototype,t.prototype.base=function(){this.base=n.prototype.base,n.apply(this,arguments),this.base=arguments.callee}),r&&this.extend(t.prototype,r,!0),e&&this.extend(t,e,!0),t},addFunction:function(e,t){return i.push(function(){return e.apply(t||this,arguments)})-1},removeFunction:function(e){i[e]=null},callFunction:function(e){var t=i[e];return t&&t.apply(window,Array.prototype.slice.call(arguments,1))},cssLength:function(){var e,t=/^-?\d+\.?\d*px$/;return function(n){return e=CKEDITOR.tools.trim(n+"")+"px",t.test(e)?e:n||""}}(),convertToPx:function(){var e;return function(t){return e||(e=CKEDITOR.dom.element.createFromHtml('<div style="position:absolute;left:-9999px;top:-9999px;margin:0px;padding:0px;border:0px;"></div>',CKEDITOR.document),CKEDITOR.document.getBody().append(e)),/%$/.test(t)?t:(e.setStyle("width",t),e.$.clientWidth)}}(),repeat:function(e,t){return Array(t+1).join(e)},tryThese:function(){for(var e,t=0,n=arguments.length;t<n;t++){var i=arguments[t];try{e=i();break}catch(e){}}return e},genKey:function(){return Array.prototype.slice.call(arguments).join("-")},defer:function(e){return function(){var t=arguments,n=this;window.setTimeout(function(){e.apply(n,t)},0)}},normalizeCssText:function(e,t){var n,i=[],r=CKEDITOR.tools.parseCssText(e,!0,t);for(n in r)i.push(n+":"+r[n]);return i.sort(),i.length?i.join(";")+";":""},convertRgbToHex:function(e){return e.replace(/(?:rgb\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\))/gi,function(e,t,n,i){for(e=[t,n,i],t=0;3>t;t++)e[t]=("0"+parseInt(e[t],10).toString(16)).slice(-2);return"#"+e.join("")})},normalizeHex:function(e){return e.replace(/#(([0-9a-f]{3}){1,2})($|;|\s+)/gi,function(e,t,n,i){return 3==(e=t.toLowerCase()).length&&(e=[(e=e.split(""))[0],e[0],e[1],e[1],e[2],e[2]].join("")),"#"+e+i})},parseCssText:function(e,t,n){var i={};return n&&(e=new CKEDITOR.dom.element("span").setAttribute("style",e).getAttribute("style")||""),e&&(e=CKEDITOR.tools.normalizeHex(CKEDITOR.tools.convertRgbToHex(e))),e&&";"!=e?(e.replace(/&quot;/g,'"').replace(/\s*([^:;\s]+)\s*:\s*([^;]+)\s*(?=;|$)/g,function(e,n,r){t&&("font-family"==(n=n.toLowerCase())&&(r=r.replace(/\s*,\s*/g,",")),r=CKEDITOR.tools.trim(r)),i[n]=r}),i):i},writeCssText:function(e,t){var n,i=[];for(n in e)i.push(n+":"+e[n]);return t&&i.sort(),i.join("; ")},objectCompare:function(e,t,n){var i;if(!e&&!t)return!0;if(!e||!t)return!1;for(i in e)if(e[i]!=t[i])return!1;if(!n)for(i in t)if(e[i]!=t[i])return!1;return!0},objectKeys:function(e){var t,n=[];for(t in e)n.push(t);return n},convertArrayToObject:function(e,t){var n={};1==arguments.length&&(t=!0);for(var i=0,r=e.length;i<r;++i)n[e[i]]=t;return n},fixDomain:function(){for(var e;;)try{e=window.parent.document.domain;break}catch(t){if(!(e=e?e.replace(/.+?(?:\.|$)/,""):document.domain))break;document.domain=e}return!!e},eventsBuffer:function(e,t,n){function i(){a=(new Date).getTime(),r=!1,n?t.call(n):t()}var r,a=0;return{input:function(){if(!r){var t=(new Date).getTime()-a;t<e?r=setTimeout(i,e-t):i()}},reset:function(){r&&clearTimeout(r),r=a=0}}},enableHtml5Elements:function(e,t){for(var n,i="abbr article aside audio bdi canvas data datalist details figcaption figure footer header hgroup main mark meter nav output progress section summary time video".split(" "),r=i.length;r--;)n=e.createElement(i[r]),t&&e.appendChild(n)},checkIfAnyArrayItemMatches:function(e,t){for(var n=0,i=e.length;n<i;++n)if(e[n].match(t))return!0;return!1},checkIfAnyObjectPropertyMatches:function(e,t){for(var n in e)if(n.match(t))return!0;return!1},keystrokeToString:function(e,t){var n=16711680&t,i=65535&t,r=CKEDITOR.env.mac,a=[],o=[];return n&CKEDITOR.CTRL&&(a.push(r?"⌘":e[17]),o.push(r?e[224]:e[17])),n&CKEDITOR.ALT&&(a.push(r?"⌥":e[18]),o.push(e[18])),n&CKEDITOR.SHIFT&&(a.push(r?"⇧":e[16]),o.push(e[16])),i&&(e[i]?(a.push(e[i]),o.push(e[i])):(a.push(String.fromCharCode(i)),o.push(String.fromCharCode(i)))),{display:a.join("+"),aria:o.join("+")}},transparentImageData:"data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==",getCookie:function(e){e=e.toLowerCase();for(var t,n=document.cookie.split(";"),i=0;i<n.length;i++)if(t=n[i].split("="),decodeURIComponent(CKEDITOR.tools.trim(t[0]).toLowerCase())===e)return decodeURIComponent(1<t.length?t[1]:"");return null},setCookie:function(e,t){document.cookie=encodeURIComponent(e)+"="+encodeURIComponent(t)+";path=/"},getCsrfToken:function(){if(!(e=CKEDITOR.tools.getCookie("ckCsrfToken"))||40!=e.length){var e=[],t="";if(window.crypto&&window.crypto.getRandomValues)e=new Uint8Array(40),window.crypto.getRandomValues(e);else for(var n=0;40>n;n++)e.push(Math.floor(256*Math.random()));for(n=0;n<e.length;n++){var i="abcdefghijklmnopqrstuvwxyz0123456789".charAt(e[n]%36);t+=.5<Math.random()?i.toUpperCase():i}e=t,CKEDITOR.tools.setCookie("ckCsrfToken",e)}return e},escapeCss:function(e){return e?window.CSS&&CSS.escape?CSS.escape(e):isNaN(parseInt(e.charAt(0),10))?e:"\\3"+e.charAt(0)+" "+e.substring(1,e.length):""},style:{parse:{_colors:{aliceblue:"#F0F8FF",antiquewhite:"#FAEBD7",aqua:"#00FFFF",aquamarine:"#7FFFD4",azure:"#F0FFFF",beige:"#F5F5DC",bisque:"#FFE4C4",black:"#000000",blanchedalmond:"#FFEBCD",blue:"#0000FF",blueviolet:"#8A2BE2",brown:"#A52A2A",burlywood:"#DEB887",cadetblue:"#5F9EA0",chartreuse:"#7FFF00",chocolate:"#D2691E",coral:"#FF7F50",cornflowerblue:"#6495ED",cornsilk:"#FFF8DC",crimson:"#DC143C",cyan:"#00FFFF",darkblue:"#00008B",darkcyan:"#008B8B",darkgoldenrod:"#B8860B",darkgray:"#A9A9A9",darkgreen:"#006400",darkgrey:"#A9A9A9",darkkhaki:"#BDB76B",darkmagenta:"#8B008B",darkolivegreen:"#556B2F",darkorange:"#FF8C00",darkorchid:"#9932CC",darkred:"#8B0000",darksalmon:"#E9967A",darkseagreen:"#8FBC8F",darkslateblue:"#483D8B",darkslategray:"#2F4F4F",darkslategrey:"#2F4F4F",darkturquoise:"#00CED1",darkviolet:"#9400D3",deeppink:"#FF1493",deepskyblue:"#00BFFF",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1E90FF",firebrick:"#B22222",floralwhite:"#FFFAF0",forestgreen:"#228B22",fuchsia:"#FF00FF",gainsboro:"#DCDCDC",ghostwhite:"#F8F8FF",gold:"#FFD700",goldenrod:"#DAA520",gray:"#808080",green:"#008000",greenyellow:"#ADFF2F",grey:"#808080",honeydew:"#F0FFF0",hotpink:"#FF69B4",indianred:"#CD5C5C",indigo:"#4B0082",ivory:"#FFFFF0",khaki:"#F0E68C",lavender:"#E6E6FA",lavenderblush:"#FFF0F5",lawngreen:"#7CFC00",lemonchiffon:"#FFFACD",lightblue:"#ADD8E6",lightcoral:"#F08080",lightcyan:"#E0FFFF",lightgoldenrodyellow:"#FAFAD2",lightgray:"#D3D3D3",lightgreen:"#90EE90",lightgrey:"#D3D3D3",lightpink:"#FFB6C1",lightsalmon:"#FFA07A",lightseagreen:"#20B2AA",lightskyblue:"#87CEFA",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#B0C4DE",lightyellow:"#FFFFE0",lime:"#00FF00",limegreen:"#32CD32",linen:"#FAF0E6",magenta:"#FF00FF",maroon:"#800000",mediumaquamarine:"#66CDAA",mediumblue:"#0000CD",mediumorchid:"#BA55D3",mediumpurple:"#9370DB",mediumseagreen:"#3CB371",mediumslateblue:"#7B68EE",mediumspringgreen:"#00FA9A",mediumturquoise:"#48D1CC",mediumvioletred:"#C71585",midnightblue:"#191970",mintcream:"#F5FFFA",mistyrose:"#FFE4E1",moccasin:"#FFE4B5",navajowhite:"#FFDEAD",navy:"#000080",oldlace:"#FDF5E6",olive:"#808000",olivedrab:"#6B8E23",orange:"#FFA500",orangered:"#FF4500",orchid:"#DA70D6",palegoldenrod:"#EEE8AA",palegreen:"#98FB98",paleturquoise:"#AFEEEE",palevioletred:"#DB7093",papayawhip:"#FFEFD5",peachpuff:"#FFDAB9",peru:"#CD853F",pink:"#FFC0CB",plum:"#DDA0DD",powderblue:"#B0E0E6",purple:"#800080",rebeccapurple:"#663399",red:"#FF0000",rosybrown:"#BC8F8F",royalblue:"#4169E1",saddlebrown:"#8B4513",salmon:"#FA8072",sandybrown:"#F4A460",seagreen:"#2E8B57",seashell:"#FFF5EE",sienna:"#A0522D",silver:"#C0C0C0",skyblue:"#87CEEB",slateblue:"#6A5ACD",slategray:"#708090",slategrey:"#708090",snow:"#FFFAFA",springgreen:"#00FF7F",steelblue:"#4682B4",tan:"#D2B48C",teal:"#008080",thistle:"#D8BFD8",tomato:"#FF6347",turquoise:"#40E0D0",violet:"#EE82EE",wheat:"#F5DEB3",white:"#FFFFFF",whitesmoke:"#F5F5F5",yellow:"#FFFF00",yellowgreen:"#9ACD32"},_rgbaRegExp:/rgba?\(\s*\d+%?\s*,\s*\d+%?\s*,\s*\d+%?\s*(?:,\s*[0-9.]+\s*)?\)/gi,_hslaRegExp:/hsla?\(\s*[0-9.]+\s*,\s*\d+%\s*,\s*\d+%\s*(?:,\s*[0-9.]+\s*)?\)/gi,background:function(e){var t,n=[];return(t=this._findColor(e)).length&&(n.color=t[0],CKEDITOR.tools.array.forEach(t,function(t){e=e.replace(t,"")})),(e=CKEDITOR.tools.trim(e))&&(n.unprocessed=e),n},margin:function(e){function t(e){n.top=i[e[0]],n.right=i[e[1]],n.bottom=i[e[2]],n.left=i[e[3]]}var n={},i=e.match(/(?:\-?[\.\d]+(?:%|\w*)|auto|inherit|initial|unset)/g)||["0px"];switch(i.length){case 1:t([0,0,0,0]);break;case 2:t([0,1,0,1]);break;case 3:t([0,1,2,1]);break;case 4:t([0,1,2,3])}return n},_findColor:function(e){var t=[],n=CKEDITOR.tools.array;return(t=(t=t.concat(e.match(this._rgbaRegExp)||[])).concat(e.match(this._hslaRegExp)||[])).concat(n.filter(e.split(/\s+/),function(e){return!!e.match(/^\#[a-f0-9]{3}(?:[a-f0-9]{3})?$/gi)||e.toLowerCase()in CKEDITOR.tools.style.parse._colors}))}}},array:{filter:function(e,t,n){var i=[];return this.forEach(e,function(r,a){t.call(n,r,a,e)&&i.push(r)}),i},forEach:function(e,t,n){var i,r=e.length;for(i=0;i<r;i++)t.call(n,e[i],i,e)},map:function(e,t,n){for(var i=[],r=0;r<e.length;r++)i.push(t.call(n,e[r],r,e));return i},reduce:function(e,t,n,i){for(var r=0;r<e.length;r++)n=t.call(i,n,e[r],r,e);return n}}},CKEDITOR.tools.array.indexOf=CKEDITOR.tools.indexOf,CKEDITOR.tools.array.isArray=CKEDITOR.tools.isArray,CKEDITOR.dtd=function(){var e=CKEDITOR.tools.extend,t=function(e,t){for(var n=CKEDITOR.tools.clone(e),i=1;i<arguments.length;i++)for(var r in arguments[i])delete n[r];return n},n={},i={},r={address:1,article:1,aside:1,blockquote:1,details:1,div:1,dl:1,fieldset:1,figure:1,footer:1,form:1,h1:1,h2:1,h3:1,h4:1,h5:1,h6:1,header:1,hgroup:1,hr:1,main:1,menu:1,nav:1,ol:1,p:1,pre:1,section:1,table:1,ul:1},a={command:1,link:1,meta:1,noscript:1,script:1,style:1},o={},s={"#":1},l={center:1,dir:1,noframes:1};return e(n,{a:1,abbr:1,area:1,audio:1,b:1,bdi:1,bdo:1,br:1,button:1,canvas:1,cite:1,code:1,command:1,datalist:1,del:1,dfn:1,em:1,embed:1,i:1,iframe:1,img:1,input:1,ins:1,kbd:1,keygen:1,label:1,map:1,mark:1,meter:1,noscript:1,object:1,output:1,progress:1,q:1,ruby:1,s:1,samp:1,script:1,select:1,small:1,span:1,strong:1,sub:1,sup:1,textarea:1,time:1,u:1,var:1,video:1,wbr:1},s,{acronym:1,applet:1,basefont:1,big:1,font:1,isindex:1,strike:1,style:1,tt:1}),e(i,r,n,l),e(t={a:t(n,{a:1,button:1}),abbr:n,address:i,area:o,article:i,aside:i,audio:e({source:1,track:1},i),b:n,base:o,bdi:n,bdo:n,blockquote:i,body:i,br:o,button:t(n,{a:1,button:1}),canvas:n,caption:i,cite:n,code:n,col:o,colgroup:{col:1},command:o,datalist:e({option:1},n),dd:i,del:n,details:e({summary:1},i),dfn:n,div:i,dl:{dt:1,dd:1},dt:i,em:n,embed:o,fieldset:e({legend:1},i),figcaption:i,figure:e({figcaption:1},i),footer:i,form:i,h1:n,h2:n,h3:n,h4:n,h5:n,h6:n,head:e({title:1,base:1},a),header:i,hgroup:{h1:1,h2:1,h3:1,h4:1,h5:1,h6:1},hr:o,html:e({head:1,body:1},i,a),i:n,iframe:s,img:o,input:o,ins:n,kbd:n,keygen:o,label:n,legend:n,li:i,link:o,main:i,map:i,mark:n,menu:e({li:1},i),meta:o,meter:t(n,{meter:1}),nav:i,noscript:e({link:1,meta:1,style:1},n),object:e({param:1},n),ol:{li:1},optgroup:{option:1},option:s,output:n,p:n,param:o,pre:n,progress:t(n,{progress:1}),q:n,rp:n,rt:n,ruby:e({rp:1,rt:1},n),s:n,samp:n,script:s,section:i,select:{optgroup:1,option:1},small:n,source:o,span:n,strong:n,style:s,sub:n,summary:e({h1:1,h2:1,h3:1,h4:1,h5:1,h6:1},n),sup:n,table:{caption:1,colgroup:1,thead:1,tfoot:1,tbody:1,tr:1},tbody:{tr:1},td:i,textarea:s,tfoot:{tr:1},th:i,thead:{tr:1},time:t(n,{time:1}),title:s,tr:{th:1,td:1},track:o,u:n,ul:{li:1},var:n,video:e({source:1,track:1},i),wbr:o,acronym:n,applet:e({param:1},i),basefont:o,big:n,center:i,dialog:o,dir:{li:1},font:n,isindex:o,noframes:i,strike:n,tt:n},{$block:e({audio:1,dd:1,dt:1,figcaption:1,li:1,video:1},r,l),$blockLimit:{article:1,aside:1,audio:1,body:1,caption:1,details:1,dir:1,div:1,dl:1,fieldset:1,figcaption:1,figure:1,footer:1,form:1,header:1,hgroup:1,main:1,menu:1,nav:1,ol:1,section:1,table:1,td:1,th:1,tr:1,ul:1,video:1},$cdata:{script:1,style:1},$editable:{address:1,article:1,aside:1,blockquote:1,body:1,details:1,div:1,fieldset:1,figcaption:1,footer:1,form:1,h1:1,h2:1,h3:1,h4:1,h5:1,h6:1,header:1,hgroup:1,main:1,nav:1,p:1,pre:1,section:1},$empty:{area:1,base:1,basefont:1,br:1,col:1,command:1,dialog:1,embed:1,hr:1,img:1,input:1,isindex:1,keygen:1,link:1,meta:1,param:1,source:1,track:1,wbr:1},$inline:n,$list:{dl:1,ol:1,ul:1},$listItem:{dd:1,dt:1,li:1},$nonBodyContent:e({body:1,head:1,html:1},t.head),$nonEditable:{applet:1,audio:1,button:1,embed:1,iframe:1,map:1,object:1,option:1,param:1,script:1,textarea:1,video:1},$object:{applet:1,audio:1,button:1,hr:1,iframe:1,img:1,input:1,object:1,select:1,table:1,textarea:1,video:1},$removeEmpty:{abbr:1,acronym:1,b:1,bdi:1,bdo:1,big:1,cite:1,code:1,del:1,dfn:1,em:1,font:1,i:1,ins:1,label:1,kbd:1,mark:1,meter:1,output:1,q:1,ruby:1,s:1,samp:1,small:1,span:1,strike:1,strong:1,sub:1,sup:1,time:1,tt:1,u:1,var:1},$tabIndex:{a:1,area:1,button:1,input:1,object:1,select:1,textarea:1},$tableContent:{caption:1,col:1,colgroup:1,tbody:1,td:1,tfoot:1,th:1,thead:1,tr:1},$transparent:{a:1,audio:1,canvas:1,del:1,ins:1,map:1,noscript:1,object:1,video:1},$intermediate:{caption:1,colgroup:1,dd:1,dt:1,figcaption:1,legend:1,li:1,optgroup:1,option:1,rp:1,rt:1,summary:1,tbody:1,td:1,tfoot:1,th:1,thead:1,tr:1}}),t}(),CKEDITOR.dom.event=function(e){this.$=e},CKEDITOR.dom.event.prototype={getKey:function(){return this.$.keyCode||this.$.which},getKeystroke:function(){var e=this.getKey();return(this.$.ctrlKey||this.$.metaKey)&&(e+=CKEDITOR.CTRL),this.$.shiftKey&&(e+=CKEDITOR.SHIFT),this.$.altKey&&(e+=CKEDITOR.ALT),e},preventDefault:function(e){var t=this.$;t.preventDefault?t.preventDefault():t.returnValue=!1,e&&this.stopPropagation()},stopPropagation:function(){var e=this.$;e.stopPropagation?e.stopPropagation():e.cancelBubble=!0},getTarget:function(){var e=this.$.target||this.$.srcElement;return e?new CKEDITOR.dom.node(e):null},getPhase:function(){return this.$.eventPhase||2},getPageOffset:function(){var e=this.getTarget().getDocument().$;return{x:this.$.pageX||this.$.clientX+(e.documentElement.scrollLeft||e.body.scrollLeft),y:this.$.pageY||this.$.clientY+(e.documentElement.scrollTop||e.body.scrollTop)}}},CKEDITOR.CTRL=1114112,CKEDITOR.SHIFT=2228224,CKEDITOR.ALT=4456448,CKEDITOR.EVENT_PHASE_CAPTURING=1,CKEDITOR.EVENT_PHASE_AT_TARGET=2,CKEDITOR.EVENT_PHASE_BUBBLING=3,CKEDITOR.dom.domObject=function(e){e&&(this.$=e)},CKEDITOR.dom.domObject.prototype={getPrivate:function(){var e;return(e=this.getCustomData("_"))||this.setCustomData("_",e={}),e},on:function(e){var t=this.getCustomData("_cke_nativeListeners");return t||(t={},this.setCustomData("_cke_nativeListeners",t)),t[e]||(t=t[e]=function(e,t){return function(n){"undefined"!=typeof CKEDITOR&&e.fire(t,new CKEDITOR.dom.event(n))}}(this,e),this.$.addEventListener?this.$.addEventListener(e,t,!!CKEDITOR.event.useCapture):this.$.attachEvent&&this.$.attachEvent("on"+e,t)),CKEDITOR.event.prototype.on.apply(this,arguments)},removeListener:function(e){if(CKEDITOR.event.prototype.removeListener.apply(this,arguments),!this.hasListeners(e)){var t=this.getCustomData("_cke_nativeListeners"),n=t&&t[e];n&&(this.$.removeEventListener?this.$.removeEventListener(e,n,!1):this.$.detachEvent&&this.$.detachEvent("on"+e,n),delete t[e])}},removeAllListeners:function(){var e,t=this.getCustomData("_cke_nativeListeners");for(e in t){var n=t[e];this.$.detachEvent?this.$.detachEvent("on"+e,n):this.$.removeEventListener&&this.$.removeEventListener(e,n,!1),delete t[e]}CKEDITOR.event.prototype.removeAllListeners.call(this)}},function(e){var t={};CKEDITOR.on("reset",function(){t={}}),e.equals=function(e){try{return e&&e.$===this.$}catch(e){return!1}},e.setCustomData=function(e,n){var i=this.getUniqueId();return(t[i]||(t[i]={}))[e]=n,this},e.getCustomData=function(e){var n=this.$["data-cke-expando"];return(n=n&&t[n])&&e in n?n[e]:null},e.removeCustomData=function(e){var n,i,r;return(n=(n=this.$["data-cke-expando"])&&t[n])&&(i=n[e],r=e in n,delete n[e]),r?i:null},e.clearCustomData=function(){this.removeAllListeners();var e=this.$["data-cke-expando"];e&&delete t[e]},e.getUniqueId=function(){return this.$["data-cke-expando"]||(this.$["data-cke-expando"]=CKEDITOR.tools.getNextNumber())},CKEDITOR.event.implementOn(e)}(CKEDITOR.dom.domObject.prototype),CKEDITOR.dom.node=function(e){return e?new CKEDITOR.dom[e.nodeType==CKEDITOR.NODE_DOCUMENT?"document":e.nodeType==CKEDITOR.NODE_ELEMENT?"element":e.nodeType==CKEDITOR.NODE_TEXT?"text":e.nodeType==CKEDITOR.NODE_COMMENT?"comment":e.nodeType==CKEDITOR.NODE_DOCUMENT_FRAGMENT?"documentFragment":"domObject"](e):this},CKEDITOR.dom.node.prototype=new CKEDITOR.dom.domObject,CKEDITOR.NODE_ELEMENT=1,CKEDITOR.NODE_DOCUMENT=9,CKEDITOR.NODE_TEXT=3,CKEDITOR.NODE_COMMENT=8,CKEDITOR.NODE_DOCUMENT_FRAGMENT=11,CKEDITOR.POSITION_IDENTICAL=0,CKEDITOR.POSITION_DISCONNECTED=1,CKEDITOR.POSITION_FOLLOWING=2,CKEDITOR.POSITION_PRECEDING=4,CKEDITOR.POSITION_IS_CONTAINED=8,CKEDITOR.POSITION_CONTAINS=16,CKEDITOR.tools.extend(CKEDITOR.dom.node.prototype,{appendTo:function(e,t){return e.append(this,t),e},clone:function(e,t){var n=this.$.cloneNode(e);return function n(i){if(i["data-cke-expando"]&&(i["data-cke-expando"]=!1),(i.nodeType==CKEDITOR.NODE_ELEMENT||i.nodeType==CKEDITOR.NODE_DOCUMENT_FRAGMENT)&&(t||i.nodeType!=CKEDITOR.NODE_ELEMENT||i.removeAttribute("id",!1),e)){i=i.childNodes;for(var r=0;r<i.length;r++)n(i[r])}}(n),n=new CKEDITOR.dom.node(n),CKEDITOR.env.ie&&9>CKEDITOR.env.version&&(this.type==CKEDITOR.NODE_ELEMENT||this.type==CKEDITOR.NODE_DOCUMENT_FRAGMENT)&&function t(n){if(n.type==CKEDITOR.NODE_ELEMENT||n.type==CKEDITOR.NODE_DOCUMENT_FRAGMENT){if(n.type!=CKEDITOR.NODE_DOCUMENT_FRAGMENT){var i=n.getName();":"==i[0]&&n.renameNode(i.substring(1))}if(e)for(i=0;i<n.getChildCount();i++)t(n.getChild(i))}}(n),n},hasPrevious:function(){return!!this.$.previousSibling},hasNext:function(){return!!this.$.nextSibling},insertAfter:function(e){return e.$.parentNode.insertBefore(this.$,e.$.nextSibling),e},insertBefore:function(e){return e.$.parentNode.insertBefore(this.$,e.$),e},insertBeforeMe:function(e){return this.$.parentNode.insertBefore(e.$,this.$),e},getAddress:function(e){for(var t=[],n=this.getDocument().$.documentElement,i=this.$;i&&i!=n;){var r=i.parentNode;r&&t.unshift(this.getIndex.call({$:i},e)),i=r}return t},getDocument:function(){return new CKEDITOR.dom.document(this.$.ownerDocument||this.$.parentNode.ownerDocument)},getIndex:function(e){function t(e,i){var r=i?e.nextSibling:e.previousSibling;return r&&r.nodeType==CKEDITOR.NODE_TEXT?n(r)?t(r,i):r:null}function n(e){return!e.nodeValue||e.nodeValue==CKEDITOR.dom.selection.FILLING_CHAR_SEQUENCE}var i,r=this.$,a=-1;if(!this.$.parentNode||e&&r.nodeType==CKEDITOR.NODE_TEXT&&n(r)&&!t(r)&&!t(r,!0))return-1;do{e&&r!=this.$&&r.nodeType==CKEDITOR.NODE_TEXT&&(i||n(r))||(a++,i=r.nodeType==CKEDITOR.NODE_TEXT)}while(r=r.previousSibling);return a},getNextSourceNode:function(e,t,n){if(n&&!n.call){var i=n;n=function(e){return!e.equals(i)}}var r;if(!(e=!e&&this.getFirst&&this.getFirst())){if(this.type==CKEDITOR.NODE_ELEMENT&&n&&!1===n(this,!0))return null;e=this.getNext()}for(;!e&&(r=(r||this).getParent());){if(n&&!1===n(r,!0))return null;e=r.getNext()}return!e||n&&!1===n(e)?null:t&&t!=e.type?e.getNextSourceNode(!1,t,n):e},getPreviousSourceNode:function(e,t,n){if(n&&!n.call){var i=n;n=function(e){return!e.equals(i)}}var r;if(!(e=!e&&this.getLast&&this.getLast())){if(this.type==CKEDITOR.NODE_ELEMENT&&n&&!1===n(this,!0))return null;e=this.getPrevious()}for(;!e&&(r=(r||this).getParent());){if(n&&!1===n(r,!0))return null;e=r.getPrevious()}return!e||n&&!1===n(e)?null:t&&e.type!=t?e.getPreviousSourceNode(!1,t,n):e},getPrevious:function(e){var t,n=this.$;do{t=(n=n.previousSibling)&&10!=n.nodeType&&new CKEDITOR.dom.node(n)}while(t&&e&&!e(t));return t},getNext:function(e){var t,n=this.$;do{t=(n=n.nextSibling)&&new CKEDITOR.dom.node(n)}while(t&&e&&!e(t));return t},getParent:function(e){var t=this.$.parentNode;return t&&(t.nodeType==CKEDITOR.NODE_ELEMENT||e&&t.nodeType==CKEDITOR.NODE_DOCUMENT_FRAGMENT)?new CKEDITOR.dom.node(t):null},getParents:function(e){var t=this,n=[];do{n[e?"push":"unshift"](t)}while(t=t.getParent());return n},getCommonAncestor:function(e){if(e.equals(this))return this;if(e.contains&&e.contains(this))return e;var t=this.contains?this:this.getParent();do{if(t.contains(e))return t}while(t=t.getParent());return null},getPosition:function(e){var t=this.$,n=e.$;if(t.compareDocumentPosition)return t.compareDocumentPosition(n);if(t==n)return CKEDITOR.POSITION_IDENTICAL;if(this.type==CKEDITOR.NODE_ELEMENT&&e.type==CKEDITOR.NODE_ELEMENT){if(t.contains){if(t.contains(n))return CKEDITOR.POSITION_CONTAINS+CKEDITOR.POSITION_PRECEDING;if(n.contains(t))return CKEDITOR.POSITION_IS_CONTAINED+CKEDITOR.POSITION_FOLLOWING}if("sourceIndex"in t)return 0>t.sourceIndex||0>n.sourceIndex?CKEDITOR.POSITION_DISCONNECTED:t.sourceIndex<n.sourceIndex?CKEDITOR.POSITION_PRECEDING:CKEDITOR.POSITION_FOLLOWING}t=this.getAddress(),e=e.getAddress(),n=Math.min(t.length,e.length);for(var i=0;i<n;i++)if(t[i]!=e[i])return t[i]<e[i]?CKEDITOR.POSITION_PRECEDING:CKEDITOR.POSITION_FOLLOWING;return t.length<e.length?CKEDITOR.POSITION_CONTAINS+CKEDITOR.POSITION_PRECEDING:CKEDITOR.POSITION_IS_CONTAINED+CKEDITOR.POSITION_FOLLOWING},getAscendant:function(e,t){var n,i,r=this.$;for(t||(r=r.parentNode),"function"==typeof e?(i=!0,n=e):(i=!1,n=function(t){return t="string"==typeof t.nodeName?t.nodeName.toLowerCase():"","string"==typeof e?t==e:t in e});r;){if(n(i?new CKEDITOR.dom.node(r):r))return new CKEDITOR.dom.node(r);try{r=r.parentNode}catch(e){r=null}}return null},hasAscendant:function(e,t){var n=this.$;for(t||(n=n.parentNode);n;){if(n.nodeName&&n.nodeName.toLowerCase()==e)return!0;n=n.parentNode}return!1},move:function(e,t){e.append(this.remove(),t)},remove:function(e){var t=this.$,n=t.parentNode;if(n){if(e)for(;e=t.firstChild;)n.insertBefore(t.removeChild(e),t);n.removeChild(t)}return this},replace:function(e){this.insertBefore(e),e.remove()},trim:function(){this.ltrim(),this.rtrim()},ltrim:function(){for(var e;this.getFirst&&(e=this.getFirst());){if(e.type==CKEDITOR.NODE_TEXT){var t=CKEDITOR.tools.ltrim(e.getText()),n=e.getLength();if(!t){e.remove();continue}t.length<n&&(e.split(n-t.length),this.$.removeChild(this.$.firstChild))}break}},rtrim:function(){for(var e;this.getLast&&(e=this.getLast());){if(e.type==CKEDITOR.NODE_TEXT){var t=CKEDITOR.tools.rtrim(e.getText()),n=e.getLength();if(!t){e.remove();continue}t.length<n&&(e.split(t.length),this.$.lastChild.parentNode.removeChild(this.$.lastChild))}break}CKEDITOR.env.needsBrFiller&&(e=this.$.lastChild)&&1==e.type&&"br"==e.nodeName.toLowerCase()&&e.parentNode.removeChild(e)},isReadOnly:function(e){var t=this;if(this.type!=CKEDITOR.NODE_ELEMENT&&(t=this.getParent()),CKEDITOR.env.edge&&t&&t.is("textarea","input")&&(e=!0),!e&&t&&void 0!==t.$.isContentEditable)return!(t.$.isContentEditable||t.data("cke-editable"));for(;t;){if(t.data("cke-editable"))return!1;if(t.hasAttribute("contenteditable"))return"false"==t.getAttribute("contenteditable");t=t.getParent()}return!0}}),CKEDITOR.dom.window=function(e){CKEDITOR.dom.domObject.call(this,e)},CKEDITOR.dom.window.prototype=new CKEDITOR.dom.domObject,CKEDITOR.tools.extend(CKEDITOR.dom.window.prototype,{focus:function(){this.$.focus()},getViewPaneSize:function(){var e=this.$.document,t="CSS1Compat"==e.compatMode;return{width:(t?e.documentElement.clientWidth:e.body.clientWidth)||0,height:(t?e.documentElement.clientHeight:e.body.clientHeight)||0}},getScrollPosition:function(){var e=this.$;return"pageXOffset"in e?{x:e.pageXOffset||0,y:e.pageYOffset||0}:{x:(e=e.document).documentElement.scrollLeft||e.body.scrollLeft||0,y:e.documentElement.scrollTop||e.body.scrollTop||0}},getFrame:function(){var e=this.$.frameElement;return e?new CKEDITOR.dom.element.get(e):null}}),CKEDITOR.dom.document=function(e){CKEDITOR.dom.domObject.call(this,e)},CKEDITOR.dom.document.prototype=new CKEDITOR.dom.domObject,CKEDITOR.tools.extend(CKEDITOR.dom.document.prototype,{type:CKEDITOR.NODE_DOCUMENT,appendStyleSheet:function(e){if(this.$.createStyleSheet)this.$.createStyleSheet(e);else{var t=new CKEDITOR.dom.element("link");t.setAttributes({rel:"stylesheet",type:"text/css",href:e}),this.getHead().append(t)}},appendStyleText:function(e){if(this.$.createStyleSheet){var t=this.$.createStyleSheet("");t.cssText=e}else{var n=new CKEDITOR.dom.element("style",this);n.append(new CKEDITOR.dom.text(e,this)),this.getHead().append(n)}return t||n.$.sheet},createElement:function(e,t){var n=new CKEDITOR.dom.element(e,this);return t&&(t.attributes&&n.setAttributes(t.attributes),t.styles&&n.setStyles(t.styles)),n},createText:function(e){return new CKEDITOR.dom.text(e,this)},focus:function(){this.getWindow().focus()},getActive:function(){var e;try{e=this.$.activeElement}catch(e){return null}return new CKEDITOR.dom.element(e)},getById:function(e){return(e=this.$.getElementById(e))?new CKEDITOR.dom.element(e):null},getByAddress:function(e,t){for(var n=this.$.documentElement,i=0;n&&i<e.length;i++){var r=e[i];if(t)for(var a=-1,o=0;o<n.childNodes.length;o++){var s=n.childNodes[o];if((!0!==t||3!=s.nodeType||!s.previousSibling||3!=s.previousSibling.nodeType)&&++a==r){n=s;break}}else n=n.childNodes[r]}return n?new CKEDITOR.dom.node(n):null},getElementsByTag:function(e,t){return CKEDITOR.env.ie&&8>=document.documentMode||!t||(e=t+":"+e),new CKEDITOR.dom.nodeList(this.$.getElementsByTagName(e))},getHead:function(){var e=this.$.getElementsByTagName("head")[0];return e?new CKEDITOR.dom.element(e):this.getDocumentElement().append(new CKEDITOR.dom.element("head"),!0)},getBody:function(){return new CKEDITOR.dom.element(this.$.body)},getDocumentElement:function(){return new CKEDITOR.dom.element(this.$.documentElement)},getWindow:function(){return new CKEDITOR.dom.window(this.$.parentWindow||this.$.defaultView)},write:function(e){this.$.open("text/html","replace"),CKEDITOR.env.ie&&(e=e.replace(/(?:^\s*<!DOCTYPE[^>]*?>)|^/i,'$&\n<script data-cke-temp="1">('+CKEDITOR.tools.fixDomain+")();<\/script>")),this.$.write(e),this.$.close()},find:function(e){return new CKEDITOR.dom.nodeList(this.$.querySelectorAll(e))},findOne:function(e){return(e=this.$.querySelector(e))?new CKEDITOR.dom.element(e):null},_getHtml5ShivFrag:function(){var e=this.getCustomData("html5ShivFrag");return e||(e=this.$.createDocumentFragment(),CKEDITOR.tools.enableHtml5Elements(e,!0),this.setCustomData("html5ShivFrag",e)),e}}),CKEDITOR.dom.nodeList=function(e){this.$=e},CKEDITOR.dom.nodeList.prototype={count:function(){return this.$.length},getItem:function(e){return 0>e||e>=this.$.length?null:(e=this.$[e])?new CKEDITOR.dom.node(e):null}},CKEDITOR.dom.element=function(e,t){"string"==typeof e&&(e=(t?t.$:document).createElement(e)),CKEDITOR.dom.domObject.call(this,e)},CKEDITOR.dom.element.get=function(e){return(e="string"==typeof e?document.getElementById(e)||document.getElementsByName(e)[0]:e)&&(e.$?e:new CKEDITOR.dom.element(e))},CKEDITOR.dom.element.prototype=new CKEDITOR.dom.node,CKEDITOR.dom.element.createFromHtml=function(e,t){var n=new CKEDITOR.dom.element("div",t);return n.setHtml(e),n.getFirst().remove()},CKEDITOR.dom.element.setMarker=function(e,t,n,i){var r=t.getCustomData("list_marker_id")||t.setCustomData("list_marker_id",CKEDITOR.tools.getNextNumber()).getCustomData("list_marker_id"),a=t.getCustomData("list_marker_names")||t.setCustomData("list_marker_names",{}).getCustomData("list_marker_names");return e[r]=t,a[n]=1,t.setCustomData(n,i)},CKEDITOR.dom.element.clearAllMarkers=function(e){for(var t in e)CKEDITOR.dom.element.clearMarkers(e,e[t],1)},CKEDITOR.dom.element.clearMarkers=function(e,t,n){var i,r=t.getCustomData("list_marker_names"),a=t.getCustomData("list_marker_id");for(i in r)t.removeCustomData(i);t.removeCustomData("list_marker_names"),n&&(t.removeCustomData("list_marker_id"),delete e[a])},function(){function e(e,t){return-1<(" "+e+" ").replace(a," ").indexOf(" "+t+" ")}function t(e){var t=!0;return e.$.id||(e.$.id="cke_tmp_"+CKEDITOR.tools.getNextNumber(),t=!1),function(){t||e.removeAttribute("id")}}function n(e,t){var n=CKEDITOR.tools.escapeCss(e.$.id);return"#"+n+" "+t.split(/,\s*/).join(", #"+n+" ")}function i(e){for(var t=0,n=0,i=o[e].length;n<i;n++)t+=parseFloat(this.getComputedStyle(o[e][n])||0,10)||0;return t}var r=void 0!==(r=document.createElement("_").classList)&&null!==String(r.add).match(/\[Native code\]/gi),a=/[\n\t\r]/g;CKEDITOR.tools.extend(CKEDITOR.dom.element.prototype,{type:CKEDITOR.NODE_ELEMENT,addClass:r?function(e){return this.$.classList.add(e),this}:function(t){var n=this.$.className;return n&&(e(n,t)||(n+=" "+t)),this.$.className=n||t,this},removeClass:r?function(e){var t=this.$;return t.classList.remove(e),t.className||t.removeAttribute("class"),this}:function(t){var n=this.getAttribute("class");return n&&e(n,t)&&((n=n.replace(new RegExp("(?:^|\\s+)"+t+"(?=\\s|$)"),"").replace(/^\s+/,""))?this.setAttribute("class",n):this.removeAttribute("class")),this},hasClass:function(t){return e(this.$.className,t)},append:function(e,t){return"string"==typeof e&&(e=this.getDocument().createElement(e)),t?this.$.insertBefore(e.$,this.$.firstChild):this.$.appendChild(e.$),e},appendHtml:function(e){if(this.$.childNodes.length){var t=new CKEDITOR.dom.element("div",this.getDocument());t.setHtml(e),t.moveChildren(this)}else this.setHtml(e)},appendText:function(e){null!=this.$.text&&CKEDITOR.env.ie&&9>CKEDITOR.env.version?this.$.text+=e:this.append(new CKEDITOR.dom.text(e))},appendBogus:function(e){if(e||CKEDITOR.env.needsBrFiller){for(e=this.getLast();e&&e.type==CKEDITOR.NODE_TEXT&&!CKEDITOR.tools.rtrim(e.getText());)e=e.getPrevious();e&&e.is&&e.is("br")||(e=this.getDocument().createElement("br"),CKEDITOR.env.gecko&&e.setAttribute("type","_moz"),this.append(e))}},breakParent:function(e,t){var n=new CKEDITOR.dom.range(this.getDocument());n.setStartAfter(this),n.setEndAfter(e);var i,r=n.extractContents(!1,t||!1);if(n.insertNode(this.remove()),CKEDITOR.env.ie&&!CKEDITOR.env.edge){for(n=new CKEDITOR.dom.element("div");i=r.getFirst();)i.$.style.backgroundColor&&(i.$.style.backgroundColor=i.$.style.backgroundColor),n.append(i);n.insertAfter(this),n.remove(!0)}else r.insertAfterNode(this)},contains:document.compareDocumentPosition?function(e){return!!(16&this.$.compareDocumentPosition(e.$))}:function(e){var t=this.$;return e.type!=CKEDITOR.NODE_ELEMENT?t.contains(e.getParent().$):t!=e.$&&t.contains(e.$)},focus:function(){function e(){try{this.$.focus()}catch(e){}}return function(t){t?CKEDITOR.tools.setTimeout(e,100,this):e.call(this)}}(),getHtml:function(){var e=this.$.innerHTML;return CKEDITOR.env.ie?e.replace(/<\?[^>]*>/g,""):e},getOuterHtml:function(){if(this.$.outerHTML)return this.$.outerHTML.replace(/<\?[^>]*>/,"");var e=this.$.ownerDocument.createElement("div");return e.appendChild(this.$.cloneNode(!0)),e.innerHTML},getClientRect:function(){var e=CKEDITOR.tools.extend({},this.$.getBoundingClientRect());return!e.width&&(e.width=e.right-e.left),!e.height&&(e.height=e.bottom-e.top),e},setHtml:CKEDITOR.env.ie&&9>CKEDITOR.env.version?function(e){try{var t=this.$;if(this.getParent())return t.innerHTML=e;var n=this.getDocument()._getHtml5ShivFrag();return n.appendChild(t),t.innerHTML=e,n.removeChild(t),e}catch(n){for(this.$.innerHTML="",(t=new CKEDITOR.dom.element("body",this.getDocument())).$.innerHTML=e,t=t.getChildren();t.count();)this.append(t.getItem(0));return e}}:function(e){return this.$.innerHTML=e},setText:function(){var e=document.createElement("p");return e.innerHTML="x",e=e.textContent,function(t){this.$[e?"textContent":"innerText"]=t}}(),getAttribute:CKEDITOR.env.ie&&(CKEDITOR.env.ie7Compat||CKEDITOR.env.quirks)?function(e){switch(e){case"class":e="className";break;case"http-equiv":e="httpEquiv";break;case"name":return this.$.name;case"tabindex":return 0!==(e=this.$.getAttribute(e,2))&&0===this.$.tabIndex&&(e=null),e;case"checked":return((e=this.$.attributes.getNamedItem(e)).specified?e.nodeValue:this.$.checked)?"checked":null;case"hspace":case"value":return this.$[e];case"style":return this.$.style.cssText;case"contenteditable":case"contentEditable":return this.$.attributes.getNamedItem("contentEditable").specified?this.$.getAttribute("contentEditable"):null}return this.$.getAttribute(e,2)}:function(e){return this.$.getAttribute(e,2)},getAttributes:function(e){var t,n={},i=this.$.attributes;for(e=CKEDITOR.tools.isArray(e)?e:[],t=0;t<i.length;t++)-1===CKEDITOR.tools.indexOf(e,i[t].name)&&(n[i[t].name]=i[t].value);return n},getChildren:function(){return new CKEDITOR.dom.nodeList(this.$.childNodes)},getComputedStyle:document.defaultView&&document.defaultView.getComputedStyle?function(e){var t=this.getWindow().$.getComputedStyle(this.$,null);return t?t.getPropertyValue(e):""}:function(e){return this.$.currentStyle[CKEDITOR.tools.cssStyleToDomStyle(e)]},getDtd:function(){var e=CKEDITOR.dtd[this.getName()];return this.getDtd=function(){return e},e},getElementsByTag:CKEDITOR.dom.document.prototype.getElementsByTag,getTabIndex:function(){var e=this.$.tabIndex;return 0!==e||CKEDITOR.dtd.$tabIndex[this.getName()]||0===parseInt(this.getAttribute("tabindex"),10)?e:-1},getText:function(){return this.$.textContent||this.$.innerText||""},getWindow:function(){return this.getDocument().getWindow()},getId:function(){return this.$.id||null},getNameAtt:function(){return this.$.name||null},getName:function(){var e=this.$.nodeName.toLowerCase();if(CKEDITOR.env.ie&&8>=document.documentMode){var t=this.$.scopeName;"HTML"!=t&&(e=t.toLowerCase()+":"+e)}return this.getName=function(){return e},this.getName()},getValue:function(){return this.$.value},getFirst:function(e){var t=this.$.firstChild;return(t=t&&new CKEDITOR.dom.node(t))&&e&&!e(t)&&(t=t.getNext(e)),t},getLast:function(e){var t=this.$.lastChild;return(t=t&&new CKEDITOR.dom.node(t))&&e&&!e(t)&&(t=t.getPrevious(e)),t},getStyle:function(e){return this.$.style[CKEDITOR.tools.cssStyleToDomStyle(e)]},is:function(){var e=this.getName();if("object"==typeof arguments[0])return!!arguments[0][e];for(var t=0;t<arguments.length;t++)if(arguments[t]==e)return!0;return!1},isEditable:function(e){var t=this.getName();return!(this.isReadOnly()||"none"==this.getComputedStyle("display")||"hidden"==this.getComputedStyle("visibility")||CKEDITOR.dtd.$nonEditable[t]||CKEDITOR.dtd.$empty[t]||this.is("a")&&(this.data("cke-saved-name")||this.hasAttribute("name"))&&!this.getChildCount()||!1!==e&&(!(e=CKEDITOR.dtd[t]||CKEDITOR.dtd.span)||!e["#"]))},isIdentical:function(e){var t=this.clone(0,1);if(e=e.clone(0,1),t.removeAttributes(["_moz_dirty","data-cke-expando","data-cke-saved-href","data-cke-saved-name"]),e.removeAttributes(["_moz_dirty","data-cke-expando","data-cke-saved-href","data-cke-saved-name"]),t.$.isEqualNode)return t.$.style.cssText=CKEDITOR.tools.normalizeCssText(t.$.style.cssText),e.$.style.cssText=CKEDITOR.tools.normalizeCssText(e.$.style.cssText),t.$.isEqualNode(e.$);if(t=t.getOuterHtml(),e=e.getOuterHtml(),CKEDITOR.env.ie&&9>CKEDITOR.env.version&&this.is("a")){var n=this.getParent();n.type==CKEDITOR.NODE_ELEMENT&&((n=n.clone()).setHtml(t),t=n.getHtml(),n.setHtml(e),e=n.getHtml())}return t==e},isVisible:function(){var e,t,n=(this.$.offsetHeight||this.$.offsetWidth)&&"hidden"!=this.getComputedStyle("visibility");return n&&CKEDITOR.env.webkit&&!(e=this.getWindow()).equals(CKEDITOR.document.getWindow())&&(t=e.$.frameElement)&&(n=new CKEDITOR.dom.element(t).isVisible()),!!n},isEmptyInlineRemoveable:function(){if(!CKEDITOR.dtd.$removeEmpty[this.getName()])return!1;for(var e=this.getChildren(),t=0,n=e.count();t<n;t++){var i=e.getItem(t);if((i.type!=CKEDITOR.NODE_ELEMENT||!i.data("cke-bookmark"))&&(i.type==CKEDITOR.NODE_ELEMENT&&!i.isEmptyInlineRemoveable()||i.type==CKEDITOR.NODE_TEXT&&CKEDITOR.tools.trim(i.getText())))return!1}return!0},hasAttributes:CKEDITOR.env.ie&&(CKEDITOR.env.ie7Compat||CKEDITOR.env.quirks)?function(){for(var e=this.$.attributes,t=0;t<e.length;t++){var n=e[t];switch(n.nodeName){case"class":if(this.getAttribute("class"))return!0;case"data-cke-expando":continue;default:if(n.specified)return!0}}return!1}:function(){var e=this.$.attributes,t=e.length,n={"data-cke-expando":1,_moz_dirty:1};return 0<t&&(2<t||!n[e[0].nodeName]||2==t&&!n[e[1].nodeName])},hasAttribute:function(){function e(e){var t=this.$.attributes.getNamedItem(e);if("input"==this.getName())switch(e){case"class":return 0<this.$.className.length;case"checked":return!!this.$.checked;case"value":return"checkbox"==(e=this.getAttribute("type"))||"radio"==e?"on"!=this.$.value:!!this.$.value}return!!t&&t.specified}return CKEDITOR.env.ie?8>CKEDITOR.env.version?function(t){return"name"==t?!!this.$.name:e.call(this,t)}:e:function(e){return!!this.$.attributes.getNamedItem(e)}}(),hide:function(){this.setStyle("display","none")},moveChildren:function(e,t){var n,i=this.$;if(i!=(e=e.$))if(t)for(;n=i.lastChild;)e.insertBefore(i.removeChild(n),e.firstChild);else for(;n=i.firstChild;)e.appendChild(i.removeChild(n))},mergeSiblings:function(){function e(e,t,n){if(t&&t.type==CKEDITOR.NODE_ELEMENT){for(var i=[];t.data("cke-bookmark")||t.isEmptyInlineRemoveable();)if(i.push(t),!(t=n?t.getNext():t.getPrevious())||t.type!=CKEDITOR.NODE_ELEMENT)return;if(e.isIdentical(t)){for(var r=n?e.getLast():e.getFirst();i.length;)i.shift().move(e,!n);t.moveChildren(e,!n),t.remove(),r&&r.type==CKEDITOR.NODE_ELEMENT&&r.mergeSiblings()}}}return function(t){(!1===t||CKEDITOR.dtd.$removeEmpty[this.getName()]||this.is("a"))&&(e(this,this.getNext(),!0),e(this,this.getPrevious()))}}(),show:function(){this.setStyles({display:"",visibility:""})},setAttribute:function(){var e=function(e,t){return this.$.setAttribute(e,t),this};return CKEDITOR.env.ie&&(CKEDITOR.env.ie7Compat||CKEDITOR.env.quirks)?function(t,n){return"class"==t?this.$.className=n:"style"==t?this.$.style.cssText=n:"tabindex"==t?this.$.tabIndex=n:"checked"==t?this.$.checked=n:"contenteditable"==t?e.call(this,"contentEditable",n):e.apply(this,arguments),this}:CKEDITOR.env.ie8Compat&&CKEDITOR.env.secure?function(t,n){if("src"==t&&n.match(/^http:\/\//))try{e.apply(this,arguments)}catch(e){}else e.apply(this,arguments);return this}:e}(),setAttributes:function(e){for(var t in e)this.setAttribute(t,e[t]);return this},setValue:function(e){return this.$.value=e,this},removeAttribute:CKEDITOR.env.ie&&(CKEDITOR.env.ie7Compat||CKEDITOR.env.quirks)?function(e){"class"==e?e="className":"tabindex"==e?e="tabIndex":"contenteditable"==e&&(e="contentEditable"),this.$.removeAttribute(e)}:function(e){this.$.removeAttribute(e)},removeAttributes:function(e){if(CKEDITOR.tools.isArray(e))for(var t=0;t<e.length;t++)this.removeAttribute(e[t]);else for(t in e=e||this.getAttributes())e.hasOwnProperty(t)&&this.removeAttribute(t)},removeStyle:function(e){if((i=this.$.style).removeProperty||"border"!=e&&"margin"!=e&&"padding"!=e)i.removeProperty?i.removeProperty(e):i.removeAttribute(CKEDITOR.tools.cssStyleToDomStyle(e)),this.$.style.cssText||this.removeAttribute("style");else{var t,n=["top","left","right","bottom"];"border"==e&&(t=["color","style","width"]);for(var i=[],r=0;r<n.length;r++)if(t)for(var a=0;a<t.length;a++)i.push([e,n[r],t[a]].join("-"));else i.push([e,n[r]].join("-"));for(e=0;e<i.length;e++)this.removeStyle(i[e])}},setStyle:function(e,t){return this.$.style[CKEDITOR.tools.cssStyleToDomStyle(e)]=t,this},setStyles:function(e){for(var t in e)this.setStyle(t,e[t]);return this},setOpacity:function(e){CKEDITOR.env.ie&&9>CKEDITOR.env.version?(e=Math.round(100*e),this.setStyle("filter",100<=e?"":"progid:DXImageTransform.Microsoft.Alpha(opacity="+e+")")):this.setStyle("opacity",e)},unselectable:function(){if(this.setStyles(CKEDITOR.tools.cssVendorPrefix("user-select","none")),CKEDITOR.env.ie){this.setAttribute("unselectable","on");for(var e=this.getElementsByTag("*"),t=0,n=e.count();t<n;t++)e.getItem(t).setAttribute("unselectable","on")}},getPositionedAncestor:function(){for(var e=this;"html"!=e.getName();){if("static"!=e.getComputedStyle("position"))return e;e=e.getParent()}return null},getDocumentPosition:function(e){var t=0,n=0,i=this.getDocument(),r=i.getBody(),a="BackCompat"==i.$.compatMode;if(!document.documentElement.getBoundingClientRect||CKEDITOR.env.ie&&8===CKEDITOR.env.version)for(l=this,u=null;l&&"body"!=l.getName()&&"html"!=l.getName();){for(t+=l.$.offsetLeft-l.$.scrollLeft,n+=l.$.offsetTop-l.$.scrollTop,l.equals(this)||(t+=l.$.clientLeft||0,n+=l.$.clientTop||0);u&&!u.equals(l);)t-=u.$.scrollLeft,n-=u.$.scrollTop,u=u.getParent();u=l,l=(o=l.$.offsetParent)?new CKEDITOR.dom.element(o):null}else{var o=this.$.getBoundingClientRect(),s=i.$.documentElement,l=s.clientTop||r.$.clientTop||0,u=s.clientLeft||r.$.clientLeft||0,c=!0;CKEDITOR.env.ie&&(c=i.getDocumentElement().contains(this),i=i.getBody().contains(this),c=a&&i||!a&&c),c&&(CKEDITOR.env.webkit||CKEDITOR.env.ie&&12<=CKEDITOR.env.version?(t=r.$.scrollLeft||s.scrollLeft,n=r.$.scrollTop||s.scrollTop):(t=(n=a?r.$:s).scrollLeft,n=n.scrollTop),t=o.left+t-u,n=o.top+n-l)}return e&&(o=this.getWindow(),l=e.getWindow(),!o.equals(l)&&o.$.frameElement&&(t+=(e=new CKEDITOR.dom.element(o.$.frameElement).getDocumentPosition(e)).x,n+=e.y)),document.documentElement.getBoundingClientRect||!CKEDITOR.env.gecko||a||(t+=this.$.clientLeft?1:0,n+=this.$.clientTop?1:0),{x:t,y:n}},scrollIntoView:function(e){var t=this.getParent();if(t)do{if((t.$.clientWidth&&t.$.clientWidth<t.$.scrollWidth||t.$.clientHeight&&t.$.clientHeight<t.$.scrollHeight)&&!t.is("body")&&this.scrollIntoParent(t,e,1),t.is("html")){var n=t.getWindow();try{var i=n.$.frameElement;i&&(t=new CKEDITOR.dom.element(i))}catch(e){}}}while(t=t.getParent())},scrollIntoParent:function(e,t,n){var i,r,a,o;function s(t,n){/body|html/.test(e.getName())?e.getWindow().$.scrollBy(t,n):(e.$.scrollLeft+=t,e.$.scrollTop+=n)}function l(e,t){var n={x:0,y:0};if(!e.is(c?"body":"html")){var i=e.$.getBoundingClientRect();n.x=i.left,n.y=i.top}return(i=e.getWindow()).equals(t)||(i=l(CKEDITOR.dom.element.get(i.$.frameElement),t),n.x+=i.x,n.y+=i.y),n}function u(e,t){return parseInt(e.getComputedStyle("margin-"+t)||0,10)||0}!e&&(e=this.getWindow());var c="BackCompat"==(a=e.getDocument()).$.compatMode;e instanceof CKEDITOR.dom.window&&(e=c?a.getBody():a.getDocumentElement()),CKEDITOR.env.webkit&&(a=this.getEditor(!1))&&(a._.previousScrollTop=null),r=l(this,a=e.getWindow());var d=l(e,a),h=this.$.offsetHeight;i=this.$.offsetWidth;var p=e.$.clientHeight,f=e.$.clientWidth;a=r.x-u(this,"left")-d.x||0,o=r.y-u(this,"top")-d.y||0,i=r.x+i+u(this,"right")-(d.x+f)||0,r=r.y+h+u(this,"bottom")-(d.y+p)||0,(0>o||0<r)&&s(0,!0===t?o:!1===t?r:0>o?o:r),n&&(0>a||0<i)&&s(0>a?a:i,0)},setState:function(e,t,n){switch(t=t||"cke",e){case CKEDITOR.TRISTATE_ON:this.addClass(t+"_on"),this.removeClass(t+"_off"),this.removeClass(t+"_disabled"),n&&this.setAttribute("aria-pressed",!0),n&&this.removeAttribute("aria-disabled");break;case CKEDITOR.TRISTATE_DISABLED:this.addClass(t+"_disabled"),this.removeClass(t+"_off"),this.removeClass(t+"_on"),n&&this.setAttribute("aria-disabled",!0),n&&this.removeAttribute("aria-pressed");break;default:this.addClass(t+"_off"),this.removeClass(t+"_on"),this.removeClass(t+"_disabled"),n&&this.removeAttribute("aria-pressed"),n&&this.removeAttribute("aria-disabled")}},getFrameDocument:function(){var e=this.$;try{e.contentWindow.document}catch(t){e.src=e.src}return e&&new CKEDITOR.dom.document(e.contentWindow.document)},copyAttributes:function(e,t){var n=this.$.attributes;t=t||{};for(var i=0;i<n.length;i++){var r,a=n[i],o=a.nodeName.toLowerCase();o in t||("checked"==o&&(r=this.getAttribute(o))?e.setAttribute(o,r):CKEDITOR.env.ie&&!this.hasAttribute(o)||(null===(r=this.getAttribute(o))&&(r=a.nodeValue),e.setAttribute(o,r)))}""!==this.$.style.cssText&&(e.$.style.cssText=this.$.style.cssText)},renameNode:function(e){if(this.getName()!=e){var t=this.getDocument();e=new CKEDITOR.dom.element(e,t),this.copyAttributes(e),this.moveChildren(e),this.getParent(!0)&&this.$.parentNode.replaceChild(e.$,this.$),e.$["data-cke-expando"]=this.$["data-cke-expando"],this.$=e.$,delete this.getName}},getChild:function(){function e(e,t){var n=e.childNodes;if(0<=t&&t<n.length)return n[t]}return function(t){var n=this.$;if(t.slice)for(t=t.slice();0<t.length&&n;)n=e(n,t.shift());else n=e(n,t);return n?new CKEDITOR.dom.node(n):null}}(),getChildCount:function(){return this.$.childNodes.length},disableContextMenu:function(){function e(e){return e.type==CKEDITOR.NODE_ELEMENT&&e.hasClass("cke_enable_context_menu")}this.on("contextmenu",function(t){t.data.getTarget().getAscendant(e,!0)||t.data.preventDefault()})},getDirection:function(e){return e?this.getComputedStyle("direction")||this.getDirection()||this.getParent()&&this.getParent().getDirection(1)||this.getDocument().$.dir||"ltr":this.getStyle("direction")||this.getAttribute("dir")},data:function(e,t){return e="data-"+e,void 0===t?this.getAttribute(e):(!1===t?this.removeAttribute(e):this.setAttribute(e,t),null)},getEditor:function(e){var t,n,i,r=CKEDITOR.instances;for(t in e=e||void 0===e,r)if((n=r[t]).element.equals(this)&&n.elementMode!=CKEDITOR.ELEMENT_MODE_APPENDTO||!e&&(i=n.editable())&&(i.equals(this)||i.contains(this)))return n;return null},find:function(e){var i=t(this);return e=new CKEDITOR.dom.nodeList(this.$.querySelectorAll(n(this,e))),i(),e},findOne:function(e){var i=t(this);return e=this.$.querySelector(n(this,e)),i(),e?new CKEDITOR.dom.element(e):null},forEach:function(e,t,n){if(!(n||t&&this.type!=t))var i=e(this);if(!1!==i){n=this.getChildren();for(var r=0;r<n.count();r++)(i=n.getItem(r)).type==CKEDITOR.NODE_ELEMENT?i.forEach(e,t):t&&i.type!=t||e(i)}}});var o={width:["border-left-width","border-right-width","padding-left","padding-right"],height:["border-top-width","border-bottom-width","padding-top","padding-bottom"]};CKEDITOR.dom.element.prototype.setSize=function(e,t,n){"number"==typeof t&&(!n||CKEDITOR.env.ie&&CKEDITOR.env.quirks||(t-=i.call(this,e)),this.setStyle(e,t+"px"))},CKEDITOR.dom.element.prototype.getSize=function(e,t){var n=Math.max(this.$["offset"+CKEDITOR.tools.capitalize(e)],this.$["client"+CKEDITOR.tools.capitalize(e)])||0;return t&&(n-=i.call(this,e)),n}}(),CKEDITOR.dom.documentFragment=function(e){e=e||CKEDITOR.document,this.$=e.type==CKEDITOR.NODE_DOCUMENT?e.$.createDocumentFragment():e},CKEDITOR.tools.extend(CKEDITOR.dom.documentFragment.prototype,CKEDITOR.dom.element.prototype,{type:CKEDITOR.NODE_DOCUMENT_FRAGMENT,insertAfterNode:function(e){(e=e.$).parentNode.insertBefore(this.$,e.nextSibling)},getHtml:function(){var e=new CKEDITOR.dom.element("div");return this.clone(1,1).appendTo(e),e.getHtml().replace(/\s*data-cke-expando=".*?"/g,"")}},!0,{append:1,appendBogus:1,clone:1,getFirst:1,getHtml:1,getLast:1,getParent:1,getNext:1,getPrevious:1,appendTo:1,moveChildren:1,insertBefore:1,insertAfterNode:1,replace:1,trim:1,type:1,ltrim:1,rtrim:1,getDocument:1,getChildCount:1,getChild:1,getChildren:1}),function(){function e(e,t){var n=this.range;if(this._.end)return null;if(!this._.start){if(this._.start=1,n.collapsed)return this.end(),null;n.optimize()}var i,r=n.startContainer;i=n.endContainer;var a,o=n.startOffset,s=n.endOffset,l=this.guard,u=this.type,c=e?"getPreviousSourceNode":"getNextSourceNode";if(!e&&!this._.guardLTR){var d=i.type==CKEDITOR.NODE_ELEMENT?i:i.getParent(),h=i.type==CKEDITOR.NODE_ELEMENT?i.getChild(s):i.getNext();this._.guardLTR=function(e,t){return!(t&&d.equals(e)||h&&e.equals(h)||e.type==CKEDITOR.NODE_ELEMENT&&t&&e.equals(n.root))}}if(e&&!this._.guardRTL){var p=r.type==CKEDITOR.NODE_ELEMENT?r:r.getParent(),f=r.type==CKEDITOR.NODE_ELEMENT?o?r.getChild(o-1):null:r.getPrevious();this._.guardRTL=function(e,t){return!(t&&p.equals(e)||f&&e.equals(f)||e.type==CKEDITOR.NODE_ELEMENT&&t&&e.equals(n.root))}}var g=e?this._.guardRTL:this._.guardLTR;for(a=l?function(e,t){return!1!==g(e,t)&&l(e,t)}:g,this.current?i=this.current[c](!1,u,a):(e?i.type==CKEDITOR.NODE_ELEMENT&&(i=0<s?i.getChild(s-1):!1===a(i,!0)?null:i.getPreviousSourceNode(!0,u,a)):(i=r).type==CKEDITOR.NODE_ELEMENT&&((i=i.getChild(o))||(i=!1===a(r,!0)?null:r.getNextSourceNode(!0,u,a))),i&&!1===a(i)&&(i=null));i&&!this._.end;){if(this.current=i,this.evaluator&&!1===this.evaluator(i)){if(t&&this.evaluator)return!1}else if(!t)return i;i=i[c](!1,u,a)}return this.end(),this.current=null}function t(t){for(var n,i=null;n=e.call(this,t);)i=n;return i}CKEDITOR.dom.walker=CKEDITOR.tools.createClass({$:function(e){this.range=e,this._={}},proto:{end:function(){this._.end=1},next:function(){return e.call(this)},previous:function(){return e.call(this,1)},checkForward:function(){return!1!==e.call(this,0,1)},checkBackward:function(){return!1!==e.call(this,1,1)},lastForward:function(){return t.call(this)},lastBackward:function(){return t.call(this,1)},reset:function(){delete this.current,this._={}}}});var n={block:1,"list-item":1,table:1,"table-row-group":1,"table-header-group":1,"table-footer-group":1,"table-row":1,"table-column-group":1,"table-column":1,"table-cell":1,"table-caption":1},i={absolute:1,fixed:1};CKEDITOR.dom.element.prototype.isBlockBoundary=function(e){return!("none"!=this.getComputedStyle("float")||this.getComputedStyle("position")in i||!n[this.getComputedStyle("display")])||!!(this.is(CKEDITOR.dtd.$block)||e&&this.is(e))},CKEDITOR.dom.walker.blockBoundary=function(e){return function(t){return!(t.type==CKEDITOR.NODE_ELEMENT&&t.isBlockBoundary(e))}},CKEDITOR.dom.walker.listItemBoundary=function(){return this.blockBoundary({br:1})},CKEDITOR.dom.walker.bookmark=function(e,t){function n(e){return e&&e.getName&&"span"==e.getName()&&e.data("cke-bookmark")}return function(i){var r,a;return r=i&&i.type!=CKEDITOR.NODE_ELEMENT&&(a=i.getParent())&&n(a),r=e?r:r||n(i),!!(t^r)}},CKEDITOR.dom.walker.whitespaces=function(e){return function(t){var n;return t&&t.type==CKEDITOR.NODE_TEXT&&(n=!CKEDITOR.tools.trim(t.getText())||CKEDITOR.env.webkit&&t.getText()==CKEDITOR.dom.selection.FILLING_CHAR_SEQUENCE),!!(e^n)}},CKEDITOR.dom.walker.invisible=function(e){var t=CKEDITOR.dom.walker.whitespaces(),n=CKEDITOR.env.webkit?1:0;return function(i){return t(i)?i=1:(i.type==CKEDITOR.NODE_TEXT&&(i=i.getParent()),i=i.$.offsetWidth<=n),!!(e^i)}},CKEDITOR.dom.walker.nodeType=function(e,t){return function(n){return!!(t^n.type==e)}},CKEDITOR.dom.walker.bogus=function(e){function t(e){return!a(e)&&!o(e)}return function(n){var i=CKEDITOR.env.needsBrFiller?n.is&&n.is("br"):n.getText&&r.test(n.getText());return i&&(i=n.getParent(),n=n.getNext(t),i=i.isBlockBoundary()&&(!n||n.type==CKEDITOR.NODE_ELEMENT&&n.isBlockBoundary())),!!(e^i)}},CKEDITOR.dom.walker.temp=function(e){return function(t){return t.type!=CKEDITOR.NODE_ELEMENT&&(t=t.getParent()),t=t&&t.hasAttribute("data-cke-temp"),!!(e^t)}};var r=/^[\t\r\n ]*(?:&nbsp;|\xa0)$/,a=CKEDITOR.dom.walker.whitespaces(),o=CKEDITOR.dom.walker.bookmark(),s=CKEDITOR.dom.walker.temp(),l=function(e){return o(e)||a(e)||e.type==CKEDITOR.NODE_ELEMENT&&e.is(CKEDITOR.dtd.$inline)&&!e.is(CKEDITOR.dtd.$empty)};CKEDITOR.dom.walker.ignored=function(e){return function(t){return t=a(t)||o(t)||s(t),!!(e^t)}};var u=CKEDITOR.dom.walker.ignored();CKEDITOR.dom.walker.empty=function(e){return function(t){for(var n=0,i=t.getChildCount();n<i;++n)if(!u(t.getChild(n)))return!!e;return!e}};var c=CKEDITOR.dom.walker.empty(),d=CKEDITOR.dom.walker.validEmptyBlockContainers=CKEDITOR.tools.extend(function(e){var t,n={};for(t in e)CKEDITOR.dtd[t]["#"]&&(n[t]=1);return n}(CKEDITOR.dtd.$block),{caption:1,td:1,th:1});CKEDITOR.dom.walker.editable=function(e){return function(t){return t=!u(t)&&!!(t.type==CKEDITOR.NODE_TEXT||t.type==CKEDITOR.NODE_ELEMENT&&(t.is(CKEDITOR.dtd.$inline)||t.is("hr")||"false"==t.getAttribute("contenteditable")||!CKEDITOR.env.needsBrFiller&&t.is(d)&&c(t))),!!(e^t)}},CKEDITOR.dom.element.prototype.getBogus=function(){var e=this;do{e=e.getPreviousSourceNode()}while(l(e));return!(!e||!(CKEDITOR.env.needsBrFiller?e.is&&e.is("br"):e.getText&&r.test(e.getText())))&&e}}(),CKEDITOR.dom.range=function(e){this.endOffset=this.endContainer=this.startOffset=this.startContainer=null,this.collapsed=!0;var t=e instanceof CKEDITOR.dom.document;this.document=t?e:e.getDocument(),this.root=t?e.getBody():e},function(){function e(e){e.collapsed=e.startContainer&&e.endContainer&&e.startContainer.equals(e.endContainer)&&e.startOffset==e.endOffset}function t(e,t,n,i,r){function a(e,t,n,i){var a=n?e.getPrevious():e.getNext();return i&&o?a:(l||i?t.append(e.clone(!0,r),n):(e.remove(),s&&t.append(e)),a)}e.optimizeBookmark();var o=0===t,s=1==t,l=2==t;t=l||s;var u,c,d,h,p,f,g=e.startContainer,m=e.endContainer,v=e.startOffset,y=e.endOffset;if(l&&m.type==CKEDITOR.NODE_TEXT&&g.equals(m))g=e.document.createText(g.substring(v,y)),n.append(g);else{m.type==CKEDITOR.NODE_TEXT?l?f=!0:m=m.split(y):0<m.getChildCount()?y>=m.getChildCount()?(m=m.getChild(y-1),c=!0):m=m.getChild(y):h=c=!0,g.type==CKEDITOR.NODE_TEXT?l?p=!0:g.split(v):0<g.getChildCount()?0===v?(g=g.getChild(v),u=!0):g=g.getChild(v-1):d=u=!0;for(var b,_,T,E=g.getParents(),C=m.getParents(),w=function(){var e,t,n,i=Math.min(E.length,C.length);for(e=0;e<i;e++)if(t=E[e],n=C[e],!t.equals(n))return e;return e-1}(),k=E.length-1,S=C.length-1,I=n,O=-1,D=w;D<=k;D++){for(T=(_=E[D]).getNext(),D!=k||_.equals(C[D])&&k<S?t&&(b=I.append(_.clone(0,r))):u?a(_,I,!1,d):p&&I.append(e.document.createText(_.substring(v)));T;){if(T.equals(C[D])){O=D;break}T=a(T,I)}I=b}for(I=n,D=w;D<=S;D++)if(T=(n=C[D]).getPrevious(),n.equals(E[D]))t&&(I=I.getChild(0));else{if(D!=S||n.equals(E[D])&&S<k?t&&(b=I.append(n.clone(0,r))):c?a(n,I,!1,h):f&&I.append(e.document.createText(n.substring(0,y))),D>O)for(;T;)T=a(T,I,!0);I=b}l||function(){var t=w-1,n=d&&h&&!g.equals(m);t<k-1||t<S-1||n?(n?e.moveToPosition(m,CKEDITOR.POSITION_BEFORE_START):S==t+1&&c?e.moveToPosition(C[t],CKEDITOR.POSITION_BEFORE_END):e.moveToPosition(C[t+1],CKEDITOR.POSITION_BEFORE_START),i&&(t=E[t+1])&&t.type==CKEDITOR.NODE_ELEMENT&&((n=CKEDITOR.dom.element.createFromHtml('<span data-cke-bookmark="1" style="display:none">&nbsp;</span>',e.document)).insertAfter(t),t.mergeSiblings(!1),e.moveToBookmark({startNode:n}))):e.collapse(!0)}()}}function n(){var e=!1,t=CKEDITOR.dom.walker.whitespaces(),n=CKEDITOR.dom.walker.bookmark(!0),i=CKEDITOR.dom.walker.bogus();return function(a){return!(!n(a)&&!t(a))||(i(a)&&!e?e=!0:!(a.type==CKEDITOR.NODE_TEXT&&(a.hasAscendant("pre")||CKEDITOR.tools.trim(a.getText()).length)||a.type==CKEDITOR.NODE_ELEMENT&&!a.is(r)))}}function i(e){return function(){var t;return this[e?"getPreviousNode":"getNextNode"](function(e){return!t&&l(e)&&(t=e),s(e)&&!(a(e)&&e.equals(t))})}}var r={abbr:1,acronym:1,b:1,bdo:1,big:1,cite:1,code:1,del:1,dfn:1,em:1,font:1,i:1,ins:1,label:1,kbd:1,q:1,samp:1,small:1,span:1,strike:1,strong:1,sub:1,sup:1,tt:1,u:1,var:1},a=CKEDITOR.dom.walker.bogus(),o=/^[\t\r\n ]*(?:&nbsp;|\xa0)$/,s=CKEDITOR.dom.walker.editable(),l=CKEDITOR.dom.walker.ignored(!0);CKEDITOR.dom.range.prototype={clone:function(){var e=new CKEDITOR.dom.range(this.root);return e._setStartContainer(this.startContainer),e.startOffset=this.startOffset,e._setEndContainer(this.endContainer),e.endOffset=this.endOffset,e.collapsed=this.collapsed,e},collapse:function(e){e?(this._setEndContainer(this.startContainer),this.endOffset=this.startOffset):(this._setStartContainer(this.endContainer),this.startOffset=this.endOffset),this.collapsed=!0},cloneContents:function(e){var n=new CKEDITOR.dom.documentFragment(this.document);return this.collapsed||t(this,2,n,!1,void 0===e||e),n},deleteContents:function(e){this.collapsed||t(this,0,null,e)},extractContents:function(e,n){var i=new CKEDITOR.dom.documentFragment(this.document);return this.collapsed||t(this,1,i,e,void 0===n||n),i},createBookmark:function(e){var t,n,i,r,a=this.collapsed;return(t=this.document.createElement("span")).data("cke-bookmark",1),t.setStyle("display","none"),t.setHtml("&nbsp;"),e&&(i="cke_bm_"+CKEDITOR.tools.getNextNumber(),t.setAttribute("id",i+(a?"C":"S"))),a||((n=t.clone()).setHtml("&nbsp;"),e&&n.setAttribute("id",i+"E"),(r=this.clone()).collapse(),r.insertNode(n)),(r=this.clone()).collapse(!0),r.insertNode(t),n?(this.setStartAfter(t),this.setEndBefore(n)):this.moveToPosition(t,CKEDITOR.POSITION_AFTER_END),{startNode:e?i+(a?"C":"S"):t,endNode:e?i+"E":n,serializable:e,collapsed:a}},createBookmark2:function(){function e(e){var t,i=e.container,r=e.offset,a=r;if((t=(t=i).type!=CKEDITOR.NODE_ELEMENT||0===a||a==t.getChildCount()?0:t.getChild(a-1).type==CKEDITOR.NODE_TEXT&&t.getChild(a).type==CKEDITOR.NODE_TEXT)&&(r=(i=i.getChild(r-1)).getLength()),i.type==CKEDITOR.NODE_ELEMENT&&0<r){e:{for(t=i;r--;)if(0<=(a=t.getChild(r).getIndex(!0))){r=a;break e}r=-1}r+=1}if(i.type==CKEDITOR.NODE_TEXT){for(t=i,a=0;(t=t.getPrevious())&&t.type==CKEDITOR.NODE_TEXT;)a+=t.getText().replace(CKEDITOR.dom.selection.FILLING_CHAR_SEQUENCE,"").length;t=a,i.getText()?r+=t:(a=i.getPrevious(n),t?(r=t,i=a?a.getNext():i.getParent().getFirst()):(i=i.getParent(),r=a?a.getIndex(!0)+1:0))}e.container=i,e.offset=r}function t(e,t){var n=t.getCustomData("cke-fillingChar");if(n){var i=e.container;n.equals(i)&&(e.offset-=CKEDITOR.dom.selection.FILLING_CHAR_SEQUENCE.length,0>=e.offset&&(e.offset=i.getIndex(),e.container=i.getParent()))}}var n=CKEDITOR.dom.walker.nodeType(CKEDITOR.NODE_TEXT,!0);return function(n){var i=this.collapsed,r={container:this.startContainer,offset:this.startOffset},a={container:this.endContainer,offset:this.endOffset};return n&&(e(r),t(r,this.root),i||(e(a),t(a,this.root))),{start:r.container.getAddress(n),end:i?null:a.container.getAddress(n),startOffset:r.offset,endOffset:a.offset,normalized:n,collapsed:i,is2:!0}}}(),moveToBookmark:function(e){if(e.is2){var t=this.document.getByAddress(e.start,e.normalized),n=e.startOffset,i=e.end&&this.document.getByAddress(e.end,e.normalized);e=e.endOffset,this.setStart(t,n),i?this.setEnd(i,e):this.collapse(!0)}else t=(n=e.serializable)?this.document.getById(e.startNode):e.startNode,e=n?this.document.getById(e.endNode):e.endNode,this.setStartBefore(t),t.remove(),e?(this.setEndBefore(e),e.remove()):this.collapse(!0)},getBoundaryNodes:function(){var e,t=this.startContainer,n=this.endContainer,i=this.startOffset,r=this.endOffset;if(t.type==CKEDITOR.NODE_ELEMENT)if((e=t.getChildCount())>i)t=t.getChild(i);else if(1>e)t=t.getPreviousSourceNode();else{for(t=t.$;t.lastChild;)t=t.lastChild;t=(t=new CKEDITOR.dom.node(t)).getNextSourceNode()||t}if(n.type==CKEDITOR.NODE_ELEMENT)if((e=n.getChildCount())>r)n=n.getChild(r).getPreviousSourceNode(!0);else if(1>e)n=n.getPreviousSourceNode();else{for(n=n.$;n.lastChild;)n=n.lastChild;n=new CKEDITOR.dom.node(n)}return t.getPosition(n)&CKEDITOR.POSITION_FOLLOWING&&(t=n),{startNode:t,endNode:n}},getCommonAncestor:function(e,t){var n=this.startContainer,i=this.endContainer;return n=n.equals(i)?e&&n.type==CKEDITOR.NODE_ELEMENT&&this.startOffset==this.endOffset-1?n.getChild(this.startOffset):n:n.getCommonAncestor(i),t&&!n.is?n.getParent():n},optimize:function(){var e=this.startContainer,t=this.startOffset;e.type!=CKEDITOR.NODE_ELEMENT&&(t?t>=e.getLength()&&this.setStartAfter(e):this.setStartBefore(e)),e=this.endContainer,t=this.endOffset,e.type!=CKEDITOR.NODE_ELEMENT&&(t?t>=e.getLength()&&this.setEndAfter(e):this.setEndBefore(e))},optimizeBookmark:function(){var e=this.startContainer,t=this.endContainer;e.is&&e.is("span")&&e.data("cke-bookmark")&&this.setStartAt(e,CKEDITOR.POSITION_BEFORE_START),t&&t.is&&t.is("span")&&t.data("cke-bookmark")&&this.setEndAt(t,CKEDITOR.POSITION_AFTER_END)},trim:function(e,t){var n=this.startContainer,i=this.startOffset,r=this.collapsed;if((!e||r)&&n&&n.type==CKEDITOR.NODE_TEXT){if(i)if(i>=n.getLength())i=n.getIndex()+1,n=n.getParent();else{var a=n.split(i);i=n.getIndex()+1,n=n.getParent(),this.startContainer.equals(this.endContainer)?this.setEnd(a,this.endOffset-this.startOffset):n.equals(this.endContainer)&&(this.endOffset+=1)}else i=n.getIndex(),n=n.getParent();if(this.setStart(n,i),r)return void this.collapse(!0)}n=this.endContainer,i=this.endOffset,t||r||!n||n.type!=CKEDITOR.NODE_TEXT||(i?(i>=n.getLength()||n.split(i),i=n.getIndex()+1):i=n.getIndex(),n=n.getParent(),this.setEnd(n,i))},enlarge:function(e,t){function n(e){return e&&e.type==CKEDITOR.NODE_ELEMENT&&e.hasAttribute("contenteditable")?null:e}var i=new RegExp(/[^\s\ufeff]/);switch(e){case CKEDITOR.ENLARGE_INLINE:var r=1;case CKEDITOR.ENLARGE_ELEMENT:var a=function(e,t){var n,r;for((n=new CKEDITOR.dom.range(f)).setStart(e,t),n.setEndAt(f,CKEDITOR.POSITION_BEFORE_END),(n=new CKEDITOR.dom.walker(n)).guard=function(e){return!(e.type==CKEDITOR.NODE_ELEMENT&&e.isBlockBoundary())};r=n.next();){if(r.type!=CKEDITOR.NODE_TEXT)return!1;if(h=r!=e?r.getText():r.substring(t),i.test(h))return!1}return!0};if(this.collapsed)break;var o,s,l,u,c,d,h,p=this.getCommonAncestor(),f=this.root,g=!1;d=this.startContainer;var m=this.startOffset;for(d.type==CKEDITOR.NODE_TEXT?(m&&(g=!!(d=!CKEDITOR.tools.trim(d.substring(0,m)).length&&d)),d&&((u=d.getPrevious())||(l=d.getParent()))):(m&&(u=d.getChild(m-1)||d.getLast()),u||(l=d)),l=n(l);l||u;){if(l&&!u){if(!c&&l.equals(p)&&(c=!0),r?l.isBlockBoundary():!f.contains(l))break;g&&"inline"==l.getComputedStyle("display")||(g=!1,c?o=l:this.setStartBefore(l)),u=l.getPrevious()}for(;u;)if(d=!1,u.type==CKEDITOR.NODE_COMMENT)u=u.getPrevious();else{if(u.type==CKEDITOR.NODE_TEXT)h=u.getText(),i.test(h)&&(u=null),d=/[\s\ufeff]$/.test(h);else if((u.$.offsetWidth>(CKEDITOR.env.webkit?1:0)||t&&u.is("br"))&&!u.data("cke-bookmark"))if(g&&CKEDITOR.dtd.$removeEmpty[u.getName()]){if(h=u.getText(),i.test(h))u=null;else{m=u.$.getElementsByTagName("*");for(var v,y=0;v=m[y++];)if(!CKEDITOR.dtd.$removeEmpty[v.nodeName.toLowerCase()]){u=null;break}}u&&(d=!!h.length)}else u=null;if(d&&(g?c?o=l:l&&this.setStartBefore(l):g=!0),u){if(d=u.getPrevious(),!l&&!d){l=u,u=null;break}u=d}else l=null}l&&(l=n(l.getParent()))}for(d=this.endContainer,m=this.endOffset,l=u=null,c=g=!1,d.type==CKEDITOR.NODE_TEXT?CKEDITOR.tools.trim(d.substring(m)).length?g=!0:(g=!d.getLength(),m==d.getLength()?(u=d.getNext())||(l=d.getParent()):a(d,m)&&(l=d.getParent())):(u=d.getChild(m))||(l=d);l||u;){if(l&&!u){if(!c&&l.equals(p)&&(c=!0),r?l.isBlockBoundary():!f.contains(l))break;g&&"inline"==l.getComputedStyle("display")||(g=!1,c?s=l:l&&this.setEndAfter(l)),u=l.getNext()}for(;u;){if(d=!1,u.type==CKEDITOR.NODE_TEXT)h=u.getText(),a(u,0)||(u=null),d=/^[\s\ufeff]/.test(h);else if(u.type==CKEDITOR.NODE_ELEMENT){if((0<u.$.offsetWidth||t&&u.is("br"))&&!u.data("cke-bookmark"))if(g&&CKEDITOR.dtd.$removeEmpty[u.getName()]){if(h=u.getText(),i.test(h))u=null;else for(m=u.$.getElementsByTagName("*"),y=0;v=m[y++];)if(!CKEDITOR.dtd.$removeEmpty[v.nodeName.toLowerCase()]){u=null;break}u&&(d=!!h.length)}else u=null}else d=1;if(d&&g&&(c?s=l:this.setEndAfter(l)),u){if(d=u.getNext(),!l&&!d){l=u,u=null;break}u=d}else l=null}l&&(l=n(l.getParent()))}o&&s&&(p=o.contains(s)?s:o,this.setStartBefore(p),this.setEndAfter(p));break;case CKEDITOR.ENLARGE_BLOCK_CONTENTS:case CKEDITOR.ENLARGE_LIST_ITEM_CONTENTS:l=new CKEDITOR.dom.range(this.root),f=this.root,l.setStartAt(f,CKEDITOR.POSITION_AFTER_START),l.setEnd(this.startContainer,this.startOffset),l=new CKEDITOR.dom.walker(l);var b,_,T=CKEDITOR.dom.walker.blockBoundary(e==CKEDITOR.ENLARGE_LIST_ITEM_CONTENTS?{br:1}:null),E=null,C=function(e){if(e.type==CKEDITOR.NODE_ELEMENT&&"false"==e.getAttribute("contenteditable"))if(E){if(E.equals(e))return void(E=null)}else E=e;else if(E)return;var t=T(e);return t||(b=e),t};if(r=function(e){var t=C(e);return!t&&e.is&&e.is("br")&&(_=e),t},l.guard=C,l=l.lastBackward(),b=b||f,this.setStartAt(b,!b.is("br")&&(!l&&this.checkStartOfBlock()||l&&b.contains(l))?CKEDITOR.POSITION_AFTER_START:CKEDITOR.POSITION_AFTER_END),e==CKEDITOR.ENLARGE_LIST_ITEM_CONTENTS){l=this.clone(),l=new CKEDITOR.dom.walker(l);var w=CKEDITOR.dom.walker.whitespaces(),k=CKEDITOR.dom.walker.bookmark();if(l.evaluator=function(e){return!w(e)&&!k(e)},(l=l.previous())&&l.type==CKEDITOR.NODE_ELEMENT&&l.is("br"))break}(l=this.clone()).collapse(),l.setEndAt(f,CKEDITOR.POSITION_BEFORE_END),(l=new CKEDITOR.dom.walker(l)).guard=e==CKEDITOR.ENLARGE_LIST_ITEM_CONTENTS?r:C,b=E=_=null,l=l.lastForward(),b=b||f,this.setEndAt(b,!l&&this.checkEndOfBlock()||l&&b.contains(l)?CKEDITOR.POSITION_BEFORE_END:CKEDITOR.POSITION_BEFORE_START),_&&this.setEndAfter(_)}},shrink:function(e,t,n){if(!this.collapsed){e=e||CKEDITOR.SHRINK_TEXT;var i=this.clone(),r=this.startContainer,a=this.endContainer,o=this.startOffset,s=this.endOffset,l=1,u=1;r&&r.type==CKEDITOR.NODE_TEXT&&(o?o>=r.getLength()?i.setStartAfter(r):(i.setStartBefore(r),l=0):i.setStartBefore(r)),a&&a.type==CKEDITOR.NODE_TEXT&&(s?s>=a.getLength()?i.setEndAfter(a):(i.setEndAfter(a),u=0):i.setEndBefore(a)),i=new CKEDITOR.dom.walker(i);var c,d=CKEDITOR.dom.walker.bookmark();return i.evaluator=function(t){return t.type==(e==CKEDITOR.SHRINK_ELEMENT?CKEDITOR.NODE_ELEMENT:CKEDITOR.NODE_TEXT)},i.guard=function(t,i){return!!d(t)||!(e==CKEDITOR.SHRINK_ELEMENT&&t.type==CKEDITOR.NODE_TEXT||i&&t.equals(c)||!1===n&&t.type==CKEDITOR.NODE_ELEMENT&&t.isBlockBoundary()||t.type==CKEDITOR.NODE_ELEMENT&&t.hasAttribute("contenteditable"))&&(i||t.type!=CKEDITOR.NODE_ELEMENT||(c=t),!0)},l&&(r=i[e==CKEDITOR.SHRINK_ELEMENT?"lastForward":"next"]())&&this.setStartAt(r,t?CKEDITOR.POSITION_AFTER_START:CKEDITOR.POSITION_BEFORE_START),u&&(i.reset(),(i=i[e==CKEDITOR.SHRINK_ELEMENT?"lastBackward":"previous"]())&&this.setEndAt(i,t?CKEDITOR.POSITION_BEFORE_END:CKEDITOR.POSITION_AFTER_END)),!(!l&&!u)}},insertNode:function(e){this.optimizeBookmark(),this.trim(!1,!0);var t=this.startContainer,n=t.getChild(this.startOffset);n?e.insertBefore(n):t.append(e),e.getParent()&&e.getParent().equals(this.endContainer)&&this.endOffset++,this.setStartBefore(e)},moveToPosition:function(e,t){this.setStartAt(e,t),this.collapse(!0)},moveToRange:function(e){this.setStart(e.startContainer,e.startOffset),this.setEnd(e.endContainer,e.endOffset)},selectNodeContents:function(e){this.setStart(e,0),this.setEnd(e,e.type==CKEDITOR.NODE_TEXT?e.getLength():e.getChildCount())},setStart:function(t,n){t.type==CKEDITOR.NODE_ELEMENT&&CKEDITOR.dtd.$empty[t.getName()]&&(n=t.getIndex(),t=t.getParent()),this._setStartContainer(t),this.startOffset=n,this.endContainer||(this._setEndContainer(t),this.endOffset=n),e(this)},setEnd:function(t,n){t.type==CKEDITOR.NODE_ELEMENT&&CKEDITOR.dtd.$empty[t.getName()]&&(n=t.getIndex()+1,t=t.getParent()),this._setEndContainer(t),this.endOffset=n,this.startContainer||(this._setStartContainer(t),this.startOffset=n),e(this)},setStartAfter:function(e){this.setStart(e.getParent(),e.getIndex()+1)},setStartBefore:function(e){this.setStart(e.getParent(),e.getIndex())},setEndAfter:function(e){this.setEnd(e.getParent(),e.getIndex()+1)},setEndBefore:function(e){this.setEnd(e.getParent(),e.getIndex())},setStartAt:function(t,n){switch(n){case CKEDITOR.POSITION_AFTER_START:this.setStart(t,0);break;case CKEDITOR.POSITION_BEFORE_END:t.type==CKEDITOR.NODE_TEXT?this.setStart(t,t.getLength()):this.setStart(t,t.getChildCount());break;case CKEDITOR.POSITION_BEFORE_START:this.setStartBefore(t);break;case CKEDITOR.POSITION_AFTER_END:this.setStartAfter(t)}e(this)},setEndAt:function(t,n){switch(n){case CKEDITOR.POSITION_AFTER_START:this.setEnd(t,0);break;case CKEDITOR.POSITION_BEFORE_END:t.type==CKEDITOR.NODE_TEXT?this.setEnd(t,t.getLength()):this.setEnd(t,t.getChildCount());break;case CKEDITOR.POSITION_BEFORE_START:this.setEndBefore(t);break;case CKEDITOR.POSITION_AFTER_END:this.setEndAfter(t)}e(this)},fixBlock:function(e,t){var n=this.createBookmark(),i=this.document.createElement(t);this.collapse(e),this.enlarge(CKEDITOR.ENLARGE_BLOCK_CONTENTS),this.extractContents().appendTo(i),i.trim(),this.insertNode(i);var r=i.getBogus();return r&&r.remove(),i.appendBogus(),this.moveToBookmark(n),i},splitBlock:function(e,t){var n=new CKEDITOR.dom.elementPath(this.startContainer,this.root),i=new CKEDITOR.dom.elementPath(this.endContainer,this.root),r=n.block,a=i.block,o=null;return n.blockLimit.equals(i.blockLimit)?("br"!=e&&(r||(r=this.fixBlock(!0,e),a=new CKEDITOR.dom.elementPath(this.endContainer,this.root).block),a||(a=this.fixBlock(!1,e))),n=r&&this.checkStartOfBlock(),i=a&&this.checkEndOfBlock(),this.deleteContents(),r&&r.equals(a)&&(i?(o=new CKEDITOR.dom.elementPath(this.startContainer,this.root),this.moveToPosition(a,CKEDITOR.POSITION_AFTER_END),a=null):n?(o=new CKEDITOR.dom.elementPath(this.startContainer,this.root),this.moveToPosition(r,CKEDITOR.POSITION_BEFORE_START),r=null):(a=this.splitElement(r,t||!1),r.is("ul","ol")||r.appendBogus())),{previousBlock:r,nextBlock:a,wasStartOfBlock:n,wasEndOfBlock:i,elementPath:o}):null},splitElement:function(e,t){if(!this.collapsed)return null;this.setEndAt(e,CKEDITOR.POSITION_BEFORE_END);var n=this.extractContents(!1,t||!1),i=e.clone(!1,t||!1);return n.appendTo(i),i.insertAfter(e),this.moveToPosition(e,CKEDITOR.POSITION_AFTER_END),i},removeEmptyBlocksAtEnd:function(){function e(e){return function(i){return!(t(i)||n(i)||i.type==CKEDITOR.NODE_ELEMENT&&i.isEmptyInlineRemoveable()||e.is("table")&&i.is("caption"))}}var t=CKEDITOR.dom.walker.whitespaces(),n=CKEDITOR.dom.walker.bookmark(!1);return function(t){for(var n,i=this.createBookmark(),r=this[t?"endPath":"startPath"](),a=r.block||r.blockLimit;a&&!a.equals(r.root)&&!a.getFirst(e(a));)n=a.getParent(),this[t?"setEndAt":"setStartAt"](a,CKEDITOR.POSITION_AFTER_END),a.remove(1),a=n;this.moveToBookmark(i)}}(),startPath:function(){return new CKEDITOR.dom.elementPath(this.startContainer,this.root)},endPath:function(){return new CKEDITOR.dom.elementPath(this.endContainer,this.root)},checkBoundaryOfElement:function(e,t){var n=t==CKEDITOR.START,i=this.clone();return i.collapse(n),i[n?"setStartAt":"setEndAt"](e,n?CKEDITOR.POSITION_AFTER_START:CKEDITOR.POSITION_BEFORE_END),(i=new CKEDITOR.dom.walker(i)).evaluator=function(e){var t=CKEDITOR.dom.walker.whitespaces(),n=CKEDITOR.dom.walker.bookmark(1);return function(i){return!(!n(i)&&!t(i))||!e&&a(i)||i.type==CKEDITOR.NODE_ELEMENT&&i.is(CKEDITOR.dtd.$removeEmpty)}}(n),i[n?"checkBackward":"checkForward"]()},checkStartOfBlock:function(){var e=this.startContainer,t=this.startOffset;return CKEDITOR.env.ie&&t&&e.type==CKEDITOR.NODE_TEXT&&(e=CKEDITOR.tools.ltrim(e.substring(0,t)),o.test(e)&&this.trim(0,1)),this.trim(),e=new CKEDITOR.dom.elementPath(this.startContainer,this.root),(t=this.clone()).collapse(!0),t.setStartAt(e.block||e.blockLimit,CKEDITOR.POSITION_AFTER_START),(e=new CKEDITOR.dom.walker(t)).evaluator=n(),e.checkBackward()},checkEndOfBlock:function(){var e=this.endContainer,t=this.endOffset;return CKEDITOR.env.ie&&e.type==CKEDITOR.NODE_TEXT&&(e=CKEDITOR.tools.rtrim(e.substring(t)),o.test(e)&&this.trim(1,0)),this.trim(),e=new CKEDITOR.dom.elementPath(this.endContainer,this.root),(t=this.clone()).collapse(!1),t.setEndAt(e.block||e.blockLimit,CKEDITOR.POSITION_BEFORE_END),(e=new CKEDITOR.dom.walker(t)).evaluator=n(),e.checkForward()},getPreviousNode:function(e,t,n){var i=this.clone();return i.collapse(1),i.setStartAt(n||this.root,CKEDITOR.POSITION_AFTER_START),(n=new CKEDITOR.dom.walker(i)).evaluator=e,n.guard=t,n.previous()},getNextNode:function(e,t,n){var i=this.clone();return i.collapse(),i.setEndAt(n||this.root,CKEDITOR.POSITION_BEFORE_END),(n=new CKEDITOR.dom.walker(i)).evaluator=e,n.guard=t,n.next()},checkReadOnly:function(){function e(e,t){for(;e;){if(e.type==CKEDITOR.NODE_ELEMENT){if("false"==e.getAttribute("contentEditable")&&!e.data("cke-editable"))return 0;if(e.is("html")||"true"==e.getAttribute("contentEditable")&&(e.contains(t)||e.equals(t)))break}e=e.getParent()}return 1}return function(){var t=this.startContainer,n=this.endContainer;return!(e(t,n)&&e(n,t))}}(),moveToElementEditablePosition:function(e,t){if(e.type==CKEDITOR.NODE_ELEMENT&&!e.isEditable(!1))return this.moveToPosition(e,t?CKEDITOR.POSITION_AFTER_END:CKEDITOR.POSITION_BEFORE_START),!0;for(var n=0;e;){if(e.type==CKEDITOR.NODE_TEXT){t&&this.endContainer&&this.checkEndOfBlock()&&o.test(e.getText())?this.moveToPosition(e,CKEDITOR.POSITION_BEFORE_START):this.moveToPosition(e,t?CKEDITOR.POSITION_AFTER_END:CKEDITOR.POSITION_BEFORE_START),n=1;break}if(e.type==CKEDITOR.NODE_ELEMENT)if(e.isEditable())this.moveToPosition(e,t?CKEDITOR.POSITION_BEFORE_END:CKEDITOR.POSITION_AFTER_START),n=1;else if(t&&e.is("br")&&this.endContainer&&this.checkEndOfBlock())this.moveToPosition(e,CKEDITOR.POSITION_BEFORE_START);else if("false"==e.getAttribute("contenteditable")&&e.is(CKEDITOR.dtd.$block))return this.setStartBefore(e),this.setEndAfter(e),!0;var i=e,r=n,a=void 0;i.type==CKEDITOR.NODE_ELEMENT&&i.isEditable(!1)&&(a=i[t?"getLast":"getFirst"](l)),r||a||(a=i[t?"getPrevious":"getNext"](l)),e=a}return!!n},moveToClosestEditablePosition:function(e,t){var n,i,r,a=0,o=[CKEDITOR.POSITION_AFTER_END,CKEDITOR.POSITION_BEFORE_START];return e?(n=new CKEDITOR.dom.range(this.root)).moveToPosition(e,o[t?0:1]):n=this.clone(),e&&!e.is(CKEDITOR.dtd.$block)?a=1:(i=n[t?"getNextEditableNode":"getPreviousEditableNode"]())&&(a=1,(r=i.type==CKEDITOR.NODE_ELEMENT)&&i.is(CKEDITOR.dtd.$block)&&"false"==i.getAttribute("contenteditable")?(n.setStartAt(i,CKEDITOR.POSITION_BEFORE_START),n.setEndAt(i,CKEDITOR.POSITION_AFTER_END)):!CKEDITOR.env.needsBrFiller&&r&&i.is(CKEDITOR.dom.walker.validEmptyBlockContainers)?(n.setEnd(i,0),n.collapse()):n.moveToPosition(i,o[t?1:0])),a&&this.moveToRange(n),!!a},moveToElementEditStart:function(e){return this.moveToElementEditablePosition(e)},moveToElementEditEnd:function(e){return this.moveToElementEditablePosition(e,!0)},getEnclosedNode:function(){if((e=this.clone()).optimize(),e.startContainer.type!=CKEDITOR.NODE_ELEMENT||e.endContainer.type!=CKEDITOR.NODE_ELEMENT)return null;var e=new CKEDITOR.dom.walker(e),t=CKEDITOR.dom.walker.bookmark(!1,!0),n=CKEDITOR.dom.walker.whitespaces(!0);e.evaluator=function(e){return n(e)&&t(e)};var i=e.next();return e.reset(),i&&i.equals(e.previous())?i:null},getTouchedStartNode:function(){var e=this.startContainer;return this.collapsed||e.type!=CKEDITOR.NODE_ELEMENT?e:e.getChild(this.startOffset)||e},getTouchedEndNode:function(){var e=this.endContainer;return this.collapsed||e.type!=CKEDITOR.NODE_ELEMENT?e:e.getChild(this.endOffset-1)||e},getNextEditableNode:i(),getPreviousEditableNode:i(1),scrollIntoView:function(){var e,t,n,i=new CKEDITOR.dom.element.createFromHtml("<span>&nbsp;</span>",this.document),r=this.clone();r.optimize(),(n=r.startContainer.type==CKEDITOR.NODE_TEXT)?(t=r.startContainer.getText(),e=r.startContainer.split(r.startOffset),i.insertAfter(r.startContainer)):r.insertNode(i),i.scrollIntoView(),n&&(r.startContainer.setText(t),e.remove()),i.remove()},_setStartContainer:function(e){this.startContainer=e},_setEndContainer:function(e){this.endContainer=e},_find:function(e,t){var n,i,r,a,o=this.getCommonAncestor(),s=this.getBoundaryNodes(),l=[];if(o&&o.find)for(i=o.find(e),n=0;n<i.count();n++)o=i.getItem(n),(t||!o.isReadOnly())&&(r=o.getPosition(s.startNode)&CKEDITOR.POSITION_FOLLOWING||s.startNode.equals(o),a=o.getPosition(s.endNode)&CKEDITOR.POSITION_PRECEDING+CKEDITOR.POSITION_IS_CONTAINED,r&&a&&l.push(o));return l}}}(),CKEDITOR.POSITION_AFTER_START=1,CKEDITOR.POSITION_BEFORE_END=2,CKEDITOR.POSITION_BEFORE_START=3,CKEDITOR.POSITION_AFTER_END=4,CKEDITOR.ENLARGE_ELEMENT=1,CKEDITOR.ENLARGE_BLOCK_CONTENTS=2,CKEDITOR.ENLARGE_LIST_ITEM_CONTENTS=3,CKEDITOR.ENLARGE_INLINE=4,CKEDITOR.START=1,CKEDITOR.END=2,CKEDITOR.SHRINK_ELEMENT=1,CKEDITOR.SHRINK_TEXT=2,function(){function e(e){1>arguments.length||(this.range=e,this.forceBrBreak=0,this.enlargeBr=1,this.enforceRealBlocks=0,this._||(this._={}))}function t(e,n,i,r){e:{null==r&&(r=function(e){var t=[];return i.forEach(function(e){if("true"==e.getAttribute("contenteditable"))return t.push(e),!1},CKEDITOR.NODE_ELEMENT,!0),t}());for(var a;a=r.shift();)if(a.getDtd().p){r={element:a,remaining:r};break e}r=null}return r?(a=CKEDITOR.filter.instances[r.element.data("cke-filter")])&&!a.check(n)?t(e,n,i,r.remaining):((n=new CKEDITOR.dom.range(r.element)).selectNodeContents(r.element),(n=n.createIterator()).enlargeBr=e.enlargeBr,n.enforceRealBlocks=e.enforceRealBlocks,n.activeFilter=n.filter=a,e._.nestedEditable={element:r.element,container:i,remaining:r.remaining,iterator:n},1):0}function n(e,t,n){return!!t&&((e=e.clone()).collapse(!n),e.checkBoundaryOfElement(t,n?CKEDITOR.START:CKEDITOR.END))}var i=/^[\r\n\t ]+$/,r=CKEDITOR.dom.walker.bookmark(!1,!0),a=CKEDITOR.dom.walker.whitespaces(!0),o=function(e){return r(e)&&a(e)},s={dd:1,dt:1,li:1};e.prototype={getNextParagraph:function(e){var a,l,u,c,d;if(e=e||"p",this._.nestedEditable){if(a=this._.nestedEditable.iterator.getNextParagraph(e))return this.activeFilter=this._.nestedEditable.iterator.activeFilter,a;if(this.activeFilter=this.filter,t(this,e,this._.nestedEditable.container,this._.nestedEditable.remaining))return this.activeFilter=this._.nestedEditable.iterator.activeFilter,this._.nestedEditable.iterator.getNextParagraph(e);this._.nestedEditable=null}if(!this.range.root.getDtd()[e])return null;if(!this._.started){var h=this.range.clone();l=h.startPath();var p=h.endPath(),f=!h.collapsed&&n(h,l.block),g=!h.collapsed&&n(h,p.block,1);h.shrink(CKEDITOR.SHRINK_ELEMENT,!0),f&&h.setStartAt(l.block,CKEDITOR.POSITION_BEFORE_END),g&&h.setEndAt(p.block,CKEDITOR.POSITION_AFTER_START),l=h.endContainer.hasAscendant("pre",!0)||h.startContainer.hasAscendant("pre",!0),h.enlarge(this.forceBrBreak&&!l||!this.enlargeBr?CKEDITOR.ENLARGE_LIST_ITEM_CONTENTS:CKEDITOR.ENLARGE_BLOCK_CONTENTS),h.collapsed||(l=new CKEDITOR.dom.walker(h.clone()),p=CKEDITOR.dom.walker.bookmark(!0,!0),l.evaluator=p,this._.nextNode=l.next(),(l=new CKEDITOR.dom.walker(h.clone())).evaluator=p,l=l.previous(),this._.lastNode=l.getNextSourceNode(!0,null,h.root),this._.lastNode&&this._.lastNode.type==CKEDITOR.NODE_TEXT&&!CKEDITOR.tools.trim(this._.lastNode.getText())&&this._.lastNode.getParent().isBlockBoundary()&&((p=this.range.clone()).moveToPosition(this._.lastNode,CKEDITOR.POSITION_AFTER_END),p.checkEndOfBlock()&&(p=new CKEDITOR.dom.elementPath(p.endContainer,p.root),this._.lastNode=(p.block||p.blockLimit).getNextSourceNode(!0))),this._.lastNode&&h.root.contains(this._.lastNode)||(this._.lastNode=this._.docEndMarker=h.document.createText(""),this._.lastNode.insertAfter(l)),h=null),this._.started=1,l=h}for(p=this._.nextNode,h=this._.lastNode,this._.nextNode=null;p;){f=0,g=p.hasAscendant("pre");var m=p.type!=CKEDITOR.NODE_ELEMENT,v=0;if(m)p.type==CKEDITOR.NODE_TEXT&&i.test(p.getText())&&(m=0);else{var y=p.getName();if(CKEDITOR.dtd.$block[y]&&"false"==p.getAttribute("contenteditable")){t(this,e,a=p);break}if(p.isBlockBoundary(this.forceBrBreak&&!g&&{br:1})){if("br"==y)m=1;else if(!l&&!p.getChildCount()&&"hr"!=y){a=p,u=p.equals(h);break}l&&(l.setEndAt(p,CKEDITOR.POSITION_BEFORE_START),"br"!=y&&(this._.nextNode=p)),f=1}else{if(p.getFirst()){l||(l=this.range.clone()).setStartAt(p,CKEDITOR.POSITION_BEFORE_START),p=p.getFirst();continue}m=1}}if(m&&!l&&(l=this.range.clone()).setStartAt(p,CKEDITOR.POSITION_BEFORE_START),u=(!f||m)&&p.equals(h),l&&!f)for(;!p.getNext(o)&&!u;){if((y=p.getParent()).isBlockBoundary(this.forceBrBreak&&!g&&{br:1})){f=1,m=0,u||y.equals(h),l.setEndAt(y,CKEDITOR.POSITION_BEFORE_END);break}m=1,u=(p=y).equals(h),v=1}if(m&&l.setEndAt(p,CKEDITOR.POSITION_AFTER_END),(u=!(p=this._getNextSourceNode(p,v,h)))||f&&l)break}if(!a){if(!l)return this._.docEndMarker&&this._.docEndMarker.remove(),this._.nextNode=null;p=(a=new CKEDITOR.dom.elementPath(l.startContainer,l.root)).blockLimit,f={div:1,th:1,td:1},!(a=a.block)&&p&&!this.enforceRealBlocks&&f[p.getName()]&&l.checkStartOfBlock()&&l.checkEndOfBlock()&&!p.equals(l.root)?a=p:!a||this.enforceRealBlocks&&a.is(s)?(a=this.range.document.createElement(e),l.extractContents().appendTo(a),a.trim(),l.insertNode(a),c=d=!0):"li"!=a.getName()?l.checkStartOfBlock()&&l.checkEndOfBlock()||(a=a.clone(!1),l.extractContents().appendTo(a),a.trim(),c=!(d=l.splitBlock()).wasStartOfBlock,d=!d.wasEndOfBlock,l.insertNode(a)):u||(this._.nextNode=a.equals(h)?null:this._getNextSourceNode(l.getBoundaryNodes().endNode,1,h))}return c&&(c=a.getPrevious())&&c.type==CKEDITOR.NODE_ELEMENT&&("br"==c.getName()?c.remove():c.getLast()&&"br"==c.getLast().$.nodeName.toLowerCase()&&c.getLast().remove()),d&&(c=a.getLast())&&c.type==CKEDITOR.NODE_ELEMENT&&"br"==c.getName()&&(!CKEDITOR.env.needsBrFiller||c.getPrevious(r)||c.getNext(r))&&c.remove(),this._.nextNode||(this._.nextNode=u||a.equals(h)||!h?null:this._getNextSourceNode(a,1,h)),a},_getNextSourceNode:function(e,t,n){function i(e){return!(e.equals(n)||e.equals(a))}var a=this.range.root;for(e=e.getNextSourceNode(t,null,i);!r(e);)e=e.getNextSourceNode(t,null,i);return e}},CKEDITOR.dom.range.prototype.createIterator=function(){return new e(this)}}(),CKEDITOR.command=function(e,t){var n;this.uiItems=[],this.exec=function(n){return!(this.state==CKEDITOR.TRISTATE_DISABLED||!this.checkAllowed())&&(this.editorFocus&&e.focus(),!1===this.fire("exec")||!1!==t.exec.call(this,e,n))},this.refresh=function(e,n){return!(this.readOnly||!e.readOnly)||(this.context&&!n.isContextFor(this.context)||!this.checkAllowed(!0)?(this.disable(),!0):(this.startDisabled||this.enable(),this.modes&&!this.modes[e.mode]&&this.disable(),!1===this.fire("refresh",{editor:e,path:n})||t.refresh&&!1!==t.refresh.apply(this,arguments)))},this.checkAllowed=function(t){return t||"boolean"!=typeof n?n=e.activeFilter.checkFeature(this):n},CKEDITOR.tools.extend(this,t,{modes:{wysiwyg:1},editorFocus:1,contextSensitive:!!t.context,state:CKEDITOR.TRISTATE_DISABLED}),CKEDITOR.event.call(this)},CKEDITOR.command.prototype={enable:function(){this.state==CKEDITOR.TRISTATE_DISABLED&&this.checkAllowed()&&this.setState(this.preserveState&&void 0!==this.previousState?this.previousState:CKEDITOR.TRISTATE_OFF)},disable:function(){this.setState(CKEDITOR.TRISTATE_DISABLED)},setState:function(e){return!(this.state==e||e!=CKEDITOR.TRISTATE_DISABLED&&!this.checkAllowed()||(this.previousState=this.state,this.state=e,this.fire("state"),0))},toggleState:function(){this.state==CKEDITOR.TRISTATE_OFF?this.setState(CKEDITOR.TRISTATE_ON):this.state==CKEDITOR.TRISTATE_ON&&this.setState(CKEDITOR.TRISTATE_OFF)}},CKEDITOR.event.implementOn(CKEDITOR.command.prototype),CKEDITOR.ENTER_P=1,CKEDITOR.ENTER_BR=2,CKEDITOR.ENTER_DIV=3,CKEDITOR.config={customConfig:"config.js",autoUpdateElement:!0,language:"",defaultLanguage:"en",contentsLangDirection:"",enterMode:CKEDITOR.ENTER_P,forceEnterMode:!1,shiftEnterMode:CKEDITOR.ENTER_BR,docType:"<!DOCTYPE html>",bodyId:"",bodyClass:"",fullPage:!1,height:200,contentsCss:CKEDITOR.getUrl("contents.css"),extraPlugins:"",removePlugins:"",protectedSource:[],tabIndex:0,width:"",baseFloatZIndex:1e4,blockedKeystrokes:[CKEDITOR.CTRL+66,CKEDITOR.CTRL+73,CKEDITOR.CTRL+85]},function(){function e(e,t,n,i,r){var a,s,l;for(a in e=[],t){s="boolean"==typeof(s=t[a])?{}:"function"==typeof s?{match:s}:S(s),"$"!=a.charAt(0)&&(s.elements=a),n&&(s.featureName=n.toLowerCase());var u=s;u.elements=o(u.elements,/\s+/)||null,u.propertiesOnly=u.propertiesOnly||!0===u.elements;var c=/\s*,\s*/,d=void 0;for(d in R){u[d]=o(u[d],c)||null;var h=u,p=x[d],f=o(u[x[d]],c),g=u[d],v=[],y=!0,b=void 0;for(b in f?y=!1:f={},g)"!"==b.charAt(0)&&(b=b.slice(1),v.push(b),f[b]=!0,y=!1);for(;b=v.pop();)g[b]=g["!"+b],delete g["!"+b];h[p]=!y&&f||null}u.match=u.match||null,i.push(s),e.push(s)}for(t=r.elements,r=r.generic,n=0,i=e.length;n<i;++n){for(c in s=!0===(a=S(e[n])).classes||!0===a.styles||!0===a.attributes,u=a,d=p=c=void 0,R)u[c]=m(u[c]);for(d in h=!0,x){for(g in f=[],g=void 0,p=u[c=x[d]])-1<g.indexOf("*")?f.push(new RegExp("^"+g.replace(/\*/g,".*")+"$")):f.push(g);(p=f).length&&(u[c]=p,h=!1)}if(u.nothingRequired=h,u.noProperties=!(u.attributes||u.classes||u.styles),!0===a.elements||null===a.elements)r[s?"unshift":"push"](a);else for(l in u=a.elements,delete a.elements,u)t[l]?t[l][s?"unshift":"push"](a):t[l]=[a]}}function t(e,t,i,r){if((!e.match||e.match(t))&&(r||s(e,t))&&(e.propertiesOnly||(i.valid=!0),i.allAttributes||(i.allAttributes=n(e.attributes,t.attributes,i.validAttributes)),i.allStyles||(i.allStyles=n(e.styles,t.styles,i.validStyles)),!i.allClasses)){if(e=e.classes,t=t.classes,r=i.validClasses,e)if(!0===e)e=!0;else{for(var a,o=0,l=t.length;o<l;++o)r[a=t[o]]||(r[a]=e(a));e=!1}else e=!1;i.allClasses=e}}function n(e,t,n){if(!e)return!1;if(!0===e)return!0;for(var i in t)n[i]||(n[i]=e(i));return!1}function i(e,t,n){if(!e.match||e.match(t)){if(e.noProperties)return!1;if(n.hadInvalidAttribute=r(e.attributes,t.attributes)||n.hadInvalidAttribute,n.hadInvalidStyle=r(e.styles,t.styles)||n.hadInvalidStyle,e=e.classes,t=t.classes,e){for(var i=!1,a=!0===e,o=t.length;o--;)(a||e(t[o]))&&(t.splice(o,1),i=!0);e=i}else e=!1;n.hadInvalidClass=e||n.hadInvalidClass}}function r(e,t){if(!e)return!1;var n,i=!1,r=!0===e;for(n in t)(r||e(n))&&(delete t[n],i=!0);return i}function a(e,t,n){return!(e.disabled||e.customConfig&&!n||!t||(e._.cachedChecks={},0))}function o(e,t){if(!e)return!1;if(!0===e)return e;if("string"==typeof e)return"*"==(e=I(e))||CKEDITOR.tools.convertArrayToObject(e.split(t));if(CKEDITOR.tools.isArray(e))return!!e.length&&CKEDITOR.tools.convertArrayToObject(e);var n,i={},r=0;for(n in e)i[n]=e[n],r++;return!!r&&i}function s(e,t){if(e.nothingRequired)return!0;var n,i,r,a;if(r=e.requiredClasses)for(a=t.classes,n=0;n<r.length;++n)if("string"==typeof(i=r[n])){if(-1==CKEDITOR.tools.indexOf(a,i))return!1}else if(!CKEDITOR.tools.checkIfAnyArrayItemMatches(a,i))return!1;return l(t.styles,e.requiredStyles)&&l(t.attributes,e.requiredAttributes)}function l(e,t){if(!t)return!0;for(var n,i=0;i<t.length;++i)if("string"==typeof(n=t[i])){if(!(n in e))return!1}else if(!CKEDITOR.tools.checkIfAnyObjectPropertyMatches(e,n))return!1;return!0}function u(e){if(!e)return{};e=e.split(/\s*,\s*/).sort();for(var t={};e.length;)t[e.shift()]="cke-test";return t}function c(e){var t,n,i,r,a={},o=1;for(e=I(e);t=e.match(A);)(n=t[2])?(i=d(n,"styles"),r=d(n,"attrs"),n=d(n,"classes")):i=r=n=null,a["$"+o++]={elements:t[1],classes:n,styles:i,attributes:r},e=e.slice(t[0].length);return a}function d(e,t){var n=e.match(P[t]);return n?I(n[1]):null}function h(e){var t=e.styleBackup=e.attributes.style,n=e.classBackup=e.attributes.class;e.styles||(e.styles=CKEDITOR.tools.parseCssText(t||"",1)),e.classes||(e.classes=n?n.split(/\s+/):[])}function p(e,n,r,a){var o,s=0;if(a.toHtml&&(n.name=n.name.replace(L,"$1")),a.doCallbacks&&e.elementCallbacks){e:{for(var l,u=0,c=(o=e.elementCallbacks).length;u<c;++u)if(l=o[u](n)){o=l;break e}o=void 0}if(o)return o}if(a.doTransform&&(o=e._.transformations[n.name])){for(h(n),u=0;u<o.length;++u)_(e,n,o[u]);f(n)}if(a.doFilter){e:{u=n.name,e=(c=e._).allowedRules.elements[u],o=c.allowedRules.generic,u=c.disallowedRules.elements[u],c=c.disallowedRules.generic,l=a.skipRequired;var d,p,m={valid:!1,validAttributes:{},validClasses:{},validStyles:{},allAttributes:!1,allClasses:!1,allStyles:!1,hadInvalidAttribute:!1,hadInvalidClass:!1,hadInvalidStyle:!1};if(e||o){if(h(n),u)for(d=0,p=u.length;d<p;++d)if(!1===i(u[d],n,m)){e=null;break e}if(c)for(d=0,p=c.length;d<p;++d)i(c[d],n,m);if(e)for(d=0,p=e.length;d<p;++d)t(e[d],n,m,l);if(o)for(d=0,p=o.length;d<p;++d)t(o[d],n,m,l);e=m}else e=null}if(!e||!e.valid)return r.push(n),1;p=e.validAttributes;var v=e.validStyles;o=e.validClasses,u=n.attributes;var y=n.styles;c=n.classes,l=n.classBackup;var b,T,E=n.styleBackup,C=[],w=(m=[],/^data-cke-/);if(d=!1,delete u.style,delete u.class,delete n.classBackup,delete n.styleBackup,!e.allAttributes)for(b in u)p[b]||w.test(b)&&(b==(T=b.replace(/^data-cke-saved-/,""))||p[T])||(delete u[b],d=!0);if(!e.allStyles||e.hadInvalidStyle){for(b in y)e.allStyles||v[b]?C.push(b+":"+y[b]):d=!0;C.length&&(u.style=C.sort().join("; "))}else E&&(u.style=E);if(!e.allClasses||e.hadInvalidClass){for(b=0;b<c.length;++b)(e.allClasses||o[c[b]])&&m.push(c[b]);m.length&&(u.class=m.sort().join(" ")),l&&m.length<l.split(/\s+/).length&&(d=!0)}else l&&(u.class=l);if(d&&(s=1),!a.skipFinalValidation&&!g(n))return r.push(n),1}return a.toHtml&&(n.name=n.name.replace(N,"cke:$1")),s}function f(e){var t,n=e.attributes;delete n.style,delete n.class,(t=CKEDITOR.tools.writeCssText(e.styles,!0))&&(n.style=t),e.classes.length&&(n.class=e.classes.sort().join(" "))}function g(e){switch(e.name){case"a":if(!(e.children.length||e.attributes.name||e.attributes.id))return!1;break;case"img":if(!e.attributes.src)return!1}return!0}function m(e){if(!e)return!1;if(!0===e)return!0;var t=function(e){var t,n=[];for(t in e)-1<t.indexOf("*")&&n.push(t.replace(/\*/g,".*"));return n.length?new RegExp("^(?:"+n.join("|")+")$"):null}(e);return function(n){return n in e||t&&n.match(t)}}function v(){return new CKEDITOR.htmlParser.element("br")}function y(e){return e.type==CKEDITOR.NODE_ELEMENT&&("br"==e.name||k.$block[e.name])}function b(e,t,n){var i=e.name;if(k.$empty[i]||!e.children.length)"hr"==i&&"br"==t?e.replaceWith(v()):(e.parent&&n.push({check:"it",el:e.parent}),e.remove());else if(k.$block[i]||"tr"==i)if("br"==t)e.previous&&!y(e.previous)&&(t=v()).insertBefore(e),e.next&&!y(e.next)&&(t=v()).insertAfter(e),e.replaceWithChildren();else{var r;i=e.children;e:{r=k[t];for(var a,o=0,s=i.length;o<s;++o)if((a=i[o]).type==CKEDITOR.NODE_ELEMENT&&!r[a.name]){r=!1;break e}r=!0}if(r)e.name=t,e.attributes={},n.push({check:"parent-down",el:e});else{var l,u;for(o=(r=e.parent).type==CKEDITOR.NODE_DOCUMENT_FRAGMENT||"body"==r.name,s=i.length;0<s;)a=i[--s],o&&(a.type==CKEDITOR.NODE_TEXT||a.type==CKEDITOR.NODE_ELEMENT&&k.$inline[a.name])?(l||((l=new CKEDITOR.htmlParser.element(t)).insertAfter(e),n.push({check:"parent-down",el:l})),l.add(a,0)):(l=null,u=k[r.name]||k.span,a.insertAfter(e),r.type==CKEDITOR.NODE_DOCUMENT_FRAGMENT||a.type!=CKEDITOR.NODE_ELEMENT||u[a.name]||n.push({check:"el-up",el:a}));e.remove()}}else i in{style:1,script:1}?e.remove():(e.parent&&n.push({check:"it",el:e.parent}),e.replaceWithChildren())}function _(e,t,n){var i,r;for(i=0;i<n.length;++i)if(!((r=n[i]).check&&!e.check(r.check,!1)||r.left&&!r.left(t))){r.right(t,D);break}}function T(e,t){var n,i,r,a,o=t.getDefinition(),s=o.attributes,l=o.styles;if(e.name!=o.element)return!1;for(n in s)if("class"==n){for(o=s[n].split(/\s+/),r=e.classes.join("|");a=o.pop();)if(-1==r.indexOf(a))return!1}else if(e.attributes[n]!=s[n])return!1;for(i in l)if(e.styles[i]!=l[i])return!1;return!0}function E(e,t){var n,i;return"string"==typeof e?n=e:e instanceof CKEDITOR.style?i=e:(n=e[0],i=e[1]),[{element:n,left:i,right:function(e,n){n.transform(e,t)}}]}function C(e){return function(t){return T(t,e)}}function w(e){return function(t,n){n[e](t)}}var k=CKEDITOR.dtd,S=CKEDITOR.tools.copy,I=CKEDITOR.tools.trim,O=["","p","br","div"];CKEDITOR.FILTER_SKIP_TREE=2,CKEDITOR.filter=function(e){if(this.allowedContent=[],this.disallowedContent=[],this.elementCallbacks=null,this.disabled=!1,this.editor=null,this.id=CKEDITOR.tools.getNextNumber(),this._={allowedRules:{elements:{},generic:[]},disallowedRules:{elements:{},generic:[]},transformations:{},cachedTests:{}},CKEDITOR.filter.instances[this.id]=this,e instanceof CKEDITOR.editor){e=this.editor=e,this.customConfig=!0;var t=e.config.allowedContent;!0===t?this.disabled=!0:(t||(this.customConfig=!1),this.allow(t,"config",1),this.allow(e.config.extraAllowedContent,"extra",1),this.allow(O[e.enterMode]+" "+O[e.shiftEnterMode],"default",1),this.disallow(e.config.disallowedContent))}else this.customConfig=!1,this.allow(e,"default",1)},CKEDITOR.filter.instances={},CKEDITOR.filter.prototype={allow:function(t,n,i){if(!a(this,t,i))return!1;var r,o;if("string"==typeof t)t=c(t);else if(t instanceof CKEDITOR.style){if(t.toAllowedContentRules)return this.allow(t.toAllowedContentRules(this.editor),n,i);r=t.getDefinition(),t={},i=r.attributes,t[r.element]=r={styles:r.styles,requiredStyles:r.styles&&CKEDITOR.tools.objectKeys(r.styles)},i&&(i=S(i),r.classes=i.class?i.class.split(/\s+/):null,r.requiredClasses=r.classes,delete i.class,r.attributes=i,r.requiredAttributes=i&&CKEDITOR.tools.objectKeys(i))}else if(CKEDITOR.tools.isArray(t)){for(r=0;r<t.length;++r)o=this.allow(t[r],n,i);return o}return e(this,t,n,this.allowedContent,this._.allowedRules),!0},applyTo:function(e,t,n,i){if(this.disabled)return!1;var r,a,o,s=this,l=[],u=this.editor&&this.editor.config.protectedSource,c=!1,d={doFilter:!n,doTransform:!0,doCallbacks:!0,toHtml:t};for(e.forEach(function(e){if(e.type==CKEDITOR.NODE_ELEMENT){if("off"==e.attributes["data-cke-filter"])return!1;if(!t||"span"!=e.name||!~CKEDITOR.tools.objectKeys(e.attributes).join("|").indexOf("data-cke-"))if(1&(r=p(s,e,l,d)))c=!0;else if(2&r)return!1}else if(e.type==CKEDITOR.NODE_COMMENT&&e.value.match(/^\{cke_protected\}(?!\{C\})/)){var n;e:{var i,a,o,h=decodeURIComponent(e.value.replace(/^\{cke_protected\}/,""));if(n=[],u)for(a=0;a<u.length;++a)if((o=h.match(u[a]))&&o[0].length==h.length){n=!0;break e}1==(h=CKEDITOR.htmlParser.fragment.fromHtml(h)).children.length&&(i=h.children[0]).type==CKEDITOR.NODE_ELEMENT&&p(s,i,n,d),n=!n.length}n||l.push(e)}},null,!0),l.length&&(c=!0),e=[],i=O[i||(this.editor?this.editor.enterMode:CKEDITOR.ENTER_P)];n=l.pop();)n.type==CKEDITOR.NODE_ELEMENT?b(n,i,e):n.remove();for(;a=e.pop();)if((n=a.el).parent)switch(o=k[n.parent.name]||k.span,a.check){case"it":k.$removeEmpty[n.name]&&!n.children.length?b(n,i,e):g(n)||b(n,i,e);break;case"el-up":n.parent.type==CKEDITOR.NODE_DOCUMENT_FRAGMENT||o[n.name]||b(n,i,e);break;case"parent-down":n.parent.type==CKEDITOR.NODE_DOCUMENT_FRAGMENT||o[n.name]||b(n.parent,i,e)}return c},checkFeature:function(e){return!(!this.disabled&&e)||(e.toFeature&&(e=e.toFeature(this.editor)),!e.requiredContent||this.check(e.requiredContent))},disable:function(){this.disabled=!0},disallow:function(t){return!!a(this,t,!0)&&("string"==typeof t&&(t=c(t)),e(this,t,null,this.disallowedContent,this._.disallowedRules),!0)},addContentForms:function(e){if(!this.disabled&&e){var t,n,i,r=[];for(t=0;t<e.length&&!i;++t)("string"==typeof(n=e[t])||n instanceof CKEDITOR.style)&&this.check(n)&&(i=n);if(i){for(t=0;t<e.length;++t)r.push(E(e[t],i));this.addTransformations(r)}}},addElementCallback:function(e){this.elementCallbacks||(this.elementCallbacks=[]),this.elementCallbacks.push(e)},addFeature:function(e){return!(!this.disabled&&e)||(e.toFeature&&(e=e.toFeature(this.editor)),this.allow(e.allowedContent,e.name),this.addTransformations(e.contentTransformations),this.addContentForms(e.contentForms),!e.requiredContent||!this.customConfig&&!this.disallowedContent.length||this.check(e.requiredContent))},addTransformations:function(e){var t,n;if(!this.disabled&&e){var i,r=this._.transformations;for(i=0;i<e.length;++i){t=e[i];var a=void 0,o=void 0,s=void 0,l=void 0,u=void 0,c=void 0;for(n=[],o=0;o<t.length;++o)"string"==typeof(s=t[o])?(l=(s=s.split(/\s*:\s*/))[0],u=null,c=s[1]):(l=s.check,u=s.left,c=s.right),a||(a=(a=s).element?a.element:l?l.match(/^([a-z0-9]+)/i)[0]:a.left.getDefinition().element),u instanceof CKEDITOR.style&&(u=C(u)),n.push({check:l==a?null:l,left:u,right:"string"==typeof c?w(c):c});r[t=a]||(r[t]=[]),r[t].push(n)}}},check:function(e,t,n){if(this.disabled)return!0;if(CKEDITOR.tools.isArray(e)){for(var i=e.length;i--;)if(this.check(e[i],t,n))return!0;return!1}var r,a;if("string"==typeof e){if((a=e+"<"+(!1===t?"0":"1")+(n?"1":"0")+">")in this._.cachedChecks)return this._.cachedChecks[a];r=(i=c(e).$1).styles;var o=i.classes;i.name=i.elements,i.classes=o=o?o.split(/\s*,\s*/):[],i.styles=u(r),i.attributes=u(i.attributes),i.children=[],o.length&&(i.attributes.class=o.join(" ")),r&&(i.attributes.style=CKEDITOR.tools.writeCssText(i.styles)),r=i}else r=(i=e.getDefinition()).styles,o=i.attributes||{},r&&!CKEDITOR.tools.isEmpty(r)?(r=S(r),o.style=CKEDITOR.tools.writeCssText(r,!0)):r={},r={name:i.element,attributes:o,classes:o.class?o.class.split(/\s+/):[],styles:r,children:[]};o=CKEDITOR.tools.clone(r);var s,l=[];if(!1!==t&&(s=this._.transformations[r.name])){for(i=0;i<s.length;++i)_(this,r,s[i]);f(r)}return p(this,o,l,{doFilter:!0,doTransform:!1!==t,skipRequired:!n,skipFinalValidation:!n}),t=!(0<l.length||!CKEDITOR.tools.objectCompare(r.attributes,o.attributes,!0)),"string"==typeof e&&(this._.cachedChecks[a]=t),t},getAllowedEnterMode:function(){var e=["p","div","br"],t={p:CKEDITOR.ENTER_P,div:CKEDITOR.ENTER_DIV,br:CKEDITOR.ENTER_BR};return function(n,i){var r,a=e.slice();if(this.check(O[n]))return n;for(i||(a=a.reverse());r=a.pop();)if(this.check(r))return t[r];return CKEDITOR.ENTER_BR}}(),destroy:function(){delete CKEDITOR.filter.instances[this.id],delete this._,delete this.allowedContent,delete this.disallowedContent}};var D,R={styles:1,attributes:1,classes:1},x={styles:"requiredStyles",attributes:"requiredAttributes",classes:"requiredClasses"},A=/^([a-z0-9\-*\s]+)((?:\s*\{[!\w\-,\s\*]+\}\s*|\s*\[[!\w\-,\s\*]+\]\s*|\s*\([!\w\-,\s\*]+\)\s*){0,3})(?:;\s*|$)/i,P={styles:/{([^}]+)}/,attrs:/\[([^\]]+)\]/,classes:/\(([^\)]+)\)/},L=/^cke:(object|embed|param)$/,N=/^(object|embed|param)$/;D=CKEDITOR.filter.transformationsTools={sizeToStyle:function(e){this.lengthToStyle(e,"width"),this.lengthToStyle(e,"height")},sizeToAttribute:function(e){this.lengthToAttribute(e,"width"),this.lengthToAttribute(e,"height")},lengthToStyle:function(e,t,n){if(!((n=n||t)in e.styles)){var i=e.attributes[t];i&&(/^\d+$/.test(i)&&(i+="px"),e.styles[n]=i)}delete e.attributes[t]},lengthToAttribute:function(e,t,n){if(!((n=n||t)in e.attributes)){var i=e.styles[t],r=i&&i.match(/^(\d+)(?:\.\d*)?px$/);r?e.attributes[n]=r[1]:"cke-test"==i&&(e.attributes[n]="cke-test")}delete e.styles[t]},alignmentToStyle:function(e){if(!("float"in e.styles)){var t=e.attributes.align;"left"!=t&&"right"!=t||(e.styles.float=t)}delete e.attributes.align},alignmentToAttribute:function(e){if(!("align"in e.attributes)){var t=e.styles.float;"left"!=t&&"right"!=t||(e.attributes.align=t)}delete e.styles.float},splitBorderShorthand:function(e){function t(t){e.styles["border-top-width"]=n[t[0]],e.styles["border-right-width"]=n[t[1]],e.styles["border-bottom-width"]=n[t[2]],e.styles["border-left-width"]=n[t[3]]}if(e.styles.border){var n=e.styles.border.match(/([\.\d]+\w+)/g)||["0px"];switch(n.length){case 1:e.styles["border-width"]=n[0];break;case 2:t([0,1,0,1]);break;case 3:t([0,1,2,1]);break;case 4:t([0,1,2,3])}e.styles["border-style"]=e.styles["border-style"]||(e.styles.border.match(/(none|hidden|dotted|dashed|solid|double|groove|ridge|inset|outset|initial|inherit)/)||[])[0],e.styles["border-style"]||delete e.styles["border-style"],delete e.styles.border}},listTypeToStyle:function(e){if(e.attributes.type)switch(e.attributes.type){case"a":e.styles["list-style-type"]="lower-alpha";break;case"A":e.styles["list-style-type"]="upper-alpha";break;case"i":e.styles["list-style-type"]="lower-roman";break;case"I":e.styles["list-style-type"]="upper-roman";break;case"1":e.styles["list-style-type"]="decimal";break;default:e.styles["list-style-type"]=e.attributes.type}},splitMarginShorthand:function(e){function t(t){e.styles["margin-top"]=n[t[0]],e.styles["margin-right"]=n[t[1]],e.styles["margin-bottom"]=n[t[2]],e.styles["margin-left"]=n[t[3]]}if(e.styles.margin){var n=e.styles.margin.match(/(\-?[\.\d]+\w+)/g)||["0px"];switch(n.length){case 1:e.styles.margin=n[0];break;case 2:t([0,1,0,1]);break;case 3:t([0,1,2,1]);break;case 4:t([0,1,2,3])}delete e.styles.margin}},matchesStyle:T,transform:function(e,t){if("string"==typeof t)e.name=t;else{var n,i,r,a,o=t.getDefinition(),s=o.styles,l=o.attributes;for(n in e.name=o.element,l)if("class"==n)for(o=e.classes.join("|"),r=l[n].split(/\s+/);a=r.pop();)-1==o.indexOf(a)&&e.classes.push(a);else e.attributes[n]=l[n];for(i in s)e.styles[i]=s[i]}}}}(),CKEDITOR.focusManager=function(e){return e.focusManager?e.focusManager:(this.hasFocus=!1,this.currentActive=null,this._={editor:e},this)},CKEDITOR.focusManager._={blurDelay:200},CKEDITOR.focusManager.prototype={focus:function(e){this._.timer&&clearTimeout(this._.timer),e&&(this.currentActive=e),this.hasFocus||this._.locked||((e=CKEDITOR.currentInstance)&&e.focusManager.blur(1),this.hasFocus=!0,(e=this._.editor.container)&&e.addClass("cke_focus"),this._.editor.fire("focus"))},lock:function(){this._.locked=1},unlock:function(){delete this._.locked},blur:function(e){function t(){var e=this._.editor;this.hasFocus&&(this.hasFocus=!1,CKEDITOR.env.chrome&&e.editable().isInline()&&e.window.$.getSelection().removeAllRanges(),(e=this._.editor.container)&&e.removeClass("cke_focus"),this._.editor.fire("blur"))}if(!this._.locked){this._.timer&&clearTimeout(this._.timer);var n=CKEDITOR.focusManager._.blurDelay;e||!n?t.call(this):this._.timer=CKEDITOR.tools.setTimeout(function(){delete this._.timer,t.call(this)},n,this)}},add:function(e,t){if(!(n=e.getCustomData("focusmanager"))||n!=this){n&&n.remove(e);var n="focus",i="blur";t&&(CKEDITOR.env.ie?(n="focusin",i="focusout"):CKEDITOR.event.useCapture=1);var r={blur:function(){e.equals(this.currentActive)&&this.blur()},focus:function(){this.focus(e)}};e.on(n,r.focus,this),e.on(i,r.blur,this),t&&(CKEDITOR.event.useCapture=0),e.setCustomData("focusmanager",this),e.setCustomData("focusmanager_handlers",r)}},remove:function(e){e.removeCustomData("focusmanager");var t=e.removeCustomData("focusmanager_handlers");e.removeListener("blur",t.blur),e.removeListener("focus",t.focus)}},CKEDITOR.keystrokeHandler=function(e){return e.keystrokeHandler?e.keystrokeHandler:(this.keystrokes={},this.blockedKeystrokes={},this._={editor:e},this)},function(){var e,t=function(t){var n=(t=t.data).getKeystroke(),i=this.keystrokes[n],r=this._.editor;return(e=!1===r.fire("key",{keyCode:n,domEvent:t}))||(i&&(e=!1!==r.execCommand(i,{from:"keystrokeHandler"})),e||(e=!!this.blockedKeystrokes[n])),e&&t.preventDefault(!0),!e},n=function(t){e&&(e=!1,t.data.preventDefault(!0))};CKEDITOR.keystrokeHandler.prototype={attach:function(e){e.on("keydown",t,this),CKEDITOR.env.gecko&&CKEDITOR.env.mac&&e.on("keypress",n,this)}}}(),CKEDITOR.lang={languages:{af:1,ar:1,az:1,bg:1,bn:1,bs:1,ca:1,cs:1,cy:1,da:1,de:1,"de-ch":1,el:1,"en-au":1,"en-ca":1,"en-gb":1,en:1,eo:1,es:1,et:1,eu:1,fa:1,fi:1,fo:1,"fr-ca":1,fr:1,gl:1,gu:1,he:1,hi:1,hr:1,hu:1,id:1,is:1,it:1,ja:1,ka:1,km:1,ko:1,ku:1,lt:1,lv:1,mk:1,mn:1,ms:1,nb:1,nl:1,no:1,oc:1,pl:1,"pt-br":1,pt:1,ro:1,ru:1,si:1,sk:1,sl:1,sq:1,"sr-latn":1,sr:1,sv:1,th:1,tr:1,tt:1,ug:1,uk:1,vi:1,"zh-cn":1,zh:1},rtl:{ar:1,fa:1,he:1,ku:1,ug:1},load:function(e,t,n){e&&CKEDITOR.lang.languages[e]||(e=this.detect(t,e));var i=this;t=function(){i[e].dir=i.rtl[e]?"rtl":"ltr",n(e,i[e])},this[e]?t():CKEDITOR.scriptLoader.load(CKEDITOR.getUrl("lang/"+e+".js"),t,this)},detect:function(e,t){var n=this.languages,i=(r=(t=t||navigator.userLanguage||navigator.language||e).toLowerCase().match(/([a-z]+)(?:-([a-z]+))?/))[1],r=r[2];return n[i+"-"+r]?i=i+"-"+r:n[i]||(i=null),CKEDITOR.lang.detect=i?function(){return i}:function(e){return e},i||e}},CKEDITOR.scriptLoader=function(){var e={},t={};return{load:function(n,i,r,a){var o="string"==typeof n;o&&(n=[n]),r||(r=CKEDITOR);var s=n.length,l=[],u=[],c=function(e){i&&(o?i.call(r,e):i.call(r,l,u))};if(0===s)c(!0);else{var d=function(e,t){(t?l:u).push(e),0>=--s&&(a&&CKEDITOR.document.getDocumentElement().removeStyle("cursor"),c(t))},h=function(n,i){e[n]=1;var r=t[n];delete t[n];for(var a=0;a<r.length;a++)r[a](n,i)},p=function(n){if(e[n])d(n,!0);else{var r=t[n]||(t[n]=[]);if(r.push(d),!(1<r.length)){var a=new CKEDITOR.dom.element("script");a.setAttributes({type:"text/javascript",src:n}),i&&(CKEDITOR.env.ie&&(8>=CKEDITOR.env.version||CKEDITOR.env.ie9Compat)?a.$.onreadystatechange=function(){"loaded"!=a.$.readyState&&"complete"!=a.$.readyState||(a.$.onreadystatechange=null,h(n,!0))}:(a.$.onload=function(){setTimeout(function(){h(n,!0)},0)},a.$.onerror=function(){h(n,!1)})),a.appendTo(CKEDITOR.document.getHead())}}};a&&CKEDITOR.document.getDocumentElement().setStyle("cursor","wait");for(var f=0;f<s;f++)p(n[f])}},queue:function(){function e(){var e;(e=t[0])&&this.load(e.scriptUrl,e.callback,CKEDITOR,0)}var t=[];return function(n,i){var r=this;t.push({scriptUrl:n,callback:function(){i&&i.apply(this,arguments),t.shift(),e.call(r)}}),1==t.length&&e.call(this)}}()}}(),CKEDITOR.resourceManager=function(e,t){this.basePath=e,this.fileName=t,this.registered={},this.loaded={},this.externals={},this._={waitingList:{}}},CKEDITOR.resourceManager.prototype={add:function(e,t){if(this.registered[e])throw Error('[CKEDITOR.resourceManager.add] The resource name "'+e+'" is already registered.');var n=this.registered[e]=t||{};return n.name=e,n.path=this.getPath(e),CKEDITOR.fire(e+CKEDITOR.tools.capitalize(this.fileName)+"Ready",n),this.get(e)},get:function(e){return this.registered[e]||null},getPath:function(e){var t=this.externals[e];return CKEDITOR.getUrl(t&&t.dir||this.basePath+e+"/")},getFilePath:function(e){var t=this.externals[e];return CKEDITOR.getUrl(this.getPath(e)+(t?t.file:this.fileName+".js"))},addExternal:function(e,t,n){e=e.split(",");for(var i=0;i<e.length;i++){var r=e[i];n||(t=t.replace(/[^\/]+$/,function(e){return n=e,""})),this.externals[r]={dir:t,file:n||this.fileName+".js"}}},load:function(e,t,n){CKEDITOR.tools.isArray(e)||(e=e?[e]:[]);for(var i=this.loaded,r=this.registered,a=[],o={},s={},l=0;l<e.length;l++){var u=e[l];if(u)if(i[u]||r[u])s[u]=this.get(u);else{var c=this.getFilePath(u);a.push(c),c in o||(o[c]=[]),o[c].push(u)}}CKEDITOR.scriptLoader.load(a,function(e,r){if(r.length)throw Error('[CKEDITOR.resourceManager.load] Resource name "'+o[r[0]].join(",")+'" was not found at "'+r[0]+'".');for(var a=0;a<e.length;a++)for(var l=o[e[a]],u=0;u<l.length;u++){var c=l[u];s[c]=this.get(c),i[c]=1}t.call(n,s)},this)}},CKEDITOR.plugins=new CKEDITOR.resourceManager("plugins/","plugin"),CKEDITOR.plugins.load=CKEDITOR.tools.override(CKEDITOR.plugins.load,function(e){var t={};return function(n,i,r){var a={},o=function(n){e.call(this,n,function(e){CKEDITOR.tools.extend(a,e);var n,s=[];for(n in e){var l=e[n],u=l&&l.requires;if(!t[n]){if(l.icons)for(var c=l.icons.split(","),d=c.length;d--;)CKEDITOR.skin.addIcon(c[d],l.path+"icons/"+(CKEDITOR.env.hidpi&&l.hidpi?"hidpi/":"")+c[d]+".png");t[n]=1}if(u)for(u.split&&(u=u.split(",")),l=0;l<u.length;l++)a[u[l]]||s.push(u[l])}if(s.length)o.call(this,s);else{for(n in a)(l=a[n]).onLoad&&!l.onLoad._called&&(!1===l.onLoad()&&delete a[n],l.onLoad._called=1);i&&i.call(r||window,a)}},this)};o.call(this,n)}}),CKEDITOR.plugins.setLang=function(e,t,n){var i=this.get(e);e=i.langEntries||(i.langEntries={}),(i=i.lang||(i.lang=[])).split&&(i=i.split(",")),-1==CKEDITOR.tools.indexOf(i,t)&&i.push(t),e[t]=n},CKEDITOR.ui=function(e){return e.ui?e.ui:(this.items={},this.instances={},this.editor=e,this._={handlers:{}},this)},CKEDITOR.ui.prototype={add:function(e,t,n){n.name=e.toLowerCase();var i=this.items[e]={type:t,command:n.command||null,args:Array.prototype.slice.call(arguments,2)};CKEDITOR.tools.extend(i,n)},get:function(e){return this.instances[e]},create:function(e){var t=this.items[e],n=t&&this._.handlers[t.type],i=t&&t.command&&this.editor.getCommand(t.command);return n=n&&n.create.apply(this,t.args),this.instances[e]=n,i&&i.uiItems.push(n),n&&!n.type&&(n.type=t.type),n},addHandler:function(e,t){this._.handlers[e]=t},space:function(e){return CKEDITOR.document.getById(this.spaceId(e))},spaceId:function(e){return this.editor.id+"_"+e}},CKEDITOR.event.implementOn(CKEDITOR.ui),function(){function e(e,n,r){if(CKEDITOR.event.call(this),e=e&&CKEDITOR.tools.clone(e),void 0!==n){if(!(n instanceof CKEDITOR.dom.element))throw Error("Expect element of type CKEDITOR.dom.element.");if(!r)throw Error("One of the element modes must be specified.");if(CKEDITOR.env.ie&&CKEDITOR.env.quirks&&r==CKEDITOR.ELEMENT_MODE_INLINE)throw Error("Inline element mode is not supported on IE quirks.");if(!function(e,t){return t==CKEDITOR.ELEMENT_MODE_INLINE?e.is(CKEDITOR.dtd.$editable)||e.is("textarea"):t==CKEDITOR.ELEMENT_MODE_REPLACE?!e.is(CKEDITOR.dtd.$nonBodyContent):1}(n,r))throw Error('The specified element mode is not supported on element: "'+n.getName()+'".');this.element=n,this.elementMode=r,this.name=this.elementMode!=CKEDITOR.ELEMENT_MODE_APPENDTO&&(n.getId()||n.getNameAtt())}else this.elementMode=CKEDITOR.ELEMENT_MODE_NONE;this._={},this.commands={},this.templates={},this.name=this.name||function(){do{var e="editor"+ ++a}while(CKEDITOR.instances[e]);return e}(),this.id=CKEDITOR.tools.getNextId(),this.status="unloaded",this.config=CKEDITOR.tools.prototypedCopy(CKEDITOR.config),this.ui=new CKEDITOR.ui(this),this.focusManager=new CKEDITOR.focusManager(this),this.keystrokeHandler=new CKEDITOR.keystrokeHandler(this),this.on("readOnly",t),this.on("selectionChange",function(e){i(this,e.data.path)}),this.on("activeFilterChange",function(){i(this,this.elementPath(),!0)}),this.on("mode",t),this.on("instanceReady",function(){this.config.startupFocus&&this.focus()}),CKEDITOR.fire("instanceCreated",null,this),CKEDITOR.add(this),CKEDITOR.tools.setTimeout(function(){"destroyed"!==this.status?function(e,t){e.on("customConfigLoaded",function(){if(t){if(t.on)for(var n in t.on)e.on(n,t.on[n]);CKEDITOR.tools.extend(e.config,t,!0),delete e.config.on}n=e.config,e.readOnly=!!n.readOnly||(e.elementMode==CKEDITOR.ELEMENT_MODE_INLINE?e.element.is("textarea")?e.element.hasAttribute("disabled")||e.element.hasAttribute("readonly"):e.element.isReadOnly():e.elementMode==CKEDITOR.ELEMENT_MODE_REPLACE&&(e.element.hasAttribute("disabled")||e.element.hasAttribute("readonly"))),e.blockless=e.elementMode==CKEDITOR.ELEMENT_MODE_INLINE&&!(e.element.is("textarea")||CKEDITOR.dtd[e.element.getName()].p),e.tabIndex=n.tabIndex||e.element&&e.element.getAttribute("tabindex")||0,e.activeEnterMode=e.enterMode=e.blockless?CKEDITOR.ENTER_BR:n.enterMode,e.activeShiftEnterMode=e.shiftEnterMode=e.blockless?CKEDITOR.ENTER_BR:n.shiftEnterMode,n.skin&&(CKEDITOR.skinName=n.skin),e.fireOnce("configLoaded"),e.dataProcessor=new CKEDITOR.htmlDataProcessor(e),e.filter=e.activeFilter=new CKEDITOR.filter(e),function(e){CKEDITOR.skin.loadPart("editor",function(){!function(e){CKEDITOR.lang.load(e.config.language,e.config.defaultLanguage,function(t,n){var i=e.config.title;e.langCode=t,e.lang=CKEDITOR.tools.prototypedCopy(n),e.title="string"==typeof i||!1===i?i:[e.lang.editor,e.name].join(", "),e.config.contentsLangDirection||(e.config.contentsLangDirection=e.elementMode==CKEDITOR.ELEMENT_MODE_INLINE?e.element.getDirection(1):e.lang.dir),e.fire("langLoaded"),function(e){e.getStylesSet(function(t){e.once("loaded",function(){e.fire("stylesSet",{styles:t})},null,null,1),function(e){var t=e.config,n=t.plugins,i=t.extraPlugins,r=t.removePlugins;if(i){var a=new RegExp("(?:^|,)(?:"+i.replace(/\s*,\s*/g,"|")+")(?=,|$)","g");n=(n=n.replace(a,""))+","+i}if(r){var o=new RegExp("(?:^|,)(?:"+r.replace(/\s*,\s*/g,"|")+")(?=,|$)","g");n=n.replace(o,"")}CKEDITOR.env.air&&(n+=",adobeair"),CKEDITOR.plugins.load(n.split(","),function(n){var i=[],r=[],a=[];for(var s in e.plugins=n,n){var l,u=n[s],c=u.lang,d=null,h=u.requires;if(CKEDITOR.tools.isArray(h)&&(h=h.join(",")),h&&(l=h.match(o)))for(;h=l.pop();)CKEDITOR.error("editor-plugin-required",{plugin:h.replace(",",""),requiredBy:s});c&&!e.lang[s]&&(c.split&&(c=c.split(",")),d=0<=CKEDITOR.tools.indexOf(c,e.langCode)?e.langCode:(d=e.langCode.replace(/-.*/,""))!=e.langCode&&0<=CKEDITOR.tools.indexOf(c,d)?d:0<=CKEDITOR.tools.indexOf(c,"en")?"en":c[0],u.langEntries&&u.langEntries[d]?(e.lang[s]=u.langEntries[d],d=null):a.push(CKEDITOR.getUrl(u.path+"lang/"+d+".js"))),r.push(d),i.push(u)}CKEDITOR.scriptLoader.load(a,function(){for(var n=["beforeInit","init","afterInit"],a=0;a<n.length;a++)for(var o=0;o<i.length;o++){var s=i[o];0===a&&r[o]&&s.lang&&s.langEntries&&(e.lang[s.name]=s.langEntries[r[o]]),s[n[a]]&&s[n[a]](e)}for(e.fireOnce("pluginsLoaded"),t.keystrokes&&e.setKeystroke(e.config.keystrokes),o=0;o<e.config.blockedKeystrokes.length;o++)e.keystrokeHandler.blockedKeystrokes[e.config.blockedKeystrokes[o]]=1;e.status="loaded",e.fireOnce("loaded"),CKEDITOR.fire("instanceLoaded",null,e)})})}(e)})}(e)})}(e)})}(e)}),t&&null!=t.customConfig&&(e.config.customConfig=t.customConfig),function e(t){if(!(n=t.config.customConfig))return!1;var n=CKEDITOR.getUrl(n),i=o[n]||(o[n]={});return i.fn?(i.fn.call(t,t.config),CKEDITOR.getUrl(t.config.customConfig)!=n&&e(t)||t.fireOnce("customConfigLoaded")):CKEDITOR.scriptLoader.queue(n,function(){i.fn=CKEDITOR.editorConfig?CKEDITOR.editorConfig:function(){},e(t)}),!0}(e)||e.fireOnce("customConfigLoaded")}(this,e):CKEDITOR.warn("editor-incorrect-destroy")},0,this)}function t(){var e,t=this.commands;for(e in t)n(this,t[e])}function n(e,t){t[t.startDisabled?"disable":e.readOnly&&!t.readOnly?"disable":t.modes[e.mode]?"enable":"disable"]()}function i(e,t,n){if(t){var i,r,a=e.commands;for(r in a)i=a[r],(n||i.contextSensitive)&&i.refresh(e,t)}}function r(){var e=this.element;if(e&&this.elementMode!=CKEDITOR.ELEMENT_MODE_APPENDTO){var t=this.getData();return this.config.htmlEncodeOutput&&(t=CKEDITOR.tools.htmlEncode(t)),e.is("textarea")?e.setValue(t):e.setHtml(t),!0}return!1}e.prototype=CKEDITOR.editor.prototype,CKEDITOR.editor=e;var a=0,o={};CKEDITOR.tools.extend(CKEDITOR.editor.prototype,{addCommand:function(e,t){t.name=e.toLowerCase();var i=new CKEDITOR.command(this,t);return this.mode&&n(this,i),this.commands[e]=i},_attachToForm:function(){function e(e){t.updateElement(),t._.required&&!n.getValue()&&!1===t.fire("required")&&e.data.preventDefault()}var t=this,n=t.element,i=new CKEDITOR.dom.element(n.$.form);n.is("textarea")&&i&&(i.on("submit",e),function(e){return!!(e&&e.call&&e.apply)}(i.$.submit)&&(i.$.submit=CKEDITOR.tools.override(i.$.submit,function(t){return function(){e(),t.apply?t.apply(this):t()}})),t.on("destroy",function(){i.removeListener("submit",e)}))},destroy:function(e){this.fire("beforeDestroy"),!e&&r.call(this),this.editable(null),this.filter&&(this.filter.destroy(),delete this.filter),delete this.activeFilter,this.status="destroyed",this.fire("destroy"),this.removeAllListeners(),CKEDITOR.remove(this),CKEDITOR.fire("instanceDestroyed",null,this)},elementPath:function(e){if(!e){if(!(e=this.getSelection()))return null;e=e.getStartElement()}return e?new CKEDITOR.dom.elementPath(e,this.editable()):null},createRange:function(){var e=this.editable();return e?new CKEDITOR.dom.range(e):null},execCommand:function(e,t){var n=this.getCommand(e),i={name:e,commandData:t,command:n};return!(!n||n.state==CKEDITOR.TRISTATE_DISABLED||!1===this.fire("beforeCommandExec",i)||(i.returnValue=n.exec(i.commandData),n.async||!1===this.fire("afterCommandExec",i)))&&i.returnValue},getCommand:function(e){return this.commands[e]},getData:function(e){!e&&this.fire("beforeGetData");var t=this._.data;return"string"!=typeof t&&(t=(t=this.element)&&this.elementMode==CKEDITOR.ELEMENT_MODE_REPLACE?t.is("textarea")?t.getValue():t.getHtml():""),t={dataValue:t},!e&&this.fire("getData",t),t.dataValue},getSnapshot:function(){var e=this.fire("getSnapshot");return"string"!=typeof e&&(e=(e=this.element)&&this.elementMode==CKEDITOR.ELEMENT_MODE_REPLACE?e.is("textarea")?e.getValue():e.getHtml():""),e},loadSnapshot:function(e){this.fire("loadSnapshot",e)},setData:function(e,t,n){var i=!0,r=t;t&&"object"==typeof t&&(n=t.internal,r=t.callback,i=!t.noSnapshot),!n&&i&&this.fire("saveSnapshot"),!r&&n||this.once("dataReady",function(e){!n&&i&&this.fire("saveSnapshot"),r&&r.call(e.editor)}),e={dataValue:e},!n&&this.fire("setData",e),this._.data=e.dataValue,!n&&this.fire("afterSetData",e)},setReadOnly:function(e){e=null==e||e,this.readOnly!=e&&(this.readOnly=e,this.keystrokeHandler.blockedKeystrokes[8]=+e,this.editable().setReadOnly(e),this.fire("readOnly"))},insertHtml:function(e,t,n){this.fire("insertHtml",{dataValue:e,mode:t,range:n})},insertText:function(e){this.fire("insertText",e)},insertElement:function(e){this.fire("insertElement",e)},getSelectedHtml:function(e){var t=this.editable(),n=(n=this.getSelection())&&n.getRanges();if(!t||!n||0===n.length)return null;for(var i,r,a,o=new CKEDITOR.dom.documentFragment,s=0;s<n.length;s++){var l=n[s],u=l.startContainer;u.getName&&"tr"==u.getName()?(i||((i=u.getAscendant("table").clone()).append(u.getAscendant("tbody").clone()),o.append(i),i=i.findOne("tbody")),r&&r.equals(u)||(r=u,a=u.clone(),i.append(a)),a.append(l.cloneContents())):o.append(l.cloneContents())}return t=i?o:t.getHtmlFromRange(n[0]),e?t.getHtml():t},extractSelectedHtml:function(e,t){var n=this.editable(),i=this.getSelection().getRanges();return n&&0!==i.length?(i=i[0],n=n.extractHtmlFromRange(i,t),t||this.getSelection().selectRanges([i]),e?n.getHtml():n):null},focus:function(){this.fire("beforeFocus")},checkDirty:function(){return"ready"==this.status&&this._.previousValue!==this.getSnapshot()},resetDirty:function(){this._.previousValue=this.getSnapshot()},updateElement:function(){return r.call(this)},setKeystroke:function(){for(var e,t,n=this.keystrokeHandler.keystrokes,i=CKEDITOR.tools.isArray(arguments[0])?arguments[0]:[[].slice.call(arguments,0)],r=i.length;r--;)e=i[r],t=0,CKEDITOR.tools.isArray(e)&&(t=e[1],e=e[0]),t?n[e]=t:delete n[e]},getCommandKeystroke:function(e){var t,n=e.name,i=this.keystrokeHandler.keystrokes;if(e.fakeKeystroke)return e.fakeKeystroke;for(t in i)if(i.hasOwnProperty(t)&&i[t]==n)return t;return null},addFeature:function(e){return this.filter.addFeature(e)},setActiveFilter:function(e){e||(e=this.filter),this.activeFilter!==e&&(this.activeFilter=e,this.fire("activeFilterChange"),e===this.filter?this.setActiveEnterMode(null,null):this.setActiveEnterMode(e.getAllowedEnterMode(this.enterMode),e.getAllowedEnterMode(this.shiftEnterMode,!0)))},setActiveEnterMode:function(e,t){e=e?this.blockless?CKEDITOR.ENTER_BR:e:this.enterMode,t=t?this.blockless?CKEDITOR.ENTER_BR:t:this.shiftEnterMode,this.activeEnterMode==e&&this.activeShiftEnterMode==t||(this.activeEnterMode=e,this.activeShiftEnterMode=t,this.fire("activeEnterModeChange"))},showNotification:function(e){alert(e)}})}(),CKEDITOR.ELEMENT_MODE_NONE=0,CKEDITOR.ELEMENT_MODE_REPLACE=1,CKEDITOR.ELEMENT_MODE_APPENDTO=2,CKEDITOR.ELEMENT_MODE_INLINE=3,CKEDITOR.htmlParser=function(){this._={htmlPartsRegex:/<(?:(?:\/([^>]+)>)|(?:!--([\S|\s]*?)--\x3e)|(?:([^\/\s>]+)((?:\s+[\w\-:.]+(?:\s*=\s*?(?:(?:"[^"]*")|(?:'[^']*')|[^\s"'\/>]+))?)*)[\S\s]*?(\/?)>))/g}},function(){var e=/([\w\-:.]+)(?:(?:\s*=\s*(?:(?:"([^"]*)")|(?:'([^']*)')|([^\s>]+)))|(?=\s|$))/g,t={checked:1,compact:1,declare:1,defer:1,disabled:1,ismap:1,multiple:1,nohref:1,noresize:1,noshade:1,nowrap:1,readonly:1,selected:1};CKEDITOR.htmlParser.prototype={onTagOpen:function(){},onTagClose:function(){},onText:function(){},onCDATA:function(){},onComment:function(){},parse:function(n){for(var i,r,a,o=0;i=this._.htmlPartsRegex.exec(n);)if((r=i.index)>o&&(o=n.substring(o,r),a?a.push(o):this.onText(o)),o=this._.htmlPartsRegex.lastIndex,!(r=i[1])||(r=r.toLowerCase(),a&&CKEDITOR.dtd.$cdata[r]&&(this.onCDATA(a.join("")),a=null),a))if(a)a.push(i[0]);else if(r=i[3]){if(r=r.toLowerCase(),!/="/.test(r)){var s,l={},u=i[4];if(i=!!i[5],u)for(;s=e.exec(u);){var c=s[1].toLowerCase();s=s[2]||s[3]||s[4]||"",l[c]=!s&&t[c]?c:CKEDITOR.tools.htmlDecodeAttr(s)}this.onTagOpen(r,l,i),!a&&CKEDITOR.dtd.$cdata[r]&&(a=[])}}else(r=i[2])&&this.onComment(r);else this.onTagClose(r);n.length>o&&this.onText(n.substring(o,n.length))}}}(),CKEDITOR.htmlParser.basicWriter=CKEDITOR.tools.createClass({$:function(){this._={output:[]}},proto:{openTag:function(e){this._.output.push("<",e)},openTagClose:function(e,t){t?this._.output.push(" />"):this._.output.push(">")},attribute:function(e,t){"string"==typeof t&&(t=CKEDITOR.tools.htmlEncodeAttr(t)),this._.output.push(" ",e,'="',t,'"')},closeTag:function(e){this._.output.push("</",e,">")},text:function(e){this._.output.push(e)},comment:function(e){this._.output.push("\x3c!--",e,"--\x3e")},write:function(e){this._.output.push(e)},reset:function(){this._.output=[],this._.indent=!1},getHtml:function(e){var t=this._.output.join("");return e&&this.reset(),t}}}),CKEDITOR.htmlParser.node=function(){},CKEDITOR.htmlParser.node.prototype={remove:function(){var e=this.parent.children,t=CKEDITOR.tools.indexOf(e,this),n=this.previous,i=this.next;n&&(n.next=i),i&&(i.previous=n),e.splice(t,1),this.parent=null},replaceWith:function(e){var t=this.parent.children,n=CKEDITOR.tools.indexOf(t,this),i=e.previous=this.previous,r=e.next=this.next;i&&(i.next=e),r&&(r.previous=e),t[n]=e,e.parent=this.parent,this.parent=null},insertAfter:function(e){var t=e.parent.children,n=CKEDITOR.tools.indexOf(t,e),i=e.next;t.splice(n+1,0,this),this.next=e.next,this.previous=e,e.next=this,i&&(i.previous=this),this.parent=e.parent},insertBefore:function(e){var t=e.parent.children,n=CKEDITOR.tools.indexOf(t,e);t.splice(n,0,this),this.next=e,(this.previous=e.previous)&&(e.previous.next=this),e.previous=this,this.parent=e.parent},getAscendant:function(e){for(var t="function"==typeof e?e:"string"==typeof e?function(t){return t.name==e}:function(t){return t.name in e},n=this.parent;n&&n.type==CKEDITOR.NODE_ELEMENT;){if(t(n))return n;n=n.parent}return null},wrapWith:function(e){return this.replaceWith(e),e.add(this),e},getIndex:function(){return CKEDITOR.tools.indexOf(this.parent.children,this)},getFilterContext:function(e){return e||{}}},CKEDITOR.htmlParser.comment=function(e){this.value=e,this._={isBlockLike:!1}},CKEDITOR.htmlParser.comment.prototype=CKEDITOR.tools.extend(new CKEDITOR.htmlParser.node,{type:CKEDITOR.NODE_COMMENT,filter:function(e,t){var n=this.value;return(n=e.onComment(t,n,this))?"string"!=typeof n?(this.replaceWith(n),!1):(this.value=n,!0):(this.remove(),!1)},writeHtml:function(e,t){t&&this.filter(t),e.comment(this.value)}}),CKEDITOR.htmlParser.text=function(e){this.value=e,this._={isBlockLike:!1}},CKEDITOR.htmlParser.text.prototype=CKEDITOR.tools.extend(new CKEDITOR.htmlParser.node,{type:CKEDITOR.NODE_TEXT,filter:function(e,t){if(!(this.value=e.onText(t,this.value,this)))return this.remove(),!1},writeHtml:function(e,t){t&&this.filter(t),e.text(this.value)}}),CKEDITOR.htmlParser.cdata=function(e){this.value=e},CKEDITOR.htmlParser.cdata.prototype=CKEDITOR.tools.extend(new CKEDITOR.htmlParser.node,{type:CKEDITOR.NODE_TEXT,filter:function(){},writeHtml:function(e){e.write(this.value)}}),CKEDITOR.htmlParser.fragment=function(){this.children=[],this.parent=null,this._={isBlockLike:!0,hasInlineStarted:!1}},function(){function e(e){return!e.attributes["data-cke-survive"]&&("a"==e.name&&e.attributes.href||CKEDITOR.dtd.$removeEmpty[e.name])}var t=CKEDITOR.tools.extend({table:1,ul:1,ol:1,dl:1},CKEDITOR.dtd.table,CKEDITOR.dtd.ul,CKEDITOR.dtd.ol,CKEDITOR.dtd.dl),n={ol:1,ul:1},i=CKEDITOR.tools.extend({},{html:1},CKEDITOR.dtd.html,CKEDITOR.dtd.body,CKEDITOR.dtd.head,{style:1,script:1}),r={ul:"li",ol:"li",dl:"dd",table:"tbody",tbody:"tr",thead:"tr",tfoot:"tr",tr:"td"};CKEDITOR.htmlParser.fragment.fromHtml=function(a,o,s){function l(e){var t;if(0<m.length)for(var n=0;n<m.length;n++){var i=m[n],r=i.name,a=CKEDITOR.dtd[r],o=y.name&&CKEDITOR.dtd[y.name];o&&!o[r]||e&&a&&!a[e]&&CKEDITOR.dtd[e]?r==y.name&&(d(y,y.parent,1),n--):(t||(u(),t=1),(i=i.clone()).parent=y,y=i,m.splice(n,1),n--)}}function u(){for(;v.length;)d(v.shift(),y)}function c(e){if(e._.isBlockLike&&"pre"!=e.name&&"textarea"!=e.name){var t,n=e.children.length,i=e.children[n-1];i&&i.type==CKEDITOR.NODE_TEXT&&((t=CKEDITOR.tools.rtrim(i.value))?i.value=t:e.children.length=n-1)}}function d(t,n,i){n=n||y||g;var r=y;void 0===t.previous&&(h(n,t)&&(y=n,f.onTagOpen(s,{}),t.returnPoint=n=y),c(t),e(t)&&!t.children.length||n.add(t),"pre"==t.name&&(_=!1),"textarea"==t.name&&(b=!1)),t.returnPoint?(y=t.returnPoint,delete t.returnPoint):y=i?n:r}function h(e,t){var n,i;if((e==g||"body"==e.name)&&s&&(!e.name||CKEDITOR.dtd[e.name][s]))return(n=t.attributes&&(i=t.attributes["data-cke-real-element-type"])?i:t.name)&&n in CKEDITOR.dtd.$inline&&!(n in CKEDITOR.dtd.head)&&!t.isOrphan||t.type==CKEDITOR.NODE_TEXT}function p(e,t){return(e in CKEDITOR.dtd.$listItem||e in CKEDITOR.dtd.$tableContent)&&(e==t||"dt"==e&&"dd"==t||"dd"==e&&"dt"==t)}var f=new CKEDITOR.htmlParser,g=o instanceof CKEDITOR.htmlParser.element?o:"string"==typeof o?new CKEDITOR.htmlParser.element(o):new CKEDITOR.htmlParser.fragment,m=[],v=[],y=g,b="textarea"==g.name,_="pre"==g.name;for(f.onTagOpen=function(r,a,o,s){if((a=new CKEDITOR.htmlParser.element(r,a)).isUnknown&&o&&(a.isEmpty=!0),a.isOptionalClose=s,e(a))m.push(a);else{if("pre"==r)_=!0;else{if("br"==r&&_)return void y.add(new CKEDITOR.htmlParser.text("\n"));"textarea"==r&&(b=!0)}if("br"==r)v.push(a);else{for(;s=(o=y.name)?CKEDITOR.dtd[o]||(y._.isBlockLike?CKEDITOR.dtd.div:CKEDITOR.dtd.span):i,!(a.isUnknown||y.isUnknown||s[r]);)if(y.isOptionalClose)f.onTagClose(o);else if(r in n&&o in n)(o=(o=y.children)[o.length-1])&&"li"==o.name||d(o=new CKEDITOR.htmlParser.element("li"),y),!a.returnPoint&&(a.returnPoint=y),y=o;else if(r in CKEDITOR.dtd.$listItem&&!p(r,o))f.onTagOpen("li"==r?"ul":"dl",{},0,1);else if(o in t&&!p(r,o))!a.returnPoint&&(a.returnPoint=y),y=y.parent;else{if(o in CKEDITOR.dtd.$inline&&m.unshift(y),!y.parent){a.isOrphan=1;break}d(y,y.parent,1)}l(r),u(),a.parent=y,a.isEmpty?d(a):y=a}}},f.onTagClose=function(e){for(var t=m.length-1;0<=t;t--)if(e==m[t].name)return void m.splice(t,1);for(var n=[],i=[],r=y;r!=g&&r.name!=e;)r._.isBlockLike||i.unshift(r),n.push(r),r=r.returnPoint||r.parent;if(r!=g){for(t=0;t<n.length;t++){var a=n[t];d(a,a.parent)}y=r,r._.isBlockLike&&u(),d(r,r.parent),r==y&&(y=y.parent),m=m.concat(i)}"body"==e&&(s=!1)},f.onText=function(e){if(y._.hasInlineStarted&&!v.length||_||b||0!==(e=CKEDITOR.tools.ltrim(e)).length){var n=y.name,a=n?CKEDITOR.dtd[n]||(y._.isBlockLike?CKEDITOR.dtd.div:CKEDITOR.dtd.span):i;!b&&!a["#"]&&n in t?(f.onTagOpen(r[n]||""),f.onText(e)):(u(),l(),_||b||(e=e.replace(/[\t\r\n ]{2,}|[\t\r\n]/g," ")),e=new CKEDITOR.htmlParser.text(e),h(y,e)&&this.onTagOpen(s,{},0,1),y.add(e))}},f.onCDATA=function(e){y.add(new CKEDITOR.htmlParser.cdata(e))},f.onComment=function(e){u(),l(),y.add(new CKEDITOR.htmlParser.comment(e))},f.parse(a),u();y!=g;)d(y,y.parent,1);return c(g),g},CKEDITOR.htmlParser.fragment.prototype={type:CKEDITOR.NODE_DOCUMENT_FRAGMENT,add:function(e,t){isNaN(t)&&(t=this.children.length);var n=0<t?this.children[t-1]:null;if(n){if(e._.isBlockLike&&n.type==CKEDITOR.NODE_TEXT&&(n.value=CKEDITOR.tools.rtrim(n.value),0===n.value.length))return this.children.pop(),void this.add(e);n.next=e}e.previous=n,e.parent=this,this.children.splice(t,0,e),this._.hasInlineStarted||(this._.hasInlineStarted=e.type==CKEDITOR.NODE_TEXT||e.type==CKEDITOR.NODE_ELEMENT&&!e._.isBlockLike)},filter:function(e,t){t=this.getFilterContext(t),e.onRoot(t,this),this.filterChildren(e,!1,t)},filterChildren:function(e,t,n){if(this.childrenFilteredBy!=e.id)for(n=this.getFilterContext(n),t&&!this.parent&&e.onRoot(n,this),this.childrenFilteredBy=e.id,t=0;t<this.children.length;t++)!1===this.children[t].filter(e,n)&&t--},writeHtml:function(e,t){t&&this.filter(t),this.writeChildrenHtml(e)},writeChildrenHtml:function(e,t,n){var i=this.getFilterContext();for(n&&!this.parent&&t&&t.onRoot(i,this),t&&this.filterChildren(t,!1,i),t=0,i=(n=this.children).length;t<i;t++)n[t].writeHtml(e)},forEach:function(e,t,n){if(!(n||t&&this.type!=t))var i=e(this);if(!1!==i){n=this.children;for(var r=0;r<n.length;r++)(i=n[r]).type==CKEDITOR.NODE_ELEMENT?i.forEach(e,t):t&&i.type!=t||e(i)}},getFilterContext:function(e){return e||{}}}}(),function(){function e(){this.rules=[]}function t(t,n,i,r){var a,o;for(a in n)(o=t[a])||(o=t[a]=new e),o.add(n[a],i,r)}CKEDITOR.htmlParser.filter=CKEDITOR.tools.createClass({$:function(t){this.id=CKEDITOR.tools.getNextNumber(),this.elementNameRules=new e,this.attributeNameRules=new e,this.elementsRules={},this.attributesRules={},this.textRules=new e,this.commentRules=new e,this.rootRules=new e,t&&this.addRules(t,10)},proto:{addRules:function(e,n){var i;"number"==typeof n?i=n:n&&"priority"in n&&(i=n.priority),"number"!=typeof i&&(i=10),"object"!=typeof n&&(n={}),e.elementNames&&this.elementNameRules.addMany(e.elementNames,i,n),e.attributeNames&&this.attributeNameRules.addMany(e.attributeNames,i,n),e.elements&&t(this.elementsRules,e.elements,i,n),e.attributes&&t(this.attributesRules,e.attributes,i,n),e.text&&this.textRules.add(e.text,i,n),e.comment&&this.commentRules.add(e.comment,i,n),e.root&&this.rootRules.add(e.root,i,n)},applyTo:function(e){e.filter(this)},onElementName:function(e,t){return this.elementNameRules.execOnName(e,t)},onAttributeName:function(e,t){return this.attributeNameRules.execOnName(e,t)},onText:function(e,t,n){return this.textRules.exec(e,t,n)},onComment:function(e,t,n){return this.commentRules.exec(e,t,n)},onRoot:function(e,t){return this.rootRules.exec(e,t)},onElement:function(e,t){for(var n,i=[this.elementsRules["^"],this.elementsRules[t.name],this.elementsRules.$],r=0;3>r;r++)if(n=i[r]){if(!1===(n=n.exec(e,t,this)))return null;if(n&&n!=t)return this.onNode(e,n);if(t.parent&&!t.name)break}return t},onNode:function(e,t){var n=t.type;return n==CKEDITOR.NODE_ELEMENT?this.onElement(e,t):n==CKEDITOR.NODE_TEXT?new CKEDITOR.htmlParser.text(this.onText(e,t.value)):n==CKEDITOR.NODE_COMMENT?new CKEDITOR.htmlParser.comment(this.onComment(e,t.value)):null},onAttribute:function(e,t,n,i){return(n=this.attributesRules[n])?n.exec(e,i,t,this):i}}}),CKEDITOR.htmlParser.filterRulesGroup=e,e.prototype={add:function(e,t,n){this.rules.splice(this.findIndex(t),0,{value:e,priority:t,options:n})},addMany:function(e,t,n){for(var i=[this.findIndex(t),0],r=0,a=e.length;r<a;r++)i.push({value:e[r],priority:t,options:n});this.rules.splice.apply(this.rules,i)},findIndex:function(e){for(var t=this.rules,n=t.length-1;0<=n&&e<t[n].priority;)n--;return n+1},exec:function(e,t){var n,i,r,a,o=t instanceof CKEDITOR.htmlParser.node||t instanceof CKEDITOR.htmlParser.fragment,s=Array.prototype.slice.call(arguments,1),l=this.rules,u=l.length;for(a=0;a<u;a++)if(o&&(n=t.type,i=t.name),r=l[a],!(e.nonEditable&&!r.options.applyToAll||e.nestedEditable&&r.options.excludeNestedEditable)){if(!1===(r=r.value.apply(null,s))||o&&r&&(r.name!=i||r.type!=n))return r;null!=r&&(s[0]=t=r)}return t},execOnName:function(e,t){for(var n,i=0,r=this.rules,a=r.length;t&&i<a;i++)n=r[i],e.nonEditable&&!n.options.applyToAll||e.nestedEditable&&n.options.excludeNestedEditable||(t=t.replace(n.value[0],n.value[1]));return t}}}(),function(){function e(e,t){function s(e){return e||CKEDITOR.env.needsNbspFiller?new CKEDITOR.htmlParser.text(" "):new CKEDITOR.htmlParser.element("br",{"data-cke-bogus":1})}function l(e,t){return function(r){if(r.type!=CKEDITOR.NODE_DOCUMENT_FRAGMENT){var o,l,c=[],d=n(r);if(d)for(u(d,1)&&c.push(d);d;)a(d)&&(o=i(d))&&u(o)&&((l=i(o))&&!a(l)?c.push(o):(s(p).insertAfter(o),o.remove())),d=d.previous;for(d=0;d<c.length;d++)c[d].remove();(c=!e||!1!==("function"==typeof t?t(r):t))&&(c=!(!p&&!CKEDITOR.env.needsBrFiller&&r.type==CKEDITOR.NODE_DOCUMENT_FRAGMENT||!p&&!CKEDITOR.env.needsBrFiller&&(7<document.documentMode||r.name in CKEDITOR.dtd.tr||r.name in CKEDITOR.dtd.$listItem)||(c=n(r))&&("form"!=r.name||"input"!=c.name))),c&&r.add(s(e))}}}function u(e,t){return!(p&&!CKEDITOR.env.needsBrFiller||e.type!=CKEDITOR.NODE_ELEMENT||"br"!=e.name||e.attributes["data-cke-eol"])||!!(e.type==CKEDITOR.NODE_TEXT&&(n=e.value.match(h))&&(n.index&&(new CKEDITOR.htmlParser.text(e.value.substring(0,n.index)).insertBefore(e),e.value=n[0]),!CKEDITOR.env.needsBrFiller&&p&&(!t||e.parent.name in g)||!p&&((n=e.previous)&&"br"==n.name||!n||a(n))));var n}var c,d={elements:{}},p="html"==t,g=CKEDITOR.tools.extend({},m);for(c in g)"#"in f[c]||delete g[c];for(c in g)d.elements[c]=l(p,e.config.fillEmptyBlocks);return d.root=l(p,!1),d.elements.br=function(e){return function(t){if(t.parent.type!=CKEDITOR.NODE_DOCUMENT_FRAGMENT){var n=t.attributes;if("data-cke-bogus"in n||"data-cke-eol"in n)delete n["data-cke-bogus"];else{for(n=t.next;n&&r(n);)n=n.next;var l=i(t);!n&&a(t.parent)?o(t.parent,s(e)):a(n)&&l&&!a(l)&&s(e).insertBefore(n)}}}}(p),d}function t(e,t){return e!=CKEDITOR.ENTER_BR&&!1!==t&&(e==CKEDITOR.ENTER_DIV?"div":"p")}function n(e){for(e=e.children[e.children.length-1];e&&r(e);)e=e.previous;return e}function i(e){for(e=e.previous;e&&r(e);)e=e.previous;return e}function r(e){return e.type==CKEDITOR.NODE_TEXT&&!CKEDITOR.tools.trim(e.value)||e.type==CKEDITOR.NODE_ELEMENT&&e.attributes["data-cke-bookmark"]}function a(e){return e&&(e.type==CKEDITOR.NODE_ELEMENT&&e.name in m||e.type==CKEDITOR.NODE_DOCUMENT_FRAGMENT)}function o(e,t){var n=e.children[e.children.length-1];e.children.push(t),t.parent=e,n&&(n.next=t,t.previous=n)}function s(e){"false"!=(e=e.attributes).contenteditable&&(e["data-cke-editable"]=e.contenteditable?"true":1),e.contenteditable="false"}function l(e){switch((e=e.attributes)["data-cke-editable"]){case"true":e.contenteditable="true";break;case"1":delete e.contenteditable}}function u(e,t){return e.replace(t,function(e,t,n){return 0===e.indexOf("<textarea")&&(e=t+c(n).replace(/</g,"&lt;").replace(/>/g,"&gt;")+"</textarea>"),"<cke:encoded>"+encodeURIComponent(e)+"</cke:encoded>"})}function c(e){return e.replace(/\x3c!--\{cke_protected\}\{C\}([\s\S]+?)--\x3e/g,function(e,t){return decodeURIComponent(t)})}function d(e,t){var n=t._.dataStore;return e.replace(/\x3c!--\{cke_protected\}([\s\S]+?)--\x3e/g,function(e,t){return decodeURIComponent(t)}).replace(/\{cke_protected_(\d+)\}/g,function(e,t){return n&&n[t]||""})}CKEDITOR.htmlDataProcessor=function(n){var i,r,a=this;this.editor=n,this.dataFilter=i=new CKEDITOR.htmlParser.filter,this.htmlFilter=r=new CKEDITOR.htmlParser.filter,this.writer=new CKEDITOR.htmlParser.basicWriter,i.addRules(v),i.addRules(y,{applyToAll:!0}),i.addRules(e(n,"data"),{applyToAll:!0}),r.addRules(b),r.addRules(_,{applyToAll:!0}),r.addRules(e(n,"html"),{applyToAll:!0}),n.on("toHtml",function(e){var i,r,a=(a=(a=(a=(a=u(a=function(e){return e.replace(T,function(e,t,n){return"<"+t+n.replace(E,function(e,t){return C.test(t)&&-1==n.indexOf("data-cke-saved-"+t)?" data-cke-saved-"+e+" data-cke-"+CKEDITOR.rnd+"-"+e:e})+">"})}(a=u(a=function(e,t){var n=[],i=t.config.protectedSource,r=t._.dataStore||(t._.dataStore={id:1}),a=/<\!--\{cke_temp(comment)?\}(\d*?)--\x3e/g;i=[/<script[\s\S]*?(<\/script>|$)/gi,/<noscript[\s\S]*?<\/noscript>/gi,/<meta[\s\S]*?\/?>/gi].concat(i),e=e.replace(/\x3c!--[\s\S]*?--\x3e/g,function(e){return"\x3c!--{cke_tempcomment}"+(n.push(e)-1)+"--\x3e"});for(var o=0;o<i.length;o++)e=e.replace(i[o],function(e){return e=e.replace(a,function(e,t,i){return n[i]}),/cke_temp(comment)?/.test(e)?e:"\x3c!--{cke_temp}"+(n.push(e)-1)+"--\x3e"});return(e=(e=e.replace(a,function(e,t,i){return"\x3c!--"+p+(t?"{C}":"")+encodeURIComponent(n[i]).replace(/--/g,"%2D%2D")+"--\x3e"})).replace(/<\w+(?:\s+(?:(?:[^\s=>]+\s*=\s*(?:[^'"\s>]+|'[^']*'|"[^"]*"))|[^\s=\/>]+))+\s*\/?>/g,function(e){return e.replace(/\x3c!--\{cke_protected\}([^>]*)--\x3e/g,function(e,t){return r[r.id]=decodeURIComponent(t),"{cke_protected_"+r.id+++"}"})})).replace(/<(title|iframe|textarea)([^>]*)>([\s\S]*?)<\/\1>/g,function(e,n,i,r){return"<"+n+i+">"+d(c(r),t)+"</"+n+">"})}(a=(e=e.data).dataValue,n),k)),w)).replace(I,"$1cke:$2")).replace(D,"<cke:$1$2></cke:$1>")).replace(/(<pre\b[^>]*>)(\r\n|\n)/g,"$1$2$2")).replace(/([^a-z0-9<\-])(on\w{3,})(?!>)/gi,"$1data-cke-"+CKEDITOR.rnd+"-$2");i=e.context||n.editable().getName(),CKEDITOR.env.ie&&9>CKEDITOR.env.version&&"pre"==i&&(i="div",a="<pre>"+a+"</pre>",r=1),(i=n.document.createElement(i)).setHtml("a"+a),a=(a=i.getHtml().substr(1)).replace(new RegExp("data-cke-"+CKEDITOR.rnd+"-","ig"),""),r&&(a=a.replace(/^<pre>|<\/pre>$/gi,"")),a=c(a=(a=a.replace(O,"$1$2")).replace(S,function(e,t){return decodeURIComponent(t)})),i=!1!==e.fixForBody&&t(e.enterMode,n.config.autoParagraph),a=CKEDITOR.htmlParser.fragment.fromHtml(a,e.context,i),i&&!(r=a).children.length&&CKEDITOR.dtd[r.name][i]&&(i=new CKEDITOR.htmlParser.element(i),r.add(i)),e.dataValue=a},null,null,5),n.on("toHtml",function(e){e.data.filter.applyTo(e.data.dataValue,!0,e.data.dontFilter,e.data.enterMode)&&n.fire("dataFiltered")},null,null,6),n.on("toHtml",function(e){e.data.dataValue.filterChildren(a.dataFilter,!0)},null,null,10),n.on("toHtml",function(e){var t=(e=e.data).dataValue,n=new CKEDITOR.htmlParser.basicWriter;t.writeChildrenHtml(n),t=n.getHtml(!0),e.dataValue=t.replace(/\x3c!--(?!{cke_protected})[\s\S]+?--\x3e/g,function(e){return"\x3c!--"+p+"{C}"+encodeURIComponent(e).replace(/--/g,"%2D%2D")+"--\x3e"})},null,null,15),n.on("toDataFormat",function(e){var i=e.data.dataValue;e.data.enterMode!=CKEDITOR.ENTER_BR&&(i=i.replace(/^<br *\/?>/i,"")),e.data.dataValue=CKEDITOR.htmlParser.fragment.fromHtml(i,e.data.context,t(e.data.enterMode,n.config.autoParagraph))},null,null,5),n.on("toDataFormat",function(e){e.data.dataValue.filterChildren(a.htmlFilter,!0)},null,null,10),n.on("toDataFormat",function(e){e.data.filter.applyTo(e.data.dataValue,!1,!0)},null,null,11),n.on("toDataFormat",function(e){var t=e.data.dataValue,i=a.writer;i.reset(),t.writeChildrenHtml(i),t=d(t=c(t=i.getHtml(!0)),n),e.data.dataValue=t},null,null,15)},CKEDITOR.htmlDataProcessor.prototype={toHtml:function(e,t,n,i){var r,a,o,s,l=this.editor;return t&&"object"==typeof t?(r=t.context,n=t.fixForBody,i=t.dontFilter,a=t.filter,o=t.enterMode,s=t.protectedWhitespaces):r=t,r||null===r||(r=l.editable().getName()),l.fire("toHtml",{dataValue:e,context:r,fixForBody:n,dontFilter:i,filter:a||l.filter,enterMode:o||l.enterMode,protectedWhitespaces:s}).dataValue},toDataFormat:function(e,t){var n,i,r;return t&&(n=t.context,i=t.filter,r=t.enterMode),n||null===n||(n=this.editor.editable().getName()),this.editor.fire("toDataFormat",{dataValue:e,filter:i||this.editor.filter,context:n,enterMode:r||this.editor.enterMode}).dataValue}};var h=/(?:&nbsp;|\xa0)$/,p="{cke_protected}",f=CKEDITOR.dtd,g="caption colgroup col thead tfoot tbody".split(" "),m=CKEDITOR.tools.extend({},f.$blockLimit,f.$block),v={elements:{input:s,textarea:s}},y={attributeNames:[[/^on/,"data-cke-pa-on"],[/^data-cke-expando$/,""]]},b={elements:{embed:function(e){if((n=e.parent)&&"object"==n.name){var t=n.attributes.width,n=n.attributes.height;t&&(e.attributes.width=t),n&&(e.attributes.height=n)}},a:function(e){var t=e.attributes;if(!(e.children.length||t.name||t.id||e.attributes["data-cke-saved-name"]))return!1}}},_={elementNames:[[/^cke:/,""],[/^\?xml:namespace$/,""]],attributeNames:[[/^data-cke-(saved|pa)-/,""],[/^data-cke-.*/,""],["hidefocus",""]],elements:{$:function(e){var t=e.attributes;if(t){if(t["data-cke-temp"])return!1;for(var n=["name","href","src"],i=0;i<n.length;i++)"data-cke-saved-"+n[i]in t&&delete t[n[i]]}return e},table:function(e){e.children.slice(0).sort(function(e,t){var n,i;return e.type==CKEDITOR.NODE_ELEMENT&&t.type==e.type&&(n=CKEDITOR.tools.indexOf(g,e.name),i=CKEDITOR.tools.indexOf(g,t.name)),-1<n&&-1<i&&n!=i||(n=e.parent?e.getIndex():-1,i=t.parent?t.getIndex():-1),n>i?1:-1})},param:function(e){return e.children=[],e.isEmpty=!0,e},span:function(e){"Apple-style-span"==e.attributes.class&&delete e.name},html:function(e){delete e.attributes.contenteditable,delete e.attributes.class},body:function(e){delete e.attributes.spellcheck,delete e.attributes.contenteditable},style:function(e){var t=e.children[0];t&&t.value&&(t.value=CKEDITOR.tools.trim(t.value)),e.attributes.type||(e.attributes.type="text/css")},title:function(e){var t=e.children[0];!t&&o(e,t=new CKEDITOR.htmlParser.text),t.value=e.attributes["data-cke-title"]||""},input:l,textarea:l},attributes:{class:function(e){return CKEDITOR.tools.ltrim(e.replace(/(?:^|\s+)cke_[^\s]*/g,""))||!1}}};CKEDITOR.env.ie&&(_.attributes.style=function(e){return e.replace(/(^|;)([^\:]+)/g,function(e){return e.toLowerCase()})});var T=/<(a|area|img|input|source)\b([^>]*)>/gi,E=/([\w-:]+)\s*=\s*(?:(?:"[^"]*")|(?:'[^']*')|(?:[^ "'>]+))/gi,C=/^(href|src|name)$/i,w=/(?:<style(?=[ >])[^>]*>[\s\S]*?<\/style>)|(?:<(:?link|meta|base)[^>]*>)/gi,k=/(<textarea(?=[ >])[^>]*>)([\s\S]*?)(?:<\/textarea>)/gi,S=/<cke:encoded>([^<]*)<\/cke:encoded>/gi,I=/(<\/?)((?:object|embed|param|html|body|head|title)[^>]*>)/gi,O=/(<\/?)cke:((?:html|body|head|title)[^>]*>)/gi,D=/<cke:(param|embed)([^>]*?)\/?>(?!\s*<\/cke:\1)/gi}(),CKEDITOR.htmlParser.element=function(e,t){this.name=e,this.attributes=t||{},this.children=[];var n=e||"",i=n.match(/^cke:(.*)/);i&&(n=i[1]),n=!!(CKEDITOR.dtd.$nonBodyContent[n]||CKEDITOR.dtd.$block[n]||CKEDITOR.dtd.$listItem[n]||CKEDITOR.dtd.$tableContent[n]||CKEDITOR.dtd.$nonEditable[n]||"br"==n),this.isEmpty=!!CKEDITOR.dtd.$empty[e],this.isUnknown=!CKEDITOR.dtd[e],this._={isBlockLike:n,hasInlineStarted:this.isEmpty||!n}},CKEDITOR.htmlParser.cssStyle=function(e){var t={};return((e instanceof CKEDITOR.htmlParser.element?e.attributes.style:e)||"").replace(/&quot;/g,'"').replace(/\s*([^ :;]+)\s*:\s*([^;]+)\s*(?=;|$)/g,function(e,n,i){"font-family"==n&&(i=i.replace(/["']/g,"")),t[n.toLowerCase()]=i}),{rules:t,populate:function(e){var t=this.toString();t&&(e instanceof CKEDITOR.dom.element?e.setAttribute("style",t):e instanceof CKEDITOR.htmlParser.element?e.attributes.style=t:e.style=t)},toString:function(){var e,n=[];for(e in t)t[e]&&n.push(e,":",t[e],";");return n.join("")}}},function(){var e=function(e,t){return(e=e[0])<(t=t[0])?-1:e>t?1:0},t=CKEDITOR.htmlParser.fragment.prototype;CKEDITOR.htmlParser.element.prototype=CKEDITOR.tools.extend(new CKEDITOR.htmlParser.node,{type:CKEDITOR.NODE_ELEMENT,add:t.add,clone:function(){return new CKEDITOR.htmlParser.element(this.name,this.attributes)},filter:function(e,t){var n,i,r,a,o=this;if((t=o.getFilterContext(t)).off)return!0;for(o.parent||e.onRoot(t,o);;){if(n=o.name,!(i=e.onElementName(t,n)))return this.remove(),!1;if(o.name=i,!(o=e.onElement(t,o)))return this.remove(),!1;if(o!==this)return this.replaceWith(o),!1;if(o.name==n)break;if(o.type!=CKEDITOR.NODE_ELEMENT)return this.replaceWith(o),!1;if(!o.name)return this.replaceWithChildren(),!1}for(r in n=o.attributes){for(i=n[r];;){if(!(a=e.onAttributeName(t,r))){delete n[r];break}if(a==r)break;delete n[r],r=a}a&&(!1===(i=e.onAttribute(t,o,a,i))?delete n[a]:n[a]=i)}return o.isEmpty||this.filterChildren(e,!1,t),!0},filterChildren:t.filterChildren,writeHtml:function(t,n){n&&this.filter(n);var i,r,a=this.name,o=[],s=this.attributes;for(i in t.openTag(a,s),s)o.push([i,s[i]]);for(t.sortAttributes&&o.sort(e),i=0,r=o.length;i<r;i++)s=o[i],t.attribute(s[0],s[1]);t.openTagClose(a,this.isEmpty),this.writeChildrenHtml(t),this.isEmpty||t.closeTag(a)},writeChildrenHtml:t.writeChildrenHtml,replaceWithChildren:function(){for(var e=this.children,t=e.length;t;)e[--t].insertAfter(this);this.remove()},forEach:t.forEach,getFirst:function(e){if(!e)return this.children.length?this.children[0]:null;"function"!=typeof e&&(e=function(e){return function(t){return t.type==CKEDITOR.NODE_ELEMENT&&("string"==typeof e?t.name==e:t.name in e)}}(e));for(var t=0,n=this.children.length;t<n;++t)if(e(this.children[t]))return this.children[t];return null},getHtml:function(){var e=new CKEDITOR.htmlParser.basicWriter;return this.writeChildrenHtml(e),e.getHtml()},setHtml:function(e){for(var t=0,n=(e=this.children=CKEDITOR.htmlParser.fragment.fromHtml(e).children).length;t<n;++t)e[t].parent=this},getOuterHtml:function(){var e=new CKEDITOR.htmlParser.basicWriter;return this.writeHtml(e),e.getHtml()},split:function(e){for(var t=this.children.splice(e,this.children.length-e),n=this.clone(),i=0;i<t.length;++i)t[i].parent=n;return n.children=t,t[0]&&(t[0].previous=null),0<e&&(this.children[e-1].next=null),this.parent.add(n,this.getIndex()+1),n},find:function(e,t){void 0===t&&(t=!1);var n,i=[];for(n=0;n<this.children.length;n++){var r=this.children[n];"function"==typeof e&&e(r)?i.push(r):"string"==typeof e&&r.name===e&&i.push(r),t&&r.find&&(i=i.concat(r.find(e,t)))}return i},addClass:function(e){if(!this.hasClass(e)){var t=this.attributes.class||"";this.attributes.class=t+(t?" ":"")+e}},removeClass:function(e){var t=this.attributes.class;t&&((t=CKEDITOR.tools.trim(t.replace(new RegExp("(?:\\s+|^)"+e+"(?:\\s+|$)")," ")))?this.attributes.class=t:delete this.attributes.class)},hasClass:function(e){var t=this.attributes.class;return!!t&&new RegExp("(?:^|\\s)"+e+"(?=\\s|$)").test(t)},getFilterContext:function(e){var t=[];if(e||(e={off:!1,nonEditable:!1,nestedEditable:!1}),e.off||"off"!=this.attributes["data-cke-processor"]||t.push("off",!0),e.nonEditable||"false"!=this.attributes.contenteditable?e.nonEditable&&!e.nestedEditable&&"true"==this.attributes.contenteditable&&t.push("nestedEditable",!0):t.push("nonEditable",!0),t.length){e=CKEDITOR.tools.copy(e);for(var n=0;n<t.length;n+=2)e[t[n]]=t[n+1]}return e}},!0)}(),function(){var e={},t=/{([^}]+)}/g,n=/([\\'])/g,i=/\n/g,r=/\r/g;CKEDITOR.template=function(a){if(e[a])this.output=e[a];else{var o=a.replace(n,"\\$1").replace(i,"\\n").replace(r,"\\r").replace(t,function(e,t){return"',data['"+t+"']==undefined?'{"+t+"}':data['"+t+"'],'"});this.output=e[a]=Function("data","buffer","return buffer?buffer.push('"+o+"'):['"+o+"'].join('');")}}}(),delete CKEDITOR.loadFullCore,CKEDITOR.instances={},CKEDITOR.document=new CKEDITOR.dom.document(document),CKEDITOR.add=function(e){CKEDITOR.instances[e.name]=e,e.on("focus",function(){CKEDITOR.currentInstance!=e&&(CKEDITOR.currentInstance=e,CKEDITOR.fire("currentInstance"))}),e.on("blur",function(){CKEDITOR.currentInstance==e&&(CKEDITOR.currentInstance=null,CKEDITOR.fire("currentInstance"))}),CKEDITOR.fire("instance",null,e)},CKEDITOR.remove=function(e){delete CKEDITOR.instances[e.name]},function(){var e={};CKEDITOR.addTemplate=function(t,n){var i=e[t];return i||(i={name:t,source:n},CKEDITOR.fire("template",i),e[t]=new CKEDITOR.template(i.source))},CKEDITOR.getTemplate=function(t){return e[t]}}(),function(){var e=[];CKEDITOR.addCss=function(t){e.push(t)},CKEDITOR.getCss=function(){return e.join("\n")}}(),CKEDITOR.on("instanceDestroyed",function(){CKEDITOR.tools.isEmpty(this.instances)&&CKEDITOR.fire("reset")}),CKEDITOR.TRISTATE_ON=1,CKEDITOR.TRISTATE_OFF=2,CKEDITOR.TRISTATE_DISABLED=0,CKEDITOR.inline=function(e,t){if(!CKEDITOR.env.isCompatible)return null;if((e=CKEDITOR.dom.element.get(e)).getEditor())throw'The editor instance "'+e.getEditor().name+'" is already attached to the provided element.';var n=new CKEDITOR.editor(t,e,CKEDITOR.ELEMENT_MODE_INLINE),i=e.is("textarea")?e:null;return i?(n.setData(i.getValue(),null,!0),(e=CKEDITOR.dom.element.createFromHtml('<div contenteditable="'+!!n.readOnly+'" class="cke_textarea_inline">'+i.getValue()+"</div>",CKEDITOR.document)).insertAfter(i),i.hide(),i.$.form&&n._attachToForm()):n.setData(e.getHtml(),null,!0),n.on("loaded",function(){n.fire("uiReady"),n.editable(e),n.container=e,n.ui.contentsElement=e,n.setData(n.getData(1)),n.resetDirty(),n.fire("contentDom"),n.mode="wysiwyg",n.fire("mode"),n.status="ready",n.fireOnce("instanceReady"),CKEDITOR.fire("instanceReady",null,n)},null,null,1e4),n.on("destroy",function(){i&&(n.container.clearCustomData(),n.container.remove(),i.show()),n.element.clearCustomData(),delete n.element}),n},CKEDITOR.inlineAll=function(){var e,t,n;for(n in CKEDITOR.dtd.$editable)for(var i=CKEDITOR.document.getElementsByTag(n),r=0,a=i.count();r<a;r++)"true"==(e=i.getItem(r)).getAttribute("contenteditable")&&(t={element:e,config:{}},!1!==CKEDITOR.fire("inline",t)&&CKEDITOR.inline(e,t.config))},CKEDITOR.domReady(function(){!CKEDITOR.disableAutoInline&&CKEDITOR.inlineAll()}),CKEDITOR.replaceClass="ckeditor",function(){function e(e,n,i,r){if(!CKEDITOR.env.isCompatible)return null;if((e=CKEDITOR.dom.element.get(e)).getEditor())throw'The editor instance "'+e.getEditor().name+'" is already attached to the provided element.';var a=new CKEDITOR.editor(n,e,r);return r==CKEDITOR.ELEMENT_MODE_REPLACE&&(e.setStyle("visibility","hidden"),a._.required=e.hasAttribute("required"),e.removeAttribute("required")),i&&a.setData(i,null,!0),a.on("loaded",function(){!function(e){var t=e.name,n=e.element,i=e.elementMode,r=e.fire("uiSpace",{space:"top",html:""}).html,a=e.fire("uiSpace",{space:"bottom",html:""}).html,o=new CKEDITOR.template('<{outerEl} id="cke_{name}" class="{id} cke cke_reset cke_chrome cke_editor_{name} cke_{langDir} '+CKEDITOR.env.cssClass+'"  dir="{langDir}" lang="{langCode}" role="application"'+(e.title?' aria-labelledby="cke_{name}_arialbl"':"")+">"+(e.title?'<span id="cke_{name}_arialbl" class="cke_voice_label">{voiceLabel}</span>':"")+'<{outerEl} class="cke_inner cke_reset" role="presentation">{topHtml}<{outerEl} id="{contentId}" class="cke_contents cke_reset" role="presentation"></{outerEl}>{bottomHtml}</{outerEl}></{outerEl}>');t=CKEDITOR.dom.element.createFromHtml(o.output({id:e.id,name:t,langDir:e.lang.dir,langCode:e.langCode,voiceLabel:e.title,topHtml:r?'<span id="'+e.ui.spaceId("top")+'" class="cke_top cke_reset_all" role="presentation" style="height:auto">'+r+"</span>":"",contentId:e.ui.spaceId("contents"),bottomHtml:a?'<span id="'+e.ui.spaceId("bottom")+'" class="cke_bottom cke_reset_all" role="presentation">'+a+"</span>":"",outerEl:CKEDITOR.env.ie?"span":"div"}));i==CKEDITOR.ELEMENT_MODE_REPLACE?(n.hide(),t.insertAfter(n)):n.append(t),e.container=t,e.ui.contentsElement=e.ui.space("contents"),r&&e.ui.space("top").unselectable(),a&&e.ui.space("bottom").unselectable(),n=e.config.width,i=e.config.height,n&&t.setStyle("width",CKEDITOR.tools.cssLength(n)),i&&e.ui.space("contents").setStyle("height",CKEDITOR.tools.cssLength(i)),t.disableContextMenu(),CKEDITOR.env.webkit&&t.on("focus",function(){e.focus()}),e.fireOnce("uiReady")}(a),r==CKEDITOR.ELEMENT_MODE_REPLACE&&a.config.autoUpdateElement&&e.$.form&&a._attachToForm(),a.setMode(a.config.startupMode,function(){a.resetDirty(),a.status="ready",a.fireOnce("instanceReady"),CKEDITOR.fire("instanceReady",null,a)})}),a.on("destroy",t),a}function t(){var e=this.container,t=this.element;e&&(e.clearCustomData(),e.remove()),t&&(t.clearCustomData(),this.elementMode==CKEDITOR.ELEMENT_MODE_REPLACE&&(t.show(),this._.required&&t.setAttribute("required","required")),delete this.element)}CKEDITOR.replace=function(t,n){return e(t,n,null,CKEDITOR.ELEMENT_MODE_REPLACE)},CKEDITOR.appendTo=function(t,n,i){return e(t,n,i,CKEDITOR.ELEMENT_MODE_APPENDTO)},CKEDITOR.replaceAll=function(){for(var e=document.getElementsByTagName("textarea"),t=0;t<e.length;t++){var n=null,i=e[t];if(i.name||i.id){if("string"==typeof arguments[0]){if(!new RegExp("(?:^|\\s)"+arguments[0]+"(?:$|\\s)").test(i.className))continue}else if("function"==typeof arguments[0]&&(n={},!1===arguments[0](i,n)))continue;this.replace(i,n)}}},CKEDITOR.editor.prototype.addMode=function(e,t){(this._.modes||(this._.modes={}))[e]=t},CKEDITOR.editor.prototype.setMode=function(e,t){var n=this,i=this._.modes;if(e!=n.mode&&i&&i[e]){if(n.fire("beforeSetMode",e),n.mode){var r,a=n.checkDirty(),o=(i=n._.previousModeData,0);n.fire("beforeModeUnload"),n.editable(0),n._.previousMode=n.mode,n._.previousModeData=r=n.getData(1),"source"==n.mode&&i==r&&(n.fire("lockSnapshot",{forceUpdate:!0}),o=1),n.ui.space("contents").setHtml(""),n.mode=""}else n._.previousModeData=n.getData(1);this._.modes[e](function(){n.mode=e,void 0!==a&&!a&&n.resetDirty(),o?n.fire("unlockSnapshot"):"wysiwyg"==e&&n.fire("saveSnapshot"),setTimeout(function(){n.fire("mode"),t&&t.call(n)},0)})}},CKEDITOR.editor.prototype.resize=function(e,t,n,i){var r=this.container,a=this.ui.space("contents"),o=CKEDITOR.env.webkit&&this.document&&this.document.getWindow().$.frameElement;(i=i?this.container.getFirst(function(e){return e.type==CKEDITOR.NODE_ELEMENT&&e.hasClass("cke_inner")}):r).setSize("width",e,!0),o&&(o.style.width="1%");var s=(i.$.offsetHeight||0)-(a.$.clientHeight||0);r=Math.max(t-(n?0:s),0),t=n?t+s:t,a.setStyle("height",r+"px"),o&&(o.style.width="100%"),this.fire("resize",{outerHeight:t,contentsHeight:r,outerWidth:e||i.getSize("width")})},CKEDITOR.editor.prototype.getResizable=function(e){return e?this.ui.space("contents"):this.container},CKEDITOR.domReady(function(){CKEDITOR.replaceClass&&CKEDITOR.replaceAll(CKEDITOR.replaceClass)})}(),CKEDITOR.config.startupMode="wysiwyg",function(){function e(e){var t,i=e.editor,a=e.data.path,o=a.blockLimit,s=e.data.selection,l=s.getRanges()[0];(CKEDITOR.env.gecko||CKEDITOR.env.ie&&CKEDITOR.env.needsBrFiller)&&(s=function(e,t){if(s.isFake)return 0;var i=t.block||t.blockLimit,r=i&&i.getLast(n);return!i||!i.isBlockBoundary()||r&&r.type==CKEDITOR.NODE_ELEMENT&&r.isBlockBoundary()||i.is("pre")||i.getBogus()?void 0:i}(0,a))&&(s.appendBogus(),t=CKEDITOR.env.ie),r(i,a.block,o)&&l.collapsed&&!l.getCommonAncestor().isReadOnly()&&((a=l.clone()).enlarge(CKEDITOR.ENLARGE_BLOCK_CONTENTS),(o=new CKEDITOR.dom.walker(a)).guard=function(e){return!n(e)||e.type==CKEDITOR.NODE_COMMENT||e.isReadOnly()},!o.checkForward()||a.checkStartOfBlock()&&a.checkEndOfBlock())&&(i=l.fixBlock(!0,i.activeEnterMode==CKEDITOR.ENTER_DIV?"div":"p"),CKEDITOR.env.needsBrFiller||(i=i.getFirst(n))&&i.type==CKEDITOR.NODE_TEXT&&CKEDITOR.tools.trim(i.getText()).match(/^(?:&nbsp;|\xa0)$/)&&i.remove(),t=1,e.cancel()),t&&l.select()}function t(e){var t=e.data.getTarget();t.is("input")&&("submit"!=(t=t.getAttribute("type"))&&"reset"!=t||e.data.preventDefault())}function n(e){return l(e)&&u(e)}function i(e){function t(e){return function(t,r){if(r&&t.type==CKEDITOR.NODE_ELEMENT&&t.is(a)&&(i=t),!(r||!n(t)||e&&d(t)))return!1}}var i,r=e.getRanges()[0];e=e.root;var a={table:1,ul:1,ol:1,dl:1};if(r.startPath().contains(a)){var o=r.clone();if(o.collapse(1),o.setStartAt(e,CKEDITOR.POSITION_AFTER_START),(e=new CKEDITOR.dom.walker(o)).guard=t(),e.checkBackward(),i)return(o=r.clone()).collapse(),o.setEndAt(i,CKEDITOR.POSITION_AFTER_END),(e=new CKEDITOR.dom.walker(o)).guard=t(!0),i=!1,e.checkForward(),i}return null}function r(e,t,n){return!1!==e.config.autoParagraph&&e.activeEnterMode!=CKEDITOR.ENTER_BR&&(e.editable().equals(n)&&!t||t&&"true"==t.getAttribute("contenteditable"))}function a(e){return e.activeEnterMode!=CKEDITOR.ENTER_BR&&!1!==e.config.autoParagraph&&(e.activeEnterMode==CKEDITOR.ENTER_DIV?"div":"p")}function o(e){var t=e.editor;t.getSelection().scrollIntoView(),setTimeout(function(){t.fire("saveSnapshot")},0)}function s(e,t,n){var i=e.getCommonAncestor(t);for(t=e=n?t:e;(e=e.getParent())&&!i.equals(e)&&1==e.getChildCount();)t=e;t.remove()}var l,u,c,d,h,p,f,g,m,v;CKEDITOR.editable=CKEDITOR.tools.createClass({base:CKEDITOR.dom.element,$:function(e,t){this.base(t.$||t),this.editor=e,this.status="unloaded",this.hasFocus=!1,this.setup()},proto:{focus:function(){var e;if(CKEDITOR.env.webkit&&!this.hasFocus&&(e=this.editor._.previousActive||this.getDocument().getActive(),this.contains(e)))e.focus();else{CKEDITOR.env.edge&&14<CKEDITOR.env.version&&!this.hasFocus&&this.getDocument().equals(CKEDITOR.document)&&(this.editor._.previousScrollTop=this.$.scrollTop);try{!CKEDITOR.env.ie||CKEDITOR.env.edge&&14<CKEDITOR.env.version||!this.getDocument().equals(CKEDITOR.document)?this.$.focus():this.$.setActive()}catch(e){if(!CKEDITOR.env.ie)throw e}CKEDITOR.env.safari&&!this.isInline()&&((e=CKEDITOR.document.getActive()).equals(this.getWindow().getFrame())||this.getWindow().focus())}},on:function(e,t){var n=Array.prototype.slice.call(arguments,0);return CKEDITOR.env.ie&&/^focus|blur$/.exec(e)&&(e="focus"==e?"focusin":"focusout",t=function(e,t){return function(n){var i=n.data.$.toElement||n.data.$.fromElement||n.data.$.relatedTarget;(i=i&&i.nodeType==CKEDITOR.NODE_ELEMENT?new CKEDITOR.dom.element(i):null)&&(t.equals(i)||t.contains(i))||e.call(this,n)}}(t,this),n[0]=e,n[1]=t),CKEDITOR.dom.element.prototype.on.apply(this,n)},attachListener:function(e){!this._.listeners&&(this._.listeners=[]);var t=Array.prototype.slice.call(arguments,1);return t=e.on.apply(e,t),this._.listeners.push(t),t},clearListeners:function(){var e=this._.listeners;try{for(;e.length;)e.pop().removeListener()}catch(e){}},restoreAttrs:function(){var e,t,n=this._.attrChanges;for(t in n)n.hasOwnProperty(t)&&(null!==(e=n[t])?this.setAttribute(t,e):this.removeAttribute(t))},attachClass:function(e){var t=this.getCustomData("classes");this.hasClass(e)||(!t&&(t=[]),t.push(e),this.setCustomData("classes",t),this.addClass(e))},changeAttr:function(e,t){var n=this.getAttribute(e);t!==n&&(!this._.attrChanges&&(this._.attrChanges={}),e in this._.attrChanges||(this._.attrChanges[e]=n),this.setAttribute(e,t))},insertText:function(e){this.editor.focus(),this.insertHtml(this.transformPlainTextToHtml(e),"text")},transformPlainTextToHtml:function(e){var t=this.editor.getSelection().getStartElement().hasAscendant("pre",!0)?CKEDITOR.ENTER_BR:this.editor.activeEnterMode;return CKEDITOR.tools.transformPlainTextToHtml(e,t)},insertHtml:function(e,t,n){var i=this.editor;i.focus(),i.fire("saveSnapshot"),n||(n=i.getSelection().getRanges()[0]),p(this,t||"html",e,n),n.select(),o(this),this.editor.fire("afterInsertHtml",{})},insertHtmlIntoRange:function(e,t,n){p(this,n||"html",e,t),this.editor.fire("afterInsertHtml",{intoRange:t})},insertElement:function(e,t){(r=this.editor).focus(),r.fire("saveSnapshot");var i=r.activeEnterMode,r=r.getSelection(),a=e.getName();a=CKEDITOR.dtd.$block[a],t||(t=r.getRanges()[0]),this.insertElementIntoRange(e,t)&&(t.moveToPosition(e,CKEDITOR.POSITION_AFTER_END),a&&((a=e.getNext(function(e){return n(e)&&!d(e)}))&&a.type==CKEDITOR.NODE_ELEMENT&&a.is(CKEDITOR.dtd.$block)?a.getDtd()["#"]?t.moveToElementEditStart(a):t.moveToElementEditEnd(e):a||i==CKEDITOR.ENTER_BR||(a=t.fixBlock(!0,i==CKEDITOR.ENTER_DIV?"div":"p"),t.moveToElementEditStart(a)))),r.selectRanges([t]),o(this)},insertElementIntoSelection:function(e){this.insertElement(e)},insertElementIntoRange:function(e,t){var n,i,r=this.editor,a=r.config.enterMode,o=e.getName(),s=CKEDITOR.dtd.$block[o];if(t.checkReadOnly())return!1;if(t.deleteContents(1),t.startContainer.type==CKEDITOR.NODE_ELEMENT&&(t.startContainer.is({tr:1,table:1,tbody:1,thead:1,tfoot:1})?f(t):t.startContainer.is(CKEDITOR.dtd.$list)&&g(t)),s)for(;(n=t.getCommonAncestor(0,1))&&(i=CKEDITOR.dtd[n.getName()])&&(!i||!i[o]);)n.getName()in CKEDITOR.dtd.span?t.splitElement(n):t.checkStartOfBlock()&&t.checkEndOfBlock()?(t.setStartBefore(n),t.collapse(!0),n.remove()):t.splitBlock(a==CKEDITOR.ENTER_DIV?"div":"p",r.editable());return t.insertNode(e),!0},setData:function(e,t){t||(e=this.editor.dataProcessor.toHtml(e)),this.setHtml(e),this.fixInitialSelection(),"unloaded"==this.status&&(this.status="ready"),this.editor.fire("dataReady")},getData:function(e){var t=this.getHtml();return e||(t=this.editor.dataProcessor.toDataFormat(t)),t},setReadOnly:function(e){this.setAttribute("contenteditable",!e)},detach:function(){this.removeClass("cke_editable"),this.status="detached";var e=this.editor;this._.detach(),delete e.document,delete e.window},isInline:function(){return this.getDocument().equals(CKEDITOR.document)},fixInitialSelection:function(){function e(){var e,n=t.getDocument().$,i=n.getSelection();e:if(i.anchorNode&&i.anchorNode==t.$)e=!0;else{if(CKEDITOR.env.webkit&&(e=t.getDocument().getActive())&&e.equals(t)&&!i.anchorNode){e=!0;break e}e=void 0}e&&((e=new CKEDITOR.dom.range(t)).moveToElementEditStart(t),(n=n.createRange()).setStart(e.startContainer.$,e.startOffset),n.collapse(!0),i.removeAllRanges(),i.addRange(n))}var t=this;CKEDITOR.env.ie&&(9>CKEDITOR.env.version||CKEDITOR.env.quirks)?this.hasFocus&&(this.focus(),function(){var e=t.getDocument().$,n=e.selection,i=t.getDocument().getActive();"None"==n.type&&i.equals(t)&&(n=new CKEDITOR.dom.range(t),e=e.body.createTextRange(),n.moveToElementEditStart(t),(n=n.startContainer).type!=CKEDITOR.NODE_ELEMENT&&(n=n.getParent()),e.moveToElementText(n.$),e.collapse(!0),e.select())}()):this.hasFocus?(this.focus(),e()):this.once("focus",function(){e()},null,null,-999)},getHtmlFromRange:function(e){return e.collapsed?new CKEDITOR.dom.documentFragment(e.document):(e={doc:this.getDocument(),range:e.clone()},m.eol.detect(e,this),m.bogus.exclude(e),m.cell.shrink(e),e.fragment=e.range.cloneContents(),m.tree.rebuild(e,this),m.eol.fix(e,this),new CKEDITOR.dom.documentFragment(e.fragment.$))},extractHtmlFromRange:function(e,t){var n=v,i={range:e,doc:e.document},r=this.getHtmlFromRange(e);if(e.collapsed)return e.optimize(),r;if(e.enlarge(CKEDITOR.ENLARGE_INLINE,1),n.table.detectPurge(i),i.bookmark=e.createBookmark(),delete i.range,(o=this.editor.createRange()).moveToPosition(i.bookmark.startNode,CKEDITOR.POSITION_BEFORE_START),i.targetBookmark=o.createBookmark(),n.list.detectMerge(i,this),n.table.detectRanges(i,this),n.block.detectMerge(i,this),i.tableContentsRanges?(n.table.deleteRanges(i),e.moveToBookmark(i.bookmark),i.range=e):(e.moveToBookmark(i.bookmark),i.range=e,e.extractContents(n.detectExtractMerge(i))),e.moveToBookmark(i.targetBookmark),e.optimize(),n.fixUneditableRangePosition(e),n.list.merge(i,this),n.table.purge(i,this),n.block.merge(i,this),t){if(n=e.startPath(),i=e.checkStartOfBlock()&&e.checkEndOfBlock()&&n.block&&!e.root.equals(n.block)){e:{var a,o=0;if(i=n.block.getElementsByTag("span"))for(;a=i.getItem(o++);)if(!u(a)){i=!0;break e}i=!1}i=!i}i&&(e.moveToPosition(n.block,CKEDITOR.POSITION_BEFORE_START),n.block.remove())}else n.autoParagraph(this.editor,e),c(e.startContainer)&&e.startContainer.appendBogus();return e.startContainer.mergeSiblings(),r},setup:function(){var e=this.editor;if(this.attachListener(e,"beforeGetData",function(){var t=this.getData();this.is("textarea")||!1!==e.config.ignoreEmptyParagraph&&(t=t.replace(h,function(e,t){return t})),e.setData(t,null,1)},this),this.attachListener(e,"getSnapshot",function(e){e.data=this.getData(1)},this),this.attachListener(e,"afterSetData",function(){this.setData(e.getData(1))},this),this.attachListener(e,"loadSnapshot",function(e){this.setData(e.data,1)},this),this.attachListener(e,"beforeFocus",function(){var t=e.getSelection();(t=t&&t.getNative())&&"Control"==t.type||this.focus()},this),this.attachListener(e,"insertHtml",function(e){this.insertHtml(e.data.dataValue,e.data.mode,e.data.range)},this),this.attachListener(e,"insertElement",function(e){this.insertElement(e.data)},this),this.attachListener(e,"insertText",function(e){this.insertText(e.data)},this),this.setReadOnly(e.readOnly),this.attachClass("cke_editable"),e.elementMode==CKEDITOR.ELEMENT_MODE_INLINE?this.attachClass("cke_editable_inline"):e.elementMode!=CKEDITOR.ELEMENT_MODE_REPLACE&&e.elementMode!=CKEDITOR.ELEMENT_MODE_APPENDTO||this.attachClass("cke_editable_themed"),this.attachClass("cke_contents_"+e.config.contentsLangDirection),e.keystrokeHandler.blockedKeystrokes[8]=+e.readOnly,e.keystrokeHandler.attach(this),this.on("blur",function(){this.hasFocus=!1},null,null,-1),this.on("focus",function(){this.hasFocus=!0},null,null,-1),CKEDITOR.env.webkit&&this.on("scroll",function(){e._.previousScrollTop=e.editable().$.scrollTop},null,null,-1),CKEDITOR.env.edge&&14<CKEDITOR.env.version){var r=function(){var t=e.editable();null!=e._.previousScrollTop&&t.getDocument().equals(CKEDITOR.document)&&(t.$.scrollTop=e._.previousScrollTop,e._.previousScrollTop=null,this.removeListener("scroll",r))};this.on("scroll",r)}if(e.focusManager.add(this),this.equals(CKEDITOR.document.getActive())&&(this.hasFocus=!0,e.once("contentDom",function(){e.focusManager.focus(this)},this)),this.isInline()&&this.changeAttr("tabindex",e.tabIndex),!this.is("textarea")){e.document=this.getDocument(),e.window=this.getWindow();var a=e.document;this.changeAttr("spellcheck",!e.config.disableNativeSpellChecker);var o=e.config.contentsLangDirection;this.getDirection(1)!=o&&this.changeAttr("dir",o);var u=CKEDITOR.getCss();if(u){var c=(o=a.getHead()).getCustomData("stylesheet");c?u!=c.getText()&&(CKEDITOR.env.ie&&9>CKEDITOR.env.version?c.$.styleSheet.cssText=u:c.setText(u)):(u=a.appendStyleText(u),u=new CKEDITOR.dom.element(u.ownerNode||u.owningElement),o.setCustomData("stylesheet",u),u.data("cke-temp",1))}o=a.getCustomData("stylesheet_ref")||0,a.setCustomData("stylesheet_ref",o+1),this.setCustomData("cke_includeReadonly",!e.config.disableReadonlyStyling),this.attachListener(this,"click",function(e){e=e.data;var t=new CKEDITOR.dom.elementPath(e.getTarget(),this).contains("a");t&&2!=e.$.button&&t.isReadOnly()&&e.preventDefault()});var d={8:1,46:1};this.attachListener(e,"key",function(t){if(e.readOnly)return!0;var n;if((h=t.data.domEvent.getKey())in d){var r,a,o,s,u=(t=e.getSelection()).getRanges()[0],c=u.startPath(),h=8==h;CKEDITOR.env.ie&&11>CKEDITOR.env.version&&(r=t.getSelectedElement())||(r=i(t))?(e.fire("saveSnapshot"),u.moveToPosition(r,CKEDITOR.POSITION_BEFORE_START),r.remove(),u.select(),e.fire("saveSnapshot"),n=1):u.collapsed&&((a=c.block)&&(s=a[h?"getPrevious":"getNext"](l))&&s.type==CKEDITOR.NODE_ELEMENT&&s.is("table")&&u[h?"checkStartOfBlock":"checkEndOfBlock"]()?(e.fire("saveSnapshot"),u[h?"checkEndOfBlock":"checkStartOfBlock"]()&&a.remove(),u["moveToElementEdit"+(h?"End":"Start")](s),u.select(),e.fire("saveSnapshot"),n=1):c.blockLimit&&c.blockLimit.is("td")&&(o=c.blockLimit.getAscendant("table"))&&u.checkBoundaryOfElement(o,h?CKEDITOR.START:CKEDITOR.END)&&(s=o[h?"getPrevious":"getNext"](l))?(e.fire("saveSnapshot"),u["moveToElementEdit"+(h?"End":"Start")](s),u.checkStartOfBlock()&&u.checkEndOfBlock()?s.remove():u.select(),e.fire("saveSnapshot"),n=1):(o=c.contains(["td","th","caption"]))&&u.checkBoundaryOfElement(o,h?CKEDITOR.START:CKEDITOR.END)&&(n=1))}return!n}),e.blockless&&CKEDITOR.env.ie&&CKEDITOR.env.needsBrFiller&&this.attachListener(this,"keyup",function(t){t.data.getKeystroke()in d&&!this.getFirst(n)&&(this.appendBogus(),(t=e.createRange()).moveToPosition(this,CKEDITOR.POSITION_AFTER_START),t.select())}),this.attachListener(this,"dblclick",function(t){if(e.readOnly)return!1;t={element:t.data.getTarget()},e.fire("doubleclick",t)}),CKEDITOR.env.ie&&this.attachListener(this,"click",t),CKEDITOR.env.ie&&!CKEDITOR.env.edge||this.attachListener(this,"mousedown",function(t){var n=t.data.getTarget();n.is("img","hr","input","textarea","select")&&!n.isReadOnly()&&(e.getSelection().selectElement(n),n.is("input","textarea","select")&&t.data.preventDefault())}),CKEDITOR.env.edge&&this.attachListener(this,"mouseup",function(t){(t=t.data.getTarget())&&t.is("img")&&e.getSelection().selectElement(t)}),CKEDITOR.env.gecko&&this.attachListener(this,"mouseup",function(t){if(2==t.data.$.button&&!(t=t.data.getTarget()).getOuterHtml().replace(h,"")){var n=e.createRange();n.moveToElementEditStart(t),n.select(!0)}}),CKEDITOR.env.webkit&&(this.attachListener(this,"click",function(e){e.data.getTarget().is("input","select")&&e.data.preventDefault()}),this.attachListener(this,"mouseup",function(e){e.data.getTarget().is("input","textarea")&&e.data.preventDefault()})),CKEDITOR.env.webkit&&this.attachListener(e,"key",function(t){if(e.readOnly)return!0;if((t=t.data.domEvent.getKey())in d){var n=8==t,i=e.getSelection().getRanges()[0];if(t=i.startPath(),i.collapsed)e:{var r=t.block;if(r&&i[n?"checkStartOfBlock":"checkEndOfBlock"]()&&i.moveToClosestEditablePosition(r,!n)&&i.collapsed){if(i.startContainer.type==CKEDITOR.NODE_ELEMENT){var a=i.startContainer.getChild(i.startOffset-(n?1:0));if(a&&a.type==CKEDITOR.NODE_ELEMENT&&a.is("hr")){e.fire("saveSnapshot"),a.remove(),t=!0;break e}}var o;!(i=i.startPath().block)||i&&i.contains(r)?t=void 0:(e.fire("saveSnapshot"),(o=(n?i:r).getBogus())&&o.remove(),a=(o=e.getSelection()).createBookmarks(),(n?r:i).moveChildren(n?i:r,!1),t.lastElement.mergeSiblings(),s(r,i,!n),o.selectBookmarks(a),t=!0)}else t=!1}else n=i,o=t.block,i=n.endPath().block,o&&i&&!o.equals(i)?(e.fire("saveSnapshot"),(r=o.getBogus())&&r.remove(),n.enlarge(CKEDITOR.ENLARGE_INLINE),n.deleteContents(),i.getParent()&&(i.moveChildren(o,!1),t.lastElement.mergeSiblings(),s(o,i,!0)),(n=e.getSelection().getRanges()[0]).collapse(1),n.optimize(),""===n.startContainer.getHtml()&&n.startContainer.appendBogus(),n.select(),t=!0):t=!1;if(!t)return;return e.getSelection().scrollIntoView(),e.fire("saveSnapshot"),!1}},this,null,100)}}},_:{detach:function(){var e;if(this.editor.setData(this.editor.getData(),0,1),this.clearListeners(),this.restoreAttrs(),e=this.removeCustomData("classes"))for(;e.length;)this.removeClass(e.pop());if(!this.is("textarea")){var t=(e=this.getDocument()).getHead();if(t.getCustomData("stylesheet")){var n=e.getCustomData("stylesheet_ref");--n?e.setCustomData("stylesheet_ref",n):(e.removeCustomData("stylesheet_ref"),t.removeCustomData("stylesheet").remove())}}this.editor.fire("contentDomUnload"),delete this.editor}}}),CKEDITOR.editor.prototype.editable=function(e){var t=this._.editable;return t&&e?0:(arguments.length&&(t=this._.editable=e?e instanceof CKEDITOR.editable?e:new CKEDITOR.editable(this,e):(t&&t.detach(),null)),t)},CKEDITOR.on("instanceLoaded",function(t){var n=t.editor;n.on("insertElement",function(e){(e=e.data).type==CKEDITOR.NODE_ELEMENT&&(e.is("input")||e.is("textarea"))&&("false"!=e.getAttribute("contentEditable")&&e.data("cke-editable",e.hasAttribute("contenteditable")?"true":"1"),e.setAttribute("contentEditable",!1))}),n.on("selectionChange",function(t){if(!n.readOnly){var i=n.getSelection();i&&!i.isLocked&&(i=n.checkDirty(),n.fire("lockSnapshot"),e(t),n.fire("unlockSnapshot"),!i&&n.resetDirty())}})}),CKEDITOR.on("instanceCreated",function(e){var t=e.editor;t.on("mode",function(){var e=t.editable();if(e&&e.isInline()){var n=t.title;if(e.changeAttr("role","textbox"),e.changeAttr("aria-label",n),n&&e.changeAttr("title",n),(r=t.fire("ariaEditorHelpLabel",{}).label)&&(n=this.ui.space(this.elementMode==CKEDITOR.ELEMENT_MODE_INLINE?"top":"contents"))){var i=CKEDITOR.tools.getNextId(),r=CKEDITOR.dom.element.createFromHtml('<span id="'+i+'" class="cke_voice_label">'+r+"</span>");n.append(r),e.changeAttr("aria-describedby",i)}}})}),CKEDITOR.addCss(".cke_editable{cursor:text}.cke_editable img,.cke_editable input,.cke_editable textarea{cursor:default}"),l=CKEDITOR.dom.walker.whitespaces(!0),u=CKEDITOR.dom.walker.bookmark(!1,!0),c=CKEDITOR.dom.walker.empty(),d=CKEDITOR.dom.walker.bogus(),h=/(^|<body\b[^>]*>)\s*<(p|div|address|h\d|center|pre)[^>]*>\s*(?:<br[^>]*>|&nbsp;|\u00A0|&#160;)?\s*(:?<\/\2>)?\s*(?=$|<\/body>)/gi,p=function(){function e(e){return e.type==CKEDITOR.NODE_ELEMENT}function t(n,i){var r,a=[],o=n.getChildren(),s=o.count(),u=0,c=l[i],d=!n.is(l.$inline)||n.is("br");for(d&&a.push(" ");u<s;u++)e(r=o.getItem(u))&&!r.is(c)?a=a.concat(t(r,i)):a.push(r);return d&&a.push(" "),a}function i(t){return e(t.startContainer)&&t.startContainer.getChild(t.startOffset-1)}function o(t){return t&&e(t)&&(t.is(l.$removeEmpty)||t.is("a")&&!t.isBlockBoundary())}function s(t,n,i,r){var a,o,l=t.clone();l.setEndAt(n,CKEDITOR.POSITION_BEFORE_END),(a=new CKEDITOR.dom.walker(l).next())&&e(a)&&u[a.getName()]&&(o=a.getPrevious())&&e(o)&&!o.getParent().equals(t.startContainer)&&i.contains(o)&&r.contains(a)&&a.isIdentical(o)&&(a.moveChildren(o),a.remove(),s(t,n,i,r))}var l=CKEDITOR.dtd,u={p:1,div:1,h1:1,h2:1,h3:1,h4:1,h5:1,h6:1,ul:1,ol:1,li:1,pre:1,dl:1,blockquote:1},c={p:1,div:1,h1:1,h2:1,h3:1,h4:1,h5:1,h6:1},d=CKEDITOR.tools.extend({},l.$inline);return delete d.br,function(u,h,p,f){var g=u.editor,m=!1;if("unfiltered_html"==h&&(h="html",m=!0),!f.checkReadOnly()){var v,y,b;if(h=(u={type:h,dontFilter:m,editable:u,editor:g,range:f,blockLimit:R=new CKEDITOR.dom.elementPath(f.startContainer,f.root).blockLimit||f.root,mergeCandidates:[],zombies:[]}).range,f=u.mergeCandidates,"text"==u.type&&h.shrink(CKEDITOR.SHRINK_ELEMENT,!0,!1)&&(v=CKEDITOR.dom.element.createFromHtml("<span>&nbsp;</span>",h.document),h.insertNode(v),h.setStartAfter(v)),m=new CKEDITOR.dom.elementPath(h.startContainer),u.endPath=R=new CKEDITOR.dom.elementPath(h.endContainer),!h.collapsed){g=R.block||R.blockLimit;var _=h.getCommonAncestor();g&&!g.equals(_)&&!g.contains(_)&&h.checkEndOfBlock()&&u.zombies.push(g),h.deleteContents()}for(;(y=i(h))&&e(y)&&y.isBlockBoundary()&&m.contains(y);)h.moveToPosition(y,CKEDITOR.POSITION_BEFORE_END);for(s(h,u.blockLimit,m,R),v&&(h.setEndBefore(v),h.collapse(),v.remove()),(g=(v=h.startPath()).contains(o,!1,1))&&(h.splitElement(g),u.inlineStylesRoot=g,u.inlineStylesPeak=v.lastElement),(g=(v=h.createBookmark()).startNode.getPrevious(n))&&e(g)&&o(g)&&f.push(g),(g=v.startNode.getNext(n))&&e(g)&&o(g)&&f.push(g),g=v.startNode;(g=g.getParent())&&o(g);)f.push(g);if(h.moveToBookmark(v),v=p){if(v=u.range,"text"==u.type&&u.inlineStylesRoot){for(h=(y=u.inlineStylesPeak).getDocument().createText("{cke-peak}"),f=u.inlineStylesRoot.getParent();!y.equals(f);)h=h.appendTo(y.clone()),y=y.getParent();p=h.getOuterHtml().split("{cke-peak}").join(p)}if(y=u.blockLimit.getName(),/^\s+|\s+$/.test(p)&&"span"in CKEDITOR.dtd[y]&&(p=(O='<span data-cke-marker="1">&nbsp;</span>')+p+O),p=u.editor.dataProcessor.toHtml(p,{context:null,fixForBody:!1,protectedWhitespaces:!!O,dontFilter:u.dontFilter,filter:u.editor.activeFilter,enterMode:u.editor.activeEnterMode}),(y=v.document.createElement("body")).setHtml(p),O&&(y.getFirst().remove(),y.getLast().remove()),(O=v.startPath().block)&&(1!=O.getChildCount()||!O.getBogus()))e:{var T;if(1==y.getChildCount()&&e(T=y.getFirst())&&T.is(c)&&!T.hasAttribute("contenteditable")){for(v=0,f=(O=T.getElementsByTag("*")).count();v<f;v++)if(!(h=O.getItem(v)).is(d))break e;T.moveChildren(T.getParent(1)),T.remove()}}u.dataWrapper=y,v=p}if(v){var E;v=(T=u.range).document,y=u.blockLimit,f=0;var C,w,k,S,I,O=[];p=g=0,h=T.startContainer;var D,R=(m=u.endPath.elements[0]).getPosition(h);for(_=!(!m.getCommonAncestor(h)||R==CKEDITOR.POSITION_IDENTICAL||R&CKEDITOR.POSITION_CONTAINS+CKEDITOR.POSITION_IS_CONTAINED),function(t,n){function i(t,n){if(n.isBlock&&n.isElement&&!n.node.is("br")&&e(t)&&t.is("br"))return t.remove(),1}var r=n.endContainer.getChild(n.endOffset),a=n.endContainer.getChild(n.endOffset-1);r&&i(r,t[t.length-1]),a&&i(a,t[0])&&(n.setEnd(n.endContainer,n.endOffset-1),n.collapse())}(h=function t(n,i){var r,a,o,s,u=[],c=i.range.startContainer;r=i.range.startPath(),c=l[c.getName()];for(var d=0,h=n.getChildren(),p=h.count(),f=-1,g=-1,m=0,v=r.contains(l.$list);d<p;++d)e(r=h.getItem(d))?(o=r.getName(),v&&o in CKEDITOR.dtd.$list?u=u.concat(t(r,i)):(s=!!c[o],"br"!=o||!r.data("cke-eol")||d&&d!=p-1||(m=(a=d?u[d-1].node:h.getItem(d+1))&&(!e(a)||!a.is("br")),a=a&&e(a)&&l.$block[a.getName()]),-1!=f||s||(f=d),s||(g=d),u.push({isElement:1,isLineBreak:m,isBlock:r.isBlockBoundary(),hasBlockSibling:a,node:r,name:o,allowed:s}),a=m=0)):u.push({isElement:0,node:r,allowed:1});return-1<f&&(u[f].firstNotAllowed=1),-1<g&&(u[g].lastNotAllowed=1),u}(u.dataWrapper,u),T);f<h.length;f++){if(E=(R=h[f]).isLineBreak){E=T,S=y;var x=void 0,A=void 0;R.hasBlockSibling?E=1:(x=E.startContainer.getAscendant(l.$block,1))&&x.is({div:1,p:1})?(A=x.getPosition(S))==CKEDITOR.POSITION_IDENTICAL||A==CKEDITOR.POSITION_CONTAINS?E=0:(S=E.splitElement(x),E.moveToPosition(S,CKEDITOR.POSITION_AFTER_START),E=1):E=0}if(E)p=0<f;else{if(E=T.startPath(),!R.isBlock&&r(u.editor,E.block,E.blockLimit)&&(k=a(u.editor))&&((k=v.createElement(k)).appendBogus(),T.insertNode(k),CKEDITOR.env.needsBrFiller&&(C=k.getBogus())&&C.remove(),T.moveToPosition(k,CKEDITOR.POSITION_BEFORE_END)),(E=T.startPath().block)&&!E.equals(w)&&((C=E.getBogus())&&(C.remove(),O.push(E)),w=E),R.firstNotAllowed&&(g=1),g&&R.isElement){for(E=T.startContainer,S=null;E&&!l[E.getName()][R.name];){if(E.equals(y)){E=null;break}S=E,E=E.getParent()}if(E)S&&(I=T.splitElement(S),u.zombies.push(I),u.zombies.push(S));else{S=y.getName(),D=!f,E=f==h.length-1,x=[],A=(S=t(R.node,S)).length;for(var P=0,L=void 0,N=0,M=-1;P<A;P++)" "==(L=S[P])?(N||D&&!P||(x.push(new CKEDITOR.dom.text(" ")),M=x.length),N=1):(x.push(L),N=0);E&&M==x.length&&x.pop(),D=x}}if(D){for(;E=D.pop();)T.insertNode(E);D=0}else T.insertNode(R.node);R.lastNotAllowed&&f<h.length-1&&((I=_?m:I)&&T.setEndAt(I,CKEDITOR.POSITION_AFTER_START),g=0),T.collapse()}}(C=1==h.length&&(C=h[0]).isElement&&"false"==C.node.getAttribute("contenteditable"))&&(p=!0,E=h[0].node,T.setStartAt(E,CKEDITOR.POSITION_BEFORE_START),T.setEndAt(E,CKEDITOR.POSITION_AFTER_END)),u.dontMoveCaret=p,u.bogusNeededBlocks=O}for(C=u.range,I=u.bogusNeededBlocks,D=C.createBookmark();w=u.zombies.pop();)w.getParent()&&((k=C.clone()).moveToElementEditStart(w),k.removeEmptyBlocksAtEnd());if(I)for(;w=I.pop();)CKEDITOR.env.needsBrFiller?w.appendBogus():w.append(C.document.createText(" "));for(;w=u.mergeCandidates.pop();)w.mergeSiblings();if(C.moveToBookmark(D),!u.dontMoveCaret){for(w=i(C);w&&e(w)&&!w.is(l.$empty);){if(w.isBlockBoundary())C.moveToPosition(w,CKEDITOR.POSITION_BEFORE_END);else{if(o(w)&&w.getHtml().match(/(\s|&nbsp;)$/g)){b=null;break}(b=C.clone()).moveToPosition(w,CKEDITOR.POSITION_BEFORE_END)}w=w.getLast(n)}b&&C.moveToRange(b)}}}}(),f=function(){function e(e){return(e=new CKEDITOR.dom.walker(e)).guard=function(e,t){return!t&&(e.type==CKEDITOR.NODE_ELEMENT?e.is(CKEDITOR.dtd.$tableContent):void 0)},e.evaluator=function(e){return e.type==CKEDITOR.NODE_ELEMENT},e}function t(e,t,n){return t=e.getDocument().createElement(t),e.append(t,n),t}function n(e){for(var t,n=e.count();0<n--;)t=e.getItem(n),CKEDITOR.tools.trim(t.getHtml())||(t.appendBogus(),CKEDITOR.env.ie&&9>CKEDITOR.env.version&&t.getChildCount()&&t.getFirst().remove())}return function(i){var r=i.startContainer,a=r.getAscendant("table",1),o=!1;n(a.getElementsByTag("td")),n(a.getElementsByTag("th")),(a=i.clone()).setStart(r,0),(a=e(a).lastBackward())||((a=i.clone()).setEndAt(r,CKEDITOR.POSITION_BEFORE_END),a=e(a).lastForward(),o=!0),a||(a=r),a.is("table")?(i.setStartAt(a,CKEDITOR.POSITION_BEFORE_START),i.collapse(!0),a.remove()):(a.is({tbody:1,thead:1,tfoot:1})&&(a=t(a,"tr",o)),a.is("tr")&&(a=t(a,a.getParent().is("thead")?"th":"td",o)),(r=a.getBogus())&&r.remove(),i.moveToPosition(a,o?CKEDITOR.POSITION_AFTER_START:CKEDITOR.POSITION_BEFORE_END))}}(),g=function(){function e(e){return(e=new CKEDITOR.dom.walker(e)).guard=function(e,t){return!t&&(e.type==CKEDITOR.NODE_ELEMENT?e.is(CKEDITOR.dtd.$list)||e.is(CKEDITOR.dtd.$listItem):void 0)},e.evaluator=function(e){return e.type==CKEDITOR.NODE_ELEMENT&&e.is(CKEDITOR.dtd.$listItem)},e}return function(t){var n,i=t.startContainer,r=!1;(n=t.clone()).setStart(i,0),(n=e(n).lastBackward())||((n=t.clone()).setEndAt(i,CKEDITOR.POSITION_BEFORE_END),n=e(n).lastForward(),r=!0),n||(n=i),n.is(CKEDITOR.dtd.$list)?(t.setStartAt(n,CKEDITOR.POSITION_BEFORE_START),t.collapse(!0),n.remove()):((i=n.getBogus())&&i.remove(),t.moveToPosition(n,r?CKEDITOR.POSITION_AFTER_START:CKEDITOR.POSITION_BEFORE_END),t.select())}}(),m={eol:{detect:function(e,t){var n=e.range,i=n.clone(),r=n.clone(),a=new CKEDITOR.dom.elementPath(n.startContainer,t),o=new CKEDITOR.dom.elementPath(n.endContainer,t);i.collapse(1),r.collapse(),a.block&&i.checkBoundaryOfElement(a.block,CKEDITOR.END)&&(n.setStartAfter(a.block),e.prependEolBr=1),o.block&&r.checkBoundaryOfElement(o.block,CKEDITOR.START)&&(n.setEndBefore(o.block),e.appendEolBr=1)},fix:function(e,t){var n,i=t.getDocument();e.appendEolBr&&(n=this.createEolBr(i),e.fragment.append(n)),!e.prependEolBr||n&&!n.getPrevious()||e.fragment.append(this.createEolBr(i),1)},createEolBr:function(e){return e.createElement("br",{attributes:{"data-cke-eol":1}})}},bogus:{exclude:function(e){var t,n=(t=e.range.getBoundaryNodes()).startNode;!(t=t.endNode)||!d(t)||n&&n.equals(t)||e.range.setEndBefore(t)}},tree:{rebuild:function(e,t){var n,i=(o=e.range).getCommonAncestor(),r=new CKEDITOR.dom.elementPath(i,t),a=new CKEDITOR.dom.elementPath(o.startContainer,t),o=new CKEDITOR.dom.elementPath(o.endContainer,t);if(i.type==CKEDITOR.NODE_TEXT&&(i=i.getParent()),r.blockLimit.is({tr:1,table:1})){var s=r.contains("table").getParent();n=function(e){return!e.equals(s)}}else if(r.block&&r.block.is(CKEDITOR.dtd.$listItem)&&(a=a.contains(CKEDITOR.dtd.$list),o=o.contains(CKEDITOR.dtd.$list),!a.equals(o))){var l=r.contains(CKEDITOR.dtd.$list).getParent();n=function(e){return!e.equals(l)}}n||(n=function(e){return!e.equals(r.block)&&!e.equals(r.blockLimit)}),this.rebuildFragment(e,t,i,n)},rebuildFragment:function(e,t,n,i){for(var r;n&&!n.equals(t)&&i(n);)r=n.clone(0,1),e.fragment.appendTo(r),e.fragment=r,n=n.getParent()}},cell:{shrink:function(e){var t=(e=e.range).startContainer,n=e.endContainer,i=e.startOffset,r=e.endOffset;t.type==CKEDITOR.NODE_ELEMENT&&t.equals(n)&&t.is("tr")&&++i==r&&e.shrink(CKEDITOR.SHRINK_TEXT)}}},v=function(){function e(e,t){var n=e.getParent();n.is(CKEDITOR.dtd.$inline)&&e[t?"insertBefore":"insertAfter"](n)}function t(t,n,i){e(n),e(i,1);for(var r;r=i.getNext();)r.insertAfter(n),n=r;c(t)&&t.remove()}function n(e,t){var n=new CKEDITOR.dom.range(e);return n.setStartAfter(t.startNode),n.setEndBefore(t.endNode),n}return{list:{detectMerge:function(e,t){var i=n(t,e.bookmark),r=i.startPath(),a=i.endPath(),o=r.contains(CKEDITOR.dtd.$list),s=a.contains(CKEDITOR.dtd.$list);e.mergeList=o&&s&&o.getParent().equals(s.getParent())&&!o.equals(s),e.mergeListItems=r.block&&a.block&&r.block.is(CKEDITOR.dtd.$listItem)&&a.block.is(CKEDITOR.dtd.$listItem),(e.mergeList||e.mergeListItems)&&((i=i.clone()).setStartBefore(e.bookmark.startNode),i.setEndAfter(e.bookmark.endNode),e.mergeListBookmark=i.createBookmark())},merge:function(e,n){if(e.mergeListBookmark){var i=e.mergeListBookmark.startNode,r=e.mergeListBookmark.endNode,a=new CKEDITOR.dom.elementPath(i,n),o=new CKEDITOR.dom.elementPath(r,n);if(e.mergeList){var s=a.contains(CKEDITOR.dtd.$list),l=o.contains(CKEDITOR.dtd.$list);s.equals(l)||(l.moveChildren(s),l.remove())}e.mergeListItems&&(a=a.contains(CKEDITOR.dtd.$listItem),o=o.contains(CKEDITOR.dtd.$listItem),a.equals(o)||t(o,i,r)),i.remove(),r.remove()}}},block:{detectMerge:function(e,t){if(!e.tableContentsRanges&&!e.mergeListBookmark){var n=new CKEDITOR.dom.range(t);n.setStartBefore(e.bookmark.startNode),n.setEndAfter(e.bookmark.endNode),e.mergeBlockBookmark=n.createBookmark()}},merge:function(e,n){if(e.mergeBlockBookmark&&!e.purgeTableBookmark){var i=e.mergeBlockBookmark.startNode,r=e.mergeBlockBookmark.endNode,a=new CKEDITOR.dom.elementPath(i,n),o=new CKEDITOR.dom.elementPath(r,n);a=a.block,o=o.block,a&&o&&!a.equals(o)&&t(o,i,r),i.remove(),r.remove()}}},table:function(){function e(e){var n,r=[],a=new CKEDITOR.dom.walker(e),o=e.startPath().contains(i),s=e.endPath().contains(i),l={};return a.guard=function(a,u){if(a.type==CKEDITOR.NODE_ELEMENT){var c="visited_"+(u?"out":"in");if(a.getCustomData(c))return;CKEDITOR.dom.element.setMarker(l,a,c,1)}u&&o&&a.equals(o)?((n=e.clone()).setEndAt(o,CKEDITOR.POSITION_BEFORE_END),r.push(n)):!u&&s&&a.equals(s)?((n=e.clone()).setStartAt(s,CKEDITOR.POSITION_AFTER_START),r.push(n)):((c=!u)&&(c=a.type==CKEDITOR.NODE_ELEMENT&&a.is(i)&&(!o||t(a,o))&&(!s||t(a,s))),c&&((n=e.clone()).selectNodeContents(a),r.push(n)))},a.lastForward(),CKEDITOR.dom.element.clearAllMarkers(l),r}function t(e,t){var n=CKEDITOR.POSITION_CONTAINS+CKEDITOR.POSITION_IS_CONTAINED,i=e.getPosition(t);return i!==CKEDITOR.POSITION_IDENTICAL&&0==(i&n)}var i={td:1,th:1,caption:1};return{detectPurge:function(e){var t=e.range;(r=t.clone()).enlarge(CKEDITOR.ENLARGE_ELEMENT);var n=0;if((r=new CKEDITOR.dom.walker(r)).evaluator=function(e){e.type==CKEDITOR.NODE_ELEMENT&&e.is(i)&&++n},r.checkForward(),1<n){var r=t.startPath().contains("table"),a=t.endPath().contains("table");r&&a&&t.checkBoundaryOfElement(r,CKEDITOR.START)&&t.checkBoundaryOfElement(a,CKEDITOR.END)&&((t=e.range.clone()).setStartBefore(r),t.setEndAfter(a),e.purgeTableBookmark=t.createBookmark())}},detectRanges:function(r,a){var o,s,l=n(a,r.bookmark),u=l.clone(),c=l.getCommonAncestor();c.is(CKEDITOR.dtd.$tableContent)&&!c.is(i)&&(c=c.getAscendant("table",!0)),s=c,c=new CKEDITOR.dom.elementPath(l.startContainer,s),s=new CKEDITOR.dom.elementPath(l.endContainer,s),c=c.contains("table"),s=s.contains("table"),(c||s)&&(c&&s&&t(c,s)?(r.tableSurroundingRange=u,u.setStartAt(c,CKEDITOR.POSITION_AFTER_END),u.setEndAt(s,CKEDITOR.POSITION_BEFORE_START),(u=l.clone()).setEndAt(c,CKEDITOR.POSITION_AFTER_END),(o=l.clone()).setStartAt(s,CKEDITOR.POSITION_BEFORE_START),o=e(u).concat(e(o))):c?s||(r.tableSurroundingRange=u,u.setStartAt(c,CKEDITOR.POSITION_AFTER_END),l.setEndAt(c,CKEDITOR.POSITION_AFTER_END)):(r.tableSurroundingRange=u,u.setEndAt(s,CKEDITOR.POSITION_BEFORE_START),l.setStartAt(s,CKEDITOR.POSITION_AFTER_START)),r.tableContentsRanges=o||e(l))},deleteRanges:function(e){for(var t;t=e.tableContentsRanges.pop();)t.extractContents(),c(t.startContainer)&&t.startContainer.appendBogus();e.tableSurroundingRange&&e.tableSurroundingRange.extractContents()},purge:function(e){if(e.purgeTableBookmark){var t=e.doc,n=e.range.clone();(t=t.createElement("p")).insertBefore(e.purgeTableBookmark.startNode),n.moveToBookmark(e.purgeTableBookmark),n.deleteContents(),e.range.moveToPosition(t,CKEDITOR.POSITION_AFTER_START)}}}}(),detectExtractMerge:function(e){return!(e.range.startPath().contains(CKEDITOR.dtd.$listItem)&&e.range.endPath().contains(CKEDITOR.dtd.$listItem))},fixUneditableRangePosition:function(e){e.startContainer.getDtd()["#"]||e.moveToClosestEditablePosition(null,!0)},autoParagraph:function(e,t){var n,i=t.startPath();r(e,i.block,i.blockLimit)&&(n=a(e))&&((n=t.document.createElement(n)).appendBogus(),t.insertNode(n),t.moveToPosition(n,CKEDITOR.POSITION_AFTER_START))}}}()}(),function(){function e(){var e,t=this._.fakeSelection;if(t&&((e=this.getSelection(1))&&e.isHidden()||(t.reset(),t=0)),(t||(t=e||this.getSelection(1))&&t.getType()!=CKEDITOR.SELECTION_NONE)&&(this.fire("selectionCheck",t),!(e=this.elementPath()).compare(this._.selectionPreviousPath))){var n=this._.selectionPreviousPath&&this._.selectionPreviousPath.blockLimit.equals(e.blockLimit);CKEDITOR.env.webkit&&!n&&(this._.previousActive=this.document.getActive()),this._.selectionPreviousPath=e,this.fire("selectionChange",{selection:t,path:e})}}function t(){u=!0,l||(n.call(this),l=CKEDITOR.tools.setTimeout(n,200,this))}function n(){l=null,u&&(CKEDITOR.tools.setTimeout(e,0,this),u=!1)}function i(e){return!(!f(e)&&(e.type!=CKEDITOR.NODE_ELEMENT||e.is(CKEDITOR.dtd.$empty)))}function r(e){function t(t,n){return!(!t||t.type==CKEDITOR.NODE_TEXT)&&e.clone()["moveToElementEdit"+(n?"End":"Start")](t)}if(!(e.root instanceof CKEDITOR.editable))return!1;var n=e.startContainer,r=e.getPreviousNode(i,null,n),a=e.getNextNode(i,null,n);return!(!t(r)&&!t(a,1)&&(r||a||n.type==CKEDITOR.NODE_ELEMENT&&n.isBlockBoundary()&&n.getBogus()))}function a(e){o(e,!1);var t=e.getDocument().createText(h);return e.setCustomData("cke-fillingChar",t),t}function o(e,t){var n=e&&e.removeCustomData("cke-fillingChar");if(n){if(!1!==t){var i=e.getDocument().getSelection().getNative(),r=i&&"None"!=i.type&&i.getRangeAt(0),a=h.length;if(n.getLength()>a&&r&&r.intersectsNode(n.$)){var o=[{node:i.anchorNode,offset:i.anchorOffset},{node:i.focusNode,offset:i.focusOffset}];i.anchorNode==n.$&&i.anchorOffset>a&&(o[0].offset-=a),i.focusNode==n.$&&i.focusOffset>a&&(o[1].offset-=a)}}n.setText(s(n.getText(),1)),o&&(i=(n=e.getDocument().$).getSelection(),(n=n.createRange()).setStart(o[0].node,o[0].offset),n.collapse(!0),i.removeAllRanges(),i.addRange(n),i.extend(o[1].node,o[1].offset))}}function s(e,t){return t?e.replace(p,function(e,t){return t?" ":""}):e.replace(h,"")}var l,u,c="function"!=typeof window.getSelection,d=1,h=CKEDITOR.tools.repeat("​",7),p=new RegExp(h+"( )?","g"),f=CKEDITOR.dom.walker.invisible(1),g=function(){function e(e){return function(t){var n=t.editor.createRange();return n.moveToClosestEditablePosition(t.selected,e)&&t.editor.getSelection().selectRanges([n]),!1}}function t(e){return function(t){var n,i=t.editor,r=i.createRange();return(n=r.moveToClosestEditablePosition(t.selected,e))||(n=r.moveToClosestEditablePosition(t.selected,!e)),n&&i.getSelection().selectRanges([r]),i.fire("saveSnapshot"),t.selected.remove(),n||(r.moveToElementEditablePosition(i.editable()),i.getSelection().selectRanges([r])),i.fire("saveSnapshot"),!1}}var n=e(),i=e(1);return{37:n,38:n,39:i,40:i,8:t(),46:t(1)}}();CKEDITOR.on("instanceCreated",function(n){function i(){var e=r.getSelection();e&&e.removeAllRanges()}var r=n.editor;r.on("contentDom",function(){function n(){(s=new CKEDITOR.dom.selection(r.getSelection())).lock()}function i(){f.removeListener("mouseup",i),v.removeListener("mouseup",i);var e=CKEDITOR.document.$.selection,t=e.createRange();"None"!=e.type&&t.parentElement().ownerDocument==p.$&&t.select()}var a,s,l,u,d,h,p=r.document,f=CKEDITOR.document,g=r.editable(),m=p.getBody(),v=p.getDocumentElement(),y=g.isInline();CKEDITOR.env.gecko&&g.attachListener(g,"focus",function(e){e.removeListener(),0!==a&&(e=r.getSelection().getNative())&&e.isCollapsed&&e.anchorNode==g.$&&((e=r.createRange()).moveToElementEditStart(g),e.select())},null,null,-2),g.attachListener(g,CKEDITOR.env.webkit?"DOMFocusIn":"focus",function(){a&&CKEDITOR.env.webkit&&(a=r._.previousActive&&r._.previousActive.equals(p.getActive()))&&null!=r._.previousScrollTop&&r._.previousScrollTop!=g.$.scrollTop&&(g.$.scrollTop=r._.previousScrollTop),r.unlockSelection(a),a=0},null,null,-1),g.attachListener(g,"mousedown",function(){a=0}),(CKEDITOR.env.ie||y)&&(c?g.attachListener(g,"beforedeactivate",n,null,null,-1):g.attachListener(r,"selectionCheck",n,null,null,-1),g.attachListener(g,CKEDITOR.env.webkit?"DOMFocusOut":"blur",function(){r.lockSelection(s),a=1},null,null,-1),g.attachListener(g,"mousedown",function(){a=0})),CKEDITOR.env.ie&&!y&&(g.attachListener(g,"mousedown",function(e){2==e.data.$.button&&((e=r.document.getSelection())&&e.getType()!=CKEDITOR.SELECTION_NONE||(l=r.window.getScrollPosition()))}),g.attachListener(g,"mouseup",function(e){2==e.data.$.button&&l&&(r.document.$.documentElement.scrollLeft=l.x,r.document.$.documentElement.scrollTop=l.y),l=null}),"BackCompat"!=p.$.compatMode)&&((CKEDITOR.env.ie7Compat||CKEDITOR.env.ie6Compat)&&v.on("mousedown",function(e){function t(e){if(e=e.data.$,d){var t=m.$.createTextRange();try{t.moveToPoint(e.clientX,e.clientY)}catch(e){}d.setEndPoint(0>h.compareEndPoints("StartToStart",t)?"EndToEnd":"StartToStart",t),d.select()}}function n(){v.removeListener("mousemove",t),f.removeListener("mouseup",n),v.removeListener("mouseup",n),d.select()}if((e=e.data).getTarget().is("html")&&e.$.y<v.$.clientHeight&&e.$.x<v.$.clientWidth){d=m.$.createTextRange();try{d.moveToPoint(e.$.clientX,e.$.clientY)}catch(e){}h=d.duplicate(),v.on("mousemove",t),f.on("mouseup",n),v.on("mouseup",n)}}),7<CKEDITOR.env.version&&11>CKEDITOR.env.version&&v.on("mousedown",function(e){e.data.getTarget().is("html")&&(f.on("mouseup",i),v.on("mouseup",i))})),g.attachListener(g,"selectionchange",e,r),g.attachListener(g,"keyup",t,r),g.attachListener(g,CKEDITOR.env.webkit?"DOMFocusIn":"focus",function(){r.forceNextSelectionCheck(),r.selectionChange(1)}),y&&(CKEDITOR.env.webkit||CKEDITOR.env.gecko)?(g.attachListener(g,"mousedown",function(){u=1}),g.attachListener(p.getDocumentElement(),"mouseup",function(){u&&t.call(r),u=0})):g.attachListener(CKEDITOR.env.ie?g:p.getDocumentElement(),"mouseup",t,r),CKEDITOR.env.webkit&&g.attachListener(p,"keydown",function(e){switch(e.data.getKey()){case 13:case 33:case 34:case 35:case 36:case 37:case 39:case 8:case 45:case 46:o(g)}},null,null,-1),g.attachListener(g,"keydown",function(e){var t={37:1,39:1,8:1,46:1};return function(n){var i=n.data.getKeystroke();if(t[i]){var r=e.getSelection().getRanges(),a=r[0];1==r.length&&a.collapsed&&(i=a[38>i?"getPreviousEditableNode":"getNextEditableNode"]())&&i.type==CKEDITOR.NODE_ELEMENT&&"false"==i.getAttribute("contenteditable")&&(e.getSelection().fake(i),n.data.preventDefault(),n.cancel())}}}(r),null,null,-1)}),r.on("setData",function(){r.unlockSelection(),CKEDITOR.env.webkit&&i()}),r.on("contentDomUnload",function(){r.unlockSelection()}),CKEDITOR.env.ie9Compat&&r.on("beforeDestroy",i,null,null,9),r.on("dataReady",function(){delete r._.fakeSelection,delete r._.hiddenSelectionContainer,r.selectionChange(1)}),r.on("loadSnapshot",function(){var e=CKEDITOR.dom.walker.nodeType(CKEDITOR.NODE_ELEMENT),t=r.editable().getLast(e);t&&t.hasAttribute("data-cke-hidden-sel")&&(t.remove(),CKEDITOR.env.gecko&&(e=r.editable().getFirst(e))&&e.is("br")&&e.getAttribute("_moz_editor_bogus_node")&&e.remove())},null,null,100),r.on("key",function(e){if("wysiwyg"==r.mode){var t=r.getSelection();if(t.isFake){var n=g[e.data.keyCode];if(n)return n({editor:r,selected:t.getSelectedElement(),selection:t,keyEvent:e})}}})}),CKEDITOR.env.webkit&&CKEDITOR.on("instanceReady",function(e){var t=e.editor;t.on("selectionChange",function(){var e=t.editable(),n=e.getCustomData("cke-fillingChar");n&&(n.getCustomData("ready")?o(e):n.setCustomData("ready",1))},null,null,-1),t.on("beforeSetMode",function(){o(t.editable())},null,null,-1),t.on("getSnapshot",function(e){e.data&&(e.data=s(e.data))},t,null,20),t.on("toDataFormat",function(e){e.data.dataValue=s(e.data.dataValue)},null,null,0)}),CKEDITOR.editor.prototype.selectionChange=function(n){(n?e:t).call(this)},CKEDITOR.editor.prototype.getSelection=function(e){return!this._.savedSelection&&!this._.fakeSelection||e?(e=this.editable())&&"wysiwyg"==this.mode?new CKEDITOR.dom.selection(e):null:this._.savedSelection||this._.fakeSelection},CKEDITOR.editor.prototype.lockSelection=function(e){return(e=e||this.getSelection(1)).getType()!=CKEDITOR.SELECTION_NONE&&(!e.isLocked&&e.lock(),this._.savedSelection=e,!0)},CKEDITOR.editor.prototype.unlockSelection=function(e){var t=this._.savedSelection;return!!t&&(t.unlock(e),delete this._.savedSelection,!0)},CKEDITOR.editor.prototype.forceNextSelectionCheck=function(){delete this._.selectionPreviousPath},CKEDITOR.dom.document.prototype.getSelection=function(){return new CKEDITOR.dom.selection(this)},CKEDITOR.dom.range.prototype.select=function(){var e=this.root instanceof CKEDITOR.editable?this.root.editor.getSelection():new CKEDITOR.dom.selection(this.root);return e.selectRanges([this]),e},CKEDITOR.SELECTION_NONE=1,CKEDITOR.SELECTION_TEXT=2,CKEDITOR.SELECTION_ELEMENT=3,CKEDITOR.dom.selection=function(e){if(e instanceof CKEDITOR.dom.selection){var t=e;e=e.root}var n,i,r=e instanceof CKEDITOR.dom.element;if(this.rev=t?t.rev:d++,this.document=e instanceof CKEDITOR.dom.document?e:e.getDocument(),this.root=r?e:this.document.getBody(),this.isLocked=0,this._={cache:{}},t)return CKEDITOR.tools.extend(this._.cache,t._.cache),this.isFake=t.isFake,this.isLocked=t.isLocked,this;if(e=this.getNative())if(e.getRangeAt)n=(i=e.rangeCount&&e.getRangeAt(0))&&new CKEDITOR.dom.node(i.commonAncestorContainer);else{try{i=e.createRange()}catch(e){}n=i&&CKEDITOR.dom.element.get(i.item&&i.item(0)||i.parentElement())}return(!n||n.type!=CKEDITOR.NODE_ELEMENT&&n.type!=CKEDITOR.NODE_TEXT||!this.root.equals(n)&&!this.root.contains(n))&&(this._.cache.type=CKEDITOR.SELECTION_NONE,this._.cache.startElement=null,this._.cache.selectedElement=null,this._.cache.selectedText="",this._.cache.ranges=new CKEDITOR.dom.rangeList),this};var m={img:1,hr:1,li:1,table:1,tr:1,td:1,th:1,embed:1,object:1,ol:1,ul:1,a:1,input:1,form:1,select:1,textarea:1,button:1,fieldset:1,thead:1,tfoot:1};CKEDITOR.tools.extend(CKEDITOR.dom.selection,{_removeFillingCharSequenceString:s,_createFillingCharSequenceNode:a,FILLING_CHAR_SEQUENCE:h}),CKEDITOR.dom.selection.prototype={getNative:function(){return void 0!==this._.cache.nativeSel?this._.cache.nativeSel:this._.cache.nativeSel=c?this.document.$.selection:this.document.getWindow().$.getSelection()},getType:c?function(){var e=this._.cache;if(e.type)return e.type;var t=CKEDITOR.SELECTION_NONE;try{var n=this.getNative(),i=n.type;"Text"==i&&(t=CKEDITOR.SELECTION_TEXT),"Control"==i&&(t=CKEDITOR.SELECTION_ELEMENT),n.createRange().parentElement()&&(t=CKEDITOR.SELECTION_TEXT)}catch(e){}return e.type=t}:function(){var e=this._.cache;if(e.type)return e.type;var t=CKEDITOR.SELECTION_TEXT;if((n=this.getNative())&&n.rangeCount){if(1==n.rangeCount){var n,i=(n=n.getRangeAt(0)).startContainer;i==n.endContainer&&1==i.nodeType&&1==n.endOffset-n.startOffset&&m[i.childNodes[n.startOffset].nodeName.toLowerCase()]&&(t=CKEDITOR.SELECTION_ELEMENT)}}else t=CKEDITOR.SELECTION_NONE;return e.type=t},getRanges:function(){var e=c?function(){function e(e){return new CKEDITOR.dom.node(e).getIndex()}var t=function(t,n){(t=t.duplicate()).collapse(n);var i=t.parentElement();if(!i.hasChildNodes())return{container:i,offset:0};for(var r,a,o,s,l=i.children,u=t.duplicate(),c=0,d=l.length-1,h=-1;c<=d;)if(r=l[h=Math.floor((c+d)/2)],u.moveToElementText(r),0<(o=u.compareEndPoints("StartToStart",t)))d=h-1;else{if(!(0>o))return{container:i,offset:e(r)};c=h+1}if(-1==h||h==l.length-1&&0>o){if(u.moveToElementText(i),u.setEndPoint("StartToStart",t),u=u.text.replace(/(\r\n|\r)/g,"\n").length,l=i.childNodes,!u)return(r=l[l.length-1]).nodeType!=CKEDITOR.NODE_TEXT?{container:i,offset:l.length}:{container:r,offset:r.nodeValue.length};for(i=l.length;0<u&&0<i;)(a=l[--i]).nodeType==CKEDITOR.NODE_TEXT&&(s=a,u-=a.nodeValue.length);return{container:s,offset:-u}}if(u.collapse(0<o),u.setEndPoint(0<o?"StartToStart":"EndToStart",t),!(u=u.text.replace(/(\r\n|\r)/g,"\n").length))return{container:i,offset:e(r)+(0<o?0:1)};for(;0<u;)try{(a=r[0<o?"previousSibling":"nextSibling"]).nodeType==CKEDITOR.NODE_TEXT&&(u-=a.nodeValue.length,s=a),r=a}catch(t){return{container:i,offset:e(r)}}return{container:s,offset:0<o?-u:s.nodeValue.length+u}};return function(){var e=(s=this.getNative())&&s.createRange(),n=this.getType();if(!s)return[];if(n==CKEDITOR.SELECTION_TEXT)return s=new CKEDITOR.dom.range(this.root),n=t(e,!0),s.setStart(new CKEDITOR.dom.node(n.container),n.offset),n=t(e),s.setEnd(new CKEDITOR.dom.node(n.container),n.offset),s.endContainer.getPosition(s.startContainer)&CKEDITOR.POSITION_PRECEDING&&s.endOffset<=s.startContainer.getIndex()&&s.collapse(),[s];if(n==CKEDITOR.SELECTION_ELEMENT){n=[];for(var i=0;i<e.length;i++){for(var r=e.item(i),a=r.parentNode,o=0,s=new CKEDITOR.dom.range(this.root);o<a.childNodes.length&&a.childNodes[o]!=r;o++);s.setStart(new CKEDITOR.dom.node(a),o),s.setEnd(new CKEDITOR.dom.node(a),o+1),n.push(s)}return n}return[]}}():function(){var e,t=[],n=this.getNative();if(!n)return t;for(var i=0;i<n.rangeCount;i++){var r=n.getRangeAt(i);(e=new CKEDITOR.dom.range(this.root)).setStart(new CKEDITOR.dom.node(r.startContainer),r.startOffset),e.setEnd(new CKEDITOR.dom.node(r.endContainer),r.endOffset),t.push(e)}return t};return function(t){var n=this._.cache,i=n.ranges;return i||(n.ranges=i=new CKEDITOR.dom.rangeList(e.call(this))),t?function(e){for(var t=0;t<e.length;t++){var n=e[t];if(n.getCommonAncestor().isReadOnly()&&e.splice(t,1),!n.collapsed){if(n.startContainer.isReadOnly())for(var i,r=n.startContainer;r&&!((i=r.type==CKEDITOR.NODE_ELEMENT)&&r.is("body")||!r.isReadOnly());)i&&"false"==r.getAttribute("contentEditable")&&n.setStartAfter(r),r=r.getParent();r=n.startContainer,i=n.endContainer;var a=n.startOffset,o=n.endOffset,s=n.clone();r&&r.type==CKEDITOR.NODE_TEXT&&(a>=r.getLength()?s.setStartAfter(r):s.setStartBefore(r)),i&&i.type==CKEDITOR.NODE_TEXT&&(o?s.setEndAfter(i):s.setEndBefore(i)),(r=new CKEDITOR.dom.walker(s)).evaluator=function(i){if(i.type==CKEDITOR.NODE_ELEMENT&&i.isReadOnly()){var r=n.clone();return n.setEndBefore(i),n.collapsed&&e.splice(t--,1),i.getPosition(s.endContainer)&CKEDITOR.POSITION_CONTAINS||(r.setStartAfter(i),r.collapsed||e.splice(t+1,0,r)),!0}return!1},r.next()}}return e}(new CKEDITOR.dom.rangeList(i.slice())):i}}(),getStartElement:function(){var e,t=this._.cache;if(void 0!==t.startElement)return t.startElement;switch(this.getType()){case CKEDITOR.SELECTION_ELEMENT:return this.getSelectedElement();case CKEDITOR.SELECTION_TEXT:var n=this.getRanges()[0];if(n){if(n.collapsed)(e=n.startContainer).type!=CKEDITOR.NODE_ELEMENT&&(e=e.getParent());else{for(n.optimize();e=n.startContainer,n.startOffset==(e.getChildCount?e.getChildCount():e.getLength())&&!e.isBlockBoundary();)n.setStartAfter(e);if((e=n.startContainer).type!=CKEDITOR.NODE_ELEMENT)return e.getParent();if((e=e.getChild(n.startOffset))&&e.type==CKEDITOR.NODE_ELEMENT)for(n=e.getFirst();n&&n.type==CKEDITOR.NODE_ELEMENT;)e=n,n=n.getFirst();else e=n.startContainer}e=e.$}}return t.startElement=e?new CKEDITOR.dom.element(e):null},getSelectedElement:function(){var e=this._.cache;if(void 0!==e.selectedElement)return e.selectedElement;var t=this,n=CKEDITOR.tools.tryThese(function(){return t.getNative().createRange().item(0)},function(){for(var e,n,i=t.getRanges()[0].clone(),r=2;r&&!((e=i.getEnclosedNode())&&e.type==CKEDITOR.NODE_ELEMENT&&m[e.getName()]&&(n=e));r--)i.shrink(CKEDITOR.SHRINK_ELEMENT);return n&&n.$});return e.selectedElement=n?new CKEDITOR.dom.element(n):null},getSelectedText:function(){var e=this._.cache;if(void 0!==e.selectedText)return e.selectedText;var t=this.getNative();return t=c?"Control"==t.type?"":t.createRange().text:t.toString(),e.selectedText=t},lock:function(){this.getRanges(),this.getStartElement(),this.getSelectedElement(),this.getSelectedText(),this._.cache.nativeSel=null,this.isLocked=1},unlock:function(e){if(this.isLocked){if(e)var t=this.getSelectedElement(),n=!t&&this.getRanges(),i=this.isFake;this.isLocked=0,this.reset(),e&&(e=t||n[0]&&n[0].getCommonAncestor())&&e.getAscendant("body",1)&&(i?this.fake(t):t?this.selectElement(t):this.selectRanges(n))}},reset:function(){this._.cache={},this.isFake=0;var e=this.root.editor;if(e&&e._.fakeSelection)if(this.rev==e._.fakeSelection.rev){delete e._.fakeSelection;var t=e._.hiddenSelectionContainer;if(t){var n=e.checkDirty();e.fire("lockSnapshot"),t.remove(),e.fire("unlockSnapshot"),!n&&e.resetDirty()}delete e._.hiddenSelectionContainer}else CKEDITOR.warn("selection-fake-reset");this.rev=d++},selectElement:function(e){var t=new CKEDITOR.dom.range(this.root);t.setStartBefore(e),t.setEndAfter(e),this.selectRanges([t])},selectRanges:function(e){var t=(t=this.root.editor)&&t._.hiddenSelectionContainer;if(this.reset(),t){t=this.root;for(var n,i=0;i<e.length;++i)(n=e[i]).endContainer.equals(t)&&(n.endOffset=Math.min(n.endOffset,t.getChildCount()))}if(e.length)if(this.isLocked){var s=CKEDITOR.document.getActive();this.unlock(),this.selectRanges(e),this.lock(),s&&!s.equals(this.root)&&s.focus()}else{var l,u,d;if(1==e.length&&!(d=e[0]).collapsed&&(l=d.getEnclosedNode())&&l.type==CKEDITOR.NODE_ELEMENT&&((d=d.clone()).shrink(CKEDITOR.SHRINK_ELEMENT,!0),(u=d.getEnclosedNode())&&u.type==CKEDITOR.NODE_ELEMENT&&(l=u),"false"==l.getAttribute("contenteditable"))||(l=void 0),l)this.fake(l);else{if(c){var h,p,f;if(d=CKEDITOR.dom.walker.whitespaces(!0),u=/\ufeff|\u00a0/,t={table:1,tbody:1,tr:1},1<e.length&&(l=e[e.length-1],e[0].setEnd(l.endContainer,l.endOffset)),e=(l=e[0]).collapsed,(n=l.getEnclosedNode())&&n.type==CKEDITOR.NODE_ELEMENT&&n.getName()in m&&(!n.is("a")||!n.getText()))try{return(f=n.$.createControlRange()).addElement(n.$),void f.select()}catch(e){}(l.startContainer.type==CKEDITOR.NODE_ELEMENT&&l.startContainer.getName()in t||l.endContainer.type==CKEDITOR.NODE_ELEMENT&&l.endContainer.getName()in t)&&(l.shrink(CKEDITOR.NODE_ELEMENT,!0),e=l.collapsed),t=(f=l.createBookmark()).startNode,e||(s=f.endNode),(f=l.document.$.body.createTextRange()).moveToElementText(t.$),f.moveStart("character",1),s?((u=l.document.$.body.createTextRange()).moveToElementText(s.$),f.setEndPoint("EndToEnd",u),f.moveEnd("character",-1)):(h=t.getNext(d),p=t.hasAscendant("pre"),h=!(h&&h.getText&&h.getText().match(u))&&(p||!t.hasPrevious()||t.getPrevious().is&&t.getPrevious().is("br")),(p=l.document.createElement("span")).setHtml("&#65279;"),p.insertBefore(t),h&&l.document.createText("\ufeff").insertBefore(t)),l.setStartBefore(t),t.remove(),e?(h?(f.moveStart("character",-1),f.select(),l.document.$.selection.clear()):f.select(),l.moveToPosition(p,CKEDITOR.POSITION_BEFORE_START),p.remove()):(l.setEndBefore(s),s.remove(),f.select())}else{if(!(s=this.getNative()))return;for(this.removeAllRanges(),f=0;f<e.length;f++)if(f<e.length-1&&(h=e[f],p=e[f+1],(u=h.clone()).setStart(h.endContainer,h.endOffset),u.setEnd(p.startContainer,p.startOffset),!u.collapsed&&(u.shrink(CKEDITOR.NODE_ELEMENT,!0),l=u.getCommonAncestor(),u=u.getEnclosedNode(),l.isReadOnly()||u&&u.isReadOnly())))p.setStart(h.startContainer,h.startOffset),e.splice(f--,1);else{l=e[f],p=this.document.$.createRange(),l.collapsed&&CKEDITOR.env.webkit&&r(l)&&(u=a(this.root),l.insertNode(u),(h=u.getNext())&&!u.getPrevious()&&h.type==CKEDITOR.NODE_ELEMENT&&"br"==h.getName()?(o(this.root),l.moveToPosition(h,CKEDITOR.POSITION_BEFORE_START)):l.moveToPosition(u,CKEDITOR.POSITION_AFTER_END)),p.setStart(l.startContainer.$,l.startOffset);try{p.setEnd(l.endContainer.$,l.endOffset)}catch(e){if(!(0<=e.toString().indexOf("NS_ERROR_ILLEGAL_VALUE")))throw e;l.collapse(1),p.setEnd(l.endContainer.$,l.endOffset)}s.addRange(p)}}this.reset(),this.root.fire("selectionchange")}}},fake:function(e,t){var n=this.root.editor;void 0===t&&e.hasAttribute("aria-label")&&(t=e.getAttribute("aria-label")),this.reset(),function(e,t){var n=CKEDITOR.dom.element.createFromHtml('<div data-cke-hidden-sel="1" data-cke-temp="1" style="'+(CKEDITOR.env.ie&&14>CKEDITOR.env.version?"display:none":"position:fixed;top:0;left:-1000px")+'">'+(t||"&nbsp;")+"</div>",e.document);e.fire("lockSnapshot"),e.editable().append(n);var i=e.getSelection(1),r=e.createRange(),a=i.root.on("selectionchange",function(e){e.cancel()},null,null,0);r.setStartAt(n,CKEDITOR.POSITION_AFTER_START),r.setEndAt(n,CKEDITOR.POSITION_BEFORE_END),i.selectRanges([r]),a.removeListener(),e.fire("unlockSnapshot"),e._.hiddenSelectionContainer=n}(n,t);var i=this._.cache,r=new CKEDITOR.dom.range(this.root);r.setStartBefore(e),r.setEndAfter(e),i.ranges=new CKEDITOR.dom.rangeList(r),i.selectedElement=i.startElement=e,i.type=CKEDITOR.SELECTION_ELEMENT,i.selectedText=i.nativeSel=null,this.isFake=1,this.rev=d++,n._.fakeSelection=this,this.root.fire("selectionchange")},isHidden:function(){var e=this.getCommonAncestor();return e&&e.type==CKEDITOR.NODE_TEXT&&(e=e.getParent()),!(!e||!e.data("cke-hidden-sel"))},createBookmarks:function(e){return e=this.getRanges().createBookmarks(e),this.isFake&&(e.isFake=1),e},createBookmarks2:function(e){return e=this.getRanges().createBookmarks2(e),this.isFake&&(e.isFake=1),e},selectBookmarks:function(e){for(var t,n=[],i=0;i<e.length;i++){var r=new CKEDITOR.dom.range(this.root);r.moveToBookmark(e[i]),n.push(r)}return e.isFake&&((t=n[0].getEnclosedNode())&&t.type==CKEDITOR.NODE_ELEMENT||(CKEDITOR.warn("selection-not-fake"),e.isFake=0)),e.isFake?this.fake(t):this.selectRanges(n),this},getCommonAncestor:function(){var e=this.getRanges();return e.length?e[0].startContainer.getCommonAncestor(e[e.length-1].endContainer):null},scrollIntoView:function(){this.type!=CKEDITOR.SELECTION_NONE&&this.getRanges()[0].scrollIntoView()},removeAllRanges:function(){if(this.getType()!=CKEDITOR.SELECTION_NONE){var e=this.getNative();try{e&&e[c?"empty":"removeAllRanges"]()}catch(e){}this.reset()}}}}(),CKEDITOR.STYLE_BLOCK=1,CKEDITOR.STYLE_INLINE=2,CKEDITOR.STYLE_OBJECT=3,function(){function e(e,t){for(var n,i;(e=e.getParent())&&!e.equals(t);)if(e.getAttribute("data-nostyle"))n=e;else if(!i){var r=e.getAttribute("contentEditable");"false"==r?n=e:"true"==r&&(i=1)}return n}function t(e,t,n,i){return(e.getPosition(t)|i)==i&&(!n.childRule||n.childRule(e))}function n(i){var a=i.document;if(i.collapsed)a=g(this,a),i.insertNode(a),i.moveToPosition(a,CKEDITOR.POSITION_BEFORE_END);else{var o,s=this.element,l=this._.definition,u=(y=l.ignoreReadonly)||l.includeReadonly;null==u&&(u=i.root.getCustomData("cke_includeReadonly"));var c=CKEDITOR.dtd[s];c||(o=!0,c=CKEDITOR.dtd.span),i.enlarge(CKEDITOR.ENLARGE_INLINE,1),i.trim();var d,p=i.createBookmark(),f=p.startNode,m=p.endNode,v=f;if(!y){var y=e(f,b=i.getCommonAncestor()),b=e(m,b);y&&(v=y.getNextSourceNode(!0)),b&&(m=b)}for(v.getPosition(m)==CKEDITOR.POSITION_FOLLOWING&&(v=0);v;){if(y=!1,v.equals(m))v=null,y=!0;else{b=(I=v.type==CKEDITOR.NODE_ELEMENT?v.getName():null)&&"false"==v.getAttribute("contentEditable");var _=I&&v.getAttribute("data-nostyle");if(I&&v.data("cke-bookmark")){v=v.getNextSourceNode(!0);continue}if(b&&u&&CKEDITOR.dtd.$block[I])for(var T=void 0,E=0,C=(L=(P=r(C=v)).length)&&new CKEDITOR.dom.range(C.getDocument());E<L;++E){T=P[E];var w=CKEDITOR.filter.instances[T.data("cke-filter")];w&&!w.check(this)||(C.selectNodeContents(T),n.call(this,C))}if(P=I?!c[I]||_?0:b&&!u?0:t(v,m,l,O):1){if(P=l,L=s,E=o,!(T=v.getParent())||!(T.getDtd()||CKEDITOR.dtd.span)[L]&&!E||P.parentRule&&!P.parentRule(T))y=!0;else if(d||I&&CKEDITOR.dtd.$removeEmpty[I]&&(v.getPosition(m)|O)!=O||(d=i.clone()).setStartBefore(v),(I=v.type)==CKEDITOR.NODE_TEXT||b||I==CKEDITOR.NODE_ELEMENT&&!v.getChildCount()){for(var k,I=v;(y=!I.getNext(S))&&c[(k=I.getParent()).getName()]&&t(k,f,l,D);)I=k;d.setEndAfter(I)}}else y=!0;v=v.getNextSourceNode(_||b)}if(y&&d&&!d.collapsed){b=(y=g(this,a)).hasAttributes(),_=d.getCommonAncestor(),I={};for(var R,x,A,P={},L=(T={},{});y&&_;){if(_.getName()==s){for(R in l.attributes)!L[R]&&(A=_.getAttribute(x))&&(y.getAttribute(R)==A?P[R]=1:L[R]=1);for(x in l.styles)!T[x]&&(A=_.getStyle(x))&&(y.getStyle(x)==A?I[x]=1:T[x]=1)}_=_.getParent()}for(R in P)y.removeAttribute(R);for(x in I)y.removeStyle(x);b&&!y.hasAttributes()&&(y=null),y?(d.extractContents().appendTo(y),d.insertNode(y),h.call(this,y),y.mergeSiblings(),CKEDITOR.env.ie||y.$.normalize()):(y=new CKEDITOR.dom.element("span"),d.extractContents().appendTo(y),d.insertNode(y),h.call(this,y),y.remove(!0)),d=null}}i.moveToBookmark(p),i.shrink(CKEDITOR.SHRINK_TEXT),i.shrink(CKEDITOR.NODE_ELEMENT,!0)}}function i(e){function t(){for(var e=new CKEDITOR.dom.elementPath(i.getParent()),t=new CKEDITOR.dom.elementPath(u.getParent()),n=null,r=null,a=0;a<e.elements.length;a++){var o=e.elements[a];if(o==e.block||o==e.blockLimit)break;c.checkElementRemovable(o,!0)&&(n=o)}for(a=0;a<t.elements.length&&(o=t.elements[a])!=t.block&&o!=t.blockLimit;a++)c.checkElementRemovable(o,!0)&&(r=o);r&&u.breakParent(r),n&&i.breakParent(n)}e.enlarge(CKEDITOR.ENLARGE_INLINE,1);var n=e.createBookmark(),i=n.startNode;if(e.collapsed){for(var r,a,o=new CKEDITOR.dom.elementPath(i.getParent(),e.root),s=0;s<o.elements.length&&(a=o.elements[s])&&a!=o.block&&a!=o.blockLimit;s++)if(this.checkElementRemovable(a)){var l;e.collapsed&&(e.checkBoundaryOfElement(a,CKEDITOR.END)||(l=e.checkBoundaryOfElement(a,CKEDITOR.START)))?(r=a).match=l?"start":"end":(a.mergeSiblings(),a.is(this.element)?d.call(this,a):p(a,y(this)[a.getName()]))}if(r){for(a=i,s=0;!(l=o.elements[s]).equals(r);s++)l.match||((l=l.clone()).append(a),a=l);a["start"==r.match?"insertBefore":"insertAfter"](r)}}else{var u=n.endNode,c=this;for(t(),o=i;!o.equals(u);)r=o.getNextSourceNode(),o.type==CKEDITOR.NODE_ELEMENT&&this.checkElementRemovable(o)&&(o.getName()==this.element?d.call(this,o):p(o,y(this)[o.getName()]),r.type==CKEDITOR.NODE_ELEMENT&&r.contains(i)&&(t(),r=i.getNext())),o=r}e.moveToBookmark(n),e.shrink(CKEDITOR.NODE_ELEMENT,!0)}function r(e){var t=[];return e.forEach(function(e){if("true"==e.getAttribute("contenteditable"))return t.push(e),!1},CKEDITOR.NODE_ELEMENT,!0),t}function a(e){var t=e.getEnclosedNode()||e.getCommonAncestor(!1,!0);(e=new CKEDITOR.dom.elementPath(t,e.root).contains(this.element,1))&&!e.isReadOnly()&&m(e,this)}function o(e){var t=e.getCommonAncestor(!0,!0);if(e=new CKEDITOR.dom.elementPath(t,e.root).contains(this.element,1)){var n=(t=this._.definition).attributes;if(n)for(var i in n)e.removeAttribute(i,n[i]);if(t.styles)for(var r in t.styles)t.styles.hasOwnProperty(r)&&e.removeStyle(r)}}function s(e){var t=e.createBookmark(!0),n=e.createIterator();n.enforceRealBlocks=!0,this._.enterMode&&(n.enlargeBr=this._.enterMode!=CKEDITOR.ENTER_BR);for(var i,r=e.document;i=n.getNextParagraph();)!i.isReadOnly()&&(!n.activeFilter||n.activeFilter.check(this))&&u(i,g(this,r,i));e.moveToBookmark(t)}function l(e){var t,n,i=e.createBookmark(1),r=e.createIterator();for(r.enforceRealBlocks=!0,r.enlargeBr=this._.enterMode!=CKEDITOR.ENTER_BR;t=r.getNextParagraph();)this.checkElementRemovable(t)&&(t.is("pre")?((n=this._.enterMode==CKEDITOR.ENTER_BR?null:e.document.createElement(this._.enterMode==CKEDITOR.ENTER_P?"p":"div"))&&t.copyAttributes(n),u(t,n)):d.call(this,t));e.moveToBookmark(i)}function u(e,t){(n=!t)&&(t=e.getDocument().createElement("div"),e.copyAttributes(t));var n,i,r=t&&t.is("pre"),a=e.is("pre"),o=!r&&a;if(r&&!a){if(a=t,(o=e.getBogus())&&o.remove(),o=(o=(o=(o=c(o=e.getHtml(),/(?:^[ \t\n\r]+)|(?:[ \t\n\r]+$)/g,"")).replace(/[ \t\r\n]*(<br[^>]*>)[ \t\r\n]*/gi,"$1")).replace(/([ \t\n\r]+|&nbsp;)/g," ")).replace(/<br\b[^>]*>/gi,"\n"),CKEDITOR.env.ie){var s=e.getDocument().createElement("div");s.append(a),a.$.outerHTML="<pre>"+o+"</pre>",a.copyAttributes(s.getFirst()),a=s.getFirst().remove()}else a.setHtml(o);t=a}else o?t=function(e,t){var n;1<e.length&&(n=new CKEDITOR.dom.documentFragment(t.getDocument()));for(var i=0;i<e.length;i++){var r=(r=(r=c(r=c(r=c(r=(r=e[i]).replace(/(\r\n|\r)/g,"\n"),/^[ \t]*\n/,""),/\n$/,""),/^[ \t]+|[ \t]+$/g,function(e,t){return 1==e.length?"&nbsp;":t?" "+CKEDITOR.tools.repeat("&nbsp;",e.length-1):CKEDITOR.tools.repeat("&nbsp;",e.length-1)+" "})).replace(/\n/g,"<br>")).replace(/[ \t]{2,}/g,function(e){return CKEDITOR.tools.repeat("&nbsp;",e.length-1)+" "});if(n){var a=t.clone();a.setHtml(r),n.append(a)}else t.setHtml(r)}return n||t}(n?[e.getHtml()]:function(e){var t=[];return c(e.getOuterHtml(),/(\S\s*)\n(?:\s|(<span[^>]+data-cke-bookmark.*?\/span>))*\n(?!$)/gi,function(e,t,n){return t+"</pre>"+n+"<pre>"}).replace(/<pre\b.*?>([\s\S]*?)<\/pre>/gi,function(e,n){t.push(n)}),t}(e),t):e.moveChildren(t);t.replace(e),r?(i=(n=t).getPrevious(I))&&i.type==CKEDITOR.NODE_ELEMENT&&i.is("pre")&&(r=c(i.getHtml(),/\n$/,"")+"\n\n"+c(n.getHtml(),/^\n/,""),CKEDITOR.env.ie?n.$.outerHTML="<pre>"+r+"</pre>":n.setHtml(r),i.remove()):n&&f(t)}function c(e,t,n){var i="",r="";return e=e.replace(/(^<span[^>]+data-cke-bookmark.*?\/span>)|(<span[^>]+data-cke-bookmark.*?\/span>$)/gi,function(e,t,n){return t&&(i=t),n&&(r=n),""}),i+e.replace(t,n)+r}function d(e,t){var n,i=(r=this._.definition).attributes,r=r.styles,a=y(this)[e.getName()],o=CKEDITOR.tools.isEmpty(i)&&CKEDITOR.tools.isEmpty(r);for(n in i)("class"!=n&&!this._.definition.fullMatch||e.getAttribute(n)==b(n,i[n]))&&(t&&"data-"==n.slice(0,5)||(o=e.hasAttribute(n),e.removeAttribute(n)));for(var s in r)this._.definition.fullMatch&&e.getStyle(s)!=b(s,r[s],!0)||(o=o||!!e.getStyle(s),e.removeStyle(s));p(e,a,E[e.getName()]),o&&(this._.definition.alwaysRemoveElement?f(e,1):!CKEDITOR.dtd.$block[e.getName()]||this._.enterMode==CKEDITOR.ENTER_BR&&!e.hasAttributes()?f(e):e.renameNode(this._.enterMode==CKEDITOR.ENTER_P?"p":"div"))}function h(e){for(var t,n=y(this),i=e.getElementsByTag(this.element),r=i.count();0<=--r;)(t=i.getItem(r)).isReadOnly()||d.call(this,t,!0);for(var a in n)if(a!=this.element)for(r=(i=e.getElementsByTag(a)).count()-1;0<=r;r--)(t=i.getItem(r)).isReadOnly()||p(t,n[a])}function p(e,t,n){if(t=t&&t.attributes)for(var i=0;i<t.length;i++){var r,a=t[i][0];if(r=e.getAttribute(a)){var o=t[i][1];(null===o||o.test&&o.test(r)||"string"==typeof o&&r==o)&&e.removeAttribute(a)}}n||f(e)}function f(e,t){if(!e.hasAttributes()||t)if(CKEDITOR.dtd.$block[e.getName()]){var n=e.getPrevious(I),i=e.getNext(I);!n||n.type!=CKEDITOR.NODE_TEXT&&n.isBlockBoundary({br:1})||e.append("br",1),!i||i.type!=CKEDITOR.NODE_TEXT&&i.isBlockBoundary({br:1})||e.append("br"),e.remove(!0)}else n=e.getFirst(),i=e.getLast(),e.remove(!0),n&&(n.type==CKEDITOR.NODE_ELEMENT&&n.mergeSiblings(),i&&!n.equals(i)&&i.type==CKEDITOR.NODE_ELEMENT&&i.mergeSiblings())}function g(e,t,n){var i;return"*"==(i=e.element)&&(i="span"),i=new CKEDITOR.dom.element(i,t),n&&n.copyAttributes(i),i=m(i,e),t.getCustomData("doc_processing_style")&&i.hasAttribute("id")?i.removeAttribute("id"):t.setCustomData("doc_processing_style",1),i}function m(e,t){var n=(i=t._.definition).attributes,i=CKEDITOR.style.getStyleText(i);if(n)for(var r in n)e.setAttribute(r,n[r]);return i&&e.setAttribute("style",i),e}function v(e,t){for(var n in e)e[n]=e[n].replace(k,function(e,n){return t[n]})}function y(e){if(e._.overrides)return e._.overrides;var t=e._.overrides={},n=e._.definition.overrides;if(n){CKEDITOR.tools.isArray(n)||(n=[n]);for(var i=0;i<n.length;i++){var r,a;if("string"==typeof(s=n[i])?r=s.toLowerCase():(r=s.element?s.element.toLowerCase():e.element,a=s.attributes),s=t[r]||(t[r]={}),a){var o,s=s.attributes=s.attributes||[];for(o in a)s.push([o.toLowerCase(),a[o]])}}}return t}function b(e,t,n){var i=new CKEDITOR.dom.element("span");return i[n?"setStyle":"setAttribute"](e,t),i[n?"getStyle":"getAttribute"](e)}function _(e,t){function n(e,t){return"font-family"==t.toLowerCase()?e.replace(/["']/g,""):e}for(var i in"string"==typeof e&&(e=CKEDITOR.tools.parseCssText(e)),"string"==typeof t&&(t=CKEDITOR.tools.parseCssText(t,!0)),e)if(!(i in t)||n(t[i],i)!=n(e[i],i)&&"inherit"!=e[i]&&"inherit"!=t[i])return!1;return!0}function T(e,t,n){var i=e.document,r=e.getRanges();t=t?this.removeFromRange:this.applyToRange;for(var a,o=r.createIterator();a=o.getNextRange();)t.call(this,a,n);e.selectRanges(r),i.removeCustomData("doc_processing_style")}var E={address:1,div:1,h1:1,h2:1,h3:1,h4:1,h5:1,h6:1,p:1,pre:1,section:1,header:1,footer:1,nav:1,article:1,aside:1,figure:1,dialog:1,hgroup:1,time:1,meter:1,menu:1,command:1,keygen:1,output:1,progress:1,details:1,datagrid:1,datalist:1},C={a:1,blockquote:1,embed:1,hr:1,img:1,li:1,object:1,ol:1,table:1,td:1,tr:1,th:1,ul:1,dl:1,dt:1,dd:1,form:1,audio:1,video:1},w=/\s*(?:;\s*|$)/,k=/#\((.+?)\)/g,S=CKEDITOR.dom.walker.bookmark(0,1),I=CKEDITOR.dom.walker.whitespaces(1);CKEDITOR.style=function(e,t){if("string"==typeof e.type)return new CKEDITOR.style.customHandlers[e.type](e);var n=e.attributes;n&&n.style&&(e.styles=CKEDITOR.tools.extend({},e.styles,CKEDITOR.tools.parseCssText(n.style)),delete n.style),t&&(v((e=CKEDITOR.tools.clone(e)).attributes,t),v(e.styles,t)),n=this.element=e.element?"string"==typeof e.element?e.element.toLowerCase():e.element:"*",this.type=e.type||(E[n]?CKEDITOR.STYLE_BLOCK:C[n]?CKEDITOR.STYLE_OBJECT:CKEDITOR.STYLE_INLINE),"object"==typeof this.element&&(this.type=CKEDITOR.STYLE_OBJECT),this._={definition:e}},CKEDITOR.style.prototype={apply:function(e){if(e instanceof CKEDITOR.dom.document)return T.call(this,e.getSelection());if(this.checkApplicable(e.elementPath(),e)){var t=this._.enterMode;t||(this._.enterMode=e.activeEnterMode),T.call(this,e.getSelection(),0,e),this._.enterMode=t}},remove:function(e){if(e instanceof CKEDITOR.dom.document)return T.call(this,e.getSelection(),1);if(this.checkApplicable(e.elementPath(),e)){var t=this._.enterMode;t||(this._.enterMode=e.activeEnterMode),T.call(this,e.getSelection(),1,e),this._.enterMode=t}},applyToRange:function(e){return this.applyToRange=this.type==CKEDITOR.STYLE_INLINE?n:this.type==CKEDITOR.STYLE_BLOCK?s:this.type==CKEDITOR.STYLE_OBJECT?a:null,this.applyToRange(e)},removeFromRange:function(e){return this.removeFromRange=this.type==CKEDITOR.STYLE_INLINE?i:this.type==CKEDITOR.STYLE_BLOCK?l:this.type==CKEDITOR.STYLE_OBJECT?o:null,this.removeFromRange(e)},applyToObject:function(e){m(e,this)},checkActive:function(e,t){switch(this.type){case CKEDITOR.STYLE_BLOCK:return this.checkElementRemovable(e.block||e.blockLimit,!0,t);case CKEDITOR.STYLE_OBJECT:case CKEDITOR.STYLE_INLINE:for(var n,i=e.elements,r=0;r<i.length;r++)if(n=i[r],this.type!=CKEDITOR.STYLE_INLINE||n!=e.block&&n!=e.blockLimit){if(this.type==CKEDITOR.STYLE_OBJECT){var a=n.getName();if(!("string"==typeof this.element?a==this.element:a in this.element))continue}if(this.checkElementRemovable(n,!0,t))return!0}}return!1},checkApplicable:function(e,t,n){if(t&&t instanceof CKEDITOR.filter&&(n=t),n&&!n.check(this))return!1;switch(this.type){case CKEDITOR.STYLE_OBJECT:return!!e.contains(this.element);case CKEDITOR.STYLE_BLOCK:return!!e.blockLimit.getDtd()[this.element]}return!0},checkElementMatch:function(e,t){var n=this._.definition;if(!e||!n.ignoreReadonly&&e.isReadOnly())return!1;var i=e.getName();if("string"==typeof this.element?i==this.element:i in this.element){if(!t&&!e.hasAttributes())return!0;if(i=n._AC)n=i;else{i={};var r=0,a=n.attributes;if(a)for(var o in a)r++,i[o]=a[o];(o=CKEDITOR.style.getStyleText(n))&&(i.style||r++,i.style=o),i._length=r,n=n._AC=i}if(!n._length)return!0;for(var s in n)if("_length"!=s)if(i=e.getAttribute(s)||"","style"==s?_(n[s],i):n[s]==i){if(!t)return!0}else if(t)return!1;if(t)return!0}return!1},checkElementRemovable:function(e,t,n){if(this.checkElementMatch(e,t,n))return!0;if(t=y(this)[e.getName()]){var i;if(!(t=t.attributes))return!0;for(n=0;n<t.length;n++)if(i=t[n][0],i=e.getAttribute(i)){var r=t[n][1];if(null===r)return!0;if("string"==typeof r){if(i==r)return!0}else if(r.test(i))return!0}}return!1},buildPreview:function(e){var t=this._.definition,n=[],i=t.element;"bdo"==i&&(i="span"),n=["<",i];var r=t.attributes;if(r)for(var a in r)n.push(" ",a,'="',r[a],'"');return(r=CKEDITOR.style.getStyleText(t))&&n.push(' style="',r,'"'),n.push(">",e||t.name,"</",i,">"),n.join("")},getDefinition:function(){return this._.definition}},CKEDITOR.style.getStyleText=function(e){if(t=e._ST)return t;var t=e.styles,n=e.attributes&&e.attributes.style||"",i="";for(var r in n.length&&(n=n.replace(w,";")),t){var a=t[r],o=(r+":"+a).replace(w,";");"inherit"==a?i+=o:n+=o}return n.length&&(n=CKEDITOR.tools.normalizeCssText(n,!0)),e._ST=n+i},CKEDITOR.style.customHandlers={},CKEDITOR.style.addCustomHandler=function(e){var t=function(e){this._={definition:e},this.setup&&this.setup(e)};return t.prototype=CKEDITOR.tools.extend(CKEDITOR.tools.prototypedCopy(CKEDITOR.style.prototype),{assignedTo:CKEDITOR.STYLE_OBJECT},e,!0),this.customHandlers[e.type]=t};var O=CKEDITOR.POSITION_PRECEDING|CKEDITOR.POSITION_IDENTICAL|CKEDITOR.POSITION_IS_CONTAINED,D=CKEDITOR.POSITION_FOLLOWING|CKEDITOR.POSITION_IDENTICAL|CKEDITOR.POSITION_IS_CONTAINED}(),CKEDITOR.styleCommand=function(e,t){this.requiredContent=this.allowedContent=this.style=e,CKEDITOR.tools.extend(this,t,!0)},CKEDITOR.styleCommand.prototype.exec=function(e){e.focus(),this.state==CKEDITOR.TRISTATE_OFF?e.applyStyle(this.style):this.state==CKEDITOR.TRISTATE_ON&&e.removeStyle(this.style)},CKEDITOR.stylesSet=new CKEDITOR.resourceManager("","stylesSet"),CKEDITOR.addStylesSet=CKEDITOR.tools.bind(CKEDITOR.stylesSet.add,CKEDITOR.stylesSet),CKEDITOR.loadStylesSet=function(e,t,n){CKEDITOR.stylesSet.addExternal(e,t,""),CKEDITOR.stylesSet.load(e,n)},CKEDITOR.tools.extend(CKEDITOR.editor.prototype,{attachStyleStateChange:function(e,t){var n=this._.styleStateChangeCallbacks;n||(n=this._.styleStateChangeCallbacks=[],this.on("selectionChange",function(e){for(var t=0;t<n.length;t++){var i=n[t],r=i.style.checkActive(e.data.path,this)?CKEDITOR.TRISTATE_ON:CKEDITOR.TRISTATE_OFF;i.fn.call(this,r)}})),n.push({style:e,fn:t})},applyStyle:function(e){e.apply(this)},removeStyle:function(e){e.remove(this)},getStylesSet:function(e){if(this._.stylesDefinitions)e(this._.stylesDefinitions);else{var t=this;if(!1===(n=t.config.stylesCombo_stylesSet||t.config.stylesSet))e(null);else if(n instanceof Array)t._.stylesDefinitions=n,e(n);else{n||(n="default");var n,i=(n=n.split(":"))[0];CKEDITOR.stylesSet.addExternal(i,n[1]?n.slice(1).join(":"):CKEDITOR.getUrl("styles.js"),""),CKEDITOR.stylesSet.load(i,function(n){t._.stylesDefinitions=n[i],e(t._.stylesDefinitions)})}}}}),CKEDITOR.dom.comment=function(e,t){"string"==typeof e&&(e=(t?t.$:document).createComment(e)),CKEDITOR.dom.domObject.call(this,e)},CKEDITOR.dom.comment.prototype=new CKEDITOR.dom.node,CKEDITOR.tools.extend(CKEDITOR.dom.comment.prototype,{type:CKEDITOR.NODE_COMMENT,getOuterHtml:function(){return"\x3c!--"+this.$.nodeValue+"--\x3e"}}),function(){var e,t={},n={};for(e in CKEDITOR.dtd.$blockLimit)e in CKEDITOR.dtd.$list||(t[e]=1);for(e in CKEDITOR.dtd.$block)e in CKEDITOR.dtd.$blockLimit||e in CKEDITOR.dtd.$empty||(n[e]=1);CKEDITOR.dom.elementPath=function(e,i){var r,a=null,o=null,s=[],l=e;i=i||e.getDocument().getBody();do{if(l.type==CKEDITOR.NODE_ELEMENT){if(s.push(l),!this.lastElement&&(this.lastElement=l,l.is(CKEDITOR.dtd.$object)||"false"==l.getAttribute("contenteditable")))continue;if(l.equals(i))break;if(!o&&(r=l.getName(),"true"==l.getAttribute("contenteditable")?o=l:!a&&n[r]&&(a=l),t[r])){if(r=!a&&"div"==r){e:{for(var u=0,c=(r=l.getChildren()).count();u<c;u++){var d=r.getItem(u);if(d.type==CKEDITOR.NODE_ELEMENT&&CKEDITOR.dtd.$block[d.getName()]){r=!0;break e}}r=!1}r=!r}r?a=l:o=l}}}while(l=l.getParent());o||(o=i),this.block=a,this.blockLimit=o,this.root=i,this.elements=s}}(),CKEDITOR.dom.elementPath.prototype={compare:function(e){var t=this.elements;if(!(e=e&&e.elements)||t.length!=e.length)return!1;for(var n=0;n<t.length;n++)if(!t[n].equals(e[n]))return!1;return!0},contains:function(e,t,n){var i;"string"==typeof e&&(i=function(t){return t.getName()==e}),e instanceof CKEDITOR.dom.element?i=function(t){return t.equals(e)}:CKEDITOR.tools.isArray(e)?i=function(t){return-1<CKEDITOR.tools.indexOf(e,t.getName())}:"function"==typeof e?i=e:"object"==typeof e&&(i=function(t){return t.getName()in e});var r=this.elements,a=r.length;for(t&&a--,n&&(r=Array.prototype.slice.call(r,0)).reverse(),t=0;t<a;t++)if(i(r[t]))return r[t];return null},isContextFor:function(e){return!(e in CKEDITOR.dtd.$block&&!(this.contains(CKEDITOR.dtd.$intermediate)||this.root.equals(this.block)&&this.block||this.blockLimit).getDtd()[e])},direction:function(){return(this.block||this.blockLimit||this.root).getDirection(1)}},CKEDITOR.dom.text=function(e,t){"string"==typeof e&&(e=(t?t.$:document).createTextNode(e)),this.$=e},CKEDITOR.dom.text.prototype=new CKEDITOR.dom.node,CKEDITOR.tools.extend(CKEDITOR.dom.text.prototype,{type:CKEDITOR.NODE_TEXT,getLength:function(){return this.$.nodeValue.length},getText:function(){return this.$.nodeValue},setText:function(e){this.$.nodeValue=e},split:function(e){var t=this.$.parentNode,n=t.childNodes.length,i=this.getLength(),r=this.getDocument(),a=new CKEDITOR.dom.text(this.$.splitText(e),r);return t.childNodes.length==n&&(e>=i?(a=r.createText("")).insertAfter(this):((e=r.createText("")).insertAfter(a),e.remove())),a},substring:function(e,t){return"number"!=typeof t?this.$.nodeValue.substr(e):this.$.nodeValue.substring(e,t)}}),function(){function e(e,t,n){var i=e.serializable,r=t[n?"endContainer":"startContainer"],a=n?"endOffset":"startOffset",o=i?t.document.getById(e.startNode):e.startNode;return e=i?t.document.getById(e.endNode):e.endNode,r.equals(o.getPrevious())?(t.startOffset=t.startOffset-r.getLength()-e.getPrevious().getLength(),r=e.getNext()):r.equals(e.getPrevious())&&(t.startOffset-=r.getLength(),r=e.getNext()),r.equals(o.getParent())&&t[a]++,r.equals(e.getParent())&&t[a]++,t[n?"endContainer":"startContainer"]=r,t}CKEDITOR.dom.rangeList=function(e){return e instanceof CKEDITOR.dom.rangeList?e:(e?e instanceof CKEDITOR.dom.range&&(e=[e]):e=[],CKEDITOR.tools.extend(e,t))};var t={createIterator:function(){var e,t=this,n=CKEDITOR.dom.walker.bookmark(),i=[];return{getNextRange:function(r){var a=t[e=void 0===e?0:e+1];if(a&&1<t.length){if(!e)for(var o=t.length-1;0<=o;o--)i.unshift(t[o].createBookmark(!0));if(r)for(var s=0;t[e+s+1];){var l=a.document;for(r=0,o=l.getById(i[s].endNode),l=l.getById(i[s+1].startNode);;){if(o=o.getNextSourceNode(!1),l.equals(o))r=1;else if(n(o)||o.type==CKEDITOR.NODE_ELEMENT&&o.isBlockBoundary())continue;break}if(!r)break;s++}for(a.moveToBookmark(i.shift());s--;)(o=t[++e]).moveToBookmark(i.shift()),a.setEnd(o.endContainer,o.endOffset)}return a}}},createBookmarks:function(t){for(var n,i=[],r=0;r<this.length;r++){i.push(n=this[r].createBookmark(t,!0));for(var a=r+1;a<this.length;a++)this[a]=e(n,this[a]),this[a]=e(n,this[a],!0)}return i},createBookmarks2:function(e){for(var t=[],n=0;n<this.length;n++)t.push(this[n].createBookmark2(e));return t},moveToBookmarks:function(e){for(var t=0;t<this.length;t++)this[t].moveToBookmark(e[t])}}}(),function(){function e(){return CKEDITOR.getUrl(CKEDITOR.skinName.split(",")[1]||"skins/"+CKEDITOR.skinName.split(",")[0]+"/")}function t(t){var n=CKEDITOR.skin["ua_"+t],i=CKEDITOR.env;if(n){n=n.split(",").sort(function(e,t){return e>t?-1:1});for(var r,a=0;a<n.length;a++)if(r=n[a],i.ie&&(r.replace(/^ie/,"")==i.version||i.quirks&&"iequirks"==r)&&(r="ie"),i[r]){t+="_"+n[a];break}}return CKEDITOR.getUrl(e()+t+".css")}function n(e,n){a[e]||(CKEDITOR.document.appendStyleSheet(t(e)),a[e]=1),n&&n()}function i(e){var t=e.getById(o);return t||((t=e.getHead().append("style")).setAttribute("id",o),t.setAttribute("type","text/css")),t}function r(e,t,n){var i,r,a;if(CKEDITOR.env.webkit)for(t=t.split("}").slice(0,-1),r=0;r<t.length;r++)t[r]=t[r].split("{");for(var o=0;o<e.length;o++)if(CKEDITOR.env.webkit)for(r=0;r<t.length;r++){for(a=t[r][1],i=0;i<n.length;i++)a=a.replace(n[i][0],n[i][1]);e[o].$.sheet.addRule(t[r][0],a)}else{for(a=t,i=0;i<n.length;i++)a=a.replace(n[i][0],n[i][1]);CKEDITOR.env.ie&&11>CKEDITOR.env.version?e[o].$.styleSheet.cssText+=a:e[o].$.innerHTML+=a}}var a={};CKEDITOR.skin={path:e,loadPart:function(t,i){CKEDITOR.skin.name!=CKEDITOR.skinName.split(",")[0]?CKEDITOR.scriptLoader.load(CKEDITOR.getUrl(e()+"skin.js"),function(){n(t,i)}):n(t,i)},getPath:function(e){return CKEDITOR.getUrl(t(e))},icons:{},addIcon:function(e,t,n,i){e=e.toLowerCase(),this.icons[e]||(this.icons[e]={path:t,offset:n||0,bgsize:i||"16px"})},getIconStyle:function(e,t,n,i,r){var a;return e&&(e=e.toLowerCase(),t&&(a=this.icons[e+"-rtl"]),a||(a=this.icons[e])),e=n||a&&a.path||"",i=i||a&&a.offset,r=r||a&&a.bgsize||"16px",e&&(e=e.replace(/'/g,"\\'")),e&&"background-image:url('"+CKEDITOR.getUrl(e)+"');background-position:0 "+i+"px;background-size:"+r+";"}},CKEDITOR.tools.extend(CKEDITOR.editor.prototype,{getUiColor:function(){return this.uiColor},setUiColor:function(e){var t=i(CKEDITOR.document);return(this.setUiColor=function(e){this.uiColor=e;var n=CKEDITOR.skin.chameleon,i="",a="";"function"==typeof n&&(i=n(this,"editor"),a=n(this,"panel")),r([t],i,e=[[l,e]]),r(s,a,e)}).call(this,e)}});var o="cke_ui_color",s=[],l=/\$color/g;CKEDITOR.on("instanceLoaded",function(e){if(!CKEDITOR.env.ie||!CKEDITOR.env.quirks){var t=e.editor;e=function(e){if(!(e=(e.data[0]||e.data).element.getElementsByTag("iframe").getItem(0).getFrameDocument()).getById("cke_ui_color")){e=i(e),s.push(e);var n=t.getUiColor();n&&r([e],CKEDITOR.skin.chameleon(t,"panel"),[[l,n]])}},t.on("panelShow",e),t.on("menuShow",e),t.config.uiColor&&t.setUiColor(t.config.uiColor)}})}(),function(){if(CKEDITOR.env.webkit)CKEDITOR.env.hc=!1;else{var e=CKEDITOR.dom.element.createFromHtml('<div style="width:0;height:0;position:absolute;left:-10000px;border:1px solid;border-color:red blue"></div>',CKEDITOR.document);e.appendTo(CKEDITOR.document.getHead());try{var t=e.getComputedStyle("border-top-color"),n=e.getComputedStyle("border-right-color");CKEDITOR.env.hc=!(!t||t!=n)}catch(e){CKEDITOR.env.hc=!1}e.remove()}if(CKEDITOR.env.hc&&(CKEDITOR.env.cssClass+=" cke_hc"),CKEDITOR.document.appendStyleText(".cke{visibility:hidden;}"),CKEDITOR.status="loaded",CKEDITOR.fireOnce("loaded"),e=CKEDITOR._.pending)for(delete CKEDITOR._.pending,t=0;t<e.length;t++)CKEDITOR.editor.prototype.constructor.apply(e[t][0],e[t][1]),CKEDITOR.add(e[t][0])}(),CKEDITOR.skin.name="moono-lisa",CKEDITOR.skin.ua_editor="ie,iequirks,ie8,gecko",CKEDITOR.skin.ua_dialog="ie,iequirks,ie8",CKEDITOR.skin.chameleon=function(){var e=function(e,t){for(var n=e.match(/[^#]./g),i=0;3>i;i++){var r,a=i;r=parseInt(n[i],16),r=("0"+(0>t?0|r*(1+t):0|r+(255-r)*t).toString(16)).slice(-2),n[a]=r}return"#"+n.join("")},t={editor:new CKEDITOR.template("{id}.cke_chrome [border-color:{defaultBorder};] {id} .cke_top [ background-color:{defaultBackground};border-bottom-color:{defaultBorder};] {id} .cke_bottom [background-color:{defaultBackground};border-top-color:{defaultBorder};] {id} .cke_resizer [border-right-color:{ckeResizer}] {id} .cke_dialog_title [background-color:{defaultBackground};border-bottom-color:{defaultBorder};] {id} .cke_dialog_footer [background-color:{defaultBackground};outline-color:{defaultBorder};] {id} .cke_dialog_tab [background-color:{dialogTab};border-color:{defaultBorder};] {id} .cke_dialog_tab:hover [background-color:{lightBackground};] {id} .cke_dialog_contents [border-top-color:{defaultBorder};] {id} .cke_dialog_tab_selected, {id} .cke_dialog_tab_selected:hover [background:{dialogTabSelected};border-bottom-color:{dialogTabSelectedBorder};] {id} .cke_dialog_body [background:{dialogBody};border-color:{defaultBorder};] {id} a.cke_button_off:hover,{id} a.cke_button_off:focus,{id} a.cke_button_off:active [background-color:{darkBackground};border-color:{toolbarElementsBorder};] {id} .cke_button_on [background-color:{ckeButtonOn};border-color:{toolbarElementsBorder};] {id} .cke_toolbar_separator,{id} .cke_toolgroup a.cke_button:last-child:after,{id} .cke_toolgroup a.cke_button.cke_button_disabled:hover:last-child:after [background-color: {toolbarElementsBorder};border-color: {toolbarElementsBorder};] {id} a.cke_combo_button:hover,{id} a.cke_combo_button:focus,{id} .cke_combo_on a.cke_combo_button [border-color:{toolbarElementsBorder};background-color:{darkBackground};] {id} .cke_combo:after [border-color:{toolbarElementsBorder};] {id} .cke_path_item [color:{elementsPathColor};] {id} a.cke_path_item:hover,{id} a.cke_path_item:focus,{id} a.cke_path_item:active [background-color:{darkBackground};] {id}.cke_panel [border-color:{defaultBorder};] "),panel:new CKEDITOR.template(".cke_panel_grouptitle [background-color:{lightBackground};border-color:{defaultBorder};] .cke_menubutton_icon [background-color:{menubuttonIcon};] .cke_menubutton:hover,.cke_menubutton:focus,.cke_menubutton:active [background-color:{menubuttonHover};] .cke_menubutton:hover .cke_menubutton_icon, .cke_menubutton:focus .cke_menubutton_icon, .cke_menubutton:active .cke_menubutton_icon [background-color:{menubuttonIconHover};] .cke_menubutton_disabled:hover .cke_menubutton_icon,.cke_menubutton_disabled:focus .cke_menubutton_icon,.cke_menubutton_disabled:active .cke_menubutton_icon [background-color:{menubuttonIcon};] .cke_menuseparator [background-color:{menubuttonIcon};] a:hover.cke_colorbox, a:active.cke_colorbox [border-color:{defaultBorder};] a:hover.cke_colorauto, a:hover.cke_colormore, a:active.cke_colorauto, a:active.cke_colormore [background-color:{ckeColorauto};border-color:{defaultBorder};] ")};return function(n,i){var r=e(n.uiColor,.4);return r={id:"."+n.id,defaultBorder:e(r,-.2),toolbarElementsBorder:e(r,-.25),defaultBackground:r,lightBackground:e(r,.8),darkBackground:e(r,-.15),ckeButtonOn:e(r,.4),ckeResizer:e(r,-.4),ckeColorauto:e(r,.8),dialogBody:e(r,.7),dialogTab:e(r,.65),dialogTabSelected:"#FFF",dialogTabSelectedBorder:"#FFF",elementsPathColor:e(r,-.6),menubuttonHover:e(r,.1),menubuttonIcon:e(r,.5),menubuttonIconHover:e(r,.3)},t[i].output(r).replace(/\[/g,"{").replace(/\]/g,"}")}}(),CKEDITOR.plugins.add("dialogui",{onLoad:function(){var e=function(e){this._||(this._={}),this._.default=this._.initValue=e.default||"",this._.required=e.required||!1;for(var t=[this._],n=1;n<arguments.length;n++)t.push(arguments[n]);return t.push(!0),CKEDITOR.tools.extend.apply(CKEDITOR.tools,t),this._},t={build:function(e,t,n){return new CKEDITOR.ui.dialog.textInput(e,t,n)}},n={build:function(e,t,n){return new CKEDITOR.ui.dialog[t.type](e,t,n)}},i={isChanged:function(){return this.getValue()!=this.getInitValue()},reset:function(e){this.setValue(this.getInitValue(),e)},setInitValue:function(){this._.initValue=this.getValue()},resetInitValue:function(){this._.initValue=this._.default},getInitValue:function(){return this._.initValue}},r=CKEDITOR.tools.extend({},CKEDITOR.ui.dialog.uiElement.prototype.eventProcessors,{onChange:function(e,t){this._.domOnChangeRegistered||(e.on("load",function(){this.getInputElement().on("change",function(){e.parts.dialog.isVisible()&&this.fire("change",{value:this.getValue()})},this)},this),this._.domOnChangeRegistered=!0),this.on("change",t)}},!0),a=/^on([A-Z]\w+)/,o=function(e){for(var t in e)(a.test(t)||"title"==t||"type"==t)&&delete e[t];return e},s=function(e){(e=e.data.getKeystroke())==CKEDITOR.SHIFT+CKEDITOR.ALT+36?this.setDirectionMarker("ltr"):e==CKEDITOR.SHIFT+CKEDITOR.ALT+35&&this.setDirectionMarker("rtl")};CKEDITOR.tools.extend(CKEDITOR.ui.dialog,{labeledElement:function(t,n,i,r){if(!(4>arguments.length)){var a=e.call(this,n);a.labelId=CKEDITOR.tools.getNextId()+"_label",this._.children=[];var o={role:n.role||"presentation"};n.includeLabel&&(o["aria-labelledby"]=a.labelId),CKEDITOR.ui.dialog.uiElement.call(this,t,n,i,"div",null,o,function(){var e=[],i=n.required?" cke_required":"";return"horizontal"!=n.labelLayout?e.push('<label class="cke_dialog_ui_labeled_label'+i+'" ',' id="'+a.labelId+'"',a.inputId?' for="'+a.inputId+'"':"",(n.labelStyle?' style="'+n.labelStyle+'"':"")+">",n.label,"</label>",'<div class="cke_dialog_ui_labeled_content"',n.controlStyle?' style="'+n.controlStyle+'"':"",' role="presentation">',r.call(this,t,n),"</div>"):(i={type:"hbox",widths:n.widths,padding:0,children:[{type:"html",html:'<label class="cke_dialog_ui_labeled_label'+i+'" id="'+a.labelId+'" for="'+a.inputId+'"'+(n.labelStyle?' style="'+n.labelStyle+'"':"")+">"+CKEDITOR.tools.htmlEncode(n.label)+"</label>"},{type:"html",html:'<span class="cke_dialog_ui_labeled_content"'+(n.controlStyle?' style="'+n.controlStyle+'"':"")+">"+r.call(this,t,n)+"</span>"}]},CKEDITOR.dialog._.uiElementBuilders.hbox.build(t,i,e)),e.join("")})}},textInput:function(t,n,i){if(!(3>arguments.length)){e.call(this,n);var r=this._.inputId=CKEDITOR.tools.getNextId()+"_textInput",a={class:"cke_dialog_ui_input_"+n.type,id:r,type:n.type};n.validate&&(this.validate=n.validate),n.maxLength&&(a.maxlength=n.maxLength),n.size&&(a.size=n.size),n.inputStyle&&(a.style=n.inputStyle);var o=this,l=!1;t.on("load",function(){o.getInputElement().on("keydown",function(e){13==e.data.getKeystroke()&&(l=!0)}),o.getInputElement().on("keyup",function(e){13==e.data.getKeystroke()&&l&&(t.getButton("ok")&&setTimeout(function(){t.getButton("ok").click()},0),l=!1),o.bidi&&s.call(o,e)},null,null,1e3)}),CKEDITOR.ui.dialog.labeledElement.call(this,t,n,i,function(){var e=['<div class="cke_dialog_ui_input_',n.type,'" role="presentation"'];for(var t in n.width&&e.push('style="width:'+n.width+'" '),e.push("><input "),a["aria-labelledby"]=this._.labelId,this._.required&&(a["aria-required"]=this._.required),a)e.push(t+'="'+a[t]+'" ');return e.push(" /></div>"),e.join("")})}},textarea:function(t,n,i){if(!(3>arguments.length)){e.call(this,n);var r=this,a=this._.inputId=CKEDITOR.tools.getNextId()+"_textarea",o={};n.validate&&(this.validate=n.validate),o.rows=n.rows||5,o.cols=n.cols||20,o.class="cke_dialog_ui_input_textarea "+(n.class||""),void 0!==n.inputStyle&&(o.style=n.inputStyle),n.dir&&(o.dir=n.dir),r.bidi&&t.on("load",function(){r.getInputElement().on("keyup",s)},r),CKEDITOR.ui.dialog.labeledElement.call(this,t,n,i,function(){o["aria-labelledby"]=this._.labelId,this._.required&&(o["aria-required"]=this._.required);var e,t=['<div class="cke_dialog_ui_input_textarea" role="presentation"><textarea id="',a,'" '];for(e in o)t.push(e+'="'+CKEDITOR.tools.htmlEncode(o[e])+'" ');return t.push(">",CKEDITOR.tools.htmlEncode(r._.default),"</textarea></div>"),t.join("")})}},checkbox:function(t,n,i){if(!(3>arguments.length)){var r=e.call(this,n,{default:!!n.default});n.validate&&(this.validate=n.validate),CKEDITOR.ui.dialog.uiElement.call(this,t,n,i,"span",null,null,function(){var e=CKEDITOR.tools.extend({},n,{id:n.id?n.id+"_checkbox":CKEDITOR.tools.getNextId()+"_checkbox"},!0),i=[],a=CKEDITOR.tools.getNextId()+"_label",s={class:"cke_dialog_ui_checkbox_input",type:"checkbox","aria-labelledby":a};return o(e),n.default&&(s.checked="checked"),void 0!==e.inputStyle&&(e.style=e.inputStyle),r.checkbox=new CKEDITOR.ui.dialog.uiElement(t,e,i,"input",null,s),i.push(' <label id="',a,'" for="',s.id,'"'+(n.labelStyle?' style="'+n.labelStyle+'"':"")+">",CKEDITOR.tools.htmlEncode(n.label),"</label>"),i.join("")})}},radio:function(t,n,i){if(!(3>arguments.length)){e.call(this,n),this._.default||(this._.default=this._.initValue=n.items[0][1]),n.validate&&(this.validate=n.validate);var r=[],a=this;n.role="radiogroup",n.includeLabel=!0,CKEDITOR.ui.dialog.labeledElement.call(this,t,n,i,function(){for(var e=[],i=[],s=(n.id?n.id:CKEDITOR.tools.getNextId())+"_radio",l=0;l<n.items.length;l++){var u=n.items[l],c=void 0!==u[2]?u[2]:u[0],d=void 0!==u[1]?u[1]:u[0],h=(p=CKEDITOR.tools.getNextId()+"_radio_input")+"_label",p=CKEDITOR.tools.extend({},n,{id:p,title:null,type:null},!0),f=(c=CKEDITOR.tools.extend({},p,{title:c},!0),{type:"radio",class:"cke_dialog_ui_radio_input",name:s,value:d,"aria-labelledby":h}),g=[];a._.default==d&&(f.checked="checked"),o(p),o(c),void 0!==p.inputStyle&&(p.style=p.inputStyle),p.keyboardFocusable=!0,r.push(new CKEDITOR.ui.dialog.uiElement(t,p,g,"input",null,f)),g.push(" "),new CKEDITOR.ui.dialog.uiElement(t,c,g,"label",null,{id:h,for:f.id},u[0]),e.push(g.join(""))}return new CKEDITOR.ui.dialog.hbox(t,r,e,i),i.join("")}),this._.children=r}},button:function(t,n,i){if(arguments.length){"function"==typeof n&&(n=n(t.getParentEditor())),e.call(this,n,{disabled:n.disabled||!1}),CKEDITOR.event.implementOn(this);var r=this;t.on("load",function(){var e=this.getElement();e.on("click",function(e){r.click(),e.data.preventDefault()}),e.on("keydown",function(e){e.data.getKeystroke()in{32:1}&&(r.click(),e.data.preventDefault())}),e.unselectable()},this);var a=CKEDITOR.tools.extend({},n);delete a.style;var o=CKEDITOR.tools.getNextId()+"_label";CKEDITOR.ui.dialog.uiElement.call(this,t,a,i,"a",null,{style:n.style,href:"javascript:void(0)",title:n.label,hidefocus:"true",class:n.class,role:"button","aria-labelledby":o},'<span id="'+o+'" class="cke_dialog_ui_button">'+CKEDITOR.tools.htmlEncode(n.label)+"</span>")}},select:function(t,n,i){if(!(3>arguments.length)){var r=e.call(this,n);n.validate&&(this.validate=n.validate),r.inputId=CKEDITOR.tools.getNextId()+"_select",CKEDITOR.ui.dialog.labeledElement.call(this,t,n,i,function(){var e=CKEDITOR.tools.extend({},n,{id:n.id?n.id+"_select":CKEDITOR.tools.getNextId()+"_select"},!0),i=[],a=[],s={id:r.inputId,class:"cke_dialog_ui_input_select","aria-labelledby":this._.labelId};i.push('<div class="cke_dialog_ui_input_',n.type,'" role="presentation"'),n.width&&i.push('style="width:'+n.width+'" '),i.push(">"),void 0!==n.size&&(s.size=n.size),void 0!==n.multiple&&(s.multiple=n.multiple),o(e);for(var l,u=0;u<n.items.length&&(l=n.items[u]);u++)a.push('<option value="',CKEDITOR.tools.htmlEncode(void 0!==l[1]?l[1]:l[0]).replace(/"/g,"&quot;"),'" /> ',CKEDITOR.tools.htmlEncode(l[0]));return void 0!==e.inputStyle&&(e.style=e.inputStyle),r.select=new CKEDITOR.ui.dialog.uiElement(t,e,i,"select",null,s,a.join("")),i.push("</div>"),i.join("")})}},file:function(t,n,i){if(!(3>arguments.length)){void 0===n.default&&(n.default="");var r=CKEDITOR.tools.extend(e.call(this,n),{definition:n,buttons:[]});n.validate&&(this.validate=n.validate),t.on("load",function(){CKEDITOR.document.getById(r.frameId).getParent().addClass("cke_dialog_ui_input_file")}),CKEDITOR.ui.dialog.labeledElement.call(this,t,n,i,function(){r.frameId=CKEDITOR.tools.getNextId()+"_fileInput";var e=['<iframe frameborder="0" allowtransparency="0" class="cke_dialog_ui_input_file" role="presentation" id="',r.frameId,'" title="',n.label,'" src="javascript:void('];return e.push(CKEDITOR.env.ie?"(function(){"+encodeURIComponent("document.open();("+CKEDITOR.tools.fixDomain+")();document.close();")+"})()":"0"),e.push(')"></iframe>'),e.join("")})}},fileButton:function(t,n,i){var r=this;if(!(3>arguments.length)){e.call(this,n),n.validate&&(this.validate=n.validate);var a=CKEDITOR.tools.extend({},n),o=a.onClick;a.className=(a.className?a.className+" ":"")+"cke_dialog_ui_button",a.onClick=function(e){var i=n.for;o&&!1===o.call(this,e)||(t.getContentElement(i[0],i[1]).submit(),this.disable())},t.on("load",function(){t.getContentElement(n.for[0],n.for[1])._.buttons.push(r)}),CKEDITOR.ui.dialog.button.call(this,t,a,i)}},html:function(){var e=/^\s*<[\w:]+\s+([^>]*)?>/,t=/^(\s*<[\w:]+(?:\s+[^>]*)?)((?:.|\r|\n)+)$/,n=/\/$/;return function(i,r,a){if(!(3>arguments.length)){var o=[],s=r.html;"<"!=s.charAt(0)&&(s="<span>"+s+"</span>");var l=r.focus;if(l){var u=this.focus;this.focus=function(){("function"==typeof l?l:u).call(this),this.fire("focus")},r.isFocusable&&(this.isFocusable=this.isFocusable),this.keyboardFocusable=!0}CKEDITOR.ui.dialog.uiElement.call(this,i,r,o,"span",null,null,""),o=o.join("").match(e),s=s.match(t)||["","",""],n.test(s[1])&&(s[1]=s[1].slice(0,-1),s[2]="/"+s[2]),a.push([s[1]," ",o[1]||"",s[2]].join(""))}}}(),fieldset:function(e,t,n,i,r){var a=r.label;this._={children:t},CKEDITOR.ui.dialog.uiElement.call(this,e,r,i,"fieldset",null,null,function(){var e=[];a&&e.push("<legend"+(r.labelStyle?' style="'+r.labelStyle+'"':"")+">"+a+"</legend>");for(var t=0;t<n.length;t++)e.push(n[t]);return e.join("")})}},!0),CKEDITOR.ui.dialog.html.prototype=new CKEDITOR.ui.dialog.uiElement,CKEDITOR.ui.dialog.labeledElement.prototype=CKEDITOR.tools.extend(new CKEDITOR.ui.dialog.uiElement,{setLabel:function(e){var t=CKEDITOR.document.getById(this._.labelId);return 1>t.getChildCount()?new CKEDITOR.dom.text(e,CKEDITOR.document).appendTo(t):t.getChild(0).$.nodeValue=e,this},getLabel:function(){var e=CKEDITOR.document.getById(this._.labelId);return!e||1>e.getChildCount()?"":e.getChild(0).getText()},eventProcessors:r},!0),CKEDITOR.ui.dialog.button.prototype=CKEDITOR.tools.extend(new CKEDITOR.ui.dialog.uiElement,{click:function(){return!this._.disabled&&this.fire("click",{dialog:this._.dialog})},enable:function(){this._.disabled=!1;var e=this.getElement();e&&e.removeClass("cke_disabled")},disable:function(){this._.disabled=!0,this.getElement().addClass("cke_disabled")},isVisible:function(){return this.getElement().getFirst().isVisible()},isEnabled:function(){return!this._.disabled},eventProcessors:CKEDITOR.tools.extend({},CKEDITOR.ui.dialog.uiElement.prototype.eventProcessors,{onClick:function(e,t){this.on("click",function(){t.apply(this,arguments)})}},!0),accessKeyUp:function(){this.click()},accessKeyDown:function(){this.focus()},keyboardFocusable:!0},!0),CKEDITOR.ui.dialog.textInput.prototype=CKEDITOR.tools.extend(new CKEDITOR.ui.dialog.labeledElement,{getInputElement:function(){return CKEDITOR.document.getById(this._.inputId)},focus:function(){var e=this.selectParentTab();setTimeout(function(){var t=e.getInputElement();t&&t.$.focus()},0)},select:function(){var e=this.selectParentTab();setTimeout(function(){var t=e.getInputElement();t&&(t.$.focus(),t.$.select())},0)},accessKeyUp:function(){this.select()},setValue:function(e){if(this.bidi){var t=e&&e.charAt(0);(t="‪"==t?"ltr":"‫"==t?"rtl":null)&&(e=e.slice(1)),this.setDirectionMarker(t)}return e||(e=""),CKEDITOR.ui.dialog.uiElement.prototype.setValue.apply(this,arguments)},getValue:function(){var e=CKEDITOR.ui.dialog.uiElement.prototype.getValue.call(this);if(this.bidi&&e){var t=this.getDirectionMarker();t&&(e=("ltr"==t?"‪":"‫")+e)}return e},setDirectionMarker:function(e){var t=this.getInputElement();e?t.setAttributes({dir:e,"data-cke-dir-marker":e}):this.getDirectionMarker()&&t.removeAttributes(["dir","data-cke-dir-marker"])},getDirectionMarker:function(){return this.getInputElement().data("cke-dir-marker")},keyboardFocusable:!0},i,!0),CKEDITOR.ui.dialog.textarea.prototype=new CKEDITOR.ui.dialog.textInput,CKEDITOR.ui.dialog.select.prototype=CKEDITOR.tools.extend(new CKEDITOR.ui.dialog.labeledElement,{getInputElement:function(){return this._.select.getElement()},add:function(e,t,n){var i=new CKEDITOR.dom.element("option",this.getDialog().getParentEditor().document),r=this.getInputElement().$;return i.$.text=e,i.$.value=void 0===t||null===t?e:t,void 0===n||null===n?CKEDITOR.env.ie?r.add(i.$):r.add(i.$,null):r.add(i.$,n),this},remove:function(e){return this.getInputElement().$.remove(e),this},clear:function(){for(var e=this.getInputElement().$;0<e.length;)e.remove(0);return this},keyboardFocusable:!0},i,!0),CKEDITOR.ui.dialog.checkbox.prototype=CKEDITOR.tools.extend(new CKEDITOR.ui.dialog.uiElement,{getInputElement:function(){return this._.checkbox.getElement()},setValue:function(e,t){this.getInputElement().$.checked=e,!t&&this.fire("change",{value:e})},getValue:function(){return this.getInputElement().$.checked},accessKeyUp:function(){this.setValue(!this.getValue())},eventProcessors:{onChange:function(e,t){return!CKEDITOR.env.ie||8<CKEDITOR.env.version?r.onChange.apply(this,arguments):(e.on("load",function(){var e=this._.checkbox.getElement();e.on("propertychange",function(t){"checked"==(t=t.data.$).propertyName&&this.fire("change",{value:e.$.checked})},this)},this),this.on("change",t),null)}},keyboardFocusable:!0},i,!0),CKEDITOR.ui.dialog.radio.prototype=CKEDITOR.tools.extend(new CKEDITOR.ui.dialog.uiElement,{setValue:function(e,t){for(var n,i=this._.children,r=0;r<i.length&&(n=i[r]);r++)n.getElement().$.checked=n.getValue()==e;!t&&this.fire("change",{value:e})},getValue:function(){for(var e=this._.children,t=0;t<e.length;t++)if(e[t].getElement().$.checked)return e[t].getValue();return null},accessKeyUp:function(){var e,t=this._.children;for(e=0;e<t.length;e++)if(t[e].getElement().$.checked)return void t[e].getElement().focus();t[0].getElement().focus()},eventProcessors:{onChange:function(e,t){return!CKEDITOR.env.ie||8<CKEDITOR.env.version?r.onChange.apply(this,arguments):(e.on("load",function(){for(var e=this._.children,t=this,n=0;n<e.length;n++)e[n].getElement().on("propertychange",function(e){"checked"==(e=e.data.$).propertyName&&this.$.checked&&t.fire("change",{value:this.getAttribute("value")})})},this),this.on("change",t),null)}}},i,!0),CKEDITOR.ui.dialog.file.prototype=CKEDITOR.tools.extend(new CKEDITOR.ui.dialog.labeledElement,i,{getInputElement:function(){var e=CKEDITOR.document.getById(this._.frameId).getFrameDocument();return 0<e.$.forms.length?new CKEDITOR.dom.element(e.$.forms[0].elements[0]):this.getElement()},submit:function(){return this.getInputElement().getParent().$.submit(),this},getAction:function(){return this.getInputElement().getParent().$.action},registerEvents:function(e){var t,n,i=/^on([A-Z]\w+)/,r=function(e,t,n,i){e.on("formLoaded",function(){e.getInputElement().on(n,i,e)})};for(n in e)(t=n.match(i))&&(this.eventProcessors[n]?this.eventProcessors[n].call(this,this._.dialog,e[n]):r(this,this._.dialog,t[1].toLowerCase(),e[n]));return this},reset:function(){function e(){n.$.open();var e="";i.size&&(e=i.size-(CKEDITOR.env.ie?7:0));var u=t.frameId+"_input";for(n.$.write(['<html dir="'+s+'" lang="'+l+'"><head><title></title></head><body style="margin: 0; overflow: hidden; background: transparent;">','<form enctype="multipart/form-data" method="POST" dir="'+s+'" lang="'+l+'" action="',CKEDITOR.tools.htmlEncode(i.action),'"><label id="',t.labelId,'" for="',u,'" style="display:none">',CKEDITOR.tools.htmlEncode(i.label),'</label><input style="width:100%" id="',u,'" aria-labelledby="',t.labelId,'" type="file" name="',CKEDITOR.tools.htmlEncode(i.id||"cke_upload"),'" size="',CKEDITOR.tools.htmlEncode(0<e?e:""),'" /></form></body></html><script>',CKEDITOR.env.ie?"("+CKEDITOR.tools.fixDomain+")();":"","window.parent.CKEDITOR.tools.callFunction("+a+");","window.onbeforeunload = function() {window.parent.CKEDITOR.tools.callFunction("+o+")}","<\/script>"].join("")),n.$.close(),e=0;e<r.length;e++)r[e].enable()}var t=this._,n=CKEDITOR.document.getById(t.frameId).getFrameDocument(),i=t.definition,r=t.buttons,a=this.formLoadedNumber,o=this.formUnloadNumber,s=t.dialog._.editor.lang.dir,l=t.dialog._.editor.langCode;a||(a=this.formLoadedNumber=CKEDITOR.tools.addFunction(function(){this.fire("formLoaded")},this),o=this.formUnloadNumber=CKEDITOR.tools.addFunction(function(){this.getInputElement().clearCustomData()},this),this.getDialog()._.editor.on("destroy",function(){CKEDITOR.tools.removeFunction(a),CKEDITOR.tools.removeFunction(o)})),CKEDITOR.env.gecko?setTimeout(e,500):e()},getValue:function(){return this.getInputElement().$.value||""},setInitValue:function(){this._.initValue=""},eventProcessors:{onChange:function(e,t){this._.domOnChangeRegistered||(this.on("formLoaded",function(){this.getInputElement().on("change",function(){this.fire("change",{value:this.getValue()})},this)},this),this._.domOnChangeRegistered=!0),this.on("change",t)}},keyboardFocusable:!0},!0),CKEDITOR.ui.dialog.fileButton.prototype=new CKEDITOR.ui.dialog.button,CKEDITOR.ui.dialog.fieldset.prototype=CKEDITOR.tools.clone(CKEDITOR.ui.dialog.hbox.prototype),CKEDITOR.dialog.addUIElement("text",t),CKEDITOR.dialog.addUIElement("password",t),CKEDITOR.dialog.addUIElement("textarea",n),CKEDITOR.dialog.addUIElement("checkbox",n),CKEDITOR.dialog.addUIElement("radio",n),CKEDITOR.dialog.addUIElement("button",n),CKEDITOR.dialog.addUIElement("select",n),CKEDITOR.dialog.addUIElement("file",n),CKEDITOR.dialog.addUIElement("fileButton",n),CKEDITOR.dialog.addUIElement("html",n),CKEDITOR.dialog.addUIElement("fieldset",{build:function(e,t,n){for(var i,r=t.children,a=[],o=[],s=0;s<r.length&&(i=r[s]);s++){var l=[];a.push(l),o.push(CKEDITOR.dialog._.uiElementBuilders[i.type].build(e,i,l))}return new CKEDITOR.ui.dialog[t.type](e,o,a,n,t)}})}}),CKEDITOR.DIALOG_RESIZE_NONE=0,CKEDITOR.DIALOG_RESIZE_WIDTH=1,CKEDITOR.DIALOG_RESIZE_HEIGHT=2,CKEDITOR.DIALOG_RESIZE_BOTH=3,CKEDITOR.DIALOG_STATE_IDLE=1,CKEDITOR.DIALOG_STATE_BUSY=2,function(){function e(){for(var e=this._.tabIdList.length,t=CKEDITOR.tools.indexOf(this._.tabIdList,this._.currentTabId)+e,n=t-1;n>t-e;n--)if(this._.tabs[this._.tabIdList[n%e]][0].$.offsetHeight)return this._.tabIdList[n%e];return null}function t(e,t){for(var n=e.$.getElementsByTagName("input"),i=0,r=n.length;i<r;i++){var a=new CKEDITOR.dom.element(n[i]);"text"==a.getAttribute("type").toLowerCase()&&(t?(a.setAttribute("value",a.getCustomData("fake_value")||""),a.removeCustomData("fake_value")):(a.setCustomData("fake_value",a.getAttribute("value")),a.setAttribute("value","")))}}function n(e){var t=CKEDITOR.dom.element.createFromHtml(CKEDITOR.addTemplate("dialog",d).output({id:CKEDITOR.tools.getNextNumber(),editorId:e.id,langDir:e.lang.dir,langCode:e.langCode,editorDialogClass:"cke_editor_"+e.name.replace(/\./g,"\\.")+"_dialog",closeTitle:e.lang.common.close,hidpi:CKEDITOR.env.hidpi?"cke_hidpi":""})),n=t.getChild([0,0,0,0,0]),i=n.getChild(0),r=n.getChild(1);return e.plugins.clipboard&&CKEDITOR.plugins.clipboard.preventDefaultDropOnElement(n),!CKEDITOR.env.ie||CKEDITOR.env.quirks||CKEDITOR.env.edge||(e="javascript:void(function(){"+encodeURIComponent("document.open();("+CKEDITOR.tools.fixDomain+")();document.close();")+"}())",CKEDITOR.dom.element.createFromHtml('<iframe frameBorder="0" class="cke_iframe_shim" src="'+e+'" tabIndex="-1"></iframe>').appendTo(n.getParent())),i.unselectable(),r.unselectable(),{element:t,parts:{dialog:t.getChild(0),title:i,close:r,tabs:n.getChild(2),contents:n.getChild([3,0,0,0]),footer:n.getChild([3,0,1,0])}}}function i(e,t,n){this.element=t,this.focusIndex=n,this.tabIndex=0,this.isFocusable=function(){return!t.getAttribute("disabled")&&t.isVisible()},this.focus=function(){e._.currentFocusIndex=this.focusIndex,this.element.focus()},t.on("keydown",function(e){e.data.getKeystroke()in{32:1,13:1}&&this.fire("click")}),t.on("focus",function(){this.fire("mouseover")}),t.on("blur",function(){this.fire("mouseout")})}function r(e,t){this._={dialog:e},CKEDITOR.tools.extend(this,t)}function a(e){function t(t){var n=e.getSize(),l=CKEDITOR.document.getWindow().getViewPaneSize(),u=t.data.$.screenX,c=t.data.$.screenY,d=u-i.x,h=c-i.y;i={x:u,y:c},r.x+=d,r.y+=h,e.move(r.x+s[3]<o?-s[3]:r.x-s[1]>l.width-n.width-o?l.width-n.width+("rtl"==a.lang.dir?0:s[1]):r.x,r.y+s[0]<o?-s[0]:r.y-s[2]>l.height-n.height-o?l.height-n.height+s[2]:r.y,1),t.data.preventDefault()}function n(){if(CKEDITOR.document.removeListener("mousemove",t),CKEDITOR.document.removeListener("mouseup",n),CKEDITOR.env.ie6Compat){var e=y.getChild(0).getFrameDocument();e.removeListener("mousemove",t),e.removeListener("mouseup",n)}}var i=null,r=null,a=e.getParentEditor(),o=a.config.dialog_magnetDistance,s=CKEDITOR.skin.margins||[0,0,0,0];void 0===o&&(o=20),e.parts.title.on("mousedown",function(a){if(i={x:a.data.$.screenX,y:a.data.$.screenY},CKEDITOR.document.on("mousemove",t),CKEDITOR.document.on("mouseup",n),r=e.getPosition(),CKEDITOR.env.ie6Compat){var o=y.getChild(0).getFrameDocument();o.on("mousemove",t),o.on("mouseup",n)}a.data.preventDefault()},e)}function o(e){function t(t){var n="rtl"==d.lang.dir,c=u.width,h=u.height,p=c+(t.data.$.screenX-l.x)*(n?-1:1)*(e._.moved?1:2),f=h+(t.data.$.screenY-l.y)*(e._.moved?1:2),g=e._.element.getFirst(),m=(g=n&&g.getComputedStyle("right"),e.getPosition());m.y+f>s.height&&(f=s.height-m.y),(n?g:m.x)+p>s.width&&(p=s.width-(n?g:m.x)),r!=CKEDITOR.DIALOG_RESIZE_WIDTH&&r!=CKEDITOR.DIALOG_RESIZE_BOTH||(c=Math.max(i.minWidth||0,p-a)),r!=CKEDITOR.DIALOG_RESIZE_HEIGHT&&r!=CKEDITOR.DIALOG_RESIZE_BOTH||(h=Math.max(i.minHeight||0,f-o)),e.resize(c,h),e._.moved||e.layout(),t.data.preventDefault()}function n(){if(CKEDITOR.document.removeListener("mouseup",n),CKEDITOR.document.removeListener("mousemove",t),c&&(c.remove(),c=null),CKEDITOR.env.ie6Compat){var e=y.getChild(0).getFrameDocument();e.removeListener("mouseup",n),e.removeListener("mousemove",t)}}var i=e.definition,r=i.resizable;if(r!=CKEDITOR.DIALOG_RESIZE_NONE){var a,o,s,l,u,c,d=e.getParentEditor(),h=CKEDITOR.tools.addFunction(function(i){u=e.getSize();var r=e.parts.contents;r.$.getElementsByTagName("iframe").length&&(c=CKEDITOR.dom.element.createFromHtml('<div class="cke_dialog_resize_cover" style="height: 100%; position: absolute; width: 100%;"></div>'),r.append(c)),o=u.height-e.parts.contents.getSize("height",!(CKEDITOR.env.gecko||CKEDITOR.env.ie&&CKEDITOR.env.quirks)),a=u.width-e.parts.contents.getSize("width",1),l={x:i.screenX,y:i.screenY},s=CKEDITOR.document.getWindow().getViewPaneSize(),CKEDITOR.document.on("mousemove",t),CKEDITOR.document.on("mouseup",n),CKEDITOR.env.ie6Compat&&((r=y.getChild(0).getFrameDocument()).on("mousemove",t),r.on("mouseup",n)),i.preventDefault&&i.preventDefault()});e.on("load",function(){var t="";r==CKEDITOR.DIALOG_RESIZE_WIDTH?t=" cke_resizer_horizontal":r==CKEDITOR.DIALOG_RESIZE_HEIGHT&&(t=" cke_resizer_vertical"),t=CKEDITOR.dom.element.createFromHtml('<div class="cke_resizer'+t+" cke_resizer_"+d.lang.dir+'" title="'+CKEDITOR.tools.htmlEncode(d.lang.common.resize)+'" onmousedown="CKEDITOR.tools.callFunction('+h+', event )">'+("ltr"==d.lang.dir?"◢":"◣")+"</div>"),e.parts.footer.append(t,1)}),d.on("destroy",function(){CKEDITOR.tools.removeFunction(h)})}}function s(e){e.data.preventDefault(1)}function l(e){var t=CKEDITOR.document.getWindow(),n=e.config,i=CKEDITOR.skinName||e.config.skin,r=n.dialog_backgroundCoverColor||("moono-lisa"==i?"black":"white"),a=(i=n.dialog_backgroundCoverOpacity,n.baseFloatZIndex),o=(n=CKEDITOR.tools.genKey(r,i,a),b[n]);o?o.show():(a=['<div tabIndex="-1" style="position: ',CKEDITOR.env.ie6Compat?"absolute":"fixed","; z-index: ",a,"; top: 0px; left: 0px; ",CKEDITOR.env.ie6Compat?"":"background-color: "+r,'" class="cke_dialog_background_cover">'],CKEDITOR.env.ie6Compat&&(r="<html><body style=\\'background-color:"+r+";\\'></body></html>",a.push('<iframe hidefocus="true" frameborder="0" id="cke_dialog_background_iframe" src="javascript:'),a.push("void((function(){"+encodeURIComponent("document.open();("+CKEDITOR.tools.fixDomain+")();document.write( '"+r+"' );document.close();")+"})())"),a.push('" style="position:absolute;left:0;top:0;width:100%;height: 100%;filter: progid:DXImageTransform.Microsoft.Alpha(opacity=0)"></iframe>')),a.push("</div>"),(o=CKEDITOR.dom.element.createFromHtml(a.join(""))).setOpacity(void 0!==i?i:.5),o.on("keydown",s),o.on("keypress",s),o.on("keyup",s),o.appendTo(CKEDITOR.document.getBody()),b[n]=o),e.focusManager.add(o),y=o;var l=function(){var e=t.getScrollPosition(),n=CKEDITOR.dialog._.currentTop;if(o.setStyles({left:e.x+"px",top:e.y+"px"}),n)do{e=n.getPosition(),n.move(e.x,e.y)}while(n=n._.parentDialog)};if(v=e=function(){var e=t.getViewPaneSize();o.setStyles({width:e.width+"px",height:e.height+"px"})},t.on("resize",e),e(),CKEDITOR.env.mac&&CKEDITOR.env.webkit||o.focus(),CKEDITOR.env.ie6Compat){var u=function(){l(),arguments.callee.prevScrollHandler.apply(this,arguments)};t.$.setTimeout(function(){u.prevScrollHandler=window.onscroll||function(){},window.onscroll=u},0),l()}}function u(e){y&&(e.focusManager.remove(y),e=CKEDITOR.document.getWindow(),y.hide(),e.removeListener("resize",v),CKEDITOR.env.ie6Compat&&e.$.setTimeout(function(){window.onscroll=window.onscroll&&window.onscroll.prevScrollHandler||null},0),v=null)}var c=CKEDITOR.tools.cssLength,d='<div class="cke_reset_all {editorId} {editorDialogClass} {hidpi}" dir="{langDir}" lang="{langCode}" role="dialog" aria-labelledby="cke_dialog_title_{id}"><table class="cke_dialog '+CKEDITOR.env.cssClass+' cke_{langDir}" style="position:absolute" role="presentation"><tr><td role="presentation"><div class="cke_dialog_body" role="presentation"><div id="cke_dialog_title_{id}" class="cke_dialog_title" role="presentation"></div><a id="cke_dialog_close_button_{id}" class="cke_dialog_close_button" href="javascript:void(0)" title="{closeTitle}" role="button"><span class="cke_label">X</span></a><div id="cke_dialog_tabs_{id}" class="cke_dialog_tabs" role="tablist"></div><table class="cke_dialog_contents" role="presentation"><tr><td id="cke_dialog_contents_{id}" class="cke_dialog_contents_body" role="presentation"></td></tr><tr><td id="cke_dialog_footer_{id}" class="cke_dialog_footer" role="presentation"></td></tr></table></div></td></tr></table></div>';CKEDITOR.dialog=function(t,i){function r(e){var t=b._.focusList;if(e=e||0,!(1>t.length)){var n=b._.currentFocusIndex;b._.tabBarMode&&0>e&&(n=0);try{t[n].getInputElement().$.blur()}catch(e){}var i=n,r=1<b._.pageCount;do{if(i+=e,r&&!b._.tabBarMode&&(i==t.length||-1==i))return b._.tabBarMode=!0,b._.tabs[b._.currentTabId][0].focus(),void(b._.currentFocusIndex=-1);if((i=(i+t.length)%t.length)==n)break}while(e&&!t[i].isFocusable());t[i].focus(),"text"==t[i].type&&t[i].select()}}function s(n){if(b==CKEDITOR.dialog._.currentTop){var i=n.data.getKeystroke(),a="rtl"==t.lang.dir;if(u=c=0,9==i||i==CKEDITOR.SHIFT+9)r(i==CKEDITOR.SHIFT+9?-1:1),u=1;else if(i==CKEDITOR.ALT+121&&!b._.tabBarMode&&1<b.getPageCount())b._.tabBarMode=!0,b._.tabs[b._.currentTabId][0].focus(),b._.currentFocusIndex=-1,u=1;else if(-1!=CKEDITOR.tools.indexOf([37,38,39,40],i)&&b._.tabBarMode)i=-1!=CKEDITOR.tools.indexOf([a?39:37,38],i)?e.call(b):function(){for(var e=this._.tabIdList.length,t=CKEDITOR.tools.indexOf(this._.tabIdList,this._.currentTabId),n=t+1;n<t+e;n++)if(this._.tabs[this._.tabIdList[n%e]][0].$.offsetHeight)return this._.tabIdList[n%e];return null}.call(b),b.selectPage(i),b._.tabs[i][0].focus(),u=1;else if(13!=i&&32!=i||!b._.tabBarMode)if(13==i)(i=n.data.getTarget()).is("a","button","select","textarea")||i.is("input")&&"button"==i.$.type||((i=this.getButton("ok"))&&CKEDITOR.tools.setTimeout(i.click,0,i),u=1),c=1;else{if(27!=i)return;(i=this.getButton("cancel"))?CKEDITOR.tools.setTimeout(i.click,0,i):!1!==this.fire("cancel",{hide:!0}).hide&&this.hide(),c=1}else this.selectPage(this._.currentTabId),this._.tabBarMode=!1,this._.currentFocusIndex=-1,r(1),u=1;l(n)}}function l(e){u?e.data.preventDefault(1):c&&e.data.stopPropagation()}var u,c,d=CKEDITOR.dialog._.dialogDefinitions[i],p=CKEDITOR.tools.clone(h),f=t.config.dialog_buttonsOrder||"OS",g=t.lang.dir,v={};if(("OS"==f&&CKEDITOR.env.mac||"rtl"==f&&"ltr"==g||"ltr"==f&&"rtl"==g)&&p.buttons.reverse(),d=CKEDITOR.tools.extend(d(t),p),d=CKEDITOR.tools.clone(d),d=new m(this,d),p=n(t),this._={editor:t,element:p.element,name:i,contentSize:{width:0,height:0},size:{width:0,height:0},contents:{},buttons:{},accessKeyMap:{},tabs:{},tabIdList:[],currentTabId:null,currentTabIndex:null,pageCount:0,lastTab:null,tabBarMode:!1,focusList:[],currentFocusIndex:0,hasFocus:!1},this.parts=p.parts,CKEDITOR.tools.setTimeout(function(){t.fire("ariaWidget",this.parts.contents)},0,this),(p={position:CKEDITOR.env.ie6Compat?"absolute":"fixed",top:0,visibility:"hidden"})["rtl"==g?"right":"left"]=0,this.parts.dialog.setStyles(p),CKEDITOR.event.call(this),this.definition=d=CKEDITOR.fire("dialogDefinition",{name:i,definition:d},t).definition,!("removeDialogTabs"in t._)&&t.config.removeDialogTabs){for(p=t.config.removeDialogTabs.split(";"),g=0;g<p.length;g++)if(2==(f=p[g].split(":")).length){var y=f[0];v[y]||(v[y]=[]),v[y].push(f[1])}t._.removeDialogTabs=v}if(t._.removeDialogTabs&&(v=t._.removeDialogTabs[i]))for(g=0;g<v.length;g++)d.removeContents(v[g]);d.onLoad&&this.on("load",d.onLoad),d.onShow&&this.on("show",d.onShow),d.onHide&&this.on("hide",d.onHide),d.onOk&&this.on("ok",function(e){t.fire("saveSnapshot"),setTimeout(function(){t.fire("saveSnapshot")},0),!1===d.onOk.call(this,e)&&(e.data.hide=!1)}),this.state=CKEDITOR.DIALOG_STATE_IDLE,d.onCancel&&this.on("cancel",function(e){!1===d.onCancel.call(this,e)&&(e.data.hide=!1)});var b=this,_=function(e){var t,n=b._.contents;for(t in n)for(var i in n[t])if(e.call(this,n[t][i]))return};this.on("ok",function(e){_(function(t){if(t.validate){var n=t.validate(this),i="string"==typeof n||!1===n;return i&&(e.data.hide=!1,e.stop()),function(e,t){var n=this.getInputElement();n&&(e?n.removeAttribute("aria-invalid"):n.setAttribute("aria-invalid",!0)),e||(this.select?this.select():this.focus()),t&&alert(t),this.fire("validated",{valid:e,msg:t})}.call(t,!i,"string"==typeof n?n:void 0),i}})},this,null,0),this.on("cancel",function(e){_(function(n){if(n.isChanged())return t.config.dialog_noConfirmCancel||confirm(t.lang.common.confirmCancel)||(e.data.hide=!1),!0})},this,null,0),this.parts.close.on("click",function(e){!1!==this.fire("cancel",{hide:!0}).hide&&this.hide(),e.data.preventDefault()},this),this.changeFocus=r;var T=this._.element;for(t.focusManager.add(T,1),this.on("show",function(){T.on("keydown",s,this),CKEDITOR.env.gecko&&T.on("keypress",l,this)}),this.on("hide",function(){T.removeListener("keydown",s),CKEDITOR.env.gecko&&T.removeListener("keypress",l),_(function(e){(function(){var e=this.getInputElement();e&&e.removeAttribute("aria-invalid")}).apply(e)})}),this.on("iframeAdded",function(e){new CKEDITOR.dom.document(e.data.iframe.$.contentWindow.document).on("keydown",s,this,null,0)}),this.on("show",function(){!function(){var e=b._.focusList;e.sort(function(e,t){return e.tabIndex!=t.tabIndex?t.tabIndex-e.tabIndex:e.focusIndex-t.focusIndex});for(var t=e.length,n=0;n<t;n++)e[n].focusIndex=n}();var e=1<b._.pageCount;t.config.dialog_startupFocusTab&&e?(b._.tabBarMode=!0,b._.tabs[b._.currentTabId][0].focus(),b._.currentFocusIndex=-1):this._.hasFocus||(this._.currentFocusIndex=e?-1:this._.focusList.length-1,d.onFocus?(e=d.onFocus.call(this))&&e.focus():r(1))},this,null,4294967295),CKEDITOR.env.ie6Compat&&this.on("load",function(){var e=this.getElement(),t=e.getFirst();t.remove(),t.appendTo(e)},this),a(this),o(this),new CKEDITOR.dom.text(d.title,CKEDITOR.document).appendTo(this.parts.title),g=0;g<d.contents.length;g++)(v=d.contents[g])&&this.addPage(v);for(this.parts.tabs.on("click",function(e){var t=e.data.getTarget();t.hasClass("cke_dialog_tab")&&(t=t.$.id,this.selectPage(t.substring(4,t.lastIndexOf("_"))),this._.tabBarMode&&(this._.tabBarMode=!1,this._.currentFocusIndex=-1,r(1)),e.data.preventDefault())},this),g=[],v=CKEDITOR.dialog._.uiElementBuilders.hbox.build(this,{type:"hbox",className:"cke_dialog_footer_buttons",widths:[],children:d.buttons},g).getChild(),this.parts.footer.setHtml(g.join("")),g=0;g<v.length;g++)this._.buttons[v[g].id]=v[g]},CKEDITOR.dialog.prototype={destroy:function(){this.hide(),this._.element.remove()},resize:function(e,t){this._.contentSize&&this._.contentSize.width==e&&this._.contentSize.height==t||(CKEDITOR.dialog.fire("resize",{dialog:this,width:e,height:t},this._.editor),this.fire("resize",{width:e,height:t},this._.editor),this.parts.contents.setStyles({width:e+"px",height:t+"px"}),"rtl"==this._.editor.lang.dir&&this._.position&&(this._.position.x=CKEDITOR.document.getWindow().getViewPaneSize().width-this._.contentSize.width-parseInt(this._.element.getFirst().getStyle("right"),10)),this._.contentSize={width:e,height:t})},getSize:function(){var e=this._.element.getFirst();return{width:e.$.offsetWidth||0,height:e.$.offsetHeight||0}},move:function(e,t,n){var i=this._.element.getFirst(),r="rtl"==this._.editor.lang.dir,a="fixed"==i.getComputedStyle("position");CKEDITOR.env.ie&&i.setStyle("zoom","100%"),a&&this._.position&&this._.position.x==e&&this._.position.y==t||(this._.position={x:e,y:t},a||(e+=(a=CKEDITOR.document.getWindow().getScrollPosition()).x,t+=a.y),r&&(a=this.getSize(),e=CKEDITOR.document.getWindow().getViewPaneSize().width-a.width-e),(t={top:(0<t?t:0)+"px"})[r?"right":"left"]=(0<e?e:0)+"px",i.setStyles(t),n&&(this._.moved=1))},getPosition:function(){return CKEDITOR.tools.extend({},this._.position)},show:function(){var e=this._.element,t=this.definition;for(var n in e.getParent()&&e.getParent().equals(CKEDITOR.document.getBody())?e.setStyle("display","block"):e.appendTo(CKEDITOR.document.getBody()),this.resize(this._.contentSize&&this._.contentSize.width||t.width||t.minWidth,this._.contentSize&&this._.contentSize.height||t.height||t.minHeight),this.reset(),this.selectPage(this.definition.contents[0].id),null===CKEDITOR.dialog._.currentZIndex&&(CKEDITOR.dialog._.currentZIndex=this._.editor.config.baseFloatZIndex),this._.element.getFirst().setStyle("z-index",CKEDITOR.dialog._.currentZIndex+=10),null===CKEDITOR.dialog._.currentTop?(CKEDITOR.dialog._.currentTop=this,this._.parentDialog=null,l(this._.editor)):(this._.parentDialog=CKEDITOR.dialog._.currentTop,this._.parentDialog.getElement().getFirst().$.style.zIndex-=Math.floor(this._.editor.config.baseFloatZIndex/2),CKEDITOR.dialog._.currentTop=this),e.on("keydown",T),e.on("keyup",E),this._.hasFocus=!1,t.contents)if(t.contents[n]){e=t.contents[n];var i=this._.tabs[e.id],r=e.requiredContent,a=0;if(i){for(var o in this._.contents[e.id]){var s=this._.contents[e.id][o];"hbox"!=s.type&&"vbox"!=s.type&&s.getInputElement()&&(s.requiredContent&&!this._.editor.activeFilter.check(s.requiredContent)?s.disable():(s.enable(),a++))}!a||r&&!this._.editor.activeFilter.check(r)?i[0].addClass("cke_dialog_tab_disabled"):i[0].removeClass("cke_dialog_tab_disabled")}}CKEDITOR.tools.setTimeout(function(){this.layout(),function(e){function t(){e.layout()}var n=CKEDITOR.document.getWindow();n.on("resize",t),e.on("hide",function(){n.removeListener("resize",t)})}(this),this.parts.dialog.setStyle("visibility",""),this.fireOnce("load",{}),CKEDITOR.ui.fire("ready",this),this.fire("show",{}),this._.editor.fire("dialogShow",this),this._.parentDialog||this._.editor.focusManager.lock(),this.foreach(function(e){e.setInitValue&&e.setInitValue()})},100,this)},layout:function(){var e=this.parts.dialog,t=this.getSize(),n=CKEDITOR.document.getWindow().getViewPaneSize(),i=(n.width-t.width)/2,r=(n.height-t.height)/2;CKEDITOR.env.ie6Compat||(t.height+(0<r?r:0)>n.height||t.width+(0<i?i:0)>n.width?e.setStyle("position","absolute"):e.setStyle("position","fixed")),this.move(this._.moved?this._.position.x:i,this._.moved?this._.position.y:r)},foreach:function(e){for(var t in this._.contents)for(var n in this._.contents[t])e.call(this,this._.contents[t][n]);return this},reset:function(){var e=function(e){e.reset&&e.reset(1)};return function(){return this.foreach(e),this}}(),setupContent:function(){var e=arguments;this.foreach(function(t){t.setup&&t.setup.apply(t,e)})},commitContent:function(){var e=arguments;this.foreach(function(t){CKEDITOR.env.ie&&this._.currentFocusIndex==t.focusIndex&&t.getInputElement().$.blur(),t.commit&&t.commit.apply(t,e)})},hide:function(){if(this.parts.dialog.isVisible()){this.fire("hide",{}),this._.editor.fire("dialogHide",this),this.selectPage(this._.tabIdList[0]);var e=this._.element;for(e.setStyle("display","none"),this.parts.dialog.setStyle("visibility","hidden"),w(this);CKEDITOR.dialog._.currentTop!=this;)CKEDITOR.dialog._.currentTop.hide();if(this._.parentDialog){var t=this._.parentDialog.getElement().getFirst();t.setStyle("z-index",parseInt(t.$.style.zIndex,10)+Math.floor(this._.editor.config.baseFloatZIndex/2))}else u(this._.editor);if(CKEDITOR.dialog._.currentTop=this._.parentDialog)CKEDITOR.dialog._.currentZIndex-=10;else{CKEDITOR.dialog._.currentZIndex=null,e.removeListener("keydown",T),e.removeListener("keyup",E);var n=this._.editor;n.focus(),setTimeout(function(){n.focusManager.unlock(),CKEDITOR.env.iOS&&n.window.focus()},0)}delete this._.parentDialog,this.foreach(function(e){e.resetInitValue&&e.resetInitValue()}),this.setState(CKEDITOR.DIALOG_STATE_IDLE)}},addPage:function(e){if(!e.requiredContent||this._.editor.filter.check(e.requiredContent)){for(var t=[],n=e.label?' title="'+CKEDITOR.tools.htmlEncode(e.label)+'"':"",i=CKEDITOR.dialog._.uiElementBuilders.vbox.build(this,{type:"vbox",className:"cke_dialog_page_contents",children:e.elements,expand:!!e.expand,padding:e.padding,style:e.style||"width: 100%;"},t),r=this._.contents[e.id]={},a=i.getChild(),o=0;i=a.shift();)i.notAllowed||"hbox"==i.type||"vbox"==i.type||o++,r[i.id]=i,"function"==typeof i.getChild&&a.push.apply(a,i.getChild());o||(e.hidden=!0),(t=CKEDITOR.dom.element.createFromHtml(t.join(""))).setAttribute("role","tabpanel"),i=CKEDITOR.env,r="cke_"+e.id+"_"+CKEDITOR.tools.getNextNumber(),n=CKEDITOR.dom.element.createFromHtml(['<a class="cke_dialog_tab"',0<this._.pageCount?" cke_last":"cke_first",n,e.hidden?' style="display:none"':"",' id="',r,'"',i.gecko&&!i.hc?"":' href="javascript:void(0)"',' tabIndex="-1" hidefocus="true" role="tab">',e.label,"</a>"].join("")),t.setAttribute("aria-labelledby",r),this._.tabs[e.id]=[n,t],this._.tabIdList.push(e.id),!e.hidden&&this._.pageCount++,this._.lastTab=n,this.updateStyle(),t.setAttribute("name",e.id),t.appendTo(this.parts.contents),n.unselectable(),this.parts.tabs.append(n),e.accessKey&&(C(this,this,"CTRL+"+e.accessKey,S,k),this._.accessKeyMap["CTRL+"+e.accessKey]=e.id)}},selectPage:function(e){if(this._.currentTabId!=e&&!this._.tabs[e][0].hasClass("cke_dialog_tab_disabled")&&!1!==this.fire("selectPage",{page:e,currentPage:this._.currentTabId})){for(var n in this._.tabs){var i=this._.tabs[n][0],r=this._.tabs[n][1];n!=e&&(i.removeClass("cke_dialog_tab_selected"),r.hide()),r.setAttribute("aria-hidden",n!=e)}var a=this._.tabs[e];a[0].addClass("cke_dialog_tab_selected"),CKEDITOR.env.ie6Compat||CKEDITOR.env.ie7Compat?(t(a[1]),a[1].show(),setTimeout(function(){t(a[1],1)},0)):a[1].show(),this._.currentTabId=e,this._.currentTabIndex=CKEDITOR.tools.indexOf(this._.tabIdList,e)}},updateStyle:function(){this.parts.dialog[(1===this._.pageCount?"add":"remove")+"Class"]("cke_single_page")},hidePage:function(t){var n=this._.tabs[t]&&this._.tabs[t][0];n&&1!=this._.pageCount&&n.isVisible()&&(t==this._.currentTabId&&this.selectPage(e.call(this)),n.hide(),this._.pageCount--,this.updateStyle())},showPage:function(e){(e=this._.tabs[e]&&this._.tabs[e][0])&&(e.show(),this._.pageCount++,this.updateStyle())},getElement:function(){return this._.element},getName:function(){return this._.name},getContentElement:function(e,t){var n=this._.contents[e];return n&&n[t]},getValueOf:function(e,t){return this.getContentElement(e,t).getValue()},setValueOf:function(e,t,n){return this.getContentElement(e,t).setValue(n)},getButton:function(e){return this._.buttons[e]},click:function(e){return this._.buttons[e].click()},disableButton:function(e){return this._.buttons[e].disable()},enableButton:function(e){return this._.buttons[e].enable()},getPageCount:function(){return this._.pageCount},getParentEditor:function(){return this._.editor},getSelectedElement:function(){return this.getParentEditor().getSelection().getSelectedElement()},addFocusable:function(e,t){if(void 0===t)t=this._.focusList.length,this._.focusList.push(new i(this,e,t));else{this._.focusList.splice(t,0,new i(this,e,t));for(var n=t+1;n<this._.focusList.length;n++)this._.focusList[n].focusIndex++}},setState:function(e){if(this.state!=e){if(this.state=e,e==CKEDITOR.DIALOG_STATE_BUSY){if(!this.parts.spinner){var t=this.getParentEditor().lang.dir,n={attributes:{class:"cke_dialog_spinner"},styles:{float:"rtl"==t?"right":"left"}};n.styles["margin-"+("rtl"==t?"left":"right")]="8px",this.parts.spinner=CKEDITOR.document.createElement("div",n),this.parts.spinner.setHtml("&#8987;"),this.parts.spinner.appendTo(this.parts.title,1)}this.parts.spinner.show(),this.getButton("ok").disable()}else e==CKEDITOR.DIALOG_STATE_IDLE&&(this.parts.spinner&&this.parts.spinner.hide(),this.getButton("ok").enable());this.fire("state",e)}}},CKEDITOR.tools.extend(CKEDITOR.dialog,{add:function(e,t){this._.dialogDefinitions[e]&&"function"!=typeof t||(this._.dialogDefinitions[e]=t)},exists:function(e){return!!this._.dialogDefinitions[e]},getCurrent:function(){return CKEDITOR.dialog._.currentTop},isTabEnabled:function(e,t,n){return!((e=e.config.removeDialogTabs)&&e.match(new RegExp("(?:^|;)"+t+":"+n+"(?:$|;)","i")))},okButton:function(){var e=function(e,t){return t=t||{},CKEDITOR.tools.extend({id:"ok",type:"button",label:e.lang.common.ok,class:"cke_dialog_ui_button_ok",onClick:function(e){!1!==(e=e.data.dialog).fire("ok",{hide:!0}).hide&&e.hide()}},t,!0)};return e.type="button",e.override=function(t){return CKEDITOR.tools.extend(function(n){return e(n,t)},{type:"button"},!0)},e}(),cancelButton:function(){var e=function(e,t){return t=t||{},CKEDITOR.tools.extend({id:"cancel",type:"button",label:e.lang.common.cancel,class:"cke_dialog_ui_button_cancel",onClick:function(e){!1!==(e=e.data.dialog).fire("cancel",{hide:!0}).hide&&e.hide()}},t,!0)};return e.type="button",e.override=function(t){return CKEDITOR.tools.extend(function(n){return e(n,t)},{type:"button"},!0)},e}(),addUIElement:function(e,t){this._.uiElementBuilders[e]=t}}),CKEDITOR.dialog._={uiElementBuilders:{},dialogDefinitions:{},currentTop:null,currentZIndex:null},CKEDITOR.event.implementOn(CKEDITOR.dialog),CKEDITOR.event.implementOn(CKEDITOR.dialog.prototype);var h={resizable:CKEDITOR.DIALOG_RESIZE_BOTH,minWidth:600,minHeight:400,buttons:[CKEDITOR.dialog.okButton,CKEDITOR.dialog.cancelButton]},p=function(e,t,n){for(var i,r=0;i=e[r];r++)if(i.id==t||n&&i[n]&&(i=p(i[n],t,n)))return i;return null},f=function(e,t,n,i,r){if(n){for(var a,o=0;a=e[o];o++){if(a.id==n)return e.splice(o,0,t),t;if(i&&a[i]&&(a=f(a[i],t,n,i,!0)))return a}if(r)return null}return e.push(t),t},g=function(e,t,n){for(var i,r=0;i=e[r];r++){if(i.id==t)return e.splice(r,1);if(n&&i[n]&&(i=g(i[n],t,n)))return i}return null},m=function(e,t){this.dialog=e;for(var n,i=t.contents,a=0;n=i[a];a++)i[a]=n&&new r(e,n);CKEDITOR.tools.extend(this,t)};m.prototype={getContents:function(e){return p(this.contents,e)},getButton:function(e){return p(this.buttons,e)},addContents:function(e,t){return f(this.contents,e,t)},addButton:function(e,t){return f(this.buttons,e,t)},removeContents:function(e){g(this.contents,e)},removeButton:function(e){g(this.buttons,e)}},r.prototype={get:function(e){return p(this.elements,e,"children")},add:function(e,t){return f(this.elements,e,t,"children")},remove:function(e){g(this.elements,e,"children")}};var v,y,b={},_={},T=function(e){var t=e.data.$.ctrlKey||e.data.$.metaKey,n=e.data.$.altKey,i=e.data.$.shiftKey,r=String.fromCharCode(e.data.$.keyCode);(t=_[(t?"CTRL+":"")+(n?"ALT+":"")+(i?"SHIFT+":"")+r])&&t.length&&((t=t[t.length-1]).keydown&&t.keydown.call(t.uiElement,t.dialog,t.key),e.data.preventDefault())},E=function(e){var t=e.data.$.ctrlKey||e.data.$.metaKey,n=e.data.$.altKey,i=e.data.$.shiftKey,r=String.fromCharCode(e.data.$.keyCode);(t=_[(t?"CTRL+":"")+(n?"ALT+":"")+(i?"SHIFT+":"")+r])&&t.length&&(t=t[t.length-1]).keyup&&(t.keyup.call(t.uiElement,t.dialog,t.key),e.data.preventDefault())},C=function(e,t,n,i,r){(_[n]||(_[n]=[])).push({uiElement:e,dialog:t,key:n,keyup:r||e.accessKeyUp,keydown:i||e.accessKeyDown})},w=function(e){for(var t in _){for(var n=_[t],i=n.length-1;0<=i;i--)n[i].dialog!=e&&n[i].uiElement!=e||n.splice(i,1);0===n.length&&delete _[t]}},k=function(e,t){e._.accessKeyMap[t]&&e.selectPage(e._.accessKeyMap[t])},S=function(){};CKEDITOR.ui.dialog={uiElement:function(e,t,n,i,r,a,o){if(!(4>arguments.length)){var s=(i.call?i(t):i)||"div",l=["<",s," "],u=(r&&r.call?r(t):r)||{},c=(a&&a.call?a(t):a)||{},d=(o&&o.call?o.call(this,e,t):o)||"",h=this.domId=c.id||CKEDITOR.tools.getNextId()+"_uiElement";t.requiredContent&&!e.getParentEditor().filter.check(t.requiredContent)&&(u.display="none",this.notAllowed=!0),c.id=h;var p={};t.type&&(p["cke_dialog_ui_"+t.type]=1),t.className&&(p[t.className]=1),t.disabled&&(p.cke_disabled=1);var f=c.class&&c.class.split?c.class.split(" "):[];for(h=0;h<f.length;h++)f[h]&&(p[f[h]]=1);for(h in f=[],p)f.push(h);for(h in c.class=f.join(" "),t.title&&(c.title=t.title),p=(t.style||"").split(";"),t.align&&(f=t.align,u["margin-left"]="left"==f?0:"auto",u["margin-right"]="right"==f?0:"auto"),u)p.push(h+":"+u[h]);for(t.hidden&&p.push("display:none"),h=p.length-1;0<=h;h--)""===p[h]&&p.splice(h,1);for(h in 0<p.length&&(c.style=(c.style?c.style+"; ":"")+p.join("; ")),c)l.push(h+'="'+CKEDITOR.tools.htmlEncode(c[h])+'" ');l.push(">",d,"</",s,">"),n.push(l.join("")),(this._||(this._={})).dialog=e,"boolean"==typeof t.isChanged&&(this.isChanged=function(){return t.isChanged}),"function"==typeof t.isChanged&&(this.isChanged=t.isChanged),"function"==typeof t.setValue&&(this.setValue=CKEDITOR.tools.override(this.setValue,function(e){return function(n){e.call(this,t.setValue.call(this,n))}})),"function"==typeof t.getValue&&(this.getValue=CKEDITOR.tools.override(this.getValue,function(e){return function(){return t.getValue.call(this,e.call(this))}})),CKEDITOR.event.implementOn(this),this.registerEvents(t),this.accessKeyUp&&this.accessKeyDown&&t.accessKey&&C(this,e,"CTRL+"+t.accessKey);var g=this;e.on("load",function(){var t=g.getInputElement();if(t){var n=g.type in{checkbox:1,ratio:1}&&CKEDITOR.env.ie&&8>CKEDITOR.env.version?"cke_dialog_ui_focused":"";t.on("focus",function(){e._.tabBarMode=!1,e._.hasFocus=!0,g.fire("focus"),n&&this.addClass(n)}),t.on("blur",function(){g.fire("blur"),n&&this.removeClass(n)})}}),CKEDITOR.tools.extend(this,t),this.keyboardFocusable&&(this.tabIndex=t.tabIndex||0,this.focusIndex=e._.focusList.push(this)-1,this.on("focus",function(){e._.currentFocusIndex=g.focusIndex}))}},hbox:function(e,t,n,i,r){if(!(4>arguments.length)){this._||(this._={});var a,o=this._.children=t,s=r&&r.widths||null,l=r&&r.height||null,u={role:"presentation"};r&&r.align&&(u.align=r.align),CKEDITOR.ui.dialog.uiElement.call(this,e,r||{type:"hbox"},i,"table",{},u,function(){var e=['<tbody><tr class="cke_dialog_ui_hbox">'];for(a=0;a<n.length;a++){var t="cke_dialog_ui_hbox_child",i=[];0===a&&(t="cke_dialog_ui_hbox_first"),a==n.length-1&&(t="cke_dialog_ui_hbox_last"),e.push('<td class="',t,'" role="presentation" '),s?s[a]&&i.push("width:"+c(s[a])):i.push("width:"+Math.floor(100/n.length)+"%"),l&&i.push("height:"+c(l)),r&&void 0!==r.padding&&i.push("padding:"+c(r.padding)),CKEDITOR.env.ie&&CKEDITOR.env.quirks&&o[a].align&&i.push("text-align:"+o[a].align),0<i.length&&e.push('style="'+i.join("; ")+'" '),e.push(">",n[a],"</td>")}return e.push("</tr></tbody>"),e.join("")})}},vbox:function(e,t,n,i,r){if(!(3>arguments.length)){this._||(this._={});var a=this._.children=t,o=r&&r.width||null,s=r&&r.heights||null;CKEDITOR.ui.dialog.uiElement.call(this,e,r||{type:"vbox"},i,"div",null,{role:"presentation"},function(){var t=['<table role="presentation" cellspacing="0" border="0" '];t.push('style="'),r&&r.expand&&t.push("height:100%;"),t.push("width:"+c(o||"100%"),";"),CKEDITOR.env.webkit&&t.push("float:none;"),t.push('"'),t.push('align="',CKEDITOR.tools.htmlEncode(r&&r.align||("ltr"==e.getParentEditor().lang.dir?"left":"right")),'" '),t.push("><tbody>");for(var i=0;i<n.length;i++){var l=[];t.push('<tr><td role="presentation" '),o&&l.push("width:"+c(o||"100%")),s?l.push("height:"+c(s[i])):r&&r.expand&&l.push("height:"+Math.floor(100/n.length)+"%"),r&&void 0!==r.padding&&l.push("padding:"+c(r.padding)),CKEDITOR.env.ie&&CKEDITOR.env.quirks&&a[i].align&&l.push("text-align:"+a[i].align),0<l.length&&t.push('style="',l.join("; "),'" '),t.push(' class="cke_dialog_ui_vbox_child">',n[i],"</td></tr>")}return t.push("</tbody></table>"),t.join("")})}}},CKEDITOR.ui.dialog.uiElement.prototype={getElement:function(){return CKEDITOR.document.getById(this.domId)},getInputElement:function(){return this.getElement()},getDialog:function(){return this._.dialog},setValue:function(e,t){return this.getInputElement().setValue(e),!t&&this.fire("change",{value:e}),this},getValue:function(){return this.getInputElement().getValue()},isChanged:function(){return!1},selectParentTab:function(){for(var e=this.getInputElement();(e=e.getParent())&&-1==e.$.className.search("cke_dialog_page_contents"););return e?(e=e.getAttribute("name"),this._.dialog._.currentTabId!=e&&this._.dialog.selectPage(e),this):this},focus:function(){return this.selectParentTab().getInputElement().focus(),this},registerEvents:function(e){var t,n,i=/^on([A-Z]\w+)/,r=function(e,t,n,i){t.on("load",function(){e.getInputElement().on(n,i,e)})};for(n in e)(t=n.match(i))&&(this.eventProcessors[n]?this.eventProcessors[n].call(this,this._.dialog,e[n]):r(this,this._.dialog,t[1].toLowerCase(),e[n]));return this},eventProcessors:{onLoad:function(e,t){e.on("load",t,this)},onShow:function(e,t){e.on("show",t,this)},onHide:function(e,t){e.on("hide",t,this)}},accessKeyDown:function(){this.focus()},accessKeyUp:function(){},disable:function(){var e=this.getElement();this.getInputElement().setAttribute("disabled","true"),e.addClass("cke_disabled")},enable:function(){var e=this.getElement();this.getInputElement().removeAttribute("disabled"),e.removeClass("cke_disabled")},isEnabled:function(){return!this.getElement().hasClass("cke_disabled")},isVisible:function(){return this.getInputElement().isVisible()},isFocusable:function(){return!(!this.isEnabled()||!this.isVisible())}},CKEDITOR.ui.dialog.hbox.prototype=CKEDITOR.tools.extend(new CKEDITOR.ui.dialog.uiElement,{getChild:function(e){return 1>arguments.length?this._.children.concat():(e.splice||(e=[e]),2>e.length?this._.children[e[0]]:this._.children[e[0]]&&this._.children[e[0]].getChild?this._.children[e[0]].getChild(e.slice(1,e.length)):null)}},!0),CKEDITOR.ui.dialog.vbox.prototype=new CKEDITOR.ui.dialog.hbox,function(){var e={build:function(e,t,n){for(var i,r=t.children,a=[],o=[],s=0;s<r.length&&(i=r[s]);s++){var l=[];a.push(l),o.push(CKEDITOR.dialog._.uiElementBuilders[i.type].build(e,i,l))}return new CKEDITOR.ui.dialog[t.type](e,o,a,n,t)}};CKEDITOR.dialog.addUIElement("hbox",e),CKEDITOR.dialog.addUIElement("vbox",e)}(),CKEDITOR.dialogCommand=function(e,t){this.dialogName=e,CKEDITOR.tools.extend(this,t,!0)},CKEDITOR.dialogCommand.prototype={exec:function(e){e.openDialog(this.dialogName)},canUndo:!1,editorFocus:1},function(){var e=/^([a]|[^a])+$/,t=/^\d*$/,n=/^\d*(?:\.\d+)?$/,i=/^(((\d*(\.\d+))|(\d*))(px|\%)?)?$/,r=/^(((\d*(\.\d+))|(\d*))(px|em|ex|in|cm|mm|pt|pc|\%)?)?$/i,a=/^(\s*[\w-]+\s*:\s*[^:;]+(?:;|$))*$/;CKEDITOR.VALIDATE_OR=1,CKEDITOR.VALIDATE_AND=2,CKEDITOR.dialog.validate={functions:function(){var e=arguments;return function(){var t,n,i=this&&this.getValue?this.getValue():e[0],r=CKEDITOR.VALIDATE_AND,a=[];for(n=0;n<e.length&&"function"==typeof e[n];n++)a.push(e[n]);n<e.length&&"string"==typeof e[n]&&(t=e[n],n++),n<e.length&&"number"==typeof e[n]&&(r=e[n]);var o=r==CKEDITOR.VALIDATE_AND;for(n=0;n<a.length;n++)o=r==CKEDITOR.VALIDATE_AND?o&&a[n](i):o||a[n](i);return!!o||t}},regex:function(e,t){return function(n){return n=this&&this.getValue?this.getValue():n,!!e.test(n)||t}},notEmpty:function(t){return this.regex(e,t)},integer:function(e){return this.regex(t,e)},number:function(e){return this.regex(n,e)},cssLength:function(e){return this.functions(function(e){return r.test(CKEDITOR.tools.trim(e))},e)},htmlLength:function(e){return this.functions(function(e){return i.test(CKEDITOR.tools.trim(e))},e)},inlineStyle:function(e){return this.functions(function(e){return a.test(CKEDITOR.tools.trim(e))},e)},equals:function(e,t){return this.functions(function(t){return t==e},t)},notEqual:function(e,t){return this.functions(function(t){return t!=e},t)}},CKEDITOR.on("instanceDestroyed",function(e){if(CKEDITOR.tools.isEmpty(CKEDITOR.instances)){for(var t;t=CKEDITOR.dialog._.currentTop;)t.hide();for(var n in b)b[n].remove();b={}}for(var i in e=e.editor._.storedDialogs)e[i].destroy()})}(),CKEDITOR.tools.extend(CKEDITOR.editor.prototype,{openDialog:function(e,t){var n=null,i=CKEDITOR.dialog._.dialogDefinitions[e];if(null===CKEDITOR.dialog._.currentTop&&l(this),"function"==typeof i)n=(n=this._.storedDialogs||(this._.storedDialogs={}))[e]||(n[e]=new CKEDITOR.dialog(this,e)),t&&t.call(n,n),n.show();else{if("failed"==i)throw u(this),Error('[CKEDITOR.dialog.openDialog] Dialog "'+e+'" failed when loading definition.');"string"==typeof i&&CKEDITOR.scriptLoader.load(CKEDITOR.getUrl(i),function(){"function"!=typeof CKEDITOR.dialog._.dialogDefinitions[e]&&(CKEDITOR.dialog._.dialogDefinitions[e]="failed"),this.openDialog(e,t)},this,0,1)}return CKEDITOR.skin.loadPart("dialog"),n}})}(),CKEDITOR.plugins.add("dialog",{requires:"dialogui",init:function(e){e.on("doubleclick",function(t){t.data.dialog&&e.openDialog(t.data.dialog)},null,null,999)}}),CKEDITOR.plugins.add("a11yhelp",{requires:"dialog",availableLangs:{af:1,ar:1,az:1,bg:1,ca:1,cs:1,cy:1,da:1,de:1,"de-ch":1,el:1,en:1,"en-gb":1,eo:1,es:1,et:1,eu:1,fa:1,fi:1,fo:1,fr:1,"fr-ca":1,gl:1,gu:1,he:1,hi:1,hr:1,hu:1,id:1,it:1,ja:1,km:1,ko:1,ku:1,lt:1,lv:1,mk:1,mn:1,nb:1,nl:1,no:1,oc:1,pl:1,pt:1,"pt-br":1,ro:1,ru:1,si:1,sk:1,sl:1,sq:1,sr:1,"sr-latn":1,sv:1,th:1,tr:1,tt:1,ug:1,uk:1,vi:1,zh:1,"zh-cn":1},init:function(e){var t=this;e.addCommand("a11yHelp",{exec:function(){var n=e.langCode;n=t.availableLangs[n]?n:t.availableLangs[n.replace(/-.*/,"")]?n.replace(/-.*/,""):"en",CKEDITOR.scriptLoader.load(CKEDITOR.getUrl(t.path+"dialogs/lang/"+n+".js"),function(){e.lang.a11yhelp=t.langEntries[n],e.openDialog("a11yHelp")})},modes:{wysiwyg:1,source:1},readOnly:1,canUndo:!1}),e.setKeystroke(CKEDITOR.ALT+48,"a11yHelp"),CKEDITOR.dialog.add("a11yHelp",this.path+"dialogs/a11yhelp.js"),e.on("ariaEditorHelpLabel",function(t){t.data.label=e.lang.common.editorHelp})}}),CKEDITOR.plugins.add("about",{requires:"dialog",init:function(e){var t=e.addCommand("about",new CKEDITOR.dialogCommand("about"));t.modes={wysiwyg:1,source:1},t.canUndo=!1,t.readOnly=1,e.ui.addButton&&e.ui.addButton("About",{label:e.lang.about.title,command:"about",toolbar:"about"}),CKEDITOR.dialog.add("about",this.path+"dialogs/about.js")}}),CKEDITOR.plugins.add("basicstyles",{init:function(e){var t=0,n=function(n,r,a,o){if(o){o=new CKEDITOR.style(o);var s=i[a];s.unshift(o),e.attachStyleStateChange(o,function(t){!e.readOnly&&e.getCommand(a).setState(t)}),e.addCommand(a,new CKEDITOR.styleCommand(o,{contentForms:s})),e.ui.addButton&&e.ui.addButton(n,{label:r,command:a,toolbar:"basicstyles,"+(t+=10)})}},i={bold:["strong","b",["span",function(e){return"bold"==(e=e.styles["font-weight"])||700<=+e}]],italic:["em","i",["span",function(e){return"italic"==e.styles["font-style"]}]],underline:["u",["span",function(e){return"underline"==e.styles["text-decoration"]}]],strike:["s","strike",["span",function(e){return"line-through"==e.styles["text-decoration"]}]],subscript:["sub"],superscript:["sup"]},r=e.config,a=e.lang.basicstyles;n("Bold",a.bold,"bold",r.coreStyles_bold),n("Italic",a.italic,"italic",r.coreStyles_italic),n("Underline",a.underline,"underline",r.coreStyles_underline),n("Strike",a.strike,"strike",r.coreStyles_strike),n("Subscript",a.subscript,"subscript",r.coreStyles_subscript),n("Superscript",a.superscript,"superscript",r.coreStyles_superscript),e.setKeystroke([[CKEDITOR.CTRL+66,"bold"],[CKEDITOR.CTRL+73,"italic"],[CKEDITOR.CTRL+85,"underline"]])}}),CKEDITOR.config.coreStyles_bold={element:"strong",overrides:"b"},CKEDITOR.config.coreStyles_italic={element:"em",overrides:"i"},CKEDITOR.config.coreStyles_underline={element:"u"},CKEDITOR.config.coreStyles_strike={element:"s",overrides:"strike"},CKEDITOR.config.coreStyles_subscript={element:"sub"},CKEDITOR.config.coreStyles_superscript={element:"sup"},function(){var e={exec:function(e){var t=e.getCommand("blockquote").state,n=e.getSelection(),i=n&&n.getRanges()[0];if(i){var r=n.createBookmarks();if(CKEDITOR.env.ie){var a,o=r[0].startNode,s=r[0].endNode;if(o&&"blockquote"==o.getParent().getName())for(a=o;a=a.getNext();)if(a.type==CKEDITOR.NODE_ELEMENT&&a.isBlockBoundary()){o.move(a,!0);break}if(s&&"blockquote"==s.getParent().getName())for(a=s;a=a.getPrevious();)if(a.type==CKEDITOR.NODE_ELEMENT&&a.isBlockBoundary()){s.move(a);break}}if((l=i.createIterator()).enlargeBr=e.config.enterMode!=CKEDITOR.ENTER_BR,t==CKEDITOR.TRISTATE_OFF){for(o=[];t=l.getNextParagraph();)o.push(t);for(1>o.length&&(t=e.document.createElement(e.config.enterMode==CKEDITOR.ENTER_P?"p":"div"),s=r.shift(),i.insertNode(t),t.append(new CKEDITOR.dom.text("\ufeff",e.document)),i.moveToBookmark(s),i.selectNodeContents(t),i.collapse(!0),s=i.createBookmark(),o.push(t),r.unshift(s)),a=o[0].getParent(),i=[],s=0;s<o.length;s++)t=o[s],a=a.getCommonAncestor(t.getParent());for(t={table:1,tbody:1,tr:1,ol:1,ul:1};t[a.getName()];)a=a.getParent();for(s=null;0<o.length;){for(t=o.shift();!t.getParent().equals(a);)t=t.getParent();t.equals(s)||i.push(t),s=t}for(;0<i.length;)if("blockquote"==(t=i.shift()).getName()){for(s=new CKEDITOR.dom.documentFragment(e.document);t.getFirst();)s.append(t.getFirst().remove()),o.push(s.getLast());s.replace(t)}else o.push(t);for((i=e.document.createElement("blockquote")).insertBefore(o[0]);0<o.length;)t=o.shift(),i.append(t)}else if(t==CKEDITOR.TRISTATE_ON){for(s=[],a={};t=l.getNextParagraph();){for(o=i=null;t.getParent();){if("blockquote"==t.getParent().getName()){i=t.getParent(),o=t;break}t=t.getParent()}i&&o&&!o.getCustomData("blockquote_moveout")&&(s.push(o),CKEDITOR.dom.element.setMarker(a,o,"blockquote_moveout",!0))}for(CKEDITOR.dom.element.clearAllMarkers(a),t=[],o=[],a={};0<s.length;)i=(l=s.shift()).getParent(),l.getPrevious()?l.getNext()?(l.breakParent(l.getParent()),o.push(l.getNext())):l.remove().insertAfter(i):l.remove().insertBefore(i),i.getCustomData("blockquote_processed")||(o.push(i),CKEDITOR.dom.element.setMarker(a,i,"blockquote_processed",!0)),t.push(l);for(CKEDITOR.dom.element.clearAllMarkers(a),s=o.length-1;0<=s;s--){i=o[s];e:{for(var l=0,u=(a=i).getChildCount(),c=void 0;l<u&&(c=a.getChild(l));l++)if(c.type==CKEDITOR.NODE_ELEMENT&&c.isBlockBoundary()){a=!1;break e}a=!0}a&&i.remove()}if(e.config.enterMode==CKEDITOR.ENTER_BR)for(i=!0;t.length;)if("div"==(l=t.shift()).getName()){for(s=new CKEDITOR.dom.documentFragment(e.document),!i||!l.getPrevious()||l.getPrevious().type==CKEDITOR.NODE_ELEMENT&&l.getPrevious().isBlockBoundary()||s.append(e.document.createElement("br")),i=l.getNext()&&!(l.getNext().type==CKEDITOR.NODE_ELEMENT&&l.getNext().isBlockBoundary());l.getFirst();)l.getFirst().remove().appendTo(s);i&&s.append(e.document.createElement("br")),s.replace(l),i=!1}}n.selectBookmarks(r),e.focus()}},refresh:function(e,t){this.setState(e.elementPath(t.block||t.blockLimit).contains("blockquote",1)?CKEDITOR.TRISTATE_ON:CKEDITOR.TRISTATE_OFF)},context:"blockquote",allowedContent:"blockquote",requiredContent:"blockquote"};CKEDITOR.plugins.add("blockquote",{init:function(t){t.blockless||(t.addCommand("blockquote",e),t.ui.addButton&&t.ui.addButton("Blockquote",{label:t.lang.blockquote.toolbar,command:"blockquote",toolbar:"blocks,10"}))}})}(),function(){function e(e,t,n){return t.type||(t.type="auto"),!(n&&!1===e.fire("beforePaste",t)||!t.dataValue&&t.dataTransfer.isEmpty())&&(t.dataValue||(t.dataValue=""),CKEDITOR.env.gecko&&"drop"==t.method&&e.toolbox&&e.once("afterPaste",function(){e.toolbox.focus()}),e.fire("paste",t))}function t(t){function n(e){return{type:e,canUndo:"cut"==e,startDisabled:!0,fakeKeystroke:"cut"==e?CKEDITOR.CTRL+88:CKEDITOR.CTRL+67,exec:function(){var e;"cut"==this.type&&s();var n=this.type;if(CKEDITOR.env.ie)e=o(n);else try{e=t.document.$.execCommand(n,!1,null)}catch(t){e=!1}return e||t.showNotification(t.lang.clipboard[this.type+"Error"]),e}}}function i(){return{canUndo:!1,async:!0,fakeKeystroke:CKEDITOR.CTRL+86,exec:function(t,n){var i=this,r=function(n,r){n&&e(t,n,!!r),t.fire("afterCommandExec",{name:"paste",command:i,returnValue:!!n})};"string"==typeof n?r({dataValue:n,method:"paste",dataTransfer:h.initPasteDataTransfer()},1):t.getClipboardData(r)}}}function r(){f=1,setTimeout(function(){f=0},100)}function a(){p=1,setTimeout(function(){p=0},10)}function o(e){var n=t.document,i=n.getBody(),r=!1,a=function(){r=!0};return i.on(e,a),7<CKEDITOR.env.version?n.$.execCommand(e):n.$.selection.createRange().execCommand(e),i.removeListener(e,a),r}function s(){if(CKEDITOR.env.ie&&!CKEDITOR.env.quirks){var e,n,i,r=t.getSelection();r.getType()==CKEDITOR.SELECTION_ELEMENT&&(e=r.getSelectedElement())&&(n=r.getRanges()[0],(i=t.document.createText("")).insertBefore(e),n.setStartBefore(i),n.setEndAfter(e),r.selectRanges([n]),setTimeout(function(){e.getParent()&&(i.remove(),r.selectElement(e))},0))}}function l(){if("paste"==h.mainPasteEvent)return t.fire("beforePaste",{type:"auto",method:"paste"}),!1;t.focus(),r();var e=t.focusManager;return e.lock(),t.editable().fire(h.mainPasteEvent)&&!o("paste")?(e.unlock(),!1):(e.unlock(),!0)}function u(n){var i={type:"auto",method:"paste",dataTransfer:h.initPasteDataTransfer(n)};i.dataTransfer.cacheData();var r=!1!==t.fire("beforePaste",i);r&&h.canClipboardApiBeTrusted(i.dataTransfer,t)?(n.data.preventDefault(),setTimeout(function(){e(t,i)},0)):function(e,n){var i,r=t.document,a=t.editable(),o=function(e){e.cancel()};if(!r.getById("cke_pastebin")){var s=t.getSelection(),l=s.createBookmarks();CKEDITOR.env.ie&&s.root.fire("selectionchange");var u=new CKEDITOR.dom.element(!CKEDITOR.env.webkit&&!a.is("body")||CKEDITOR.env.ie?"div":"body",r);u.setAttributes({id:"cke_pastebin","data-cke-temp":"1"});var c=0;r=r.getWindow(),CKEDITOR.env.webkit?(a.append(u),u.addClass("cke_editable"),a.is("body")||(c=(c="static"!=a.getComputedStyle("position")?a:CKEDITOR.dom.element.get(a.$.offsetParent)).getDocumentPosition().y)):a.getAscendant(CKEDITOR.env.ie?"body":"html",1).append(u),u.setStyles({position:"absolute",top:r.getScrollPosition().y-c+10+"px",width:"1px",height:Math.max(1,r.getViewPaneSize().height-20)+"px",overflow:"hidden",margin:0,padding:0}),CKEDITOR.env.safari&&u.setStyles(CKEDITOR.tools.cssVendorPrefix("user-select","text")),(c=u.getParent().isReadOnly())?(u.setOpacity(0),u.setAttribute("contenteditable",!0)):u.setStyle("ltr"==t.config.contentsLangDirection?"left":"right","-10000px"),t.on("selectionChange",o,null,null,0),(CKEDITOR.env.webkit||CKEDITOR.env.gecko)&&(i=a.once("blur",o,null,null,-100)),c&&u.focus(),(c=new CKEDITOR.dom.range(u)).selectNodeContents(u);var d=c.select();CKEDITOR.env.ie&&(i=a.once("blur",function(){t.lockSelection(d)}));var h=CKEDITOR.document.getWindow().getScrollPosition().y;setTimeout(function(){var e;CKEDITOR.env.webkit&&(CKEDITOR.document.getBody().$.scrollTop=h),i&&i.removeListener(),CKEDITOR.env.ie&&a.focus(),s.selectBookmarks(l),u.remove(),CKEDITOR.env.webkit&&(e=u.getFirst())&&e.is&&e.hasClass("Apple-style-span")&&(u=e),t.removeListener("selectionChange",o),n(u.getHtml())},0)}}(0,function(n){i.dataValue=n.replace(/<span[^>]+data-cke-bookmark[^<]*?<\/span>/gi,""),r&&e(t,i)})}function c(){if("wysiwyg"==t.mode){var e=d("paste");t.getCommand("cut").setState(d("cut")),t.getCommand("copy").setState(d("copy")),t.getCommand("paste").setState(e),t.fire("pasteState",e)}}function d(e){if(g&&e in{paste:1,cut:1})return CKEDITOR.TRISTATE_DISABLED;if("paste"==e)return CKEDITOR.TRISTATE_OFF;var n=(e=t.getSelection()).getRanges();return e.getType()==CKEDITOR.SELECTION_NONE||1==n.length&&n[0].collapsed?CKEDITOR.TRISTATE_DISABLED:CKEDITOR.TRISTATE_OFF}var h=CKEDITOR.plugins.clipboard,p=0,f=0,g=0;t.on("key",function(e){if("wysiwyg"==t.mode)switch(e.data.keyCode){case CKEDITOR.CTRL+86:case CKEDITOR.SHIFT+45:e=t.editable(),r(),"paste"==h.mainPasteEvent&&e.fire("beforepaste");break;case CKEDITOR.CTRL+88:case CKEDITOR.SHIFT+46:t.fire("saveSnapshot"),setTimeout(function(){t.fire("saveSnapshot")},50)}}),t.on("contentDom",function(){var e,n=t.editable();if(CKEDITOR.plugins.clipboard.isCustomCopyCutSupported){var i=function(e){t.readOnly&&"cut"==e.name||h.initPasteDataTransfer(e,t),e.data.preventDefault()};n.on("copy",i),n.on("cut",i),n.on("cut",function(){t.readOnly||t.extractSelectedHtml()},null,null,999)}n.on(h.mainPasteEvent,function(e){"beforepaste"==h.mainPasteEvent&&p||u(e)}),"beforepaste"==h.mainPasteEvent&&(n.on("paste",function(e){f||(r(),e.data.preventDefault(),u(e),o("paste")||t.openDialog("paste"))}),n.on("contextmenu",a,null,null,0),n.on("beforepaste",function(e){!e.data||e.data.$.ctrlKey||e.data.$.shiftKey||a()},null,null,0)),n.on("beforecut",function(){!p&&s()}),n.attachListener(CKEDITOR.env.ie?n:t.document.getDocumentElement(),"mouseup",function(){e=setTimeout(function(){c()},0)}),t.on("destroy",function(){clearTimeout(e)}),n.on("keyup",c)}),t.on("selectionChange",function(e){g=e.data.selection.getRanges()[0].checkReadOnly(),c()}),t.contextMenu&&t.contextMenu.addListener(function(e,t){return g=t.getRanges()[0].checkReadOnly(),{cut:d("cut"),copy:d("copy"),paste:d("paste")}}),function(){function e(e,n,i,r,a){var o=t.lang.clipboard[n];t.addCommand(n,i),t.ui.addButton&&t.ui.addButton(e,{label:o,command:n,toolbar:"clipboard,"+r}),t.addMenuItems&&t.addMenuItem(n,{label:o,command:n,group:"clipboard",order:a})}e("Cut","cut",n("cut"),10,1),e("Copy","copy",n("copy"),20,4),e("Paste","paste",i(),30,8)}(),t.getClipboardData=function(e,n){function i(e){e.removeListener(),e.cancel(),n(e.data)}function r(e){e.removeListener(),e.cancel(),s=!0,n({type:o,dataValue:e.data.dataValue,dataTransfer:e.data.dataTransfer,method:"paste"})}var a=!1,o="auto",s=!1;n||(n=e,e=null),t.on("paste",i,null,null,0),t.on("beforePaste",function(e){e.removeListener(),a=!0,o=e.data.type},null,null,1e3),!1===l()&&(t.removeListener("paste",i),a&&t.fire("pasteDialog",function(){this.customTitle=e&&e.title})?(t.on("pasteDialogCommit",r),t.on("dialogHide",function(e){e.removeListener(),e.data.removeListener("pasteDialogCommit",r),setTimeout(function(){s||n(null)},10)})):n(null))}}function n(e,t,n){t=CKEDITOR.htmlParser.fragment.fromHtml(t);var i=new CKEDITOR.htmlParser.basicWriter;return n.applyTo(t,!0,!1,e.activeEnterMode),t.writeHtml(i),i.getHtml()}function i(e){e.data.preventDefault(),e.data.$.dataTransfer.dropEffect="none"}function r(t){var n=CKEDITOR.plugins.clipboard;t.on("contentDom",function(){function i(n,i,r){i.select(),e(t,{dataTransfer:r,method:"drop"},1),r.sourceEditor.fire("saveSnapshot"),r.sourceEditor.editable().extractHtmlFromRange(n),r.sourceEditor.getSelection().selectRanges([n]),r.sourceEditor.fire("saveSnapshot")}function r(i,r){i.select(),e(t,{dataTransfer:r,method:"drop"},1),n.resetDragDataTransfer()}function a(e,n,i){var r={$:e.data.$,target:e.data.getTarget()};n&&(r.dragRange=n),i&&(r.dropRange=i),!1===t.fire(e.name,r)&&e.data.preventDefault()}function o(e){return e.type!=CKEDITOR.NODE_ELEMENT&&(e=e.getParent()),e.getChildCount()}var s=t.editable(),l=CKEDITOR.plugins.clipboard.getDropTarget(t),u=t.ui.space("top"),c=t.ui.space("bottom");n.preventDefaultDropOnElement(u),n.preventDefaultDropOnElement(c),s.attachListener(l,"dragstart",a),s.attachListener(t,"dragstart",n.resetDragDataTransfer,n,null,1),s.attachListener(t,"dragstart",function(e){n.initDragDataTransfer(e,t)},null,null,2),s.attachListener(t,"dragstart",function(){var e=n.dragRange=t.getSelection().getRanges()[0];CKEDITOR.env.ie&&10>CKEDITOR.env.version&&(n.dragStartContainerChildCount=e?o(e.startContainer):null,n.dragEndContainerChildCount=e?o(e.endContainer):null)},null,null,100),s.attachListener(l,"dragend",a),s.attachListener(t,"dragend",n.initDragDataTransfer,n,null,1),s.attachListener(t,"dragend",n.resetDragDataTransfer,n,null,100),s.attachListener(l,"dragover",function(e){var t=e.data.getTarget();t&&t.is&&t.is("html")?e.data.preventDefault():CKEDITOR.env.ie&&CKEDITOR.plugins.clipboard.isFileApiSupported&&e.data.$.dataTransfer.types.contains("Files")&&e.data.preventDefault()}),s.attachListener(l,"drop",function(e){if(!e.data.$.defaultPrevented&&(e.data.preventDefault(),!(i=e.data.getTarget()).isReadOnly()||i.type==CKEDITOR.NODE_ELEMENT&&i.is("html"))){var i=n.getRangeAtDropPosition(e,t),r=n.dragRange;i&&a(e,r,i)}},null,null,9999),s.attachListener(t,"drop",n.initDragDataTransfer,n,null,1),s.attachListener(t,"drop",function(e){if(e=e.data){var a=e.dropRange,o=e.dragRange,s=e.dataTransfer;s.getTransferType(t)==CKEDITOR.DATA_TRANSFER_INTERNAL?setTimeout(function(){n.internalDrop(o,a,s,t)},0):s.getTransferType(t)==CKEDITOR.DATA_TRANSFER_CROSS_EDITORS?i(o,a,s):r(a,s)}},null,null,9999)})}CKEDITOR.plugins.add("clipboard",{requires:"dialog",init:function(e){var i,a=function(){var e={};return{get:function(t){return"plain-text"==t?e.plainText||(e.plainText=new CKEDITOR.filter("br")):"semantic-content"==t?((t=e.semanticContent)||((t=new CKEDITOR.filter).allow({$1:{elements:function(){var e,t={};for(e in CKEDITOR.dtd)"$"!=e.charAt(0)&&"div"!=e&&"span"!=e&&(t[e]=1);return t}(),attributes:!0,styles:!1,classes:!1}}),t=e.semanticContent=t),t):t?new CKEDITOR.filter(t):null}}}();if(e.config.forcePasteAsPlainText?i="plain-text":e.config.pasteFilter?i=e.config.pasteFilter:!CKEDITOR.env.webkit||"pasteFilter"in e.config||(i="semantic-content"),e.pasteFilter=a.get(i),t(e),r(e),CKEDITOR.dialog.add("paste",CKEDITOR.getUrl(this.path+"dialogs/paste.js")),CKEDITOR.env.gecko){var o,s=["image/png","image/jpeg","image/gif"];e.on("paste",function(t){var n=t.data,i=n.dataTransfer;if(!n.dataValue&&"paste"==n.method&&i&&1==i.getFilesCount()&&o!=i.id&&(i=i.getFile(0),-1!=CKEDITOR.tools.indexOf(s,i.type))){var r=new FileReader;r.addEventListener("load",function(){t.data.dataValue='<img src="'+r.result+'" />',e.fire("paste",t.data)},!1),r.addEventListener("abort",function(){e.fire("paste",t.data)},!1),r.addEventListener("error",function(){e.fire("paste",t.data)},!1),r.readAsDataURL(i),o=n.dataTransfer.id,t.stop()}},null,null,1)}e.on("paste",function(t){if(t.data.dataTransfer||(t.data.dataTransfer=new CKEDITOR.plugins.clipboard.dataTransfer),!t.data.dataValue){var n=t.data.dataTransfer,i=n.getData("text/html");i?(t.data.dataValue=i,t.data.type="html"):(i=n.getData("text/plain"))&&(t.data.dataValue=e.editable().transformPlainTextToHtml(i),t.data.type="text")}},null,null,1),e.on("paste",function(e){var t=e.data.dataValue,n=CKEDITOR.dtd.$block;if(-1<t.indexOf("Apple-")&&(t=t.replace(/<span class="Apple-converted-space">&nbsp;<\/span>/gi," "),"html"!=e.data.type&&(t=t.replace(/<span class="Apple-tab-span"[^>]*>([^<]*)<\/span>/gi,function(e,t){return t.replace(/\t/g,"&nbsp;&nbsp; &nbsp;")})),-1<t.indexOf('<br class="Apple-interchange-newline">')&&(e.data.startsWithEOL=1,e.data.preSniffing="html",t=t.replace(/<br class="Apple-interchange-newline">/,"")),t=t.replace(/(<[^>]+) class="Apple-[^"]*"/gi,"$1")),t.match(/^<[^<]+cke_(editable|contents)/i)){var i,r,a=new CKEDITOR.dom.element("div");for(a.setHtml(t);1==a.getChildCount()&&(i=a.getFirst())&&i.type==CKEDITOR.NODE_ELEMENT&&(i.hasClass("cke_editable")||i.hasClass("cke_contents"));)a=r=i;r&&(t=r.getHtml().replace(/<br>$/i,""))}CKEDITOR.env.ie?t=t.replace(/^&nbsp;(?: |\r\n)?<(\w+)/g,function(t,i){return i.toLowerCase()in n?(e.data.preSniffing="html","<"+i):t}):CKEDITOR.env.webkit?t=t.replace(/<\/(\w+)><div><br><\/div>$/,function(t,i){return i in n?(e.data.endsWithEOL=1,"</"+i+">"):t}):CKEDITOR.env.gecko&&(t=t.replace(/(\s)<br>$/,"$1")),e.data.dataValue=t},null,null,3),e.on("paste",function(t){var i,r=(t=t.data).type,o=t.dataValue,s=e.config.clipboard_defaultContentType||"html",l=t.dataTransfer.getTransferType(e);"htmlifiedtext"==(i="html"==r||"html"==t.preSniffing?"html":function(e){if(CKEDITOR.env.webkit){if(!e.match(/^[^<]*$/g)&&!e.match(/^(<div><br( ?\/)?><\/div>|<div>[^<]*<\/div>)*$/gi))return"html"}else if(CKEDITOR.env.ie){if(!e.match(/^([^<]|<br( ?\/)?>)*$/gi)&&!e.match(/^(<p>([^<]|<br( ?\/)?>)*<\/p>|(\r\n))*$/gi))return"html"}else{if(!CKEDITOR.env.gecko)return"html";if(!e.match(/^([^<]|<br( ?\/)?>)*$/gi))return"html"}return"htmlifiedtext"}(o))&&(o=function(e,t){function n(e){return CKEDITOR.tools.repeat("</p><p>",~~(e/2))+(1==e%2?"<br>":"")}return(t=(t=t.replace(/\s+/g," ").replace(/> +</g,"><").replace(/<br ?\/>/gi,"<br>")).replace(/<\/?[A-Z]+>/g,function(e){return e.toLowerCase()})).match(/^[^<]$/)?t:(CKEDITOR.env.webkit&&-1<t.indexOf("<div>")&&((t=t.replace(/^(<div>(<br>|)<\/div>)(?!$|(<div>(<br>|)<\/div>))/g,"<br>").replace(/^(<div>(<br>|)<\/div>){2}(?!$)/g,"<div></div>")).match(/<div>(<br>|)<\/div>/)&&(t="<p>"+t.replace(/(<div>(<br>|)<\/div>)+/g,function(e){return n(e.split("</div><div>").length+1)})+"</p>"),t=(t=t.replace(/<\/div><div>/g,"<br>")).replace(/<\/?div>/g,"")),CKEDITOR.env.gecko&&e.enterMode!=CKEDITOR.ENTER_BR&&(CKEDITOR.env.gecko&&(t=t.replace(/^<br><br>$/,"<br>")),-1<t.indexOf("<br><br>")&&(t="<p>"+t.replace(/(<br>){2,}/g,function(e){return n(e.length/4)})+"</p>")),function(e,t){return e.enterMode==CKEDITOR.ENTER_BR?t=t.replace(/(<\/p><p>)+/g,function(e){return CKEDITOR.tools.repeat("<br>",e.length/7*2)}).replace(/<\/?p>/g,""):e.enterMode==CKEDITOR.ENTER_DIV&&(t=t.replace(/<(\/)?p>/g,"<$1div>")),t}(e,t))}(e.config,o)),"text"==r&&"html"==i?o=n(e,o,a.get("plain-text")):l==CKEDITOR.DATA_TRANSFER_EXTERNAL&&e.pasteFilter&&!t.dontFilter&&(o=n(e,o,e.pasteFilter)),t.startsWithEOL&&(o='<br data-cke-eol="1">'+o),t.endsWithEOL&&(o+='<br data-cke-eol="1">'),"auto"==r&&(r="html"==i||"html"==s?"html":"text"),t.type=r,t.dataValue=o,delete t.preSniffing,delete t.startsWithEOL,delete t.endsWithEOL},null,null,6),e.on("paste",function(t){(t=t.data).dataValue&&(e.insertHtml(t.dataValue,t.type,t.range),setTimeout(function(){e.fire("afterPaste")},0))},null,null,1e3),e.on("pasteDialog",function(t){setTimeout(function(){e.openDialog("paste",t.data)},0)})}}),CKEDITOR.plugins.clipboard={isCustomCopyCutSupported:!CKEDITOR.env.ie&&!CKEDITOR.env.iOS,isCustomDataTypesSupported:!CKEDITOR.env.ie,isFileApiSupported:!CKEDITOR.env.ie||9<CKEDITOR.env.version,mainPasteEvent:CKEDITOR.env.ie&&!CKEDITOR.env.edge?"beforepaste":"paste",canClipboardApiBeTrusted:function(e,t){return!!(e.getTransferType(t)!=CKEDITOR.DATA_TRANSFER_EXTERNAL||CKEDITOR.env.chrome&&!e.isEmpty()||CKEDITOR.env.gecko&&(e.getData("text/html")||e.getFilesCount()))},getDropTarget:function(e){var t=e.editable();return CKEDITOR.env.ie&&9>CKEDITOR.env.version||t.isInline()?t:e.document},fixSplitNodesAfterDrop:function(e,t,n,i){function r(e,n,i){var r=e;if(r.type==CKEDITOR.NODE_TEXT&&(r=e.getParent()),r.equals(n)&&i!=n.getChildCount())return e=t.startContainer.getChild(t.startOffset-1),n=t.startContainer.getChild(t.startOffset),e&&e.type==CKEDITOR.NODE_TEXT&&n&&n.type==CKEDITOR.NODE_TEXT&&(i=e.getLength(),e.setText(e.getText()+n.getText()),n.remove(),t.setStart(e,i),t.collapse(!0)),!0}var a=t.startContainer;"number"==typeof i&&"number"==typeof n&&a.type==CKEDITOR.NODE_ELEMENT&&(r(e.startContainer,a,n)||r(e.endContainer,a,i))},isDropRangeAffectedByDragRange:function(e,t){var n=t.startContainer,i=t.endOffset;return!!(e.endContainer.equals(n)&&e.endOffset<=i||e.startContainer.getParent().equals(n)&&e.startContainer.getIndex()<i||e.endContainer.getParent().equals(n)&&e.endContainer.getIndex()<i)},internalDrop:function(t,n,i,r){var a,o,s=CKEDITOR.plugins.clipboard,l=r.editable();r.fire("saveSnapshot"),r.fire("lockSnapshot",{dontUpdate:1}),CKEDITOR.env.ie&&10>CKEDITOR.env.version&&this.fixSplitNodesAfterDrop(t,n,s.dragStartContainerChildCount,s.dragEndContainerChildCount),(o=this.isDropRangeAffectedByDragRange(t,n))||(a=t.createBookmark(!1)),s=n.clone().createBookmark(!1),o&&(a=t.createBookmark(!1)),t=a.startNode,n=a.endNode,o=s.startNode,n&&t.getPosition(o)&CKEDITOR.POSITION_PRECEDING&&n.getPosition(o)&CKEDITOR.POSITION_FOLLOWING&&o.insertBefore(t),(t=r.createRange()).moveToBookmark(a),l.extractHtmlFromRange(t,1),(n=r.createRange()).moveToBookmark(s),e(r,{dataTransfer:i,method:"drop",range:n},1),r.fire("unlockSnapshot")},getRangeAtDropPosition:function(e,t){var n=e.data.$,i=n.clientX,r=n.clientY,a=t.getSelection(!0).getRanges()[0],o=t.createRange();if(e.data.testRange)return e.data.testRange;if(document.caretRangeFromPoint)n=t.document.$.caretRangeFromPoint(i,r),o.setStart(CKEDITOR.dom.node(n.startContainer),n.startOffset),o.collapse(!0);else if(n.rangeParent)o.setStart(CKEDITOR.dom.node(n.rangeParent),n.rangeOffset),o.collapse(!0);else{if(CKEDITOR.env.ie&&8<CKEDITOR.env.version&&a&&t.editable().hasFocus)return a;if(!document.body.createTextRange)return null;t.focus(),n=t.document.getBody().$.createTextRange();try{for(var s=!1,l=0;20>l&&!s;l++){if(!s)try{n.moveToPoint(i,r-l),s=!0}catch(e){}if(!s)try{n.moveToPoint(i,r+l),s=!0}catch(e){}}if(s){var u="cke-temp-"+(new Date).getTime();n.pasteHTML('<span id="'+u+'">​</span>');var c=t.document.getById(u);o.moveToPosition(c,CKEDITOR.POSITION_BEFORE_START),c.remove()}else{var d=t.document.$.elementFromPoint(i,r),h=new CKEDITOR.dom.element(d);if(h.equals(t.editable())||"html"==h.getName())return a&&a.startContainer&&!a.startContainer.equals(t.editable())?a:null;i<h.getClientRect().left?o.setStartAt(h,CKEDITOR.POSITION_AFTER_START):o.setStartAt(h,CKEDITOR.POSITION_BEFORE_END),o.collapse(!0)}}catch(e){return null}}return o},initDragDataTransfer:function(e,t){var n=e.data.$?e.data.$.dataTransfer:null,i=new this.dataTransfer(n,t);n?this.dragData&&i.id==this.dragData.id?i=this.dragData:this.dragData=i:this.dragData?i=this.dragData:this.dragData=i,e.data.dataTransfer=i},resetDragDataTransfer:function(){this.dragData=null},initPasteDataTransfer:function(e,t){if(this.isCustomCopyCutSupported){if(e&&e.data&&e.data.$){var n=new this.dataTransfer(e.data.$.clipboardData,t);return this.copyCutData&&n.id==this.copyCutData.id?(n=this.copyCutData).$=e.data.$.clipboardData:this.copyCutData=n,n}return new this.dataTransfer(null,t)}return new this.dataTransfer(CKEDITOR.env.edge&&e&&e.data.$&&e.data.$.clipboardData||null,t)},preventDefaultDropOnElement:function(e){e&&e.on("dragover",i)}};var a=CKEDITOR.plugins.clipboard.isCustomDataTypesSupported?"cke/id":"Text";CKEDITOR.plugins.clipboard.dataTransfer=function(e,t){if(e&&(this.$=e),this._={metaRegExp:/^<meta.*?>/i,bodyRegExp:/<body(?:[\s\S]*?)>([\s\S]*)<\/body>/i,fragmentRegExp:/\x3c!--(?:Start|End)Fragment--\x3e/g,data:{},files:[],normalizeType:function(e){return"text"==(e=e.toLowerCase())||"text/plain"==e?"Text":"url"==e?"URL":e}},this.id=this.getData(a),this.id||(this.id="Text"==a?"":"cke-"+CKEDITOR.tools.getUniqueId()),"Text"!=a)try{this.$.setData(a,this.id)}catch(e){}t&&(this.sourceEditor=t,this.setData("text/html",t.getSelectedHtml(1)),"Text"==a||this.getData("text/plain")||this.setData("text/plain",t.getSelection().getSelectedText()))},CKEDITOR.DATA_TRANSFER_INTERNAL=1,CKEDITOR.DATA_TRANSFER_CROSS_EDITORS=2,CKEDITOR.DATA_TRANSFER_EXTERNAL=3,CKEDITOR.plugins.clipboard.dataTransfer.prototype={getData:function(e){e=this._.normalizeType(e);var t=this._.data[e];if(void 0===t||null===t||""===t)try{t=this.$.getData(e)}catch(e){}return void 0!==t&&null!==t&&""!==t||(t=""),"text/html"==e?(t=t.replace(this._.metaRegExp,""),(e=this._.bodyRegExp.exec(t))&&e.length&&(t=(t=e[1]).replace(this._.fragmentRegExp,""))):"Text"==e&&CKEDITOR.env.gecko&&this.getFilesCount()&&"file://"==t.substring(0,7)&&(t=""),t},setData:function(e,t){if(e=this._.normalizeType(e),this._.data[e]=t,CKEDITOR.plugins.clipboard.isCustomDataTypesSupported||"URL"==e||"Text"==e){"Text"==a&&"Text"==e&&(this.id=t);try{this.$.setData(e,t)}catch(e){}}},getTransferType:function(e){return this.sourceEditor?this.sourceEditor==e?CKEDITOR.DATA_TRANSFER_INTERNAL:CKEDITOR.DATA_TRANSFER_CROSS_EDITORS:CKEDITOR.DATA_TRANSFER_EXTERNAL},cacheData:function(){function e(e){e=i._.normalizeType(e);var t=i.getData(e);t&&(i._.data[e]=t)}if(this.$){var t,n,i=this;if(CKEDITOR.plugins.clipboard.isCustomDataTypesSupported){if(this.$.types)for(t=0;t<this.$.types.length;t++)e(this.$.types[t])}else e("Text"),e("URL");if(n=this._getImageFromClipboard(),this.$&&this.$.files||n){if(this._.files=[],this.$.files&&this.$.files.length)for(t=0;t<this.$.files.length;t++)this._.files.push(this.$.files[t]);0===this._.files.length&&n&&this._.files.push(n)}}},getFilesCount:function(){return this._.files.length?this._.files.length:this.$&&this.$.files&&this.$.files.length?this.$.files.length:this._getImageFromClipboard()?1:0},getFile:function(e){return this._.files.length?this._.files[e]:this.$&&this.$.files&&this.$.files.length?this.$.files[e]:0===e?this._getImageFromClipboard():void 0},isEmpty:function(){var e,t={};if(this.getFilesCount())return!1;for(e in this._.data)t[e]=1;if(this.$)if(CKEDITOR.plugins.clipboard.isCustomDataTypesSupported){if(this.$.types)for(var n=0;n<this.$.types.length;n++)t[this.$.types[n]]=1}else t.Text=1,t.URL=1;for(e in"Text"!=a&&(t[a]=0),t)if(t[e]&&""!==this.getData(e))return!1;return!0},_getImageFromClipboard:function(){var e;if(this.$&&this.$.items&&this.$.items[0])try{if((e=this.$.items[0].getAsFile())&&e.type)return e}catch(e){}}}}(),function(){CKEDITOR.plugins.add("panel",{beforeInit:function(e){e.ui.addHandler(CKEDITOR.UI_PANEL,CKEDITOR.ui.panel.handler)}}),CKEDITOR.UI_PANEL="panel",CKEDITOR.ui.panel=function(e,t){t&&CKEDITOR.tools.extend(this,t),CKEDITOR.tools.extend(this,{className:"",css:[]}),this.id=CKEDITOR.tools.getNextId(),this.document=e,this.isFramed=this.forceIFrame||this.css.length,this._={blocks:{}}},CKEDITOR.ui.panel.handler={create:function(e){return new CKEDITOR.ui.panel(e)}};var e=CKEDITOR.addTemplate("panel",'<div lang="{langCode}" id="{id}" dir={dir} class="cke cke_reset_all {editorId} cke_panel cke_panel {cls} cke_{dir}" style="z-index:{z-index}" role="presentation">{frame}</div>'),t=CKEDITOR.addTemplate("panel-frame",'<iframe id="{id}" class="cke_panel_frame" role="presentation" frameborder="0" src="{src}"></iframe>'),n=CKEDITOR.addTemplate("panel-frame-inner",'<!DOCTYPE html><html class="cke_panel_container {env}" dir="{dir}" lang="{langCode}"><head>{css}</head><body class="cke_{dir}" style="margin:0;padding:0" onload="{onload}"></body></html>');CKEDITOR.ui.panel.prototype={render:function(i,r){this.getHolderElement=function(){if(!(t=this._.holder)){if(this.isFramed){var e=(t=this.document.getById(this.id+"_frame")).getParent(),t=t.getFrameDocument();CKEDITOR.env.iOS&&e.setStyles({overflow:"scroll","-webkit-overflow-scrolling":"touch"}),e=CKEDITOR.tools.addFunction(CKEDITOR.tools.bind(function(){this.isLoaded=!0,this.onLoad&&this.onLoad()},this)),t.write(n.output(CKEDITOR.tools.extend({css:CKEDITOR.tools.buildStyleHtml(this.css),onload:"window.parent.CKEDITOR.tools.callFunction("+e+");"},a))),t.getWindow().$.CKEDITOR=CKEDITOR,t.on("keydown",function(e){var t=e.data.getKeystroke(),n=this.document.getById(this.id).getAttribute("dir");this._.onKeyDown&&!1===this._.onKeyDown(t)?e.data.preventDefault():(27==t||t==("rtl"==n?39:37))&&this.onEscape&&!1===this.onEscape(t)&&e.data.preventDefault()},this),(t=t.getBody()).unselectable(),CKEDITOR.env.air&&CKEDITOR.tools.callFunction(e)}else t=this.document.getById(this.id);this._.holder=t}return t};var a={editorId:i.id,id:this.id,langCode:i.langCode,dir:i.lang.dir,cls:this.className,frame:"",env:CKEDITOR.env.cssClass,"z-index":i.config.baseFloatZIndex+1};if(this.isFramed){var o=CKEDITOR.env.air?"javascript:void(0)":CKEDITOR.env.ie?"javascript:void(function(){"+encodeURIComponent("document.open();("+CKEDITOR.tools.fixDomain+")();document.close();")+"}())":"";a.frame=t.output({id:this.id+"_frame",src:o})}return o=e.output(a),r&&r.push(o),o},addBlock:function(e,t){return t=this._.blocks[e]=t instanceof CKEDITOR.ui.panel.block?t:new CKEDITOR.ui.panel.block(this.getHolderElement(),t),this._.currentBlock||this.showBlock(e),t},getBlock:function(e){return this._.blocks[e]},showBlock:function(e){e=this._.blocks[e];var t=this._.currentBlock,n=!this.forceIFrame||CKEDITOR.env.ie?this._.holder:this.document.getById(this.id+"_frame");return t&&t.hide(),this._.currentBlock=e,CKEDITOR.fire("ariaWidget",n),e._.focusIndex=-1,this._.onKeyDown=e.onKeyDown&&CKEDITOR.tools.bind(e.onKeyDown,e),e.show(),e},destroy:function(){this.element&&this.element.remove()}},CKEDITOR.ui.panel.block=CKEDITOR.tools.createClass({$:function(e,t){this.element=e.append(e.getDocument().createElement("div",{attributes:{tabindex:-1,class:"cke_panel_block"},styles:{display:"none"}})),t&&CKEDITOR.tools.extend(this,t),this.element.setAttributes({role:this.attributes.role||"presentation","aria-label":this.attributes["aria-label"],title:this.attributes.title||this.attributes["aria-label"]}),this.keys={},this._.focusIndex=-1,this.element.disableContextMenu()},_:{markItem:function(e){-1!=e&&(e=this.element.getElementsByTag("a").getItem(this._.focusIndex=e),CKEDITOR.env.webkit&&e.getDocument().getWindow().focus(),e.focus(),this.onMark&&this.onMark(e))}},proto:{show:function(){this.element.setStyle("display","")},hide:function(){this.onHide&&!0===this.onHide.call(this)||this.element.setStyle("display","none")},onKeyDown:function(e,t){switch(r=this.keys[e]){case"next":for(var n,i=this._.focusIndex,r=this.element.getElementsByTag("a");n=r.getItem(++i);)if(n.getAttribute("_cke_focus")&&n.$.offsetWidth){this._.focusIndex=i,n.focus();break}return!n&&!t&&(this._.focusIndex=-1,this.onKeyDown(e,1));case"prev":for(i=this._.focusIndex,r=this.element.getElementsByTag("a");0<i&&(n=r.getItem(--i));){if(n.getAttribute("_cke_focus")&&n.$.offsetWidth){this._.focusIndex=i,n.focus();break}n=null}return!n&&!t&&(this._.focusIndex=r.count(),this.onKeyDown(e,1));case"click":case"mouseup":return(n=0<=(i=this._.focusIndex)&&this.element.getElementsByTag("a").getItem(i))&&(n.$[r]?n.$[r]():n.$["on"+r]()),!1}return!0}}})}(),CKEDITOR.plugins.add("floatpanel",{requires:"panel"}),function(){function e(e,n,i,r,a){a=CKEDITOR.tools.genKey(n.getUniqueId(),i.getUniqueId(),e.lang.dir,e.uiColor||"",r.css||"",a||"");var o=t[a];return o||((o=t[a]=new CKEDITOR.ui.panel(n,r)).element=i.append(CKEDITOR.dom.element.createFromHtml(o.render(e),n)),o.element.setStyles({display:"none",position:"absolute"})),o}var t={};CKEDITOR.ui.floatPanel=CKEDITOR.tools.createClass({$:function(t,n,i,r){function a(){u.hide()}i.forceIFrame=1,i.toolbarRelated&&t.elementMode==CKEDITOR.ELEMENT_MODE_INLINE&&(n=CKEDITOR.document.getById("cke_"+t.name));var o=n.getDocument(),s=(r=e(t,o,n,i,r||0)).element,l=s.getFirst(),u=this;s.disableContextMenu(),this.element=s,this._={editor:t,panel:r,parentElement:n,definition:i,document:o,iframe:l,children:[],dir:t.lang.dir,showBlockParams:null},t.on("mode",a),t.on("resize",a),o.getWindow().on("resize",function(){this.reposition()},this)},proto:{addBlock:function(e,t){return this._.panel.addBlock(e,t)},addListBlock:function(e,t){return this._.panel.addListBlock(e,t)},getBlock:function(e){return this._.panel.getBlock(e)},showBlock:function(e,t,n,i,r,a){var o=this._.panel,s=o.showBlock(e);this._.showBlockParams=[].slice.call(arguments),this.allowBlur(!1);var l=this._.editor.editable();this._.returnFocus=l.hasFocus?l:new CKEDITOR.dom.element(CKEDITOR.document.$.activeElement),this._.hideTimeout=0;var u=this.element,c=(l=this._.iframe,l=CKEDITOR.env.ie&&!CKEDITOR.env.edge?l:new CKEDITOR.dom.window(l.$.contentWindow),u.getDocument()),d=this._.parentElement.getPositionedAncestor(),h=t.getDocumentPosition(c),p=(c=d?d.getDocumentPosition(c):{x:0,y:0},"rtl"==this._.dir),f=h.x+(i||0)-c.x,g=h.y+(r||0)-c.y;!p||1!=n&&4!=n?p||2!=n&&3!=n||(f+=t.$.offsetWidth-1):f+=t.$.offsetWidth,3!=n&&4!=n||(g+=t.$.offsetHeight-1),this._.panel._.offsetParentId=t.getId(),u.setStyles({top:g+"px",left:0,display:""}),u.setOpacity(0),u.getFirst().removeStyle("width"),this._.editor.focusManager.add(l),this._.blurSet||(CKEDITOR.event.useCapture=!0,l.on("blur",function(e){function t(){delete this._.returnFocus,this.hide()}this.allowBlur()&&e.data.getPhase()==CKEDITOR.EVENT_PHASE_AT_TARGET&&this.visible&&!this._.activeChild&&(CKEDITOR.env.iOS?this._.hideTimeout||(this._.hideTimeout=CKEDITOR.tools.setTimeout(t,0,this)):t.call(this))},this),l.on("focus",function(){this._.focused=!0,this.hideChild(),this.allowBlur(!0)},this),CKEDITOR.env.iOS&&(l.on("touchstart",function(){clearTimeout(this._.hideTimeout)},this),l.on("touchend",function(){this._.hideTimeout=0,this.focus()},this)),CKEDITOR.event.useCapture=!1,this._.blurSet=1),o.onEscape=CKEDITOR.tools.bind(function(e){if(this.onEscape&&!1===this.onEscape(e))return!1},this),CKEDITOR.tools.setTimeout(function(){var e=CKEDITOR.tools.bind(function(){if((n=u).removeStyle("width"),s.autoSize){var e=s.element.getDocument();e=(CKEDITOR.env.webkit||CKEDITOR.env.edge?s.element:e.getBody()).$.scrollWidth,CKEDITOR.env.ie&&CKEDITOR.env.quirks&&0<e&&(e+=(n.$.offsetWidth||0)-(n.$.clientWidth||0)+3),n.setStyle("width",e+10+"px"),e=s.element.$.scrollHeight,CKEDITOR.env.ie&&CKEDITOR.env.quirks&&0<e&&(e+=(n.$.offsetHeight||0)-(n.$.clientHeight||0)+3),n.setStyle("height",e+"px"),o._.currentBlock.element.setStyle("display","none").removeStyle("display")}else n.removeStyle("height");p&&(f-=u.$.offsetWidth),u.setStyle("left",f+"px"),e=o.element.getWindow();var t,n=u.$.getBoundingClientRect(),i=(e=e.getViewPaneSize(),n.width||n.right-n.left),r=n.height||n.bottom-n.top,l=p?n.right:e.width-n.left,c=p?e.width-n.right:n.left;p?l<i&&(f=c>i?f+i:e.width>i?f-n.left:f-n.right+e.width):l<i&&(f=c>i?f-i:e.width>i?f-n.right+e.width:f-n.left),i=n.top,e.height-n.top<r&&(g=i>r?g-r:e.height>r?g-n.bottom+e.height:g-n.top),CKEDITOR.env.ie&&("html"==(e=n=new CKEDITOR.dom.element(u.$.offsetParent)).getName()&&(e=e.getDocument().getBody()),"rtl"==e.getComputedStyle("direction")&&(f=CKEDITOR.env.ie8Compat?f-2*u.getDocument().getDocumentElement().$.scrollLeft:f-(n.$.scrollWidth-n.$.clientWidth))),(t=(n=u.getFirst()).getCustomData("activePanel"))&&t.onHide&&t.onHide.call(this,1),n.setCustomData("activePanel",this),u.setStyles({top:g+"px",left:f+"px"}),u.setOpacity(1),a&&a()},this);o.isLoaded?e():o.onLoad=e,CKEDITOR.tools.setTimeout(function(){var e=CKEDITOR.env.webkit&&CKEDITOR.document.getWindow().getScrollPosition().y;this.focus(),s.element.focus(),CKEDITOR.env.webkit&&(CKEDITOR.document.getBody().$.scrollTop=e),this.allowBlur(!0),this._.editor.fire("panelShow",this)},0,this)},CKEDITOR.env.air?200:0,this),this.visible=1,this.onShow&&this.onShow.call(this)},reposition:function(){var e=this._.showBlockParams;this.visible&&this._.showBlockParams&&(this.hide(),this.showBlock.apply(this,e))},focus:function(){if(CKEDITOR.env.webkit){var e=CKEDITOR.document.getActive();e&&!e.equals(this._.iframe)&&e.$.blur()}(this._.lastFocused||this._.iframe.getFrameDocument().getWindow()).focus()},blur:function(){var e=this._.iframe.getFrameDocument().getActive();e&&e.is("a")&&(this._.lastFocused=e)},hide:function(e){!this.visible||this.onHide&&!0===this.onHide.call(this)||(this.hideChild(),CKEDITOR.env.gecko&&this._.iframe.getFrameDocument().$.activeElement.blur(),this.element.setStyle("display","none"),this.visible=0,this.element.getFirst().removeCustomData("activePanel"),(e=e&&this._.returnFocus)&&(CKEDITOR.env.webkit&&e.type&&e.getWindow().$.focus(),e.focus()),delete this._.lastFocused,this._.showBlockParams=null,this._.editor.fire("panelHide",this))},allowBlur:function(e){var t=this._.panel;return void 0!==e&&(t.allowBlur=e),t.allowBlur},showAsChild:function(e,t,n,i,r,a){this._.activeChild==e&&e._.panel._.offsetParentId==n.getId()||(this.hideChild(),e.onHide=CKEDITOR.tools.bind(function(){CKEDITOR.tools.setTimeout(function(){this._.focused||this.hide()},0,this)},this),this._.activeChild=e,this._.focused=!1,e.showBlock(t,n,i,r,a),this.blur(),(CKEDITOR.env.ie7Compat||CKEDITOR.env.ie6Compat)&&setTimeout(function(){e.element.getChild(0).$.style.cssText+=""},100))},hideChild:function(e){var t=this._.activeChild;t&&(delete t.onHide,delete this._.activeChild,t.hide(),e&&this.focus())}}}),CKEDITOR.on("instanceDestroyed",function(){var e,n=CKEDITOR.tools.isEmpty(CKEDITOR.instances);for(e in t){var i=t[e];n?i.destroy():i.element.hide()}n&&(t={})})}(),CKEDITOR.plugins.add("menu",{requires:"floatpanel",beforeInit:function(e){for(var t=e.config.menu_groups.split(","),n=e._.menuGroups={},i=e._.menuItems={},r=0;r<t.length;r++)n[t[r]]=r+1;e.addMenuGroup=function(e,t){n[e]=t||100},e.addMenuItem=function(e,t){n[t.group]&&(i[e]=new CKEDITOR.menuItem(this,e,t))},e.addMenuItems=function(e){for(var t in e)this.addMenuItem(t,e[t])},e.getMenuItem=function(e){return i[e]},e.removeMenuItem=function(e){delete i[e]}}}),function(){var e='<span class="cke_menuitem"><a id="{id}" class="cke_menubutton cke_menubutton__{name} cke_menubutton_{state} {cls}" href="{href}" title="{title}" tabindex="-1" _cke_focus=1 hidefocus="true" role="{role}" aria-label="{label}" aria-describedby="{id}_description" aria-haspopup="{hasPopup}" aria-disabled="{disabled}" {ariaChecked} draggable="false"';CKEDITOR.env.gecko&&CKEDITOR.env.mac&&(e+=' onkeypress="return false;"'),CKEDITOR.env.gecko&&(e+=' onblur="this.style.cssText = this.style.cssText;" ondragstart="return false;"'),e=e+' onmouseover="CKEDITOR.tools.callFunction({hoverFn},{index});" onmouseout="CKEDITOR.tools.callFunction({moveOutFn},{index});" '+(CKEDITOR.env.ie?'onclick="return false;" onmouseup':"onclick")+'="CKEDITOR.tools.callFunction({clickFn},{index}); return false;">';var t=CKEDITOR.addTemplate("menuItem",e+'<span class="cke_menubutton_inner"><span class="cke_menubutton_icon"><span class="cke_button_icon cke_button__{iconName}_icon" style="{iconStyle}"></span></span><span class="cke_menubutton_label">{label}</span>{shortcutHtml}{arrowHtml}</span></a><span id="{id}_description" class="cke_voice_label" aria-hidden="false">{ariaShortcut}</span></span>'),n=CKEDITOR.addTemplate("menuArrow",'<span class="cke_menuarrow"><span>{label}</span></span>'),i=CKEDITOR.addTemplate("menuShortcut",'<span class="cke_menubutton_label cke_menubutton_shortcut">{shortcut}</span>');CKEDITOR.menu=CKEDITOR.tools.createClass({$:function(e,t){t=this._.definition=t||{},this.id=CKEDITOR.tools.getNextId(),this.editor=e,this.items=[],this._.listeners=[],this._.level=t.level||1;var n=CKEDITOR.tools.extend({},t.panel,{css:[CKEDITOR.skin.getPath("editor")],level:this._.level-1,block:{}}),i=n.block.attributes=n.attributes||{};!i.role&&(i.role="menu"),this._.panelDefinition=n},_:{onShow:function(){var e=this.editor.getSelection(),t=e&&e.getStartElement(),n=this.editor.elementPath(),i=this._.listeners;this.removeAll();for(var r=0;r<i.length;r++){var a=i[r](t,e,n);if(a)for(var o in a){var s=this.editor.getMenuItem(o);!s||s.command&&!this.editor.getCommand(s.command).state||(s.state=a[o],this.add(s))}}},onClick:function(e){this.hide(),e.onClick?e.onClick():e.command&&this.editor.execCommand(e.command)},onEscape:function(e){var t=this.parent;return t?t._.panel.hideChild(1):27==e&&this.hide(1),!1},onHide:function(){this.onHide&&this.onHide()},showSubMenu:function(e){var t=this._.subMenu,n=this.items[e];if(n=n.getItems&&n.getItems()){for(var i in t?t.removeAll():((t=this._.subMenu=new CKEDITOR.menu(this.editor,CKEDITOR.tools.extend({},this._.definition,{level:this._.level+1},!0))).parent=this,t._.onClick=CKEDITOR.tools.bind(this._.onClick,this)),n){var r=this.editor.getMenuItem(i);r&&(r.state=n[i],t.add(r))}var a=this._.panel.getBlock(this.id).element.getDocument().getById(this.id+String(e));setTimeout(function(){t.show(a,2)},0)}else this._.panel.hideChild(1)}},proto:{add:function(e){e.order||(e.order=this.items.length),this.items.push(e)},removeAll:function(){this.items=[]},show:function(e,t,n,i){if(this.parent||(this._.onShow(),this.items.length)){t=t||("rtl"==this.editor.lang.dir?2:1);var r=this.items,a=this.editor,o=this._.panel,s=this._.element;o||((o=this._.panel=new CKEDITOR.ui.floatPanel(this.editor,CKEDITOR.document.getBody(),this._.panelDefinition,this._.level)).onEscape=CKEDITOR.tools.bind(function(e){if(!1===this._.onEscape(e))return!1},this),o.onShow=function(){o._.panel.getHolderElement().getParent().addClass("cke").addClass("cke_reset_all")},o.onHide=CKEDITOR.tools.bind(function(){this._.onHide&&this._.onHide()},this),(s=o.addBlock(this.id,this._.panelDefinition.block)).autoSize=!0,(l=s.keys)[40]="next",l[9]="next",l[38]="prev",l[CKEDITOR.SHIFT+9]="prev",l["rtl"==a.lang.dir?37:39]=CKEDITOR.env.ie?"mouseup":"click",l[32]=CKEDITOR.env.ie?"mouseup":"click",CKEDITOR.env.ie&&(l[13]="mouseup"),(l=(s=this._.element=s.element).getDocument()).getBody().setStyle("overflow","hidden"),l.getElementsByTag("html").getItem(0).setStyle("overflow","hidden"),this._.itemOverFn=CKEDITOR.tools.addFunction(function(e){clearTimeout(this._.showSubTimeout),this._.showSubTimeout=CKEDITOR.tools.setTimeout(this._.showSubMenu,a.config.menu_subMenuDelay||400,this,[e])},this),this._.itemOutFn=CKEDITOR.tools.addFunction(function(){clearTimeout(this._.showSubTimeout)},this),this._.itemClickFn=CKEDITOR.tools.addFunction(function(e){var t=this.items[e];t.state==CKEDITOR.TRISTATE_DISABLED?this.hide(1):t.getItems?this._.showSubMenu(e):this._.onClick(t)},this)),r.sort(function(e,t){return e.group<t.group?-1:e.group>t.group?1:e.order<t.order?-1:e.order>t.order?1:0});for(var l=['<div class="cke_menu'+((l=a.elementPath())&&l.direction()!=a.lang.dir?" cke_mixed_dir_content":"")+'" role="presentation">'],u=r.length,c=u&&r[0].group,d=0;d<u;d++){var h=r[d];c!=h.group&&(l.push('<div class="cke_menuseparator" role="separator"></div>'),c=h.group),h.render(this,d,l)}l.push("</div>"),s.setHtml(l.join("")),CKEDITOR.ui.fire("ready",this),this.parent?this.parent._.panel.showAsChild(o,this.id,e,t,n,i):o.showBlock(this.id,e,t,n,i),a.fire("menuShow",[o])}},addListener:function(e){this._.listeners.push(e)},hide:function(e){this._.onHide&&this._.onHide(),this._.panel&&this._.panel.hide(e)}}}),CKEDITOR.menuItem=CKEDITOR.tools.createClass({$:function(e,t,n){CKEDITOR.tools.extend(this,n,{order:0,className:"cke_menubutton__"+t}),this.group=e._.menuGroups[this.group],this.editor=e,this.name=t},proto:{render:function(e,r,a){var o,s,l=e.id+String(r),u=void 0===this.state?CKEDITOR.TRISTATE_OFF:this.state,c="",d=this.editor,h=u==CKEDITOR.TRISTATE_ON?"on":u==CKEDITOR.TRISTATE_DISABLED?"disabled":"off";this.role in{menuitemcheckbox:1,menuitemradio:1}&&(c=' aria-checked="'+(u==CKEDITOR.TRISTATE_ON?"true":"false")+'"');var p=this.getItems,f="&#"+("rtl"==this.editor.lang.dir?"9668":"9658")+";",g=this.name;this.icon&&!/\./.test(this.icon)&&(g=this.icon),this.command&&(o=d.getCommand(this.command),(o=d.getCommandKeystroke(o))&&(s=CKEDITOR.tools.keystrokeToString(d.lang.common.keyboard,o))),e={id:l,name:this.name,iconName:g,label:this.label,cls:this.className||"",state:h,hasPopup:p?"true":"false",disabled:u==CKEDITOR.TRISTATE_DISABLED,title:this.label+(s?" ("+s.display+")":""),ariaShortcut:s?d.lang.common.keyboardShortcut+" "+s.aria:"",href:"javascript:void('"+(this.label||"").replace("'")+"')",hoverFn:e._.itemOverFn,moveOutFn:e._.itemOutFn,clickFn:e._.itemClickFn,index:r,iconStyle:CKEDITOR.skin.getIconStyle(g,"rtl"==this.editor.lang.dir,g==this.icon?null:this.icon,this.iconOffset),shortcutHtml:s?i.output({shortcut:s.display}):"",arrowHtml:p?n.output({label:f}):"",role:this.role?this.role:"menuitem",ariaChecked:c},t.output(e,a)}}})}(),CKEDITOR.config.menu_groups="clipboard,form,tablecell,tablecellproperties,tablerow,tablecolumn,table,anchor,link,image,flash,checkbox,radio,textfield,hiddenfield,imagebutton,button,select,textarea,div",CKEDITOR.plugins.add("contextmenu",{requires:"menu",onLoad:function(){CKEDITOR.plugins.contextMenu=CKEDITOR.tools.createClass({base:CKEDITOR.menu,$:function(e){this.base.call(this,e,{panel:{className:"cke_menu_panel",attributes:{"aria-label":e.lang.contextmenu.options}}})},proto:{addTarget:function(e,t){if(e.on("contextmenu",function(e){e=e.data;var i=CKEDITOR.env.webkit?n:CKEDITOR.env.mac?e.$.metaKey:e.$.ctrlKey;if(!t||!i){e.preventDefault(),CKEDITOR.env.mac&&CKEDITOR.env.webkit&&(i=this.editor,(r=new CKEDITOR.dom.elementPath(e.getTarget(),i.editable()).contains(function(e){return e.hasAttribute("contenteditable")},!0))&&"false"==r.getAttribute("contenteditable")&&i.getSelection().fake(r));var r=e.getTarget().getDocument(),a=e.getTarget().getDocument().getDocumentElement(),o=(i=!r.equals(CKEDITOR.document),r=r.getWindow().getScrollPosition(),i?e.$.clientX:e.$.pageX||r.x+e.$.clientX),s=i?e.$.clientY:e.$.pageY||r.y+e.$.clientY;CKEDITOR.tools.setTimeout(function(){this.open(a,null,o,s)},CKEDITOR.env.ie?200:0,this)}},this),CKEDITOR.env.webkit){var n,i=function(){n=0};e.on("keydown",function(e){n=CKEDITOR.env.mac?e.data.$.metaKey:e.data.$.ctrlKey}),e.on("keyup",i),e.on("contextmenu",i)}},open:function(e,t,n,i){this.editor.focus(),e=e||CKEDITOR.document.getDocumentElement(),this.editor.selectionChange(1),this.show(e,t,n,i)}}})},beforeInit:function(e){var t=e.contextMenu=new CKEDITOR.plugins.contextMenu(e);e.on("contentDom",function(){t.addTarget(e.editable(),!1!==e.config.browserContextMenuOnCtrl)}),e.addCommand("contextMenu",{exec:function(){e.contextMenu.open(e.document.getBody())}}),e.setKeystroke(CKEDITOR.SHIFT+121,"contextMenu"),e.setKeystroke(CKEDITOR.CTRL+CKEDITOR.SHIFT+121,"contextMenu")}}),function(){function e(e,n){function r(t){var n;(t=l.list[t]).equals(e.editable())||"true"==t.getAttribute("contenteditable")?((n=e.createRange()).selectNodeContents(t),n=n.select()):(n=e.getSelection()).selectElement(t),CKEDITOR.env.ie&&e.fire("selectionChange",{selection:n,path:new CKEDITOR.dom.elementPath(t)}),e.focus()}function a(){o&&o.setHtml('<span class="cke_path_empty">&nbsp;</span>'),delete l.list}var o,s=e.ui.spaceId("path"),l=e._.elementsPath,u=l.idBase;n.html+='<span id="'+s+'_label" class="cke_voice_label">'+e.lang.elementspath.eleLabel+'</span><span id="'+s+'" class="cke_path" role="group" aria-labelledby="'+s+'_label"><span class="cke_path_empty">&nbsp;</span></span>',e.on("uiReady",function(){var t=e.ui.space("path");t&&e.focusManager.add(t,1)}),l.onClick=r;var c=CKEDITOR.tools.addFunction(r),d=CKEDITOR.tools.addFunction(function(t,n){var i,a=l.idBase;switch(n=new CKEDITOR.dom.event(n),i="rtl"==e.lang.dir,n.getKeystroke()){case i?39:37:case 9:return(i=CKEDITOR.document.getById(a+(t+1)))||(i=CKEDITOR.document.getById(a+"0")),i.focus(),!1;case i?37:39:case CKEDITOR.SHIFT+9:return(i=CKEDITOR.document.getById(a+(t-1)))||(i=CKEDITOR.document.getById(a+(l.list.length-1))),i.focus(),!1;case 27:return e.focus(),!1;case 13:case 32:return r(t),!1}return!0});e.on("selectionChange",function(){for(var t,n=[],r=l.list=[],a=[],h=l.filters,p=!0,f=e.elementPath().elements,g=f.length;g--;){var m=f[g],v=0;t=m.data("cke-display-name")?m.data("cke-display-name"):m.data("cke-real-element-type")?m.data("cke-real-element-type"):m.getName(),(p=m.hasAttribute("contenteditable")?"true"==m.getAttribute("contenteditable"):p)||m.hasAttribute("contenteditable")||(v=1);for(var y=0;y<h.length;y++){var b=h[y](m,t);if(!1===b){v=1;break}t=b||t}v||(r.unshift(m),a.unshift(t))}for(r=r.length,h=0;h<r;h++)t=a[h],p=e.lang.elementspath.eleTitle.replace(/%1/,t),t=i.output({id:u+h,label:p,text:t,jsTitle:"javascript:void('"+t+"')",index:h,keyDownFn:d,clickFn:c}),n.unshift(t);o||(o=CKEDITOR.document.getById(s)),(a=o).setHtml(n.join("")+'<span class="cke_path_empty">&nbsp;</span>'),e.fire("elementsPathUpdate",{space:a})}),e.on("readOnly",a),e.on("contentDomUnload",a),e.addCommand("elementsPathFocus",t.toolbarFocus),e.setKeystroke(CKEDITOR.ALT+122,"elementsPathFocus")}var t={toolbarFocus:{editorFocus:!1,readOnly:1,exec:function(e){(e=CKEDITOR.document.getById(e._.elementsPath.idBase+"0"))&&e.focus(CKEDITOR.env.ie||CKEDITOR.env.air)}}},n="";CKEDITOR.env.gecko&&CKEDITOR.env.mac&&(n+=' onkeypress="return false;"'),CKEDITOR.env.gecko&&(n+=' onblur="this.style.cssText = this.style.cssText;"');var i=CKEDITOR.addTemplate("pathItem",'<a id="{id}" href="{jsTitle}" tabindex="-1" class="cke_path_item" title="{label}"'+n+' hidefocus="true"  onkeydown="return CKEDITOR.tools.callFunction({keyDownFn},{index}, event );" onclick="CKEDITOR.tools.callFunction({clickFn},{index}); return false;" role="button" aria-label="{label}">{text}</a>');CKEDITOR.plugins.add("elementspath",{init:function(t){t._.elementsPath={idBase:"cke_elementspath_"+CKEDITOR.tools.getNextNumber()+"_",filters:[]},t.on("uiSpace",function(n){"bottom"==n.data.space&&e(t,n.data)})}})}(),function(){function e(e,i){var r,a;i.on("refresh",function(e){var i,r=[t];for(i in e.data.states)r.push(e.data.states[i]);this.setState(CKEDITOR.tools.search(r,n)?n:t)},i,null,100),i.on("exec",function(t){r=e.getSelection(),a=r.createBookmarks(1),t.data||(t.data={}),t.data.done=!1},i,null,0),i.on("exec",function(){e.forceNextSelectionCheck(),r.selectBookmarks(a)},i,null,100)}var t=CKEDITOR.TRISTATE_DISABLED,n=CKEDITOR.TRISTATE_OFF;CKEDITOR.plugins.add("indent",{init:function(t){var n=CKEDITOR.plugins.indent.genericDefinition;e(t,t.addCommand("indent",new n(!0))),e(t,t.addCommand("outdent",new n)),t.ui.addButton&&(t.ui.addButton("Indent",{label:t.lang.indent.indent,command:"indent",directional:!0,toolbar:"indent,20"}),t.ui.addButton("Outdent",{label:t.lang.indent.outdent,command:"outdent",directional:!0,toolbar:"indent,10"})),t.on("dirChanged",function(e){var n=t.createRange(),i=e.data.node;n.setStartBefore(i),n.setEndAfter(i);for(var r,a=new CKEDITOR.dom.walker(n);r=a.next();)if(r.type==CKEDITOR.NODE_ELEMENT)if(!r.equals(i)&&r.getDirection())n.setStartAfter(r),a=new CKEDITOR.dom.walker(n);else{var o=t.config.indentClasses;if(o)for(var s="ltr"==e.data.dir?["_rtl",""]:["","_rtl"],l=0;l<o.length;l++)r.hasClass(o[l]+s[0])&&(r.removeClass(o[l]+s[0]),r.addClass(o[l]+s[1]));o=r.getStyle("margin-right"),s=r.getStyle("margin-left"),o?r.setStyle("margin-left",o):r.removeStyle("margin-left"),s?r.setStyle("margin-right",s):r.removeStyle("margin-right")}})}}),CKEDITOR.plugins.indent={genericDefinition:function(e){this.isIndent=!!e,this.startDisabled=!this.isIndent},specificDefinition:function(e,t,n){this.name=t,this.editor=e,this.jobs={},this.enterBr=e.config.enterMode==CKEDITOR.ENTER_BR,this.isIndent=!!n,this.relatedGlobal=n?"indent":"outdent",this.indentKey=n?9:CKEDITOR.SHIFT+9,this.database={}},registerCommands:function(e,t){e.on("pluginsLoaded",function(){for(var e in t)!function(e,t){var n,i=e.getCommand(t.relatedGlobal);for(n in t.jobs)i.on("exec",function(i){i.data.done||(e.fire("lockSnapshot"),t.execJob(e,n)&&(i.data.done=!0),e.fire("unlockSnapshot"),CKEDITOR.dom.element.clearAllMarkers(t.database))},this,null,n),i.on("refresh",function(i){i.data.states||(i.data.states={}),i.data.states[t.name+"@"+n]=t.refreshJob(e,n,i.data.path)},this,null,n);e.addFeature(t)}(this,t[e])})}},CKEDITOR.plugins.indent.genericDefinition.prototype={context:"p",exec:function(){}},CKEDITOR.plugins.indent.specificDefinition.prototype={execJob:function(e,n){var i=this.jobs[n];if(i.state!=t)return i.exec.call(this,e)},refreshJob:function(e,n,i){return n=this.jobs[n],e.activeFilter.checkFeature(this)?n.state=n.refresh.call(this,e,i):n.state=t,n.state},getContext:function(e){return e.contains(this.context)}}}(),function(){function e(e){function i(t){for(var i=r.startContainer,l=r.endContainer;i&&!i.getParent().equals(t);)i=i.getParent();for(;l&&!l.getParent().equals(t);)l=l.getParent();if(!i||!l)return!1;for(var u=i,c=(i=[],!1);!c;)u.equals(l)&&(c=!0),i.push(u),u=u.getNext();if(1>i.length)return!1;for(u=t.getParents(!0),l=0;l<u.length;l++)if(u[l].getName&&s[u[l].getName()]){t=u[l];break}u=a.isIndent?1:-1,l=i[0],i=i[i.length-1];var d,h=(c=CKEDITOR.plugins.list.listToArray(t,o))[i.getCustomData("listarray_index")].indent;for(l=l.getCustomData("listarray_index");l<=i.getCustomData("listarray_index");l++)if(c[l].indent+=u,0<u){var p=c[l].parent;c[l].parent=new CKEDITOR.dom.element(p.getName(),p.getDocument())}for(l=i.getCustomData("listarray_index")+1;l<c.length&&c[l].indent>h;l++)c[l].indent+=u;if(i=CKEDITOR.plugins.list.arrayToList(c,o,null,e.config.enterMode,t.getDirection()),!a.isIndent&&(d=t.getParent())&&d.is("li")){var f,g=[];for(l=(u=i.listNode.getChildren()).count()-1;0<=l;l--)(f=u.getItem(l))&&f.is&&f.is("li")&&g.push(f)}if(i&&i.listNode.replace(t),g&&g.length)for(l=0;l<g.length;l++){for(f=t=g[l];(f=f.getNext())&&f.is&&f.getName()in s;)CKEDITOR.env.needsNbspFiller&&!t.getFirst(n)&&t.append(r.document.createText(" ")),t.append(f);t.insertAfter(d)}return i&&e.fire("contentDomInvalidated"),!0}for(var r,a=this,o=this.database,s=this.context,l=((l=e.getSelection())&&l.getRanges()).createIterator();r=l.getNextRange();){for(var u=r.getCommonAncestor();u&&(u.type!=CKEDITOR.NODE_ELEMENT||!s[u.getName()]);){if(e.editable().equals(u)){u=!1;break}u=u.getParent()}if(u||(u=r.startPath().contains(s))&&r.setEndAt(u,CKEDITOR.POSITION_BEFORE_END),!u){var c=r.getEnclosedNode();c&&c.type==CKEDITOR.NODE_ELEMENT&&c.getName()in s&&(r.setStartAt(c,CKEDITOR.POSITION_AFTER_START),r.setEndAt(c,CKEDITOR.POSITION_BEFORE_END),u=c)}if(u&&r.startContainer.type==CKEDITOR.NODE_ELEMENT&&r.startContainer.getName()in s&&((c=new CKEDITOR.dom.walker(r)).evaluator=t,r.startContainer=c.next()),u&&r.endContainer.type==CKEDITOR.NODE_ELEMENT&&r.endContainer.getName()in s&&((c=new CKEDITOR.dom.walker(r)).evaluator=t,r.endContainer=c.previous()),u)return i(u)}return 0}function t(e){return e.type==CKEDITOR.NODE_ELEMENT&&e.is("li")}function n(e){return i(e)&&r(e)}var i=CKEDITOR.dom.walker.whitespaces(!0),r=CKEDITOR.dom.walker.bookmark(!1,!0),a=CKEDITOR.TRISTATE_DISABLED,o=CKEDITOR.TRISTATE_OFF;CKEDITOR.plugins.add("indentlist",{requires:"indent",init:function(t){function n(t){i.specificDefinition.apply(this,arguments),this.requiredContent=["ul","ol"],t.on("key",function(e){if("wysiwyg"==t.mode&&e.data.keyCode==this.indentKey){var n=this.getContext(t.elementPath());!n||this.isIndent&&CKEDITOR.plugins.indentList.firstItemInPath(this.context,t.elementPath(),n)||(t.execCommand(this.relatedGlobal),e.cancel())}},this),this.jobs[this.isIndent?10:30]={refresh:this.isIndent?function(e,t){var n=this.getContext(t),i=CKEDITOR.plugins.indentList.firstItemInPath(this.context,t,n);return n&&this.isIndent&&!i?o:a}:function(e,t){return!this.getContext(t)||this.isIndent?a:o},exec:CKEDITOR.tools.bind(e,this)}}var i=CKEDITOR.plugins.indent;i.registerCommands(t,{indentlist:new n(t,"indentlist",!0),outdentlist:new n(t,"outdentlist")}),CKEDITOR.tools.extend(n.prototype,i.specificDefinition.prototype,{context:{ol:1,ul:1}})}}),CKEDITOR.plugins.indentList={},CKEDITOR.plugins.indentList.firstItemInPath=function(e,n,i){var r=n.contains(t);return i||(i=n.contains(e)),i&&r&&r.equals(i.getFirst(t))}}(),function(){function e(e,t,n){function i(n){!(l=c[n?"getFirst":"getLast"]())||l.is&&l.isBlockBoundary()||!(u=t.root[n?"getPrevious":"getNext"](CKEDITOR.dom.walker.invisible(!0)))||u.is&&u.isBlockBoundary({br:1})||e.document.createElement("br")[n?"insertBefore":"insertAfter"](l)}for(var r=CKEDITOR.plugins.list.listToArray(t.root,n),a=[],o=0;o<t.contents.length;o++){var s=t.contents[o];(s=s.getAscendant("li",!0))&&!s.getCustomData("list_item_processed")&&(a.push(s),CKEDITOR.dom.element.setMarker(n,s,"list_item_processed",!0))}for(s=null,o=0;o<a.length;o++)r[s=a[o].getCustomData("listarray_index")].indent=-1;for(o=s+1;o<r.length;o++)if(r[o].indent>r[o-1].indent+1){for(a=r[o-1].indent+1-r[o].indent,s=r[o].indent;r[o]&&r[o].indent>=s;)r[o].indent+=a,o++;o--}var l,u,c=CKEDITOR.plugins.list.arrayToList(r,n,null,e.config.enterMode,t.root.getAttribute("dir")).listNode;i(!0),i(),c.replace(t.root),e.fire("contentDomInvalidated")}function t(e,t){this.name=e,this.context=this.type=t,this.allowedContent=t+" li",this.requiredContent=t}function n(e,t,n,i){for(var r,a;r=e[i?"getLast":"getFirst"](p);)(a=r.getDirection(1))!==t.getDirection(1)&&r.setAttribute("dir",a),r.remove(),n?r[i?"insertBefore":"insertAfter"](n):t.append(r,i)}function i(e){function t(t){var i=e[t?"getPrevious":"getNext"](c);i&&i.type==CKEDITOR.NODE_ELEMENT&&i.is(e.getName())&&(n(e,i,null,!t),e.remove(),e=i)}t(),t(1)}function r(e){return e.type==CKEDITOR.NODE_ELEMENT&&(e.getName()in CKEDITOR.dtd.$block||e.getName()in CKEDITOR.dtd.$listItem)&&CKEDITOR.dtd[e.getName()]["#"]}function a(e,t,r){e.fire("saveSnapshot"),r.enlarge(CKEDITOR.ENLARGE_LIST_ITEM_CONTENTS);var a=r.extractContents();t.trim(!1,!0);var s=t.createBookmark(),l=(u=new CKEDITOR.dom.elementPath(t.startContainer)).block,u=u.lastElement.getAscendant("li",1)||l,h=(p=new CKEDITOR.dom.elementPath(r.startContainer)).contains(CKEDITOR.dtd.$listItem),p=p.contains(CKEDITOR.dtd.$list);for(l?(l=l.getBogus())&&l.remove():p&&(l=p.getPrevious(c))&&d(l)&&l.remove(),(l=a.getLast())&&l.type==CKEDITOR.NODE_ELEMENT&&l.is("br")&&l.remove(),(l=t.startContainer.getChild(t.startOffset))?a.insertBefore(l):t.startContainer.append(a),h&&(a=o(h))&&(u.contains(h)?(n(a,h.getParent(),h),a.remove()):u.append(a));r.checkStartOfBlock()&&r.checkEndOfBlock()&&(a=(p=r.startPath()).block);)a.is("li")&&(u=a.getParent(),a.equals(u.getLast(c))&&a.equals(u.getFirst(c))&&(a=u)),r.moveToPosition(a,CKEDITOR.POSITION_BEFORE_START),a.remove();r=r.clone(),a=e.editable(),r.setEndAt(a,CKEDITOR.POSITION_BEFORE_END),(r=new CKEDITOR.dom.walker(r)).evaluator=function(e){return c(e)&&!d(e)},(r=r.next())&&r.type==CKEDITOR.NODE_ELEMENT&&r.getName()in CKEDITOR.dtd.$list&&i(r),t.moveToBookmark(s),t.select(),e.fire("saveSnapshot")}function o(e){return(e=e.getLast(c))&&e.type==CKEDITOR.NODE_ELEMENT&&e.getName()in s?e:null}var s={ol:1,ul:1},l=CKEDITOR.dom.walker.whitespaces(),u=CKEDITOR.dom.walker.bookmark(),c=function(e){return!(l(e)||u(e))},d=CKEDITOR.dom.walker.bogus();CKEDITOR.plugins.list={listToArray:function(e,t,n,i,r){if(!s[e.getName()])return[];i||(i=0),n||(n=[]);for(var a=0,o=e.getChildCount();a<o;a++){var l=e.getChild(a);if(l.type==CKEDITOR.NODE_ELEMENT&&l.getName()in CKEDITOR.dtd.$list&&CKEDITOR.plugins.list.listToArray(l,t,n,i+1),"li"==l.$.nodeName.toLowerCase()){var u={parent:e,indent:i,element:l,contents:[]};r?u.grandparent=r:(u.grandparent=e.getParent(),u.grandparent&&"li"==u.grandparent.$.nodeName.toLowerCase()&&(u.grandparent=u.grandparent.getParent())),t&&CKEDITOR.dom.element.setMarker(t,l,"listarray_index",n.length),n.push(u);for(var c,d=0,h=l.getChildCount();d<h;d++)(c=l.getChild(d)).type==CKEDITOR.NODE_ELEMENT&&s[c.getName()]?CKEDITOR.plugins.list.listToArray(c,t,n,i+1,u.grandparent):u.contents.push(c)}}return n},arrayToList:function(e,t,n,i,r){if(n||(n=0),!e||e.length<n+1)return null;for(var a,o,l,d=e[n].parent.getDocument(),h=new CKEDITOR.dom.documentFragment(d),p=null,f=n,g=Math.max(e[n].indent,0),m=null,v=i==CKEDITOR.ENTER_P?"p":"div";;){var y=e[f];if(a=y.grandparent,o=y.element.getDirection(1),y.indent==g){for(p&&e[f].parent.getName()==p.getName()||(p=e[f].parent.clone(!1,1),r&&p.setAttribute("dir",r),h.append(p)),m=p.append(y.element.clone(0,1)),o!=p.getDirection(1)&&m.setAttribute("dir",o),a=0;a<y.contents.length;a++)m.append(y.contents[a].clone(1,1));f++}else if(y.indent==Math.max(g,0)+1)y=e[f-1].element.getDirection(1),f=CKEDITOR.plugins.list.arrayToList(e,null,f,i,y!=o?o:null),!m.getChildCount()&&CKEDITOR.env.needsNbspFiller&&7>=d.$.documentMode&&m.append(d.createText(" ")),m.append(f.listNode),f=f.nextIndex;else{if(-1!=y.indent||n||!a)return null;s[a.getName()]?(m=y.element.clone(!1,!0),o!=a.getDirection(1)&&m.setAttribute("dir",o)):m=new CKEDITOR.dom.documentFragment(d),p=a.getDirection(1)!=o;var b,_,T=y.element,E=T.getAttribute("class"),C=T.getAttribute("style"),w=m.type==CKEDITOR.NODE_DOCUMENT_FRAGMENT&&(i!=CKEDITOR.ENTER_BR||p||C||E),k=y.contents.length;for(a=0;a<k;a++)if(b=y.contents[a],u(b)&&1<k)w?_=b.clone(1,1):m.append(b.clone(1,1));else if(b.type==CKEDITOR.NODE_ELEMENT&&b.isBlockBoundary()){p&&!b.getDirection()&&b.setAttribute("dir",o),l=b;var S=T.getAttribute("style");S&&l.setAttribute("style",S.replace(/([^;])$/,"$1;")+(l.getAttribute("style")||"")),E&&b.addClass(E),l=null,_&&(m.append(_),_=null),m.append(b.clone(1,1))}else w?(l||(l=d.createElement(v),m.append(l),p&&l.setAttribute("dir",o)),C&&l.setAttribute("style",C),E&&l.setAttribute("class",E),_&&(l.append(_),_=null),l.append(b.clone(1,1))):m.append(b.clone(1,1));_&&((l||m).append(_),_=null),m.type==CKEDITOR.NODE_DOCUMENT_FRAGMENT&&f!=e.length-1&&(CKEDITOR.env.needsBrFiller&&(o=m.getLast())&&o.type==CKEDITOR.NODE_ELEMENT&&o.is("br")&&o.remove(),(o=m.getLast(c))&&o.type==CKEDITOR.NODE_ELEMENT&&o.is(CKEDITOR.dtd.$block)||m.append(d.createElement("br"))),"div"!=(o=m.$.nodeName.toLowerCase())&&"p"!=o||m.appendBogus(),h.append(m),p=null,f++}if(l=null,e.length<=f||Math.max(e[f].indent,0)<g)break}if(t)for(e=h.getFirst();e;){if(e.type==CKEDITOR.NODE_ELEMENT&&(CKEDITOR.dom.element.clearMarkers(t,e),e.getName()in CKEDITOR.dtd.$listItem&&(d=r=i=void 0,i=(n=e).getDirection()))){for(r=n.getParent();r&&!(d=r.getDirection());)r=r.getParent();i==d&&n.removeAttribute("dir")}e=e.getNextSourceNode()}return{listNode:h,nextIndex:f}}};var h=/^h[1-6]$/,p=CKEDITOR.dom.walker.nodeType(CKEDITOR.NODE_ELEMENT);t.prototype={exec:function(t){this.refresh(t,t.elementPath());var n=t.config,r=t.getSelection(),a=r&&r.getRanges();if(this.state==CKEDITOR.TRISTATE_OFF)if((l=t.editable()).getFirst(c)){var o=1==a.length&&a[0];(n=o&&o.getEnclosedNode())&&n.is&&this.type==n.getName()&&this.setState(CKEDITOR.TRISTATE_ON)}else n.enterMode==CKEDITOR.ENTER_BR?l.appendBogus():a[0].fixBlock(1,n.enterMode==CKEDITOR.ENTER_P?"p":"div"),r.selectRanges(a);n=r.createBookmarks(!0);for(var l=[],u={},d=(a=a.createIterator(),0);(o=a.getNextRange())&&++d;){var p=(_=o.getBoundaryNodes()).startNode,f=_.endNode;for(p.type==CKEDITOR.NODE_ELEMENT&&"td"==p.getName()&&o.setStartAt(_.startNode,CKEDITOR.POSITION_AFTER_START),f.type==CKEDITOR.NODE_ELEMENT&&"td"==f.getName()&&o.setEndAt(_.endNode,CKEDITOR.POSITION_BEFORE_END),(o=o.createIterator()).forceBrBreak=this.state==CKEDITOR.TRISTATE_OFF;_=o.getNextParagraph();)if(!_.getCustomData("list_block")){CKEDITOR.dom.element.setMarker(u,_,"list_block",1),p=(m=t.elementPath(_)).elements,f=0;for(var g,m=m.blockLimit,v=p.length-1;0<=v&&(g=p[v]);v--)if(s[g.getName()]&&m.contains(g)){m.removeCustomData("list_group_object_"+d),(p=g.getCustomData("list_group_object"))?p.contents.push(_):(p={root:g,contents:[_]},l.push(p),CKEDITOR.dom.element.setMarker(u,g,"list_group_object",p)),f=1;break}f||((f=m).getCustomData("list_group_object_"+d)?f.getCustomData("list_group_object_"+d).contents.push(_):(p={root:f,contents:[_]},CKEDITOR.dom.element.setMarker(u,f,"list_group_object_"+d,p),l.push(p)))}}for(g=[];0<l.length;)if(p=l.shift(),this.state==CKEDITOR.TRISTATE_OFF)if(s[p.root.getName()]){for(a=t,d=p,p=u,o=g,f=CKEDITOR.plugins.list.listToArray(d.root,p),m=[],_=0;_<d.contents.length;_++)(v=(v=d.contents[_]).getAscendant("li",!0))&&!v.getCustomData("list_item_processed")&&(m.push(v),CKEDITOR.dom.element.setMarker(p,v,"list_item_processed",!0));v=d.root.getDocument();for(var y=void 0,b=void 0,_=0;_<m.length;_++){var T=m[_].getCustomData("listarray_index");(y=f[T].parent).is(this.type)||(b=v.createElement(this.type),y.copyAttributes(b,{start:1,type:1}),b.removeStyle("list-style-type"),f[T].parent=b)}for(p=CKEDITOR.plugins.list.arrayToList(f,p,null,a.config.enterMode),f=void 0,m=p.listNode.getChildCount(),_=0;_<m&&(f=p.listNode.getChild(_));_++)f.getName()==this.type&&o.push(f);p.listNode.replace(d.root),a.fire("contentDomInvalidated")}else{for(f=t,_=g,m=(o=p).contents,a=o.root.getDocument(),d=[],1==m.length&&m[0].equals(o.root)&&(p=a.createElement("div"),m[0].moveChildren&&m[0].moveChildren(p),m[0].append(p),m[0]=p),o=o.contents[0].getParent(),v=0;v<m.length;v++)o=o.getCommonAncestor(m[v].getParent());for(y=f.config.useComputedState,f=p=void 0,y=void 0===y||y,v=0;v<m.length;v++)for(b=m[v];T=b.getParent();){if(T.equals(o)){d.push(b),!f&&b.getDirection()&&(f=1),b=b.getDirection(y),null!==p&&(p=p&&p!=b?null:b);break}b=T}if(!(1>d.length)){for(m=d[d.length-1].getNext(),v=a.createElement(this.type),_.push(v),y=_=void 0;d.length;)_=d.shift(),y=a.createElement("li"),(b=_).is("pre")||h.test(b.getName())||"false"==b.getAttribute("contenteditable")?_.appendTo(y):(_.copyAttributes(y),p&&_.getDirection()&&(y.removeStyle("direction"),y.removeAttribute("dir")),_.moveChildren(y),_.remove()),y.appendTo(v);p&&f&&v.setAttribute("dir",p),m?v.insertBefore(m):v.appendTo(o)}}else this.state==CKEDITOR.TRISTATE_ON&&s[p.root.getName()]&&e.call(this,t,p,u);for(v=0;v<g.length;v++)i(g[v]);CKEDITOR.dom.element.clearAllMarkers(u),r.selectBookmarks(n),t.focus()},refresh:function(e,t){var n=t.contains(s,1),i=t.blockLimit||t.root;n&&i.contains(n)?this.setState(n.is(this.type)?CKEDITOR.TRISTATE_ON:CKEDITOR.TRISTATE_OFF):this.setState(CKEDITOR.TRISTATE_OFF)}},CKEDITOR.plugins.add("list",{requires:"indentlist",init:function(e){e.blockless||(e.addCommand("numberedlist",new t("numberedlist","ol")),e.addCommand("bulletedlist",new t("bulletedlist","ul")),e.ui.addButton&&(e.ui.addButton("NumberedList",{label:e.lang.list.numberedlist,command:"numberedlist",directional:!0,toolbar:"list,10"}),e.ui.addButton("BulletedList",{label:e.lang.list.bulletedlist,command:"bulletedlist",directional:!0,toolbar:"list,20"})),e.on("key",function(t){var n,i=t.data.domEvent.getKey();if("wysiwyg"==e.mode&&i in{8:1,46:1}){var l=e.getSelection().getRanges()[0],u=l&&l.startPath();if(l&&l.collapsed){var h,p=8==i,f=e.editable(),g=new CKEDITOR.dom.walker(l.clone());if(g.evaluator=function(e){return c(e)&&!d(e)},g.guard=function(e,t){return!(t&&e.type==CKEDITOR.NODE_ELEMENT&&e.is("table"))},i=l.clone(),p)if((h=u.contains(s))&&l.checkBoundaryOfElement(h,CKEDITOR.START)&&(h=h.getParent())&&h.is("li")&&(h=o(h))?(n=h,h=h.getPrevious(c),i.moveToPosition(h&&d(h)?h:n,CKEDITOR.POSITION_BEFORE_START)):(g.range.setStartAt(f,CKEDITOR.POSITION_AFTER_START),g.range.setEnd(l.startContainer,l.startOffset),(h=g.previous())&&h.type==CKEDITOR.NODE_ELEMENT&&(h.getName()in s||h.is("li"))&&(h.is("li")||(g.range.selectNodeContents(h),g.reset(),g.evaluator=r,h=g.previous()),n=h,i.moveToElementEditEnd(n),i.moveToPosition(i.endPath().block,CKEDITOR.POSITION_BEFORE_END))),n)a(e,i,l),t.cancel();else{var m=u.contains(s);m&&l.checkBoundaryOfElement(m,CKEDITOR.START)&&(n=m.getFirst(c),l.checkBoundaryOfElement(n,CKEDITOR.START)&&(h=m.getPrevious(c),o(n)?h&&(l.moveToElementEditEnd(h),l.select()):e.execCommand("outdent"),t.cancel()))}else if(n=u.contains("li")){if(g.range.setEndAt(f,CKEDITOR.POSITION_BEFORE_END),p=(f=n.getLast(c))&&r(f)?f:n,u=0,(h=g.next())&&h.type==CKEDITOR.NODE_ELEMENT&&h.getName()in s&&h.equals(f)?(u=1,h=g.next()):l.checkBoundaryOfElement(p,CKEDITOR.END)&&(u=2),u&&h){if((l=l.clone()).moveToElementEditStart(h),1==u&&(i.optimize(),!i.startContainer.equals(n))){for(n=i.startContainer;n.is(CKEDITOR.dtd.$inline);)m=n,n=n.getParent();m&&i.moveToPosition(m,CKEDITOR.POSITION_AFTER_END)}2==u&&(i.moveToPosition(i.endPath().block,CKEDITOR.POSITION_BEFORE_END),l.endPath().block&&l.moveToPosition(l.endPath().block,CKEDITOR.POSITION_AFTER_START)),a(e,i,l),t.cancel()}}else g.range.setEndAt(f,CKEDITOR.POSITION_BEFORE_END),(h=g.next())&&h.type==CKEDITOR.NODE_ELEMENT&&h.is(s)&&(h=h.getFirst(c),u.block&&l.checkStartOfBlock()&&l.checkEndOfBlock()?(u.block.remove(),l.moveToElementEditStart(h),l.select()):o(h)?(l.moveToElementEditStart(h),l.select()):((l=l.clone()).moveToElementEditStart(h),a(e,i,l)),t.cancel());setTimeout(function(){e.selectionChange(1)})}}}))}})}(),function(){function e(e,t,n){n=e.config.forceEnterMode||n,"wysiwyg"==e.mode&&(t||(t=e.activeEnterMode),e.elementPath().isContextFor("p")||(t=CKEDITOR.ENTER_BR,n=1),e.fire("saveSnapshot"),t==CKEDITOR.ENTER_BR?a(e,t,null,n):o(e,t,null,n),e.fire("saveSnapshot"))}function t(e){for(var t=(e=e.getSelection().getRanges(!0)).length-1;0<t;t--)e[t].deleteContents();return e[0]}CKEDITOR.plugins.add("enterkey",{init:function(t){t.addCommand("enter",{modes:{wysiwyg:1},editorFocus:!1,exec:function(t){e(t)}}),t.addCommand("shiftEnter",{modes:{wysiwyg:1},editorFocus:!1,exec:function(t){e(t,t.activeShiftEnterMode,1)}}),t.setKeystroke([[13,"enter"],[CKEDITOR.SHIFT+13,"shiftEnter"]])}});var n=CKEDITOR.dom.walker.whitespaces(),i=CKEDITOR.dom.walker.bookmark();CKEDITOR.plugins.enterkey={enterBlock:function(e,r,o,l){if(o=o||t(e)){var u,c=(o=function(e){var t=e.startContainer.getAscendant(function(e){return e.type==CKEDITOR.NODE_ELEMENT&&"true"==e.getAttribute("contenteditable")},!0);return e.root.equals(t)?e:((t=new CKEDITOR.dom.range(t)).moveToRange(e),t)}(o)).document,d=o.checkStartOfBlock(),h=o.checkEndOfBlock(),p=e.elementPath(o.startContainer),f=p.block,g=r==CKEDITOR.ENTER_DIV?"div":"p";if(d&&h){if(f&&(f.is("li")||f.getParent().is("li"))){f.is("li")||(f=f.getParent()),u=(o=f.getParent()).getParent(),l=!f.hasPrevious();var m=!f.hasNext(),v=(g=e.getSelection()).createBookmarks(),y=(d=f.getDirection(1),h=f.getAttribute("class"),f.getAttribute("style")),b=u.getDirection(1)!=d;if(e=e.enterMode!=CKEDITOR.ENTER_BR||b||y||h,u.is("li"))l||m?(l&&m&&o.remove(),f[m?"insertAfter":"insertBefore"](u)):f.breakParent(u);else{if(e)p.block.is("li")?(u=c.createElement(r==CKEDITOR.ENTER_P?"p":"div"),b&&u.setAttribute("dir",d),y&&u.setAttribute("style",y),h&&u.setAttribute("class",h),f.moveChildren(u)):u=p.block,l||m?u[l?"insertBefore":"insertAfter"](o):(f.breakParent(o),u.insertAfter(o));else if(f.appendBogus(!0),l||m)for(;c=f[l?"getFirst":"getLast"]();)c[l?"insertBefore":"insertAfter"](o);else for(f.breakParent(o);c=f.getLast();)c.insertAfter(o);f.remove()}return void g.selectBookmarks(v)}if(f&&f.getParent().is("blockquote"))return f.breakParent(f.getParent()),f.getPrevious().getFirst(CKEDITOR.dom.walker.invisible(1))||f.getPrevious().remove(),f.getNext().getFirst(CKEDITOR.dom.walker.invisible(1))||f.getNext().remove(),o.moveToElementEditStart(f),void o.select()}else if(f&&f.is("pre")&&!h)return void a(e,r,o,l);if(d=o.splitBlock(g)){if(r=d.previousBlock,f=d.nextBlock,p=d.wasStartOfBlock,e=d.wasEndOfBlock,f?(v=f.getParent()).is("li")&&(f.breakParent(v),f.move(f.getNext(),1)):r&&(v=r.getParent())&&v.is("li")&&(r.breakParent(v),v=r.getNext(),o.moveToElementEditStart(v),r.move(r.getPrevious())),p||e){if(r?(r.is("li")||!s.test(r.getName())&&!r.is("pre"))&&(u=r.clone()):f&&(u=f.clone()),u?l&&!u.is("li")&&u.renameNode(g):v&&v.is("li")?u=v:(u=c.createElement(g),r&&(m=r.getDirection())&&u.setAttribute("dir",m)),c=d.elementPath)for(l=0,g=c.elements.length;l<g&&!(v=c.elements[l]).equals(c.block)&&!v.equals(c.blockLimit);l++)CKEDITOR.dtd.$removeEmpty[v.getName()]&&(v=v.clone(),u.moveChildren(v),u.append(v));u.appendBogus(),u.getParent()||o.insertNode(u),u.is("li")&&u.removeAttribute("value"),!CKEDITOR.env.ie||!p||e&&r.getChildCount()||(o.moveToElementEditStart(e?r:u),o.select()),o.moveToElementEditStart(p&&!e?f:u)}else f.is("li")&&((u=o.clone()).selectNodeContents(f),(u=new CKEDITOR.dom.walker(u)).evaluator=function(e){return!(i(e)||n(e)||e.type==CKEDITOR.NODE_ELEMENT&&e.getName()in CKEDITOR.dtd.$inline&&!(e.getName()in CKEDITOR.dtd.$empty))},(v=u.next())&&v.type==CKEDITOR.NODE_ELEMENT&&v.is("ul","ol")&&(CKEDITOR.env.needsBrFiller?c.createElement("br"):c.createText(" ")).insertBefore(v)),f&&o.moveToElementEditStart(f);o.select(),o.scrollIntoView()}}},enterBr:function(e,n,i,r){if(i=i||t(e)){var a=i.document,l=i.checkEndOfBlock(),u=new CKEDITOR.dom.elementPath(e.getSelection().getStartElement()),c=u.block,d=c&&u.block.getName();r||"li"!=d?(!r&&l&&s.test(d)?(l=c.getDirection())?((a=a.createElement("div")).setAttribute("dir",l),a.insertAfter(c),i.setStart(a,0)):(a.createElement("br").insertAfter(c),CKEDITOR.env.gecko&&a.createText("").insertAfter(c),i.setStartAt(c.getNext(),CKEDITOR.env.ie?CKEDITOR.POSITION_BEFORE_START:CKEDITOR.POSITION_AFTER_START)):(e="pre"==d&&CKEDITOR.env.ie&&8>CKEDITOR.env.version?a.createText("\r"):a.createElement("br"),i.deleteContents(),i.insertNode(e),CKEDITOR.env.needsBrFiller?(a.createText("\ufeff").insertAfter(e),l&&(c||u.blockLimit).appendBogus(),e.getNext().$.nodeValue="",i.setStartAt(e.getNext(),CKEDITOR.POSITION_AFTER_START)):i.setStartAt(e,CKEDITOR.POSITION_AFTER_END)),i.collapse(!0),i.select(),i.scrollIntoView()):o(e,n,i,r)}}};var r=CKEDITOR.plugins.enterkey,a=r.enterBr,o=r.enterBlock,s=/^h[1-6]$/}(),function(){function e(e,t){var n={},i=[],r={nbsp:" ",shy:"­",gt:">",lt:"<",amp:"&",apos:"'",quot:'"'};if(e=e.replace(/\b(nbsp|shy|gt|lt|amp|apos|quot)(?:,|$)/g,function(e,a){var o=t?"&"+a+";":r[a];return n[o]=t?r[a]:"&"+a+";",i.push(o),""}),!t&&e){e=e.split(",");var a,o=document.createElement("div");for(o.innerHTML="&"+e.join(";&")+";",a=o.innerHTML,o=null,o=0;o<a.length;o++){var s=a.charAt(o);n[s]="&"+e[o]+";",i.push(s)}}return n.regex=i.join(t?"|":""),n}CKEDITOR.plugins.add("entities",{afterInit:function(t){function n(e){return l[e]}function i(e){return"force"!=r.entities_processNumerical&&o[e]?o[e]:"&#"+e.charCodeAt(0)+";"}var r=t.config;if(t=(t=t.dataProcessor)&&t.htmlFilter){var a=[];!1!==r.basicEntities&&a.push("nbsp,gt,lt,amp"),r.entities&&(a.length&&a.push("quot,iexcl,cent,pound,curren,yen,brvbar,sect,uml,copy,ordf,laquo,not,shy,reg,macr,deg,plusmn,sup2,sup3,acute,micro,para,middot,cedil,sup1,ordm,raquo,frac14,frac12,frac34,iquest,times,divide,fnof,bull,hellip,prime,Prime,oline,frasl,weierp,image,real,trade,alefsym,larr,uarr,rarr,darr,harr,crarr,lArr,uArr,rArr,dArr,hArr,forall,part,exist,empty,nabla,isin,notin,ni,prod,sum,minus,lowast,radic,prop,infin,ang,and,or,cap,cup,int,there4,sim,cong,asymp,ne,equiv,le,ge,sub,sup,nsub,sube,supe,oplus,otimes,perp,sdot,lceil,rceil,lfloor,rfloor,lang,rang,loz,spades,clubs,hearts,diams,circ,tilde,ensp,emsp,thinsp,zwnj,zwj,lrm,rlm,ndash,mdash,lsquo,rsquo,sbquo,ldquo,rdquo,bdquo,dagger,Dagger,permil,lsaquo,rsaquo,euro"),r.entities_latin&&a.push("Agrave,Aacute,Acirc,Atilde,Auml,Aring,AElig,Ccedil,Egrave,Eacute,Ecirc,Euml,Igrave,Iacute,Icirc,Iuml,ETH,Ntilde,Ograve,Oacute,Ocirc,Otilde,Ouml,Oslash,Ugrave,Uacute,Ucirc,Uuml,Yacute,THORN,szlig,agrave,aacute,acirc,atilde,auml,aring,aelig,ccedil,egrave,eacute,ecirc,euml,igrave,iacute,icirc,iuml,eth,ntilde,ograve,oacute,ocirc,otilde,ouml,oslash,ugrave,uacute,ucirc,uuml,yacute,thorn,yuml,OElig,oelig,Scaron,scaron,Yuml"),r.entities_greek&&a.push("Alpha,Beta,Gamma,Delta,Epsilon,Zeta,Eta,Theta,Iota,Kappa,Lambda,Mu,Nu,Xi,Omicron,Pi,Rho,Sigma,Tau,Upsilon,Phi,Chi,Psi,Omega,alpha,beta,gamma,delta,epsilon,zeta,eta,theta,iota,kappa,lambda,mu,nu,xi,omicron,pi,rho,sigmaf,sigma,tau,upsilon,phi,chi,psi,omega,thetasym,upsih,piv"),r.entities_additional&&a.push(r.entities_additional));var o=e(a.join(",")),s=o.regex?"["+o.regex+"]":"a^";delete o.regex,r.entities&&r.entities_processNumerical&&(s="[^ -~]|"+s),s=new RegExp(s,"g");var l=e("nbsp,gt,lt,amp,shy",!0),u=new RegExp(l.regex,"g");t.addRules({text:function(e){return e.replace(u,n).replace(s,i)}},{applyToAll:!0,excludeNestedEditable:!0})}}})}(),CKEDITOR.config.basicEntities=!0,CKEDITOR.config.entities=!0,CKEDITOR.config.entities_latin=!0,CKEDITOR.config.entities_greek=!0,CKEDITOR.config.entities_additional="#39",CKEDITOR.plugins.add("popup"),CKEDITOR.tools.extend(CKEDITOR.editor.prototype,{popup:function(e,t,n,i){t=t||"80%",n=n||"70%","string"==typeof t&&1<t.length&&"%"==t.substr(t.length-1,1)&&(t=parseInt(window.screen.width*parseInt(t,10)/100,10)),"string"==typeof n&&1<n.length&&"%"==n.substr(n.length-1,1)&&(n=parseInt(window.screen.height*parseInt(n,10)/100,10)),640>t&&(t=640),420>n&&(n=420);var r=parseInt((window.screen.height-n)/2,10),a=parseInt((window.screen.width-t)/2,10);i=(i||"location=no,menubar=no,toolbar=no,dependent=yes,minimizable=no,modal=yes,alwaysRaised=yes,resizable=yes,scrollbars=yes")+",width="+t+",height="+n+",top="+r+",left="+a;var o=window.open("",null,i,!0);if(!o)return!1;try{-1==navigator.userAgent.toLowerCase().indexOf(" chrome/")&&(o.moveTo(a,r),o.resizeTo(t,n)),o.focus(),o.location.href=e}catch(t){window.open(e,null,i,!0)}return!0}}),function(){function e(e,t){var n=[];if(!t)return e;for(var i in t)n.push(i+"="+encodeURIComponent(t[i]));return e+(-1!=e.indexOf("?")?"&":"?")+n.join("&")}function t(e){return(e+="").charAt(0).toUpperCase()+e.substr(1)}function n(){var n=(r=this.getDialog()).getParentEditor();n._.filebrowserSe=this;var i=n.config["filebrowser"+t(r.getName())+"WindowWidth"]||n.config.filebrowserWindowWidth||"80%",r=n.config["filebrowser"+t(r.getName())+"WindowHeight"]||n.config.filebrowserWindowHeight||"70%",a=this.filebrowser.params||{};a.CKEditor=n.name,a.CKEditorFuncNum=n._.filebrowserFn,a.langCode||(a.langCode=n.langCode),a=e(this.filebrowser.url,a),n.popup(a,i,r,n.config.filebrowserWindowFeatures||n.config.fileBrowserWindowFeatures)}function i(){var e=this.getDialog();return e.getParentEditor()._.filebrowserSe=this,!(!e.getContentElement(this.for[0],this.for[1]).getInputElement().$.value||!e.getContentElement(this.for[0],this.for[1]).getAction())}function r(t,n,i){var r=i.params||{};r.CKEditor=t.name,r.CKEditorFuncNum=t._.filebrowserFn,r.langCode||(r.langCode=t.langCode),n.action=e(i.url,r),n.filebrowser=i}function a(e,o,s,l){if(l&&l.length)for(var u,c=l.length;c--;)if("hbox"!=(u=l[c]).type&&"vbox"!=u.type&&"fieldset"!=u.type||a(e,o,s,u.children),u.filebrowser)if("string"==typeof u.filebrowser&&(u.filebrowser={action:"fileButton"==u.type?"QuickUpload":"Browse",target:u.filebrowser}),"Browse"==u.filebrowser.action){var d=u.filebrowser.url;void 0===d&&void 0===(d=e.config["filebrowser"+t(o)+"BrowseUrl"])&&(d=e.config.filebrowserBrowseUrl),d&&(u.onClick=n,u.filebrowser.url=d,u.hidden=!1)}else if("QuickUpload"==u.filebrowser.action&&u.for&&(void 0===(d=u.filebrowser.url)&&void 0===(d=e.config["filebrowser"+t(o)+"UploadUrl"])&&(d=e.config.filebrowserUploadUrl),d)){var h=u.onClick;u.onClick=function(e){var t=e.sender;return!(h&&!1===h.call(t,e)||!i.call(t,e)||(e=t.getDialog().getContentElement(this.for[0],this.for[1]).getInputElement(),(t=new CKEDITOR.dom.element(e.$.form))&&((e=t.$.elements.ckCsrfToken)?e=new CKEDITOR.dom.element(e):((e=new CKEDITOR.dom.element("input")).setAttributes({name:"ckCsrfToken",type:"hidden"}),t.append(e)),e.setAttribute("value",CKEDITOR.tools.getCsrfToken())),0))},u.filebrowser.url=d,u.hidden=!1,r(e,s.getContents(u.for[0]).get(u.for[1]),u.filebrowser)}}function o(e,t,n){if(-1!==n.indexOf(";")){n=n.split(";");for(var i=0;i<n.length;i++)if(o(e,t,n[i]))return!0;return!1}return(e=e.getContents(t).get(n).filebrowser)&&e.url}function s(e,t){var n=this._.filebrowserSe.getDialog(),i=this._.filebrowserSe.for,r=this._.filebrowserSe.filebrowser.onSelect;i&&n.getContentElement(i[0],i[1]).reset(),"function"==typeof t&&!1===t.call(this._.filebrowserSe)||r&&!1===r.call(this._.filebrowserSe,e,t)||("string"==typeof t&&t&&alert(t),e&&(n=(i=this._.filebrowserSe).getDialog(),i=i.filebrowser.target||null)&&(i=i.split(":"),(r=n.getContentElement(i[0],i[1]))&&(r.setValue(e),n.selectPage(i[0]))))}CKEDITOR.plugins.add("filebrowser",{requires:"popup",init:function(e){e._.filebrowserFn=CKEDITOR.tools.addFunction(s,e),e.on("destroy",function(){CKEDITOR.tools.removeFunction(this._.filebrowserFn)})}}),CKEDITOR.on("dialogDefinition",function(e){if(e.editor.plugins.filebrowser)for(var t,n=e.data.definition,i=0;i<n.contents.length;++i)(t=n.contents[i])&&(a(e.editor,e.data.name,n,t.elements),t.hidden&&t.filebrowser&&(t.hidden=!o(n,t.id,t.filebrowser)))})}(),function(){function e(e){var i=e.config,r=e.fire("uiSpace",{space:"top",html:""}).html,a=function(){function r(e,t,i){s.setStyle(t,n(i)),s.setStyle("position",e)}function o(e){var t=u.getDocumentPosition();switch(e){case"top":r("absolute","top",t.y-p-m);break;case"pin":r("fixed","top",y);break;case"bottom":r("absolute","top",t.y+(d.height||d.bottom-d.top)+m)}l=e}var l,u,c,d,h,p,f,g=i.floatSpaceDockedOffsetX||0,m=i.floatSpaceDockedOffsetY||0,v=i.floatSpacePinnedOffsetX||0,y=i.floatSpacePinnedOffsetY||0;return function(r){if(u=e.editable()){var y=r&&"focus"==r.name;y&&s.show(),e.fire("floatingSpaceLayout",{show:y}),s.removeStyle("left"),s.removeStyle("right"),c=s.getClientRect(),d=u.getClientRect(),h=t.getViewPaneSize(),p=c.height,f="pageXOffset"in t.$?t.$.pageXOffset:CKEDITOR.document.$.documentElement.scrollLeft,l?(p+m<=d.top?o("top"):p+m>h.height-d.bottom?o("pin"):o("bottom"),r=h.width/2,r=i.floatSpacePreferRight?"right":0<d.left&&d.right<h.width&&d.width>c.width?"rtl"==i.contentsLangDirection?"right":"left":r-d.left>d.right-r?"left":"right",c.width>h.width?(r="left",y=0):(y="left"==r?0<d.left?d.left:0:d.right<h.width?h.width-d.right:0)+c.width>h.width&&(r="left"==r?"right":"left",y=0),s.setStyle(r,n(("pin"==l?v:g)+y+("pin"==l?0:"left"==r?f:-f)))):(l="pin",o("pin"),a(r))}}}();if(r){var o=new CKEDITOR.template('<div id="cke_{name}" class="cke {id} cke_reset_all cke_chrome cke_editor_{name} cke_float cke_{langDir} '+CKEDITOR.env.cssClass+'" dir="{langDir}" title="'+(CKEDITOR.env.gecko?" ":"")+'" lang="{langCode}" role="application" style="{style}"'+(e.title?' aria-labelledby="cke_{name}_arialbl"':" ")+">"+(e.title?'<span id="cke_{name}_arialbl" class="cke_voice_label">{voiceLabel}</span>':" ")+'<div class="cke_inner"><div id="{topId}" class="cke_top" role="presentation">{content}</div></div></div>'),s=CKEDITOR.document.getBody().append(CKEDITOR.dom.element.createFromHtml(o.output({content:r,id:e.id,langDir:e.lang.dir,langCode:e.langCode,name:e.name,style:"display:none;z-index:"+(i.baseFloatZIndex-1),topId:e.ui.spaceId("top"),voiceLabel:e.title}))),l=CKEDITOR.tools.eventsBuffer(500,a),u=CKEDITOR.tools.eventsBuffer(100,a);s.unselectable(),s.on("mousedown",function(e){(e=e.data).getTarget().hasAscendant("a",1)||e.preventDefault()}),e.on("focus",function(n){a(n),e.on("change",l.input),t.on("scroll",u.input),t.on("resize",u.input)}),e.on("blur",function(){s.hide(),e.removeListener("change",l.input),t.removeListener("scroll",u.input),t.removeListener("resize",u.input)}),e.on("destroy",function(){t.removeListener("scroll",u.input),t.removeListener("resize",u.input),s.clearCustomData(),s.remove()}),e.focusManager.hasFocus&&s.show(),e.focusManager.add(s,1)}}var t=CKEDITOR.document.getWindow(),n=CKEDITOR.tools.cssLength;CKEDITOR.plugins.add("floatingspace",{init:function(t){t.on("loaded",function(){e(this)},null,null,20)}})}(),CKEDITOR.plugins.add("listblock",{requires:"panel",onLoad:function(){var e=CKEDITOR.addTemplate("panel-list",'<ul role="presentation" class="cke_panel_list">{items}</ul>'),t=CKEDITOR.addTemplate("panel-list-item",'<li id="{id}" class="cke_panel_listItem" role=presentation><a id="{id}_option" _cke_focus=1 hidefocus=true title="{title}" href="javascript:void(\'{val}\')"  {onclick}="CKEDITOR.tools.callFunction({clickFn},\'{val}\'); return false;" role="option">{text}</a></li>'),n=CKEDITOR.addTemplate("panel-list-group",'<h1 id="{id}" class="cke_panel_grouptitle" role="presentation" >{label}</h1>'),i=/\'/g;CKEDITOR.ui.panel.prototype.addListBlock=function(e,t){return this.addBlock(e,new CKEDITOR.ui.listBlock(this.getHolderElement(),t))},CKEDITOR.ui.listBlock=CKEDITOR.tools.createClass({base:CKEDITOR.ui.panel.block,$:function(e,t){var n=(t=t||{}).attributes||(t.attributes={});(this.multiSelect=!!t.multiSelect)&&(n["aria-multiselectable"]=!0),!n.role&&(n.role="listbox"),this.base.apply(this,arguments),this.element.setAttribute("role",n.role),(n=this.keys)[40]="next",n[9]="next",n[38]="prev",n[CKEDITOR.SHIFT+9]="prev",n[32]=CKEDITOR.env.ie?"mouseup":"click",CKEDITOR.env.ie&&(n[13]="mouseup"),this._.pendingHtml=[],this._.pendingList=[],this._.items={},this._.groups={}},_:{close:function(){if(this._.started){var t=e.output({items:this._.pendingList.join("")});this._.pendingList=[],this._.pendingHtml.push(t),delete this._.started}},getClick:function(){return this._.click||(this._.click=CKEDITOR.tools.addFunction(function(e){var t=this.toggle(e);this.onClick&&this.onClick(e,t)},this)),this._.click}},proto:{add:function(e,n,r){var a=CKEDITOR.tools.getNextId();this._.started||(this._.started=1,this._.size=this._.size||0),this._.items[e]=a,e={id:a,val:CKEDITOR.tools.htmlEncodeAttr(e).replace(i,"\\'"),onclick:CKEDITOR.env.ie?'onclick="return false;" onmouseup':"onclick",clickFn:this._.getClick(),title:CKEDITOR.tools.htmlEncodeAttr(r||e),text:n||e},this._.pendingList.push(t.output(e))},startGroup:function(e){this._.close();var t=CKEDITOR.tools.getNextId();this._.groups[e]=t,this._.pendingHtml.push(n.output({id:t,label:e}))},commit:function(){this._.close(),this.element.appendHtml(this._.pendingHtml.join("")),delete this._.size,this._.pendingHtml=[]},toggle:function(e){var t=this.isMarked(e);return t?this.unmark(e):this.mark(e),!t},hideGroup:function(e){var t=(e=this.element.getDocument().getById(this._.groups[e]))&&e.getNext();e&&(e.setStyle("display","none"),t&&"ul"==t.getName()&&t.setStyle("display","none"))},hideItem:function(e){this.element.getDocument().getById(this._.items[e]).setStyle("display","none")},showAll:function(){var e,t=this._.items,n=this._.groups,i=this.element.getDocument();for(e in t)i.getById(t[e]).setStyle("display","");for(var r in n)e=(t=i.getById(n[r])).getNext(),t.setStyle("display",""),e&&"ul"==e.getName()&&e.setStyle("display","")},mark:function(e){this.multiSelect||this.unmarkAll(),e=this._.items[e];var t=this.element.getDocument().getById(e);t.addClass("cke_selected"),this.element.getDocument().getById(e+"_option").setAttribute("aria-selected",!0),this.onMark&&this.onMark(t)},unmark:function(e){var t=this.element.getDocument();e=this._.items[e];var n=t.getById(e);n.removeClass("cke_selected"),t.getById(e+"_option").removeAttribute("aria-selected"),this.onUnmark&&this.onUnmark(n)},unmarkAll:function(){var e,t=this._.items,n=this.element.getDocument();for(e in t){var i=t[e];n.getById(i).removeClass("cke_selected"),n.getById(i+"_option").removeAttribute("aria-selected")}this.onUnmark&&this.onUnmark()},isMarked:function(e){return this.element.getDocument().getById(this._.items[e]).hasClass("cke_selected")},focus:function(e){this._.focusIndex=-1;var t,n=this.element.getElementsByTag("a"),i=-1;if(e){for(t=this.element.getDocument().getById(this._.items[e]).getFirst();e=n.getItem(++i);)if(e.equals(t)){this._.focusIndex=i;break}}else this.element.focus();t&&setTimeout(function(){t.focus()},0)}}})}}),function(){var e='<a id="{id}" class="cke_button cke_button__{name} cke_button_{state} {cls}"'+(CKEDITOR.env.gecko&&!CKEDITOR.env.hc?"":" href=\"javascript:void('{titleJs}')\"")+' title="{title}" tabindex="-1" hidefocus="true" role="button" aria-labelledby="{id}_label" aria-describedby="{id}_description" aria-haspopup="{hasArrow}" aria-disabled="{ariaDisabled}"';CKEDITOR.env.gecko&&CKEDITOR.env.mac&&(e+=' onkeypress="return false;"'),CKEDITOR.env.gecko&&(e+=' onblur="this.style.cssText = this.style.cssText;"'),e=(e=e+' onkeydown="return CKEDITOR.tools.callFunction({keydownFn},event);" onfocus="return CKEDITOR.tools.callFunction({focusFn},event);" '+(CKEDITOR.env.ie?'onclick="return false;" onmouseup':"onclick")+'="CKEDITOR.tools.callFunction({clickFn},this);return false;"><span class="cke_button_icon cke_button__{iconName}_icon" style="{style}"')+'>&nbsp;</span><span id="{id}_label" class="cke_button_label cke_button__{name}_label" aria-hidden="false">{label}</span><span id="{id}_description" class="cke_button_label" aria-hidden="false">{ariaShortcut}</span>{arrowHtml}</a>';var t=CKEDITOR.addTemplate("buttonArrow",'<span class="cke_button_arrow">'+(CKEDITOR.env.hc?"&#9660;":"")+"</span>"),n=CKEDITOR.addTemplate("button",e);CKEDITOR.plugins.add("button",{beforeInit:function(e){e.ui.addHandler(CKEDITOR.UI_BUTTON,CKEDITOR.ui.button.handler)}}),CKEDITOR.UI_BUTTON="button",CKEDITOR.ui.button=function(e){CKEDITOR.tools.extend(this,e,{title:e.label,click:e.click||function(t){t.execCommand(e.command)}}),this._={}},CKEDITOR.ui.button.handler={create:function(e){return new CKEDITOR.ui.button(e)}},CKEDITOR.ui.button.prototype={render:function(e,i){function r(){var t=e.mode;t&&(t=this.modes[t]?void 0!==m[t]?m[t]:CKEDITOR.TRISTATE_OFF:CKEDITOR.TRISTATE_DISABLED,t=e.readOnly&&!this.readOnly?CKEDITOR.TRISTATE_DISABLED:t,this.setState(t),this.refresh&&this.refresh())}var a,o,s,l=CKEDITOR.env,u=this._.id=CKEDITOR.tools.getNextId(),c="",d=this.command;this._.editor=e;var h={id:u,button:this,editor:e,focus:function(){CKEDITOR.document.getById(u).focus()},execute:function(){this.button.click(e)},attach:function(e){this.button.attach(e)}},p=CKEDITOR.tools.addFunction(function(e){if(h.onkey)return e=new CKEDITOR.dom.event(e),!1!==h.onkey(h,e.getKeystroke())}),f=CKEDITOR.tools.addFunction(function(e){var t;return h.onfocus&&(t=!1!==h.onfocus(h,new CKEDITOR.dom.event(e))),t}),g=0;if(h.clickFn=a=CKEDITOR.tools.addFunction(function(){g&&(e.unlockSelection(1),g=0),h.execute(),l.iOS&&e.focus()}),this.modes){var m={};e.on("beforeModeUnload",function(){e.mode&&this._.state!=CKEDITOR.TRISTATE_DISABLED&&(m[e.mode]=this._.state)},this),e.on("activeFilterChange",r,this),e.on("mode",r,this),!this.readOnly&&e.on("readOnly",r,this)}else d&&(d=e.getCommand(d))&&(d.on("state",function(){this.setState(d.state)},this),c+=d.state==CKEDITOR.TRISTATE_ON?"on":d.state==CKEDITOR.TRISTATE_DISABLED?"disabled":"off");this.directional&&e.on("contentDirChanged",function(t){var n=CKEDITOR.document.getById(this._.id),i=n.getFirst();(t=t.data)!=e.lang.dir?n.addClass("cke_"+t):n.removeClass("cke_ltr").removeClass("cke_rtl"),i.setAttribute("style",CKEDITOR.skin.getIconStyle(v,"rtl"==t,this.icon,this.iconOffset))},this),d?(o=e.getCommandKeystroke(d))&&(s=CKEDITOR.tools.keystrokeToString(e.lang.common.keyboard,o)):c+="off";var v=o=this.name||this.command;return this.icon&&!/\./.test(this.icon)&&(v=this.icon,this.icon=null),c={id:u,name:o,iconName:v,label:this.label,cls:this.className||"",state:c,ariaDisabled:"disabled"==c?"true":"false",title:this.title+(s?" ("+s.display+")":""),ariaShortcut:s?e.lang.common.keyboardShortcut+" "+s.aria:"",titleJs:l.gecko&&!l.hc?"":(this.title||"").replace("'",""),hasArrow:this.hasArrow?"true":"false",keydownFn:p,focusFn:f,clickFn:a,style:CKEDITOR.skin.getIconStyle(v,"rtl"==e.lang.dir,this.icon,this.iconOffset),arrowHtml:this.hasArrow?t.output():""},n.output(c,i),this.onRender&&this.onRender(),h},setState:function(e){if(this._.state==e)return!1;this._.state=e;var t=CKEDITOR.document.getById(this._.id);return!!t&&(t.setState(e,"cke_button"),e==CKEDITOR.TRISTATE_DISABLED?t.setAttribute("aria-disabled",!0):t.removeAttribute("aria-disabled"),this.hasArrow?(e=e==CKEDITOR.TRISTATE_ON?this._.editor.lang.button.selectedLabel.replace(/%1/g,this.label):this.label,CKEDITOR.document.getById(this._.id+"_label").setText(e)):e==CKEDITOR.TRISTATE_ON?t.setAttribute("aria-pressed",!0):t.removeAttribute("aria-pressed"),!0)},getState:function(){return this._.state},toFeature:function(e){if(this._.feature)return this._.feature;var t=this;return this.allowedContent||this.requiredContent||!this.command||(t=e.getCommand(this.command)||t),this._.feature=t}},CKEDITOR.ui.prototype.addButton=function(e,t){this.add(e,CKEDITOR.UI_BUTTON,t)}}(),CKEDITOR.plugins.add("richcombo",{requires:"floatpanel,listblock,button",beforeInit:function(e){e.ui.addHandler(CKEDITOR.UI_RICHCOMBO,CKEDITOR.ui.richCombo.handler)}}),function(){var e='<span id="{id}" class="cke_combo cke_combo__{name} {cls}" role="presentation"><span id="{id}_label" class="cke_combo_label">{label}</span><a class="cke_combo_button" title="{title}" tabindex="-1"'+(CKEDITOR.env.gecko&&!CKEDITOR.env.hc?"":" href=\"javascript:void('{titleJs}')\"")+' hidefocus="true" role="button" aria-labelledby="{id}_label" aria-haspopup="true"';CKEDITOR.env.gecko&&CKEDITOR.env.mac&&(e+=' onkeypress="return false;"'),CKEDITOR.env.gecko&&(e+=' onblur="this.style.cssText = this.style.cssText;"'),e=e+' onkeydown="return CKEDITOR.tools.callFunction({keydownFn},event,this);" onfocus="return CKEDITOR.tools.callFunction({focusFn},event);" '+(CKEDITOR.env.ie?'onclick="return false;" onmouseup':"onclick")+'="CKEDITOR.tools.callFunction({clickFn},this);return false;"><span id="{id}_text" class="cke_combo_text cke_combo_inlinelabel">{label}</span><span class="cke_combo_open"><span class="cke_combo_arrow">'+(CKEDITOR.env.hc?"&#9660;":CKEDITOR.env.air?"&nbsp;":"")+"</span></span></a></span>";var t=CKEDITOR.addTemplate("combo",e);CKEDITOR.UI_RICHCOMBO="richcombo",CKEDITOR.ui.richCombo=CKEDITOR.tools.createClass({$:function(e){CKEDITOR.tools.extend(this,e,{canGroup:!1,title:e.label,modes:{wysiwyg:1},editorFocus:1}),e=this.panel||{},delete this.panel,this.id=CKEDITOR.tools.getNextNumber(),this.document=e.parent&&e.parent.getDocument()||CKEDITOR.document,e.className="cke_combopanel",e.block={multiSelect:e.multiSelect,attributes:e.attributes},e.toolbarRelated=!0,this._={panelDefinition:e,items:{}}},proto:{renderHtml:function(e){var t=[];return this.render(e,t),t.join("")},render:function(e,n){function i(){if(this.getState()!=CKEDITOR.TRISTATE_ON){var t=this.modes[e.mode]?CKEDITOR.TRISTATE_OFF:CKEDITOR.TRISTATE_DISABLED;e.readOnly&&!this.readOnly&&(t=CKEDITOR.TRISTATE_DISABLED),this.setState(t),this.setValue(""),t!=CKEDITOR.TRISTATE_DISABLED&&this.refresh&&this.refresh()}}var r=CKEDITOR.env,a="cke_"+this.id,o=CKEDITOR.tools.addFunction(function(t){d&&(e.unlockSelection(1),d=0),l.execute(t)},this),s=this,l={id:a,combo:this,focus:function(){CKEDITOR.document.getById(a).getChild(1).focus()},execute:function(t){var n=s._;if(n.state!=CKEDITOR.TRISTATE_DISABLED)if(s.createPanel(e),n.on)n.panel.hide();else{s.commit();var i=s.getValue();i?n.list.mark(i):n.list.unmarkAll(),n.panel.showBlock(s.id,new CKEDITOR.dom.element(t),4)}},clickFn:o};e.on("activeFilterChange",i,this),e.on("mode",i,this),e.on("selectionChange",i,this),!this.readOnly&&e.on("readOnly",i,this);var u=CKEDITOR.tools.addFunction(function(t,n){var i=(t=new CKEDITOR.dom.event(t)).getKeystroke();switch(40==i&&e.once("panelShow",function(e){e.data._.panel._.currentBlock.onKeyDown(40)}),i){case 13:case 32:case 40:CKEDITOR.tools.callFunction(o,n);break;default:l.onkey(l,i)}t.preventDefault()}),c=CKEDITOR.tools.addFunction(function(){l.onfocus&&l.onfocus()}),d=0;return l.keyDownFn=u,r={id:a,name:this.name||this.command,label:this.label,title:this.title,cls:this.className||"",titleJs:r.gecko&&!r.hc?"":(this.title||"").replace("'",""),keydownFn:u,focusFn:c,clickFn:o},t.output(r,n),this.onRender&&this.onRender(),l},createPanel:function(e){if(!this._.panel){var t=this._.panelDefinition,n=this._.panelDefinition.block,i=t.parent||CKEDITOR.document.getBody(),r="cke_combopanel__"+this.name,a=new CKEDITOR.ui.floatPanel(e,i,t),o=a.addListBlock(this.id,n),s=this;a.onShow=function(){this.element.addClass(r),s.setState(CKEDITOR.TRISTATE_ON),s._.on=1,s.editorFocus&&!e.focusManager.hasFocus&&e.focus(),s.onOpen&&s.onOpen(),e.once("panelShow",function(){o.focus(!o.multiSelect&&s.getValue())})},a.onHide=function(t){this.element.removeClass(r),s.setState(s.modes&&s.modes[e.mode]?CKEDITOR.TRISTATE_OFF:CKEDITOR.TRISTATE_DISABLED),s._.on=0,!t&&s.onClose&&s.onClose()},a.onEscape=function(){a.hide(1)},o.onClick=function(e,t){s.onClick&&s.onClick.call(s,e,t),a.hide()},this._.panel=a,this._.list=o,a.getBlock(this.id).onHide=function(){s._.on=0,s.setState(CKEDITOR.TRISTATE_OFF)},this.init&&this.init()}},setValue:function(e,t){this._.value=e;var n=this.document.getById("cke_"+this.id+"_text");n&&(e||t?n.removeClass("cke_combo_inlinelabel"):(t=this.label,n.addClass("cke_combo_inlinelabel")),n.setText(void 0!==t?t:e))},getValue:function(){return this._.value||""},unmarkAll:function(){this._.list.unmarkAll()},mark:function(e){this._.list.mark(e)},hideItem:function(e){this._.list.hideItem(e)},hideGroup:function(e){this._.list.hideGroup(e)},showAll:function(){this._.list.showAll()},add:function(e,t,n){this._.items[e]=n||e,this._.list.add(e,t,n)},startGroup:function(e){this._.list.startGroup(e)},commit:function(){this._.committed||(this._.list.commit(),this._.committed=1,CKEDITOR.ui.fire("ready",this)),this._.committed=1},setState:function(e){if(this._.state!=e){var t=this.document.getById("cke_"+this.id);t.setState(e,"cke_combo"),e==CKEDITOR.TRISTATE_DISABLED?t.setAttribute("aria-disabled",!0):t.removeAttribute("aria-disabled"),this._.state=e}},getState:function(){return this._.state},enable:function(){this._.state==CKEDITOR.TRISTATE_DISABLED&&this.setState(this._.lastState)},disable:function(){this._.state!=CKEDITOR.TRISTATE_DISABLED&&(this._.lastState=this._.state,this.setState(CKEDITOR.TRISTATE_DISABLED))}},statics:{handler:{create:function(e){return new CKEDITOR.ui.richCombo(e)}}}}),CKEDITOR.ui.prototype.addRichCombo=function(e,t){this.add(e,CKEDITOR.UI_RICHCOMBO,t)}}(),CKEDITOR.plugins.add("format",{requires:"richcombo",init:function(e){if(!e.blockless){for(var t=e.config,n=e.lang.format,i=t.format_tags.split(";"),r={},a=0,o=[],s=0;s<i.length;s++){var l=i[s],u=new CKEDITOR.style(t["format_"+l]);e.filter.customConfig&&!e.filter.check(u)||(a++,r[l]=u,r[l]._.enterMode=e.config.enterMode,o.push(u))}0!==a&&e.ui.addRichCombo("Format",{label:n.label,title:n.panelTitle,toolbar:"styles,20",allowedContent:o,panel:{css:[CKEDITOR.skin.getPath("editor")].concat(t.contentsCss),multiSelect:!1,attributes:{"aria-label":n.panelTitle}},init:function(){for(var e in this.startGroup(n.panelTitle),r){var t=n["tag_"+e];this.add(e,r[e].buildPreview(t),t)}},onClick:function(t){e.focus(),e.fire("saveSnapshot"),t=r[t];var n=e.elementPath();e[t.checkActive(n,e)?"removeStyle":"applyStyle"](t),setTimeout(function(){e.fire("saveSnapshot")},0)},onRender:function(){e.on("selectionChange",function(t){var n=this.getValue();for(var i in t=t.data.path,this.refresh(),r)if(r[i].checkActive(t,e))return void(i!=n&&this.setValue(i,e.lang.format["tag_"+i]));this.setValue("")},this)},onOpen:function(){for(var t in this.showAll(),r)e.activeFilter.check(r[t])||this.hideItem(t)},refresh:function(){var t=e.elementPath();if(t){if(t.isContextFor("p"))for(var n in r)if(e.activeFilter.check(r[n]))return;this.setState(CKEDITOR.TRISTATE_DISABLED)}}})}}}),CKEDITOR.config.format_tags="p;h1;h2;h3;h4;h5;h6;pre;address;div",CKEDITOR.config.format_p={element:"p"},CKEDITOR.config.format_div={element:"div"},CKEDITOR.config.format_pre={element:"pre"},CKEDITOR.config.format_address={element:"address"},CKEDITOR.config.format_h1={element:"h1"},CKEDITOR.config.format_h2={element:"h2"},CKEDITOR.config.format_h3={element:"h3"},CKEDITOR.config.format_h4={element:"h4"},CKEDITOR.config.format_h5={element:"h5"},CKEDITOR.config.format_h6={element:"h6"},function(){var e={canUndo:!1,exec:function(e){var t=e.document.createElement("hr");e.insertElement(t)},allowedContent:"hr",requiredContent:"hr"};CKEDITOR.plugins.add("horizontalrule",{init:function(t){t.blockless||(t.addCommand("horizontalrule",e),t.ui.addButton&&t.ui.addButton("HorizontalRule",{label:t.lang.horizontalrule.toolbar,command:"horizontalrule",toolbar:"insert,40"}))}})}(),CKEDITOR.plugins.add("htmlwriter",{init:function(e){var t=new CKEDITOR.htmlWriter;t.forceSimpleAmpersand=e.config.forceSimpleAmpersand,t.indentationChars=e.config.dataIndentationChars||"\t",e.dataProcessor.writer=t}}),CKEDITOR.htmlWriter=CKEDITOR.tools.createClass({base:CKEDITOR.htmlParser.basicWriter,$:function(){this.base(),this.indentationChars="\t",this.selfClosingEnd=" />",this.lineBreakChars="\n",this.sortAttributes=1,this._.indent=0,this._.indentation="",this._.inPre=0,this._.rules={};var e,t=CKEDITOR.dtd;for(e in CKEDITOR.tools.extend({},t.$nonBodyContent,t.$block,t.$listItem,t.$tableContent))this.setRules(e,{indent:!t[e]["#"],breakBeforeOpen:1,breakBeforeClose:!t[e]["#"],breakAfterClose:1,needsSpace:e in t.$block&&!(e in{li:1,dt:1,dd:1})});this.setRules("br",{breakAfterOpen:1}),this.setRules("title",{indent:0,breakAfterOpen:0}),this.setRules("style",{indent:0,breakBeforeClose:1}),this.setRules("pre",{breakAfterOpen:1,indent:0})},proto:{openTag:function(e){var t=this._.rules[e];this._.afterCloser&&t&&t.needsSpace&&this._.needsSpace&&this._.output.push("\n"),this._.indent?this.indentation():t&&t.breakBeforeOpen&&(this.lineBreak(),this.indentation()),this._.output.push("<",e),this._.afterCloser=0},openTagClose:function(e,t){var n=this._.rules[e];t?(this._.output.push(this.selfClosingEnd),n&&n.breakAfterClose&&(this._.needsSpace=n.needsSpace)):(this._.output.push(">"),n&&n.indent&&(this._.indentation+=this.indentationChars)),n&&n.breakAfterOpen&&this.lineBreak(),"pre"==e&&(this._.inPre=1)},attribute:function(e,t){"string"==typeof t&&(this.forceSimpleAmpersand&&(t=t.replace(/&amp;/g,"&")),t=CKEDITOR.tools.htmlEncodeAttr(t)),this._.output.push(" ",e,'="',t,'"')},closeTag:function(e){var t=this._.rules[e];t&&t.indent&&(this._.indentation=this._.indentation.substr(this.indentationChars.length)),this._.indent?this.indentation():t&&t.breakBeforeClose&&(this.lineBreak(),this.indentation()),this._.output.push("</",e,">"),"pre"==e&&(this._.inPre=0),t&&t.breakAfterClose&&(this.lineBreak(),this._.needsSpace=t.needsSpace),this._.afterCloser=1},text:function(e){this._.indent&&(this.indentation(),!this._.inPre&&(e=CKEDITOR.tools.ltrim(e))),this._.output.push(e)},comment:function(e){this._.indent&&this.indentation(),this._.output.push("\x3c!--",e,"--\x3e")},lineBreak:function(){!this._.inPre&&0<this._.output.length&&this._.output.push(this.lineBreakChars),this._.indent=1},indentation:function(){!this._.inPre&&this._.indentation&&this._.output.push(this._.indentation),this._.indent=0},reset:function(){this._.output=[],this._.indent=0,this._.indentation="",this._.afterCloser=0,this._.inPre=0,this._.needsSpace=0},setRules:function(e,t){var n=this._.rules[e];n?CKEDITOR.tools.extend(n,t,!0):this._.rules[e]=t}}}),function(){function e(e,t){if(t||(t=e.getSelection().getSelectedElement()),t&&t.is("img")&&!t.data("cke-realelement")&&!t.isReadOnly())return t}function t(e){var t=e.getStyle("float");return"inherit"!=t&&"none"!=t||(t=0),t||(t=e.getAttribute("align")),t}CKEDITOR.plugins.add("image",{requires:"dialog",init:function(t){if(!t.plugins.image2){CKEDITOR.dialog.add("image",this.path+"dialogs/image.js");var n="img[alt,!src]{border-style,border-width,float,height,margin,margin-bottom,margin-left,margin-right,margin-top,width}";CKEDITOR.dialog.isTabEnabled(t,"image","advanced")&&(n="img[alt,dir,id,lang,longdesc,!src,title]{*}(*)"),t.addCommand("image",new CKEDITOR.dialogCommand("image",{allowedContent:n,requiredContent:"img[alt,src]",contentTransformations:[["img{width}: sizeToStyle","img[width]: sizeToAttribute"],["img{float}: alignmentToStyle","img[align]: alignmentToAttribute"]]})),t.ui.addButton&&t.ui.addButton("Image",{label:t.lang.common.image,command:"image",toolbar:"insert,10"}),t.on("doubleclick",function(e){var t=e.data.element;!t.is("img")||t.data("cke-realelement")||t.isReadOnly()||(e.data.dialog="image")}),t.addMenuItems&&t.addMenuItems({image:{label:t.lang.image.menu,command:"image",group:"image"}}),t.contextMenu&&t.contextMenu.addListener(function(n){if(e(t,n))return{image:CKEDITOR.TRISTATE_OFF}})}},afterInit:function(n){function i(i){var r=n.getCommand("justify"+i);r&&("left"!=i&&"right"!=i||r.on("exec",function(r){var a=e(n);a&&(t(a)==i?(a.removeStyle("float"),i==t(a)&&a.removeAttribute("align")):a.setStyle("float",i),r.cancel())}),r.on("refresh",function(r){var a=e(n);a&&(a=t(a),this.setState(a==i?CKEDITOR.TRISTATE_ON:"right"==i||"left"==i?CKEDITOR.TRISTATE_OFF:CKEDITOR.TRISTATE_DISABLED),r.cancel())}))}n.plugins.image2||(i("left"),i("right"),i("center"),i("block"))}})}(),CKEDITOR.config.image_removeLinkByEmptyURL=!0,function(){function e(e,t){var n=i.exec(e),r=i.exec(t);if(n){if(!n[2]&&"px"==r[2])return r[1];if("px"==n[2]&&!r[2])return r[1]+"px"}return t}var t=CKEDITOR.htmlParser.cssStyle,n=CKEDITOR.tools.cssLength,i=/^((?:\d*(?:\.\d+))|(?:\d+))(.*)?$/i,r={elements:{$:function(n){var i=n.attributes;if((i=(i=(i=i&&i["data-cke-realelement"])&&new CKEDITOR.htmlParser.fragment.fromHtml(decodeURIComponent(i)))&&i.children[0])&&n.attributes["data-cke-resizable"]){var r=new t(n).rules;n=i.attributes;var a=r.width;r=r.height,a&&(n.width=e(n.width,a)),r&&(n.height=e(n.height,r))}return i}}};CKEDITOR.plugins.add("fakeobjects",{init:function(e){e.filter.allow("img[!data-cke-realelement,src,alt,title](*){*}","fakeobjects")},afterInit:function(e){(e=(e=e.dataProcessor)&&e.htmlFilter)&&e.addRules(r,{applyToAll:!0})}}),CKEDITOR.editor.prototype.createFakeElement=function(e,i,r,a){var o=(o=this.lang.fakeobjects)[r]||o.unknown;return i={class:i,"data-cke-realelement":encodeURIComponent(e.getOuterHtml()),"data-cke-real-node-type":e.type,alt:o,title:o,align:e.getAttribute("align")||""},CKEDITOR.env.hc||(i.src=CKEDITOR.tools.transparentImageData),r&&(i["data-cke-real-element-type"]=r),a&&(i["data-cke-resizable"]=a,r=new t,a=e.getAttribute("width"),e=e.getAttribute("height"),a&&(r.rules.width=n(a)),e&&(r.rules.height=n(e)),r.populate(i)),this.document.createElement("img",{attributes:i})},CKEDITOR.editor.prototype.createFakeParserElement=function(e,i,r,a){var o,s=(s=this.lang.fakeobjects)[r]||s.unknown;return o=new CKEDITOR.htmlParser.basicWriter,e.writeHtml(o),o=o.getHtml(),i={class:i,"data-cke-realelement":encodeURIComponent(o),"data-cke-real-node-type":e.type,alt:s,title:s,align:e.attributes.align||""},CKEDITOR.env.hc||(i.src=CKEDITOR.tools.transparentImageData),r&&(i["data-cke-real-element-type"]=r),a&&(i["data-cke-resizable"]=a,a=e.attributes,e=new t,r=a.width,a=a.height,void 0!==r&&(e.rules.width=n(r)),void 0!==a&&(e.rules.height=n(a)),e.populate(i)),new CKEDITOR.htmlParser.element("img",i)},CKEDITOR.editor.prototype.restoreRealElement=function(t){if(t.data("cke-real-node-type")!=CKEDITOR.NODE_ELEMENT)return null;var n=CKEDITOR.dom.element.createFromHtml(decodeURIComponent(t.data("cke-realelement")),this.document);if(t.data("cke-resizable")){var i=t.getStyle("width");t=t.getStyle("height"),i&&n.setAttribute("width",e(n.getAttribute("width"),i)),t&&n.setAttribute("height",e(n.getAttribute("height"),t))}return n}}(),function(){function e(e){return e.replace(/'/g,"\\$&")}CKEDITOR.plugins.add("link",{requires:"dialog,fakeobjects",onLoad:function(){function e(e){return n.replace(/%1/g,"rtl"==e?"right":"left").replace(/%2/g,"cke_contents_"+e)}var t="background:url("+CKEDITOR.getUrl(this.path+"images"+(CKEDITOR.env.hidpi?"/hidpi":"")+"/anchor.png")+") no-repeat %1 center;border:1px dotted #00f;background-size:16px;",n=".%2 a.cke_anchor,.%2 a.cke_anchor_empty,.cke_editable.%2 a[name],.cke_editable.%2 a[data-cke-saved-name]{"+t+"padding-%1:18px;cursor:auto;}.%2 img.cke_anchor{"+t+"width:16px;min-height:15px;height:1.15em;vertical-align:text-bottom;}";CKEDITOR.addCss(e("ltr")+e("rtl"))},init:function(e){var t="a[!href]";CKEDITOR.dialog.isTabEnabled(e,"link","advanced")&&(t=t.replace("]",",accesskey,charset,dir,id,lang,name,rel,tabindex,title,type,download]{*}(*)")),CKEDITOR.dialog.isTabEnabled(e,"link","target")&&(t=t.replace("]",",target,onclick]")),e.addCommand("link",new CKEDITOR.dialogCommand("link",{allowedContent:t,requiredContent:"a[href]"})),e.addCommand("anchor",new CKEDITOR.dialogCommand("anchor",{allowedContent:"a[!name,id]",requiredContent:"a[name]"})),e.addCommand("unlink",new CKEDITOR.unlinkCommand),e.addCommand("removeAnchor",new CKEDITOR.removeAnchorCommand),e.setKeystroke(CKEDITOR.CTRL+76,"link"),e.ui.addButton&&(e.ui.addButton("Link",{label:e.lang.link.toolbar,command:"link",toolbar:"links,10"}),e.ui.addButton("Unlink",{label:e.lang.link.unlink,command:"unlink",toolbar:"links,20"}),e.ui.addButton("Anchor",{label:e.lang.link.anchor.toolbar,command:"anchor",toolbar:"links,30"})),CKEDITOR.dialog.add("link",this.path+"dialogs/link.js"),CKEDITOR.dialog.add("anchor",this.path+"dialogs/anchor.js"),e.on("doubleclick",function(t){var n=CKEDITOR.plugins.link.getSelectedLink(e)||t.data.element;n.isReadOnly()||(n.is("a")?(t.data.dialog=!n.getAttribute("name")||n.getAttribute("href")&&n.getChildCount()?"link":"anchor",t.data.link=n):CKEDITOR.plugins.link.tryRestoreFakeAnchor(e,n)&&(t.data.dialog="anchor"))},null,null,0),e.on("doubleclick",function(t){t.data.dialog in{link:1,anchor:1}&&t.data.link&&e.getSelection().selectElement(t.data.link)},null,null,20),e.addMenuItems&&e.addMenuItems({anchor:{label:e.lang.link.anchor.menu,command:"anchor",group:"anchor",order:1},removeAnchor:{label:e.lang.link.anchor.remove,command:"removeAnchor",group:"anchor",order:5},link:{label:e.lang.link.menu,command:"link",group:"link",order:1},unlink:{label:e.lang.link.unlink,command:"unlink",group:"link",order:5}}),e.contextMenu&&e.contextMenu.addListener(function(t){if(!t||t.isReadOnly())return null;if(!(t=CKEDITOR.plugins.link.tryRestoreFakeAnchor(e,t))&&!(t=CKEDITOR.plugins.link.getSelectedLink(e)))return null;var n={};return t.getAttribute("href")&&t.getChildCount()&&(n={link:CKEDITOR.TRISTATE_OFF,unlink:CKEDITOR.TRISTATE_OFF}),t&&t.hasAttribute("name")&&(n.anchor=n.removeAnchor=CKEDITOR.TRISTATE_OFF),n}),this.compiledProtectionFunction=function(e){var t;return(e=e.config.emailProtection||"")&&"encode"!=e&&(t={},e.replace(/^([^(]+)\(([^)]+)\)$/,function(e,n,i){t.name=n,t.params=[],i.replace(/[^,\s]+/g,function(e){t.params.push(e)})})),t}(e)},afterInit:function(e){e.dataProcessor.dataFilter.addRules({elements:{a:function(t){return t.attributes.name?t.children.length?null:e.createFakeParserElement(t,"cke_anchor","anchor"):null}}});var t=e._.elementsPath&&e._.elementsPath.filters;t&&t.push(function(t,n){if("a"==n&&(CKEDITOR.plugins.link.tryRestoreFakeAnchor(e,t)||t.getAttribute("name")&&(!t.getAttribute("href")||!t.getChildCount())))return"anchor"})}});var t=/^javascript:/,n=/^mailto:([^?]+)(?:\?(.+))?$/,i=/subject=([^;?:@&=$,\/]*)/i,r=/body=([^;?:@&=$,\/]*)/i,a=/^#(.*)$/,o=/^((?:http|https|ftp|news):\/\/)?(.*)$/,s=/^(_(?:self|top|parent|blank))$/,l=/^javascript:void\(location\.href='mailto:'\+String\.fromCharCode\(([^)]+)\)(?:\+'(.*)')?\)$/,u=/^javascript:([^(]+)\(([^)]+)\)$/,c=/\s*window.open\(\s*this\.href\s*,\s*(?:'([^']*)'|null)\s*,\s*'([^']*)'\s*\)\s*;\s*return\s*false;*\s*/,d=/(?:^|,)([^=]+)=(\d+|yes|no)/gi,h={id:"advId",dir:"advLangDir",accessKey:"advAccessKey",name:"advName",lang:"advLangCode",tabindex:"advTabIndex",title:"advTitle",type:"advContentType",class:"advCSSClasses",charset:"advCharset",style:"advStyles",rel:"advRel"};CKEDITOR.plugins.link={getSelectedLink:function(e){var t=e.getSelection(),n=t.getSelectedElement();return n&&n.is("a")?n:(t=t.getRanges()[0])?(t.shrink(CKEDITOR.SHRINK_TEXT),e.elementPath(t.getCommonAncestor()).contains("a",1)):null},getEditorAnchors:function(e){for(var t,n=(i=(n=e.editable()).isInline()&&!e.plugins.divarea?e.document:n).getElementsByTag("a"),i=i.getElementsByTag("img"),r=[],a=0;t=n.getItem(a++);)(t.data("cke-saved-name")||t.hasAttribute("name"))&&r.push({name:t.data("cke-saved-name")||t.getAttribute("name"),id:t.getAttribute("id")});for(a=0;t=i.getItem(a++);)(t=this.tryRestoreFakeAnchor(e,t))&&r.push({name:t.getAttribute("name"),id:t.getAttribute("id")});return r},fakeAnchor:!0,tryRestoreFakeAnchor:function(e,t){if(t&&t.data("cke-real-element-type")&&"anchor"==t.data("cke-real-element-type")){var n=e.restoreRealElement(t);if(n.data("cke-saved-name"))return n}},parseLinkAttributes:function(e,p){var f,g=p&&(p.data("cke-saved-href")||p.getAttribute("href"))||"",m=e.plugins.link.compiledProtectionFunction,v=e.config.emailProtection,y={};if(g.match(t)&&("encode"==v?g=g.replace(l,function(e,t,n){return n=n||"","mailto:"+String.fromCharCode.apply(String,t.split(","))+n.replace(/\\'/g,"'")}):v&&g.replace(u,function(e,t,n){if(t==m.name){y.type="email",e=y.email={},t=/(^')|('$)/g;for(var i,r=(n=n.match(/[^,\s]+/g)).length,a=0;a<r;a++)i=decodeURIComponent(i=n[a].replace(t,"").replace(/\\'/g,"'")),e[m.params[a].toLowerCase()]=i;e.address=[e.name,e.domain].join("@")}})),!y.type)if(v=g.match(a))y.type="anchor",y.anchor={},y.anchor.name=y.anchor.id=v[1];else if(v=g.match(n)){f=g.match(i),g=g.match(r),y.type="email";var b=y.email={};b.address=v[1],f&&(b.subject=decodeURIComponent(f[1])),g&&(b.body=decodeURIComponent(g[1]))}else g&&(f=g.match(o))&&(y.type="url",y.url={},y.url.protocol=f[1],y.url.url=f[2]);if(p){if(g=p.getAttribute("target"))y.target={type:g.match(s)?g:"frame",name:g};else if(g=(g=p.data("cke-pa-onclick")||p.getAttribute("onclick"))&&g.match(c))for(y.target={type:"popup",name:g[1]};v=d.exec(g[2]);)"yes"!=v[2]&&"1"!=v[2]||v[1]in{height:1,width:1,top:1,left:1}?isFinite(v[2])&&(y.target[v[1]]=v[2]):y.target[v[1]]=!0;var _;for(_ in null!==p.getAttribute("download")&&(y.download=!0),g={},h)(v=p.getAttribute(_))&&(g[h[_]]=v);(_=p.data("cke-saved-name")||g.advName)&&(g.advName=_),CKEDITOR.tools.isEmpty(g)||(y.advanced=g)}return y},getLinkAttributes:function(t,n){var i=t.config.emailProtection||"",r={};switch(n.type){case"url":i=n.url&&void 0!==n.url.protocol?n.url.protocol:"http://";var a=n.url&&CKEDITOR.tools.trim(n.url.url)||"";r["data-cke-saved-href"]=0===a.indexOf("/")?a:i+a;break;case"anchor":i=n.anchor&&n.anchor.id,r["data-cke-saved-href"]="#"+(n.anchor&&n.anchor.name||i||"");break;case"email":switch(a=(l=n.email).address,i){case"":case"encode":var o=encodeURIComponent(l.subject||""),s=encodeURIComponent(l.body||""),l=[];o&&l.push("subject="+o),s&&l.push("body="+s),l=l.length?"?"+l.join("&"):"","encode"==i?(i=["javascript:void(location.href='mailto:'+",function(e){for(var t,n=e.length,i=[],r=0;r<n;r++)t=e.charCodeAt(r),i.push(t);return"String.fromCharCode("+i.join(",")+")"}(a)],l&&i.push("+'",e(l),"'"),i.push(")")):i=["mailto:",a,l];break;default:i=a.split("@",2),l.name=i[0],l.domain=i[1],i=["javascript:",function(t,n){var i,r,a=t.plugins.link,o=a.compiledProtectionFunction.params;r=[a.compiledProtectionFunction.name,"("];for(var s=0;s<o.length;s++)i=n[a=o[s].toLowerCase()],0<s&&r.push(","),r.push("'",i?e(encodeURIComponent(n[a])):"","'");return r.push(")"),r.join("")}(t,l)]}r["data-cke-saved-href"]=i.join("")}if(n.target)if("popup"==n.target.type){i=["window.open(this.href, '",n.target.name||"","', '"];var u="resizable status location toolbar menubar fullscreen scrollbars dependent".split(" ");for(a=u.length,o=function(e){n.target[e]&&u.push(e+"="+n.target[e])},l=0;l<a;l++)u[l]+=n.target[u[l]]?"=yes":"=no";o("width"),o("left"),o("height"),o("top"),i.push(u.join(","),"'); return false;"),r["data-cke-pa-onclick"]=i.join("")}else"notSet"!=n.target.type&&n.target.name&&(r.target=n.target.name);if(n.download&&(r.download=""),n.advanced){for(var c in h)(i=n.advanced[h[c]])&&(r[c]=i);r.name&&(r["data-cke-saved-name"]=r.name)}for(var d in r["data-cke-saved-href"]&&(r.href=r["data-cke-saved-href"]),c={target:1,onclick:1,"data-cke-pa-onclick":1,"data-cke-saved-name":1,download:1},n.advanced&&CKEDITOR.tools.extend(c,h),r)delete c[d];return{set:r,removed:CKEDITOR.tools.objectKeys(c)}},showDisplayTextForElement:function(e,t){return!(t.widgets&&t.widgets.focused||e&&e.getName&&e.is({img:1,table:1,tbody:1,thead:1,tfoot:1,input:1,select:1,textarea:1}))}},CKEDITOR.unlinkCommand=function(){},CKEDITOR.unlinkCommand.prototype={exec:function(e){var t=new CKEDITOR.style({element:"a",type:CKEDITOR.STYLE_INLINE,alwaysRemoveElement:1});e.removeStyle(t)},refresh:function(e,t){var n=t.lastElement&&t.lastElement.getAscendant("a",!0);n&&"a"==n.getName()&&n.getAttribute("href")&&n.getChildCount()?this.setState(CKEDITOR.TRISTATE_OFF):this.setState(CKEDITOR.TRISTATE_DISABLED)},contextSensitive:1,startDisabled:1,requiredContent:"a[href]"},CKEDITOR.removeAnchorCommand=function(){},CKEDITOR.removeAnchorCommand.prototype={exec:function(e){var t,n=e.getSelection(),i=n.createBookmarks();n&&(t=n.getSelectedElement())&&(t.getChildCount()?t.is("a"):CKEDITOR.plugins.link.tryRestoreFakeAnchor(e,t))?t.remove(1):(t=CKEDITOR.plugins.link.getSelectedLink(e))&&(t.hasAttribute("href")?(t.removeAttributes({name:1,"data-cke-saved-name":1}),t.removeClass("cke_anchor")):t.remove(1)),n.selectBookmarks(i)},requiredContent:"a[name]"},CKEDITOR.tools.extend(CKEDITOR.config,{linkShowAdvancedTab:!0,linkShowTargetTab:!0})}(),function(){function e(e,t,n){return d(t)&&d(n)&&n.equals(t.getNext(function(e){return!(W(e)||G(e)||h(e))}))}function t(e){this.upper=e[0],this.lower=e[1],this.set.apply(this,e.slice(2))}function n(e){var t=e.element;if(t&&d(t)&&(t=t.getAscendant(e.triggers,!0))&&e.editable.contains(t)){var n=o(t);if("true"==n.getAttribute("contenteditable"))return t;if(n.is(e.triggers))return n}return null}function i(e,t,n){return b(e,t),b(e,n),e=t.size.bottom,n=n.size.top,e&&n?0|(e+n)/2:e||n}function r(e,t,n){return t[n?"getPrevious":"getNext"](function(t){return t&&t.type==CKEDITOR.NODE_TEXT&&!W(t)||d(t)&&!h(t)&&!c(e,t)})}function a(e,t,n){return e>t&&e<n}function o(e,t){if(e.data("cke-editable"))return null;for(t||(e=e.getParent());e&&!e.data("cke-editable");){if(e.hasAttribute("contenteditable"))return e;e=e.getParent()}return null}function s(e){var t=e.doc,n=k('<span contenteditable="false" style="'+V+"position:absolute;border-top:1px dashed "+e.boxColor+'"></span>',t),i=CKEDITOR.getUrl(this.path+"images/"+(S.hidpi?"hidpi/":"")+"icon"+(e.rtl?"-rtl":"")+".png");for(C(n,{attach:function(){return this.wrap.getParent()||this.wrap.appendTo(e.editable,!0),this},lineChildren:[C(k('<span title="'+e.editor.lang.magicline.title+'" contenteditable="false">&#8629;</span>',t),{base:V+"height:17px;width:17px;"+(e.rtl?"left":"right")+":17px;background:url("+i+") center no-repeat "+e.boxColor+";cursor:pointer;"+(S.hc?"font-size: 15px;line-height:14px;border:1px solid #fff;text-align:center;":"")+(S.hidpi?"background-size: 9px 10px;":""),looks:["top:-8px; border-radius: 2px;","top:-17px; border-radius: 2px 2px 0px 0px;","top:-1px; border-radius: 0px 0px 2px 2px;"]}),C(k(H,t),{base:q+"left:0px;border-left-color:"+e.boxColor+";",looks:["border-width:8px 0 8px 8px;top:-8px","border-width:8px 0 0 8px;top:-8px","border-width:0 0 8px 8px;top:0px"]}),C(k(H,t),{base:q+"right:0px;border-right-color:"+e.boxColor+";",looks:["border-width:8px 8px 8px 0;top:-8px","border-width:8px 8px 0 0;top:-8px","border-width:0 8px 8px 0;top:0px"]})],detach:function(){return this.wrap.getParent()&&this.wrap.remove(),this},mouseNear:function(){b(e,this);var t=e.holdDistance,n=this.size;return!!(n&&a(e.mouse.y,n.top-t,n.bottom+t)&&a(e.mouse.x,n.left-t,n.right+t))},place:function(){var t=e.view,n=e.editable,i=e.trigger,r=i.upper,o=i.lower,s=r||o,l=s.getParent(),u={};for(var c in this.trigger=i,r&&b(e,r,!0),o&&b(e,o,!0),b(e,l,!0),e.inInlineMode&&_(e,!0),l.equals(n)?(u.left=t.scroll.x,u.right=-t.scroll.x,u.width=""):(u.left=s.size.left-s.size.margin.left+t.scroll.x-(e.inInlineMode?t.editable.left+t.editable.border.left:0),u.width=s.size.outerWidth+s.size.margin.left+s.size.margin.right+t.scroll.x,u.right=""),r&&o?u.top=r.size.margin.bottom===o.size.margin.top?0|r.size.bottom+r.size.margin.bottom/2:r.size.margin.bottom<o.size.margin.top?r.size.bottom+r.size.margin.bottom:r.size.bottom+r.size.margin.bottom-o.size.margin.top:r?o||(u.top=r.size.bottom+r.size.margin.bottom):u.top=o.size.top-o.size.margin.top,i.is(L)||a(u.top,t.scroll.y-15,t.scroll.y+5)?(u.top=e.inInlineMode?0:t.scroll.y,this.look(L)):i.is(N)||a(u.top,t.pane.bottom-5,t.pane.bottom+15)?(u.top=e.inInlineMode?t.editable.height+t.editable.padding.top+t.editable.padding.bottom:t.pane.bottom-1,this.look(N)):(e.inInlineMode&&(u.top-=t.editable.top+t.editable.border.top),this.look(M)),e.inInlineMode&&(u.top--,u.top+=t.editable.scroll.top,u.left+=t.editable.scroll.left),u)u[c]=CKEDITOR.tools.cssLength(u[c]);this.setStyles(u)},look:function(e){if(this.oldLook!=e){for(var t,n=this.lineChildren.length;n--;)(t=this.lineChildren[n]).setAttribute("style",t.base+t.looks[0|e/2]);this.oldLook=e}},wrap:new w("span",e.doc)}),t=n.lineChildren.length;t--;)n.lineChildren[t].appendTo(n);n.look(M),n.appendTo(n.wrap),n.unselectable(),n.lineChildren[0].on("mouseup",function(t){n.detach(),l(e,function(t){var n=e.line.trigger;t[n.is(R)?"insertBefore":"insertAfter"](n.is(R)?n.lower:n.upper)},!0),e.editor.focus(),S.ie||e.enterMode==CKEDITOR.ENTER_BR||e.hotNode.scrollIntoView(),t.data.preventDefault(!0)}),n.on("mousedown",function(e){e.data.preventDefault(!0)}),e.line=n}function l(e,t,n){var i,r=new CKEDITOR.dom.range(e.doc),a=e.editor;S.ie&&e.enterMode==CKEDITOR.ENTER_BR?i=e.doc.createText(K):(i=(i=o(e.element,!0))&&i.data("cke-enter-mode")||e.enterMode,(i=new w(D[i],e.doc)).is("br")||e.doc.createText(K).appendTo(i)),n&&a.fire("saveSnapshot"),t(i),r.moveToPosition(i,CKEDITOR.POSITION_AFTER_START),a.getSelection().selectRanges([r]),e.hotNode=i,n&&a.fire("saveSnapshot")}function u(e,t){return{canUndo:!0,modes:{wysiwyg:1},exec:function(){function i(n){var i=S.ie&&9>S.version?" ":K,r=e.hotNode&&e.hotNode.getText()==i&&e.element.equals(e.hotNode)&&e.lastCmdDirection===!!t;l(e,function(i){r&&e.hotNode&&e.hotNode.remove(),i[t?"insertAfter":"insertBefore"](n),i.setAttributes({"data-cke-magicline-hot":1,"data-cke-magicline-dir":!!t}),e.lastCmdDirection=!!t}),S.ie||e.enterMode==CKEDITOR.ENTER_BR||e.hotNode.scrollIntoView(),e.line.detach()}return function(a){var s,l;a=(a=a.getSelection().getStartElement()).getAscendant(F,1),g(e,a)||!a||a.equals(e.editable)||a.contains(e.editable)||((s=o(a))&&"false"==s.getAttribute("contenteditable")&&(a=s),e.element=a,d(s=r(e,a,!t))&&s.is(e.triggers)&&s.is(B)&&(!r(e,s,!t)||(l=r(e,s,!t))&&d(l)&&l.is(e.triggers))?i(s):d(l=n(e))&&(r(e,l,!t)?(a=r(e,l,!t))&&d(a)&&a.is(e.triggers)&&i(l):i(l)))}}()}}function c(e,t){if(!t||t.type!=CKEDITOR.NODE_ELEMENT||!t.$)return!1;var n=e.line;return n.wrap.equals(t)||n.wrap.contains(t)}function d(e){return e&&e.type==CKEDITOR.NODE_ELEMENT&&e.$}function h(e){return!!d(e)&&((t=p(e))||(t=!(!d(e)||!(t={left:1,right:1,center:1})[e.getComputedStyle("float")]&&!t[e.getAttribute("align")])),t);var t}function p(e){return!!{absolute:1,fixed:1}[e.getComputedStyle("position")]}function f(e,t){return d(t)?t.is(e.triggers):null}function g(e,t){if(!t)return!1;for(var n=t.getParents(1),i=n.length;i--;)for(var r=e.tabuList.length;r--;)if(n[i].hasAttribute(e.tabuList[r]))return!0;return!1}function m(e){var n=e.editable,i=e.mouse,r=e.view,o=e.triggerOffset;_(e);var s=i.y>(e.inInlineMode?r.editable.top+r.editable.height/2:Math.min(r.editable.height,r.pane.height)/2);return(n=n[s?"getLast":"getFirst"](function(e){return!(W(e)||G(e))}))?(c(e,n)&&(n=e.line.wrap[s?"getPrevious":"getNext"](function(e){return!(W(e)||G(e))})),d(n)&&!h(n)&&f(e,n)?(b(e,n),!s&&0<=n.size.top&&a(i.y,0,n.size.top+o)?(e=e.inInlineMode||0===r.scroll.y?L:M,new t([null,n,R,P,e])):s&&n.size.bottom<=r.pane.height&&a(i.y,n.size.bottom-o,r.pane.height)?(e=e.inInlineMode||a(n.size.bottom,r.pane.height-o,r.pane.height)?N:M,new t([n,null,x,P,e])):null):null):null}function v(e){var i=e.mouse,o=e.view,s=e.triggerOffset,l=n(e);if(!l)return null;b(e,l),s=Math.min(s,0|l.size.outerHeight/2);var u,c,p=[];if(a(i.y,l.size.top-1,l.size.top+s))c=!1;else{if(!a(i.y,l.size.bottom-s,l.size.bottom+1))return null;c=!0}if(h(l)||function(e,t,n){return!!(t=t[n?"getLast":"getFirst"](function(t){return e.isRelevant(t)&&!t.is(j)}))&&(b(e,t),n?t.size.top>e.mouse.y:t.size.bottom<e.mouse.y)}(e,l,c)||l.getParent().is($))return null;var g=r(e,l,!c);if(g){if(g&&g.type==CKEDITOR.NODE_TEXT)return null;if(d(g)){if(h(g)||!f(e,g)||g.getParent().is($))return null;p=[g,l][c?"reverse":"concat"]().concat([A,P])}}else l.equals(e.editable[c?"getLast":"getFirst"](e.isRelevant))?(_(e),c&&a(i.y,l.size.bottom-s,o.pane.height)&&a(l.size.bottom,o.pane.height-s,o.pane.height)?u=N:a(i.y,0,l.size.top+s)&&(u=L)):u=M,p=[null,l][c?"reverse":"concat"]().concat([c?x:R,P,u,l.equals(e.editable[c?"getLast":"getFirst"](e.isRelevant))?c?N:L:M]);return 0 in p?new t(p):null}function y(e,t,n,i){for(var r=t.getDocumentPosition(),a={},o={},s={},l={},u=Y.length;u--;)a[Y[u]]=parseInt(t.getComputedStyle.call(t,"border-"+Y[u]+"-width"),10)||0,s[Y[u]]=parseInt(t.getComputedStyle.call(t,"padding-"+Y[u]),10)||0,o[Y[u]]=parseInt(t.getComputedStyle.call(t,"margin-"+Y[u]),10)||0;return n&&!i||T(e,i),l.top=r.y-(n?0:e.view.scroll.y),l.left=r.x-(n?0:e.view.scroll.x),l.outerWidth=t.$.offsetWidth,l.outerHeight=t.$.offsetHeight,l.height=l.outerHeight-(s.top+s.bottom+a.top+a.bottom),l.width=l.outerWidth-(s.left+s.right+a.left+a.right),l.bottom=l.top+l.outerHeight,l.right=l.left+l.outerWidth,e.inInlineMode&&(l.scroll={top:t.$.scrollTop,left:t.$.scrollLeft}),C({border:a,padding:s,margin:o,ignoreScroll:n},l,!0)}function b(e,t,n){if(!d(t))return t.size=null;if(t.size){if(t.size.ignoreScroll==n&&t.size.date>new Date-U)return null}else t.size={};return C(t.size,y(e,t,n),{date:+new Date},!0)}function _(e,t){e.view.editable=y(e,e.editable,t,!0)}function T(e,t){e.view||(e.view={});var n=e.view;if(!(!t&&n&&n.date>new Date-U)){n=(i=e.win).getScrollPosition();var i=i.getViewPaneSize();C(e.view,{scroll:{x:n.x,y:n.y,width:e.doc.$.documentElement.scrollWidth-i.width,height:e.doc.$.documentElement.scrollHeight-i.height},pane:{width:i.width,height:i.height,bottom:i.height+n.y},date:+new Date},!0)}}function E(e,n,i,r){for(var a=r,o=r,s=0,l=!1,u=!1,c=e.view.pane.height,d=e.mouse;d.y+s<c&&0<d.y-s&&(l||(l=n(a,r)),u||(u=n(o,r)),!l&&0<d.y-s&&(a=i(e,{x:d.x,y:d.y-s})),!u&&d.y+s<c&&(o=i(e,{x:d.x,y:d.y+s})),!l||!u);)s+=2;return new t([a,o,null,null])}CKEDITOR.plugins.add("magicline",{init:function(e){var i,a,o,f=e.config,b=f.magicline_triggerOffset||30,E={editor:e,enterMode:f.enterMode,triggerOffset:b,holdDistance:0|b*(f.magicline_holdDistance||.5),boxColor:f.magicline_color||"#ff0000",rtl:"rtl"==f.contentsLangDirection,tabuList:["data-cke-hidden-sel"].concat(f.magicline_tabuList||[]),triggers:f.magicline_everywhere?F:{table:1,hr:1,div:1,ul:1,ol:1,dl:1,form:1,blockquote:1},isRelevant:function(e){return d(e)&&!c(E,e)&&!h(e)}};e.on("contentDom",function(){var d=e.editable(),h=e.document,b=e.window;C(E,{editable:d,inInlineMode:d.isInline(),doc:h,win:b,hotNode:null},!0),E.boundary=E.inInlineMode?E.editable:E.doc.getDocumentElement(),d.is(O.$inline)||(E.inInlineMode&&!p(d)&&d.setStyles({position:"relative",top:null,left:null}),s.call(this,E),T(E),d.attachListener(e,"beforeUndoImage",function(){E.line.detach()}),d.attachListener(e,"beforeGetData",function(){E.line.wrap.getParent()&&(E.line.detach(),e.once("getData",function(){E.line.attach()},null,null,1e3))},null,null,0),d.attachListener(E.inInlineMode?h:h.getWindow().getFrame(),"mouseout",function(t){if("wysiwyg"==e.mode)if(E.inInlineMode){var n=t.data.$.clientX;t=t.data.$.clientY,T(E),_(E,!0);var i=E.view.editable,r=E.view.scroll;n>i.left-r.x&&n<i.right-r.x&&t>i.top-r.y&&t<i.bottom-r.y||(clearTimeout(o),o=null,E.line.detach())}else clearTimeout(o),o=null,E.line.detach()}),d.attachListener(d,"keyup",function(){E.hiddenMode=0}),d.attachListener(d,"keydown",function(t){if("wysiwyg"==e.mode)switch(t.data.getKeystroke()){case 2228240:case 16:E.hiddenMode=1,E.line.detach()}}),d.attachListener(E.inInlineMode?d:h,"mousemove",function(t){if(a=!0,"wysiwyg"==e.mode&&!e.readOnly&&!o){var n={x:t.data.$.clientX,y:t.data.$.clientY};o=setTimeout(function(){E.mouse=n,o=E.trigger=null,T(E),a&&!E.hiddenMode&&e.focusManager.hasFocus&&!E.line.mouseNear()&&(E.element=z(E,!0))&&((E.trigger=m(E)||v(E)||X(E))&&!g(E,E.trigger.upper||E.trigger.lower)?E.line.attach().place():(E.trigger=null,E.line.detach()),a=!1)},30)}}),d.attachListener(b,"scroll",function(){"wysiwyg"==e.mode&&(E.line.detach(),S.webkit&&(E.hiddenMode=1,clearTimeout(i),i=setTimeout(function(){E.mouseDown||(E.hiddenMode=0)},50)))}),d.attachListener(I?h:b,"mousedown",function(){"wysiwyg"==e.mode&&(E.line.detach(),E.hiddenMode=1,E.mouseDown=1)}),d.attachListener(I?h:b,"mouseup",function(){E.hiddenMode=0,E.mouseDown=0}),e.addCommand("accessPreviousSpace",u(E)),e.addCommand("accessNextSpace",u(E,!0)),e.setKeystroke([[f.magicline_keystrokePrevious,"accessPreviousSpace"],[f.magicline_keystrokeNext,"accessNextSpace"]]),e.on("loadSnapshot",function(){var t,n,i,r;for(r in{p:1,br:1,div:1})for(i=(t=e.document.getElementsByTag(r)).count();i--;)if((n=t.getItem(i)).data("cke-magicline-hot"))return E.hotNode=n,void(E.lastCmdDirection="true"===n.data("cke-magicline-dir"))}),this.backdoor={accessFocusSpace:l,boxTrigger:t,isLine:c,getAscendantTrigger:n,getNonEmptyNeighbour:r,getSize:y,that:E,triggerEdge:v,triggerEditable:m,triggerExpand:X})},this)}});var C=CKEDITOR.tools.extend,w=CKEDITOR.dom.element,k=w.createFromHtml,S=CKEDITOR.env,I=CKEDITOR.env.ie&&9>CKEDITOR.env.version,O=CKEDITOR.dtd,D={},R=128,x=64,A=32,P=16,L=4,N=2,M=1,K=" ",$=O.$listItem,j=O.$tableContent,B=C({},O.$nonEditable,O.$empty),F=O.$block,U=100,V="width:0px;height:0px;padding:0px;margin:0px;display:block;z-index:9999;color:#fff;position:absolute;font-size: 0px;line-height:0px;",q=V+"border-color:transparent;display:block;border-style:solid;",H="<span>"+K+"</span>";D[CKEDITOR.ENTER_BR]="br",D[CKEDITOR.ENTER_P]="p",D[CKEDITOR.ENTER_DIV]="div",t.prototype={set:function(e,t,n){return this.properties=e+t+(n||M),this},is:function(e){return(this.properties&e)==e}};var z=function(){function e(e,t){var n=e.$.elementFromPoint(t.x,t.y);return n&&n.nodeType?new CKEDITOR.dom.element(n):null}return function(t,n,i){if(!t.mouse)return null;var r=t.doc,a=t.line.wrap,o=e(r,i=i||t.mouse);return n&&c(t,o)&&(a.hide(),o=e(r,i),a.show()),!o||o.type!=CKEDITOR.NODE_ELEMENT||!o.$||S.ie&&9>S.version&&!t.boundary.equals(o)&&!t.boundary.contains(o)?null:o}}(),W=CKEDITOR.dom.walker.whitespaces(),G=CKEDITOR.dom.walker.nodeType(CKEDITOR.NODE_COMMENT),X=function(){function t(t){var r,o,s;if(!d(p=t.element)||p.contains(t.editable)||p.isReadOnly())return null;if(e(0,r=(s=E(t,function(e,t){return!t.equals(e)},function(e,t){return z(e,!0,t)},p)).upper,o=s.lower))return s.set(A,8);if(r&&p.contains(r))for(;!r.getParent().equals(p);)r=r.getParent();else r=p.getFirst(function(e){return n(t,e)});if(o&&p.contains(o))for(;!o.getParent().equals(p);)o=o.getParent();else o=p.getLast(function(e){return n(t,e)});if(!r||!o)return null;if(b(t,r),b(t,o),!a(t.mouse.y,r.size.top,o.size.bottom))return null;for(var l,u,c,h,p=Number.MAX_VALUE;o&&!o.equals(r)&&(u=r.getNext(t.isRelevant));)(l=Math.abs(i(t,r,u)-t.mouse.y))<p&&(p=l,c=r,h=u),b(t,r=u);return c&&h&&a(t.mouse.y,c.size.top,h.size.bottom)?(s.upper=c,s.lower=h,s.set(A,8)):null}function n(e,t){return!(t&&t.type==CKEDITOR.NODE_TEXT||G(t)||h(t)||c(e,t)||t.type==CKEDITOR.NODE_ELEMENT&&t.$&&t.is("br"))}return function(n){var i,r=t(n);if(i=r){i=r.upper;var a=r.lower;i=!(!i||!a||h(a)||h(i)||a.equals(i)||i.equals(a)||a.contains(i)||i.contains(a)||!(f(n,i)&&f(n,a)&&e(0,i,a)))}return i?r:null}}(),Y=["top","left","right","bottom"]}(),CKEDITOR.config.magicline_keystrokePrevious=CKEDITOR.CTRL+CKEDITOR.SHIFT+51,CKEDITOR.config.magicline_keystrokeNext=CKEDITOR.CTRL+CKEDITOR.SHIFT+52,function(){function e(e){if(!e||e.type!=CKEDITOR.NODE_ELEMENT||"form"!=e.getName())return[];for(var t=[],n=["style","className"],i=0;i<n.length;i++){var r=e.$.elements.namedItem(n[i]);r&&(r=new CKEDITOR.dom.element(r),t.push([r,r.nextSibling]),r.remove())}return t}function t(e,t){if(e&&e.type==CKEDITOR.NODE_ELEMENT&&"form"==e.getName()&&0<t.length)for(var n=t.length-1;0<=n;n--){var i=t[n][0],r=t[n][1];r?i.insertBefore(r):i.appendTo(e)}}function n(n,i){var r=e(n),a={},o=n.$;return i||(a.class=o.className||"",o.className=""),a.inline=o.style.cssText||"",i||(o.style.cssText="position: static; overflow: visible"),t(r),a}function i(n,i){var r=e(n),a=n.$;"class"in i&&(a.className=i.class),"inline"in i&&(a.style.cssText=i.inline),t(r)}function r(e){if(!e.editable().isInline()){var t,n=CKEDITOR.instances;for(t in n){var i=n[t];"wysiwyg"!=i.mode||i.readOnly||((i=i.document.getBody()).setAttribute("contentEditable",!1),i.setAttribute("contentEditable",!0))}e.editable().hasFocus&&(e.toolbox.focus(),e.focus())}}CKEDITOR.plugins.add("maximize",{init:function(e){function t(){var t=c.getViewPaneSize();e.resize(t.width,t.height,null,!0)}if(e.elementMode!=CKEDITOR.ELEMENT_MODE_INLINE){var a,o,s,l=e.lang,u=CKEDITOR.document,c=u.getWindow(),d=CKEDITOR.TRISTATE_OFF;e.addCommand("maximize",{modes:{wysiwyg:!CKEDITOR.env.iOS,source:!CKEDITOR.env.iOS},readOnly:1,editorFocus:!1,exec:function(){var h=e.container.getFirst(function(e){return e.type==CKEDITOR.NODE_ELEMENT&&e.hasClass("cke_inner")}),p=e.ui.space("contents");if("wysiwyg"==e.mode){var f=e.getSelection();a=f&&f.getRanges(),o=c.getScrollPosition()}else{var g=e.editable().$;a=!CKEDITOR.env.ie&&[g.selectionStart,g.selectionEnd],o=[g.scrollLeft,g.scrollTop]}if(this.state==CKEDITOR.TRISTATE_OFF){for(c.on("resize",t),s=c.getScrollPosition(),f=e.container;f=f.getParent();)f.setCustomData("maximize_saved_styles",n(f)),f.setStyle("z-index",e.config.baseFloatZIndex-5);p.setCustomData("maximize_saved_styles",n(p,!0)),h.setCustomData("maximize_saved_styles",n(h,!0)),p={overflow:CKEDITOR.env.webkit?"":"hidden",width:0,height:0},u.getDocumentElement().setStyles(p),!CKEDITOR.env.gecko&&u.getDocumentElement().setStyle("position","fixed"),CKEDITOR.env.gecko&&CKEDITOR.env.quirks||u.getBody().setStyles(p),CKEDITOR.env.ie?setTimeout(function(){c.$.scrollTo(0,0)},0):c.$.scrollTo(0,0),h.setStyle("position",CKEDITOR.env.gecko&&CKEDITOR.env.quirks?"fixed":"absolute"),h.$.offsetLeft,h.setStyles({"z-index":e.config.baseFloatZIndex-5,left:"0px",top:"0px"}),h.addClass("cke_maximized"),t(),p=h.getDocumentPosition(),h.setStyles({left:-1*p.x+"px",top:-1*p.y+"px"}),CKEDITOR.env.gecko&&r(e)}else if(this.state==CKEDITOR.TRISTATE_ON){c.removeListener("resize",t),f=[p,h];for(var m=0;m<f.length;m++)i(f[m],f[m].getCustomData("maximize_saved_styles")),f[m].removeCustomData("maximize_saved_styles");for(f=e.container;f=f.getParent();)i(f,f.getCustomData("maximize_saved_styles")),f.removeCustomData("maximize_saved_styles");CKEDITOR.env.ie?setTimeout(function(){c.$.scrollTo(s.x,s.y)},0):c.$.scrollTo(s.x,s.y),h.removeClass("cke_maximized"),CKEDITOR.env.webkit&&(h.setStyle("display","inline"),setTimeout(function(){h.setStyle("display","block")},0)),e.fire("resize",{outerHeight:e.container.$.offsetHeight,contentsHeight:p.$.offsetHeight,outerWidth:e.container.$.offsetWidth})}this.toggleState(),(f=this.uiItems[0])&&(p=this.state==CKEDITOR.TRISTATE_OFF?l.maximize.maximize:l.maximize.minimize,(f=CKEDITOR.document.getById(f._.id)).getChild(1).setHtml(p),f.setAttribute("title",p),f.setAttribute("href",'javascript:void("'+p+'");')),"wysiwyg"==e.mode?a?(CKEDITOR.env.gecko&&r(e),e.getSelection().selectRanges(a),(g=e.getSelection().getStartElement())&&g.scrollIntoView(!0)):c.$.scrollTo(o.x,o.y):(a&&(g.selectionStart=a[0],g.selectionEnd=a[1]),g.scrollLeft=o[0],g.scrollTop=o[1]),a=o=null,d=this.state,e.fire("maximize",this.state)},canUndo:!1}),e.ui.addButton&&e.ui.addButton("Maximize",{label:l.maximize.maximize,command:"maximize",toolbar:"tools,10"}),e.on("mode",function(){var t=e.getCommand("maximize");t.setState(t.state==CKEDITOR.TRISTATE_DISABLED?CKEDITOR.TRISTATE_DISABLED:d)},null,null,100)}}})}(),function(){function e(e){e.data.type="html"}CKEDITOR.plugins.add("pastefromword",{requires:"clipboard",init:function(t){var n=0,i=this.path;t.addCommand("pastefromword",{canUndo:!1,async:!0,exec:function(t){var i=this;n=1,t.once("beforePaste",e),t.getClipboardData({title:t.lang.pastefromword.title},function(e){e&&t.fire("paste",{type:"html",dataValue:e.dataValue,method:"paste",dataTransfer:CKEDITOR.plugins.clipboard.initPasteDataTransfer()}),t.fire("afterCommandExec",{name:"pastefromword",command:i,returnValue:!!e})})}}),t.ui.addButton&&t.ui.addButton("PasteFromWord",{label:t.lang.pastefromword.toolbar,command:"pastefromword",toolbar:"clipboard,50"}),t.on("pasteState",function(e){t.getCommand("pastefromword").setState(e.data)}),t.on("paste",function(e){var r=e.data,a=r.dataValue,o={dataValue:a};if(a&&(n||/(class=\"?Mso|style=\"[^\"]*\bmso\-|w:WordDocument|<o:\w+>|<\/font>)/.test(a))&&(!1!==t.fire("pasteFromWord",o)||n)){r.dontFilter=!0;var s=function(e,t,n){var i=CKEDITOR.cleanWord;return i?n():(e=CKEDITOR.getUrl(e.config.pasteFromWordCleanupFile||t+"filter/default.js"),CKEDITOR.scriptLoader.load(e,n,null,!0)),!i}(t,i,function(){s?t.fire("paste",r):(!t.config.pasteFromWordPromptCleanup||n||confirm(t.lang.pastefromword.confirmCleanup))&&(o.dataValue=CKEDITOR.cleanWord(o.dataValue,t),t.fire("afterPasteFromWord",o),r.dataValue=o.dataValue),n=0});s&&e.cancel()}},null,null,3)}})}(),function(){var e={canUndo:!1,async:!0,exec:function(t){t.getClipboardData({title:t.lang.pastetext.title},function(n){n&&t.fire("paste",{type:"text",dataValue:n.dataValue,method:"paste",dataTransfer:CKEDITOR.plugins.clipboard.initPasteDataTransfer()}),t.fire("afterCommandExec",{name:"pastetext",command:e,returnValue:!!n})})}};CKEDITOR.plugins.add("pastetext",{requires:"clipboard",init:function(t){t.addCommand("pastetext",e),t.ui.addButton&&t.ui.addButton("PasteText",{label:t.lang.pastetext.button,command:"pastetext",toolbar:"clipboard,40"}),t.config.forcePasteAsPlainText&&t.on("beforePaste",function(e){"html"!=e.data.type&&(e.data.type="text")}),t.on("pasteState",function(e){t.getCommand("pastetext").setState(e.data)})}})}(),CKEDITOR.plugins.add("removeformat",{init:function(e){e.addCommand("removeFormat",CKEDITOR.plugins.removeformat.commands.removeformat),e.ui.addButton&&e.ui.addButton("RemoveFormat",{label:e.lang.removeformat.toolbar,command:"removeFormat",toolbar:"cleanup,10"})}}),CKEDITOR.plugins.removeformat={commands:{removeformat:{exec:function(e){for(var t,n=e._.removeFormatRegex||(e._.removeFormatRegex=new RegExp("^(?:"+e.config.removeFormatTags.replace(/,/g,"|")+")$","i")),i=e._.removeAttributes||(e._.removeAttributes=e.config.removeFormatAttributes.split(",")),r=CKEDITOR.plugins.removeformat.filter,a=e.getSelection().getRanges(),o=a.createIterator(),s=function(e){return e.type==CKEDITOR.NODE_ELEMENT};t=o.getNextRange();){t.collapsed||t.enlarge(CKEDITOR.ENLARGE_ELEMENT);var l=t.createBookmark(),u=l.startNode,c=l.endNode,d=function(t){for(var i,a=e.elementPath(t),o=a.elements,s=1;(i=o[s])&&!i.equals(a.block)&&!i.equals(a.blockLimit);s++)n.test(i.getName())&&r(e,i)&&t.breakParent(i)};if(d(u),c)for(d(c),u=u.getNextSourceNode(!0,CKEDITOR.NODE_ELEMENT);u&&!u.equals(c);)if(u.isReadOnly()){if(u.getPosition(c)&CKEDITOR.POSITION_CONTAINS)break;u=u.getNext(s)}else d=u.getNextSourceNode(!1,CKEDITOR.NODE_ELEMENT),"img"==u.getName()&&u.data("cke-realelement")||!r(e,u)||(n.test(u.getName())?u.remove(1):(u.removeAttributes(i),e.fire("removeFormatCleanup",u))),u=d;t.moveToBookmark(l)}e.forceNextSelectionCheck(),e.getSelection().selectRanges(a)}}},filter:function(e,t){for(var n=e._.removeFormatFilters||[],i=0;i<n.length;i++)if(!1===n[i](t))return!1;return!0}},CKEDITOR.editor.prototype.addRemoveFormatFilter=function(e){this._.removeFormatFilters||(this._.removeFormatFilters=[]),this._.removeFormatFilters.push(e)},CKEDITOR.config.removeFormatTags="b,big,cite,code,del,dfn,em,font,i,ins,kbd,q,s,samp,small,span,strike,strong,sub,sup,tt,u,var",CKEDITOR.config.removeFormatAttributes="class,style,lang,width,height,align,hspace,valign",CKEDITOR.plugins.add("resize",{init:function(e){function t(t){var n=s.width,r=s.height,l=n+(t.data.$.screenX-o.x)*("rtl"==a?-1:1);t=r+(t.data.$.screenY-o.y),u&&(n=Math.max(i.resize_minWidth,Math.min(l,i.resize_maxWidth))),c&&(r=Math.max(i.resize_minHeight,Math.min(t,i.resize_maxHeight))),e.resize(u?n:null,r)}function n(){CKEDITOR.document.removeListener("mousemove",t),CKEDITOR.document.removeListener("mouseup",n),e.document&&(e.document.removeListener("mousemove",t),e.document.removeListener("mouseup",n))}var i=e.config,r=e.ui.spaceId("resizer"),a=e.element?e.element.getDirection(1):"ltr";if(!i.resize_dir&&(i.resize_dir="vertical"),void 0===i.resize_maxWidth&&(i.resize_maxWidth=3e3),void 0===i.resize_maxHeight&&(i.resize_maxHeight=3e3),void 0===i.resize_minWidth&&(i.resize_minWidth=750),void 0===i.resize_minHeight&&(i.resize_minHeight=250),!1!==i.resize_enabled){var o,s,l=null,u=("both"==i.resize_dir||"horizontal"==i.resize_dir)&&i.resize_minWidth!=i.resize_maxWidth,c=("both"==i.resize_dir||"vertical"==i.resize_dir)&&i.resize_minHeight!=i.resize_maxHeight,d=CKEDITOR.tools.addFunction(function(r){l||(l=e.getResizable()),s={width:l.$.offsetWidth||0,height:l.$.offsetHeight||0},o={x:r.screenX,y:r.screenY},i.resize_minWidth>s.width&&(i.resize_minWidth=s.width),i.resize_minHeight>s.height&&(i.resize_minHeight=s.height),CKEDITOR.document.on("mousemove",t),CKEDITOR.document.on("mouseup",n),e.document&&(e.document.on("mousemove",t),e.document.on("mouseup",n)),r.preventDefault&&r.preventDefault()});e.on("destroy",function(){CKEDITOR.tools.removeFunction(d)}),e.on("uiSpace",function(t){if("bottom"==t.data.space){var n="";u&&!c&&(n=" cke_resizer_horizontal"),!u&&c&&(n=" cke_resizer_vertical");var i='<span id="'+r+'" class="cke_resizer'+n+" cke_resizer_"+a+'" title="'+CKEDITOR.tools.htmlEncode(e.lang.common.resize)+'" onmousedown="CKEDITOR.tools.callFunction('+d+', event)">'+("ltr"==a?"◢":"◣")+"</span>";"ltr"==a&&"ltr"==n?t.data.html+=i:t.data.html=i+t.data.html}},e,null,100),e.on("maximize",function(t){e.ui.space("resizer")[t.data==CKEDITOR.TRISTATE_ON?"hide":"show"]()})}}}),CKEDITOR.plugins.add("menubutton",{requires:"button,menu",onLoad:function(){var e=function(e){var t=this._,n=t.menu;t.state!==CKEDITOR.TRISTATE_DISABLED&&(t.on&&n?n.hide():(t.previousState=t.state,n||((n=t.menu=new CKEDITOR.menu(e,{panel:{className:"cke_menu_panel",attributes:{"aria-label":e.lang.common.options}}})).onHide=CKEDITOR.tools.bind(function(){var n=this.command?e.getCommand(this.command).modes:this.modes;this.setState(!n||n[e.mode]?t.previousState:CKEDITOR.TRISTATE_DISABLED),t.on=0},this),this.onMenu&&n.addListener(this.onMenu)),this.setState(CKEDITOR.TRISTATE_ON),t.on=1,setTimeout(function(){n.show(CKEDITOR.document.getById(t.id),4)},0)))};CKEDITOR.ui.menuButton=CKEDITOR.tools.createClass({base:CKEDITOR.ui.button,$:function(t){delete t.panel,this.base(t),this.hasArrow=!0,this.click=e},statics:{handler:{create:function(e){return new CKEDITOR.ui.menuButton(e)}}}})},beforeInit:function(e){e.ui.addHandler(CKEDITOR.UI_MENUBUTTON,CKEDITOR.ui.menuButton.handler)}}),CKEDITOR.UI_MENUBUTTON="menubutton",CKEDITOR.plugins.add("scayt",{requires:"menubutton,dialog",tabToOpen:null,dialogName:"scaytDialog",onLoad:function(e){CKEDITOR.plugins.scayt.onLoadTimestamp=(new Date).getTime(),"moono-lisa"==(CKEDITOR.skinName||e.config.skin)&&CKEDITOR.document.appendStyleSheet(this.path+"skins/"+CKEDITOR.skin.name+"/scayt.css")},init:function(e){var t=this,n=CKEDITOR.plugins.scayt;this.bindEvents(e),this.parseConfig(e),this.addRule(e),CKEDITOR.dialog.add(this.dialogName,CKEDITOR.getUrl(this.path+"dialogs/options.js")),this.addMenuItems(e);var i=e.lang.scayt,r=CKEDITOR.env;e.ui.add("Scayt",CKEDITOR.UI_MENUBUTTON,{label:i.text_title,title:e.plugins.wsc?e.lang.wsc.title:i.text_title,modes:{wysiwyg:!(r.ie&&(8>r.version||r.quirks))},toolbar:"spellchecker,20",refresh:function(){var t=e.ui.instances.Scayt.getState();e.scayt&&(t=n.state.scayt[e.name]?CKEDITOR.TRISTATE_ON:CKEDITOR.TRISTATE_OFF),e.fire("scaytButtonState",t)},onRender:function(){var t=this;e.on("scaytButtonState",function(e){void 0!==typeof e.data&&t.setState(e.data)})},onMenu:function(){var t=e.scayt;return e.getMenuItem("scaytToggle").label=e.lang.scayt[t&&n.state.scayt[e.name]?"btn_disable":"btn_enable"],t={scaytToggle:CKEDITOR.TRISTATE_OFF,scaytOptions:t?CKEDITOR.TRISTATE_OFF:CKEDITOR.TRISTATE_DISABLED,scaytLangs:t?CKEDITOR.TRISTATE_OFF:CKEDITOR.TRISTATE_DISABLED,scaytDict:t?CKEDITOR.TRISTATE_OFF:CKEDITOR.TRISTATE_DISABLED,scaytAbout:t?CKEDITOR.TRISTATE_OFF:CKEDITOR.TRISTATE_DISABLED,WSC:e.plugins.wsc?CKEDITOR.TRISTATE_OFF:CKEDITOR.TRISTATE_DISABLED},e.config.scayt_uiTabs[0]||delete t.scaytOptions,e.config.scayt_uiTabs[1]||delete t.scaytLangs,e.config.scayt_uiTabs[2]||delete t.scaytDict,t}}),e.contextMenu&&e.addMenuItems&&(e.contextMenu.addListener(function(n,i){var r,a,o=e.scayt;return o&&(a=o.getSelectionNode())&&(r=t.menuGenerator(e,a),o.showBanner("."+e.contextMenu._.definition.panel.className.split(" ").join(" ."))),r}),e.contextMenu._.onHide=CKEDITOR.tools.override(e.contextMenu._.onHide,function(t){return function(){var n=e.scayt;return n&&n.hideBanner(),t.apply(this)}}))},addMenuItems:function(e){var t=this,n=CKEDITOR.plugins.scayt;e.addMenuGroup("scaytButton");for(var i=e.config.scayt_contextMenuItemsOrder.split("|"),r=0;r<i.length;r++)i[r]="scayt_"+i[r];if((i=["grayt_description","grayt_suggest","grayt_control"].concat(i))&&i.length)for(r=0;r<i.length;r++)e.addMenuGroup(i[r],r-10);e.addCommand("scaytToggle",{exec:function(e){var t=e.scayt;n.state.scayt[e.name]=!n.state.scayt[e.name],!0===n.state.scayt[e.name]?t||n.createScayt(e):t&&n.destroy(e)}}),e.addCommand("scaytAbout",{exec:function(e){e.scayt.tabToOpen="about",e.lockSelection(),e.openDialog(t.dialogName)}}),e.addCommand("scaytOptions",{exec:function(e){e.scayt.tabToOpen="options",e.lockSelection(),e.openDialog(t.dialogName)}}),e.addCommand("scaytLangs",{exec:function(e){e.scayt.tabToOpen="langs",e.lockSelection(),e.openDialog(t.dialogName)}}),e.addCommand("scaytDict",{exec:function(e){e.scayt.tabToOpen="dictionaries",e.lockSelection(),e.openDialog(t.dialogName)}}),i={scaytToggle:{label:e.lang.scayt.btn_enable,group:"scaytButton",command:"scaytToggle"},scaytAbout:{label:e.lang.scayt.btn_about,group:"scaytButton",command:"scaytAbout"},scaytOptions:{label:e.lang.scayt.btn_options,group:"scaytButton",command:"scaytOptions"},scaytLangs:{label:e.lang.scayt.btn_langs,group:"scaytButton",command:"scaytLangs"},scaytDict:{label:e.lang.scayt.btn_dictionaries,group:"scaytButton",command:"scaytDict"}},e.plugins.wsc&&(i.WSC={label:e.lang.wsc.toolbar,group:"scaytButton",onClick:function(){var t=CKEDITOR.plugins.scayt,n=e.scayt,i=e.elementMode==CKEDITOR.ELEMENT_MODE_INLINE?e.container.getText():e.document.getBody().getText();(i=i.replace(/\s/g,""))?(n&&t.state.scayt[e.name]&&n.setMarkupPaused&&n.setMarkupPaused(!0),e.lockSelection(),e.execCommand("checkspell")):alert("Nothing to check!")}}),e.addMenuItems(i)},bindEvents:function(e){var t=CKEDITOR.plugins.scayt,n=e.elementMode==CKEDITOR.ELEMENT_MODE_INLINE,i=function(){t.destroy(e)},r=function(){!t.state.scayt[e.name]||e.readOnly||e.scayt||t.createScayt(e)},a=function(){n?e.config.scayt_inlineModeImmediateMarkup?r():(e.on("blur",function(){setTimeout(i,0)}),e.on("focus",r),e.focusManager.hasFocus&&r()):r(),function(){var t=e.editable();t.attachListener(t,"focus",function(t){var i,a;if(CKEDITOR.plugins.scayt&&!e.scayt&&setTimeout(r,0),t=CKEDITOR.plugins.scayt&&CKEDITOR.plugins.scayt.state.scayt[e.name]&&e.scayt,(n||t)&&e._.savedSelection){t=!(t=e._.savedSelection.getSelectedElement())&&e._.savedSelection.getRanges();for(var o=0;o<t.length;o++)"string"==typeof(a=t[o]).startContainer.$.nodeValue&&((i=a.startContainer.getText().length)<a.startOffset||i<a.endOffset)&&e.unlockSelection(!1)}},this,null,-10)}();var t=e.editable();t.attachListener(t,"mousedown",function(t){t=t.data.getTarget();var n=e.widgets&&e.widgets.getByElement(t);n&&(n.wrapper=t.getAscendant(function(e){return e.hasAttribute("data-cke-widget-wrapper")},!0))},this,null,-10)};e.on("contentDom",a),e.on("beforeCommandExec",function(n){var i=e.scayt,r=null,a=!1,o=!0;n.data.name in t.options.disablingCommandExec&&"wysiwyg"==e.mode?i&&(t.destroy(e),e.fire("scaytButtonState",CKEDITOR.TRISTATE_DISABLED)):"bold"!==n.data.name&&"italic"!==n.data.name&&"underline"!==n.data.name&&"strike"!==n.data.name&&"subscript"!==n.data.name&&"superscript"!==n.data.name&&"enter"!==n.data.name&&"cut"!==n.data.name&&"language"!==n.data.name||!i||("cut"===n.data.name&&(o=!1,a=!0),"language"===n.data.name&&(r=(r=e.plugins.language.getCurrentLangElement(e))&&r.$,a=!0),e.fire("reloadMarkupScayt",{removeOptions:{removeInside:o,forceBookmark:a,selectionNode:r},timeout:0}))}),e.on("beforeSetMode",function(n){"source"==n.data&&((n=e.scayt)&&(t.destroy(e),e.fire("scaytButtonState",CKEDITOR.TRISTATE_DISABLED)),e.document&&e.document.getBody().removeAttribute("_jquid"))}),e.on("afterCommandExec",function(n){"wysiwyg"!=e.mode||"undo"!=n.data.name&&"redo"!=n.data.name||setTimeout(function(){t.reloadMarkup(e.scayt)},250)}),e.on("readOnly",function(n){var i;n&&(i=e.scayt,!0===n.editor.readOnly?i&&i.fire("removeMarkupInDocument",{}):i?t.reloadMarkup(i):"wysiwyg"==n.editor.mode&&!0===t.state.scayt[n.editor.name]&&(t.createScayt(e),n.editor.fire("scaytButtonState",CKEDITOR.TRISTATE_ON)))}),e.on("beforeDestroy",i),e.on("setData",function(){i(),(e.elementMode==CKEDITOR.ELEMENT_MODE_INLINE||e.plugins.divarea)&&a()},this,null,50),e.on("reloadMarkupScayt",function(n){var i=n.data&&n.data.removeOptions;n=n.data&&n.data.timeout;var r=e.scayt;r&&setTimeout(function(){r.removeMarkupInSelectionNode(i),t.reloadMarkup(r)},n||0)}),e.on("insertElement",function(){e.fire("reloadMarkupScayt",{removeOptions:{forceBookmark:!0}})},this,null,50),e.on("insertHtml",function(){e.fire("reloadMarkupScayt")},this,null,50),e.on("insertText",function(){e.fire("reloadMarkupScayt")},this,null,50),e.on("scaytDialogShown",function(t){t.data.selectPage(e.scayt.tabToOpen)})},parseConfig:function(e){if((i=CKEDITOR.plugins.scayt).replaceOldOptionsNames(e.config),"boolean"!=typeof e.config.scayt_autoStartup&&(e.config.scayt_autoStartup=!1),i.state.scayt[e.name]=e.config.scayt_autoStartup,"boolean"!=typeof e.config.grayt_autoStartup&&(e.config.grayt_autoStartup=!1),"boolean"!=typeof e.config.scayt_inlineModeImmediateMarkup&&(e.config.scayt_inlineModeImmediateMarkup=!1),i.state.grayt[e.name]=e.config.grayt_autoStartup,e.config.scayt_contextCommands||(e.config.scayt_contextCommands="ignore|ignoreall|add"),e.config.scayt_contextMenuItemsOrder||(e.config.scayt_contextMenuItemsOrder="suggest|moresuggest|control"),e.config.scayt_sLang||(e.config.scayt_sLang="en_US"),(void 0===e.config.scayt_maxSuggestions||"number"!=typeof e.config.scayt_maxSuggestions||0>e.config.scayt_maxSuggestions)&&(e.config.scayt_maxSuggestions=5),(void 0===e.config.scayt_minWordLength||"number"!=typeof e.config.scayt_minWordLength||1>e.config.scayt_minWordLength)&&(e.config.scayt_minWordLength=4),void 0!==e.config.scayt_customDictionaryIds&&"string"==typeof e.config.scayt_customDictionaryIds||(e.config.scayt_customDictionaryIds=""),void 0!==e.config.scayt_userDictionaryName&&"string"==typeof e.config.scayt_userDictionaryName||(e.config.scayt_userDictionaryName=null),"string"==typeof e.config.scayt_uiTabs&&3===e.config.scayt_uiTabs.split(",").length){var t=[],n=[];e.config.scayt_uiTabs=e.config.scayt_uiTabs.split(","),CKEDITOR.tools.search(e.config.scayt_uiTabs,function(e){1===Number(e)||0===Number(e)?(n.push(!0),t.push(Number(e))):n.push(!1)}),null===CKEDITOR.tools.search(n,!1)?e.config.scayt_uiTabs=t:e.config.scayt_uiTabs=[1,1,1]}else e.config.scayt_uiTabs=[1,1,1];if("string"!=typeof e.config.scayt_serviceProtocol&&(e.config.scayt_serviceProtocol=null),"string"!=typeof e.config.scayt_serviceHost&&(e.config.scayt_serviceHost=null),"string"!=typeof e.config.scayt_servicePort&&(e.config.scayt_servicePort=null),"string"!=typeof e.config.scayt_servicePath&&(e.config.scayt_servicePath=null),e.config.scayt_moreSuggestions||(e.config.scayt_moreSuggestions="on"),"string"!=typeof e.config.scayt_customerId&&(e.config.scayt_customerId="1:WvF0D4-UtPqN1-43nkD4-NKvUm2-daQqk3-LmNiI-z7Ysb4-mwry24-T8YrS3-Q2tpq2"),"string"!=typeof e.config.scayt_srcUrl&&(i=-1!=(i=document.location.protocol).search(/https?:/)?i:"http:",e.config.scayt_srcUrl=i+"//svc.webspellchecker.net/spellcheck31/lf/scayt3/ckscayt/ckscayt.js"),"boolean"!=typeof CKEDITOR.config.scayt_handleCheckDirty&&(CKEDITOR.config.scayt_handleCheckDirty=!0),"boolean"!=typeof CKEDITOR.config.scayt_handleUndoRedo&&(CKEDITOR.config.scayt_handleUndoRedo=!0),CKEDITOR.config.scayt_handleUndoRedo=!!CKEDITOR.plugins.undo&&CKEDITOR.config.scayt_handleUndoRedo,"boolean"!=typeof e.config.scayt_multiLanguageMode&&(e.config.scayt_multiLanguageMode=!1),"object"!=typeof e.config.scayt_multiLanguageStyles&&(e.config.scayt_multiLanguageStyles={}),e.config.scayt_ignoreAllCapsWords&&"boolean"!=typeof e.config.scayt_ignoreAllCapsWords&&(e.config.scayt_ignoreAllCapsWords=!1),e.config.scayt_ignoreDomainNames&&"boolean"!=typeof e.config.scayt_ignoreDomainNames&&(e.config.scayt_ignoreDomainNames=!1),e.config.scayt_ignoreWordsWithMixedCases&&"boolean"!=typeof e.config.scayt_ignoreWordsWithMixedCases&&(e.config.scayt_ignoreWordsWithMixedCases=!1),e.config.scayt_ignoreWordsWithNumbers&&"boolean"!=typeof e.config.scayt_ignoreWordsWithNumbers&&(e.config.scayt_ignoreWordsWithNumbers=!1),e.config.scayt_disableOptionsStorage){var i=CKEDITOR.tools.isArray(e.config.scayt_disableOptionsStorage)?e.config.scayt_disableOptionsStorage:"string"==typeof e.config.scayt_disableOptionsStorage?[e.config.scayt_disableOptionsStorage]:void 0,r="all options lang ignore-all-caps-words ignore-domain-names ignore-words-with-mixed-cases ignore-words-with-numbers".split(" "),a=["lang","ignore-all-caps-words","ignore-domain-names","ignore-words-with-mixed-cases","ignore-words-with-numbers"],o=CKEDITOR.tools.search,s=CKEDITOR.tools.indexOf;e.config.scayt_disableOptionsStorage=function(e){for(var t=0;t<e.length;t++){var n=e[t],i=!!o(e,"options");if(!o(r,n)||i&&o(a,function(e){if("lang"===e)return!1}))return;if(o(a,n)&&a.splice(s(a,n),1),"all"===n||i&&o(e,"lang"))return[];"options"===n&&(a=["lang"])}return[].concat(a)}(i)}},addRule:function(e){var t=CKEDITOR.plugins.scayt,n=(r=e.dataProcessor)&&r.htmlFilter,i=e._.elementsPath&&e._.elementsPath.filters,r=r&&r.dataFilter,a=e.addRemoveFormatFilter;i&&i.push(function(n){if(e.scayt&&(n.hasAttribute(t.options.data_attribute_name)||n.hasAttribute(t.options.problem_grammar_data_attribute)))return!1}),r&&r.addRules({elements:{span:function(e){var n=e.hasClass(t.options.misspelled_word_class)&&e.attributes[t.options.data_attribute_name],i=e.hasClass(t.options.problem_grammar_class)&&e.attributes[t.options.problem_grammar_data_attribute];return t&&(n||i)&&delete e.name,e}}}),n&&n.addRules({elements:{span:function(e){var n=e.hasClass(t.options.misspelled_word_class)&&e.attributes[t.options.data_attribute_name],i=e.hasClass(t.options.problem_grammar_class)&&e.attributes[t.options.problem_grammar_data_attribute];return t&&(n||i)&&delete e.name,e}}}),a&&a.call(e,function(n){var i=!0;return e.scayt&&(n.hasAttribute(t.options.data_attribute_name)||n.hasAttribute(t.options.problem_grammar_data_attribute))&&(i=!1),i})},scaytMenuDefinition:function(e){var t=this;return{scayt:{scayt_ignore:{label:(e=e.scayt).getLocal("btn_ignore"),group:"scayt_control",order:1,exec:function(e){e.scayt.ignoreWord()}},scayt_ignoreall:{label:e.getLocal("btn_ignoreAll"),group:"scayt_control",order:2,exec:function(e){e.scayt.ignoreAllWords()}},scayt_add:{label:e.getLocal("btn_addWord"),group:"scayt_control",order:3,exec:function(e){var t=e.scayt;setTimeout(function(){t.addWordToUserDictionary()},10)}},scayt_option:{label:e.getLocal("btn_options"),group:"scayt_control",order:4,exec:function(e){e.scayt.tabToOpen="options",e.lockSelection(),e.openDialog(t.dialogName)},verification:function(e){return 1==e.config.scayt_uiTabs[0]}},scayt_language:{label:e.getLocal("btn_langs"),group:"scayt_control",order:5,exec:function(e){e.scayt.tabToOpen="langs",e.lockSelection(),e.openDialog(t.dialogName)},verification:function(e){return 1==e.config.scayt_uiTabs[1]}},scayt_dictionary:{label:e.getLocal("btn_dictionaries"),group:"scayt_control",order:6,exec:function(e){e.scayt.tabToOpen="dictionaries",e.lockSelection(),e.openDialog(t.dialogName)},verification:function(e){return 1==e.config.scayt_uiTabs[2]}},scayt_about:{label:e.getLocal("btn_about"),group:"scayt_control",order:7,exec:function(e){e.scayt.tabToOpen="about",e.lockSelection(),e.openDialog(t.dialogName)}}},grayt:{grayt_problemdescription:{label:"Grammar problem description",group:"grayt_description",order:1,state:CKEDITOR.TRISTATE_DISABLED,exec:function(e){}},grayt_ignore:{label:e.getLocal("btn_ignore"),group:"grayt_control",order:2,exec:function(e){e.scayt.ignorePhrase()}}}}},buildSuggestionMenuItems:function(e,t,n){var i={},r={},a=n?"word":"phrase",o=n?"startGrammarCheck":"startSpellCheck",s=e.scayt;if(0<t.length&&"no_any_suggestions"!==t[0])if(n)for(n=0;n<t.length;n++){var l="scayt_suggest_"+CKEDITOR.plugins.scayt.suggestions[n].replace(" ","_");e.addCommand(l,this.createCommand(CKEDITOR.plugins.scayt.suggestions[n],a,o)),n<e.config.scayt_maxSuggestions?(e.addMenuItem(l,{label:t[n],command:l,group:"scayt_suggest",order:n+1}),i[l]=CKEDITOR.TRISTATE_OFF):(e.addMenuItem(l,{label:t[n],command:l,group:"scayt_moresuggest",order:n+1}),r[l]=CKEDITOR.TRISTATE_OFF,"on"===e.config.scayt_moreSuggestions&&(e.addMenuItem("scayt_moresuggest",{label:s.getLocal("btn_moreSuggestions"),group:"scayt_moresuggest",order:10,getItems:function(){return r}}),i.scayt_moresuggest=CKEDITOR.TRISTATE_OFF))}else for(n=0;n<t.length;n++)l="grayt_suggest_"+CKEDITOR.plugins.scayt.suggestions[n].replace(" ","_"),e.addCommand(l,this.createCommand(CKEDITOR.plugins.scayt.suggestions[n],a,o)),e.addMenuItem(l,{label:t[n],command:l,group:"grayt_suggest",order:n+1}),i[l]=CKEDITOR.TRISTATE_OFF;else i.no_scayt_suggest=CKEDITOR.TRISTATE_DISABLED,e.addCommand("no_scayt_suggest",{exec:function(){}}),e.addMenuItem("no_scayt_suggest",{label:s.getLocal("btn_noSuggestions")||"no_scayt_suggest",command:"no_scayt_suggest",group:"scayt_suggest",order:0});return i},menuGenerator:function(e,t){var n,i,r=e.scayt,a=this.scaytMenuDefinition(e),o={},s=e.config.scayt_contextCommands.split("|"),l=t.getAttribute(r.getLangAttribute())||r.getLang();if(n=r.isScaytNode(t),i=r.isGraytNode(t),n?(a=a.scayt,o=t.getAttribute(r.getScaytNodeAttributeName()),r.fire("getSuggestionsList",{lang:l,word:o}),o=this.buildSuggestionMenuItems(e,CKEDITOR.plugins.scayt.suggestions,n)):i&&(a=a.grayt,o=t.getAttribute(r.getGraytNodeAttributeName()),i=r.getProblemDescriptionText(o,l),a.grayt_problemdescription&&i&&(a.grayt_problemdescription.label=i),r.fire("getGrammarSuggestionsList",{lang:l,phrase:o}),o=this.buildSuggestionMenuItems(e,CKEDITOR.plugins.scayt.suggestions,n)),n&&"off"==e.config.scayt_contextCommands)return o;for(var u in a)n&&-1==CKEDITOR.tools.indexOf(s,u.replace("scayt_",""))&&"all"!=e.config.scayt_contextCommands||(o[u]=void 0!==a[u].state?a[u].state:CKEDITOR.TRISTATE_OFF,"function"!=typeof a[u].verification||a[u].verification(e)||delete o[u],e.addCommand(u,{exec:a[u].exec}),e.addMenuItem(u,{label:e.lang.scayt[a[u].label]||a[u].label,command:u,group:a[u].group,order:a[u].order}));return o},createCommand:function(e,t,n){return{exec:function(i){i=i.scayt;var r={};r[t]=e,i.replaceSelectionNode(r),"startGrammarCheck"===n&&i.removeMarkupInSelectionNode({grammarOnly:!0}),i.fire(n)}}}}),CKEDITOR.plugins.scayt={charsToObserve:[{charName:"cke-fillingChar",charCode:function(){var e;if(n=(n=CKEDITOR.version.match(/^\d(\.\d*)*/))&&n[0]){e="4.5.7";var t,n=n.replace(/\./g,"");e=e.replace(/\./g,""),t=0<=(t=n.length-e.length)?t:0,e=parseInt(n)>=parseInt(e)*Math.pow(10,t)}return e?Array(7).join(String.fromCharCode(8203)):String.fromCharCode(8203)}()}],onLoadTimestamp:"",state:{scayt:{},grayt:{}},warningCounter:0,suggestions:[],options:{disablingCommandExec:{source:!0,newpage:!0,templates:!0},data_attribute_name:"data-scayt-word",misspelled_word_class:"scayt-misspell-word",problem_grammar_data_attribute:"data-grayt-phrase",problem_grammar_class:"gramm-problem"},backCompatibilityMap:{scayt_service_protocol:"scayt_serviceProtocol",scayt_service_host:"scayt_serviceHost",scayt_service_port:"scayt_servicePort",scayt_service_path:"scayt_servicePath",scayt_customerid:"scayt_customerId"},alarmCompatibilityMessage:function(){5>this.warningCounter&&(console.warn("Note: You are using latest version of SCAYT plug-in. It is recommended to upgrade WebSpellChecker.net application to version v4.8.3.Contact us by e-mail at support@webspellchecker.net."),this.warningCounter+=1)},reloadMarkup:function(e){var t;e&&(t=e.getScaytLangList(),e.reloadMarkup?e.reloadMarkup():(this.alarmCompatibilityMessage(),t&&t.ltr&&t.rtl&&e.fire("startSpellCheck, startGrammarCheck")))},replaceOldOptionsNames:function(e){for(var t in e)t in this.backCompatibilityMap&&(e[this.backCompatibilityMap[t]]=e[t],delete e[t])},createScayt:function(e){var t=this,n=CKEDITOR.plugins.scayt;this.loadScaytLibrary(e,function(e){function i(e){return new SCAYT.CKSCAYT(e,function(){},function(){})}var r=e.window&&e.window.getFrame()||e.editable();if(r){var a;r={lang:e.config.scayt_sLang,container:r.$,customDictionary:e.config.scayt_customDictionaryIds,userDictionaryName:e.config.scayt_userDictionaryName,localization:e.langCode,customer_id:e.config.scayt_customerId,debug:e.config.scayt_debug,data_attribute_name:t.options.data_attribute_name,misspelled_word_class:t.options.misspelled_word_class,problem_grammar_data_attribute:t.options.problem_grammar_data_attribute,problem_grammar_class:t.options.problem_grammar_class,"options-to-restore":e.config.scayt_disableOptionsStorage,focused:e.editable().hasFocus,ignoreElementsRegex:e.config.scayt_elementsToIgnore,minWordLength:e.config.scayt_minWordLength,multiLanguageMode:e.config.scayt_multiLanguageMode,multiLanguageStyles:e.config.scayt_multiLanguageStyles,graytAutoStartup:n.state.grayt[e.name],charsToObserve:n.charsToObserve},e.config.scayt_serviceProtocol&&(r.service_protocol=e.config.scayt_serviceProtocol),e.config.scayt_serviceHost&&(r.service_host=e.config.scayt_serviceHost),e.config.scayt_servicePort&&(r.service_port=e.config.scayt_servicePort),e.config.scayt_servicePath&&(r.service_path=e.config.scayt_servicePath),"boolean"==typeof e.config.scayt_ignoreAllCapsWords&&(r["ignore-all-caps-words"]=e.config.scayt_ignoreAllCapsWords),"boolean"==typeof e.config.scayt_ignoreDomainNames&&(r["ignore-domain-names"]=e.config.scayt_ignoreDomainNames),"boolean"==typeof e.config.scayt_ignoreWordsWithMixedCases&&(r["ignore-words-with-mixed-cases"]=e.config.scayt_ignoreWordsWithMixedCases),"boolean"==typeof e.config.scayt_ignoreWordsWithNumbers&&(r["ignore-words-with-numbers"]=e.config.scayt_ignoreWordsWithNumbers);try{a=i(r)}catch(e){t.alarmCompatibilityMessage(),delete r.charsToObserve,a=i(r)}a.subscribe("suggestionListSend",function(e){for(var t={},n=[],i=0;i<e.suggestionList.length;i++)t["word_"+e.suggestionList[i]]||(t["word_"+e.suggestionList[i]]=e.suggestionList[i],n.push(e.suggestionList[i]));CKEDITOR.plugins.scayt.suggestions=n}),a.subscribe("selectionIsChanged",function(t){e.getSelection().isLocked&&e.lockSelection()}),a.subscribe("graytStateChanged",function(t){n.state.grayt[e.name]=t.state}),a.addMarkupHandler&&a.addMarkupHandler(function(t){var n=e.editable(),i=n.getCustomData(t.charName);i&&(i.$=t.node,n.setCustomData(t.charName,i))}),e.scayt=a,e.fire("scaytButtonState",e.readOnly?CKEDITOR.TRISTATE_DISABLED:CKEDITOR.TRISTATE_ON)}else n.state.scayt[e.name]=!1})},destroy:function(e){e.scayt&&e.scayt.destroy(),delete e.scayt,e.fire("scaytButtonState",CKEDITOR.TRISTATE_OFF)},loadScaytLibrary:function(e,t){var n,i=function(){CKEDITOR.fireOnce("scaytReady"),e.scayt||"function"==typeof t&&t(e)};void 0===window.SCAYT||"function"!=typeof window.SCAYT.CKSCAYT?(n=e.config.scayt_srcUrl+"?"+this.onLoadTimestamp,CKEDITOR.scriptLoader.load(n,function(e){e&&i()})):window.SCAYT&&"function"==typeof window.SCAYT.CKSCAYT&&i()}},CKEDITOR.on("dialogDefinition",function(e){var t=e.data.name;e=e.data.definition.dialog,"scaytDialog"===t&&e.on("cancel",function(e){return!1},this,null,-1),"checkspell"===t&&e.on("cancel",function(e){e=e.sender&&e.sender.getParentEditor();var t=CKEDITOR.plugins.scayt,n=e.scayt;n&&t.state.scayt[e.name]&&n.setMarkupPaused&&n.setMarkupPaused(!1),e.unlockSelection()},this,null,-2),"link"===t&&e.on("ok",function(e){var t=e.sender&&e.sender.getParentEditor();t&&setTimeout(function(){t.fire("reloadMarkupScayt",{removeOptions:{removeInside:!0,forceBookmark:!0},timeout:0})},0)})}),CKEDITOR.on("scaytReady",function(){if(!0===CKEDITOR.config.scayt_handleCheckDirty&&((e=CKEDITOR.editor.prototype).checkDirty=CKEDITOR.tools.override(e.checkDirty,function(e){return function(){var t=null,n=this.scayt;if(CKEDITOR.plugins.scayt&&CKEDITOR.plugins.scayt.state.scayt[this.name]&&this.scayt){if(t="ready"==this.status){var i=n.removeMarkupFromString(this.getSnapshot());n=n.removeMarkupFromString(this._.previousValue),t=t&&n!==i}}else t=e.call(this);return t}}),e.resetDirty=CKEDITOR.tools.override(e.resetDirty,function(e){return function(){var t=this.scayt;CKEDITOR.plugins.scayt&&CKEDITOR.plugins.scayt.state.scayt[this.name]&&this.scayt?this._.previousValue=t.removeMarkupFromString(this.getSnapshot()):e.call(this)}})),!0===CKEDITOR.config.scayt_handleUndoRedo){var e,t="function"==typeof(e=CKEDITOR.plugins.undo.Image.prototype).equalsContent?"equalsContent":"equals";e[t]=CKEDITOR.tools.override(e[t],function(e){return function(t){var n,i=t.editor.scayt,r=this.contents,a=t.contents;return CKEDITOR.plugins.scayt&&CKEDITOR.plugins.scayt.state.scayt[t.editor.name]&&t.editor.scayt&&(this.contents=i.removeMarkupFromString(r)||"",t.contents=i.removeMarkupFromString(a)||""),n=e.apply(this,arguments),this.contents=r,t.contents=a,n}})}}),function(){var e={preserveState:!0,editorFocus:!1,readOnly:1,exec:function(e){this.toggleState(),this.refresh(e)},refresh:function(e){if(e.document){var t=this.state==CKEDITOR.TRISTATE_ON?"attachClass":"removeClass";e.editable()[t]("cke_show_borders")}}};CKEDITOR.plugins.add("showborders",{modes:{wysiwyg:1},onLoad:function(){var e;e=(CKEDITOR.env.ie6Compat?[".%1 table.%2,",".%1 table.%2 td, .%1 table.%2 th","{","border : #d3d3d3 1px dotted","}"]:".%1 table.%2,;.%1 table.%2 > tr > td, .%1 table.%2 > tr > th,;.%1 table.%2 > tbody > tr > td, .%1 table.%2 > tbody > tr > th,;.%1 table.%2 > thead > tr > td, .%1 table.%2 > thead > tr > th,;.%1 table.%2 > tfoot > tr > td, .%1 table.%2 > tfoot > tr > th;{;border : #d3d3d3 1px dotted;}".split(";")).join("").replace(/%2/g,"cke_show_border").replace(/%1/g,"cke_show_borders "),CKEDITOR.addCss(e)},init:function(t){var n=t.addCommand("showborders",e);n.canUndo=!1,!1!==t.config.startupShowBorders&&n.setState(CKEDITOR.TRISTATE_ON),t.on("mode",function(){n.state!=CKEDITOR.TRISTATE_DISABLED&&n.refresh(t)},null,null,100),t.on("contentDom",function(){n.state!=CKEDITOR.TRISTATE_DISABLED&&n.refresh(t)}),t.on("removeFormatCleanup",function(e){e=e.data,t.getCommand("showborders").state==CKEDITOR.TRISTATE_ON&&e.is("table")&&(!e.hasAttribute("border")||0>=parseInt(e.getAttribute("border"),10))&&e.addClass("cke_show_border")})},afterInit:function(e){var t=e.dataProcessor;e=t&&t.dataFilter,t=t&&t.htmlFilter,e&&e.addRules({elements:{table:function(e){var t=(e=e.attributes).class,n=parseInt(e.border,10);n&&!(0>=n)||t&&-1!=t.indexOf("cke_show_border")||(e.class=(t||"")+" cke_show_border")}}}),t&&t.addRules({elements:{table:function(e){var t=(e=e.attributes).class;t&&(e.class=t.replace("cke_show_border","").replace(/\s{2}/," ").replace(/^\s+|\s+$/,""))}}})}}),CKEDITOR.on("dialogDefinition",function(e){var t=e.data.name;"table"!=t&&"tableProperties"!=t||((t=(e=e.data.definition).getContents("info").get("txtBorder")).commit=CKEDITOR.tools.override(t.commit,function(e){return function(t,n){e.apply(this,arguments);var i=parseInt(this.getValue(),10);n[!i||0>=i?"addClass":"removeClass"]("cke_show_border")}}),(e=(e=e.getContents("advanced"))&&e.get("advCSSClasses"))&&(e.setup=CKEDITOR.tools.override(e.setup,function(e){return function(){e.apply(this,arguments),this.setValue(this.getValue().replace(/cke_show_border/,""))}}),e.commit=CKEDITOR.tools.override(e.commit,function(e){return function(t,n){e.apply(this,arguments),parseInt(n.getAttribute("border"),10)||n.addClass("cke_show_border")}})))})}(),function(){CKEDITOR.plugins.add("sourcearea",{init:function(t){function n(){var e=r&&this.equals(CKEDITOR.document.getActive());this.hide(),this.setStyle("height",this.getParent().$.clientHeight+"px"),this.setStyle("width",this.getParent().$.clientWidth+"px"),this.show(),e&&this.focus()}if(t.elementMode!=CKEDITOR.ELEMENT_MODE_INLINE){var i=CKEDITOR.plugins.sourcearea;t.addMode("source",function(i){var r=t.ui.space("contents").getDocument().createElement("textarea");r.setStyles(CKEDITOR.tools.extend({width:CKEDITOR.env.ie7Compat?"99%":"100%",height:"100%",resize:"none",outline:"none","text-align":"left"},CKEDITOR.tools.cssVendorPrefix("tab-size",t.config.sourceAreaTabSize||4))),r.setAttribute("dir","ltr"),r.addClass("cke_source").addClass("cke_reset").addClass("cke_enable_context_menu"),t.ui.space("contents").append(r),(r=t.editable(new e(t,r))).setData(t.getData(1)),CKEDITOR.env.ie&&(r.attachListener(t,"resize",n,r),r.attachListener(CKEDITOR.document.getWindow(),"resize",n,r),CKEDITOR.tools.setTimeout(n,0,r)),t.fire("ariaWidget",this),i()}),t.addCommand("source",i.commands.source),t.ui.addButton&&t.ui.addButton("Source",{label:t.lang.sourcearea.toolbar,command:"source",toolbar:"mode,10"}),t.on("mode",function(){t.getCommand("source").setState("source"==t.mode?CKEDITOR.TRISTATE_ON:CKEDITOR.TRISTATE_OFF)});var r=CKEDITOR.env.ie&&9==CKEDITOR.env.version}}});var e=CKEDITOR.tools.createClass({base:CKEDITOR.editable,proto:{setData:function(e){this.setValue(e),this.status="ready",this.editor.fire("dataReady")},getData:function(){return this.getValue()},insertHtml:function(){},insertElement:function(){},insertText:function(){},setReadOnly:function(e){this[(e?"set":"remove")+"Attribute"]("readOnly","readonly")},detach:function(){e.baseProto.detach.call(this),this.clearCustomData(),this.remove()}}})}(),CKEDITOR.plugins.sourcearea={commands:{source:{modes:{wysiwyg:1,source:1},editorFocus:!1,readOnly:1,exec:function(e){"wysiwyg"==e.mode&&e.fire("saveSnapshot"),e.getCommand("source").setState(CKEDITOR.TRISTATE_DISABLED),e.setMode("source"==e.mode?"wysiwyg":"source")},canUndo:!1}}},CKEDITOR.plugins.add("specialchar",{availableLangs:{af:1,ar:1,az:1,bg:1,ca:1,cs:1,cy:1,da:1,de:1,"de-ch":1,el:1,en:1,"en-gb":1,eo:1,es:1,et:1,eu:1,fa:1,fi:1,fr:1,"fr-ca":1,gl:1,he:1,hr:1,hu:1,id:1,it:1,ja:1,km:1,ko:1,ku:1,lt:1,lv:1,nb:1,nl:1,no:1,oc:1,pl:1,pt:1,"pt-br":1,ru:1,si:1,sk:1,sl:1,sq:1,sv:1,th:1,tr:1,tt:1,ug:1,uk:1,vi:1,zh:1,"zh-cn":1},requires:"dialog",init:function(e){var t=this;CKEDITOR.dialog.add("specialchar",this.path+"dialogs/specialchar.js"),e.addCommand("specialchar",{exec:function(){var n=e.langCode;n=t.availableLangs[n]?n:t.availableLangs[n.replace(/-.*/,"")]?n.replace(/-.*/,""):"en",CKEDITOR.scriptLoader.load(CKEDITOR.getUrl(t.path+"dialogs/lang/"+n+".js"),function(){CKEDITOR.tools.extend(e.lang.specialchar,t.langEntries[n]),e.openDialog("specialchar")})},modes:{wysiwyg:1},canUndo:!1}),e.ui.addButton&&e.ui.addButton("SpecialChar",{label:e.lang.specialchar.toolbar,command:"specialchar",toolbar:"insert,50"})}}),CKEDITOR.config.specialChars="! &quot; # $ % &amp; ' ( ) * + - . / 0 1 2 3 4 5 6 7 8 9 : ; &lt; = &gt; ? @ A B C D E F G H I J K L M N O P Q R S T U V W X Y Z [ ] ^ _ ` a b c d e f g h i j k l m n o p q r s t u v w x y z { | } ~ &euro; &lsquo; &rsquo; &ldquo; &rdquo; &ndash; &mdash; &iexcl; &cent; &pound; &curren; &yen; &brvbar; &sect; &uml; &copy; &ordf; &laquo; &not; &reg; &macr; &deg; &sup2; &sup3; &acute; &micro; &para; &middot; &cedil; &sup1; &ordm; &raquo; &frac14; &frac12; &frac34; &iquest; &Agrave; &Aacute; &Acirc; &Atilde; &Auml; &Aring; &AElig; &Ccedil; &Egrave; &Eacute; &Ecirc; &Euml; &Igrave; &Iacute; &Icirc; &Iuml; &ETH; &Ntilde; &Ograve; &Oacute; &Ocirc; &Otilde; &Ouml; &times; &Oslash; &Ugrave; &Uacute; &Ucirc; &Uuml; &Yacute; &THORN; &szlig; &agrave; &aacute; &acirc; &atilde; &auml; &aring; &aelig; &ccedil; &egrave; &eacute; &ecirc; &euml; &igrave; &iacute; &icirc; &iuml; &eth; &ntilde; &ograve; &oacute; &ocirc; &otilde; &ouml; &divide; &oslash; &ugrave; &uacute; &ucirc; &uuml; &yacute; &thorn; &yuml; &OElig; &oelig; &#372; &#374 &#373 &#375; &sbquo; &#8219; &bdquo; &hellip; &trade; &#9658; &bull; &rarr; &rArr; &hArr; &diams; &asymp;".split(" "),CKEDITOR.plugins.add("stylescombo",{requires:"richcombo",init:function(e){var t=e.config,n=e.lang.stylescombo,i={},r=[],a=[];e.on("stylesSet",function(n){if(n=n.data.styles){for(var o,s,l,u=0,c=n.length;u<c;u++)o=n[u],e.blockless&&o.element in CKEDITOR.dtd.$block||"string"==typeof o.type&&!CKEDITOR.style.customHandlers[o.type]||(s=o.name,o=new CKEDITOR.style(o),e.filter.customConfig&&!e.filter.check(o))||(o._name=s,o._.enterMode=t.enterMode,o._.type=l=o.assignedTo||o.type,o._.weight=u+1e3*(l==CKEDITOR.STYLE_OBJECT?1:l==CKEDITOR.STYLE_BLOCK?2:3),i[s]=o,r.push(o),a.push(o));r.sort(function(e,t){return e._.weight-t._.weight})}}),e.ui.addRichCombo("Styles",{label:n.label,title:n.panelTitle,toolbar:"styles,10",allowedContent:a,panel:{css:[CKEDITOR.skin.getPath("editor")].concat(t.contentsCss),multiSelect:!0,attributes:{"aria-label":n.panelTitle}},init:function(){var e,t,i,a,o,s;for(o=0,s=r.length;o<s;o++)t=(e=r[o])._name,(a=e._.type)!=i&&(this.startGroup(n["panelTitle"+String(a)]),i=a),this.add(t,e.type==CKEDITOR.STYLE_OBJECT?t:e.buildPreview(),t);this.commit()},onClick:function(t){e.focus(),e.fire("saveSnapshot"),t=i[t];var n=e.elementPath();t.group&&t.removeStylesFromSameGroup(e)?e.applyStyle(t):e[t.checkActive(n,e)?"removeStyle":"applyStyle"](t),e.fire("saveSnapshot")},onRender:function(){e.on("selectionChange",function(t){for(var n,r=this.getValue(),a=0,o=(t=t.data.path.elements).length;a<o;a++)for(var s in n=t[a],i)if(i[s].checkElementRemovable(n,!0,e))return void(s!=r&&this.setValue(s));this.setValue("")},this)},onOpen:function(){var t=e.getSelection().getSelectedElement(),r=(t=e.elementPath(t),[0,0,0,0]);for(var a in this.showAll(),this.unmarkAll(),i){var o=i[a],s=o._.type;o.checkApplicable(t,e,e.activeFilter)?r[s]++:this.hideItem(a),o.checkActive(t,e)&&this.mark(a)}r[CKEDITOR.STYLE_BLOCK]||this.hideGroup(n["panelTitle"+String(CKEDITOR.STYLE_BLOCK)]),r[CKEDITOR.STYLE_INLINE]||this.hideGroup(n["panelTitle"+String(CKEDITOR.STYLE_INLINE)]),r[CKEDITOR.STYLE_OBJECT]||this.hideGroup(n["panelTitle"+String(CKEDITOR.STYLE_OBJECT)])},refresh:function(){var t=e.elementPath();if(t){for(var n in i)if(i[n].checkApplicable(t,e,e.activeFilter))return;this.setState(CKEDITOR.TRISTATE_DISABLED)}},reset:function(){i={},r=[]}})}}),function(){function e(e){return{editorFocus:!1,canUndo:!1,modes:{wysiwyg:1},exec:function(t){if(t.editable().hasFocus){var n,i=t.getSelection();if(n=new CKEDITOR.dom.elementPath(i.getCommonAncestor(),i.root).contains({td:1,th:1},1)){if(i=t.createRange(),(a=CKEDITOR.tools.tryThese(function(){var t=n.getParent().$.cells[n.$.cellIndex+(e?-1:1)];return t.parentNode.parentNode,t},function(){var t;return(t=(t=n.getParent()).getAscendant("table").$.rows[t.$.rowIndex+(e?-1:1)]).cells[e?t.cells.length-1:0]}))||e){if(!a)return!0;a=new CKEDITOR.dom.element(a),i.moveToElementEditStart(a),i.checkStartOfBlock()&&i.checkEndOfBlock()||i.selectNodeContents(a)}else{for(var r=n.getAscendant("table").$,a=n.getParent().$.cells,o=(r=new CKEDITOR.dom.element(r.insertRow(-1),t.document),0),s=a.length;o<s;o++)r.append(new CKEDITOR.dom.element(a[o],t.document).clone(!1,!1)).appendBogus();i.moveToElementEditStart(r)}return i.select(!0),!0}}return!1}}}var t={editorFocus:!1,modes:{wysiwyg:1,source:1}},n={exec:function(e){e.container.focusNext(!0,e.tabIndex)}},i={exec:function(e){e.container.focusPrevious(!0,e.tabIndex)}};CKEDITOR.plugins.add("tab",{init:function(r){for(var a=!1!==r.config.enableTabKeyTools,o=r.config.tabSpaces||0,s="";o--;)s+=" ";s&&r.on("key",function(e){9==e.data.keyCode&&(r.insertText(s),e.cancel())}),a&&r.on("key",function(e){(9==e.data.keyCode&&r.execCommand("selectNextCell")||e.data.keyCode==CKEDITOR.SHIFT+9&&r.execCommand("selectPreviousCell"))&&e.cancel()}),r.addCommand("blur",CKEDITOR.tools.extend(n,t)),r.addCommand("blurBack",CKEDITOR.tools.extend(i,t)),r.addCommand("selectNextCell",e()),r.addCommand("selectPreviousCell",e(!0))}})}(),CKEDITOR.dom.element.prototype.focusNext=function(e,t){var n,i,r,a,o,s,l=void 0===t?this.getTabIndex():t;if(0>=l)for(o=this.getNextSourceNode(e,CKEDITOR.NODE_ELEMENT);o;){if(o.isVisible()&&0===o.getTabIndex()){r=o;break}o=o.getNextSourceNode(!1,CKEDITOR.NODE_ELEMENT)}else for(o=this.getDocument().getBody().getFirst();o=o.getNextSourceNode(!1,CKEDITOR.NODE_ELEMENT);){if(!n)if(!i&&o.equals(this)){if(i=!0,e){if(!(o=o.getNextSourceNode(!0,CKEDITOR.NODE_ELEMENT)))break;n=1}}else i&&!this.contains(o)&&(n=1);if(o.isVisible()&&!(0>(s=o.getTabIndex()))){if(n&&s==l){r=o;break}s>l&&(!r||!a||s<a)?(r=o,a=s):r||0!==s||(r=o,a=s)}}r&&r.focus()},CKEDITOR.dom.element.prototype.focusPrevious=function(e,t){for(var n,i,r,a,o=void 0===t?this.getTabIndex():t,s=0,l=this.getDocument().getBody().getLast();l=l.getPreviousSourceNode(!1,CKEDITOR.NODE_ELEMENT);){if(!n)if(!i&&l.equals(this)){if(i=!0,e){if(!(l=l.getPreviousSourceNode(!0,CKEDITOR.NODE_ELEMENT)))break;n=1}}else i&&!this.contains(l)&&(n=1);if(l.isVisible()&&!(0>(a=l.getTabIndex())))if(0>=o){if(n&&0===a){r=l;break}a>s&&(r=l,s=a)}else{if(n&&a==o){r=l;break}a<o&&(!r||a>s)&&(r=l,s=a)}}r&&r.focus()},CKEDITOR.plugins.add("table",{requires:"dialog",init:function(e){function t(e){return CKEDITOR.tools.extend(e||{},{contextSensitive:1,refresh:function(e,t){this.setState(t.contains("table",1)?CKEDITOR.TRISTATE_OFF:CKEDITOR.TRISTATE_DISABLED)}})}if(!e.blockless){var n=e.lang.table;e.addCommand("table",new CKEDITOR.dialogCommand("table",{context:"table",allowedContent:"table{width,height}[align,border,cellpadding,cellspacing,summary];caption tbody thead tfoot;th td tr[scope];"+(e.plugins.dialogadvtab?"table"+e.plugins.dialogadvtab.allowedContent():""),requiredContent:"table",contentTransformations:[["table{width}: sizeToStyle","table[width]: sizeToAttribute"],["td: splitBorderShorthand"],[{element:"table",right:function(e){e.styles&&(e.styles.border&&e.styles.border.match(/solid/)&&(e.attributes.border=1),"collapse"==e.styles["border-collapse"]&&(e.attributes.cellspacing=0))}}]]})),e.addCommand("tableProperties",new CKEDITOR.dialogCommand("tableProperties",t())),e.addCommand("tableDelete",t({exec:function(e){var t=e.elementPath().contains("table",1);if(t){var n=t.getParent(),i=e.editable();1!=n.getChildCount()||n.is("td","th")||n.equals(i)||(t=n),(e=e.createRange()).moveToPosition(t,CKEDITOR.POSITION_BEFORE_START),t.remove(),e.select()}}})),e.ui.addButton&&e.ui.addButton("Table",{label:n.toolbar,command:"table",toolbar:"insert,30"}),CKEDITOR.dialog.add("table",this.path+"dialogs/table.js"),CKEDITOR.dialog.add("tableProperties",this.path+"dialogs/table.js"),e.addMenuItems&&e.addMenuItems({table:{label:n.menu,command:"tableProperties",group:"table",order:5},tabledelete:{label:n.deleteTable,command:"tableDelete",group:"table",order:1}}),e.on("doubleclick",function(e){e.data.element.is("table")&&(e.data.dialog="tableProperties")}),e.contextMenu&&e.contextMenu.addListener(function(){return{tabledelete:CKEDITOR.TRISTATE_OFF,table:CKEDITOR.TRISTATE_OFF}})}}}),function(){function e(e){function t(e){0<n.length||e.type!=CKEDITOR.NODE_ELEMENT||!h.test(e.getName())||e.getCustomData("selected_cell")||(CKEDITOR.dom.element.setMarker(i,e,"selected_cell",!0),n.push(e))}e=e.getRanges();for(var n=[],i={},r=0;r<e.length;r++){var a,o;if((a=e[r]).collapsed)(a=(a=a.getCommonAncestor()).getAscendant("td",!0)||a.getAscendant("th",!0))&&n.push(a);else for((a=new CKEDITOR.dom.walker(a)).guard=t;o=a.next();)o.type==CKEDITOR.NODE_ELEMENT&&o.is(CKEDITOR.dtd.table)||(o=o.getAscendant("td",!0)||o.getAscendant("th",!0))&&!o.getCustomData("selected_cell")&&(CKEDITOR.dom.element.setMarker(i,o,"selected_cell",!0),n.push(o))}return CKEDITOR.dom.element.clearAllMarkers(i),n}function t(t,n){var i=(r=(s=e(t))[0]).getAscendant("table"),r=r.getDocument(),a=(l=s[0].getParent()).$.rowIndex,o=(s=s[s.length-1]).getParent().$.rowIndex+s.$.rowSpan-1,s=new CKEDITOR.dom.element(i.$.rows[o]),l=(a=n?a:o,n?l:s);for(i=(s=CKEDITOR.tools.buildTableMap(i))[a],a=n?s[a-1]:s[a+1],s=s[0].length,r=r.createElement("tr"),o=0;i[o]&&o<s;o++){var u;1<i[o].rowSpan&&a&&i[o]==a[o]?(u=i[o]).rowSpan+=1:((u=new CKEDITOR.dom.element(i[o]).clone()).removeAttribute("rowSpan"),u.appendBogus(),r.append(u),u=u.$),o+=u.colSpan-1}n?r.insertBefore(l):r.insertAfter(l)}function n(t){if(t instanceof CKEDITOR.dom.selection){var i=(o=e(t))[0].getAscendant("table"),r=CKEDITOR.tools.buildTableMap(i);t=o[0].getParent().$.rowIndex;for(var a=(o=o[o.length-1]).getParent().$.rowIndex+o.$.rowSpan-1,o=[],s=t;s<=a;s++){for(var l=r[s],u=new CKEDITOR.dom.element(i.$.rows[s]),c=0;c<l.length;c++){var d=new CKEDITOR.dom.element(l[c]),h=d.getParent().$.rowIndex;1==d.$.rowSpan?d.remove():(--d.$.rowSpan,h==s&&((h=r[s+1])[c-1]?d.insertAfter(new CKEDITOR.dom.element(h[c-1])):new CKEDITOR.dom.element(i.$.rows[s+1]).append(d,1))),c+=d.$.colSpan-1}o.push(u)}for(r=i.$.rows,i=new CKEDITOR.dom.element(r[a+1]||(0<t?r[t-1]:null)||i.$.parentNode),s=o.length;0<=s;s--)n(o[s]);return i}return t instanceof CKEDITOR.dom.element&&(1==(i=t.getAscendant("table")).$.rows.length?i.remove():t.remove()),null}function i(e,t){for(var n=t?1/0:0,i=0;i<e.length;i++){for(var r,a=t,o=(r=e[i]).getParent().$.cells,s=0,l=0;l<o.length;l++){var u=o[l];if(s+=a?1:u.colSpan,u==r.$)break}r=s-1,(t?r<n:r>n)&&(n=r)}return n}function r(t,n){for(var r=(o=e(t))[0].getAscendant("table"),a=i(o,1),o=i(o),s=(a=n?a:o,CKEDITOR.tools.buildTableMap(r)),l=(r=[],o=[],s.length),u=0;u<l;u++)r.push(s[u][a]),o.push(n?s[u][a-1]:s[u][a+1]);for(u=0;u<l;u++)r[u]&&(1<r[u].colSpan&&o[u]==r[u]?(a=r[u]).colSpan+=1:((a=new CKEDITOR.dom.element(r[u]).clone()).removeAttribute("colSpan"),a.appendBogus(),a[n?"insertBefore":"insertAfter"].call(a,new CKEDITOR.dom.element(r[u])),a=a.$),u+=a.rowSpan-1)}function a(e,t){var n=e.getStartElement();if(n=n.getAscendant("td",1)||n.getAscendant("th",1)){var i=n.clone();i.appendBogus(),t?i.insertBefore(n):i.insertAfter(n)}}function o(t){if(t instanceof CKEDITOR.dom.selection){var n,i=(t=e(t))[0]&&t[0].getAscendant("table");e:{var r=0;n=t.length-1;for(var a,l,u={};a=t[r++];)CKEDITOR.dom.element.setMarker(u,a,"delete_cell",!0);for(r=0;a=t[r++];)if((l=a.getPrevious())&&!l.getCustomData("delete_cell")||(l=a.getNext())&&!l.getCustomData("delete_cell")){CKEDITOR.dom.element.clearAllMarkers(u),n=l;break e}CKEDITOR.dom.element.clearAllMarkers(u),n=(l=(l=t[0].getParent()).getPrevious())?l.getLast():(l=(l=t[n].getParent()).getNext())?l.getChild(0):null}for(l=t.length-1;0<=l;l--)o(t[l]);n?s(n,!0):i&&i.remove()}else t instanceof CKEDITOR.dom.element&&(1==(i=t.getParent()).getChildCount()?i.remove():t.remove())}function s(e,t){var n=e.getDocument(),i=CKEDITOR.document;CKEDITOR.env.ie&&10==CKEDITOR.env.version&&(i.focus(),n.focus()),(n=new CKEDITOR.dom.range(n))["moveToElementEdit"+(t?"End":"Start")](e)||(n.selectNodeContents(e),n.collapse(!t)),n.select(!0)}function l(e,t,n){if(e=e[t],void 0===n)return e;for(t=0;e&&t<e.length;t++){if(n.is&&e[t]==n.$)return t;if(t==n)return new CKEDITOR.dom.element(e[t])}return n.is?-1:null}function u(t,n,i){var r,a,o=e(t);if((n?1!=o.length:2>o.length)||(r=t.getCommonAncestor())&&r.type==CKEDITOR.NODE_ELEMENT&&r.is("table"))return!1;r=(t=o[0]).getAscendant("table");var s=CKEDITOR.tools.buildTableMap(r),u=s.length,c=s[0].length,d=t.getParent().$.rowIndex,h=l(s,d,t);if(n){var p;try{var f=parseInt(t.getAttribute("rowspan"),10)||1;a=parseInt(t.getAttribute("colspan"),10)||1,p=s["up"==n?d-f:"down"==n?d+f:d]["left"==n?h-a:"right"==n?h+a:h]}catch(e){return!1}if(!p||t.$==p)return!1;o["up"==n||"left"==n?"unshift":"push"](new CKEDITOR.dom.element(p))}n=t.getDocument();var g=d,m=(f=p=0,!i&&new CKEDITOR.dom.documentFragment(n)),v=0;for(n=0;n<o.length;n++){var y=(a=o[n]).getParent(),b=a.getFirst(),_=a.$.colSpan,T=a.$.rowSpan,E=l(s,y=y.$.rowIndex,a);v+=_*T,f=Math.max(f,E-h+_),p=Math.max(p,y-d+T),i||((T=(_=a).getBogus())&&T.remove(),_.trim(),a.getChildren().count()&&(y==g||!b||b.isBlockBoundary&&b.isBlockBoundary({br:1})||!(g=m.getLast(CKEDITOR.dom.walker.whitespaces(!0)))||g.is&&g.is("br")||m.append("br"),a.moveChildren(m)),n?a.remove():a.setHtml("")),g=y}if(i)return p*f==v;for(m.moveChildren(t),t.appendBogus(),f>=c?t.removeAttribute("rowSpan"):t.$.rowSpan=p,p>=u?t.removeAttribute("colSpan"):t.$.colSpan=f,n=(o=(i=new CKEDITOR.dom.nodeList(r.$.rows)).count())-1;0<=n;n--)(r=i.getItem(n)).$.cells.length||(r.remove(),o++);return t}function c(t,n){if(1<(i=e(t)).length)return!1;if(n)return!0;var i,r,a=(c=(i=i[0]).getParent()).getAscendant("table"),o=l(d=CKEDITOR.tools.buildTableMap(a),h=c.$.rowIndex,i);if(1<(u=i.$.rowSpan)){r=Math.ceil(u/2);for(var s,u=Math.floor(u/2),c=h+r,d=(a=new CKEDITOR.dom.element(a.$.rows[c]),l(d,c)),h=(c=i.clone(),0);h<d.length;h++){if((s=d[h]).parentNode==a.$&&h>o){c.insertBefore(new CKEDITOR.dom.element(s));break}s=null}s||a.append(c)}else for(u=r=1,(a=c.clone()).insertAfter(c),a.append(c=i.clone()),s=l(d,h),o=0;o<s.length;o++)s[o].rowSpan++;return c.appendBogus(),i.$.rowSpan=r,c.$.rowSpan=u,1==r&&i.removeAttribute("rowSpan"),1==u&&c.removeAttribute("rowSpan"),c}function d(t,n){if(1<(i=e(t)).length)return!1;if(n)return!0;var i,r=(i=i[0]).getParent(),a=r.getAscendant("table"),o=l(a=CKEDITOR.tools.buildTableMap(a),r.$.rowIndex,i);if(1<(s=i.$.colSpan))r=Math.ceil(s/2),s=Math.floor(s/2);else{for(var s=r=1,u=[],c=0;c<a.length;c++){var d=a[c];u.push(d[o]),1<d[o].rowSpan&&(c+=d[o].rowSpan-1)}for(a=0;a<u.length;a++)u[a].colSpan++}return(a=i.clone()).insertAfter(i),a.appendBogus(),i.$.colSpan=r,a.$.colSpan=s,1==r&&i.removeAttribute("colSpan"),1==s&&a.removeAttribute("colSpan"),a}var h=/^(?:td|th)$/;CKEDITOR.plugins.tabletools={requires:"table,dialog,contextmenu",init:function(i){function l(e){return CKEDITOR.tools.extend(e||{},{contextSensitive:1,refresh:function(e,t){this.setState(t.contains({td:1,th:1},1)?CKEDITOR.TRISTATE_OFF:CKEDITOR.TRISTATE_DISABLED)}})}function h(e,t){var n=i.addCommand(e,t);i.addFeature(n)}var p=i.lang.table;h("cellProperties",new CKEDITOR.dialogCommand("cellProperties",l({allowedContent:"td th{width,height,border-color,background-color,white-space,vertical-align,text-align}[colspan,rowspan]",requiredContent:"table",contentTransformations:[[{element:"td",left:function(e){return e.styles.background&&e.styles.background.match(/^(#[a-fA-F0-9]{3,6}|rgb\([\d, ]+\)|\w+)$/)},right:function(e){e.styles["background-color"]=e.styles.background}}]]}))),CKEDITOR.dialog.add("cellProperties",this.path+"dialogs/tableCell.js"),h("rowDelete",l({requiredContent:"table",exec:function(e){s(n(e=e.getSelection()))}})),h("rowInsertBefore",l({requiredContent:"table",exec:function(e){t(e=e.getSelection(),!0)}})),h("rowInsertAfter",l({requiredContent:"table",exec:function(e){t(e=e.getSelection())}})),h("columnDelete",l({requiredContent:"table",exec:function(t){var n=(t=e(t=t.getSelection()))[0],i=t[t.length-1];t=n.getAscendant("table");for(var r,a,o=CKEDITOR.tools.buildTableMap(t),l=[],u=0,c=o.length;u<c;u++)for(var d=0,h=o[u].length;d<h;d++)o[u][d]==n.$&&(r=d),o[u][d]==i.$&&(a=d);for(u=r;u<=a;u++)for(d=0;d<o.length;d++)i=o[d],n=new CKEDITOR.dom.element(t.$.rows[d]),(i=new CKEDITOR.dom.element(i[u])).$&&(1==i.$.colSpan?i.remove():--i.$.colSpan,d+=i.$.rowSpan-1,n.$.cells.length||l.push(n));a=t.$.rows[0]&&t.$.rows[0].cells,r=new CKEDITOR.dom.element(a[r]||(r?a[r-1]:t.$.parentNode)),l.length==c&&t.remove(),r&&s(r,!0)}})),h("columnInsertBefore",l({requiredContent:"table",exec:function(e){r(e=e.getSelection(),!0)}})),h("columnInsertAfter",l({requiredContent:"table",exec:function(e){r(e=e.getSelection())}})),h("cellDelete",l({requiredContent:"table",exec:function(e){o(e=e.getSelection())}})),h("cellMerge",l({allowedContent:"td[colspan,rowspan]",requiredContent:"td[colspan,rowspan]",exec:function(e){s(u(e.getSelection()),!0)}})),h("cellMergeRight",l({allowedContent:"td[colspan]",requiredContent:"td[colspan]",exec:function(e){s(u(e.getSelection(),"right"),!0)}})),h("cellMergeDown",l({allowedContent:"td[rowspan]",requiredContent:"td[rowspan]",exec:function(e){s(u(e.getSelection(),"down"),!0)}})),h("cellVerticalSplit",l({allowedContent:"td[rowspan]",requiredContent:"td[rowspan]",exec:function(e){s(d(e.getSelection()))}})),h("cellHorizontalSplit",l({allowedContent:"td[colspan]",requiredContent:"td[colspan]",exec:function(e){s(c(e.getSelection()))}})),h("cellInsertBefore",l({requiredContent:"table",exec:function(e){a(e=e.getSelection(),!0)}})),h("cellInsertAfter",l({requiredContent:"table",exec:function(e){a(e=e.getSelection())}})),i.addMenuItems&&i.addMenuItems({tablecell:{label:p.cell.menu,group:"tablecell",order:1,getItems:function(){var t=i.getSelection(),n=e(t);return{tablecell_insertBefore:CKEDITOR.TRISTATE_OFF,tablecell_insertAfter:CKEDITOR.TRISTATE_OFF,tablecell_delete:CKEDITOR.TRISTATE_OFF,tablecell_merge:u(t,null,!0)?CKEDITOR.TRISTATE_OFF:CKEDITOR.TRISTATE_DISABLED,tablecell_merge_right:u(t,"right",!0)?CKEDITOR.TRISTATE_OFF:CKEDITOR.TRISTATE_DISABLED,tablecell_merge_down:u(t,"down",!0)?CKEDITOR.TRISTATE_OFF:CKEDITOR.TRISTATE_DISABLED,tablecell_split_vertical:d(t,!0)?CKEDITOR.TRISTATE_OFF:CKEDITOR.TRISTATE_DISABLED,tablecell_split_horizontal:c(t,!0)?CKEDITOR.TRISTATE_OFF:CKEDITOR.TRISTATE_DISABLED,tablecell_properties:0<n.length?CKEDITOR.TRISTATE_OFF:CKEDITOR.TRISTATE_DISABLED}}},tablecell_insertBefore:{label:p.cell.insertBefore,group:"tablecell",command:"cellInsertBefore",order:5},tablecell_insertAfter:{label:p.cell.insertAfter,group:"tablecell",command:"cellInsertAfter",order:10},tablecell_delete:{label:p.cell.deleteCell,group:"tablecell",command:"cellDelete",order:15},tablecell_merge:{label:p.cell.merge,group:"tablecell",command:"cellMerge",order:16},tablecell_merge_right:{label:p.cell.mergeRight,group:"tablecell",command:"cellMergeRight",order:17},tablecell_merge_down:{label:p.cell.mergeDown,group:"tablecell",command:"cellMergeDown",order:18},tablecell_split_horizontal:{label:p.cell.splitHorizontal,group:"tablecell",command:"cellHorizontalSplit",order:19},tablecell_split_vertical:{label:p.cell.splitVertical,group:"tablecell",command:"cellVerticalSplit",order:20},tablecell_properties:{label:p.cell.title,group:"tablecellproperties",command:"cellProperties",order:21},tablerow:{label:p.row.menu,group:"tablerow",order:1,getItems:function(){return{tablerow_insertBefore:CKEDITOR.TRISTATE_OFF,tablerow_insertAfter:CKEDITOR.TRISTATE_OFF,tablerow_delete:CKEDITOR.TRISTATE_OFF}}},tablerow_insertBefore:{label:p.row.insertBefore,group:"tablerow",command:"rowInsertBefore",order:5},tablerow_insertAfter:{label:p.row.insertAfter,group:"tablerow",command:"rowInsertAfter",order:10},tablerow_delete:{label:p.row.deleteRow,group:"tablerow",command:"rowDelete",order:15},tablecolumn:{label:p.column.menu,group:"tablecolumn",order:1,getItems:function(){return{tablecolumn_insertBefore:CKEDITOR.TRISTATE_OFF,tablecolumn_insertAfter:CKEDITOR.TRISTATE_OFF,tablecolumn_delete:CKEDITOR.TRISTATE_OFF}}},tablecolumn_insertBefore:{label:p.column.insertBefore,group:"tablecolumn",command:"columnInsertBefore",order:5},tablecolumn_insertAfter:{label:p.column.insertAfter,group:"tablecolumn",command:"columnInsertAfter",order:10},tablecolumn_delete:{label:p.column.deleteColumn,group:"tablecolumn",command:"columnDelete",order:15}}),i.contextMenu&&i.contextMenu.addListener(function(e,t,n){return(e=n.contains({td:1,th:1},1))&&!e.isReadOnly()?{tablecell:CKEDITOR.TRISTATE_OFF,tablerow:CKEDITOR.TRISTATE_OFF,tablecolumn:CKEDITOR.TRISTATE_OFF}:null})},getSelectedCells:e},CKEDITOR.plugins.add("tabletools",CKEDITOR.plugins.tabletools)}(),CKEDITOR.tools.buildTableMap=function(e){e=e.$.rows;for(var t=-1,n=[],i=0;i<e.length;i++){!n[++t]&&(n[t]=[]);for(var r=-1,a=0;a<e[i].cells.length;a++){var o=e[i].cells[a];for(r++;n[t][r];)r++;for(var s=isNaN(o.colSpan)?1:o.colSpan,l=(o=isNaN(o.rowSpan)?1:o.rowSpan,0);l<o;l++){n[t+l]||(n[t+l]=[]);for(var u=0;u<s;u++)n[t+l][r+u]=e[i].cells[a]}r+=s-1}}return n},function(){function e(e){function n(t,n){if(n.length){t.items?t.items.push(e.ui.create("-")):t.items=[];for(var r;r=n.shift();)r="string"==typeof r?r:r.name,i&&-1!=CKEDITOR.tools.indexOf(i,r)||(r=e.ui.create(r))&&e.addFeature(r)&&t.items.push(r)}}var i=(i=e.config.removeButtons)&&i.split(","),r=e.config.toolbar;return"string"==typeof r&&(r=e.config["toolbar_"+r]),e.toolbar=r?function(e){var t,i,r,a=[];for(t=0;t<e.length;++t)r={},"/"==(i=e[t])?a.push(i):CKEDITOR.tools.isArray(i)?(n(r,CKEDITOR.tools.clone(i)),a.push(r)):i.items&&(n(r,CKEDITOR.tools.clone(i.items)),r.name=i.name,a.push(r));return a}(r):function(){for(var i=function(){var t,n,i,r={};for(t in e.ui.items)n=(i=(i=(n=e.ui.items[t]).toolbar||"others").split(","))[0],i=parseInt(i[1]||-1,10),r[n]||(r[n]=[]),r[n].push({name:t,order:i});for(n in r)r[n]=r[n].sort(function(e,t){return e.order==t.order?0:0>t.order?-1:0>e.order?1:e.order<t.order?-1:1});return r}(),r=CKEDITOR.tools.clone(e.config.toolbarGroups)||t(e),a=0;a<r.length;a++){var o=r[a];if("/"!=o){"string"==typeof o&&(o=r[a]={name:o});var s,l=o.groups;if(l)for(var u=0;u<l.length;u++)(s=i[s=l[u]])&&n(o,s);(s=i[o.name])&&n(o,s)}}return r}()}function t(e){return e._.toolbarGroups||(e._.toolbarGroups=[{name:"document",groups:["mode","document","doctools"]},{name:"clipboard",groups:["clipboard","undo"]},{name:"editing",groups:["find","selection","spellchecker"]},{name:"forms"},"/",{name:"basicstyles",groups:["basicstyles","cleanup"]},{name:"paragraph",groups:["list","indent","blocks","align","bidi"]},{name:"links"},{name:"insert"},"/",{name:"styles"},{name:"colors"},{name:"tools"},{name:"others"},{name:"about"}])}var n=function(){this.toolbars=[],this.focusCommandExecuted=!1};n.prototype.focus=function(){for(var e,t=0;e=this.toolbars[t++];)for(var n,i=0;n=e.items[i++];)if(n.focus)return void n.focus()};var i={modes:{wysiwyg:1,source:1},readOnly:1,exec:function(e){e.toolbox&&(e.toolbox.focusCommandExecuted=!0,CKEDITOR.env.ie||CKEDITOR.env.air?setTimeout(function(){e.toolbox.focus()},100):e.toolbox.focus())}};CKEDITOR.plugins.add("toolbar",{requires:"button",init:function(t){var r,a=function(e,n){var i,o="rtl"==t.lang.dir,s=t.config.toolbarGroupCycling,l=o?37:39;switch(o=o?39:37,s=void 0===s||s,n){case 9:case CKEDITOR.SHIFT+9:for(;!i||!i.items.length;)if((i=9==n?(i?i.next:e.toolbar.next)||t.toolbox.toolbars[0]:(i?i.previous:e.toolbar.previous)||t.toolbox.toolbars[t.toolbox.toolbars.length-1]).items.length)for(e=i.items[r?i.items.length-1:0];e&&!e.focus;)(e=r?e.previous:e.next)||(i=0);return e&&e.focus(),!1;case l:i=e;do{!(i=i.next)&&s&&(i=e.toolbar.items[0])}while(i&&!i.focus);return i?i.focus():a(e,9),!1;case 40:return e.button&&e.button.hasArrow?(t.once("panelShow",function(e){e.data._.panel._.currentBlock.onKeyDown(40)}),e.execute()):a(e,40==n?l:o),!1;case o:case 38:i=e;do{!(i=i.previous)&&s&&(i=e.toolbar.items[e.toolbar.items.length-1])}while(i&&!i.focus);return i?i.focus():(r=1,a(e,CKEDITOR.SHIFT+9),r=0),!1;case 27:return t.focus(),!1;case 13:case 32:return e.execute(),!1}return!0};t.on("uiSpace",function(i){if(i.data.space==t.config.toolbarLocation){i.removeListener(),t.toolbox=new n;var r,o,s=['<span id="',l=CKEDITOR.tools.getNextId(),'" class="cke_voice_label">',t.lang.toolbar.toolbars,"</span>",'<span id="'+t.ui.spaceId("toolbox")+'" class="cke_toolbox" role="group" aria-labelledby="',l,'" onmousedown="return false;">'],l=!1!==t.config.toolbarStartupExpanded;t.config.toolbarCanCollapse&&t.elementMode!=CKEDITOR.ELEMENT_MODE_INLINE&&s.push('<span class="cke_toolbox_main"'+(l?">":' style="display:none">'));for(var u=t.toolbox.toolbars,c=e(t),d=c.length,h=0;h<d;h++){var p,f,g,m=0,v=c[h],y="/"!==v&&("/"===c[h+1]||h==d-1);if(v)if(r&&(s.push("</span>"),o=r=0),"/"===v)s.push('<span class="cke_toolbar_break"></span>');else{g=v.items||v;for(var b=0;b<g.length;b++){var _,T=g[b];if(T){var E=function(e){e=e.render(t,s),0<(C=m.items.push(e)-1)&&(e.previous=m.items[C-1],e.previous.next=e),e.toolbar=m,e.onkey=a,e.onfocus=function(){t.toolbox.focusCommandExecuted||t.focus()}};if(T.type==CKEDITOR.UI_SEPARATOR)o=r&&T;else{if(_=!1!==T.canGroup,!m){p=CKEDITOR.tools.getNextId(),m={id:p,items:[]},f=v.name&&(t.lang.toolbar.toolbarGroups[v.name]||v.name),s.push('<span id="',p,'" class="cke_toolbar'+(y?' cke_toolbar_last"':'"'),f?' aria-labelledby="'+p+'_label"':"",' role="toolbar">'),f&&s.push('<span id="',p,'_label" class="cke_voice_label">',f,"</span>"),s.push('<span class="cke_toolbar_start"></span>');var C=u.push(m)-1;0<C&&(m.previous=u[C-1],m.previous.next=m)}_?r||(s.push('<span class="cke_toolgroup" role="presentation">'),r=1):r&&(s.push("</span>"),r=0),o&&(E(o),o=0),E(T)}}}r&&(s.push("</span>"),o=r=0),m&&s.push('<span class="cke_toolbar_end"></span></span>')}}if(t.config.toolbarCanCollapse&&s.push("</span>"),t.config.toolbarCanCollapse&&t.elementMode!=CKEDITOR.ELEMENT_MODE_INLINE){var w=CKEDITOR.tools.addFunction(function(){t.execCommand("toolbarCollapse")});t.on("destroy",function(){CKEDITOR.tools.removeFunction(w)}),t.addCommand("toolbarCollapse",{readOnly:1,exec:function(e){var t=e.ui.space("toolbar_collapser"),n=t.getPrevious(),i=e.ui.space("contents"),r=n.getParent(),a=parseInt(i.$.style.height,10),o=r.$.offsetHeight,s=t.hasClass("cke_toolbox_collapser_min");s?(n.show(),t.removeClass("cke_toolbox_collapser_min"),t.setAttribute("title",e.lang.toolbar.toolbarCollapse)):(n.hide(),t.addClass("cke_toolbox_collapser_min"),t.setAttribute("title",e.lang.toolbar.toolbarExpand)),t.getFirst().setText(s?"▲":"◀"),i.setStyle("height",a-(r.$.offsetHeight-o)+"px"),e.fire("resize",{outerHeight:e.container.$.offsetHeight,contentsHeight:i.$.offsetHeight,outerWidth:e.container.$.offsetWidth})},modes:{wysiwyg:1,source:1}}),t.setKeystroke(CKEDITOR.ALT+(CKEDITOR.env.ie||CKEDITOR.env.webkit?189:109),"toolbarCollapse"),s.push('<a title="'+(l?t.lang.toolbar.toolbarCollapse:t.lang.toolbar.toolbarExpand)+'" id="'+t.ui.spaceId("toolbar_collapser")+'" tabIndex="-1" class="cke_toolbox_collapser'),l||s.push(" cke_toolbox_collapser_min"),s.push('" onclick="CKEDITOR.tools.callFunction('+w+')">','<span class="cke_arrow">&#9650;</span>',"</a>")}s.push("</span>"),i.data.html+=s.join("")}}),t.on("destroy",function(){if(this.toolbox){var e,t,n,i,r=0;for(e=this.toolbox.toolbars;r<e.length;r++)for(n=e[r].items,t=0;t<n.length;t++)(i=n[t]).clickFn&&CKEDITOR.tools.removeFunction(i.clickFn),i.keyDownFn&&CKEDITOR.tools.removeFunction(i.keyDownFn)}}),t.on("uiReady",function(){var e=t.ui.space("toolbox");e&&t.focusManager.add(e,1)}),t.addCommand("toolbarFocus",i),t.setKeystroke(CKEDITOR.ALT+121,"toolbarFocus"),t.ui.add("-",CKEDITOR.UI_SEPARATOR,{}),t.ui.addHandler(CKEDITOR.UI_SEPARATOR,{create:function(){return{render:function(e,t){return t.push('<span class="cke_toolbar_separator" role="separator"></span>'),{}}}}})}}),CKEDITOR.ui.prototype.addToolbarGroup=function(e,n,i){var r=t(this.editor),a=0===n,o={name:e};if(i){if(i=CKEDITOR.tools.search(r,function(e){return e.name==i}))return!i.groups&&(i.groups=[]),n&&0<=(n=CKEDITOR.tools.indexOf(i.groups,n))?void i.groups.splice(n+1,0,e):void(a?i.groups.splice(0,0,e):i.groups.push(e));n=null}n&&(n=CKEDITOR.tools.indexOf(r,function(e){return e.name==n})),a?r.splice(0,0,e):"number"==typeof n?r.splice(n+1,0,o):r.push(e)}}(),CKEDITOR.UI_SEPARATOR="separator",CKEDITOR.config.toolbarLocation="top",function(){var e=[CKEDITOR.CTRL+90,CKEDITOR.CTRL+89,CKEDITOR.CTRL+CKEDITOR.SHIFT+90],t={8:1,46:1};CKEDITOR.plugins.add("undo",{init:function(t){function i(e){o.enabled&&!1!==e.data.command.canUndo&&o.save()}function r(){o.enabled=!t.readOnly&&"wysiwyg"==t.mode,o.onChange()}var o=t.undoManager=new n(t),s=o.editingHandler=new a(o),l=t.addCommand("undo",{exec:function(){o.undo()&&(t.selectionChange(),this.fire("afterUndo"))},startDisabled:!0,canUndo:!1}),u=t.addCommand("redo",{exec:function(){o.redo()&&(t.selectionChange(),this.fire("afterRedo"))},startDisabled:!0,canUndo:!1});t.setKeystroke([[e[0],"undo"],[e[1],"redo"],[e[2],"redo"]]),o.onChange=function(){l.setState(o.undoable()?CKEDITOR.TRISTATE_OFF:CKEDITOR.TRISTATE_DISABLED),u.setState(o.redoable()?CKEDITOR.TRISTATE_OFF:CKEDITOR.TRISTATE_DISABLED)},t.on("beforeCommandExec",i),t.on("afterCommandExec",i),t.on("saveSnapshot",function(e){o.save(e.data&&e.data.contentOnly)}),t.on("contentDom",s.attachListeners,s),t.on("instanceReady",function(){t.fire("saveSnapshot")}),t.on("beforeModeUnload",function(){"wysiwyg"==t.mode&&o.save(!0)}),t.on("mode",r),t.on("readOnly",r),t.ui.addButton&&(t.ui.addButton("Undo",{label:t.lang.undo.undo,command:"undo",toolbar:"undo,10"}),t.ui.addButton("Redo",{label:t.lang.undo.redo,command:"redo",toolbar:"undo,20"})),t.resetUndo=function(){o.reset(),t.fire("saveSnapshot")},t.on("updateSnapshot",function(){o.currentImage&&o.update()}),t.on("lockSnapshot",function(e){e=e.data,o.lock(e&&e.dontUpdate,e&&e.forceUpdate)}),t.on("unlockSnapshot",o.unlock,o)}}),CKEDITOR.plugins.undo={};var n=CKEDITOR.plugins.undo.UndoManager=function(e){this.strokesRecorded=[0,0],this.locked=null,this.previousKeyGroup=-1,this.limit=e.config.undoStackSize||20,this.strokesLimit=25,this.editor=e,this.reset()};n.prototype={type:function(e,t){var i=n.getKeyGroup(e),r=this.strokesRecorded[i]+1;t=t||r>=this.strokesLimit,this.typing||(this.hasUndo=this.typing=!0,this.hasRedo=!1,this.onChange()),t?(r=0,this.editor.fire("saveSnapshot")):this.editor.fire("change"),this.strokesRecorded[i]=r,this.previousKeyGroup=i},keyGroupChanged:function(e){return n.getKeyGroup(e)!=this.previousKeyGroup},reset:function(){this.snapshots=[],this.index=-1,this.currentImage=null,this.hasRedo=this.hasUndo=!1,this.locked=null,this.resetType()},resetType:function(){this.strokesRecorded=[0,0],this.typing=!1,this.previousKeyGroup=-1},refreshState:function(){this.hasUndo=!!this.getNextImage(!0),this.hasRedo=!!this.getNextImage(!1),this.resetType(),this.onChange()},save:function(e,t,n){var r=this.editor;if(this.locked||"ready"!=r.status||"wysiwyg"!=r.mode)return!1;var a=r.editable();if(!a||"ready"!=a.status)return!1;if(a=this.snapshots,t||(t=new i(r)),!1===t.contents)return!1;if(this.currentImage)if(t.equalsContent(this.currentImage)){if(e||t.equalsSelection(this.currentImage))return!1}else!1!==n&&r.fire("change");return a.splice(this.index+1,a.length-this.index-1),a.length==this.limit&&a.shift(),this.index=a.push(t)-1,this.currentImage=t,!1!==n&&this.refreshState(),!0},restoreImage:function(e){var t,n=this.editor;e.bookmarks&&(n.focus(),t=n.getSelection()),this.locked={level:999},this.editor.loadSnapshot(e.contents),e.bookmarks?t.selectBookmarks(e.bookmarks):CKEDITOR.env.ie&&((t=this.editor.document.getBody().$.createTextRange()).collapse(!0),t.select()),this.locked=null,this.index=e.index,this.currentImage=this.snapshots[this.index],this.update(),this.refreshState(),n.fire("change")},getNextImage:function(e){var t,n=this.snapshots,i=this.currentImage;if(i)if(e){for(t=this.index-1;0<=t;t--)if(e=n[t],!i.equalsContent(e))return e.index=t,e}else for(t=this.index+1;t<n.length;t++)if(e=n[t],!i.equalsContent(e))return e.index=t,e;return null},redoable:function(){return this.enabled&&this.hasRedo},undoable:function(){return this.enabled&&this.hasUndo},undo:function(){if(this.undoable()){this.save(!0);var e=this.getNextImage(!0);if(e)return this.restoreImage(e),!0}return!1},redo:function(){if(this.redoable()&&(this.save(!0),this.redoable())){var e=this.getNextImage(!1);if(e)return this.restoreImage(e),!0}return!1},update:function(e){if(!this.locked){e||(e=new i(this.editor));for(var t=this.index,n=this.snapshots;0<t&&this.currentImage.equalsContent(n[t-1]);)--t;n.splice(t,this.index-t+1,e),this.index=t,this.currentImage=e}},updateSelection:function(e){if(!this.snapshots.length)return!1;var t=this.snapshots,n=t[t.length-1];return!(!n.equalsContent(e)||n.equalsSelection(e)||(this.currentImage=t[t.length-1]=e,0))},lock:function(e,t){if(this.locked)this.locked.level++;else if(e)this.locked={level:1};else{var n=null;if(t)n=!0;else{var r=new i(this.editor,!0);this.currentImage&&this.currentImage.equalsContent(r)&&(n=r)}this.locked={update:n,level:1}}},unlock:function(){if(this.locked&&!--this.locked.level){var e=this.locked.update;if(this.locked=null,!0===e)this.update();else if(e){var t=new i(this.editor,!0);e.equalsContent(t)||this.update()}}}},n.navigationKeyCodes={37:1,38:1,39:1,40:1,36:1,35:1,33:1,34:1},n.keyGroups={PRINTABLE:0,FUNCTIONAL:1},n.isNavigationKey=function(e){return!!n.navigationKeyCodes[e]},n.getKeyGroup=function(e){var i=n.keyGroups;return t[e]?i.FUNCTIONAL:i.PRINTABLE},n.getOppositeKeyGroup=function(e){var t=n.keyGroups;return e==t.FUNCTIONAL?t.PRINTABLE:t.FUNCTIONAL},n.ieFunctionalKeysBug=function(e){return CKEDITOR.env.ie&&n.getKeyGroup(e)==n.keyGroups.FUNCTIONAL};var i=CKEDITOR.plugins.undo.Image=function(e,t){this.editor=e,e.fire("beforeUndoImage");var n=e.getSnapshot();CKEDITOR.env.ie&&n&&(n=n.replace(/\s+data-cke-expando=".*?"/g,"")),this.contents=n,t||(this.bookmarks=(n=n&&e.getSelection())&&n.createBookmarks2(!0)),e.fire("afterUndoImage")},r=/\b(?:href|src|name)="[^"]*?"/gi;i.prototype={equalsContent:function(e){var t=this.contents;return e=e.contents,CKEDITOR.env.ie&&(CKEDITOR.env.ie7Compat||CKEDITOR.env.quirks)&&(t=t.replace(r,""),e=e.replace(r,"")),t==e},equalsSelection:function(e){var t=this.bookmarks;if(e=e.bookmarks,t||e){if(!t||!e||t.length!=e.length)return!1;for(var n=0;n<t.length;n++){var i=t[n],r=e[n];if(i.startOffset!=r.startOffset||i.endOffset!=r.endOffset||!CKEDITOR.tools.arrayCompare(i.start,r.start)||!CKEDITOR.tools.arrayCompare(i.end,r.end))return!1}}return!0}};var a=CKEDITOR.plugins.undo.NativeEditingHandler=function(e){this.undoManager=e,this.ignoreInputEvent=!1,this.keyEventsStack=new o,this.lastKeydownImage=null};a.prototype={onKeydown:function(t){var r=t.data.getKey();229!==r&&(-1<CKEDITOR.tools.indexOf(e,t.data.getKeystroke())?t.data.preventDefault():(this.keyEventsStack.cleanUp(t),t=this.undoManager,this.keyEventsStack.getLast(r)||this.keyEventsStack.push(r),this.lastKeydownImage=new i(t.editor),(n.isNavigationKey(r)||this.undoManager.keyGroupChanged(r))&&(t.strokesRecorded[0]||t.strokesRecorded[1])&&(t.save(!1,this.lastKeydownImage,!1),t.resetType())))},onInput:function(){if(this.ignoreInputEvent)this.ignoreInputEvent=!1;else{var e=this.keyEventsStack.getLast();e||(e=this.keyEventsStack.push(0)),this.keyEventsStack.increment(e.keyCode),this.keyEventsStack.getTotalInputs()>=this.undoManager.strokesLimit&&(this.undoManager.type(e.keyCode,!0),this.keyEventsStack.resetInputs())}},onKeyup:function(e){var t=this.undoManager;e=e.data.getKey();var r=this.keyEventsStack.getTotalInputs();this.keyEventsStack.remove(e),n.ieFunctionalKeysBug(e)&&this.lastKeydownImage&&this.lastKeydownImage.equalsContent(new i(t.editor,!0))||(0<r?t.type(e):n.isNavigationKey(e)&&this.onNavigationKey(!0))},onNavigationKey:function(e){var t=this.undoManager;!e&&t.save(!0,null,!1)||t.updateSelection(new i(t.editor)),t.resetType()},ignoreInputEventListener:function(){this.ignoreInputEvent=!0},attachListeners:function(){var e=this.undoManager.editor,t=e.editable(),i=this;t.attachListener(t,"keydown",function(e){i.onKeydown(e),n.ieFunctionalKeysBug(e.data.getKey())&&i.onInput()},null,null,999),t.attachListener(t,CKEDITOR.env.ie?"keypress":"input",i.onInput,i,null,999),t.attachListener(t,"keyup",i.onKeyup,i,null,999),t.attachListener(t,"paste",i.ignoreInputEventListener,i,null,999),t.attachListener(t,"drop",i.ignoreInputEventListener,i,null,999),t.attachListener(t.isInline()?t:e.document.getDocumentElement(),"click",function(){i.onNavigationKey()},null,null,999),t.attachListener(this.undoManager.editor,"blur",function(){i.keyEventsStack.remove(9)},null,null,999)}};var o=CKEDITOR.plugins.undo.KeyEventsStack=function(){this.stack=[]};o.prototype={push:function(e){return e=this.stack.push({keyCode:e,inputs:0}),this.stack[e-1]},getLastIndex:function(e){if("number"!=typeof e)return this.stack.length-1;for(var t=this.stack.length;t--;)if(this.stack[t].keyCode==e)return t;return-1},getLast:function(e){return-1!=(e=this.getLastIndex(e))?this.stack[e]:null},increment:function(e){this.getLast(e).inputs++},remove:function(e){-1!=(e=this.getLastIndex(e))&&this.stack.splice(e,1)},resetInputs:function(e){if("number"==typeof e)this.getLast(e).inputs=0;else for(e=this.stack.length;e--;)this.stack[e].inputs=0},getTotalInputs:function(){for(var e=this.stack.length,t=0;e--;)t+=this.stack[e].inputs;return t},cleanUp:function(e){(e=e.data.$).ctrlKey||e.metaKey||this.remove(17),e.shiftKey||this.remove(16),e.altKey||this.remove(18)}}}(),CKEDITOR.plugins.add("wsc",{requires:"dialog",parseApi:function(e){e.config.wsc_onFinish="function"==typeof e.config.wsc_onFinish?e.config.wsc_onFinish:function(){},e.config.wsc_onClose="function"==typeof e.config.wsc_onClose?e.config.wsc_onClose:function(){}},parseConfig:function(e){e.config.wsc_customerId=e.config.wsc_customerId||CKEDITOR.config.wsc_customerId||"1:ua3xw1-2XyGJ3-GWruD3-6OFNT1-oXcuB1-nR6Bp4-hgQHc-EcYng3-sdRXG3-NOfFk",e.config.wsc_customDictionaryIds=e.config.wsc_customDictionaryIds||CKEDITOR.config.wsc_customDictionaryIds||"",e.config.wsc_userDictionaryName=e.config.wsc_userDictionaryName||CKEDITOR.config.wsc_userDictionaryName||"",e.config.wsc_customLoaderScript=e.config.wsc_customLoaderScript||CKEDITOR.config.wsc_customLoaderScript,e.config.wsc_interfaceLang=e.config.wsc_interfaceLang,CKEDITOR.config.wsc_cmd=e.config.wsc_cmd||CKEDITOR.config.wsc_cmd||"spell",CKEDITOR.config.wsc_version="v4.3.0-master-d769233",CKEDITOR.config.wsc_removeGlobalVariable=!0},onLoad:function(e){"moono-lisa"==(CKEDITOR.skinName||e.config.skin)&&CKEDITOR.document.appendStyleSheet(this.path+"skins/"+CKEDITOR.skin.name+"/wsc.css")},init:function(e){var t=CKEDITOR.env;this.parseConfig(e),this.parseApi(e),e.addCommand("checkspell",new CKEDITOR.dialogCommand("checkspell")).modes={wysiwyg:!(CKEDITOR.env.opera||CKEDITOR.env.air||document.domain!=window.location.hostname||t.ie&&(8>t.version||t.quirks))},void 0===e.plugins.scayt&&e.ui.addButton&&e.ui.addButton("SpellChecker",{label:e.lang.wsc.toolbar,click:function(e){var t=e.elementMode==CKEDITOR.ELEMENT_MODE_INLINE?e.container.getText():e.document.getBody().getText();(t=t.replace(/\s/g,""))?e.execCommand("checkspell"):alert("Nothing to check!")},toolbar:"spellchecker,10"}),CKEDITOR.dialog.add("checkspell",this.path+(CKEDITOR.env.ie&&7>=CKEDITOR.env.version?"dialogs/wsc_ie.js":window.postMessage?"dialogs/wsc.js":"dialogs/wsc_ie.js"))}}),function(){function e(e){function t(e){var t=!1;o.attachListener(o,"keydown",function(){var n=i.getBody().getElementsByTag(e);if(!t){for(var r=0;r<n.count();r++)n.getItem(r).setCustomData("retain",!0);t=!0}},null,null,1),o.attachListener(o,"keyup",function(){var n=i.getElementsByTag(e);t&&(1!=n.count()||n.getItem(0).getCustomData("retain")||n.getItem(0).hasAttribute("data-cke-temp")||n.getItem(0).remove(1),t=!1)})}var n=this.editor,i=e.document,r=i.body,a=i.getElementById("cke_actscrpt");a&&a.parentNode.removeChild(a),(a=i.getElementById("cke_shimscrpt"))&&a.parentNode.removeChild(a),(a=i.getElementById("cke_basetagscrpt"))&&a.parentNode.removeChild(a),r.contentEditable=!0,CKEDITOR.env.ie&&(r.hideFocus=!0,r.disabled=!0,r.removeAttribute("disabled")),delete this._.isLoadingData,this.$=r,i=new CKEDITOR.dom.document(i),this.setup(),this.fixInitialSelection();var o=this;CKEDITOR.env.ie&&!CKEDITOR.env.edge&&i.getDocumentElement().addClass(i.$.compatMode),CKEDITOR.env.ie&&!CKEDITOR.env.edge&&n.enterMode!=CKEDITOR.ENTER_P?t("p"):CKEDITOR.env.edge&&n.enterMode!=CKEDITOR.ENTER_DIV&&t("div"),(CKEDITOR.env.webkit||CKEDITOR.env.ie&&10<CKEDITOR.env.version)&&i.getDocumentElement().on("mousedown",function(e){e.data.getTarget().is("html")&&setTimeout(function(){n.editable().focus()})}),function(e){function t(e){e.returnValue=!1}if(CKEDITOR.env.gecko)try{var n=e.document.$;n.execCommand("enableObjectResizing",!1,!e.config.disableObjectResizing),n.execCommand("enableInlineTableEditing",!1,!e.config.disableNativeTableHandles)}catch(e){}else CKEDITOR.env.ie&&11>CKEDITOR.env.version&&e.config.disableObjectResizing&&function(){var n;e.editable().attachListener(e,"selectionChange",function(){var i=e.getSelection().getSelectedElement();i&&(n&&(n.detachEvent("onresizestart",t),n=null),i.$.attachEvent("onresizestart",t),n=i.$)})}()}(n);try{n.document.$.execCommand("2D-position",!1,!0)}catch(e){}(CKEDITOR.env.gecko||CKEDITOR.env.ie&&"CSS1Compat"==n.document.$.compatMode)&&this.attachListener(this,"keydown",function(e){var t=e.data.getKeystroke();if(33==t||34==t)if(CKEDITOR.env.ie)setTimeout(function(){n.getSelection().scrollIntoView()},0);else if(n.window.$.innerHeight>this.$.offsetHeight){var i=n.createRange();i[33==t?"moveToElementEditStart":"moveToElementEditEnd"](this),i.select(),e.data.preventDefault()}}),CKEDITOR.env.ie&&this.attachListener(i,"blur",function(){try{i.$.selection.empty()}catch(e){}}),CKEDITOR.env.iOS&&this.attachListener(i,"touchend",function(){e.focus()}),(r=n.document.getElementsByTag("title").getItem(0)).data("cke-title",r.getText()),CKEDITOR.env.ie&&(n.document.$.title=this._.docTitle),CKEDITOR.tools.setTimeout(function(){"unloaded"==this.status&&(this.status="ready"),n.fire("contentDom"),this._.isPendingFocus&&(n.focus(),this._.isPendingFocus=!1),setTimeout(function(){n.fire("dataReady")},0)},0,this)}var t;CKEDITOR.plugins.add("wysiwygarea",{init:function(e){e.config.fullPage&&e.addFeature({allowedContent:"html head title; style [media,type]; body (*)[id]; meta link [*]",requiredContent:"body"}),e.addMode("wysiwyg",function(n){function i(i){i&&i.removeListener(),e.editable(new t(e,a.$.contentWindow.document.body)),e.setData(e.getData(1),n)}var r="document.open();"+(CKEDITOR.env.ie?"("+CKEDITOR.tools.fixDomain+")();":"")+"document.close();",a=(r=CKEDITOR.env.air?"javascript:void(0)":CKEDITOR.env.ie&&!CKEDITOR.env.edge?"javascript:void(function(){"+encodeURIComponent(r)+"}())":"",CKEDITOR.dom.element.createFromHtml('<iframe src="'+r+'" frameBorder="0"></iframe>'));a.setStyles({width:"100%",height:"100%"}),a.addClass("cke_wysiwyg_frame").addClass("cke_reset"),(r=e.ui.space("contents")).append(a);var o=CKEDITOR.env.ie&&!CKEDITOR.env.edge||CKEDITOR.env.gecko;o&&a.on("load",i);var s=e.title,l=e.fire("ariaEditorHelpLabel",{}).label;if(s&&(CKEDITOR.env.ie&&l&&(s+=", "+l),a.setAttribute("title",s)),l){s=CKEDITOR.tools.getNextId();var u=CKEDITOR.dom.element.createFromHtml('<span id="'+s+'" class="cke_voice_label">'+l+"</span>");r.append(u,1),a.setAttribute("aria-describedby",s)}e.on("beforeModeUnload",function(e){e.removeListener(),u&&u.remove()}),a.setAttributes({tabIndex:e.tabIndex,allowTransparency:"true"}),!o&&i(),e.fire("ariaWidget",a)})}}),CKEDITOR.editor.prototype.addContentsCss=function(e){var t=this.config,n=t.contentsCss;CKEDITOR.tools.isArray(n)||(t.contentsCss=n?[n]:[]),t.contentsCss.push(e)},t=CKEDITOR.tools.createClass({$:function(){this.base.apply(this,arguments),this._.frameLoadedHandler=CKEDITOR.tools.addFunction(function(t){CKEDITOR.tools.setTimeout(e,0,this,t)},this),this._.docTitle=this.getWindow().getFrame().getAttribute("title")},base:CKEDITOR.editable,proto:{setData:function(e,t){var n=this.editor;if(t)this.setHtml(e),this.fixInitialSelection(),n.fire("dataReady");else{this._.isLoadingData=!0,n._.dataStore={id:1};var i=n.config,r=i.fullPage,a=i.docType,o=CKEDITOR.tools.buildStyleHtml(function(){var e=[];if(8<=CKEDITOR.document.$.documentMode){e.push("html.CSS1Compat [contenteditable=false]{min-height:0 !important}");var t,n=[];for(t in CKEDITOR.dtd.$removeEmpty)n.push("html.CSS1Compat "+t+"[contenteditable=false]");e.push(n.join(",")+"{display:inline-block}")}else CKEDITOR.env.gecko&&(e.push("html{height:100% !important}"),e.push("img:-moz-broken{-moz-force-broken-image-icon:1;min-width:24px;min-height:24px}"));return e.push("html{cursor:text;*cursor:auto}"),e.push("img,input,textarea{cursor:default}"),e.join("\n")}()).replace(/<style>/,'<style data-cke-temp="1">');r||(o+=CKEDITOR.tools.buildStyleHtml(n.config.contentsCss));var s=i.baseHref?'<base href="'+i.baseHref+'" data-cke-temp="1" />':"";r&&(e=e.replace(/<!DOCTYPE[^>]*>/i,function(e){return n.docType=a=e,""}).replace(/<\?xml\s[^\?]*\?>/i,function(e){return n.xmlDeclaration=e,""})),e=n.dataProcessor.toHtml(e),r?(/<body[\s|>]/.test(e)||(e="<body>"+e),/<html[\s|>]/.test(e)||(e="<html>"+e+"</html>"),/<head[\s|>]/.test(e)?/<title[\s|>]/.test(e)||(e=e.replace(/<head[^>]*>/,"$&<title></title>")):e=e.replace(/<html[^>]*>/,"$&<head><title></title></head>"),s&&(e=e.replace(/<head[^>]*?>/,"$&"+s)),e=e.replace(/<\/head\s*>/,o+"$&"),e=a+e):e=i.docType+'<html dir="'+i.contentsLangDirection+'" lang="'+(i.contentsLanguage||n.langCode)+'"><head><title>'+this._.docTitle+"</title>"+s+o+"</head><body"+(i.bodyId?' id="'+i.bodyId+'"':"")+(i.bodyClass?' class="'+i.bodyClass+'"':"")+">"+e+"</body></html>",CKEDITOR.env.gecko&&(e=e.replace(/<body/,'<body contenteditable="true" '),2e4>CKEDITOR.env.version&&(e=e.replace(/<body[^>]*>/,"$&\x3c!-- cke-content-start --\x3e"))),i='<script id="cke_actscrpt" type="text/javascript"'+(CKEDITOR.env.ie?' defer="defer" ':"")+">var wasLoaded=0;function onload(){if(!wasLoaded)window.parent.CKEDITOR.tools.callFunction("+this._.frameLoadedHandler+",window);wasLoaded=1;}"+(CKEDITOR.env.ie?"onload();":'document.addEventListener("DOMContentLoaded", onload, false );')+"<\/script>",CKEDITOR.env.ie&&9>CKEDITOR.env.version&&(i+='<script id="cke_shimscrpt">window.parent.CKEDITOR.tools.enableHtml5Elements(document)<\/script>'),s&&CKEDITOR.env.ie&&10>CKEDITOR.env.version&&(i+='<script id="cke_basetagscrpt">var baseTag = document.querySelector( "base" );baseTag.href = baseTag.href;<\/script>'),e=e.replace(/(?=\s*<\/(:?head)>)/,i),this.clearCustomData(),this.clearListeners(),n.fire("contentDomUnload");var l=this.getDocument();try{l.write(e)}catch(t){setTimeout(function(){l.write(e)},0)}}},getData:function(e){if(e)return this.getHtml();var t=(e=this.editor).config,n=(a=t.fullPage)&&e.docType,i=a&&e.xmlDeclaration,r=this.getDocument(),a=a?r.getDocumentElement().getOuterHtml():r.getBody().getHtml();return CKEDITOR.env.gecko&&t.enterMode!=CKEDITOR.ENTER_BR&&(a=a.replace(/<br>(?=\s*(:?$|<\/body>))/,"")),a=e.dataProcessor.toDataFormat(a),i&&(a=i+"\n"+a),n&&(a=n+"\n"+a),a},focus:function(){this._.isLoadingData?this._.isPendingFocus=!0:t.baseProto.focus.call(this)},detach:function(){var e,n=this.editor,i=n.document;try{e=n.window.getFrame()}catch(e){}t.baseProto.detach.call(this),this.clearCustomData(),i.getDocumentElement().clearCustomData(),CKEDITOR.tools.removeFunction(this._.frameLoadedHandler),e&&e.getParent()?(e.clearCustomData(),(n=e.removeCustomData("onResize"))&&n.removeListener(),e.remove()):CKEDITOR.warn("editor-destroy-iframe")}}})}(),CKEDITOR.config.disableObjectResizing=!1,CKEDITOR.config.disableNativeTableHandles=!0,CKEDITOR.config.disableNativeSpellChecker=!0,CKEDITOR.config.plugins="dialogui,dialog,a11yhelp,about,basicstyles,blockquote,clipboard,panel,floatpanel,menu,contextmenu,elementspath,indent,indentlist,list,enterkey,entities,popup,filebrowser,floatingspace,listblock,button,richcombo,format,horizontalrule,htmlwriter,image,fakeobjects,link,magicline,maximize,pastefromword,pastetext,removeformat,resize,menubutton,scayt,showborders,sourcearea,specialchar,stylescombo,tab,table,tabletools,toolbar,undo,wsc,wysiwygarea",CKEDITOR.config.skin="moono-lisa",function(){var e=function(e,t){var n=CKEDITOR.getUrl("plugins/"+t);e=e.split(",");for(var i=0;i<e.length;i++)CKEDITOR.skin.icons[e[i]]={path:n,offset:-e[++i],bgsize:e[++i]}};CKEDITOR.env.hidpi?e("about,0,,bold,24,,italic,48,,strike,72,,subscript,96,,superscript,120,,underline,144,,bidiltr,168,,bidirtl,192,,blockquote,216,,copy-rtl,240,,copy,264,,cut-rtl,288,,cut,312,,paste-rtl,336,,paste,360,,codesnippet,384,,bgcolor,408,,textcolor,432,,copyformatting,456,,creatediv,480,,docprops-rtl,504,,docprops,528,,embed,552,,embedsemantic,576,,find-rtl,600,,find,624,,replace,648,,flash,672,,button,696,,checkbox,720,,form,744,,hiddenfield,768,,imagebutton,792,,radio,816,,select-rtl,840,,select,864,,textarea-rtl,888,,textarea,912,,textfield-rtl,936,,textfield,960,,horizontalrule,984,,iframe,1008,,image,1032,,indent-rtl,1056,,indent,1080,,outdent-rtl,1104,,outdent,1128,,justifyblock,1152,,justifycenter,1176,,justifyleft,1200,,justifyright,1224,,language,1248,,anchor-rtl,1272,,anchor,1296,,link,1320,,unlink,1344,,bulletedlist-rtl,1368,,bulletedlist,1392,,numberedlist-rtl,1416,,numberedlist,1440,,mathjax,1464,,maximize,1488,,newpage-rtl,1512,,newpage,1536,,pagebreak-rtl,1560,,pagebreak,1584,,pastefromword-rtl,1608,,pastefromword,1632,,pastetext-rtl,1656,,pastetext,1680,,placeholder,1704,,preview-rtl,1728,,preview,1752,,print,1776,,removeformat,1800,,save,1824,,scayt,1848,,selectall,1872,,showblocks-rtl,1896,,showblocks,1920,,smiley,1944,,source-rtl,1968,,source,1992,,sourcedialog-rtl,2016,,sourcedialog,2040,,specialchar,2064,,table,2088,,templates-rtl,2112,,templates,2136,,uicolor,2160,,redo-rtl,2184,,redo,2208,,undo-rtl,2232,,undo,2256,,simplebox,4560,auto,spellchecker,2304,","icons_hidpi.png"):e("about,0,auto,bold,24,auto,italic,48,auto,strike,72,auto,subscript,96,auto,superscript,120,auto,underline,144,auto,bidiltr,168,auto,bidirtl,192,auto,blockquote,216,auto,copy-rtl,240,auto,copy,264,auto,cut-rtl,288,auto,cut,312,auto,paste-rtl,336,auto,paste,360,auto,codesnippet,384,auto,bgcolor,408,auto,textcolor,432,auto,copyformatting,456,auto,creatediv,480,auto,docprops-rtl,504,auto,docprops,528,auto,embed,552,auto,embedsemantic,576,auto,find-rtl,600,auto,find,624,auto,replace,648,auto,flash,672,auto,button,696,auto,checkbox,720,auto,form,744,auto,hiddenfield,768,auto,imagebutton,792,auto,radio,816,auto,select-rtl,840,auto,select,864,auto,textarea-rtl,888,auto,textarea,912,auto,textfield-rtl,936,auto,textfield,960,auto,horizontalrule,984,auto,iframe,1008,auto,image,1032,auto,indent-rtl,1056,auto,indent,1080,auto,outdent-rtl,1104,auto,outdent,1128,auto,justifyblock,1152,auto,justifycenter,1176,auto,justifyleft,1200,auto,justifyright,1224,auto,language,1248,auto,anchor-rtl,1272,auto,anchor,1296,auto,link,1320,auto,unlink,1344,auto,bulletedlist-rtl,1368,auto,bulletedlist,1392,auto,numberedlist-rtl,1416,auto,numberedlist,1440,auto,mathjax,1464,auto,maximize,1488,auto,newpage-rtl,1512,auto,newpage,1536,auto,pagebreak-rtl,1560,auto,pagebreak,1584,auto,pastefromword-rtl,1608,auto,pastefromword,1632,auto,pastetext-rtl,1656,auto,pastetext,1680,auto,placeholder,1704,auto,preview-rtl,1728,auto,preview,1752,auto,print,1776,auto,removeformat,1800,auto,save,1824,auto,scayt,1848,auto,selectall,1872,auto,showblocks-rtl,1896,auto,showblocks,1920,auto,smiley,1944,auto,source-rtl,1968,auto,source,1992,auto,sourcedialog-rtl,2016,auto,sourcedialog,2040,auto,specialchar,2064,auto,table,2088,auto,templates-rtl,2112,auto,templates,2136,auto,uicolor,2160,auto,redo-rtl,2184,auto,redo,2208,auto,undo-rtl,2232,auto,undo,2256,auto,simplebox,2280,auto,spellchecker,2304,auto","icons.png")}()),org.ekstep.pluginframework.pluginManager.registerPlugin({id:"org.ekstep.richtext",ver:"1.0",shortId:"org.ekstep.richtext",displayName:"Rich Text",author:"Kartheek Palla",title:"Text Plugin",description:"",publishedDate:"",editor:{main:"editor/plugin.js",dependencies:[{type:"js",src:"editor/libs/ckeditor.js"},{type:"css",src:"editor/style.css"}],views:[{template:"./richtexteditor.html",controller:"./richtexteditorapp.js"}],behaviour:{rotatable:!1},configManifest:[{type:"custom_template",templateURL:"editor/configTemplate.html"}],help:{src:"editor/help.md",dataType:"text"}},renderer:{main:"renderer/richtextrendererplugin.js"}},org.ekstep.contenteditor.basePlugin.extend({type:"org.ekstep.richtext",magicNumber:1920,editorWidth:720,richTextId:"richtext-wrapper",initialize:function(){var e=this;CKEDITOR.basePath=ecEditor.resolvePluginResource(this.manifest.id,this.manifest.ver,"editor/libs/"),ecEditor.addEventListener(this.type+":showpopup",this.loadHtml,this),ecEditor.addEventListener("stage:unselect",this.removeHtmlElements,this),ecEditor.addEventListener("stage:create",this.removeHtmlElements,this),ecEditor.addEventListener(e.manifest.id+":adddiv",this.addDivElement,this),org.ekstep.contenteditor.api.getCanvas().on("object:scaling",this.resizeObject,this),ecEditor.resolvePluginResource(e.manifest.id,e.manifest.ver,"editor/richtexteditor.html"),ecEditor.resolvePluginResource(e.manifest.id,e.manifest.ver,"editor/richtexteditorapp.js"),ecEditor.getService("popup").loadNgModules(n(84),n(85),!0),(e=document.createElement("div")).setAttribute("id",this.richTextId),e.setAttribute("class",this.richTextId),ecEditor.jQuery(".canvas-container").append(e)},newInstance:function(){this.configManifest=_.remove(this.configManifest,function(e){return"stroke"!=e.propertyName});var e=this.convertToFabric(this.attributes);ecEditor._.isUndefined(this.config.text)&&(this.config.text=ecEditor._.isUndefined(this.attributes.__text)?"":this.attributes.__text),delete e.__text,this.editorObj=new fabric.Rect(e),this.editorObj.visible=!0,this.editorObj&&this.editorObj.setFill(e.fill),ecEditor.dispatchEvent(this.manifest.id+":adddiv",{data:this})},resizeObject:function(e){var t,n;ecEditor.getCurrentObject()&&"org.ekstep.richtext"==ecEditor.getCurrentObject().manifest.id&&(t=ecEditor.jQuery("#canvas").offset(),n=ecEditor.getCurrentObject(),ecEditor.jQuery("#"+e.target.id).offset({top:e.target.top+t.top,left:e.target.left+t.left}),n.attributes.w=e.target.getWidth(),n.attributes.h=e.target.getHeight(),n.editorObj.width=e.target.getWidth(),n.editorObj.height=e.target.getHeight(),ecEditor.jQuery("#"+e.target.id).width(e.target.getWidth()),ecEditor.jQuery("#"+e.target.id).height(e.target.getHeight()))},moving:function(e){var t=ecEditor.jQuery("#canvas").offset();ecEditor.jQuery("#"+this.editorObj.id).offset({top:this.editorObj.top+t.top,left:this.editorObj.left+t.left})},selected:function(e){fabric.util.addListener(fabric.document,"dblclick",this.dblClickHandler)},deselected:function(e,t,n){fabric.util.removeListener(fabric.document,"dblclick",this.dblClickHandler)},removed:function(e,t,n){ecEditor.jQuery("div#"+e.id).remove()},addDivElement:function(e,t){var n=ecEditor.jQuery("#canvas").offset(),i=((i=document.createElement("div")).setAttribute("id",t.data.id),i.style.position="absolute",i.style.fontSize="14px",i.style.width=t.data.editorObj.width?t.data.editorObj.width+1+"px":"auto",i.style.height=t.data.editorObj.height?t.data.editorObj.height+1+"px":"auto",i.style.pointerEvents="none",ecEditor.jQuery(".canvas-container #"+this.richTextId).append(i),ecEditor.jQuery(".canvas-container #"+this.richTextId+" div#"+t.data.id).html(t.data.config.text),ecEditor.jQuery("#"+t.data.id).offset({top:t.data.editorObj.top+n.top,left:Number(parseInt(ecEditor.jQuery(".canvas-container").css("margin-left")))+(t.data.editorObj.left+n.left)}),ecEditor.jQuery("#"+t.data.id).width());n=ecEditor.jQuery("#"+t.data.id).height(),ecEditor.jQuery("#"+t.data.id).width(i),ecEditor.jQuery("#"+t.data.id).height(n),t.data.editorObj.width=i,t.data.editorObj.height=n},dblClickHandler:function(e){"canvas"==e.target.tagName.toLowerCase()&&ecEditor.getCurrentObject()&&"org.ekstep.richtext"===ecEditor.getCurrentObject().manifest.id&&ecEditor.dispatchEvent("org.ekstep.richtext:showpopup",{textSelected:!0})},loadHtml:function(e,t){0<document.getElementsByClassName("richtextEditor_1").length||(this.textSelected=!!t&&t.textSelected,currentInstance=this,ecEditor.getService("popup").open({template:"richtexteditor",controller:"richtexteditorcontroller",controllerAs:"$ctrl",resolve:{instance:function(){return currentInstance}},data:{textSelected:this.textSelected},width:500,showClose:!1,closeByEscape:!1,closeByDocument:!1,className:"ngdialog-theme-plain richtextEditor_1"}))},render:function(e){e.add(this.editorObj),ecEditor.dispatchEvent(this.manifest.id+":adddiv",{data:this})},removeHtmlElements:function(){org.ekstep.contenteditor.api.jQuery("#"+this.richTextId).empty()},getAttributes:function(){var e=this._super();return e.fontSize=this.updateFontSize(ecEditor.jQuery("#"+this.richTextId).css("font-size"),!1),e},getConfig:function(){var e=this._super();return e.fontsize=ecEditor.jQuery("#"+this.id).css("font-size"),_.omit(e,["stroke","strokeWidth"])},toECML:function(){return _.omit(this._super(),["__text"])},onConfigChange:function(e,t){var n="";switch(e){case"fontweight":_.each(ecEditor.jQuery("#"+this.id).children(),function(e){e.innerHTML="<strong>"+e.innerHTML+"</strong>",n+=e.outerHTML}),this.config.text=n;break;case"fontstyle":_.each(ecEditor.jQuery("#"+this.id).children(),function(e){e.innerHTML="<em>"+e.innerHTML+"</em>",n+=e.outerHTML}),this.config.text=n;break;case"fontsize":break;case"align":_.each(ecEditor.jQuery("#"+this.id).children(),function(e){e.style.textAlign=t,n+=e.outerHTML}),this.config.text=n}ecEditor.render(),ecEditor.dispatchEvent("object:modified",{target:ecEditor.getEditorObject()})},updateFontSize:function(e,t){var n,i=void 0;return t?(n=this.attributes.w*(this.magicNumber/100),i=this.editorWidth*this.attributes.w/100,parseInt(Math.round(e*(i/n)).toString())):(n=this.editorObj.width/this.magicNumber*100,i=this.editorObj.width/this.editorWidth*100,parseFloat((parseInt(e)*(i/n)).toFixed(2)))}}))},function(e,t){e.exports='<script type="text/ng-template" ng-app="richtexteditorapp" ng-controller="richtexteditorcontroller as $ctrl" id="richtexteditor">\n    <div class="ui modal small active" style="top: 10% !important; width:730px!important;">\n        <div class="header">\n            <div class="ui two column grid">\n                <div class="row">\n                    <div class="column">\n                        <span><i class="fa fa-file-text-o"></i> Text Editor</span>\n                    </div>\n                    <div class="column" style="text-align: right; cursor: pointer;">\n                        <i class="cursor-pointer close icon" ng-click="closeThisDialog()"></i>\n                    </div>\n                </div>\n            </div>\n        </div>\n        <div class="content">\n            <textarea name="editor1" id="editor1" rows="10" cols="80" ng-model="$ctrl.text"></textarea>\n        </div>\n        <div class="actions">\n            <div class="ui buttons">\n                <div class="ui grid">\n                    <div class="eight wide column left aligned richtext-message">\n                        <p>Please select appropriate font name (typeface) as per the language of your text.</p>\n                    </div>\n                    <div class="four wide column right aligned">\n                        <div class="ui buttons" style="margin:0;">\n                            <button class="ui orange button" ng-click="closeThisDialog()" type="button">Cancel</button>\n                            <div class="or"></div>\n                            <button class="ui blue button" id="addLesson" type="button" ng-click="$ctrl.addText()">Add To Lesson</button>\n                        </div>\n                    </div>\n                </div>\n            </div>\n        </div>\n    </div>\n<\/script>'},function(e,t,n){"use strict";angular.module("richtexteditorapp",[]).controller("richtexteditorcontroller",["$scope","$injector","instance",function(e,t,n){var i=this;i.text="",i.pluginLoadStartTime=new Date,i.generateImpression=function(e){e&&ecEditor.getService("telemetry").impression({type:e.type,subtype:e.subtype||"",pageid:e.pageid||"",uri:window.location.href,duration:e.duration})},e.$on("ngDialog.opened",function(e,t){var n=document.getElementsByClassName("richtextEditor_1");(n=n[0]).addEventListener("click",function(e){var t=i.mapElementWithName(e.srcElement);t&&i.generateTelemetry({id:"button",type:"click",subtype:t.subtype,target:t.target})}),i.selectedText=!1;var r=org.ekstep.pluginframework.pluginManager.getPluginManifest("org.ekstep.richtext");CKEDITOR.replace("editor1",{customConfig:ecEditor.resolvePluginResource(r.id,r.ver,"editor/libs/config.js"),skin:"moono-lisa,"+CKEDITOR.basePath+"skins/moono-lisa/",contentsCss:ecEditor.resolvePluginResource(r.id,r.ver,"editor/libs/contents.css")});var a=ecEditor.getCurrentObject();e.currentScope.ngDialogData&&e.currentScope.ngDialogData.textSelected&&a&&(i.selectedText=!0,CKEDITOR.instances.editor1.setData(a.config.text)),i.generateImpression({type:"view",subtype:"popup-open",pageid:"RichTextEditor",duration:new Date-i.pluginLoadStartTime})}),i.generateTelemetry=function(e){e&&org.ekstep.contenteditor.api.getService(ServiceConstants.TELEMETRY_SERVICE).interact({id:e.id,type:e.type,subtype:e.subtype,target:e.target,pluginid:n.manifest.id,pluginver:n.manifest.ver,objectid:i.selectedText?org.ekstep.contenteditor.api.getCurrentObject().id:"",stage:ecEditor.getCurrentStage().id})},i.addText=function(){var t=ecEditor.getCurrentObject();t&&i.selectedText?(t.config.text=CKEDITOR.instances.editor1.getData(),t.attributes.__text=t.config.text,ecEditor.jQuery("#richtext-wrapper div#"+t.id).html(t.config.text)):ecEditor.dispatchEvent("org.ekstep.richtext:create",{__text:CKEDITOR.instances.editor1.getData(),type:"rect",x:10,y:20,fill:"rgba(0, 0, 0, 0)",opacity:1}),org.ekstep.contenteditor.api.dispatchEvent("object:modified"),e.closeThisDialog()},i.mapElementWithName=function(e){var t={},n="select",i="dropdown",r=e.title||e.parentElement.title||e.outerText||e.parentElement.text;switch(r){case"Bold (Ctrl+B)":t.target="Bold",t.subtype=n;break;case"Italic (Ctrl+I)":t.target="Italic",t.subtype=n;break;case"Strikethrough":t.target=r,t.subtype=n;break;case"Remove Format":t.target="RemoveFromat",t.subtype=n;break;case"Insert/Remove Numbered List":t.target="NumberedList",t.subtype=n;break;case"Insert/Remove Bulleted List":t.target="BulletList",t.subtype=n;break;case"Align Left":t.target="AlignLeft",t.subtype=n;break;case"Center":t.target="AlignCenter",t.subtype=n;break;case"Align Right":t.target="AlignRight",t.subtype=n;break;case"Justify":t.target="Justify",t.subtype=n;break;case"Paragraph Format":t.target="ParagraphFromat",t.subtype=i;break;case"Font Name":t.target="FontName",t.subtype=i;break;case"Font Size":t.target="FontSize",t.subtype=i;break;case"Text Color":t.target="TextColor",t.subtype=n;break;case"Background Color":t.target="BackgroundColor",t.subtype=n;break;case"Cancel":t.target="Cancel",t.subtype=n;break;case"Add To Lesson":t.target="AddToLesson",t.subtype=n}return t}}])},function(e,t){org.ekstep.pluginframework.pluginManager.registerPlugin({id:"org.ekstep.iterator",ver:"1.0",author:"Jagadish",type:"plugin",title:"Iterator",description:"It is a base plugin for all collection plugins which needs navigation control",editor:{main:"editor/plugin.js",dependencies:[],menu:[]},renderer:{main:"renderer/plugin.js"},icon:"assets/icon.png",languages:["English"],categories:[""],keywords:[""]},org.ekstep.contenteditor.basePlugin.extend({initialize:function(){},newInstance:function(){}}))},function(e,t){org.ekstep.pluginframework.pluginManager.registerPlugin({id:"org.ekstep.navigation",ver:"1.0",author:"Jagadish",type:"plugin",title:"Navigation",description:"",editor:{main:"editor/plugin.js",menu:[]},renderer:{main:"renderer/plugin.js",dependencies:[{type:"js",src:"renderer/controller/navigation_ctrl.js",scope:"all"},{type:"js",src:"renderer/templates/navigation.html",scope:"all"}]},icon:"assets/icon.png",languages:["English"],categories:[""],keywords:[""]},org.ekstep.contenteditor.basePlugin.extend({initialize:function(){var e=this;ecEditor.addEventListener("content:load:complete",function(t){ecEditor.instantiatePlugin(e.manifest.id,{},void 0)})},newInstance:function(){}}))},function(e,t){org.ekstep.pluginframework.pluginManager.registerPlugin({id:"org.ekstep.reviewercomments",ver:"1.0",author:"Revathi P",title:"Reviewer Comments",description:"",publishedDate:"",editor:{main:"editor/plugin.js",dependencies:[{type:"css",src:"editor/comments.css"}],menu:[],sidebarMenu:[{id:"comments",type:"icon",toolTip:"comments",title:"comments",iconClass:"comment icon",templateURL:"editor/partials/sidebarCommentsTemplate.html"}]}},org.ekstep.contenteditor.basePlugin.extend({NO_COMMENTS:"No Reviewer Comments",initialize:function(){ecEditor.addEventListener("stage:render:complete",this.initializeComments,this)},initializeComments:function(e,t){var n,i=this;null==i.comments?(this.context=org.ekstep.contenteditor.globalContext,ecEditor._.get(this.context.contentId)||(i=this,n=ecEditor.getService("content").getContentMeta(org.ekstep.contenteditor.api.getContext("contentId")).pkgVersion,n={request:{contextDetails:{contentId:ecEditor.getContext("contentId"),contentType:ecEditor.getService("content").getContentMeta(org.ekstep.contenteditor.api.getContext("contentId")).mimeType,contentVer:_.isUndefined(n)?"0":n.toString()}}},ecEditor.getService(ServiceConstants.CONTENT_SERVICE).getComments(n,function(e,t){try{t&&t.data.responseCode&&t.data.result.comments&&i.showComments(t.data.result.comments)}catch(e){i.displayNoComments(),ecEditor.dispatchEvent("org.ekstep.toaster:error",{message:"Error in fetching comments, please try again!",position:"topCenter",icon:"fa fa-warning"}),ecEditor.getService("telemetry").error({env:"content",stage:ecEditor.getCurrentStage().id,action:"review comments",objectid:"",objecttype:"",err:e.status,type:"API",data:e,severity:"fatal"}),console.warn("error in fetching review comments: ",e)}}))):i.displayStageComments(i.comments)},showComments:function(e){e&&(e=_.sortBy(e,function(e){return new Date(e.createdOn)}),this.mapComment(e))},displayNoComments:function(){jQuery('a[data-content ="comments"]').removeClass("highlight"),ecEditor.jQuery("#reviewerComments").html("<div>"+this.NO_COMMENTS+"</div>")},getMonthName:function(e){return(e=new Date(e)).toLocaleString("en-us",{month:"long"}).toString().substr(0,3)+" "+e.getDate()},mapComment:function(e){var t=this,n=[];_.map(e,function(e){var i={};i.username=e.userInfo.name,i.logo=e.userInfo.logo||ecEditor.resolvePluginResource(t.manifest.id,t.manifest.ver,"assets/reviewer_icon.png"),i.username=e.userInfo.name,i.date=t.getMonthName(e.createdOn),i.body=e.body,i.stageId=e.stageId,n.push(i)}),t.comments=n,t.displayStageComments()},filterComments:function(){return _.filter(this.comments,["stageId",ecEditor.getCurrentStage().id])},displayStageComments:function(){var e;filteredComments=[],0<(filteredComments=this.filterComments()).length?(e=_.template('<% _.each(filteredComments, function(item) { %><div class="comment"> <div class="avatar"><img src= " <%-item.logo %> "/></div><div class="content"><div class="flex-class"><span class="author"><%- item.username %></span><span class="date"><%- item.date %> </span></div><div class="text"> <%-item.body  %> </div></div></div><% }); %>'),ecEditor.jQuery('a[data-content ="comments"]').addClass("highlight"),ecEditor.jQuery("#reviewerComments").html(e)):this.displayNoComments()}}))}]);